"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(){}function t(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function n(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function a(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function o(e,t){var n,o=Qe(e),i=!o&&Je(e),r=!o&&!i&&Xe(e),a=!o&&!i&&!r&&$e(e),s=o||i||r||a,l=s?function(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}(e.length,String):[],d=l.length;for(n in e)!t&&!Ee.call(e,n)||s&&("length"==n||r&&("offset"==n||"parent"==n)||a&&("buffer"==n||"byteLength"==n||"byteOffset"==n)||h(n,d))||l.push(n);return l}function u(e,t,n){var o=e[t];Ee.call(e,t)&&E(o,n)&&(n!==M||t in e)||d(e,t,n)}function i(e,t){for(var n=e.length;n--;)if(E(e[n][0],t))return n;return-1}function d(e,t,n){"__proto__"==t&&Oe?Oe(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function r(e){return null==e?e===M?$:J:Le&&Le in Object(e)?function(e){var t=Ee.call(e,Le),n=e[Le];try{e[Le]=M;var o=!0}catch(e){}var i=Se.call(e);return o&&(t?e[Le]=n:delete e[Le]),i}(e):Se.call(e)}function s(e){return U(e)&&r(e)==W}function l(e){return C(e)&&(t=e,!(Ae&&Ae in t))&&(S(e)?Te:ae).test(function(e){if(null!=e){try{return Ie.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function c(e){if(!C(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t,n,o,i=(n=(t=e)&&t.constructor,t===("function"==typeof n&&n.prototype||ye)),r=[];for(o in e)("constructor"!=o||!i&&Ee.call(e,o))&&r.push(o);return r}function p(e,t){return We((r=e,s=z,a=Ne((a=t)===M?r.length-1:a,0),function(){for(var e=arguments,t=-1,n=Ne(e.length-a,0),o=Array(n);++t<n;)o[t]=e[a+t];for(var t=-1,i=Array(a+1);++t<a;)i[t]=e[t];return i[a]=s(o),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(r,this,i)}),e+"");var r,a,s}function g(e){if("string"==typeof e)return e;if(Qe(e))return function(e,t){for(var n=-1,o=null==e?0:e.length,i=Array(o);++n<o;)i[n]=t(e[n],n,e);return i}(e,g)+"";if(L(e))return Me?Me.call(e):"";var t=e+"";return"0"==t&&1/e==-B?"-0":t}function m(e,t){return Qe(e)?e:function(e,t){if(Qe(e))return!1;var n=void 0===e?"undefined":_typeof(e);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!L(e))||ee.test(e)||!Z.test(e)||null!=t&&e in Object(t)}(e,t)?[e]:He(D(e))}function f(e,t){var n,o=e.__data__;return("string"==(e=void 0===(n=t)?"undefined":_typeof(n))||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==n:null===n)?o["string"==typeof t?"string":"hash"]:o.map}function b(e,t){t=t,t=null==(e=e)?M:e[t];return l(t)?t:M}function h(e,t){var n=void 0===e?"undefined":_typeof(e);return(t=null==t?j:t)&&("number"==n||"symbol"!=n&&le.test(e))&&-1<e&&e%1==0&&e<t}function v(e,t,n){if(C(n)){var o=void 0===t?"undefined":_typeof(t);return("number"==o?A(n)&&h(t,n.length):"string"==o&&t in n)&&E(n[t],e)}}function _(e){if("string"==typeof e||L(e))return e;var t=e+"";return"0"==t&&1/e==-B?"-0":t}function w(e,t){var n;if("function"!=typeof t)throw new TypeError(G);return e=k(e),function(){return 0<--e&&(n=t.apply(this,arguments)),e<=1&&(t=M),n}}function y(o,n,e){function i(e){var t=l,n=d;return l=d=M,m=e,u=o.apply(n,t)}function r(e){var t=e-g;return g===M||n<=t||t<0||b&&c<=e-m}function a(){var e,t=Ge();return r(t)?s(t):(p=setTimeout(a,(t=n-((e=t)-g),b?De(t,c-(e-m)):t)),M)}function s(e){return p=M,h&&l?i(e):(l=d=M,u)}function t(){var e=Ge(),t=r(e);if(l=arguments,d=this,g=e,t){if(p===M)return m=t=g,p=setTimeout(a,n),f?i(t):u;if(b)return p=setTimeout(a,n),i(g)}return p===M&&(p=setTimeout(a,n)),u}var l,d,c,u,p,g,m=0,f=!1,b=!1,h=!0;if("function"!=typeof o)throw new TypeError(G);return n=N(n)||0,C(e)&&(f=!!e.leading,b="maxWait"in e,c=b?Ne(N(e.maxWait)||0,n):c,h="trailing"in e?!!e.trailing:h),t.cancel=function(){p!==M&&clearTimeout(p),m=0,l=g=d=p=M},t.flush=function(){return p===M?u:s(Ge())},t}function I(o,i){if("function"!=typeof o||null!=i&&"function"!=typeof i)throw new TypeError(G);function r(){var e=arguments,t=i?i.apply(this,e):e[0],n=r.cache;return n.has(t)?n.get(t):(e=o.apply(this,e),r.cache=n.set(t,e)||n,e)}return r.cache=new(I.Cache||a),r}function E(e,t){return e===t||e!=e&&t!=t}function A(e){return null!=e&&T(e.length)&&!S(e)}function S(e){if(!C(e))return!1;e=r(e);return e==Y||e==K||e==H||e==Q}function T(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=j}function C(e){var t=void 0===e?"undefined":_typeof(e);return null!=e&&("object"==t||"function"==t)}function U(e){return null!=e&&"object"==(void 0===e?"undefined":_typeof(e))}function L(e){return"symbol"==(void 0===e?"undefined":_typeof(e))||U(e)&&r(e)==X}function O(e){return e?(e=N(e))===B||e===-B?(e<0?-1:1)*V:e==e?e:0:0===e?e:0}function k(e){var t=O(e),e=t%1;return t==t?e?t-e:t:0}function N(e){if("number"==typeof e)return e;if(L(e))return q;if("string"!=typeof(e=C(e)?C(t="function"==typeof e.valueOf?e.valueOf():e)?t+"":t:e))return 0===e?e:+e;e=e.replace(ne,"");var t=re.test(e);return t||se.test(e)?ue(e.slice(2),t?2:8):ie.test(e)?q:+e}function D(e){return null==e?"":g(e)}function P(e){return A(e)?o(e,!0):c(e)}function R(e){return function(){return e}}function z(e){return e}function x(){return!1}var M,G="Expected a function",F="__lodash_hash_undefined__",B=1/0,j=9007199254740991,V=17976931348623157e292,q=NaN,W="[object Arguments]",H="[object AsyncFunction]",Y="[object Function]",K="[object GeneratorFunction]",J="[object Null]",Q="[object Proxy]",X="[object Symbol]",$="[object Undefined]",Z=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ee=/^\w*$/,te=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ne=/^\s+|\s+$/g,oe=/\\(\\)?/g,ie=/^[-+]0x[0-9a-f]+$/i,re=/^0b[01]+$/i,ae=/^\[object .+?Constructor\]$/,se=/^0o[0-7]+$/i,le=/^(?:0|[1-9]\d*)$/,de={};de["[object Float32Array]"]=de["[object Float64Array]"]=de["[object Int8Array]"]=de["[object Int16Array]"]=de["[object Int32Array]"]=de["[object Uint8Array]"]=de["[object Uint8ClampedArray]"]=de["[object Uint16Array]"]=de["[object Uint32Array]"]=!0,de[W]=de["[object Array]"]=de["[object ArrayBuffer]"]=de["[object Boolean]"]=de["[object DataView]"]=de["[object Date]"]=de["[object Error]"]=de[Y]=de["[object Map]"]=de["[object Number]"]=de["[object Object]"]=de["[object RegExp]"]=de["[object Set]"]=de["[object String]"]=de["[object WeakMap]"]=!1;var ce=parseFloat,ue=parseInt,pe="object"==("undefined"==typeof global?"undefined":_typeof(global))&&global&&global.Object===Object&&global,ge="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self&&self.Object===Object&&self,me=pe||ge||Function("return this")(),fe="object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&exports&&!exports.nodeType&&exports,be=fe&&"object"==("undefined"==typeof module?"undefined":_typeof(module))&&module&&!module.nodeType&&module,he=be&&be.exports===fe,ve=he&&pe.process,_e=function(){try{return ve&&ve.binding&&ve.binding("util")}catch(e){}}(),we=_e&&_e.isTypedArray,ge=Array.prototype,pe=Function.prototype,ye=Object.prototype,_e=me["__core-js_shared__"],Ie=pe.toString,Ee=ye.hasOwnProperty,Ae=(_e=/[^.]+$/.exec(_e&&_e.keys&&_e.keys.IE_PROTO||""))?"Symbol(src)_1."+_e:"",Se=ye.toString,Te=RegExp("^"+Ie.call(Ee).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_e=he?me.Buffer:M,he=me.Symbol,Ce=ye.propertyIsEnumerable,Ue=ge.splice,Le=he?he.toStringTag:M,Oe=function(){try{var e=b(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),ke=Math.floor,_e=_e?_e.isBuffer:M,Ne=Math.max,De=Math.min,Pe=Date.now,Re=Math.random,ze=b(me,"Map"),xe=b(Object,"create"),he=he?he.prototype:M,Me=he?he.toString:M;t.prototype.clear=function(){this.__data__=xe?xe(null):{},this.size=0},t.prototype.delete=function(e){return e=this.has(e)&&delete this.__data__[e],this.size-=e?1:0,e},t.prototype.get=function(e){var t=this.__data__;if(xe){var n=t[e];return n===F?M:n}return Ee.call(t,e)?t[e]:M},t.prototype.has=function(e){var t=this.__data__;return xe?t[e]!==M:Ee.call(t,e)},t.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=xe&&t===M?F:t,this},n.prototype.clear=function(){this.__data__=[],this.size=0},n.prototype.delete=function(e){var t=this.__data__;return!((e=i(t,e))<0||(e==t.length-1?t.pop():Ue.call(t,e,1),--this.size,0))},n.prototype.get=function(e){var t=this.__data__;return(e=i(t,e))<0?M:t[e][1]},n.prototype.has=function(e){return-1<i(this.__data__,e)},n.prototype.set=function(e,t){var n=this.__data__,o=i(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this},a.prototype.clear=function(){this.size=0,this.__data__={hash:new t,map:new(ze||n),string:new t}},a.prototype.delete=function(e){return e=f(this,e).delete(e),this.size-=e?1:0,e},a.prototype.get=function(e){return f(this,e).get(e)},a.prototype.has=function(e){return f(this,e).has(e)},a.prototype.set=function(e,t){var n=f(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this};function Ge(){return me.Date.now()}var Fe,Be,je,Ve,qe,We=(je=Oe?function(e,t){return Oe(e,"toString",{configurable:!0,enumerable:!1,value:R(t),writable:!0})}:z,qe=Ve=0,function(){var e=Pe(),t=16-(e-qe);if(qe=e,0<t){if(800<=++Ve)return arguments[0]}else Ve=0;return je.apply(M,arguments)}),He=(Be=(Fe=I(Fe=function(e){var i=[];return 46===e.charCodeAt(0)&&i.push(""),e.replace(te,function(e,t,n,o){i.push(n?o.replace(oe,"$1"):t||e)}),i},function(e){return 500===Be.size&&Be.clear(),e})).cache,Fe);I.Cache=a;var Ye,Ke,Je=s(function(){return arguments}())?s:function(e){return U(e)&&Ee.call(e,"callee")&&!Ce.call(e,"callee")},Qe=Array.isArray,Xe=_e||x,$e=we?(Ke=we,function(e){return Ke(e)}):function(e){return U(e)&&T(e.length)&&!!de[r(e)]},we=(Ye=function(e,t){!function(e,t,n,o){var i=!n;n=n||{};for(var r=-1,a=t.length;++r<a;){var s=t[r],l=o?o(n[s],e[s],s,n,e):M;(i?d:u)(n,s,l=l===M?e[s]:l)}}(t,P(t),e)},p(function(e,t){var n=-1,o=t.length,i=1<o?t[o-1]:M,r=2<o?t[2]:M,i=3<Ye.length&&"function"==typeof i?(o--,i):M;for(r&&v(t[0],t[1],r)&&(i=o<3?M:i,o=1),e=Object(e);++n<o;){var a=t[n];a&&Ye(e,a,n,i)}return e}));e.assignIn=we,e.before=w,e.constant=R,e.debounce=y,e.keysIn=P,e.memoize=I,e.once=function(e){return w(2,e)},e.set=function(e,t,n){return null==e?e:function(e,t,n,o){if(!C(e))return e;for(var i=-1,r=(t=m(t,e)).length,a=r-1,s=e;null!=s&&++i<r;){var l,d=_(t[i]),c=n;i!=a&&(l=s[d],(c=o?o(l,d,s):M)===M&&(c=C(l)?l:h(t[i+1])?[]:{})),u(s,d,c),s=s[d]}return e}(e,t,n)},e.throttle=function(e,t,n){var o=!0,i=!0;if("function"!=typeof e)throw new TypeError(G);return C(n)&&(o="leading"in n?!!n.leading:o,i="trailing"in n?!!n.trailing:i),y(e,t,{leading:o,maxWait:t,trailing:i})},e.extend=we,e.eq=E,e.identity=z,e.isArguments=Je,e.isArray=Qe,e.isArrayLike=A,e.isBuffer=Xe,e.isFunction=S,e.isLength=T,e.isObject=C,e.isObjectLike=U,e.isSymbol=L,e.isTypedArray=$e,e.stubFalse=x,e.now=Ge,e.random=function(e,t,n){var o;if(n&&"boolean"!=typeof n&&v(e,t,n)&&(t=n=M),n===M&&("boolean"==typeof t?(n=t,t=M):"boolean"==typeof e&&(n=e,e=M)),e===M&&t===M?(e=0,t=1):(e=O(e),t===M?(t=e,e=0):t=O(t)),t<e&&(o=e,e=t,t=o),n||e%1||t%1){n=Re();return De(e+n*(t-e+ce("1e-"+((n+"").length-1))),t)}return t=t,(e=e)+ke(Re()*(t-e+1))},e.result=function(e,t,n){var o=-1,i=(t=m(t,e)).length;for(i||(i=1,e=M);++o<i;){var r=null==e?M:e[_(t[o])];r===M&&(o=i,r=n),e=S(r)?r.call(e):r}return e},e.toFinite=O,e.toInteger=k,e.toNumber=N,e.toString=D,e.VERSION="4.17.5","function"==typeof define&&"object"==_typeof(define.amd)&&define.amd?(me._=e,define(function(){return e})):be?((be.exports=e)._=e,fe._=e):me._=e}.call(void 0);var TRC=window.TRC||{},Globals=window.Globals||{};function isPubSuffixForRouteOn(e,t){var n=(e="string"==typeof e?[e]:e).reduce(function(e,t){return e.push("/"+t+"/"),e.push("/"+t+"?"),e},[]),o=t+"?";return!e.length||n.some(function(e){return-1!==o.indexOf(e)})}(mgzUI=window.mgzUI||{}).mainImage=mgzUI.mainImage||{},window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)}),window.HTMLElement&&!HTMLElement.appendAfter&&(HTMLElement.prototype.appendAfter=function(e){e.parentNode.insertBefore(this,e.nextSibling)}),window.HTMLElement&&!HTMLElement.appendChildren&&(HTMLElement.prototype.appendChildren=function(e){for(var t=0;t<e.length;t++)this.appendChild(e[t])}),Date.now||(Date.now=function(){return(new Date).getTime()}),Globals.googleAnalyticsEvent=function(e,t,n){console.debug("GoogleAnalyticsEvent: ",e,t),t=decodeURIComponent(t)||e,n=decodeURIComponent(n||location.pathname),window.ga&&ga("send","event",e,t,n)},mgzUI.serviceOnceObj={},mgzUI.onceFunc=function(e){return!mgzUI.serviceOnceObj[e]&&(mgzUI.serviceOnceObj[e]=!0)},mgzUI.debounceFunction=function(e,t){clearTimeout(void 0);setTimeout(e,t)},mgzUI.decodeHTML=function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value},mgzUI.magazineSideDedupe=function(e,t){t=t||"h1.article-title";for(var n=document.querySelector(t).innerText,o=e.detail.items,i=0;i<o.length;i++){var r=o[i],a=r.title;mgzUI.decodeHTML(a)!=n||(r=document.querySelector('div[data-item-title="'+r.title+'"]'))&&(r.remove(),console.log("mgzUI.magazineSideDedupe - item deduped - ",r))}},mgzUI.customDFPCounter=0,mgzUI.addCustomAdCard=function(e,t,n){var o,i,r,a,s=3<arguments.length&&void 0!==arguments[3]&&arguments[3],l=arguments[4];isPubSuffixForRouteOn(_.result(Globals,"settings.ads.has_pub_suffix_on_routes",[]),window&&window.location?window.location.pathname+"?":"")&&_.result(Globals,"settings.ads.has_pub_suffix",!1)&&(o=getPublisherId(),n.includes(o)||(n+="_"+o));try{if(window.dfpSlots=window.dfpSlots||{},!n)return void console.error("Error on define mgzUI.addCustomAdCard slot - missing add id path");mgzUI.CustomDivId="tbl-customDFP"+mgzUI.customDFPCounter,mgzUI.customSize=function(){try{t=JSON.parse(t)}catch(e){console.debug("addCustomAdCard size not json---\x3e ",t)}return t||[320,50]},mgzUI.customPath=n;var d=window.document.createElement("div");d.id=mgzUI.CustomDivId,d.style.width="100%",d.style.height="auto",d.style.margin="0 0 15px auto",d.style.textAlign="center",d.style.margin="auto",l&&"number"==typeof l&&d.setAttribute("data-click-delay",l),e.parentNode.appendChild(d),mgzUI.gptFileLoaded&&!mgzUI._dfpFailed||(i=window.document,r="tbl-gpt-script",a=i.getElementsByTagName("script")[0],i.getElementById(r)||((i=i.createElement("script")).id=r,i.async=!0,i.src="https://securepubads.g.doubleclick.net/tag/js/gpt.js",a.parentNode.insertBefore(i,a))),mgzUI.shouldYieldbirdDisplay?(window.Yieldbird=window.Yieldbird||{},window.Yieldbird.cmd=window.Yieldbird.cmd||[],window.Yieldbird.cmd.push(function(){var e=window.Yieldbird.defineSlot(mgzUI.CustomDivId);e?e.setTargeting({k1:"v1",k2:"v2"}).render():console.error("Error on define YB slot ",mgzUI.customPath," id",mgzUI.CustomDivId)})):window.googletag.cmd.push(function(){var e,t=document.querySelector("#"+mgzUI.CustomDivId),n=window.googletag.defineSlot(mgzUI.customPath,mgzUI.customSize(),mgzUI.CustomDivId).addService(window.googletag.pubads()),o=mgzUI.isAdSpecificLazyLoad&&s;n?(window.googletag.pubads().collapseEmptyDivs(),n.addService(window.googletag.pubads()),window.dfpService.addSlotTargeting(n,o),window.googletag.enableServices(),o?(e=n.getSlotElementId(),observe(t,0,e,function(){mgzUI.pbEnabled?requestBids([n]):window.googletag.display(e)},noop,mgzUI.lazyLoadRootMargin)):mgzUI.pbEnabled?requestBids([n]):window.googletag.display(mgzUI.CustomDivId),window.googletag.pubads().addEventListener("slotRenderEnded",function(e){e.isEmpty||e.slot.getSlotElementId()!==mgzUI.CustomDivId||TRC.dispatch("trcContentReady",{container:t.parentNode})})):AbFire.sendAbEvent("mgz_addCustomAdCard","missing_ad_slot")}),mgzUI.customDFPCounter++}catch(e){AbFire.sendAbEvent("mgzUI.addCustomAdCard error",e),TRC.__trcError("Error in publisher-start - Add Custom DFP Card"+e.message)}};var userAgent=navigator.userAgent||navigator.vendor||window.opera||"";window.isMobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(userAgent.substr(0,4)),window.isTablet=/SM-T|MI PAD|ARM|iPad|Fire|nexus/i.test(userAgent),window.isInternetExplorer=/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i.test(userAgent),Globals.orientation=(screen.orientation||{}).type||screen.mozOrientation||screen.msOrientation,mgzUI.replaceCloudinaryParams=function(e,t){var n=void 0,o=void 0,i=void 0;return mgzUI.mainImage.newWidth=n,mgzUI.mainImage.newHeight=o,o=767<window.innerWidth?(n=window.innerWidth>window.innerHeight?856:904,window.innerWidth>window.innerHeight?916:Math.round(window.innerWidth/1.9)):(n=Math.round(2*(window.innerWidth-30)),article.imageHeight?2*article.imageHeight:Math.round(n/1.9)),-1<e.indexOf("/http")&&(e=e.substr(e.indexOf("/http")+1)),i=t&&t.includes("{w}")&&t.includes("{h}")?t.replace("{w}",n).replace("{h}",o)+e:"//images.taboola.com/taboola/image/fetch/f_jpg%2Cq_auto%2Cq_100%2Ch_"+o+"%2Cw_"+n+"%2Cc_fill%2Cg_faces:auto/"+e,mgzUI.mainImage.url=i},mgzUI.HTMLToText=function(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""},mgzUI.hasClass=function(e,t){for(var n=e.className.split(" "),o=0;o<n.length;o++)if(n[o]==t)return!0;return!1},mgzUI.extractParamsFromUrl=_.memoize(function(e){e=(e=e||location.href).split("?")[e.split("?").length-1];void 0===(e=e&&e.split("#")[0])&&(e="");var i={};return decodeURIComponent(e).replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,t,n,o){i[t]=o}),i}),mgzUI.getParameterByName=function(e,t){t=t||window.location.href,e=e.replace(/[\[\]]/g,"\\$&");t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return t?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null},mgzUI.observeAdAndLazyLoad=function(e,t,n){observe(e,0,t,function(){n(t)},noop,mgzUI.lazyLoadRootMargin)},mgzUI.showAds=function(e){e=e||document,setTimeout(function(){for(var a=e.querySelectorAll(".content_item_ad.google_ad"),s=function(e){setTimeout(function(){window.dfpIdsWasDisplaying=window.dfpIdsWasDisplaying||[],window.isAdDisplaying(e)||(window.dfpIdsWasDisplaying.push(e),window.googletag.cmd.push(function(){googletag.enableServices(),googletag.display(e)}))},100)},l=0;l<a.length;l++)!function(){var e=a[l];if(!e.children.length){var t=document.createElement("div"),n=e.getAttribute("data-ad-id"),o=e.getAttribute("data-ad-unit"),i=e.hasAttribute("data-lazy-load");t.className="cb-google-ad",t.setAttribute("data-id",n),t.innerHTML='<div class="cb-google-ad__title"><div class="cb-google-ad-wrapper"><div class="cb-google-ad-zoom"><div id="'+n+'" style="display: inline-block"></div></div></div></div>',e.appendChild(t);var r=[[320,100],[320,50]];try{r=JSON.parse(e.getAttribute("data-ad-size"))}catch(e){}i=mgzUI.isAdSpecificLazyLoad&&i||mgzUI.isAdLazyLoad;mgzUI.shouldYieldbirdDisplay||mgzUI.pbEnabled?mgzUI.pbEnabled&&(i?mgzUI.observeAdAndLazyLoad(t,n,function(){definePrebidSlot(o,r,n)}):definePrebidSlot(o,r,n)):(window.dfpService.defineSlot(o,r,n,!1,i),i?mgzUI.observeAdAndLazyLoad(t,n,s):s(n))}}()},100)},window.isAdDisplaying=function(e){return window.dfpIdsWasDisplaying=window.dfpIdsWasDisplaying||[],-1!==window.dfpIdsWasDisplaying.indexOf(e)},mgzUI.redirectTo=function(e){var t=document.createElement("a");t.href=e,t.click()},mgzUI.getCloudinaryImage=function(e,t,n){return"//image.thestartmagazine.com/fetch/d_magazineDefault.jpg,c_fill,g_face:auto,fl_lossy,q_70"+(t?",w_"+Math.floor(t):"")+(n?",h_"+Math.floor(n):"")+"/"+e},mgzUI.makeBooleanOrNumber=function(e){return"true"===e?e=!0:"false"===e?e=!1:isNaN(Number(e))||(e=Number(e)),e},mgzUI.sendEvent404=function(e){var t=(e?"bot":"")+"404",n=navigator.userAgent||navigator.vendor||window.opera||"",e=window.location.href,e=JSON.stringify({publisherId:Globals.publisherId,userAgent:n,url:e});loadGoogleAnalytics(_.result(Globals.settings,"tracking.ga_lean","UA-76585427-2")),Globals.googleAnalyticsEvent(t,"pageNotFoundData",e),AbFire.sendBeaconAbEvent(t,e)},mgzUI.setSamsungAB=function(e,t){var n={5824:300,5825:500,5826:600},t=t.pev&&t.pev.length?t.pev.split(",").map(function(e){return e.replace(/variant-/i,"")}):[""];Globals.abPev=t.find(function(e){return!!n[e]})||"",Globals.abPev&&(Globals.settings.ab_samsung_applied||(e.article.summary=e.article.summary||{},e.article.summary.truncated=n[Globals.abPev]))},mgzUI.overrideSettings=function(o){o=o||{};var i=mgzUI.extractParamsFromUrl();return Object.keys(i||{}).forEach(function(e){var t,n;0===e.indexOf("ovrd.")&&(t=i[e],(e=e.substring(5))&&t&&(n=void 0,0<t.indexOf(":")&&0!==t.indexOf("http:")&&0!==t.indexOf("https:")?t.split(",").forEach(function(e){var t=e.split(":"),e=t[0];e&&t[1]&&((n=n||{})[e]=mgzUI.makeBooleanOrNumber(t[1]))}):n=0<t.indexOf(",")?t.split(",").map(mgzUI.makeBooleanOrNumber):mgzUI.makeBooleanOrNumber(t),_.set(o,e,n)))}),mgzUI.setSamsungAB(o,i),o},mgzUI.sendPageLoadEvent=function(){window.performance&&window.performance.getEntriesByType&&window.addEventListener("load",function(){setTimeout(function(){var e=window.performance.getEntriesByType("navigation").pop();e&&(Globals.performance=Globals.performance||{},Globals.performance.dom_complete=(Math.round(e.domComplete)/1e3).toFixed(2),Globals.performance.dom_interactive=(Math.round(e.domInteractive)/1e3).toFixed(2),window.AbFire.sendAbEvent("mgz_page_load_dom_complete",Globals.performance.dom_complete),window.AbFire.sendAbEvent("mgz_page_load_dom_interactive",Globals.performance.dom_interactive))})})},mgzUI.trimHtml=function(e,t){for(var n,o,i,r,a,s,l="number"==typeof(t=t||{}).limit?t.limit:100,d=void 0===t.preserveTags||t.preserveTags,c=void 0!==t.wordBreak&&t.wordBreak,u=t.suffix||"...",p=t.preserveWhiteSpace||!1,g=e.replace(/</g,"\n<").replace(/>/g,">\n").replace(/\n\n/g,"\n").replace(/^\n/g,"").replace(/\n$/g,"").split("\n"),m=0,f=0,b=[],h=!1,v=0;v<g.length;v++)if(n=g[v],i=p?n:n.replace(/[ ]+/g," "),n.length){var _=mgzUI.getCharArray(i);if("<"!==n[0])if(l<=m)n="";else if(m+_.length>=l){if(" "===_[(o=l-m)-1])for(;o&&" "===_[--o-1];);else a=_.slice(o).indexOf(" "),c||(-1!==a?o+=a:o=n.length);n=_.slice(0,o).join("")+u,f=v+1,r=_.slice(o).join("")+g.slice(f).join(""),m=l,h=!0}else m+=_.length;else if(d){if(l<=m)if(s=(a=n.match(/[a-zA-Z]+/))?a[0]:"")if("</"!==n.substring(0,2))b.push(s),n="";else{for(;b[b.length-1]!==s&&b.length;)b.pop();b.length&&(n=""),b.pop()}else n=""}else n="";g[v]=n}return{html:g.join("\n").replace(/\n/g,""),more:h,closeTags:u+g.slice(f).join(""),restContent:r}},mgzUI.getCharArray=function(e){for(var t,n=[],o=0;o<e.length;o++)(t=e.substring(o).match(/^&[a-z0-9#]+;/))?(t=t[0],n.push(t),o+=t.length-1):n.push(e[o]);return n},mgzUI.getBestMatchedName=function(e,t){for(var n=void 0,o=void 0,i=0;i<e.length;i++){var r=e[i],a=new RegExp(t,"i");if(r.toLowerCase()===t.toLowerCase()){o=r;break}a.test(r)&&(n=r)}return o||n},mgzUI.changeScoresPage=function(e){var t,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1],o=["publisherId","key","aid","utm_source","utm_medium","cex","appv"],i=mgzUI.extractParamsFromUrl(),r="/scores/"+e,a=n;for(t in i)i.hasOwnProperty(t)&&o.includes(t)&&(r+=(a?"&":"?")+t+"="+i[t],a=!0);window.open(r,"_self")},mgzUI.renderFeedItemsForScores=function(d){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],u=[];return d.forEach(function(e,t){var n,o,i=c.find(function(e){return e.position===t+1}),r=t===d.length-1||i,a=Globals.sponsoredPlacement&&e.name&&e.name.includes(Globals.sponsoredPlacement),s=_.result(e,"events",{}),l=_.result(e,"list[0]",null);l&&(n=l,o=r,e=a,l=s,r=_.result(n,"thumbnail[0].url"),a='<a href="'+Globals.logoLink+'" class="feed-item-link"><span>Sponsored</span></a>',(s=document.createElement("div")).classList.add("api-feed-item"),o&&s.classList.add("api-feed-item_last"),s.dataset.visibleEvent=l.visible||"",s.dataset.availableEvent=l.available||"",s.innerHTML='<div class="feed-item_desc-container">\n                <a href="'+n.url+'" class="feed-item-link"><div class="feed-item_title">'+n.name+'</div></a>\n                <div class="feed-item_title-footer">\n                    <span>'+n.branding+"</span>\n                    "+(e?'<span class="feed-item_spacer"></span>':"")+"\n                    "+(e?a:"")+'\n                </div>\n                </div>\n                 <div class="feed-item_image-container">\n                    <a href="'+n.url+'" class="feed-item-link"><div class="feed-item_image" style="background-image: url(\''+r+"')\"></div></a>\n                </div>",u.push(s=s),mgzUI.setFeedEventsForScores([s]),i&&(s=i,(i=document.createElement("section")).classList.add("dfp-container"),i.innerHTML='<div class="content_item_ad google_ad" data-ad-unit="'+s.ad_unit+'" data-ad-size="'+s.size+'" data-ad-id="'+s.id+'" data-lazy-load="'+s.lazy+'"></div>',u.push(i)))}),u},mgzUI.setInfiniteAPIFeedForScores=function(n){var o=n.feedContainerEl,t=n.placements,i=n.sponsoredPlacement,e=o.querySelector(".api-feed-item:nth-last-child(4)");e&&mgzUI.trackInfiniteFeedLoadTrigger(e,function(){var e=mgzUI.generatePlacementsForScores(mgzUI.scoresFeedParameters.totalItemsLoaded+6,t,i,mgzUI.scoresFeedParameters.totalItemsLoaded+1);mgzUI.getFeedItemsForScores(e,function(e,t){!t&&e&&e.length&&((e=mgzUI.renderFeedItemsForScores(e,[])).forEach(function(e){o.appendChild(e)}),mgzUI.scoresFeedParameters.totalItemsLoaded+=e.length,6===e.length&&mgzUI.setInfiniteAPIFeedForScores(n))})})},mgzUI.trackInfiniteFeedLoadTrigger=function(e,t){var n=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&.95<e.intersectionRatio&&(t(),n.unobserve(e.target))})},{threshold:[1]});n.USE_MUTATION_OBSERVER=!1,n.POLL_INTERVAL=100,e&&n.observe(e)},mgzUI.scoresFeedParameters={viewId:""+Date.now()+Math.floor(1e7*Math.random()),sessionId:"init",totalItemsLoaded:0},mgzUI.getFeedItemsForScores=function(e,n){var t,o="//api.taboola.com/2.0/json/"+Globals.publisherId.replace("Taboola_","")+"/recommendations.get",i=Globals.contentAPIKey,r=window.location.href,a=mgzUI.extractParamsFromUrl(),s="true"===(t=a.cex)?"TRUE_CONSENT":"false"===t?"FALSE_CONSENT":"NONE_CONSENT",l="";fetch(o,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify({app:{type:"MOBILE",apiKey:""+i,origin:"CLIENT",name:"ScoresMinisite",consent:{exists:s},mobileData:{app:{version:""+(a.appv||"")}}},user:{session:mgzUI.scoresFeedParameters.sessionId,device:""+a.aid},source:{type:"section",id:"scoresminisite",url:""+r},view:{id:mgzUI.scoresFeedParameters.viewId},placements:e})}).then(function(e){e.json().then(function(e){var t=_.result(e,"user.session",null);t&&(mgzUI.scoresFeedParameters.sessionId=t);e=e.placements||[];e&&e.length&&(e=e.sort(function(e,t){e=e.name.split("_"),t=t.name.split("_");return e[e.length-1]-t[t.length-1]})),n(e,l)})}).catch(function(e){n([],l=e)})},mgzUI.getStoriesForScores=function(t){var e=Globals.publisherId.replace("Taboola_","");fetch("https://news-api.taboola.com/stories/v1/"+e+"/wc-stories",{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(e){e.json().then(function(e){e&&e.stories?t(e.stories):t([])})}).catch(function(e){t({})})},mgzUI.generatePlacementsForScores=function(e,t,n){for(var o=[],i=Globals.firstSponsoredItem,r=Globals.sponsoredRatio,a=i&&2<=r&&n,s=void 0,l=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;l<=e;l++){var d=l.toLocaleString(void 0,{minimumIntegerDigits:3}),s=a&&i<=l&&(l-i)%r==0?n:!(2<=t.length)||l%2?t[0]:t[1];o.push({name:s+"_"+d,recCount:"1",organicType:"MIX",thumbnail:{width:"780",height:"600"}})}return o},mgzUI.sendScoresEvent=function(e){fetch(e).then(function(){})},mgzUI.setFeedEventsForScores=function(e){var n=new IntersectionObserver(function(e){e.forEach(function(e){var t;e.isIntersecting&&.95<e.intersectionRatio&&(e.target.dataset&&e.target.dataset.visibleEvent&&(t=e.target.dataset.visibleEvent,mgzUI.sendScoresEvent(t)),n.unobserve(e.target))})},{threshold:[1]});n.USE_MUTATION_OBSERVER=!1,n.POLL_INTERVAL=100,e&&e.length&&e.forEach(function(e){var t;e&&e.dataset&&e.dataset.availableEvent&&(t=e.dataset.availableEvent,mgzUI.sendScoresEvent(t)),n.observe(e)})},mgzUI.trackScoresSectionVisibility=function(e,t,n){var o=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&.95<e.intersectionRatio&&(mgzUI.trackMixpanelEvent(t,n),o.unobserve(e.target))})},{threshold:[1]});o.USE_MUTATION_OBSERVER=!1,o.POLL_INTERVAL=100,e&&o.observe(e)},mgzUI.trackMixpanelEvent=function(e,t){t=t||{},window.mixpanel&&e&&mixpanel.track(e,t)},mgzUI.registerMixpanelSuperProperties=function(e){window.mixpanel&&e&&mixpanel.register(e)},mgzUI.shuffleArray=function(e){for(var t,n=e.length;0!==n;){t=Math.floor(Math.random()*n),n--;var o=[e[t],e[n]];e[n]=o[0],e[t]=o[1]}return e},mgzUI.isLongSwipe=function(e){return 50<=Math.abs(e.start-e.end)},mgzUI.categoryMap={finance:"Business",technology:"Tech",sport:"Sports",tourism:"Travel",food:"Food and drink"},mgzUI.getCampaignId=function(){var e=Globals.dc_data||_.result(Globals,"query.dc_data");return e&&e.includes("_")?e.split("_")[0]:""},Globals.settings=mgzUI.overrideSettings(Globals.settings);var tabVisibility=function(){var t,n,e={hidden:"visibilitychange",webkitHidden:"webkitvisibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange"};for(t in e)if(t in document){n=e[t];break}return function(e){return e&&document.addEventListener(n,e),!document[t]}}(),goToPage=function(e){window.location.href=e};mgzUI.fallbackWidgetShown=0,mgzUI.fallbackPlacementsShown={},mgzUI.showFallbackTaboolaWidget=function(e,t){var n,o,i,r,a,s,l,d=document.getElementById(e);d?((n=d).style.height="0px",n.style.position="absolute",n.style.zIndex="-1",n.parentElement&&(n.parentElement.style.position="relative"),(o=document.createElement("div")).id="taboola-slot-"+mgzUI.fallbackWidgetShown,o.style.minWidth="320px",o.style.width="100%",o.style.maxWidth="100vw",e=o,d.insertAdjacentElement("afterend",e),mgzUI.fallbackWidgetShown++,r=t.placement,a=mgzUI.fallbackPlacementsShown[r],s=r,a?(s=r+" "+a,mgzUI.fallbackPlacementsShown[r]++):mgzUI.fallbackPlacementsShown[r]=1,i=s,l={mode:t.mode,container:e.id,placement:i,target_type:t.target_type},window._taboola=window._taboola||[],_taboola.push({listenTo:"render",handler:function(e){_.result(e,"detail.placement")===i&&(e&&e.detail&&e.detail.itemCount?console.debug("[SC-FALLBACK]: Item rendered!",i):console.debug("[SC-FALLBACK]: WARNING! Item is not rendered!",i))}}),console.debug("[SC-FALLBACK]: SC Fallback called with params: ",l),_taboola.push(l)):console.error("[SC FALLBACK] Frame element is not found.")},function(){var t="t_mc",e=document.cookie.split("; ").find(function(e){return e.startsWith(t+"=")}),n=e?e.split("=")[1]:"",o=function(){try{return!!window.sessionStorage&&(sessionStorage.setItem("test","test"),sessionStorage.removeItem("test"),!0)}catch(e){return!1}}(),i=mgzUI.extractParamsFromUrl().cex||null;i&&i.length&&(i="true"===i||"false"!==i&&null);var r=!1;"boolean"!=typeof i&&o?(i=b(window.sessionStorage.getItem("__tcex")))&&(r=!0):"boolean"!=typeof i&&n&&(i="1"===n,r=!0);var p="boolean"==typeof i,g=_.result(Globals,"settings.ads.tcStringsOldGDPR",!1);"boolean"==typeof(i=g&&p?!1:i)&&(window._taboola=window._taboola||[],window._taboola.push({cex:i?"true":"false"}));var m={cex:i,cmpId:300,cmpVersion:0},a="CPMb0YxPMb0YxEsAAAENAwCsAP_AAH_AAAAAGLtV_T9fb2vj-_Z99_tkeYwf95y3p-wzhheMs-8NyZeH_B4Wv2MyvBX4JiQKGRgksjLBAQdtHGlcTQgBwIlViTLMYk2MjzNKJrJEilsbO2dYGD9Pn8HT3ZCY70-vv__7v3ff_3gYu1X9P19va-P79n33-2R5jB_3nLen7DOGF4yz7w3Jl4f8Hha_YzK8FfgmJAoZGCSyMsEBB20caVxNCAHAiVWJMsxiTYyPM0omskSKWxs7Z1gYP0-fwdPdkJjvT6-___u_d9__eAAA.YAAAAAAAAAA",s="CPMb0YxPMb0YxEsAAAENAwCsAP_AAH_AAAAAGLwAAMXgAAAA.YAAAAAAAAAA",e={consentEnabled:_.result(Globals,"settings.ads.tcStrings.consentEnabled","CPi3b7wPi3b7wEsAAAENCZCgAL0AAELAACiQI7Nd_X__bX9n-_7_6ft0eY1f9_r37uQzDhfNs-8F3L_W_LwX32E7NF36tq4KmR4ku1bBIQNtHMnUDUmxaolVrzHsak2cpyNKJ_JkknsZe2dYGF9Pn9lD-YKZ7_5_9_f52T_9_9_-39z3_9f___dv_-__-vjf_599n_v9fV_78_Kf9______-____________8Edmu_r__tr-z_f9_9P26PMav-_1793IZhwvm2feC7l_rfl4L77Cdmi79W1cFTI8SXatgkIG2jmTqBqTYtUSq15j2NSbOU5GlE_kyST2MvbOsDC-nz-yh_MFM9_8_-_v87J_-_-__b-57_-v___u3__f__Xxv_8--z_3-vq_9-flP-_______f___________-AA.YAAAAAAAAAA"),consentDisabled:_.result(Globals,"settings.ads.tcStrings.consentDisabled","CPh5Bj5Ph5Bj5EsAAAENCZCgAIAAAELAACiQI7Nd_X__bX9n-_7_6ft0eY1f9_r37uQzDhfNs-8F3L_W_LwX32E7NF36tq4KmR4ku1bBIQNtHMnUDUmxaolVrzHsak2cpyNKJ_JkknsZe2dYGF9Pn9lD-YKZ7_5_9_f52T_9_9_-39z3_9f___dv_-__-vjf_599n_v9fV_78_Kf9______-____________8Edmu_r__tr-z_f9_9P26PMav-_1793IZhwvm2feC7l_rfl4L77Cdmi79W1cFTI8SXatgkIG2jmTqBqTYtUSq15j2NSbOU5GlE_kyST2MvbOsDC-nz-yh_MFM9_8_-_v87J_-_-__b-57_-v___u3__f__Xxv_8--z_3-vq_9-flP-_______f___________-AA.YAAAAAAAAAA")},f={haveConsentApplied:p,nonPersonalAd:!b(i,!0),consentEnabled:g?a:e.consentEnabled,consentDisabled:g?s:e.consentDisabled};function b(e,t){return"true"===e||!0===e||"false"!==e&&!1!==e&&t}function l(e){return e&&"1"===e}function d(){window.__tcfapi=function(e,t,n,o){var i,r,a,s,l,d,c=[];function u(){var e=b(m.cex,!0);return{cmpId:m.cmpId,cmpVersion:m.cmpVersion,cmpStatus:"loaded",gdprApplies:g?e:p,eventStatus:"tcloaded",tcString:e?f.consentEnabled:f.consentDisabled,tcfPolicyVersion:2}}switch(e){case"addEventListener":(l=n)&&(c.push(l),(d=u()).listenerId=c.length-1,l(d,!0));break;case"removeEventListener":a=n,c[s=o]?a(!(c[s]=null)):a(!1);break;case"getTCData":(r=n)&&r(u(),!0);break;case"ping":(i=n)&&i({gdprApplies:p,cmpId:m.cmpId,cmpVersion:m.cmpVersion,cmpLoaded:!0,cmpStatus:"loaded",tcfPolicyVersion:2})}}}function c(e){document.cookie=t+"="+(e?"1":"0")+"; "}"boolean"==typeof i&&(o&&!r?window.sessionStorage.setItem("__tcex",m.cex):r||n&&l(n)===i||c(i),d()),function(){if(f.haveConsentApplied){for(var e=f.nonPersonalAd,t=["1","2","4","6","8","10","11","12","13","14","15","16","18","21","22","23","24","25","26","28","30","31","32","33","34","36","37","39","40","41","42","44","45","47","49","50","51","52","53","57","58","59","60","61","62","63","65","66","67","68","69","70","72","73","76","77","78","79","80","82","83","84","85","86","88","89","90","91","92","93","94","95","97","98","100","101","104","108","109","110","111","114","115","119","120","126","127","128","129","130","131","132","133","134","136","137","138","139","142","143","144","147","149","150","152","153","154","155","157","160","161","162","163","164","165","167","168","173","174","177","178","179","184","185","190","192","193","194","195","199","200","203","205","206","209","210","211","212","213","215","216","217","218","223","224","226","227","228","231","234","235","238","240","241","242","243","248","249","250","251","252","253","254","255","256","262","263","264","265","270","272","273","275","277","278","279","280","281","282","284","285","289","290","293","294","297","299","301","302","303","304","310","312","314","315","316","317","318","319","325","328","329","333","336","343","345","350","351","354","358","359","365","368","371","373","374","377","381","382","385","387","388","394","402","408","409","410","412","413","415","416","418","422","423","424","428","429","431","434","436","438","439","440","444","447","448","450","455","466","467","468","475","479","482","484","486","488","490","491","495","498","501","502","505","507","508","511","512","516","517","521","524","527","528","530","531","535","536","539","543","544","545","546","549","550","553","554","556","559","561","565","568","569","571","573","574","577","580","584","587","591","593","596","598","599","601","602","606","607","609","610","613","614","615","617","618","620","621","624","625","626","628","630","631","638","639","645","646","647","648","649","650","652","655","656","657","658","659","662","663","664","665","666","667","668","674","675","676","678","681","682","683","684","686","687","688","690","691","694","699","702","703","707","708","709","711","712","713","714","716","719","720","721","722","723","725","727","728","729","730","731","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","753","754","755","757","758","759","760","761","762","764","765","766","768","769","770","771","772","774","775","776","777","778","779","780","781","782","783","784","785","786","788","789","790","791"],n={},o=0;o<t.length;o++)n[t[o]]=!0;f.purpose=function(e){var t={},n={};if(e)n={2:!0,3:!0,4:!0,5:!0,6:!0,8:!0,9:!(t={1:!0,2:!1,3:!1,4:!1,5:!1,6:!1,7:!0,8:!1,9:!1,10:!1}),10:!0};else for(var o=1;o<=10;o++){var i=o.toString();t[i]=e,1<o&&(n[i]=e)}return{consents:t,legitimateInterests:n}}(!e),f.vendor={consents:e?{}:n,legitimateInterests:e?{}:n}}}(),window.GDPR=f}();_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var p,n,g,m;function r(e){try{return e.defaultView&&e.defaultView.frameElement||null}catch(e){return null}}function l(e){this.time=e.time,this.target=e.target,this.rootBounds=i(e.rootBounds),this.boundingClientRect=i(e.boundingClientRect),this.intersectionRect=i(e.intersectionRect||o()),this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,e=t.width*t.height,t=this.intersectionRect,t=t.width*t.height;this.intersectionRatio=e?Number((t/e).toFixed(4)):this.isIntersecting?1:0}function e(e,t){var n,o,i,t=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(t.root&&1!=t.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),o=this.THROTTLE_TIMEOUT,i=null,function(){i=i||setTimeout(function(){n(),i=null},o)}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(t.rootMargin),this.thresholds=this._initThresholds(t.threshold),this.root=t.root||null,this.rootMargin=this._rootMarginValues.map(function(e){return e.value+e.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}function a(e,t,n,o){"function"==typeof e.addEventListener?e.addEventListener(t,n,o||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,n)}function s(e,t,n,o){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,o||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,n)}function f(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?t.width&&t.height?t:{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}:o()}function o(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function i(e){return!e||"x"in e?e:{top:e.top,y:e.top,bottom:e.bottom,left:e.left,x:e.left,right:e.right,width:e.width,height:e.height}}function b(e,t){var n=t.top-e.top,e=t.left-e.left;return{top:n,left:e,height:t.height,width:t.width,bottom:n+t.height,right:e+t.width}}function t(e,t){for(var n=t;n;){if(n==e)return!0;n=h(n)}return!1}function h(e){var t=e.parentNode;return 9==e.nodeType&&e!=p?r(e):(t=t&&t.assignedSlot?t.assignedSlot.parentNode:t)&&11==t.nodeType&&t.host?t.host:t}"object"===("undefined"==typeof window?"undefined":_typeof(window))&&("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype?"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return 0<this.intersectionRatio}}):(p=function(){for(var e=window.document,t=r(e);t;)t=r(e=t.ownerDocument);return e}(),n=[],m=g=null,e.prototype.THROTTLE_TIMEOUT=100,e.prototype.POLL_INTERVAL=null,e.prototype.USE_MUTATION_OBSERVER=!0,e._setupCrossOriginUpdater=function(){return g=g||function(e,t){m=e&&t?b(e,t):o(),n.forEach(function(e){e._checkForIntersections()})}},e._resetCrossOriginUpdater=function(){m=g=null},e.prototype.observe=function(t){if(!this._observationTargets.some(function(e){return e.element==t})){if(!t||1!=t.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:t,entry:null}),this._monitorIntersections(t.ownerDocument),this._checkForIntersections()}},e.prototype.unobserve=function(t){this._observationTargets=this._observationTargets.filter(function(e){return e.element!=t}),this._unmonitorIntersections(t.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},e.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},e.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},e.prototype._initThresholds=function(e){e=e||[0];return(e=!Array.isArray(e)?[e]:e).sort().filter(function(e,t,n){if("number"!=typeof e||isNaN(e)||e<0||1<e)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==n[t-1]})},e.prototype._parseRootMargin=function(e){e=(e||"0px").split(/\s+/).map(function(e){e=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!e)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(e[1]),unit:e[2]}});return e[1]=e[1]||e[0],e[2]=e[2]||e[0],e[3]=e[3]||e[1],e},e.prototype._monitorIntersections=function(t){var n,o,i,e=t.defaultView;e&&-1==this._monitoringDocuments.indexOf(t)&&(n=this._checkForIntersections,i=o=null,this.POLL_INTERVAL?o=e.setInterval(n,this.POLL_INTERVAL):(a(e,"resize",n,!0),a(t,"scroll",n,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in e&&(i=new e.MutationObserver(n)).observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(t),this._monitoringUnsubscribes.push(function(){var e=t.defaultView;e&&(o&&e.clearInterval(o),s(e,"resize",n,!0)),s(t,"scroll",n,!0),i&&i.disconnect()}),t==(this.root&&this.root.ownerDocument||p)||(e=r(t))&&this._monitorIntersections(e.ownerDocument))},e.prototype._unmonitorIntersections=function(o){var i,e,t=this._monitoringDocuments.indexOf(o);-1!=t&&(i=this.root&&this.root.ownerDocument||p,this._observationTargets.some(function(e){if((t=e.element.ownerDocument)==o)return!0;for(;t&&t!=i;){var t,n=r(t);if((t=n&&n.ownerDocument)==o)return!0}return!1})||(e=this._monitoringUnsubscribes[t],this._monitoringDocuments.splice(t,1),this._monitoringUnsubscribes.splice(t,1),e(),o==i||(e=r(o))&&this._unmonitorIntersections(e.ownerDocument)))},e.prototype._unmonitorAllIntersections=function(){var e=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0;for(var t=this._monitoringUnsubscribes.length=0;t<e.length;t++)e[t]()},e.prototype._checkForIntersections=function(){var a,s;!this.root&&g&&!m||(a=this._rootIsInDom(),s=a?this._getRootRect():o(),this._observationTargets.forEach(function(e){var t=e.element,n=f(t),o=this._rootContainsTarget(t),i=e.entry,r=a&&o&&this._computeTargetAndRootIntersection(t,n,s),r=e.entry=new l({time:window.performance&&performance.now&&performance.now(),target:t,boundingClientRect:n,rootBounds:g&&!this.root?null:s,intersectionRect:r});i?a&&o?this._hasCrossedThreshold(i,r)&&this._queuedEntries.push(r):i&&i.isIntersecting&&this._queuedEntries.push(r):this._queuedEntries.push(r)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this))},e.prototype._computeTargetAndRootIntersection=function(e,t,n){if("none"!=window.getComputedStyle(e).display){for(var o=t,i=h(e),r=!1;!r&&i;){var a,s,l,d,c=null,u=1==i.nodeType?window.getComputedStyle(i):{};if("none"==u.display)return null;if(i==this.root||9==i.nodeType?(r=!0,i==this.root||i==p?g&&!this.root?!m||0==m.width&&0==m.height?o=c=i=null:c=m:c=n:(s=(a=h(i))&&f(a),l=a&&this._computeTargetAndRootIntersection(a,s,n),s&&l?(i=a,c=b(s,l)):o=i=null)):i!=(d=i.ownerDocument).body&&i!=d.documentElement&&"visible"!=u.overflow&&(c=f(i)),c&&(a=c,s=o,c=u=d=l=void 0,l=Math.max(a.top,s.top),d=Math.min(a.bottom,s.bottom),u=Math.max(a.left,s.left),c=Math.min(a.right,s.right),s=d-l,o=0<=(a=c-u)&&0<=s?{top:l,bottom:d,left:u,right:c,width:a,height:s}:null),!o)break;i=i&&h(i)}return o}},e.prototype._getRootRect=function(){var e,t;return t=this.root?f(this.root):(e=p.documentElement,t=p.body,{top:0,left:0,right:e.clientWidth||t.clientWidth,width:e.clientWidth||t.clientWidth,bottom:e.clientHeight||t.clientHeight,height:e.clientHeight||t.clientHeight}),this._expandRectByRootMargin(t)},e.prototype._expandRectByRootMargin=function(n){var e=this._rootMarginValues.map(function(e,t){return"px"==e.unit?e.value:e.value*(t%2?n.width:n.height)/100}),e={top:n.top-e[0],right:n.right+e[1],bottom:n.bottom+e[2],left:n.left-e[3]};return e.width=e.right-e.left,e.height=e.bottom-e.top,e},e.prototype._hasCrossedThreshold=function(e,t){var n=e&&e.isIntersecting?e.intersectionRatio||0:-1,o=t.isIntersecting?t.intersectionRatio||0:-1;if(n!==o)for(var i=0;i<this.thresholds.length;i++){var r=this.thresholds[i];if(r==n||r==o||r<n!=r<o)return!0}},e.prototype._rootIsInDom=function(){return!this.root||t(p,this.root)},e.prototype._rootContainsTarget=function(e){return t(this.root||p,e)&&(!this.root||this.root.ownerDocument==e.ownerDocument)},e.prototype._registerInstance=function(){n.indexOf(this)<0&&n.push(this)},e.prototype._unregisterInstance=function(){var e=n.indexOf(this);-1!=e&&n.splice(e,1)},window.IntersectionObserver=e,window.IntersectionObserverEntry=l))}(),function(){var n={},t="settings-user-id",o="settings-ads-manager",i=void 0;n.localStorageSupported=function(){if(void 0===i)try{i=!!window.localStorage&&(localStorage.setItem("test","test"),localStorage.removeItem("test"),!0)}catch(e){i=!1}return i},n.set=function(e,t){n.localStorageSupported()&&localStorage.setItem("ct."+e,t)},n.get=function(e){return n.localStorageSupported()?localStorage.getItem("ct."+e):null},n.setObj=function(e,t){return n.localStorageSupported()?t&&n.set(e,JSON.stringify(t)):t},n.getObj=function(t){t=this.get(t)||null;try{t=JSON.parse(t)}catch(e){t=null}return t},n.remove=function(e){n.localStorageSupported()&&localStorage.removeItem("ct."+e)},n.setUserId=function(e){n.set(t,e)},n.getUserId=function(){return n.get(t)},n.getAdsManager=function(){return n.getObj(o)||{}},n.setAdsManager=function(e){n.setObj(o,e)},n.updateAdsManagerType=function(e){var t=n.getObj(o)||{};t.pageType=e;e=window.Globals&&Globals.pageViewParams&&Globals.pageViewParams.content_id;e&&(t.contentId=e),n.setObj(o,t)},n.setProviderProps=function(e,t){return this.setObj("provider_"+e,t)},n.getProviderProps=function(e){return this.getObj("provider_"+e)},window.localStorageService=n}(),"serviceWorker"in navigator&&window.localStorageService.localStorageSupported()&&Globals.settings.service_worker&&(window.onload=function(){navigator.serviceWorker.register("/service-worker.js").then(function(e){e.update(),console.info("mgzUI - Service-worker registered")}).catch(function(e){console.error("Service-worker registration failed with "+e)})});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mgzUI=mgzUI||{kanalytics:{}};window._taboola=window._taboola||[];var XIAOMI_INTERACTION_ID_KEY="int_id";if(document.referrer)try{var referrer=new URL(document.referrer),journeyId=referrer.searchParams.get(XIAOMI_INTERACTION_ID_KEY);journeyId&&_taboola.push({overrideConfig:{trcForce:{jd:"v2_"+journeyId}}})}catch(e){}var noop=function(){},MIN_HEIGHT_TABOOLA_FEED=300,MIN_HEIGHT_TABOOLA_FEED_ITEM=60,taboolaProvider=_.result(Globals.settings.providers,"Taboola",{}),FALLBACK_TIME=1e3*(taboolaProvider.fallback_time||0);window&&window.addEventListener("beforeinstallprompt",function(e){e.preventDefault()}),window.performance&&"function"==typeof window.performance.mark&&window.performance.mark("tbl_ic"),Globals.performance={taboolaReadyFired:!1},Globals.performance.startTime=window.performance.getEntriesByType("navigation").pop().startTime;var attachScriptToHead=function(e,t,n,o){var i,r;i=document.createElement("script"),r=document.getElementsByTagName("script")[0],e=e,t=t,document.getElementById(t)||(i.defer=1,i.src=e,t&&(i.id=t),"function"==typeof n&&(i.onerror=n),"function"==typeof o&&(i.onload=o),r.parentNode.insertBefore(i,r))},getTrcForceParamMap=function(){var e=window.location.href.split("?")[1];if(e){e=e.match(/trcForce=([^&]+)/);if(e){var e=e[1],e=decodeURIComponent(e),i={};return e.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,t,n,o){i[t]=o}),i}}},appendMonetizationGroupPlacementSuffix=function(){var e=Globals.mg.toLowerCase();return"a"===e?"_HIGH_TIER":"b"===e?"_MID_TIER":""},getPlacementAndMode=function(e,o){var i=e.placement||"Below Article Thumbnails",r=e.mode||"thumbnails-a";if(taboolaProvider.taboola_loader_url_override&&(e.ad_blocker_fallback_placement||e.addBlockerFallbackMode)){var a=e.ad_blocker_fallback_placement||i,s=e.addBlockerFallbackMode||r;return window.dfpService.initDfpLoad(null,function(e,t){t&&o(a,s);var n="test-taboola-favico";return attachScriptToHead("https://cdn.taboola.com/favicon.ico",n,function(){document.getElementById(n).remove(),o(a,s)},function(){document.getElementById(n).remove(),o(i,r)})})}o(i,r)},getWidgetOptions=function(o,i){var e=mgzUI.extractParamsFromUrl(),r={};Globals.aid&&"CT_USERINFO_EAID"!==Globals.aid&&(r.device=Globals.aid);e=e.exp;e&&(r.exp=e);e=taboolaProvider.network_url||null;e&&(r.url=e),getPlacementAndMode(o,function(e,t){var n=window.location.pathname;o.page_type?"home"===r[o.page_type]?r[o.page_type]="auto":r[o.page_type]=n:e.toLocaleLowerCase().includes("homepage")||Globals.isFeedPage?r.home="auto":r.article=n;n=Globals.scoresPlacement;n&&(e=n),Globals.mg&&(e+=appendMonetizationGroupPlacementSuffix()),i(r,{mode:t,container:o.container,placement:e,target_type:"mix"})})},AbFire={hasTaboolaFired:!1,isInited:!1,que:[],sent:{},revenueEventsQueue:[],init:function(){this.isInited||(this.isInited=!0,window._taboola=window._taboola||[],_taboola.push({listenTo:"render",handler:function(){Globals.performance.taboolaReadyFired||(performanceModule.sendPerformanceEvent("taboola_feed"),Globals.performance.taboolaReadyFired=!0,Globals.performance.taboolaFeedLoadTime=(Math.round(performance.now()-Globals.performance.startTime)/1e3).toFixed(2),AbFire.sendBeaconAbEvent("mgz_page_load_feed_load",Globals.performance.taboolaFeedLoadTime)),AbFire.hasTaboolaFired||(AbFire.hasTaboolaFired=!0,AbFire.que.length&&AbFire.que.forEach(function(e){AbFire.sent[e.name]!==e.value&&(AbFire.sent[e.name]=e.value,console.debug("sendAbTestEvent :",e.name," - ",e.value),window.TRCImpl&&"function"==typeof TRCImpl.sendAbTestEvent?TRCImpl.sendAbTestEvent(e.name,e.value,noop,e.isBeacon):AbFire.sendBeaconAbEvent("abtest_event_failed",e.name),AbFire.sendBeaconAbEvent(e.name,e.value))}),AbFire.emptyRevenueEventsQueue(!1))}}),!AbFire.hasTaboolaFired&&AbFire.que.length&&setTimeout(function(){AbFire.que.forEach(function(e){AbFire.sent[e.name]!==e.value&&(AbFire.sent[e.name]=e.value,AbFire.sendBeaconAbEvent(e.name,e.value),AbFire.sendBeaconAbEvent("abtest_event_failed",e.name))}),AbFire.emptyRevenueEventsQueue(!0)},FALLBACK_TIME))},sendBeaconAbEvent:function(e,t){t="object"===(void 0===t?"undefined":_typeof(t))?JSON.stringify(t):t,console.debug("sendBeaconAbEvent:",e," - ",t),(new Image).src="//beacon.taboola.com/?type=mgz_box_event"+(Globals.dc_data?"&dc_data="+Globals.dc_data:"")+"&name="+e+"&value="+t+(Globals.settings.abColor?"&abColor="+Globals.settings.abColor:"")},sendAbEvent:function(e,t,n){"function"==typeof mgzUI.kanalytics.pushEventWithTime&&mgzUI.kanalytics.pushEventWithTime(t?e+"_"+t:e),this.isInited||this.init(),this.sent[e]!==t&&(this.hasTaboolaFired?(console.debug("sendAbTestEvent :",e," - ",t),window.TRCImpl&&"function"==typeof TRCImpl.sendAbTestEvent?TRCImpl.sendAbTestEvent(e,t,noop,n):AbFire.sendBeaconAbEvent("abtest_event_failed",e),AbFire.sendBeaconAbEvent(e,t)):this.que.push({name:e,value:t,isBeacon:n}))},sendRevenueEvent:function(e,t,n){n={adUnit:t,eventType:n};this.isInited||this.init(),this.hasTaboolaFired?(window.TRCImpl&&"function"==typeof TRCImpl.sendExternalRevenueEvent?(console.debug("SENDING REVENUE EVENT: ",e,JSON.stringify(n,null,2)),TRCImpl.sendExternalRevenueEvent(e,n)):AbFire.sendBeaconAbEvent("revenue_event_failed_ "+e,n.adUnit),AbFire.sendBeaconAbEvent("revenue_event_ "+e,n.adUnit)):this.revenueEventsQueue.push({name:e,eventData:n})},emptyRevenueEventsQueue:function(e){for(;this.revenueEventsQueue.length;){var t=this.revenueEventsQueue.shift();!e&&window.TRCImpl&&"function"==typeof TRCImpl.sendExternalRevenueEvent?TRCImpl.sendExternalRevenueEvent(t.name,t.eventData):AbFire.sendBeaconAbEvent("revenue_event_failed_ "+t.name,t.eventData.adUnit),AbFire.sendBeaconAbEvent("revenue_event_ "+t.name,t.eventData.adUnit)}}},getTrackingUTMSource=function(){return(Globals.video_partners||Globals.vendor||"tn_main_feed")+"___"+(Globals.pubId&&-1===Globals.pubId.indexOf("-network")?Globals.pubId:Globals.dc_data&&-1!==Globals.dc_data.indexOf("_")?Globals.dc_data.split("_")[1]:Globals.publisherId.replace("Taboola_",""))};function getPublisherId(){if(Globals.publisherId.toLowerCase().includes("magazine_from")||Globals.startPartnerId)return Globals.pubId;var e=Globals.publisherId,t="Taboola_";return-1!==e.indexOf(t)?e.substring(t.length):e}function overrideReportSourceUrl(){window._taboola.push({overrideConfig:{global:{"url-extract-order":["meta","og","canonical","paramUrl","location"]}}})}var mgzTaboola={loaded:!1,TRKJSLoaded:!1,loaderURL:taboolaProvider.taboola_loader_url_override||"//cdn.taboola.com/libtrc/${publisher}/loader.js",fallBack:function(e){this.loaded&&(this.loaded=!1,console.debug("mgzUI Taboolafallback:",e),(new Image).src="//beacon.taboola.com/?type=mgz_box_feed_fallback&reason="+e+(Globals.dc_data?"&dc_data="+Globals.dc_data:"")+(Globals.settings.abColor?"&abColor="+Globals.settings.abColor:""),e&&AbFire.sendAbEvent(e,!0),this.loadTRKJS())},loadPixelScript:function(){Globals.pixelAccountId&&(window._tfa=window._tfa||[],window._tfa.push({notify:"event",name:"page_view",id:Globals.pixelAccountId}),attachScriptToHead("//cdn.taboola.com/libtrc/"+Globals.pixelAccountId+"/tfa.js","tb_tfa_script"))},getLoaderUrl:function(e){return e=0<(e=e||this.loaderURL).indexOf("${publisher}")?e.replace("${publisher}",Globals.pubId):e},loadTRCLoaderScript:function(e,t){var n=this;this.loaded&&!e||(this.loaded=!0,t=this.getLoaderUrl(t),attachScriptToHead(t,"tb_loader_script",function(){console.info("Taboola script loading failed"),n.fallBack("Taboola_script_fallback")}),Globals.shouldFixSourceURL&&overrideReportSourceUrl(),this.loadPixelScript(),window.performance&&"function"==typeof window.performance.mark&&window.performance.mark("tbl_ic"))},setWidgetId:function(e){var t=document.querySelector(".taboola_feeds");t&&t.setAttribute("id",e)},loadTRKJS:function(){var e,t;this.TRKJSLoaded||(this.TRKJSLoaded=!0,(e=document.createElement("script")).type="text/javascript",e.defer=!0,t=getPublisherId(),e.src="https://cdn.taboola.com/libtrc/"+t+"/trk.js",(t=document.getElementsByTagName("script")[0]).parentNode.insertBefore(e,t))},initFeed:function(e){this.setWidgetId(Globals.taboolaFeed[e]&&Globals.taboolaFeed[e].container||"taboola-below-article-thumbnails"),console.log("taboola widget feed",e),_taboola.push({tracking_codes:{utm_campaign:getTrackingUTMSource()}}),window._taboola.push({mode:Globals.taboolaFeed[e].mode||"editorial-stream-a",container:Globals.taboolaFeed[e].container,placement:Globals.taboolaFeed[e].placement,target_type:"mix"}),window._taboola.push({home:"auto"}),AbFire.init(),Globals.settings.abColor&&AbFire.sendAbEvent("abColor",Globals.settings.abColor),_taboola.push({flush:!0}),_taboola.push({listenTo:"click",handler:function(){Globals.googleAnalyticsEvent("FeedClicks","ItemClick")}}),this.loadTRCLoaderScript(!0,taboolaLoaderUrl)},checkTaboolaRender:function(o,e,i){if(!FALLBACK_TIME||e)return i();var r=this,a=!1,s=5,l=void 0;_taboola.push({listenTo:"render",handler:function(e){var t,n=document.querySelector("#"+o);if((t=(t=n)||document.querySelector(".taboola_feeds"))&&t.clientHeight>MIN_HEIGHT_TABOOLA_FEED&&!a&&2<t.childNodes.length&&(t.childNodes[1].clientHeight>MIN_HEIGHT_TABOOLA_FEED_ITEM||t.childNodes[Math.round(t.childNodes.length/2)].clientHeight>MIN_HEIGHT_TABOOLA_FEED_ITEM))return console.debug("Taboola render no fallback"),i(),void(a=!0);if(l===n.clientHeight&&s<=0&&!a)return r.fallBack("Taboola_height_fallback"),void(a=!0);s--,l=n.clientHeight;e=e.detail?e.detail.placement:"na";"function"==typeof mgzUI.kanalytics.pushEventWithTime&&mgzUI.kanalytics.pushEventWithTime("RboxRendered",e)}})},defineWidget:function(r,a,s){var l=this;"function"==typeof a&&(s=a,a=!1),s=s||function(){},a||this.setWidgetId(r.container),this.loadTRCLoaderScript(),getWidgetOptions(r,function(e,t){console.log("taboola pushed widget with params:",t,e),_taboola.push({tracking_codes:{utm_campaign:getTrackingUTMSource()}});var n,o=getTrcForceParamMap();o&&_taboola.push({overrideConfig:{trcForce:o}}),AbFire.init(),Globals.abPev&&(n=isNaN(parseInt(Globals.abPev,10))?Globals.abPev:parseInt(Globals.abPev,10),AbFire.sendAbEvent(" samsung_abtest_1",n),_taboola.push({overrideConfig:{systemFlags:{experimentID:n}}}));var i=mgzUI.extractParamsFromUrl(),o=i.exId||null;Globals.exId=o||Globals.exId,Globals.exId&&(AbFire.sendAbEvent("experimentID",Globals.exId),_taboola.push({overrideConfig:{systemFlags:{experimentID:Globals.exId}}})),i.pev&&(Globals.externalPev=i.pev,_taboola.push({overrideConfig:{systemFlags:{experimentID:i.pev}}}));o=+i.latitude,i=+i.longitude;o&&i&&window._taboola.push({geo:{coordinates:{latitude:o,longitude:i}}}),_taboola.push(e),_taboola.push(t),Globals.settings.abColor&&AbFire.sendAbEvent("abColor",Globals.settings.abColor),l.checkTaboolaRender(r.container,a,function(){Globals.ct_client_version&&_taboola.push({additional_data:{sdkd:Globals.ct_client_version,app:"STARTER"}}),window.isArticlePage&&!a&&_taboola.push({listenTo:"render",handler:function(e){console.debug("taboola render added:  magazineSideDedupe"),mgzUI.magazineSideDedupe(e),n&&[].slice.call(e.detail.container.querySelectorAll("a")).forEach(function(e){var t=new URL(e.logger_url);t.searchParams.set("redir",t.searchParams.get("redir")+"&prev=variant-"+n),e.logger_url=t.toString()})}}),s()})})}};function loadHotjarScript(e){var t,n;t=window,n=document,t.hj=t.hj||function(){(t.hj.q=t.hj.q||[]).push(arguments)},t._hjSettings={hjid:e||Globals.settings.hotMapId,hjsv:6},e=n.getElementsByTagName("head")[0],(n=n.createElement("script")).async=1,n.src="//static.hotjar.com/c/hotjar-"+t._hjSettings.hjid+".js?sv="+t._hjSettings.hjsv,e.appendChild(n)}function loadAmpSdk(){!function(e,t){var n=e.amplitude||{_q:[],_iq:{}},o=t.createElement("script");o.type="text/javascript",o.async=!0,o.src="//d24n15hnbwhuhn.cloudfront.net/libs/amplitude-3.0.0-min.gz.js",o.onload=function(){e.amplitude.runQueuedFunctions()};t=t.getElementsByTagName("script")[0];function i(e,t){e.prototype[t]=function(){return this._q.push([t].concat(Array.prototype.slice.call(arguments,0))),this}}t.parentNode.insertBefore(o,t);for(var r=function(){return this._q=[],this},a=["add","append","clearAll","prepend","set","setOnce","unset"],s=0;s<a.length;s++)i(r,a[s]);n.Identify=r;for(var l=function(){return this._q=[],this},d=["setProductId","setQuantity","setPrice","setRevenueType","setEventProperties"],c=0;c<d.length;c++)i(l,d[c]);n.Revenue=l;var u=["init","logEvent","logRevenue","setUserId","setUserProperties","setOptOut","setVersionName","setDomain","setDeviceId","setGlobalUserProperties","identify","clearUserProperties","setGroup","logRevenueV2","regenerateDeviceId"];function p(t){for(var e=0;e<u.length;e++)!function(e){t[e]=function(){t._q.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(u[e])}p(n),n.getInstance=function(e){return e=(e&&0!==e.length?e:"$default_instance").toLowerCase(),n._iq.hasOwnProperty(e)||(n._iq[e]={_q:[]},p(n._iq[e])),n._iq[e]},e.amplitude=n}(window,document)}function loadGoogleAnalytics(e){var t,n,o;t=window,o=document,n="ga",t.GoogleAnalyticsObject=n,t.ga=t.ga||function(){(t.ga.q=t.ga.q||[]).push(arguments)},t.ga.l=+new Date,n=o.createElement("script"),o=o.getElementsByTagName("script")[0],n.async=1,n.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(n,o),ga("create",e,"auto")}!function(){var e={};e.getUrlParams=function(){var e=window.location.href.split("?")[1];void 0===(e=e&&e.split("#")[0])&&(e="");var i={};return decodeURIComponent(e).replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,t,n,o){i[t]=o}),i},e.generateUUID=function(){var n=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)})},e.initUser=function(){var e=this.generateUUID(),t=window.localStorageService.localStorageSupported(),n=t&&window.localStorageService.getUserId("userId");if(n){try{n=JSON.parse(n)}catch(e){}"unidentified_lean_user"!==n&&(e=n)}n=this.getUrlParams();if(n.userId&&n.userId!==e)"lean"!==n.userId&&"CT_USERINFO_SUID"!==n.userId&&"!{'$USER$'}"!==n.userId&&(e=n.userId);else if(!n.userId&&!t)return void(this.userId=e);t&&window.localStorageService.setUserId(e),this.userId=e},e.setContentProvidersLimit=function(){var t=this;t.providersLimits={};var e=_.result(Globals.settings,"content_providers",null);if(e)for(var n in e)t.providersLimits[n.toLowerCase()]=e[n];var o=_.result(Globals.settings.article,"content_providers",null);o&&o.length&&o.forEach(function(e){t.providersLimits[e.name.toLowerCase()]=e})},e.checkContentProviderLimitExceeded=function(e){e=e&&e.toLowerCase();var t=this.providersLimits[e];if(t){var n=Date.now(),o=location.pathname,i={},r={},a=(localStorageService.getProviderProps(e)||[]).filter(function(e){return r[e.path]=e.viewed,e.time>=n-864e5*(t.days||1)&&(i[e.path]=!0)});if(i[o]||r[o]||a.push({time:n,path:o}),localStorageService.setProviderProps(e,a),a.length>(t.cap||t.articles_daily_cap||0)){if(!r[o]){o=t.register_url;return o=0!==o.indexOf("http")?"//"+o:o}}else a[a.length-1].viewed=!0,localStorageService.setProviderProps(e,a)}return!1},e.initUser(),window.userService=e}(),function(){var e,n=mgzUI.extractParamsFromUrl(),o={};["appv","pwav","mg","geniev2","rccv","abv"].forEach(function(e){var t=n[e]||null;t&&(o[e]=t)}),0<Object.keys(o).length&&(e={sdkd:o},window._taboola=window._taboola||[],window._taboola.push({additional_data:e}),Object.assign(window.Globals,o))}(),function(){function l(){}function n(e){return void 0===e}function d(e){return n(t=e)||null==t||""==e||0===e.length;var t}function c(e,t){return d(e)?[""]:(""+e).split(t)}window.observe=function(t,e,n,o,i,r){var a,s;o=o||l,i=i||l,t&&(a={height:t.offsetTop,elementHeight:t.clientHeight,id:n,elem:t},"IntersectionObserver"in window?(s=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&(o(t,n),i(a),s.unobserve(t))})},{root:null,rootMargin:r||"0px",threshold:[e]})).observe(t):window.viewsHook?viewsHook.addHook(a,o,i):(o(t),i(a)))},window.Env={init:function(){this.type="browser",Globals.ct_client_version&&(e=parseFloat(Globals.ct_client_version),isNaN(e)?this.type="start":this.startVersion=Globals.ct_client_version);var e=(""+Globals.ct_client_type).toLowerCase();"sdk"!==e&&!this.compareVersions(this.getVersionFromSDK(),.1)||(this.type="sdk"),"start"!==e&&"lockscreen"!==e||(this.type="start"),Globals.mode&&(this.mode=Globals.mode),Globals.features.dont_send_analytics_observer&&(this.isdisableAnalyticsFromSettings=!0)},isNotification:function(){return"notification"===this.mode},isStart:function(){return"start"===this.type},isDisableAds:function(){return this.isChromeTab()&&this.isNotification()||Globals.features.dont_load_dfp_when_hidden&&document.hidden},enableAnalyticsFromSettings:function(){this.isdisableAnalyticsFromSettings=!1},isDisableAnalyticsFromSettings:function(){return this.isdisableAnalyticsFromSettings},isSDK:function(){return"sdk"===this.type},isBrowser:function(){return"browser"===this.type},isChromeTab:function(){if(!this.startVersion)return!1;var e=this.startVersion.split(".").join("")[0],e=Number(e);return!("start"===this.type&&5<=e)&&("start"===this.type&&-1<this.compareVersions(this.startVersion,"4.6.6")&&n(window.StartClientEventsBridge))},isFirstTime:function(){return this.firstTime},wasVersionChanged:function(){return this.previousVersion!==VERSION},getVersionFromSDK:function(){return window.MagazineSettings&&window.MagazineSettings.getSdkVersion?window.MagazineSettings.getSdkVersion():-1},compareVersions:function(e,t){if(d(e)&&d(t))return 0;if(d(e))return-1;if(d(t))return 1;var n=c(e,"."),o=c(t,"."),i=parseInt(n[0]),r=parseInt(o[0]),a=1<n.length?parseInt(n[1]):0,s=1<o.length?parseInt(o[1]):0,e=2<n.length?parseInt(n[2]):0,t=2<o.length?parseInt(o[2]):0,n=3<n.length?parseInt(n[3]):0,o=3<o.length?parseInt(o[3]):0;return r<i?1:i<r?-1:s<a?1:a<s?-1:t<e?1:e<t?-1:o<n?1:n<o?-1:0}},window.Env.init()}(),window.AdsABTestService=function(){function e(){this.init()}return e.prototype.init=function(){var e=0;Globals&&Globals.AB_TEST_COVERAGE&&""!==Globals.AB_TEST_COVERAGE&&(e=parseInt(Globals.AB_TEST_COVERAGE)),window.localStorageService.localStorageSupported()&&(this.testName=localStorageService.get("dfp-lite-ab-test-name"),null!==this.testName&&""!=this.testName||(this.testName=100*Math.random()>e?"a":"b",this.testName&&""!==this.testName&&localStorageService.set("dfp-lite-ab-test-name",this.testName)))},e.prototype.getTestName=function(){return this.testName},new e}(),window.dfpIdsToAdUnits=window.dfpIdsToAdUnits||{},window.firstAdReported=!1,window.firstAdRequested=!1,function(){function i(){}function p(){return(Globals.publisherId||"").toLowerCase().includes("starter")}var l=[],d=[],o=o||{ab:function(){return o.dool?"b":"a"+Math.floor(10*Math.random())},dc:function(){return o.dool?"d":"c"+Math.floor(20*Math.random())},mx:function(){return o.dool?"m"+Math.floor(180*Math.random()):"x"},tt:function(){return"tt"+Math.floor(10*Math.random())},dool:.1<=Math.random()},t=Env.isChromeTab()&&Env.isNotification(),r=!1,n=!1;window.addSingleDfpTag=function(e){t||window._dfpFailed||window.googletag.cmd.push(function(){c.enableServices(),c.display(l[e])})};var c=window.googletag||{};c.cmd=c.cmd||[],window.googletag=c,window.dfpDisplayTags=l,window._YB=o,window.dfpIdsToAdUnits=window.dfpIdsToAdUnits||{},window.dfpSlots=window.dfpSlots||{},window.renderedAds=[],window.dfpService={},window.dfpService.viewableAdsTimesStampMap={},window.dfpService.initDfpLoad=function(e,t){if(r&&!t)return e&&window.initDftTargeting(),!1;t=t||i,r=!0,mgzUI._dfpFailed=!1,Globals.pbEnabled&&(mgzUI.pbEnabled=!0,reportHbEnabled());var n=document.createElement("script");n.type="text/javascript",n.onerror=function(){console.log("Error loading google tag script"),mgzUI._dfpFailed=!0,t(n,!0)},n.async=!0,n.src="https://securepubads.g.doubleclick.net/tag/js/gpt.js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(n,o),e&&window.initDftTargeting(),n.onload=function(){mgzUI.gptFileLoaded=!0,t(n),mgzUI.pbEnabled?initHeaderBidding():window.gaid=getGAID()}},window.dfpService.addSlotTargeting=function(e,t){Globals.settings.ads.has_yb_abc?(n=Math.random()<=.9?o.ab():"c",e.setTargeting("yb_ab",n)):e.setTargeting("yb_ab",o.ab()),e.setTargeting("yb_dc",o.dc()),e.setTargeting("yb_mx",o.mx()),e.setTargeting("yb_tt",o.tt());var n=mgzUI.isAdLazyLoad&&!mgzUI.isAdSpecificLazyLoad;e.setTargeting("lazyload",t||n?"true":"false")},window.dfpService.defineSlot=function(t,n,o,e,i){var r,a,s;-1===d.indexOf(o)&&(d.push(o),Env.isDisableAds()||window._dfpFailed||(window.dfpIdsToAdUnits[o]=t,mgzUI.shouldYieldbirdDisplay&&!e?setTimeout(function(){window.Yieldbird=window.Yieldbird||{},window.Yieldbird.cmd=window.Yieldbird.cmd||[],window.Yieldbird.cmd.push(function(){var e=window.Yieldbird.defineSlot(o,n);e?e.setTargeting({k1:"v1",k2:"v2"}).render():console.error("Error on define YB slot ",t," id",o),l.push(o)})},100,!0):mgzUI.shouldUseDynamicAds||mgzUI.hbEnabled||mgzUI.pbEnabled||(e=n,336<=Math.max(document.documentElement.clientWidth,window.innerWidth||0)&&2<e.length&&Array.isArray(e)&&e.push([336,280]),c.cmd.push((r=t,a=e,s=o,function(){var e=c.defineSlot(r,a,s);e?(e.addService(c.pubads()),window.dfpService.addSlotTargeting(e,i),window.dfpSlots[s]=e):console.error("Error on define slot ",r," id",s),l.push(s)})))))},window.dfpService.removeADS=function(){for(var e=document.getElementsByClassName("cb-google-ad"),t=0;t<e.length;t++)e[t].style.display="none"},window.dfpService.removeBrokenADS=function(t,n){setTimeout(function(){var e=document.getElementsByClassName("cb-google-ad")||[];!window.renderedAds[n]&&e[t]&&(e[t].style.display="none")},5e3)},window.initDftTargeting=function(e){var c,t,u;n||(n=!0,t=(c=Globals.settings||{}).lean||{},mgzUI.isAdLazyLoad="boolean"==typeof e?e:t.ads&&t.ads.lazy_load_ads,Globals.features.dont_send_analytics_observer&&(mgzUI.isAdLazyLoad=!0),"boolean"==typeof(t=_.result(c,"providers.Taboola.dfp_lazy_load",void 0))&&(mgzUI.isAdLazyLoad=t),mgzUI.isAdSpecificLazyLoad=_.result(c,"providers.Taboola.specific_dfp_lazy_load.active",!1),mgzUI.isAdSpecificLazyLoad&&(mgzUI.lazyLoadRootMargin=_.result(c,"providers.Taboola.specific_dfp_lazy_load.root_margin","0px 0px 25% 0px")),Globals.isScoresPage&&(mgzUI.isAdSpecificLazyLoad=_.result(c,"sportScores.shouldLazyLoadAds",!1),mgzUI.lazyLoadRootMargin=_.result(c,"sportScores.lazyLoadAdsMargin","0px 0px 25% 0px")),(u=window.googletag||{}).cmd=u.cmd||[],u.cmd.push(function(){!mgzUI.isAdLazyLoad&&Globals.hbEnabled&&u.pubads().enableSingleRequest(),mgzUI.isAdLazyLoad&&!mgzUI.isAdSpecificLazyLoad&&(u.pubads().enableLazyLoad({fetchMarginPercent:10,renderMarginPercent:10,mobileScaling:1}),AbFire.sendAbEvent("lazy-load",!0)),mgzUI.shouldYieldbirdDisplay||u.enableServices(),window.GDPR&&GDPR.haveConsentApplied&&GDPR.nonPersonalAd&&u.pubads().setPrivacySettings({nonPersonalizedAds:!0})}),u.cmd.push(function(){try{var e=(e=p()?Globals.pubId:Globals.publisherId)||(Globals.publisherId||Globals.pubId);u.pubads().setTargeting("distribution-partner",c.dfp_partner&&c.dfp_partner.name||Globals.publisherId||""),u.pubads().setTargeting("ab-test",(s=Globals.abPev||c.abColor,l=e,d="",s&&0===s.indexOf("cnr")?s:(s&&(d+=(s=0===s.indexOf("mgz")?s.substr(3).replace("_v",""):s)+"_"),d+(l=0===l.indexOf("Taboola_")?l.substring(8,l.lastIndexOf("-")+3):l)))),u.pubads().setTargeting("isTopDomain",String(window.parent===window));[{key:"geniev2",name:"genie_l2_ab_test"},{key:"rccv",name:"rcc_ab_test"},{key:"abv",name:"deeptn_ab_test"}].forEach(function(e){Globals[e.key]&&u.pubads().setTargeting(e.name,Globals[e.key])});var t,n="function"==typeof mgzUI.getCampaignId&&mgzUI.getCampaignId();if(n&&u.pubads().setTargeting("campaign_id",n),Globals.appv&&(u.pubads().setTargeting("appv",Globals.appv),AbFire.sendAbEvent("appv",Globals.appv)),Globals.pwav&&(u.pubads().setTargeting("pwav",Globals.pwav),AbFire.sendAbEvent("pwav",Globals.pwav)),Globals.externalPev&&(t=Globals.externalPev.split(",")[0],u.pubads().setTargeting("ab-test-ext",t)),(Globals.video_partners||Globals.vendor&&1===Globals.vendor.split(",").length)&&u.pubads().setTargeting("content-partner",Globals.video_partners||Globals.vendor||""),(p()||Globals.startPartnerId)&&u.pubads().setTargeting("start-partner-id",Globals.startPartnerId||""),u.pubads().setTargeting("lazy",mgzUI.isAdLazyLoad?"true":"false"),u.pubads().setTargeting("clientType","lean"),Globals.category&&u.pubads().setTargeting("category",Globals.category),Globals.language&&u.pubads().setTargeting("language",Globals.language),(p()||Globals.starterName)&&u.pubads().setTargeting("starterName",Globals.starterName||"N/A"),Globals.variantId&&u.pubads().setTargeting("variantId",Globals.variantId),!Env)throw"no Env object";u.pubads().setTargeting("chrometab",""+Env.isChromeTab()),(p()||Env.startVersion)&&u.pubads().setTargeting("start-version",Env.startVersion+" "+Env.isChromeTab()),mgzUI.shouldYieldbirdDisplay&&u.pubads().setTargeting("partner_state","active"),u.pubads().setTargeting("yb_ff",""+Math.round(Math.random()));var o=new Date,i=o.getUTCHours()-8,r=o.getUTCMinutes(),a=o.getUTCDay();i<0&&(i=24+i,--a),a<0&&(a=7+a),u.pubads().setTargeting("yb_th",i.toString()),u.pubads().setTargeting("yb_tm",r.toString()),u.pubads().setTargeting("yb_wd",a.toString()),(Globals.isScoresPage||Globals.isWorldCupSkin)&&u.pubads().setTargeting("wc","true"),u.pubads().addEventListener("slotRenderEnded",function(e){var t=e.slot?e.slot.getAdUnitPath():"unknown",e=e.slot&&e.slot.getSlotElementId();console.warn("DFP slotRenderEnded adUnit:",t),performanceModule.sendPerformanceEvent("first_dfp",!0),window.renderedAds[e&&dfpIdsToAdUnits[e]||t]=!0;e=document.querySelector(".cb-google-ad-wrapper");mgzUI.shouldAddBorderToAd&&e&&(e.style.border="1px solid #CBCBCB"),window.dfpInterstitialSettings&&t===dfpInterstitialSettings.slotName&&Globals.isInterstitial&&console.warn("InterstitialAdManager::interstitialSlot RENDERED",t),AbFire.sendAbEvent("dfp_rendered",t),AbFire.sendRevenueEvent("dfp",t,"rendered")}),u.pubads().addEventListener("impressionViewable",function(e){e=e.slot?e.slot.getAdUnitPath():"unknown";window.dfpService.viewableAdsTimesStampMap[e]=performance.now(),window.dfpService.handleClickDelay(e),console.log("DFP impressionViewable adUnit:",e)}),u.pubads().addEventListener("slotOnload",function(e){e=e.slot?e.slot.getAdUnitPath():"unknown";console.log("DFP slotOnload adUnit:",e)})}catch(e){console.error(e)}var s,l,d}),u.cmd.push(function(){window.interstitialService&&interstitialService.adSlot&&(window.dfpService.addSlotTargeting(interstitialService.adSlot,!1),u.display(interstitialService.adSlot))}))},window.dfpService.displayAllDfpAds=function(){window.dfpIdsWasDisplaying=window.dfpIdsWasDisplaying||[],(Env.isDisableAds()||mgzUI._dfpFailed)&&(window.dfpService.removeADS(),console.log("ads disabled")),mgzUI.shouldUseDynamicAds||window.googletag.cmd.push(function(){if(c.enableServices(),!mgzUI.isAdLazyLoad)for(var e=0;e<l.length;e++){var t=l[e];-1===window.dfpIdsWasDisplaying.indexOf(t)&&(window.dfpIdsWasDisplaying.push(t),c.display(l[e]))}})},window.dfpService.displayAdById=function(t){Globals.shouldUpdateAD&&setInterval(function(){var e;mgzUI.blockAdRefresh||(mgzUI.shouldYieldbirdDisplay?window.Yieldbird.cmd.push(function(){window.Yieldbird.refresh(t)}):(e=window.dfpSlots[t],window.googletag.cmd.push(function(){c.pubads().refresh([e])})))},1e3*Number(Globals.shouldUpdateAD)),mgzUI.shouldYieldbirdDisplay||window.googletag.cmd.push(function(){Globals.video_partners&&window.dfpSlots[t].setTargeting("content-partner",Globals.video_partners),c.enableServices(),c.display(t)})},window.dfpService.handleClickDelay=function(e){var t,n,o=document.querySelector('[data-ad-unit="'+e+'"]')||document.querySelector("[id*='"+e+"']");!o||(t=o.getAttribute("data-click-delay")||o.parentElement.getAttribute("data-click-delay"))&&((n=o.firstChild).style.pointerEvents="none",o.addEventListener("touchstart",function(){window.dfpService.shouldBlockClick(t,e)?AbFire.sendAbEvent("ad-click-blocked",e):n.style.pointerEvents="auto"}))},window.dfpService.shouldBlockClick=function(e,t){return performance.now()-window.dfpService.viewableAdsTimesStampMap[t]<Number(e)}}();var pbjs=window.pbjs||{},googletag=window.googletag||{};googletag.cmd=googletag.cmd||[];var prebidLoadFailed=!1,DEFAULT_FALLBACK_TIMEOUT=3e3;function reportHbEnabled(){AbFire.sendAbEvent(mgzUI.prebidEvents.PREBID_ENABLED.abEvent,!0)}function initHeaderBidding(){_initPrebidVariables(),window.pbjs&&window.pbjs.libLoaded?googletag.cmd.push(function(){googletag.pubads().disableInitialLoad(),googletag.enableServices(),_attachPrebidEvents(pbjs)}):(AbFire.sendAbEvent(mgzUI.prebidEvents.PREBID_LOAD_FAILED.abEvent,!0),prebidLoadFailed=!0)}function definePrebidSlot(t,n,o){googletag.cmd.push(function(){var e=googletag.defineSlot(t,n,o).addService(googletag.pubads());if(e){if(prebidLoadFailed)return void callAdServer([e]);window.definedSlots.push(e),dfpDisplayTags.push(o),requestBids([window.hb.dfpIdsToSlots[o]=e])}e=_.result(Globals.settings,"providers.PB.timeout",DEFAULT_FALLBACK_TIMEOUT);setTimeout(function(){mgzUI.adServerCalled||(window.callAdServer(window.definedSlots),AbFire.sendAbEvent(mgzUI.prebidEvents.FAILSAFE_TIMEOUT_INVOKED.abEvent,!0))},e)})}function requestBids(e){prebidLoadFailed?callAdServer(e):pbjs.que.push(function(){pbjs.rp.requestBids({callback:callAdServer,gptSlotObjects:e})})}function callAdServer(o){window.googletag.cmd.push(function(){window.dfpIdsWasDisplaying=window.dfpIdsWasDisplaying||[];for(var e=[],t=0;t<o.length;t++){var n=o[t].getSlotElementId();window.isAdDisplaying(n)||(window.dfpIdsWasDisplaying.push(n),e.push(o[t]))}e.length&&window.googletag.pubads().refresh(e),mgzUI.adServerCalled=!0})}function applyGDPRSettings(){var e={consentManagement:{gdpr:{cmpApi:"static",rules:[{purpose:"storage",enforcePurpose:!0,enforceVendor:!0},{purpose:"basicAds",enforcePurpose:!0,enforceVendor:!0},{purpose:"measurement",enforcePurpose:!0,enforceVendor:!0}],consentData:{getTCData:{tcString:window.GDPR.nonPersonalAd?window.GDPR.consentDisabled:window.GDPR.consentEnabled,gdprApplies:window.GDPR.haveConsentApplied,purpose:window.GDPR.purpose,vendor:window.GDPR.vendor}}}}};pbjs.que.push(function(){pbjs.setConfig(e)})}function _initPrebidVariables(){(googletag=window.googletag||{}).cmd=googletag.cmd||[],(pbjs=window.pbjs||{}).rp=window.pbjs.rp||{},pbjs.rp.hasCustomCmp=!0,pbjs.que=window.pbjs.que||[],window.hb=window.hb||{},window.hb.dfpIdsToSlots=window.hb.dfpIdsToSlots||{},window.definedSlots=window.definedSlots||[],mgzUI.adServerCalled=!1,window.GDPR&&window.GDPR.haveConsentApplied&&window.pbjs&&applyGDPRSettings(),addUserGAIDToPbjsConfig(getGAID()),window.hb.prebidLazyLoad=function(e){var t=window.googletag||{};t.cmd=t.cmd||[];var n=window.hb.dfpIdsToSlots[e],o=window.isAdDisplaying(e);n&&!o&&t.cmd.push(function(){t.pubads().refresh([n]),window.dfpIdsWasDisplaying.push(e)})}}function getGAID(){var e=mgzUI.extractParamsFromUrl();if(e.aid)return e.aid}function addUserGAIDToPbjsConfig(e){var t;!e||window.GDPR&&window.GDPR.nonPersonalAd||(t={ortb2:{user:{id:e}}},pbjs.que.push(function(){pbjs.setConfig(t)}),pbjs.gaid=e,window.gaid=e)}function _attachPrebidEvents(e){try{e.onEvent("adRenderFailed",function(e){AbFire.sendAbEvent(mgzUI.prebidEvents.AD_RENDER_FAILED.abEvent,JSON.stringify({reason:e.reason,msg:e.message}))}),e.onEvent("bidWon",function(e){var t=e.adUnitCode,n=e.bidderCode,e=e.cpm;AbFire.sendAbEvent(mgzUI.prebidEvents.BID_WON.abEvent,JSON.stringify({adUnitCode:t,bidderCode:n,cpm:e})),console.log(n+" won the ad server auction for ad unit "+t+" at "+e+" CPM")})}catch(e){}}Globals.pbEnabled&&(mgzUI.prebidEvents={PREBID_LOAD_FAILED:{abEvent:"headerbidding_load_failed",event:"headerBiddingLoadFailed"},PREBID_ENABLED:{abEvent:"headerbidding_enabled",event:"headerBiddingEnabled"},BID_TIMEOUT:{abEvent:"bid_timeout",event:"bidTimeout"},AD_RENDER_FAILED:{abEvent:"prebid_ad_render_failed",event:"prebidAdRenderFailed"},BIDDER_ERROR:{abEvent:"bidder_error",event:"bidderError"},BID_WON:{abEvent:"bid_won",event:"bidWon"},EMPTY_AD_SLOT_AFTER_RENDER:{abEvent:"empty_ad_slot_after_render",event:"emptyAdSlotAfterRender"},FAILSAFE_TIMEOUT_INVOKED:{abEvent:"failsafe_timeout_invoked"}}),function(){var e={trackArticlePageView:function(e){window.ga&&(window.ga("send","pageview",{dimension1:Globals.publisherId||"None",dimension2:"lite",dimension3:window.Globals.theme||"None",dimension4:article?JSON.stringify(article.contentId):"",dimension5:article?JSON.stringify(article.contentSource):"",dimension6:e||"article",dimension7:Env.startVersion||"None",dimension8:Globals.startPartnerId||"",dimension9:Env.isNotification()?Env.type||"None":"no_notification",dimension10:Globals.starterName||"None"}),article&&null!==article.gaId&&""!==article.gaId&&"null"!==article.gaId&&(ga("create",article.gaId,"auto","extraTrackerForContent"),ga("extraTrackerForContent.send","pageview",{send_to:article.gaId,dimension1:Globals.publisherId||"None",dimension2:"lite",dimension3:window.Globals.theme||"None",dimension4:article?JSON.stringify(article.contentId):"",dimension5:article?JSON.stringify(article.contentSource):"",dimension6:"article",dimension7:Env.startVersion||"None",dimension8:Globals.startPartnerId,dimension9:Env.isNotification()?Env.type||"None":"no_notification",dimension10:Globals.starterName||"None"})))},trackPageView:function(e){window.ga&&ga("send","pageview",{dimension1:Globals.publisherId||"None",dimension2:"lite",dimension3:window.Globals.theme||"None",dimension6:e,dimension7:Env.startVersion||"None",dimension8:Globals.startPartnerId,dimension9:Env.isNotification()?Env.type||"None":"no_notification",dimension10:Globals.starterName||"None"})}};window.GA_service=e}();var epoch0=window.Date.now(),NO_METRIC_VALUE=-1,mgzUI=window.mgzUI||{};Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),o=n.length>>>0;if(0==o)return!1;for(var i,r,t=0|t,a=Math.max(0<=t?t:o-Math.abs(t),0);a<o;){if((i=n[a])===(r=e)||"number"==typeof i&&"number"==typeof r&&isNaN(i)&&isNaN(r))return!0;a++}return!1}}),String.prototype.includes||(String.prototype.includes=function(e,t){if(e instanceof RegExp)throw TypeError("first argument must not be a RegExp");return-1!==this.indexOf(e,t=void 0===t?0:t)}),console.table||(console.table=console.log),mgzUI.kanalytics={sendImmediateList:["error","canplaythrough"],dontPushStoryList:[],alwaysPushStoryList:["available","visible","json","notify-visible","notify-available"]},mgzUI.kanalytics.init=function(){var s,l,i,d,r;function a(){var e,t,n=performance.getEntries(),o=/([^\/]+)\/?$/;for(e in n){var i,r,a=n[e];a.name&&void 0!==a.responseEnd&&(s.analyticsLoaded===NO_METRIC_VALUE&&-1<a.name.indexOf("analytics.js")&&(s.analyticsLoaded=a.responseEnd||NO_METRIC_VALUE),s.hotjarLoaded===NO_METRIC_VALUE&&-1<a.name.indexOf("hotjar")&&(s.hotjarLoaded=a.responseEnd||NO_METRIC_VALUE),s.gptLoaded===NO_METRIC_VALUE&&-1<a.name.indexOf("gpt.js")&&(s.gptLoaded=a.responseEnd||NO_METRIC_VALUE),s.ybLoaded===NO_METRIC_VALUE&&-1<a.name.indexOf("yb.js")&&(s.ybLoaded=a.responseEnd||NO_METRIC_VALUE),s.implLoaded===NO_METRIC_VALUE&&-1<a.name.indexOf("impl.")&&(s.implLoaded=a.responseEnd||NO_METRIC_VALUE),s.loaderLoaded===NO_METRIC_VALUE&&-1<a.name.indexOf("loader.js")&&(s.loaderLoaded=a.responseEnd||NO_METRIC_VALUE),s.lightRBoxLoaded===NO_METRIC_VALUE&&-1<a.name.indexOf("engine")&&(s.lightRBoxLoaded=a.responseEnd||NO_METRIC_VALUE),s.firstImage===NO_METRIC_VALUE&&-1<a.name.indexOf("images.taboola.com")&&(s.firstImage=a.responseEnd||NO_METRIC_VALUE),!(-1<a.name.indexOf("api.taboola.com")||-1<a.name.indexOf("trc.taboola.com"))||(i=(i=null===(i=new URL(a.name).pathname.match(o))||void 0===i?void 0:i[1]).includes("recommendations.")?i.replace("recommendations.",""):i)&&("video"===a.initiatorType?l.mp4_url=a.name||NO_METRIC_VALUE:s[i]=a.responseEnd||NO_METRIC_VALUE,mgzUI.kanalytics.alwaysPushStoryList.includes(i)?(s[i]=a.responseEnd,r=i+"_"+s[i],mgzUI.onceFunc(r)&&(d=!0)):!i||s[i]!==NO_METRIC_VALUE&&s[i]||(s[i]=a.responseEnd||NO_METRIC_VALUE)))}return 0!==(t=window.performance&&window.performance.getEntriesByType("navigation")||[]).length&&(0<(t=t[0]).domContentLoadedEventEnd&&s.domContentLoaded===NO_METRIC_VALUE&&(s.domContentLoaded=t.domContentLoadedEventEnd),0<t.domComplete&&s.domComplete===NO_METRIC_VALUE&&(s.domComplete=t.domComplete),0<t.domInteractive&&s.domInteractive===NO_METRIC_VALUE&&(s.domInteractive=t.domInteractive),0<t.loadEventEnd&&s.loadEvent===NO_METRIC_VALUE&&(s.loadEvent=t.loadEventEnd)),s}function c(e,t){void 0===e&&(e={});var n="updateCounter",o=window,o={rbox_loaderType:o.TRCImpl&&o.TRCImpl.getSystemFlag?o.TRCImpl.getSystemFlag("loaderType"):"na",abtest:o.settings_override&&o.settings_override.abColor?o.settings_override.abColor:"na",t_userId:o.TRC?o.TRC.user_id:"na",_id:[Math.random(),Math.random(),Math.random()].map(function(e){return e.toString(36).substr(2)}).join("").substr(0,20),publisherName:function(){if(r)return r;var e=window;return r=e.taboolaMobile?e.taboolaMobile.getPublisherId()||"":(null===(e=e.TRC)||void 0===e?void 0:e.publisherId)||Globals.publisherId||""}(),timestamp:(new Date).toISOString(),event:"magazine",page_type:Globals.pageId},o=Object.assign(o,e,i,a(),l);d&&(o[n]=o.hasOwnProperty(n)?o[n]+1:0,d=!1,i=o,e="https://vidanalytics.taboola.com/putes/magazine",n=JSON.stringify(o),navigator.sendBeacon?navigator.sendBeacon(e,n):((o=new XMLHttpRequest).open("POST",e,!0),o.send(n))),window.setTimeout(c,5e3)}function e(e){e=["Message: "+e.message,"URL: "+e.filename,"Line: "+e.lineno,"Column: "+e.colno,"Error object: "+JSON.stringify(e.error)].join(" - ");mgzUI.kanalytics.pushEventWithTime("onError",JSON.stringify(e),!0)}window.performance&&performance.getEntries&&performance.getEntriesByType&&(s={hotjarLoaded:NO_METRIC_VALUE,analyticsLoaded:NO_METRIC_VALUE,gptLoaded:NO_METRIC_VALUE,ybLoaded:NO_METRIC_VALUE,implLoaded:NO_METRIC_VALUE,loaderLoaded:NO_METRIC_VALUE,lightRBoxLoaded:NO_METRIC_VALUE,available:NO_METRIC_VALUE,json:NO_METRIC_VALUE,visible:NO_METRIC_VALUE,firstImage:NO_METRIC_VALUE,"multiple-get":NO_METRIC_VALUE,"notify-available":NO_METRIC_VALUE,"notify-visible":NO_METRIC_VALUE,domContentLoaded:NO_METRIC_VALUE,domInteractive:NO_METRIC_VALUE,domComplete:NO_METRIC_VALUE,loadEvent:NO_METRIC_VALUE},l={},i={},d=!"magazine",r="",mgzUI.kanalytics.pushEventWithTime=function(e,t,n){n=n||mgzUI.kanalytics.sendImmediateList.includes(e),e.includes(mgzUI.kanalytics.dontPushStoryList)||(void 0!==t&&(l[e]=t),l[e+"_time"]=window.Date.now()-epoch0,d=!0,n&&c(null))},mgzUI.kanalytics.initializeEvents=function(e){(e||[]).forEach(function(e){l[e]=NO_METRIC_VALUE})},window.setTimeout(c,5e3),window.addEventListener("error",e),Globals.olb&&mgzUI.kanalytics.pushEventWithTime("olb","true"))},Globals.settings.kanalyticsPercentage>=Math.ceil(100*Math.random())&&(mgzUI.kanalytics.init(),mgzUI.kanalytics.pushEventWithTime("pageVisibility","visible"===document.visibilityState||NO_METRIC_VALUE),document.addEventListener("visibilitychange",function(){mgzUI.kanalytics.pushEventWithTime("pageVisibility","visible"===document.visibilityState||NO_METRIC_VALUE)})),function(){var e,n=_.result(Globals,"settings.analytics.send_performance_events",!1)&&window.performance&&"function"==typeof window.performance.now,o=window.performance,i=new Set,r=o.getEntriesByType("navigation")[0],s="first-contentful-paint",l="largest-contentful-paint";window.performanceModule={},n&&"androidObj"in window&&"PerformanceObserver"in window&&((e=new PerformanceObserver(function(e){var t=!0,n=!1,o=void 0;try{for(var i,r=e.getEntries()[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var a=i.value;"paint"===a.entryType&&a.name===s?u("fcp",0|a.startTime):a.entryType===l&&u("lcp",0|a.startTime)}}catch(e){n=!0,o=e}finally{try{!t&&r.return&&r.return()}finally{if(n)throw o}}})).observe({type:"paint",buffered:!0}),e.observe({type:"largest-contentful-paint",buffered:!0})),performanceModule.sendPerformanceEvent=function(e,t){!n||t&&i.has(e)||(t=0|o.now())&&(console.debug(e+" took "+t+" to load"),i.add(e),AbFire.sendAbEvent("pp_"+e+"_render_time",t,!0))},performanceModule.measureRequestTime=function(){var e,t;n&&(t=0|r.requestStart,e=0|r.responseEnd,AbFire.sendAbEvent("pp_request_to_response_time",e-t,!0),"androidObj"in window&&"function"==typeof window.androidObj.getClickTimeStamp&&((e=window.androidObj.getClickTimeStamp())&&(t=Math.round(o.timeOrigin),AbFire.sendAbEvent("api_click_to_app_start",t-e,!0))))};function t(e){var t=window.document.referrer;if(t)return new URL(t).searchParams.get(e)}var a,d,c,u=function(e,t){var n=o.timeOrigin||o.timing.navigationStart,n=o.now?o.now()+n:Date.now();window.androidObj.sendWebVitals(e,[n,t]),console.debug("The",e,"took",t,[n,t])};d=window.navigator&&"function"==typeof window.navigator.sendBeacon,c=o&&"number"==typeof o.timeOrigin,d&&c&&(a=Math.floor(window.performance.timeOrigin),d=+t("ts"),c=t("ui"),d=d&&!isNaN(d)?a-d:"null",c=function(e){var t,n=new URL("https://beacon.taboola.com/");for(t in e)n.searchParams.set(t,e[t]);return n.href}({appName:"mgz_"+((window.location.pathname||"").split("/")[1]||"unknown"),eventId:"TIME_FROM_CLICK_TO_APP_START",eventValue:d,appv:mgzUI.getParameterByName("appv")||"null",device_id:c||"null",aggregator:window.getPublisherId()}),window.navigator.sendBeacon(c))}();var _createClass=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ContentAPIService=function(){function e(){_classCallCheck(this,e),this.carouselConfig=window.Globals.settings&&window.Globals.settings.carousel&&window.Globals.settings.carousel.config?window.Globals.settings.carousel.config:{},this.isTestMode=this.carouselConfig.isTestMode,this.reelPlacements=this.carouselConfig.reelPlacements||[],this.DEFAULT_PUBLISHER_ID="xiaomi-lockscreen-unitedkingdom",this.API_URL_XIAOMI="https://api.taboola.com/2.0/json/{publisherId}/recommendations.get",this.API_URL_OPPO="https://api.taboola.com/2.0/json/oppo-lockscreen-in-en/recommendations.get",this.WC_CONFIG_PROD_URL="https://cdn.taboola.com/xiaomi-lockscreen/events/configurations.json",this.WC_CONFIG_QA_URL="https://cdn.taboola.com/xiaomi-lockscreen/qa/configurations.json",this.IS_XIAOMI=-1!==window.location.pathname.indexOf("/carousel"),this.tbBridge=window.tbBridge,this.isOnline=!0,this.API_URL=this.IS_XIAOMI?this.API_URL_XIAOMI:this.API_URL_OPPO,this.PLACEMENTS_NAME="Editorial Wallpaper Realtime ",this.PLACEMENTS_CACHE_NAME="Editorial Wallpaper Batch ",this.PLACEMENTS_SUFFIX=" PWA",this.USER_SESSION="",this.PLACEMENT={name:this.PLACEMENTS_NAME,recCount:1,organicType:"MIX",thumbnail:{width:Math.floor(window.screen.width*window.devicePixelRatio),height:Math.floor(window.screen.height*window.devicePixelRatio)}},this.EVENTLIST={NO_CONTENT:"not enough content",NOT_SUPPORTED:"NOT_SUPPORTED"},this.RAW_DATA={app:{type:"MOBILE",apiKey:this.IS_XIAOMI?"d252b025f9650cb732547685f44a658684fd8852":"699ed99a40e7ab4ef1701ea9c0d5104788ba4d93",origin:"CLIENT",name:"LockScreen",mobileData:{app:{id:"com.miui.android.fashiongallery",name:"Wallpaper Carousel"},device:{os:"Android"}},consent:{},acceptedCreatives:{thumbnailTypes:["image"]}},user:{agent:window.userAgent},source:{type:"HOME",id:"lockscreen",url:this.IS_XIAOMI?"https://xiaomi.com/lockscreen":"https://oppo.com/lockscreen"},view:{id:(this.IS_XIAOMI?"wallpaper_ec_pwa_":"wallpaper_ec_")+Math.floor((new Date).getTime())},placements:[]},this.CONTENT_REQUEST_BODY=this.RAW_DATA,this.WC_CONFIG_FALLBACK={event_name:"World Cup",start_date:"2022-11-28",end_date:"2022-12-20",template_url:"https://taboolanews.com/scores/homepage?utm_source=taboola&utm_medium=taboola_news&publisherId=Taboola_{aggregator-name}&key=Taboola&cex={consent}&appv={app-version}&aid={device-id}",grey_icon_url:"https://cdn.taboola.com/xiaomi-lockscreen/events/grey_icon.png",colored_icon_url:"https://cdn.taboola.com/xiaomi-lockscreen/events/colored_icon.png",icon_text:"QATAR 2022"},this.queryParamsKeysPassToRecommendations=this.carouselConfig.keysPassToRecommendations||["trc_"]}return _createClass(e,[{key:"getMatchingQueryParams",value:function(e){var t=window.location.search;return t?t.split("&").filter(function(t){return e.some(function(e){return-1!==t.indexOf(e)})}).join("&"):""}},{key:"getRequestBody",value:function(e,t,n){var o,i=JSON.parse(JSON.stringify(e)),r=mgzUI.extractParamsFromUrl();return r.expovid&&(i.view.variant=+r.expovid),t&&(i.view.id="wallpaper_ec_pwa"),this.tbBridge&&(o=window.tbBridge.getUserConsent2?window.tbBridge.getUserConsent2():window.tbBridge.getUserConsent?window.tbBridge.getUserConsent():"true",i.app.consent.exists=!this.IS_XIAOMI||"true"===o?"TRUE_CONSENT":"FALSE_CONSENT",i.user.device=this.tbBridge.getDeviceId?this.tbBridge.getDeviceId():"fallback_device_id",i.user.session=n,i.app.mobileData.app.id=this.tbBridge.getApplicationId?this.tbBridge.getApplicationId():"fallback_app_id",i.app.mobileData.app.name=this.tbBridge.getApplicationName?this.tbBridge.getApplicationName():"fallback_app_name",i.app.mobileData.device.version=this.tbBridge.getDeviceOsVersion?this.tbBridge.getDeviceOsVersion():"fallback_app_version",e=this.tbBridge.getApplicationVersion?this.tbBridge.getApplicationVersion():"fallback_app_version",r=this.tbBridge.getDeviceLanguage?this.tbBridge.getDeviceLanguage():"en",t=this.tbBridge.getDeviceModel?this.tbBridge.getDeviceModel():"Note 11",o=this.tbBridge.getNetworkType?this.tbBridge.getNetworkType():"WiFi",n=this.tbBridge.getDeviceLocale?this.tbBridge.getDeviceLocale():"English",e&&(i.app.mobileData.app.version=e),r&&(i.app.mobileData.device.ui=r),t&&(i.app.mobileData.device.model=t),o&&(i.app.mobileData.device.network=o),n&&(i.app.mobileData.device.locale=n),i.app.mobileData.app.pwa={version:window.parseVersionFromStr(window.Globals.version)}),i}},{key:"checkAndAddReelSuffix",value:function(e,t){return!e&&this.isTestMode&&this.reelPlacements.length&&this.reelPlacements.includes(t)?" Reel":""}},{key:"getContent",value:function(d,c,u,p){var g=this;return c=c||10,new Promise(function(t,o){"function"!=typeof fetch&&o(g.EVENTLIST.NOT_SUPPORTED);var e=window&&window.Globals&&window.Globals.publisherId?window.Globals.publisherId.split("_")[1]:"";g.agent=window.userAgent;var n=g.getMatchingQueryParams(g.queryParamsKeysPassToRecommendations);g.ContentAPIServiceUrl=g.API_URL.replace("{publisherId}",e||g.DEFAULT_PUBLISHER_ID)+n;e=new Headers;e.append("Content-Type","text/plain");for(var i=u?g.PLACEMENTS_CACHE_NAME:g.PLACEMENTS_NAME,r=[],a=0;a<c;a++){var s=(d+a+"").padStart(2,"0"),l=i+s+g.PLACEMENTS_SUFFIX+g.checkAndAddReelSuffix(u,s),s=JSON.parse(JSON.stringify(g.PLACEMENT));r.push(Object.assign(s,{name:l}))}g.CONTENT_REQUEST_BODY.placements=r;n=g.getRequestBody(g.CONTENT_REQUEST_BODY,u,p),n={method:"POST",headers:e,body:JSON.stringify(n)};return fetch(g.ContentAPIServiceUrl,n).then(function(e){return g.isOnline=!0,e.json()}).then(function(e){var n;e&&e.placements&&e.placements.length&&e.placements[0]&&e.placements[0].list?(n=[],e.placements.forEach(function(t){t.list.forEach(function(e){t.events&&(e.eventUrl=t.events.visible,e.mediaStartEvent=t.events.media_start,e.mediaStopEvent=t.events.media_stop),e.name&&120<e.name.length&&(e.name=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"...";return Boolean(t)?""+e.substring(0,t-n.length)+n:e}(e.name,120)),t.name&&(e.placementName=t.name)}),e.user&&e.user.session&&(g.USER_SESSION=e.user.session),n=n.concat(t.list)}),e.placements[0].list=n,t(e)):o(g.EVENTLIST.NO_CONTENT)}).catch(function(e){g.isOnline=!1,g.fetchError=!0,console.info("Carousel - APIService fetch error",e),o(new Error("APIService fetch error"))})})}},{key:"getWorldCupConfigs",value:function(){var o=this;return new Promise(function(e,t){"function"!=typeof fetch&&t(o.EVENTLIST.NOT_SUPPORTED);var n="QA"===(o.tbBridge.getApplicationVersion?o.tbBridge.getApplicationVersion():"fallback_version")?o.WC_CONFIG_QA_URL:o.WC_CONFIG_PROD_URL,t=new Headers;return t.append("Content-Type","text/plain"),fetch(n,{method:"GET",headers:t}).then(function(e){return e.json()}).then(e).catch(function(){return e(o.WC_CONFIG_FALLBACK)})})}}]),e}(),_slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,i=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){i=!0,r=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_createClass=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function openLinkWithTimestamp(e,t){t=t.target&&t.target.classList.contains("video-controls");e&&e.length&&!t&&(t=(new Date).getTime(),window.open(e+t,"_self"))}var ContentService=function(){function t(e){_classCallCheck(this,t),this.idbService=new IDbService,this.contentApiService=new ContentAPIService,this.options=e,this.carouselConfig=window.Globals.settings&&window.Globals.settings.carousel&&window.Globals.settings.carousel.config?window.Globals.settings.carousel.config:{},this.beaconKustoSessionId=Math.floor(Math.random()*Date.now())}return _createClass(t,[{key:"parseToStringStyle",value:function(e){var t,n="";for(t in e)e.hasOwnProperty(t)&&(n+=t+":"+e[t]+";");return n}},{key:"generateSlidesArray",value:function(e,t,n){var o=[],i=Math.floor(window.screen.height*window.devicePixelRatio),r=Math.floor(window.screen.width*window.devicePixelRatio);if(e&&e.length){var a=!0,s=!1,l=void 0;try{for(var d,c=e.entries()[Symbol.iterator]();!(a=(d=c.next()).done);a=!0){var u=_slicedToArray(d.value,2),p=u[0],g=u[1],m=t+p+1,f="reel"===g.mediaType&&!!g.reel,b=document.createElement("div");b.classList.add("swiper-slide"),b.dataset.rawId=g["raw-id"],b.dataset.eventUrl=g.eventUrl,f&&b.classList.add("video-slide");var h=f?this.createVideoBackgroundComponent(g,b,m):this.createImageBackgroundComponent(g,r,i),v=this.createSlideOverlayComponent(g,m,n,f);b.appendChild(h),b.appendChild(v),o.push(b)}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}return o}},{key:"createImageBackgroundComponent",value:function(e,t,n){var o=document.createElement("img");return o.classList.add("slide-bg"),o.src=e.thumbnail[0].url,o.alt="Image",o.width=t,o.height=n,o}},{key:"getInternetConnectionSpeed",value:function(){return window.navigator&&navigator.connection&&navigator.connection.downlink?+navigator.connection.downlink:null}},{key:"parseVideoUrls",value:function(e){var t,n,o=[];for(t in e)!e.hasOwnProperty(t)||"number"==typeof(n=Number(t))&&o.push({resolution:n,link:e[t]});return o.sort(function(e,t){return t.resolution-e.resolution})}},{key:"getSuitableVideoResolution",value:function(e){var t=this.carouselConfig.reelQualityMatrix||[{minSpeed:4,quality:720},{minSpeed:2.5,quality:540},{minSpeed:1.5,quality:480},{minSpeed:1,quality:360},{minSpeed:.01,quality:240}],e=this.parseVideoUrls(e),n=this.getInternetConnectionSpeed(),o=720;n&&(i=t.find(function(e){return n>=e.minSpeed}),o=i?i.quality:o);var i=e.find(function(e){return e.resolution<=o});return i&&i.link?i.link:e[0]&&e[0].link?e[0].link:""}},{key:"createVideoBackgroundComponent",value:function(e,t,n){var o=this,i=document.createElement("div");i.classList.add("video-container");var r=document.createElement("video");r.classList.add("slide-bg"),r.width=window.screen.width,r.height=window.screen.height,r.volume=0,r.loop=!0,r.preload="none",r.poster=e.thumbnail[0].url,e.mediaStopEvent&&(r.dataset.mediaStopEvent=e.mediaStopEvent),e.mediaStartEvent&&(r.dataset.mediaStartEvent=e.mediaStartEvent),r.oncanplaythrough=function(){r.classList.add("video-ready"),t.classList.add("video-ready")},r.onstalled=function(){o.sendBeaconEvent("stalled",n)};var a=document.createElement("source");return a.src=this.getSuitableVideoResolution(e.reel.urls),r.appendChild(a),i.appendChild(r),i}},{key:"createSlideOverlayComponent",value:function(e,t,n,o){var i=window.Globals.settings&&window.Globals.settings.carousel&&window.Globals.settings.carousel.styles?window.Globals.settings.carousel.styles:{},r=i.description?this.parseToStringStyle(i.description):"",a=i.branding?this.parseToStringStyle(i.branding):"",s=i.discoverButton?this.parseToStringStyle(i.discoverButton):"",l=i.slideLinks?this.parseToStringStyle(i.slideLinks):"",d=window.wcConfig||{},c=d.template_url&&window.Globals.settings&&window.Globals.settings.carousel&&window.Globals.settings.carousel.worldCup&&window.Globals.settings.carousel.worldCup.active,i=document.createElement("div");i.classList.add("slide-overlay");n="onclick=\"openLinkWithTimestamp('"+e.url+"&s_index="+t+"&int_id="+n+"&ts=', event)\"",s='<div class="slide-link" '+n+" style="+s+'>\n                <span class="link-text">'+e["cta-text"]+"</span>\n             </div>";return i.innerHTML='<div class="half-top"></div>\n            <div class="half-bottom">\n                <div class="slide-description" '+(e.url?n:"")+" style="+r+">\n                    <p>"+e.name+"</p>\n                    "+(o?'<div class="video-controls muted">\n                <div class="video-ctrl-btn video-unmute-btn">\n                    <svg width="27" height="20" viewBox="0 0 27 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n                        <path fill-rule="evenodd" clip-rule="evenodd" d="M12.6045 0.106317C12.4712 0.160027 10.9441 1.44263 9.211 2.9565L6.05987 5.70916L4.11198 5.70951C1.98061 5.70999 1.34238 5.83587 0.754817 6.37106C0.0372077 7.02486 0 7.20386 0 9.99724C0 12.4522 0.0115139 12.5773 0.279118 13.0361C0.590231 13.5693 1.14883 13.9939 1.76888 14.1686C1.99503 14.2323 3.05308 14.2845 4.12035 14.2845H6.06059L9.02956 16.9128C10.6625 18.3583 12.1622 19.6443 12.3621 19.7705C12.9259 20.1262 13.4408 20.0694 13.9698 19.5932L14.4225 19.1855V9.99724V0.80895L13.9698 0.401304C13.5107 -0.0120586 13.1123 -0.0980419 12.6045 0.106317ZM12.3015 10.0015V16.9132L9.61265 14.5567L6.92376 12.2004L4.55266 12.1409L2.18155 12.0813V9.99724V7.91316L4.55278 7.85361L6.924 7.79407L9.58247 5.4499C11.0446 4.16062 12.2546 3.10215 12.2712 3.09786C12.2878 3.09358 12.3015 6.20017 12.3015 10.0015ZM18.0411 5.82813C17.6787 5.97175 17.3918 6.4131 17.3918 6.82705C17.3918 7.11335 17.6482 7.43156 18.8095 8.58685L20.2271 9.99724L18.8095 11.4076C17.6294 12.5816 17.3918 12.8783 17.3918 13.1779C17.3918 13.9127 18.2387 14.4759 18.8693 14.1603C19.0233 14.0833 19.7355 13.451 20.4521 12.7551L21.755 11.4898L23.1184 12.8206C23.8897 13.5734 24.621 14.1845 24.8021 14.2277C25.4897 14.3913 26.259 13.6078 26.0529 12.9535C26.0049 12.8013 25.3622 12.0739 24.6245 11.337L23.2833 9.99724L24.6245 8.65747C25.3622 7.92066 26.0049 7.19314 26.0529 7.04094C26.259 6.38666 25.4897 5.60316 24.8021 5.76679C24.621 5.81002 23.8897 6.42108 23.1184 7.17385L21.755 8.50468L20.4521 7.23935C18.8576 5.69093 18.6674 5.5797 18.0411 5.82813Z" fill="white"/>\n                    </svg>\n                </div>\n                <div class="video-ctrl-btn video-mute-btn">\n                    <svg width="26" height="20" viewBox="0 0 26 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n                        <path fill-rule="evenodd" clip-rule="evenodd" d="M12.9069 0.127743C12.7709 0.202683 11.2369 1.48322 9.49797 2.97356L6.33615 5.68309L4.12093 5.72336C2.10139 5.76005 1.85912 5.78746 1.38037 6.03348C0.241307 6.61883 -0.0557275 7.5616 0.0081789 10.3894C0.0482286 12.1593 0.0767822 12.3636 0.360591 12.9109C0.690506 13.5469 1.22302 13.9648 1.95281 14.1601C2.1988 14.226 3.28026 14.2801 4.35604 14.2805L6.31205 14.2812L9.27214 16.8481C12.471 19.622 12.9691 20 13.4247 20C13.8787 20 14.4266 19.6783 14.6353 19.2891C14.9183 18.7618 14.9183 1.22242 14.6353 0.695096C14.3138 0.0958129 13.4683 -0.181787 12.9069 0.127743ZM20.8035 3.27047C20.4114 3.45692 20.1381 3.86701 20.1381 4.26887C20.1381 4.39123 20.5514 4.92534 21.0566 5.45576C22.4281 6.89547 22.9811 8.19912 22.9811 9.99209C22.9811 11.7593 22.4186 13.109 21.1189 14.4599C20.1859 15.4298 20.0319 15.7627 20.2826 16.2669C20.5235 16.7514 21.0233 16.9538 21.5584 16.7835C22.255 16.5619 23.6304 15.0363 24.2835 13.7609C25.5304 11.3256 25.5287 8.74682 24.2782 6.23388C23.6811 5.03388 22.36 3.52543 21.6587 3.24306C21.1805 3.05041 21.2725 3.04743 20.8035 3.27047ZM17.799 6.72629C17.2451 7.17546 17.2679 7.77009 17.865 8.45909C18.3988 9.07493 18.5312 9.37946 18.5312 9.99209C18.5312 10.6047 18.3988 10.9092 17.865 11.5251C17.2679 12.2141 17.2451 12.8087 17.799 13.2579C18.0082 13.4275 18.3001 13.5661 18.448 13.5659C19.4834 13.5642 20.7561 11.5997 20.7561 10.003C20.7561 9.37672 20.468 8.3278 20.1665 7.85683C19.6857 7.10564 18.8229 6.41783 18.3613 6.41783C18.2612 6.41783 18.0082 6.55663 17.799 6.72629Z" fill="white"/>\n                    </svg>\n                </div>\n            </div>':"")+'\n                </div>\n                <div class="slide-branding" style='+a+">\n                    <p>"+e.branding+'</p>\n                </div>\n                <div class="slide-links" style='+l+'>\n                    <a class="world-cup-container" href='+d.template_url+" style="+(c?"display:inline-flex":"display:none")+'>\n                        <img class="world-cup-icon" src='+d.colored_icon_url+' alt="WCIcon" />\n                        <div class="world-cup-text" style='+a+">"+d.icon_text+"</div>\n                    </a>\n                    "+(e.url?s:'<div class="slide-link-spacer"></div>')+"\n                </div>\n            </div>",i}},{key:"requestNewItems",value:function(n,o,i){var r=this;return new Promise(function(e,t){return r.contentApiService.getContent(n,o,i,r.options.userSession).then(e).catch(t)})}},{key:"getMediaBlob",value:function(o){return new Promise(function(t,n){var e=o.thumbnail[0].url;fetch(e).then(function(e){return e.blob()}).then(function(e){return t({id:o["raw-id"],src:e})}).catch(function(e){return n(e)})})}},{key:"uuid",value:function(){return([1e7]+1e3+4e3+8e3+1e11+2e3+7e3+2e11+5e3).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})}},{key:"populateWCConfigValues",value:function(e,t){var n=e;return e&&e.template_url&&(n.template_url=e.template_url.replace("{aggregator-name}",t).replace("{app-version}",window.tbBridge.getApplicationVersion?window.tbBridge.getApplicationVersion():"fallback_version").replace("{device-id}",window.tbBridge.getDeviceId?window.tbBridge.getDeviceId():"fallback_device_id").replace("{consent}",window.tbBridge.getUserConsent2?window.tbBridge.getUserConsent2():window.tbBridge.getUserConsent?window.tbBridge.getUserConsent():"true")),n}},{key:"sendVisibleEvent",value:function(e,t,n){var o;this.contentApiService.isOnline&&(o=(new Date).getTime(),fetch(e+("&s_index="+t+"&int_id="+n+"&ts="+o)).then(function(){return console.info("[Visibility event] sent")}))}},{key:"sendBeaconEvent",value:function(e,t){var n=(new Date).getTime(),n="//beacon.taboola.com/?type=mgz_box_event&name=reels_"+e+"&publisher="+(Globals.publisherId||"NotSet")+"&slideIndex="+t+"&timestamp="+n+"&session="+this.beaconKustoSessionId;console.log("[Beacon event]: ",e),(new Image).src=n}},{key:"clearExistingCache",value:function(e){var o=this,e=[{key:this.options.idbAppVersion,data:e},{key:this.options.idbUserSession,data:""},{key:this.options.idbItemsSlotNames.itemsSlot1,data:[]},{key:this.options.idbImgSourceById,data:{}}].map(function(n){return new Promise(function(e,t){return o.idbService.storeSetToName(n.key,n.data,e,t)})});return Promise.all(e)}},{key:"populateItemWithImgSource",value:function(n){var o=this;return new Promise(function(t,e){o.idbService.storeReadByNameAndKey(o.options.idbImgSourceById,n["raw-id"],function(e){e?n.thumbnail[0].url=URL.createObjectURL(new File([e],n.name,{type:"image/webp"})):console.info("No binary found for item",n),t(n)},e)})}},{key:"setItemsToCache",value:function(e){this.idbService.storeSetToName(this.options.idbItemsSlotNames.itemsSlot1,e)}},{key:"setUserSessionToCache",value:function(n,o,i){var r=this;this.options.userSession=n,this.idbService.storeGetByName("userSession",function(e){var t=e&&e.length?e[0].data:null;t&&t.userSession?(t.userSession=n,e=(new Date).getDate(),new Date(t.date).getDate()!==e&&(t.date=new Date),r.idbService.storeSetToName("userSession",t)):r.idbService.storeSetToName(r.options.idbUserSession,{userSession:n,date:new Date},o,i)})}},{key:"storeMediaBlobToCache",value:function(e){var t=this;e.forEach(function(e){t.idbService.storeAddByNameToKey(t.options.idbImgSourceById,e.id,e.src)})}},{key:"requestAndStoreBlobs",value:function(t,n,o,i){var r,a=this;t&&t.length&&n&&o?(r=t.shift(),this.getMediaBlob(r).then(function(e){n.push(e),n.length!==o&&t.length?a.requestAndStoreBlobs(t,n,o,i):(a.storeMediaBlobToCache(n),t.length?a.requestAndStoreBlobs(t,[],o,i):i&&i())}).catch(function(e){console.error("Error while getting media blob ",e," skip request of item: ",JSON.parse(JSON.stringify(r))),a.requestAndStoreBlobs(t,n,o,i)})):i?i():console.error("requestAndStoreBlobs callback is not defined")}},{key:"populateInitialCacheItems",value:function(e){var t=this.carouselConfig.batchDownloadSize||3,e=e&&e.placements?e.placements[0].list:[];this.options.placementNBatch=this.options.placementNBatch+e.length,e&&e.length&&(this.idbService.storeSetToName(this.options.idbItemsSlotNames.itemsSlot1,e),this.requestAndStoreBlobs(e,[],t,function(){return console.log("All blobs are stored")}))}},{key:"getItemsFromCache",value:function(){var n=this;return new Promise(function(e,t){return n.idbService.storeReadByName(n.options.idbItemsSlotNames.itemsSlot1,e,t)})}},{key:"getMediaFromCache",value:function(){var n=this;return new Promise(function(e,t){return n.idbService.storeReadByName(n.options.idbItemsSlotNames.mediaData,e,t)})}},{key:"getUserSession",value:function(){var n=this;return new Promise(function(t,e){return n.idbService.storeReadByName(n.options.idbUserSession,function(e){return t(e&&e.length?e[0].data:null)},e)})}},{key:"getContent",value:function(o){var i=this,t=o?this.options.placementNBatch:this.options.placementNRealtime,r=o?this.options.cacheInfo.slotCacheLimit:this.options.cacheInfo.slotItemsLimit;return new Promise(function(n,e){return i.contentApiService.getContent(t,r,o,i.options.userSession).then(function(e){var t=(new Date).getDate(),t=!i.options.userSessionDate||new Date(i.options.userSessionDate).getDate()!==t;e&&e.user&&e.user.session&&(t||i.options.userSession!==e.user.session)&&i.setUserSessionToCache(e.user.session),o&&setTimeout(function(){return i.populateInitialCacheItems(e)},300),n(e)}).catch(e)})}},{key:"initUserDb",value:function(e,n,o){var i=this;this.idbService.initUniqUserDb(e,async function(){i.idbService.storeGetByName(i.options.idbAppVersion,function(e){var t=window.Globals.version;(e&&e.length?e[0].data:null)!==t?i.clearExistingCache(t).then(n).catch(o):n()})},function(e){console.log("initUniqUserDb error: ",e),o(e)})}},{key:"initialConfigAndFetch",value:function(n,c){var u=this;return new Promise(function(s,l){var d=u.carouselConfig.nFromCacheOnLoad||3,e=u.contentApiService.getWorldCupConfigs(),t=new Promise(function(t,e){u.initUserDb(n,function(){Promise.all([u.getUserSession(),u.getItemsFromCache()]).then(function(e){return t({sessionData:e[0],cacheItems:e[1]})}).catch(e)},e)});Promise.all([t,e]).then(function(e){var t=e[0].sessionData,n=e[0].cacheItems,o=e[1],i=n&&n[0]&&n[0].data&&n[0].data.length;u.options.userSession=t.userSession||"init",u.options.userSessionDate=t.date,u.options.placementNRealtime=1;var r=new Date,e=r.getDate(),n=r.getHours(),t=u.options.userSessionDate?new Date(u.options.userSessionDate):r,r=t.getDate(),t=t.getHours(),t=!u.options.userSessionDate||r!==e||t+8<=n,n=window.Globals.publisherId.replace("Taboola_",""),a=!i||t;window.wcConfig=u.populateWCConfigValues(o,n),c&&c(d),u.getContent(a).then(function(e){a?(a=!1,u.getContent(a).then(s).catch(l)):s(e)}).catch(l)}).catch(function(e){c&&c(d),l(e)})})}},{key:"populateListWithImgSrc",value:function(e){var t=this;return Promise.all(e.map(async function(e){return t.populateItemWithImgSource(e)}))}}]),t}(),_createClass=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var IDbService=function(){function e(){_classCallCheck(this,e),this.dbAvailable=!1,this.idbOk=!1,this.dbPromise=null}return _createClass(e,[{key:"clearStoreIdFor",value:function(e,t,n){var o,i=e&&e.ids?e.ids:[],e=e.name,r={done:!1,message:"",event:{}};this.db&&e?((o=this.db.transaction(e,"readwrite").objectStore(e)).onsuccess=t,o.onerror=function(e){n&&(r.done=!1,r.event=e,r.message="IndexedDB - delete by name and storeId error.",n(r))},i.forEach(function(e){return o.delete(e)}),t()):n&&(r.done=!1,r.message="IndexedDB - delete by name and storeId event can't be done due to invalid name {".concat(e,"} or DB connection."),n(r))}},{key:"initUniqUserDb",value:function(e,t,n){var o,i=this,r={done:!1,message:"",event:{}};this.iDbCheck(),this.idbOk?(o=window.indexedDB,this.dbPromise=o.open(e,1),this.dbPromise.onerror=function(e){n&&(r.event=e,r.message="IndexedDB - open error",n(r))},this.dbPromise.onsuccess=function(e){e&&e.target&&e.target.result&&(i.dbAvailable=!0,i.db=e.target.result,i.db.onerror=i.dbOnError,i.db.objectStoreNames&&i.db.objectStoreNames.length&&t&&(r.done=!0,r.event=e,r.message="IndexedDB - open success",t(r)))},this.dbPromise.onupgradeneeded=function(e){return i.dbInitPopulate(e,function(){},n)}):n&&(r.message="IndexedDB - NOT supported",n(r))}},{key:"storeGetByName",value:function(e,t,n){var o;this.db&&this.dbAvailable&&(o=[],(e=this.db.transaction([e],"readwrite").objectStore(e).openCursor()).onsuccess=function(e){e&&e.target&&e.target.result?(e=e.target.result)&&(o.push(e.value),e.continue()):t&&t(o)},e.onerror=function(e){e&&e.target&&e.target.result&&(n?n(e):console.log("storeGetByName error",e))})}},{key:"storeReadByName",value:function(e,t,n){var o=this.db.transaction(e,"readonly"),e=o.objectStore(e).getAll();e.onsuccess=function(e){e=e.target.result;if(e)return t(e),o.complete},e.onerror=n}},{key:"storeReadByNameAndKey",value:function(e,t,n,o){this.db.transaction(e,"readonly").objectStore(e).get(t).onsuccess=function(e){e=e.target;e&&e.result&&e.result.data?n(e.result.data):o()}}},{key:"storeAddByNameToKey",value:function(e,t,n){this.db&&this.dbAvailable&&this.db.transaction([e],"readwrite").objectStore(e).add({storeId:t,entityTitle:e,entityType:e,data:n})}},{key:"storeAddByName",value:function(t,n,o){var i=this;this.db&&this.dbAvailable&&this.storeReadByName(t,function(e){e&&e[0]&&e[0].data&&(e=e[0].data,o&&"string"==typeof o?(e=e||{})[o]=n:(e=e||[]).push(n),i.clearAndAddNew(t,e))},function(){})}},{key:"clearAndAddNew",value:function(t,n){var o=this;this.storeGetByName(t,function(e){e&&e.length&&o.clearStoreIdFor({ids:e.map(function(e){return e.storeId}),name:t},function(){o.db.transaction([t],"readwrite").objectStore(t).add({storeId:(new Date).getTime(),entityTitle:t,entityType:t,data:n})},function(e){console.log("clearByName "+t+" error",e)})},function(e){console.log("clearAndAddNew ".concat(t," error"),e)})}},{key:"storeSetToName",value:function(t,n,o,i){var r,e,a=this,s={done:!1,message:"",event:{}};this.db?((e=(r=this.db.transaction([t],"readwrite").objectStore(t)).openCursor()).onsuccess=function(e){e&&e.target&&e.target.result?a.clearAndAddNew(t,n):r.add({storeId:(new Date).getTime(),entityTitle:t,entityType:t,data:n}),o&&(s.done=!0,s.event=e,o(s))},e.onerror=function(e){e&&e.target&&e.target.result&&i&&(s.done=!1,s.event=e,s.message="Store read error.",i(e))}):(s.done=!1,s.message="Indexed DB connection not initiated.",i?i():console.log("storeSetToName error idb not initiated yet"))}},{key:"iDbCheck",value:function(){this.idbOk="indexedDB"in window,this.idbOk?console.log("IndexedDB supported -",this.idbOk):console.log("IndexedDB - NOT supported")}},{key:"createObjStoreFor",value:function(t,n){this.db&&t.name&&(this.db.createObjectStore(t.name,t.keyPath?{keyPath:t.keyPath}:{}).transaction.oncomplete=function(e){n({done:!0,event:e,message:"Create obj store for ".concat(t.name," - Ok")})})}},{key:"dbOnError",value:function(e){e&&e.target&&e.target.errorCode&&console.log("IDB error: ".concat(e.target.errorCode))}},{key:"dbInitPopulate",value:function(e,t,n){var o=this,i={done:!1,message:"",event:{}};e&&e.target&&e.target.result?(this.dbAvailable=!0,this.db=e.target.result,this.db.onerror=this.dbOnError,[{name:"itemsSlot1",keyPath:"storeId"},{name:"contentImages",keyPath:"storeId"},{name:"contentVideos",keyPath:"storeId"},{name:"mediaData",keyPath:"storeId"},{name:"appVersion",keyPath:"storeId"},{name:"userSession",keyPath:"storeId"}].forEach(function(e){return o.createObjStoreFor(e,t)})):(i.event=e,i.message="IndexedDB - onupgradeneeded target result is not defined",n(i))}}]),e}(),_createClass=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var VideoService=function(){function e(){_classCallCheck(this,e),this.VIDEO_MUTED_CLASS="muted",this.VIDEO_READY_CLASS="video-ready",this.VIDEO_ACTIVE_CLASS="video-active",this.videoMuted=!0}return _createClass(e,[{key:"getVideoElementFromSlide",value:function(e,t,n){t=e.slides[e.realIndex+t];if(t&&t.classList.contains("video-slide"))return t.querySelector(n)}},{key:"setVideoSound",value:function(e){var t=this,n=this.getVideoElementFromSlide(e,0,"video.slide-bg"),o=this.getVideoElementFromSlide(e,0,".video-controls");n&&o&&(o.onclick=null,o.onclick=function(e){e.preventDefault(),n.volume?(n.volume=0,o.classList.add(t.VIDEO_MUTED_CLASS),t.videoMuted=!0):(n.volume=1,o.classList.remove(t.VIDEO_MUTED_CLASS),t.videoMuted=!1)},this.videoMuted?(n.volume&&(n.volume=0),o.classList.add(this.VIDEO_MUTED_CLASS)):(n.volume||(n.volume=1),o.classList.remove(this.VIDEO_MUTED_CLASS)))}},{key:"playSlideVideo",value:function(e,t){var n,o,i=this,r=e.slides[e.realIndex],a=this.getVideoElementFromSlide(e,0,"video.slide-bg"),s=e.realIndex+1;a&&(a.classList.add(this.VIDEO_ACTIVE_CLASS),n=a.dataset.mediaStartEvent,o=function(){a.paused&&a.classList.contains(i.VIDEO_ACTIVE_CLASS)&&a.play().then(function(){a.classList.contains(i.VIDEO_ACTIVE_CLASS)?(n&&i.sendVideoEvent(n,s,contentStatistics.uuid,"media_start"),t("media_start",s)):a.pause()}).catch(function(){t("media_blocked",s)})},a.classList.contains(this.VIDEO_READY_CLASS)?o():(a.oncanplaythrough=null,a.oncanplaythrough=function(e){a.classList.add(i.VIDEO_READY_CLASS),r.classList.add(i.VIDEO_READY_CLASS),a.oncanplaythrough=null,a.classList.contains(i.VIDEO_ACTIVE_CLASS)&&o()}))}},{key:"pauseVideo",value:function(e,t){var n=this.getVideoElementFromSlide(e,0,"video.slide-bg"),e=e.realIndex+1;n&&!n.paused&&(n.pause(),n.paused&&((n=n.dataset.mediaStopEvent)&&this.sendVideoEvent(n,e,contentStatistics.uuid,"media_stop"),t("media_stop",e)))}},{key:"resetVideoProgress",value:function(e,t){var n=this.getVideoElementFromSlide(e,t,"video.slide-bg");n&&"none"!==n.preload&&(n.classList.remove(this.VIDEO_ACTIVE_CLASS),n.pause(),n.volume=0,setTimeout(function(){n.currentTime&&0!==n.currentTime&&(n.currentTime=0)},200))}},{key:"startLoadVideo",value:function(e,t){t=this.getVideoElementFromSlide(e,t,"video.slide-bg");t&&"none"===t.preload&&(t.preload="auto")}},{key:"sendVideoEvent",value:function(e,t,n,o){var i=(new Date).getTime();fetch(e+("&s_index="+t+"&int_id="+n+"&ts="+i)).then(function(){console.info("[Reel event] sent: "+o+". Slide Index: "+t+".")})}}]),e}();function initGlobals(){window.mgzUI=window.mgzUI||{},window.setGlobals||(window.setGlobals=function(e,t){t&&e&&"string"==typeof e&&(window[e]=t)},setGlobals("Globals",window.globs?JSON.stringify(window.globs):{}),Globals.settings=Globals.settings||{},Globals.features=Globals.features||{}),window.tbBridge||(window.tbBridge={getBridgeVersion:function(){return 4},getApplicationId:function(){return"com.miui.android.fashiongallery"},getApplicationName:function(){return"Wallpaper Carousel"},getApplicationVersion:function(){return"QA"},getDeviceLanguage:function(){return"AU"},getDeviceModel:function(){return"Redmi Note 9T"},getDeviceOsVersion:function(){return"11"},getUserConsent:function(){return!0},getUserConsent2:function(){return"true"},getDeviceId:function(){return"d6ff211233e3371cafe0620588eb6adced4a19e204ef65425a5172bb7"+(new Date).getMinutes()+(new Date).getSeconds()},getNetworkType:function(){return"Wifi"},getDeviceLocale:function(){return"English (Australia)"},getItemOnLockScreenId:function(){return"-randomMockItemIdHere"},getInteractionId:function(){return""},getSession:function(){return"v2_258acc17222a8a8b8d99a4e66c2a2783_d6ff211233e3371cafe0620588eb6adced4a19e204ef65425a5172bb7b1c93ed_1657690383_1657694627_CIi3jgYQyMhUGLWSorajnYqElgEgDygFMGY4iOsKQLCQEEjO0tgDUP___________wFYAGAEaKL4zOXk1bnWbXAA"},setElementsVisibility:function(e){return console.log("[setElementsVisibility]:",e),function(){}},isElementsVisible:function(){return!0},setFullscreenPage:function(e){return console.log("[setFullscreenPage]:",e),function(){}},isFullscreenPage:function(){return!0},showNoConnectionScreen:function(){return console.log("[showNoConnectionScreen]"),function(){}},setWebAppVersion:function(e){return console.log("[setWebAppVersion]:",e),function(){}}})}function parseVersionFromStr(e){return e&&e.length?e.split(" ")[0]:e}initGlobals();