!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(self,(()=>(()=>{"use strict";var e,t,n,i={r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};i.r(r),function(e){e.HORIZONTAL="HORIZONTAL",e.RECTANGLE="RECTANGLE",e.VERTICAL="VERTICAL",e.MOBILE="MOBILE",e.MOBILE_BIG="MOBILE_BIG",e.MOBILE_HORIZONTAL="MOBILE_HORIZONTAL",e.PORTRAIT="PORTRAIT",e.BILLBOARD="BILLBOARD"}(e||(e={})),function(e){e[e.Unknown=0]="Unknown",e[e.Ethernet=1]="Ethernet",e[e.WIFI=2]="WIFI",e[e.CellularNetworkUnknownGeneration=3]="CellularNetworkUnknownGeneration",e[e.CellularNetwork2G=4]="CellularNetwork2G",e[e.CellularNetwork3G=5]="CellularNetwork3G",e[e.CellularNetwork4G=6]="CellularNetwork4G",e[e.CellularNetwork5G=7]="CellularNetwork5G"}(t||(t={}));var o,a=((n={})[e.HORIZONTAL]=[[970,90],[728,90],[468,60],[234,60]],n[e.RECTANGLE]=[[336,280],[300,250],[250,250],[200,200],[180,150],[125,125]],n[e.VERTICAL]=[[300,600],[160,600],[120,600],[120,240]],n[e.MOBILE]=[[320,50]],n[e.MOBILE_BIG]=[[320,100],[320,50]],n[e.MOBILE_HORIZONTAL]=[[970,90],[728,90],[468,60],[320,100],[320,50],[234,60]],n[e.PORTRAIT]=[[300,1050]],n[e.BILLBOARD]=[[970,250]],n["300x600"]=[[300,600],[160,600]],n["336x280"]=[[336,280],[300,250]],n["728x90"]=[[728,90],[468,60]],n["970x90"]=[[970,90],[728,90],[468,60]],n),s="ana-api-key",c="056363cfdcfcf7de5cea11820138b4d2daf3ca",d="https://ads.assemblyexchange.com",l="lib_version",u="web_".concat("3.1.1"),h="publisher_version",p="web_0.0.1",f="ana_client_uid",g="ana_client_session_id",y="ana_vast",v="ana_staging",m="https://securepubads.g.doubleclick.net/tag/js/gpt.js",b="//c.amazon-adsystem.com/aax2/apstag.js",w=[new RegExp("^https://js.media-lab.ai$"),new RegExp("^https://apps.media-lab.ai$"),new RegExp("^https://ads.assemblyexchange.com$"),new RegExp("^https://staging.apps.media-lab.ai$"),new RegExp("^https://tpc.googlesyndication.com$"),new RegExp("^https?://ana-sdk-creative.s3-website-us-west-2.amazonaws.com$"),new RegExp("^https://\\w+.safeframe.googlesyndication.com$"),new RegExp("^https?://localhost:9000$"),new RegExp("^https?://127.0.0.1:9000$")],E=[new RegExp("^https://js.media-lab.ai$"),new RegExp("^https://apps.media-lab.ai$"),new RegExp("^https://ads.assemblyexchange.com$"),new RegExp("^https://staging.apps.media-lab.ai$"),new RegExp("^https?://localhost:2279$"),new RegExp("^https?://127.0.0.1:2279$")],T=417,A="frequency_cap",I="cs_",S="AssemblyBidderSyncState",D=2500,_=500,P=4,k="_lr_env",R="rtisCalled",O=function(){return O=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},O.apply(this,arguments)},C=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))},M=function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},B=function(){var e=null;if(window.XMLHttpRequest?e=new XMLHttpRequest:window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLHTTP")),!e)throw Error("Cannot create an XMLHttpRequest instance");return e},L=function(e){e.withCredentials=!0,e.setRequestHeader("Content-Type","application/json"),e.setRequestHeader(s,c),e.setRequestHeader(l,u),e.setRequestHeader(h,p)},N=function(e,t){void 0===t&&(t={});var n,i,r=new URL(e);return t&&"{}"!==JSON.stringify(t)?(void 0!==r.searchParams?Object.keys(t).forEach((function(e){return r.searchParams.append(e,String(t[e]))})):r.href+="?"+(n=t,i=[],Object.keys(n).forEach((function(e){i.push(encodeURIComponent(e)+"="+encodeURIComponent(n[e]))})),i.join("&")),r):r};function x(e){return function(){this.readyState===XMLHttpRequest.DONE&&e&&e(this)}}function U(e){return function(){0!==this.status&&console.error("Error occurred while HTTP request"),e&&e(this)}}var j=function(e,t,n,i,r){void 0===t&&(t={}),void 0===n&&(n=null);var o=B();o.onreadystatechange=x(i),o.onerror=U(r);var a=N(e,t);o.open("POST",a.toString()),L(o),o.send(n?JSON.stringify(n):null)},V=((o={"Content-Type":"application/json"})["ana-api-key"]=c,o.lib_version=u,o.publisher_version=p,o),F=function(e){var t=e.url,n=e.params,i=void 0===n?{}:n,r=e.headers,o=void 0===r?{}:r,a=e.body,s=void 0===a?null:a;return C(void 0,void 0,void 0,(function(){return M(this,(function(e){try{return[2,fetch(N(t,i).toString(),{body:JSON.stringify(s),credentials:"include",headers:O(O({},V),o),method:"POST"})]}catch(e){throw new Error(e)}return[2]}))}))},G=function(e){var t=e.url,n=e.params,i=void 0===n?{}:n,r=e.headers;return C(void 0,void 0,void 0,(function(){return M(this,(function(e){try{return[2,fetch(N(t,i).toString(),{credentials:"include",headers:O(O({},V),r),method:"GET"})]}catch(e){throw new Error(e)}return[2]}))}))},q=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},W=function(e){return e.map((function(e){var t=e.toCustomJSON();return t.creative="",t.impression_pixels=[],t.view_pixels=[],t.click_pixels=[],t}))};function H(){return window.ANAWebSDKInstance}function z(){var e=H();if(e)return e.propertyId;var t=window.ANAWebPropertyId;return t||window.location.hostname}function J(e){try{var t=e(),n="__random_key__",i="__random_val__";return t.setItem(n,i),t.getItem(n)!==i?!1:(t.removeItem(n),!0)}catch(e){return!1}}function K(){return!!window.ana_debug||-1!==window.location.href.indexOf("ana_debug=1")}function $(){var e,n=window.navigator;if(!n.connection)return t.Unknown;switch(n.connection.effectiveType){case"slow-2g":case"2g":e=t.CellularNetwork2G;break;case"3g":e=t.CellularNetwork3G;break;case"4g":e=t.CellularNetwork4G;break;default:e=t.Unknown}return e}function X(){var e,n=window.navigator;if(!n.connection)return t.Unknown;if(n.connection)switch(n.connection.type){case"cellular":e=$();break;case"ethernet":e=t.Ethernet;break;case"wifi":e=t.WIFI;break;case"unknown":e=t.Unknown;break;case void 0:e=$();break;default:e=t.Unknown}return e}function Z(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];K()&&console.log.apply(console,q(["%cðŸš¨ANA: ","background: #222; color: #33c65a"],e,!1))}function Q(e,t,n){var i="";if(n){var r=new Date;r.setTime(r.getTime()+60*n*1e3),i="; expires="+r.toUTCString()}document.cookie=e+"="+(t||"")+i+"; path=/"}function Y(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){var r=n[i].trim();if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null}function ee(e){return new URLSearchParams(window.location.search).get(e)}function te(e){var t=!1;return Array.from(document.getElementsByTagName("script")).forEach((function(n){n.getAttribute("src")===e&&(t=!0)})),t}function ne(e,t,n){if(t.addEventListener)t.addEventListener(e,n,!1);else{if(!t.attachEvent)throw Error("No event listener found!");t.attachEvent("on".concat(e),n)}}function ie(e){var t,n=document.getElementById(e),i=!!(null===(t=window.googletag)||void 0===t?void 0:t.pubads);return!!n&&!(i&&googletag.pubads&&googletag.pubads().getSlots().find((function(t){return t.getSlotElementId()===e})))}var re=function(e,t){if(t){var n=t.options.dimensions.filter((function(e){return 300===e[0]&&600===e[1]})).length>0,i=t.options.dimensions.filter((function(e){return 300===e[0]&&(300===e[1]||250===e[1])})).length>0;if(n&&i){var r=document.getElementById(t.elementID);if(!t.isSemiStickyUnit||300!==e.Width||300!==e.Height&&250!==e.Height)t.isSemiStickyUnit&&e.Height>300&&"assembly-semi-sticky-container"===r.parentElement.getAttribute("class")&&(r.style.position="relative",r.style.marginTop="0px");else{var o=null;"assembly-semi-sticky-container"!==r.parentElement.getAttribute("class")&&((o=document.createElement("div")).setAttribute("class","assembly-semi-sticky-container"),o.style.display="block",o.style.width="300px",o.style.height="600px",o.style.marginLeft="auto",o.style.marginRight="auto",o.style.borderTop="1px solid transparent",o.style.borderBottom="1px solid transparent",r.parentNode.insertBefore(o,r),o.appendChild(r))}}}else Z("slot is not defined")},oe=0,ae=ee("aversion");if(ae){var se="use_local_bundle"===ae?"http://localhost:9000/wana.js":"https://js.media-lab.ai/wana."+ae+".js";if(!te(se))throw function e(t){if(!document.body)return console.error("ana-web is triying to load another version before there is a body to append to. Retry [".concat(ae,"][").concat(oe,"]")),(oe+=1)<10?void setTimeout((function(){e(t)}),50):void console.error("Ana Web exhausted retries while waiting for document.body . Retry [".concat(ae,"][").concat(oe,"]"));te(t)||function(e,t){if(!te(e)){var n=document.createElement("script");n.async=t,n.src=e,document.body.appendChild(n)}}(t,!0)}(se),Error("Ana Version parameter found, stoping current script to load requested version [".concat(ae,"]"))}var ce,de,le,ue=function(){function e(){}return e.prototype.setItem=function(e,t){this[e]=t},e.prototype.getItem=function(e){var t=this[e];return t||(t=null),t},e.prototype.removeItem=function(e){delete this[e]},e.prototype.clear=function(){var e=this;Object.keys(this).forEach((function(t){delete e[t]}))},e.prototype.key=function(e){throw Error("not implemented (index = ".concat(e))},Object.defineProperty(e.prototype,"length",{get:function(){return Object.keys(this).length},enumerable:!1,configurable:!0}),e}();window.anaStorage=J((function(){return window.localStorage}))?window.localStorage:new ue,window.anaSessionStorage=J((function(){return window.sessionStorage}))?window.sessionStorage:new ue,function(e){e[e.GOOGLE=0]="GOOGLE",e[e.ANA=1]="ANA",e[e.SAS=2]="SAS"}(ce||(ce={})),function(e){e[e.VIDEO_JS=0]="VIDEO_JS",e[e.HTML5=1]="HTML5"}(de||(de={}));var he,pe=null,fe=function(e){var t,n=document.activeElement;if(n&&"IFRAME"===n.tagName&&pe!==n&&(pe=n,document.activeElement.parentNode&&"DIV"===document.activeElement.parentNode.nodeName)){var i=document.activeElement.parentNode,r="";i.parentNode&&"DIV"===i.parentNode.nodeName&&i.parentNode.getAttribute("id")?r=i.parentNode.getAttribute("id"):(i,r=i.getAttribute("id")),Z("ANA Ad Click detected on adUnit",r);var o=null===(t=e.getBannerSlot(r))||void 0===t?void 0:t.currentBid;o?(Z("Rendering ClickPixels for adUnit",r),o.renderClickPixels()):Z("Failed Rendering ClickPixels for adUnit",r,"because bid is missing")}},ge=function(){function e(e){var t=this;Object.keys(e).forEach((function(n){var i=function(e,t){void 0===t&&(t=!1);var n=e.replace(/([-_]id$)|([-_][a-z])/gi,(function(e){return e.toUpperCase().replace("-","").replace("_","")}));return"id"===n&&(n="ID"),n&&t&&(n=n[0].toUpperCase()+n.slice(1)),n}(n,!0);t[i]=e[n]})),this.LastNomination=0}return e.prototype.toCustomJSON=function(){var e=this,t={};return Object.keys(this).forEach((function(n){var i=n.replace(/\.?([A-Z]+)/g,(function(e,t){return"_"+t.toLowerCase()})).replace(/^_/,"");t[i]=e[n]})),t},e.prototype.renderPixels=function(e){var t=this.BidID;e.forEach((function(e){var n=document.createElement("img");n.setAttribute("data-bid-id",t),n.setAttribute("src",e),n.setAttribute("width","1"),n.setAttribute("height","1"),document.body.appendChild(n)}))},e.prototype.renderImpressionPixels=function(){this.ImpressionPixels&&this.renderPixels(this.ImpressionPixels)},e.prototype.renderViewPixels=function(){this.ViewPixels&&this.renderPixels(this.ViewPixels)},e.prototype.renderClickPixels=function(){this.ClickPixels&&this.renderPixels(this.ClickPixels)},e.prototype.removeImpressionPixels=function(){for(var e=[],t=document.getElementsByTagName("img"),n=0;n<t.length;n++){var i=t[n];i.getAttribute("data-bid-id")===String(this.BidID)&&e.push(i)}e.forEach((function(e){return document.body.removeChild(e)}))},e.prototype.isExpired=function(){if(void 0===this.Expires)return!1;var e=this.Expires-this.Received,t=new Date(this.Expires);this.ClientReceived&&(t=new Date(this.ClientReceived+e));var n=new Date;return t.getTime()<n.getTime()},e}(),ye=function(){for(var e=[],t="0123456789abcdef",n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&+e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")},ve=function(){return"y"===new URLSearchParams(window.location.search).get("tracing")},me=function(){var e=anaStorage.getItem(f);return e||(e=ye(),anaStorage.setItem(f,e)),ve()?"tr"+e:e},be=(he=function(e,t){return he=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},he(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}he(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});const we=function(e){function t(t,n){var i=e.call(this,t)||this;return i.status=n,i}return be(t,e),t}(Error);var Ee=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))},Te=function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Ae=function(e,t){anaStorage.setItem(I+e,t)};var Ie=function(e){var t=anaStorage.getItem(S),n=null;try{if(t){n=JSON.parse(t);var i=!0;if(e&&Object.keys(e).forEach((function(e){Object.keys(n.bidders).find((function(t){return e===t}))||(i=!1)})),i)return Object.keys(n.bidders).forEach((function(e){n.bidders[e].sync_date<Date.now()-864e5&&(n.bidders[e].sync_date=Date.now(),n.bidders[e].sync_counter=0)})),n}}catch(e){}var r={group:-1,bidders:{}};return e?(Object.keys(e).forEach((function(e){r.bidders[e]={sync_counter:-1,sync_date:Date.now()}})),r):r},Se=function(e,t){var n,i,r=Object.keys(e).length,o=Math.ceil(r/6);-1===t.group?t.group=(n=0,i=o-1,Math.floor(Math.random()*(i-n+1)+n)):(t.group++,t.group>o-1&&(t.group=0));var a=6*t.group,s=a+6;s>r&&(s=r);var c=Object.keys(e).slice(a,s);c.forEach((function(e){void 0!==t.bidders[e]&&(t.bidders[e].sync_counter++,t.bidders[e].sync_counter>3&&(t.bidders[e].sync_counter=3))})),c=c.filter((function(e){return void 0!==t.bidders[e]&&t.bidders[e].sync_counter<3}));var d={};return c.forEach((function(t){d[t]=e[t]})),[d,t]},De=function(e){var t=e.propertyId,n=e.uid;return Ee(void 0,void 0,void 0,(function(){var e,i,r,o,a,s,c,d;return Te(this,(function(l){switch(l.label){case 0:if(!t)throw Error("propertyId is required");if(h=Ie(null),0!==Object.keys(h.bidders).length&&0===Object.keys(h.bidders).filter((function(e){return h.bidders[e].sync_counter<3})).length)return Z("Already all synced, no need to resync cookies across bidders"),[2];if(Z("Not all bidders synced, continuing"),void 0===window.syncRequestLastTime&&(window.syncRequestLastTime={}),void 0===window.syncRequestLastTime[window.location.href]&&(window.syncRequestLastTime[window.location.href]=0),(new Date).getTime()-window.syncRequestLastTime[window.location.href]<2500)return Z("We have already called resync before 2.5 seconds, rejecting the call until later"),[2];window.syncRequestLastTime[window.location.href]=(new Date).getTime(),Z("Updating last resync timer"),u=t,window.ANAWebPropertyId=u,function(e){anaStorage.setItem(f,e)}(n),Z("sending a syncing cookie request to doh"),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,We.UserSync.sync({syncedBidderIds:[]})];case 2:return e=l.sent(),i=e.syncUrls,r=e.cookieIds,o=Ie(i),a=Se(i,o),s=a[0],function(e){try{anaStorage.setItem(S,JSON.stringify(e))}catch(e){}}(a[1]),c=r?Object.keys(r):null,Z("got response from /doh/sync:",s,r),Object.keys(s).forEach((function(e){c&&-1!==c.indexOf(e)||xe(e,s[e])})),r&&Object.keys(r).forEach((function(e){var t=r[e];t&&Ae(e,t)})),[2];case 3:return d=l.sent(),console.error("Something went wrong during user sync:",d),[3,4];case 4:return[2]}var u,h}))}))};function _e(e){this.callCounter++,document.body?document.body.appendChild(e):this.callCounter<200&&setTimeout(_e.bind(this,e),50)}var Pe,ke,Re,Oe,Ce,Me,Be,Le,Ne,xe=function(e,t){var n=z(),i=document.createElement("iframe");i.setAttribute("src",t),i.setAttribute("frameborder","0"),i.setAttribute("scrolling","no"),i.setAttribute("marginheight","0"),i.setAttribute("marginwidth","0"),i.setAttribute("TOPMARGIN","0"),i.setAttribute("LEFTMARGIN","0"),i.setAttribute("allowtransparency","true"),i.setAttribute("width","0"),i.setAttribute("height","0"),i.setAttribute("data-property-id",n),Z("creating cookie syncing iframe for "+e,t),setTimeout(_e.bind({callCounter:0},i),0)};!function(e){e[e.PageLoadSoundOn=1]="PageLoadSoundOn",e[e.PageLoadSoundOff=2]="PageLoadSoundOff",e[e.ClickSoundOn=3]="ClickSoundOn",e[e.MouseOverSoundOn=4]="MouseOverSoundOn",e[e.EnterViewpointSoundOn=5]="EnterViewpointSoundOn",e[e.EnterViewpointSoundOff=6]="EnterViewpointSoundOff"}(Pe||(Pe={})),function(e){e[e.GenericPostRoll=-2]="GenericPostRoll",e[e.GenericMidRoll=-1]="GenericMidRoll",e[e.PreRoll=0]="PreRoll",e[e.MidRoll3Sec=3]="MidRoll3Sec",e[e.MidRoll5Sec=5]="MidRoll5Sec",e[e.MidRoll10Sec=10]="MidRoll10Sec",e[e.MidRoll15Sec=15]="MidRoll15Sec",e[e.MidRoll30Sec=30]="MidRoll30Sec",e[e.MidRoll60Sec=60]="MidRoll60Sec"}(ke||(ke={})),function(e){e[e.InStream=1]="InStream",e[e.InBanner=2]="InBanner",e[e.InArticle=3]="InArticle",e[e.InFeed=4]="InFeed",e[e.Interstitial=5]="Interstitial"}(Re||(Re={})),function(e){e[e.InStream=1]="InStream",e[e.Overlay=2]="Overlay"}(Oe||(Oe={})),function(e){e[e.OnVideoCompletion=1]="OnVideoCompletion",e[e.OnLeavingViewport=2]="OnLeavingViewport",e[e.OnLeavingViewportContinues=3]="OnLeavingViewportContinues"}(Ce||(Ce={})),function(e){e[e.Unknown=0]="Unknown",e[e.AboveTheFold=1]="AboveTheFold",e[e.Deprecated=2]="Deprecated",e[e.BelowTheFold=3]="BelowTheFold",e[e.Header=4]="Header",e[e.Footer=5]="Footer",e[e.Sidebar=6]="Sidebar",e[e.FullScreen=7]="FullScreen"}(Me||(Me={})),function(e){e[e.Vast10=1]="Vast10",e[e.Vast20=2]="Vast20",e[e.Vast30=3]="Vast30",e[e.Vast10Wrapper=4]="Vast10Wrapper",e[e.Vast20Wrapper=5]="Vast20Wrapper",e[e.Vast30Wrapper=6]="Vast30Wrapper",e[e.Vast40=7]="Vast40",e[e.Vast40Wrapper=8]="Vast40Wrapper",e[e.Daast10=9]="Daast10",e[e.Daast10Wrapper=10]="Daast10Wrapper"}(Be||(Be={})),function(e){e[e.Vpaid10=1]="Vpaid10",e[e.Vpaid20=2]="Vpaid20",e[e.Mraid1=3]="Mraid1",e[e.Ormma=4]="Ormma",e[e.Mraid2=5]="Mraid2",e[e.Mraid3=6]="Mraid3"}(Le||(Le={})),function(e){e[e.Streaming=1]="Streaming",e[e.Progressive=2]="Progressive",e[e.Download=3]="Download"}(Ne||(Ne={}));var Ue=function(){var e=Y(g);return e||(e=ye()),je(e),ve()?"tr"+e:e},je=function(e){Q(g,e,30)},Ve=function(e){var t={};return Object.keys(e).forEach((function(n){var i=e[n];Array.isArray(i)?t[n]=i.join(","):t[n]=i})),t},Fe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))},Ge=function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},qe=function(e,t,n){var i,r=H().consentManager,o={ad_unit:e,auction_timeout:n,inventory_type:"web",additional_targeting:Ve(t),property_id:z(),opportunity_data:{platform:"web",connection_type:X()},site:{page:document.location.href,referer:document.referrer},matched_ids:{ids:(i={},Object.keys(anaStorage).forEach((function(e){0===e.indexOf(I)&&(i[e.slice(I.length)]=anaStorage.getItem(e))})),i)},consent:{tcfV2:r.tcfV2String,usPrivacyString:r.usPrivacyString},session_id:Ue()},a=H().getUserIdentity();return a.email?o.opportunity_data.lr_envelope={identifier:a.email,identifier_type:P}:a.envelope&&"noEnvelope"!==a.envelope&&(o.opportunity_data.liveramp_envelope=a.envelope),o},We={BannerBids:{fetch:function(e){var t=e.adUnitID,n=e.targeting,i=e.auctionTimeout;return Fe(void 0,void 0,void 0,(function(){var e,r,o,a,s,c;return Ge(this,(function(d){switch(d.label){case 0:return d.trys.push([0,5,,6]),[4,F({url:"".concat(Je(),"/wana/bids/request"),params:{uid:me(),ad_unit:t},body:qe(t,n,i)})];case 1:return e=d.sent(),r=e.status,e.ok?[3,3]:[4,e.text()];case 2:throw o=d.sent(),new we(o,r);case 3:return[4,e.json()];case 4:return a=d.sent(),s=a.bids||[],[2,{code:r,bids:s.map((function(e){return new ge(e)})),ok:e.ok}];case 5:if((c=d.sent()).status)return c.status!==T&&console.error("HTTP error "+c.status),[2,{code:c.status,bids:[],err_msg:c.message===A?A:c.status.toString(),ok:!1}];throw new Error(c);case 6:return[2]}}))}))},get:function(e,t,n,i,r){j("".concat(Je(),"/wana/bids/request"),{uid:me(),ad_unit:e},qe(e,t,n),(function(e){switch(e.status){case 200:var t=JSON.parse(e.responseText).bids||[];i({code:200,bids:t.map((function(e){return new ge(e)}))});break;case T:var n=void 0;n=JSON.parse(e.responseText).message===A?A:e.status.toString(),i({code:T,bids:[],err_msg:n});break;default:0!==e.status&&console.error("HTTP error "+e.status),i({code:e.status,bids:[],err_msg:e.status.toString()})}}),r)},invalidateBids:function(e){var t=e.adUnitID,n=e.bids;return Z("invalidating bids for adUnitID ".concat(t,":"),n),F({url:"".concat(Je(),"/wana/bids/invalidate"),params:{uid:me(),ad_unit:t},body:{bids:W(n)}}).catch((function(e){var t=n.map((function(e){return e.BidID})).join(", ");console.error("Something went wrong when invalidating the bids: ".concat(t,"."),e)}))},invalidate:function(e,t,n,i){Z("invalidating bids for adUnitID ".concat(e,":"),t);var r=t.map((function(e){var t=e.toCustomJSON();return t.creative="",t.impression_pixels=[],t.view_pixels=[],t.click_pixels=[],t}));j("".concat(Je(),"/wana/bids/invalidate"),{uid:me(),ad_unit:e},{bids:r},n,i)}},VMAP:{fetch:function(e){return Fe(void 0,void 0,void 0,(function(){var t,n,i,r,o;return Ge(this,(function(a){switch(a.label){case 0:t=function(e){var t=e.adUnitID,n=e.targeting,i=e.adPlacement,r=e.playbackMethod,o=e.adPosition,a=e.startDelay,s=e.playerWidth,c=e.playerHeight,d=e.auctionTimeout,l=qe(t,n,d);return l.video_delivery=Ne.Progressive,l.video_placement=i,l.video_playback_method=r,l.video_position=o,l.video_start_delay=a,l.video_width=s,l.video_height=c,l}(e),a.label=1;case 1:return a.trys.push([1,6,,7]),[4,F({url:"".concat(Je(),"/vmap/request"),params:{uid:me()},body:t})];case 2:return(n=a.sent()).ok?[3,4]:[4,n.text()];case 3:throw i=a.sent(),new we(i,n.status);case 4:return[4,n.json()];case 5:return r=a.sent(),Z("".concat(e.adUnitID," got video bid response from ANA"),r),[2,{code:n.status,tagUrl:r.tag_url}];case 6:throw(o=a.sent()).status===T?o.message===A&&console.warn("#".concat(e.elementID," ").concat(e.adUnitID," ANA user reached fcap")):console.error("Failed requesting video bids: HTTP error ".concat(o.status,"."),o),o;case 7:return[2]}}))}))}},UserSync:{sync:function(e){var t=e.syncedBidderIds;return Fe(void 0,void 0,void 0,(function(){var e,n,i,r,o,a;return Ge(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),e=z(),[4,F({url:"".concat(Je(),"/doh/sync"),params:{uid:me(),property_id:e},body:{synced_ids:t}})];case 1:if(200!==(n=s.sent()).status)throw new Error("Failed getting sync URLs");return[4,n.json()];case 2:return i=s.sent(),r=i.sync_urls,o=i.cookie_ids,[2,{syncUrls:r,cookieIds:o}];case 3:throw a=s.sent(),new Error(a);case 4:return[2]}}))}))}},Hertz:{impression:function(e){var t=e.adUnitID,n=e.bidId,i=void 0===n?"adserver":n;return Fe(void 0,void 0,void 0,(function(){var e,n,r,o;return Ge(this,(function(a){switch(a.label){case 0:Z("reporting on bid ".concat(i," impression to hertz for ").concat(t)),e=z(),n=me(),r=Ue(),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,G({url:"".concat(Je(),"/hertz/impression"),params:{uid:n,ad_unit_id:t,session_id:r,bid_id:i,property_id:e}})];case 2:return[2,a.sent()];case 3:return o=a.sent(),console.error("hertz/impression error:",o),[3,4];case 4:return[2]}}))}))}}},He={rtis:function(e){window.fetch&&fetch("https://api.rlcdn.com/api/identity/envelope?pid=13731",{credentials:"include"}).then((function(e){return e.json()})).then((function(t){t.envelope&&e(t.envelope)})).catch((function(){e("noEnvelope")}))}},ze=function(e){var t=e.adUnitID,n=e.bid;if(n)return n.renderImpressionPixels(),We.BannerBids.invalidateBids({adUnitID:t,bids:[n]})},Je=function(){return window.ana_staging||-1!==window.location.href.indexOf(v)?d.replace("https://","https://staging."):d},Ke=function(e){var t=e.getBoundingClientRect(),n=t.width*t.height,i=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight;return $e(t,i,r)/n>=.5},$e=function(e,t,n){return(Math.min(t,e.right)-Math.max(0,e.left))*(Math.min(n,e.bottom)-Math.max(0,e.top))},Xe=function(){return Xe=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Xe.apply(this,arguments)},Ze=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))},Qe=function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Ye={adUnitID:"",format:e.HORIZONTAL,elementID:"",collapseBeforeFill:!1,collapseIfNoFill:!1,dimensions:null,baseTargeting:{},passThroughANA:!1,apsEnabled:!0,adServerRender:!0,disableViewabilityMonitor:!1},et=function(){function e(e,t){this.options=Xe(Xe({},Ye),t),this.anaWeb=e,this.adUnitID=this.options.adUnitID,this.elementID=this.options.elementID,this.dimensions=this.options.dimensions,this.baseTargeting=Xe({},this.options.baseTargeting),this.passThroughANA=this.options.passThroughANA,this.apsEnabled=e.apsEnabled&&this.options.apsEnabled,this.adServerRender=this.options.adServerRender,this.isSemiStickyUnit=!!this.options.isSemiStickyUnit,this.disableViewabilityMonitor=this.options.disableViewabilityMonitor,this.adLoadCallback=this.options.onAdLoad,this.refreshCount=0,this.currentBid=null,this.hasBeenViewed=!1,this.impCount=0}return e.prototype.updateBaseTargeting=function(e){this.baseTargeting=Xe(Xe({},this.baseTargeting),e)},e.prototype.fetchANABids=function(){return Ze(this,void 0,void 0,(function(){var e,t,n,i,r,o,a;return Qe(this,(function(s){switch(s.label){case 0:if(!this.anaWeb.hasFocus()&&this.refreshCount>0)throw Z("prevent ad slot refresh - document not in focus"),this.anaWeb.eventsTracker.adAttemptAborted(this.adUnitID,"not-in-focus"),new we("Document not in focus",1);if(this.refreshCount++,this.passThroughANA)return[2];e=Xe(Xe({},this.anaWeb.globalTargeting),this.baseTargeting),n=(t=this).anaWeb,i=t.adUnitID,this.anaWeb.eventsTracker.adAttemptMade(i),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,We.BannerBids.fetch({adUnitID:i,targeting:e,auctionTimeout:n.auctionTimeout})];case 2:if((r=s.sent()).code===T)throw new we(r.err_msg,r.code);return o=r.bids,r.ok&&n.eventsTracker.adAttemptSucceeded(i,o.length),o.length>0&&n.bidManager.addBids(o,i),[3,4];case 3:if((a=s.sent()).status===T)throw a.message===A&&(console.warn("#".concat(this.elementID," ").concat(i," ANA user reached fcap")),n.eventsTracker.adAttemptFailed(i,"fcap")),new we(a.message,a.status);return n.eventsTracker.adAttemptFailed(i,"0"),[3,4];case 4:return[2]}}))}))},e.prototype.fetchAPSBids=function(e){var t=this;return void 0===e&&(e=this.elementID),this.anaWeb.apsEnabled?new Promise((function(n){window.apstag.fetchBids({slots:[{slotID:e,slotName:t.adUnitID,sizes:t.dimensions}]},(function(e){Z("APS responded with bids for ".concat(t),e),n(e)}))})):Promise.resolve()},e.prototype.updateTargeting=function(){},e.prototype.getTopBid=function(e){void 0===e&&(e=!0);var t=this.anaWeb,n=this.adUnitID;return t.bidManager.getBid(n,e)},e.prototype.renderInElement=function(e,t,n){if(document.getElementById(e)){var i=this.adUnitID,r=this.anaWeb;!function(e,t,n){var i=document.getElementById(e);if(!i)throw Error("tried to render ad on missing element "+e);for(;i.firstChild;)i.removeChild(i.firstChild);"none"===i.style.display&&(i.style.display="inline-block",i.style.lineHeight="0px");var r=document.createElement("iframe");r.setAttribute("srcdoc",t.Creative),r.setAttribute("frameborder","0"),r.setAttribute("scrolling","no"),r.setAttribute("marginheight","0"),r.setAttribute("marginwidth","0"),r.setAttribute("TOPMARGIN","0"),r.setAttribute("LEFTMARGIN","0"),r.setAttribute("allowtransparency","true");var o=t.Width,a=t.Height;r.setAttribute("width","".concat(o)),r.setAttribute("height","".concat(a)),i.append(r),le||(le=setInterval((function(){return fe(n)}),25))}(e,t,r),ze({adUnitID:i,bid:t}),r.eventsTracker.slotRendered(this.adUnitID,t),r.bidManager.useBid(i,t.BidID),this.onAdLoad(e,t,n)}else console.error("missing element for direct render")},e.prototype.alreadyRendered=function(){throw Error("unimplemented method: alreadyRendered")},e.prototype.isWaitingForView=function(){return this.impCount>0&&!this.hasBeenViewed},e.prototype.onAdLoad=function(e,t,n){var i=this;this.impCount+=1,this.hasBeenViewed=!1,this.currentBid=t,this.currentOnView=n,this.adLoadCallback&&this.adLoadCallback(),this.currentViewMonitorStop=function(e,t,n,i){var r=!1,o=n||0,a=function(){return r||(clearInterval(s),r=!0),o},s=setInterval((function(){var n=document.getElementById(e);if(!n)return Z("viewability monitor: missing element ".concat(e,". stopping monitor")),void a();Ke(n)?o++:o=0,o>=20&&(Z("viewability monitor: viewed ".concat(e,". stopping monitor")),t&&t.renderViewPixels(),i&&i(),a())}),50);return a}(e,t,0,(function(){i.hasBeenViewed=!0,n&&n()}))},e}();et.prototype.toString=function(){return"ANASlot('".concat(this.adUnitID,"', '").concat(this.elementID,"')")};var tt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),nt=function(){return nt=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},nt.apply(this,arguments)},it=function(e,t,n){googletag.cmd.push((function(){googletag.pubads().addEventListener(e,(function(e){e.slot.getSlotElementId()===t&&n(e)}))}))},rt=function(e){function t(t,n){var i,r,o=e.call(this,t,n)||this;if(o.fetched=function(){Z("fetched ".concat(o))},o.rendered=function(){Z("rendered ".concat(o))},o.format=o.options.format,o.collapseBeforeFill=o.options.collapseBeforeFill,o.collapseIfNoFill=o.options.collapseIfNoFill,o.slot=null,o.currentBid=null,o.slotType=ce.GOOGLE,o.attemptCount=0,o.pendingRefresh=!1,o.resetRequestMgr(),o.anaWeb.lazyLoad)return o.fetchBids(),K()&&(it("slotRequested",o.elementID,o.fetched),it("slotOnload",o.elementID,o.rendered)),o;if(i=o.adUnitID,r=new RegExp(/\/(\d+)(\/([\.|A-Z|a-z|\d|_|\-|\*|â€œ|\!|\\|\(|\)])+)+\/*/),i.length>100||!r.test(i))throw Error("Invalid AdunitID format, ".concat(o));if(!function(e){if(!Array.isArray(e)||0===e.length)return!1;if(2!==e.length||Array.isArray(e[0])||Array.isArray(e[1])){for(var t=!0,n=0,i=e;n<i.length;n++){var r=i[n];Array.isArray(r)?2!==r.length||"number"!=typeof r[0]||"number"!=typeof r[1]?t=!1:parseInt(r[0].toString())===r[0]&&parseInt(r[1].toString())===r[1]||(t=!1):t=!1}return t}return!(!Number.isInteger(e[0])||!Number.isInteger(e[1]))}(o.dimensions))throw Error("Invalid Adunit size, should be an array of bidimensional integer arrays, or it can be one bidimesional array of integers, ".concat(o));if(!ie(o.elementID))throw Error("Invalid elementID, might not be present of the page or already been used by another adUnit, ".concat(o));return googletag.cmd.push((function(){o.registerSlot()})),o}return tt(t,e),t.prototype.resetRequestMgr=function(){this.requestMgr={didDirectRender:!1,requestStarted:!1,gptStarted:!1},this.currentBid=null},t.prototype.alreadyRendered=function(){return!!this.requestMgr.didDirectRender&&(this.requestMgr.didDirectRender=!1,!0)},t.prototype.maybeRenderBid=function(e){return!(!e||this.adServerRender&&!e.DirectRender)&&(re(e,this),this.requestMgr.didDirectRender=!0,this.renderInElement(this.elementID,e),!0)},t.prototype.removeSlot=function(){var e=this;googletag.cmd.push((function(){var t=e.slot;googletag.destroySlots([t]),e.slot=null,document.getElementById(e.elementID).innerHTML=null}));var t=this.anaWeb,n=t.createdSlots.indexOf(this);-1!==n&&t.createdSlots.splice(n,1)},t.prototype.setAdServerRender=function(e){this.adServerRender=e},t.prototype.updateAnaTargeting=function(){var e=this,t=this.getTopBid(!0),n=this.slot,i=this.baseTargeting;if(t){if(this.currentBid=t,this.maybeRenderBid(t))return;null===n?(Z("updateTargeting - register slot for ".concat(this)),this.registerSlot(t.Targeting)):Object.keys(nt(nt({},i),t.Targeting)).forEach((function(i){Z("updateTargeting - set targeting ".concat(i,", ").concat(t.Targeting[i]," for ").concat(e)),n.setTargeting(i,t.Targeting[i])}))}else null===n&&(Z("updateTargeting - register slot with no bid for ".concat(this)),this.registerSlot());this.updateRefreshCountTargeting()},t.prototype.updateApsTargeting=function(){window.apstag.setDisplayBids()},t.prototype.refreshGPTSlot=function(e){var t=this;if(!this.requestMgr.gptStarted){if(this.requestMgr.gptStarted=!0,this.requestMgr.didDirectRender)return Z("refreshGPTSlot, skipping since slot was rendered directly"),console.warn("resync all bidders from direct render"),void setTimeout((function(){t.anaWeb.syncUserCookies()}),1e3);this.currentBid&&this.anaWeb.eventsTracker.targetingSent(this.adUnitID),this.adServerRender&&googletag.cmd.push((function(){t.updateRefreshCountTargeting(),Z("Calling GAM refresh for ",t),googletag.pubads().refresh([t.slot]),console.warn("resync all bidders from single slot"),setTimeout((function(){t.anaWeb.syncUserCookies()}),1e3),e()}))}},t.prototype.refresh=function(){var e=this;if(this.anaWeb.shouldUseViewabilityMonitor&&!this.disableViewabilityMonitor){var t=this.isWaitingForView()||this.requestMgr.requestStarted;if(t&&!this.pendingRefreshPromise){Z("slot view monitor refresh queued waiting for view:".concat(this.isWaitingForView()," in flight:").concat(this.requestMgr.requestStarted));var n=new Promise((function(t){e.pendingRefreshResolve=t}));return this.pendingRefresh=!0,this.pendingRefreshPromise=n,n}if(t&&this.pendingRefreshPromise)return this.pendingRefreshPromise;if(this.pendingRefreshPromise){var i=this.pendingRefreshPromise,r=this.pendingRefreshResolve;return this.doRefresh((function(){e.pendingRefreshResolve=null,e.pendingRefresh=!1,e.pendingRefreshPromise=null,r()})),i}}return new Promise((function(t){e.doRefresh(t)}))},t.prototype.doRefresh=function(e){var t=this;this.slot&&googletag.cmd.push((function(){t.slot.clearTargeting()})),this.resetRequestMgr(),this.requestMgr.requestStarted=!0;var n=Promise.resolve();this.apsEnabled&&(n=this.fetchAPSBids().then((function(){t.requestMgr.gptStarted||googletag.cmd.push((function(){t.updateApsTargeting()}))})));var i=this.fetchANABids().then((function(){Z("ANA responded for ".concat(t)),t.requestMgr.gptStarted||googletag.cmd.push((function(){t.updateAnaTargeting()}))})).catch((function(e){throw Z("ANA canceling ad attempt"),e}));Promise.all([n,i]).then((function(){return t.refreshGPTSlot(e)})),setTimeout((function(){t.refreshGPTSlot(e)}),this.anaWeb.auctionTimeout+_)},t.prototype.registerSlot=function(e){var t=this;Z("registerSlot - define slot for ".concat(this));var n=this,i=n.dimensions,r=n.format,o=n.collapseBeforeFill,a=n.collapseIfNoFill,s=n.adUnitID,c=n.elementID,d=n.baseTargeting,l=this.prepareDimensions(i,r);this.slot=googletag.defineSlot(s,l,c);var u=this.slot;it("impressionViewable",this.elementID,this.onViewHandler.bind(this)),it("slotRenderEnded",this.elementID,(function(){t.onAdLoad(t.elementID,t.currentBid)})),u.setCollapseEmptyDiv(o,a);var h=nt(nt({},d),e);h&&Object.keys(h).length&&Object.keys(h).forEach((function(e){Z("registerSlot - set targeting ".concat(e,", ").concat(h[e]," for ").concat(t)),u.setTargeting(e,h[e])})),u.addService(googletag.pubads()),googletag.display(c)},t.prototype.updateRefreshCountTargeting=function(){this.slot.getTargetingKeys&&void 0===this.slot.getTargetingKeys().find((function(e){return"mlrf"===e}))&&(this.attemptCount++,this.slot.setTargeting("mlrf",this.attemptCount.toString()))},t.prototype.onViewHandler=function(e){this.currentBid?(Z("Rendering ViewPixels for ".concat(this.adUnitID),e),this.currentBid.renderViewPixels()):Z("Ignoring ViewPixels on AdUnit since it does not have a currentBid on ",this.adUnitID),this.hasBeenViewed=!0,this.pendingRefresh&&this.refresh()},t.prototype.prepareDimensions=function(e,t){return e&&e.length?e:a[t]||[]},t.prototype.fetchBids=function(){var e=this;this.fetchANABids().then((function(){Z("fetchBids - ANA responded with bids for ".concat(e)),googletag.cmd.push((function(){e.updateAnaTargeting()}))})),this.apsEnabled&&this.fetchAPSBids().then((function(){Z("fetchBids - APS responded for ".concat(e)),googletag.cmd.push((function(){e.updateApsTargeting()}))}))},t}(et);rt.prototype.toString=function(){return"BannerSlot('".concat(this.adUnitID,"', '").concat(this.elementID,"')")};var ot=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))},at=function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},st=function(){function e(e,t,n,i,r){var o=this;this.anaBidRequest=function(e){return ot(o,void 0,void 0,(function(){var t,n;return at(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e()];case 1:return t=i.sent(),this.imaInit(t),[3,3];case 2:return n=i.sent(),console.warn("".concat(this.videoPlayerID," error getting ANA bids: ").concat(n.message)),[3,3];case 3:return[2]}}))}))},this.playerType=e,this.adUnitID=i,this.targeting=r,this.adsManagerLoadedCustomCbk=t,this.videoPlayerID=n,this.html5Player=document.getElementById(n),this.initAds()}return e.prototype.initAds=function(){throw new Error("must be implemented by child class")},e.prototype.imaInit=function(e){throw new Error("must be implemented by child class")},e.prototype.vastUrlAndVideoSrc=function(e){Z("".concat(this.videoPlayerID," imaInit"));var t,n=(t=window.ana_vast)||(-1!==window.location.href.indexOf("ana_vast=")&&(t=N(window.location.href).searchParams.get(y))?t:"");if(n||(n=e),n){var i=this.html5Player.currentSrc;if(!i&&""!==i)throw Error("".concat(this.videoPlayerID," does not have a valid src"));return Z("".concat(this.videoPlayerID," vast used: ").concat(n,", src: ").concat(i)),{videoVastUrl:n,videoSrc:i}}Z("".concat(this.videoPlayerID," we don't have an ad to show"))},e.prototype.adsManagerLoadedCallback=function(e){throw new Error("must be implemented by child class")},e.prototype.addDefaultListeners=function(){var e=this,t=window.google;this.adsManagerLoadedCustomCbk&&this.adsManagerLoadedCustomCbk(this.html5Player,this.playerType,this.adsManager);var n=[t.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,t.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,t.ima.AdEvent.Type.CLICK,t.ima.AdEvent.Type.VIDEO_CLICKED,t.ima.AdEvent.Type.VIDEO_ICON_CLICKED,t.ima.AdEvent.Type.STARTED,t.ima.AdEvent.Type.AD_PROGRESS,t.ima.AdEvent.Type.AD_BUFFERING,t.ima.AdEvent.Type.IMPRESSION,t.ima.AdEvent.Type.PAUSED,t.ima.AdEvent.Type.RESUMED,t.ima.AdEvent.Type.FIRST_QUARTILE,t.ima.AdEvent.Type.MIDPOINT,t.ima.AdEvent.Type.THIRD_QUARTILE,t.ima.AdEvent.Type.COMPLETE,t.ima.AdEvent.Type.DURATION_CHANGE,t.ima.AdEvent.Type.USER_CLOSE,t.ima.AdEvent.Type.LOADED,t.ima.AdEvent.Type.ALL_ADS_COMPLETED,t.ima.AdEvent.Type.SKIPPED,t.ima.AdEvent.Type.LINEAR_CHANGED,t.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,t.ima.AdEvent.Type.AD_METADATA,t.ima.AdEvent.Type.AD_BREAK_READY,t.ima.AdEvent.Type.LOG,t.ima.AdEvent.Type.VOLUME_CHANGED,t.ima.AdEvent.Type.VOLUME_MUTED,t.ima.AdEvent.Type.INTERACTION],i=function(){var t;t=e.adUnitID,We.Hertz.impression({adUnitID:t})};this.adsManager.addEventListener(t.ima.AdEvent.Type.IMPRESSION,i),this.adsManager.addEventListener(t.ima.AdEvent.Type.IMPRESSION,(function(){return e.adsManager.removeEventListener(t.ima.AdEvent.Type.IMPRESSION,i)}));for(var r=0;r<n.length;r++)this.adsManager.addEventListener(n[r],this.onAdEvent.bind(this)),Z("".concat(this.videoPlayerID," bind ").concat(n[r]," ad event"))},e.prototype.onAdEvent=function(e){void 0===e&&(e={});var t=window.google,n=e.type;n!==t.ima.AdEvent.Type.AD_PROGRESS&&Z("".concat(this.videoPlayerID," ad event: ").concat(n))},e}(),ct=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),dt=function(e){function t(t,n,i,r){var o=e.call(this,de.VIDEO_JS,t,n,i,r)||this;return o.toggleOverlayedBtnContainer=function(){o.overlayedBtnContainer&&(o.overlayedBtnContainer.hidden=!o.overlayedBtnContainer.hidden)},o.onComplete=function(){o.adPlaying=!1},o.onStarted=function(){o.adPlaying=!0},o.onSkipped=function(){o.adPlaying=!1,o.adDisplayContainer.destroy(),o.html5Player.play()},o.onContentPauseRequested=function(){o.adPlaying=!0,o.html5Player.pause()},o.onContentResumeRequested=function(){o.adPlaying=!1,o.html5Player.play()},o.onAdLoaded=function(e){e.getAd().isLinear()||o.html5Player.play()},Z("initializing IMAManagerHTML5 for",n),o.adPlaying=!1,o}return ct(t,e),t.prototype.initAds=function(){var e=this,t=window.google;if(!this.html5Player)throw Error("internal videojs element was not found on the page using id=".concat(this.videoPlayerID,", this is probably because this was initialized before videojs was ready"));if(t){this.overlayedBtnContainer=document.createElement("div"),this.overlayedBtnContainer.classList.add("ana-ad-overlay"),this.overlayedBtnContainer.id=this.videoPlayerID+"_ana_ad_overlay";var n=document.createElement("div");n.classList.add("ana-ad-container"),n.id=this.videoPlayerID+"_ana_ad_container",this.html5Player.after(this.overlayedBtnContainer,n),this.adDisplayContainer=new t.ima.AdDisplayContainer(n,this.html5Player),this.adsLoader=new t.ima.AdsLoader(this.adDisplayContainer),this.adsLoader.addEventListener(t.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.adsManagerLoadedCallback.bind(this),!1),this.adsLoader.addEventListener(t.ima.AdErrorEvent.Type.AD_ERROR,console.error,!1),this.html5Player.onended=this.adsLoader.contentComplete,window.addEventListener("resize",(function(){if(e.adsManager){var n=e.html5Player.clientWidth,i=e.html5Player.clientHeight;e.adsManager.resize(n,i,t.ima.ViewMode.NORMAL)}}))}else console.error("Google SDK not found.")},t.prototype.imaInit=function(e){if(e&&""!==e){var t=window.google,n=this.vastUrlAndVideoSrc(e).videoVastUrl;this.adsManager&&this.adsManager.destroy(),this.adsLoader.contentComplete();var i=new t.ima.AdsRequest;i.adTagUrl=n,i.linearAdSlotWidth=640,i.linearAdSlotHeight=480,i.nonLinearAdSlotWidth=640,i.nonLinearAdSlotHeight=150,i.forceNonLinearFullSlot=!0,i.omidAccessModeRules={},i.omidAccessModeRules[t.ima.OmidVerificationVendor.OTHER]=t.ima.OmidAccessMode.FULL,this.adsLoader.requestAds(i),this.overlayedBtnContainer.addEventListener("click",this.onOverlayedBtnContainerClick.bind(this)),this.overlayedBtnContainer.addEventListener("touchend",this.onOverlayedBtnContainerClick.bind(this))}},t.prototype.onOverlayedBtnContainerClick=function(e){e.cancelable&&e.preventDefault(),this.adPlaying?this.adsManager.resume():this.playAds(),this.toggleOverlayedBtnContainer()},t.prototype.playAds=function(){var e=window.google;this.adDisplayContainer&&this.adDisplayContainer.initialize(),this.html5Player.load();try{var t=this.html5Player.getBoundingClientRect(),n=t.width,i=t.height;this.adsManager.init(n,i,e.ima.ViewMode.NORMAL),this.adsManager.addEventListener(e.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,this.onContentPauseRequested),this.adsManager.addEventListener(e.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this.onContentResumeRequested),this.adsManager.addEventListener(e.ima.AdEvent.Type.LOADED,this.onAdLoaded),this.adsManager.addEventListener(e.ima.AdEvent.Type.STARTED,this.onStarted),this.adsManager.addEventListener(e.ima.AdEvent.Type.SKIPPED,this.onSkipped),this.adsManager.addEventListener(e.ima.AdEvent.Type.COMPLETE,this.onComplete),this.adsManager.addEventListener(e.ima.AdEvent.Type.PAUSED,this.toggleOverlayedBtnContainer),this.adsManager.start()}catch(e){this.html5Player.play()}},t.prototype.adsManagerLoadedCallback=function(e){Z("".concat(this.videoPlayerID," AdsManager loaded"));var t=window.google,n=new t.ima.AdsRenderingSettings;n.restoreCustomPlaybackStateOnAdBreakComplete=!0,n.uiElements=[t.ima.UiElements.AD_ATTRIBUTION,t.ima.UiElements.COUNTDOWN],this.adsManager=e.getAdsManager(this.html5Player,n),this.addDefaultListeners()},t}(st),lt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ut=function(e){function t(t,n,i,r){var o=e.call(this,de.VIDEO_JS,t,n,i,r)||this;return Z("initializing IMAManagerVideoJS for",n),navigator.userAgent.match(/iPad|Android/i)&&o.html5Player.hasAttribute("controls")&&o.html5Player.removeAttribute("controls"),o.overlayedBtnContainer=document.getElementById(n),o}return lt(t,e),t.prototype.initAds=function(){var e,t=window.videojs,n=window.google;if(!t)throw new Error("VideoJS not detected, dependency was not added correctly");if(n){if(this.html5Player=document.getElementById(this.videoPlayerID+"_html5_api"),!this.html5Player)throw Error("internal videojs element was not found on the page using id=".concat(this.videoPlayerID,", this is probably because this was initialized before videojs was ready"));this.videoJSPlayer=t(this.videoPlayerID);var i={id:this.videoPlayerID,adLabel:"Advertisement",disableAdControls:!1,showControlsForJSAds:!0,adsManagerLoadedCallback:this.adsManagerLoadedCallback.bind(this),omidVendorAccess:(e={},e[n.ima.OmidVerificationVendor.OTHER]=n.ima.OmidAccessMode.FULL,e)};this.videoJSPlayer.ima?this.videoJSPlayer.ima(i):console.error("IMA not found for video JS")}else console.error("Google SDK not found.")},t.prototype.imaInit=function(e){if(e&&""!==e){var t=this.vastUrlAndVideoSrc(e),n=t.videoVastUrl,i=t.videoSrc;this.videoJSPlayer.ima.setContentWithAdTag(i,n,!1),this.videoJSPlayer.ima.requestAds(),this.boundBidRequestClick=this.onOverlayedBtnContainerClick.bind(this),this.boundBidRequestTouch=this.onOverlayedBtnContainerClick.bind(this),this.overlayedBtnContainer.addEventListener("click",this.boundBidRequestClick),this.overlayedBtnContainer.addEventListener("touchend",this.boundBidRequestTouch)}},t.prototype.onOverlayedBtnContainerClick=function(e){e.cancelable&&e.preventDefault(),this.videoJSPlayer.ima.initializeAdDisplayContainer(),this.overlayedBtnContainer.removeEventListener("click",this.boundBidRequestClick),this.overlayedBtnContainer.removeEventListener("touchend",this.boundBidRequestTouch)},t.prototype.adsManagerLoadedCallback=function(){Z("".concat(this.videoPlayerID," AdsManager loaded")),this.adsManager=this.videoJSPlayer.ima.getAdsManager(),this.addDefaultListeners()},t}(st),ht=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),pt=function(){return pt=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},pt.apply(this,arguments)},ft=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))},gt=function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},yt=function(e){function t(t,n,i){var r,o=e.call(this,t,i)||this;if(o.fetchANAVMAP=function(){return ft(o,void 0,void 0,(function(){var e,t,n,i;return gt(this,(function(r){switch(r.label){case 0:e=this.currentDimensions(),t=pt(pt({},this.anaWeb.globalTargeting),this.baseTargeting),this.anaWeb.eventsTracker.adAttemptMade(this.adUnitID),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,We.VMAP.fetch({adPlacement:this.adPlacement,adPosition:this.adPosition,adUnitID:this.adUnitID,auctionTimeout:this.anaWeb.auctionTimeout,elementID:this.elementID,playbackMethod:this.playbackMethod,playerHeight:e[0][1],playerWidth:e[0][0],startDelay:this.startDelay,targeting:t})];case 2:if(n=r.sent(),this.anaWeb.eventsTracker.adAttemptSucceeded(this.adUnitID,0),n.tagUrl.includes("bids=&")&&!this.adServerRender)throw Error("did not receive ANA bid and ad server render disabled");return[2,"".concat(n.tagUrl).concat(this.adServerRender?"":"&ad_server_render=0")];case 3:throw(i=r.sent()).status?i.status===T&&i.message!==A&&this.anaWeb.eventsTracker.adAttemptFailed(this.adUnitID,"fcap"):this.anaWeb.eventsTracker.adAttemptFailed(this.adUnitID,"0"),i;case 4:return[2]}}))}))},o.playerType=n,void 0===i.startDelay)throw Error("startDelay must be specified for video ad slots");if(i.startDelay<-2)throw Error("startDelay must be valid");if(void 0===i.adPlacement)throw Error("adPlacement must be specified for video ad slots");if(void 0===i.adPosition)throw Error("adPosition must be specified for video ad slots");if(i.adPosition<1||i.adPosition>7)throw Error("adPosition must be valid not Unknown");if(!i.playbackMethod||i.playbackMethod<1||i.playbackMethod>6)throw Error("playbackMethod must be specified for video ad slots");if(o.startDelay=i.startDelay,o.adPlacement=i.adPlacement,o.adPosition=i.adPosition,o.playbackMethod=i.playbackMethod,o.wrapperDiv=document.getElementById(o.elementID),o.dimensions&&0===o.dimensions.length)throw new Error("".concat(o.elementID," dimensions must be either omitted or have at least one element in the array"));switch(o.playerType){case de.VIDEO_JS:r=ut;break;case de.HTML5:r=dt;break;default:throw Error("unsupported video player type: ".concat(n))}return o.videoManager=new r(i.adsManagerLoadedCbk,o.elementID,o.adUnitID,o.baseTargeting),o.videoManager.anaBidRequest(o.fetchANAVMAP),o}return ht(t,e),t.prototype.currentDimensions=function(){var e;if(this.dimensions)e=this.dimensions;else{var t=this.playerDimensions();e=[[t.w,t.h]]}if(0===e.length||2!==e[0].length)throw new Error("".concat(this.elementID," final dimensions are not valid: ").concat(e));return e},t.prototype.playerDimensions=function(){var e=this.wrapperDiv.getBoundingClientRect(),t=Math.floor(e.width),n=Math.floor(e.height);if(0===t||0===n)throw Error("".concat(this.elementID," wrong video ad slot dimensions: ").concat(t,"x").concat(n));return{w:t,h:n}},t}(et);yt.prototype.toString=function(){return"VideoSlot('".concat(this.adUnitID,"', ").concat(this.playerType,", '").concat(this.elementID,"')")};var vt=function(){function e(e){if(this.anaWeb=e,window.addEventListener)window.addEventListener("message",this.handleMessage.bind(this),!1),window.addEventListener("unload",(function(){e&&e.eventsTracker&&e.eventsTracker.pageviewExit()}));else{if(!window.attachEvent)throw Error("No event listener found!");window.attachEvent("onmessage",this.handleMessage.bind(this))}}return e.prototype.handleMessage=function(e){if(e&&(a=e.origin,w.some((function(e){return e.test(a)})))&&e.data&&e.data.bidID){var t=e.data,n=t.adUnitID,i=t.bidID,r=this.anaWeb.bidManager.getBidToRender(n,i);if(r){var o=this.anaWeb.createdSlots.find((function(e){return e.adUnitID===n}));re(r,o),e.source?e.source.postMessage(JSON.stringify(r),e.origin):console.error("e.source is not available in this context"),ze({adUnitID:n,bid:r}),this.anaWeb.eventsTracker.slotRendered(n,r)}}var a;e&&function(e){return E.some((function(t){return t.test(e)}))}(e.origin)&&e.data&&e.data.msgType&&"cookieSyncingSuccess"===e.data.msgType&&(Z("synced cookie message event for ".concat(e.data.bidderId,", id=").concat(e.data.partnerUid)),Ae(e.data.bidderId,e.data.partnerUid))},e}(),mt=function(){return mt=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},mt.apply(this,arguments)},bt={enableSingleRequest:!1,globalTargeting:{},sandboxIframe:!1,collapseEmptyDivs:!1,preCollapseEmptyDivs:!1,enableLazyLoad:!1,setPPID:!1,lazyLoadOptConfig:{fetchMarginPercent:800,renderMarginPercent:400,mobileScaling:3}},wt=function(e,t){if(void 0===t&&(t=null),window.googletag&&void 0!==window.googletag.pubads)throw new Error("attempting to initialize ANA sdk with pre-initialized gpt integration. aborting");var n;!function(e){document.body||console.error("loadGPTTagJS called before there is a body to append to");var t=document.createElement("script");t.async=!0,t.defer=!0,t.src=m,document.body.appendChild(t),Z("added GPT script on the page ".concat(m)),e&&e.eventsTracker&&e.eventsTracker.gptAdded()}(t);var i=(n=e?mt(mt({},bt),e):bt).enableSingleRequest,r=n.globalTargeting,o=n.sandboxIframe,a=n.collapseEmptyDivs,s=n.enableLazyLoad,c=n.lazyLoadOptConfig,d=n.preCollapseEmptyDivs,l=n.setPPID;window.googletag=window.googletag||{},googletag.cmd=googletag.cmd||[],googletag.cmd.push((function(){t&&t.eventsTracker&&t.eventsTracker.gptLoaded(),i&&googletag.pubads().enableSingleRequest(),o&&googletag.pubads().setSafeFrameConfig({sandbox:!0}),a&&googletag.pubads().collapseEmptyDivs(d),r&&Object.keys(r).length&&Object.keys(r).forEach((function(e){googletag.pubads().setTargeting(e,r[e])})),s?googletag.pubads().enableLazyLoad(c):googletag.pubads().disableInitialLoad(),t&&l&&googletag.pubads().setPublisherProvidedId(t.uid),googletag.enableServices(),window.addEventListener("blur",(function(){"IFRAME"===document.activeElement.nodeName?(Tt(t),At(t)):Et=null})),window.addEventListener("focus",(function(){Et=null}))}))},Et=null,Tt=function(e){var t=document.activeElement;if(t&&"IFRAME"===t.tagName&&Et!==t&&(Et=t,document.activeElement.parentNode&&"DIV"===document.activeElement.parentNode.nodeName)){var n=document.activeElement.parentNode,i=null,r="";n.parentNode&&"DIV"===n.parentNode.nodeName&&n.parentNode.getAttribute("id")?(i=n.parentNode,r=i.getAttribute("id")):(i=n,r=n.getAttribute("id")),googletag.pubads().getSlots().forEach((function(t){if(r===t.getSlotElementId()&&e){var n=e.getBannerSlot(r);n&&n.currentBid?(Z("Rendering ClickPixels if available for adUnit",r),n.currentBid.renderClickPixels()):Z("Ignoring click pixel on add since it does not have a currentBid on",r)}}))}},At=function(e){setInterval((function(){Tt(e)}),25)},It=function(){return It=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},It.apply(this,arguments)},St="amznbid",Dt="amzniid",_t={pubID:null,adServer:"googletag",bidTimeout:_},Pt=function(e){if(window.apstag)throw new Error("attempting to initialize ANA sdk with pre-initialized apt integration");!function(){function e(e,t){window.apstag._Q.push([e,t])}document.body||console.error("loadAPSTagJS called before there is a body to append to"),window.apstag={init:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e("i",t)},fetchBids:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e("f",t)},setDisplayBids:function(){},targetingKeys:function(){return[]},_Q:[]};var t=document.createElement("script");t.async=!0,t.src=b;var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n),Z("added APS script on the page ".concat(b))}();var t=It(It({},_t),e),n=t.pubID,i=t.adServer,r=t.bidTimeout;if(!n)throw new Error("to fully enable amazon publisher tag integration you need to pass at least `pubID`");window.apstag.init({pubID:n,adServer:i,bidTimeout:r})},kt=new(function(){function e(){this._usPrivacyData=null,this._tcData=null}return Object.defineProperty(e.prototype,"tcData",{get:function(){return this._tcData},set:function(e){this._tcData=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tcfV2String",{get:function(){return this._tcData?this._tcData.tcString:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"usPrivacyData",{get:function(){return this._usPrivacyData},set:function(e){this._usPrivacyData=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"usPrivacyString",{get:function(){return this._usPrivacyData?this._usPrivacyData.uspString:null},enumerable:!1,configurable:!0}),e}()),Rt=function(){function e(e,t,n){void 0===e&&(e=0),this.count=e,this.timeoutInt=n,this.doneCallback=t}return e.prototype.add=function(e){void 0===e&&(e=1),this.count+=e},e.prototype.decrement=function(e){void 0===e&&(e=1),this.count=this.count-e,0===this.count&&(this.timeoutInt&&clearTimeout(this.timeoutInt),this.doneCallback())},e}(),Ot=function(){function e(){this.bidsByID={},this.bidsByAdUnit={},this.usedBidIDs={}}return e.prototype.addBids=function(e,t){var n=this,i=this,r=i.usedBidIDs,o=i.bidsByID,a=i.bidsByAdUnit,s=(0,i.adUnitKey)(t);e.forEach((function(e){var t=e.BidID;e.ClientReceived=(new Date).getTime(),n.getBidByID(t)||r[t]||(o[t]=e,a[s]?a[s].push(e):a[s]=[e])})),a[s].sort((function(e,t){return e.Value-t.Value}))},e.prototype.getBid=function(e,t){void 0===t&&(t=!1);var n=this.bidsByAdUnit,i=(0,this.adUnitKey)(e);if(n[i]&&n[i].length){n[i]=n[i].filter((function(e){return!e.isExpired()}));var r=n[i];if(!t)return s=r[r.length-1];for(var o=Date.now(),a=r.length-1;a>=0;a--){var s;if((s=r[a]).LastNomination<o-1e3)return s.LastNomination=o,s}}return null},e.prototype.getBidByID=function(e){return this.bidsByID[e]||null},e.prototype.getBidToRender=function(e,t){return this.usedBidIDs[t]?null:(this.useBid(e,t),this.getBidByID(t))},e.prototype.useBid=function(e,t){var n=this,i=n.usedBidIDs,r=n.bidsByAdUnit,o=(0,n.adUnitKey)(e);if(!i[t]&&void 0!==r&&void 0!==r[o]){var a=r[o].map((function(e){return e.BidID})).indexOf(t);-1!==a&&r[o].splice(a,1),i[t]=!0}},e.prototype.reset=function(){this.bidsByID={},this.bidsByAdUnit={},this.usedBidIDs={}},e.prototype.adUnitKey=function(e){var t=window.location.href;return"".concat(e,":").concat(t)},e}(),Ct="https://xeno-soswcrde4a-uc.a.run.app/events",Mt="ANAEventsCache";function Bt(){Z("ðŸš‚ðŸš‚ðŸš‚ðŸš‚ðŸš‚ðŸš‚ðŸš‚ðŸš‚ ANA Web SDK ".concat("3.1.1"," ðŸš‚ðŸš‚ðŸš‚ðŸš‚ðŸš‚ðŸš‚ðŸš‚ðŸš‚")),Z("dispatching anaReadyEvent"),document.dispatchEvent(new CustomEvent("ANAReady"))}var Lt=function(e,t,n,i){var r=window.pageviewUID;void 0===window.pageviewUID&&(r=ye(),window.pageviewUID=r);var o={uid:me(),session_id:Ue(),event:n,app_id:e,wid:r,lib_version:t,screen_width:Math.floor(performance.now()),device:"web",extra_json:{time_since_page_load:Math.floor(performance.now())}};return i&&(o.impression_type=i.impression_type,o.impression_sub_type=i.impression_sub_type,o.domain=i.bidder,o.extra_json.reason=i.reason,o.extra_json.totalBids=i.totalBids,i.slot&&(o.cohort=i.slot),i.bid&&(o.object_id=i.bid.BidID,o.sizes="".concat(i.bid.Width,"x").concat(i.bid.Height),o.extra_json.placement_id=i.bid.PlacementID,o.extra_json.bid_id=i.bid.BidID,o.extra_json.bid_type=i.bid.BidType,o.domain=i.bid.BidderName,o.extra_json.bidder_name=i.bid.BidderName,o.extra_json.direct_render=i.bid.DirectRender,o.extra_json.floor=i.bid.Floor,o.extra_json.width=i.bid.Width,o.extra_json.height=i.bid.Height,o.extra_json.impression_type=i.bid.ImpressionType,o.extra_json.targeting=i.bid.Targeting,o.extra_json.value=i.bid.Value,o.cookie_creation_ts=i.bid.Value)),o},Nt=function(){function e(e,t){var n=this;this.propertyID=e,this.libVersion=t,this.timeoutId=setInterval((function(){return n.tickTimer()}),1e3,this)}return e.prototype.tickTimer=function(){var e=this;this.timeoutId&&clearInterval(this.timeoutId),this.sendCachedEvents(),this.timeoutId=setInterval((function(){return e.tickTimer()}),1e3,this)},e.prototype.sendCachedEvents=function(){var e=anaStorage.getItem(Mt),t=null,n=[];if(e)try{n=JSON.parse(e)}catch(e){n=[]}n&&0!==n.length&&(window.XMLHttpRequest?t=new XMLHttpRequest:window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLHTTP")),t&&(t.onerror=console.warn,t.open("POST","https://xeno-soswcrde4a-uc.a.run.app/events"),t.setRequestHeader("Content-Type","application/json"),t.send(JSON.stringify({events:n})),anaStorage.setItem(Mt,"[]")))},e.prototype.sendBeaconEvent=function(e,t){void 0===t&&(t={}),navigator.sendBeacon&&navigator.sendBeacon(Ct,JSON.stringify({events:[Lt(this.propertyID,this.libVersion,e,t)]}))},e.prototype.trackEvent=function(e,t){void 0===t&&(t={});var n=anaStorage.getItem(Mt),i=[];if(n)try{i=JSON.parse(n)}catch(e){i=[]}i.push(Lt(this.propertyID,this.libVersion,e,t));var r=JSON.stringify(i);try{anaStorage.setItem(Mt,r),r.length>2097152&&this.sendCachedEvents()}catch(e){var o=i.pop();console.error("Cant add event: ".concat(o.event," to cache, max quota exceeded"))}this.timeoutId},e.prototype.anaLoaded=function(){this.trackEvent("ana_loaded")},e.prototype.gptAdded=function(){this.trackEvent("gpt_added")},e.prototype.gptLoaded=function(){this.trackEvent("gpt_loaded")},e.prototype.slotCreated=function(e,t){this.trackEvent("slot_created",{slot:e,impressionType:t})},e.prototype.adAttemptMade=function(e){this.trackEvent("ad_attempt_made",{slot:e})},e.prototype.adAttemptAborted=function(e,t){this.trackEvent("ad_attempt_aborted",{slot:e,reason:t})},e.prototype.adAttemptFailed=function(e,t){this.trackEvent("ad_attempt_failed",{slot:e,reason:t})},e.prototype.adAttemptSucceeded=function(e,t){this.trackEvent("ad_attempt_succeeded",{slot:e,totalBids:t})},e.prototype.slotRendered=function(e,t){this.trackEvent("ana_bid_render",{slot:e,bid:t})},e.prototype.targetingSent=function(e){this.trackEvent("targeting_sent",{slot:e})},e.prototype.pageviewExit=function(){this.sendBeaconEvent("pageview_text")},e}(),xt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ut=function(){return Ut=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Ut.apply(this,arguments)},jt=function(e,t,n){for(var i=Ut(Ut(Ut({},e),t),n),r=Ve(i),o=[],a=0,s=Object.keys(r);a<s.length;a++){var c=s[a];o.push("".concat(c,"=").concat(r[c]))}return o.join(";")},Vt=!0,Ft=function(e){function t(t,n){var i=e.call(this,t,n)||this;if(i.slotType=ce.SAS,i.pendingRefresh=!1,i.attemptInFlight=!1,i.anaInFlight=!1,i.lastCallTs=0,i.lastRenderTs=0,i.shouldReset=!1,!ie(i.elementID))throw Error("Invalid elementID, might not be present of the page or already been used by another adUnit, ".concat(i));return i}return xt(t,e),t.prototype.refresh=function(){var e=this;if(this.anaWeb.shouldUseViewabilityMonitor&&!this.disableViewabilityMonitor){var t=this.isWaitingForView()||this.attemptInFlight;if(t&&!this.pendingRefreshPromise){Z("slot view monitor refresh queued waiting for view:".concat(this.isWaitingForView()," in flight:").concat(this.attemptInFlight));var n=new Promise((function(t){e.pendingRefreshResolve=t}));return this.pendingRefresh=!0,this.pendingRefreshPromise=n,n}if(t&&this.pendingRefreshPromise)return this.pendingRefreshPromise;if(this.pendingRefreshPromise){var i=this.pendingRefreshPromise,r=this.pendingRefreshResolve;return this.doRefresh((function(){e.pendingRefreshResolve=null,e.pendingRefresh=!1,e.pendingRefreshPromise=null,r()})),i}}return new Promise((function(t){e.doRefresh(t)}))},t.prototype.doRefresh=function(e){var t,n=this;this.attemptInFlight=!0,this.currentTagId&&!this.shouldReset||(this.shouldReset=!1,this.impCount=0,this.currentTagId="sas_".concat(this.adUnitID,"_").concat(Math.floor(9999999*Math.random())),this.checkTagElement()),this.anaInFlight=!0;var i=this.fetchANABids().catch((function(e){Z("ANA error ".concat(n.adUnitID," ").concat(e)),n.endAttempt(),t=e})),r=Promise.resolve();this.apsEnabled&&(this.clearAPSTargeting(),r=this.fetchAPSBids(this.currentTagId).then((function(e){e&&e.length&&e.forEach((function(e){var t=e.amznbid,i=e.amzniid;i&&i.length&&n.setAPSTargeting(t,i)}))}))),Promise.all([i,r]).then((function(){return n.anaInFlight&&n.requestSAS(e)})),setTimeout((function(){!t&&n.anaInFlight&&n.requestSAS(e)}),this.anaWeb.auctionTimeout+_)},t.prototype.endAttempt=function(){this.attemptInFlight=!1,this.anaInFlight=!1,this.currentResolve()},t.prototype.setAPSTargeting=function(e,t){this.baseTargeting["".concat(St,"_").concat(this.adUnitID)]=e,this.baseTargeting["".concat(Dt,"_").concat(this.adUnitID)]=t},t.prototype.clearAPSTargeting=function(){delete this.baseTargeting["".concat(St,"_").concat(this.adUnitID)],delete this.baseTargeting["".concat(Dt,"_").concat(this.adUnitID)]},t.prototype.requestSAS=function(e){var t=this;this.anaInFlight=!1,this.currentBid=this.getTopBid();var n=this.currentBid,i=this.adUnitID,r=this.currentTagId;if(this.currentResolve=e,n&&n.DirectRender)return this.endAttempt(),this.renderBid(r,n),e();window.sas.cmd.push((function(){if(t.checkTagElement(),n&&window.sas.setHeaderBiddingWinner(r,{cpm:n.Value/100,bidder:"assembly",currency:"USD"}),t.impCount>0){t.lastCallTs=Date.now();var e=jt(t.anaWeb.globalTargeting,t.baseTargeting,null==n?void 0:n.Targeting);return window.sas.refresh(r,{forceMasterFlag:!1,resetTimestamp:!1,target:e}),void(n&&t.startSASChecker(r,n,t.currentResolve))}var o=t.anaWeb.sasOptions,a={tagId:r,siteId:o.siteID,pageId:o.pageIDGetter(),formatId:i,target:jt(t.anaWeb.globalTargeting,t.baseTargeting,null==n?void 0:n.Targeting)};t.lastCallTs=Date.now();var s=!!Vt&&(Vt=!1,!0);Z("sas.call ".concat(t.elementID," ").concat(t.currentTagId)),window.sas.call("std",a,{forceMasterFlag:s,resetTimestamp:s,onLoad:function(e){var n=e.hasAd;Z("sas onLoad ".concat(t.elementID," ").concat(t.currentTagId)),t.endAttempt(),n&&(t.lastRenderTs=Date.now(),t.onAdLoad(t.elementID))},onNoad:function(e){Z("sas onNoad ".concat(t.elementID," ").concat(t.currentTagId));var i=t.currentBid;t.lastCallTs<t.lastRenderTs||n&&t.renderBid(e.tagId,i)}}),n&&t.startSASChecker(r,n,t.currentResolve)}))},t.prototype.startSASChecker=function(e,t,n){var i=this;setTimeout((function(){i.lastCallTs>i.lastRenderTs&&t&&i.renderBid(e,t),n()}),500)},t.prototype.renderBid=function(e,t){var n=this;this.checkTagElement();this.renderInElement(e,t,(function(){n.pendingRefresh&&n.refresh()})),this.lastRenderTs=Date.now(),Z("refreshSASSlot, resync after render"),setTimeout((function(){n.anaWeb.syncUserCookies()}),1e3)},t.prototype.checkTagElement=function(){var e=document.getElementById(this.elementID);if(e){var t=document.createElement("div");t.id=this.currentTagId,e.appendChild(t)}},t.prototype.resetTagID=function(){this.shouldReset=!0},t}(et);Ft.prototype.toString=function(){return"SASSlot('".concat(this.adUnitID,"', '").concat(this.elementID,"')")};var Gt,qt=function(){return qt=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},qt.apply(this,arguments)},Wt={networkID:0,inSequence:!0,async:!0,siteID:null,pageIDGetter:null},Ht=function(){return Ht=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Ht.apply(this,arguments)},zt=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Jt={slotEventsHandlers:{},gptOptions:{globalTargeting:{}},apsOptions:null,syncCookies:!0,resyncCookiesAfterTimeout:5e3,propertyId:window.location.hostname,videoOptions:null,lightMode:!1,userEmail:null,shouldUseViewabilityMonitor:!1,auctionTimeout:D},Kt=function(){function e(t){void 0===t&&(t={}),this.createdSlots=[],this.createdGoogleSlots=[],this.createdVideoContainers=[];var n,i=Ht(Ht({},Jt),t),r=i.slotEventsHandlers,o=i.gptOptions,a=i.apsOptions,s=i.syncCookies,c=i.resyncCookiesAfterTimeout,d=i.propertyId,l=i.lightMode,h=i.auctionTimeout,p=i.userEmail,f=i.shouldUseViewabilityMonitor,g=i.sasOptions;g&&(this.sasMode=!0),this.sasOptions=g,ee("auctionTimeout")&&parseInt(ee("auctionTimeout"))>0&&(n=parseInt(ee("auctionTimeout"))),this.bidManager=new Ot,this.consentManager=kt,this.slotEventsHandlers=r,this.syncCookies=s,this.resyncCookiesAfterTimeout=c,this.propertyId=d,this.apsEnabled=!!a,this.refreshedAllSlots=!1,this.globalTargeting=(null==g?void 0:g.globalTargeting)||(null==o?void 0:o.globalTargeting)||{},this.setPPID=o&&!!o.setPPID,this.lazyLoad=o&&o.enableLazyLoad,this.lightMode=!!l,this.auctionTimeout=n||h,this.eventsTracker=new Nt(this.propertyId,u),this.msgHandler=new vt(this),this.userEmail=p,this.shouldUseViewabilityMonitor=f,this.eventsTracker.anaLoaded(),window.ANAWebSDKInstance=this,this.setFocusListeners(),t.auctionTimeout||n?(t.auctionTimeout||n)&&Z("Setting auctionTimeout to ".concat(this.auctionTimeout)):Z("auctionTimeout wasn't provided, using default value: ".concat(D)),(this.auctionTimeout<500||this.auctionTimeout>4e3)&&(this.auctionTimeout=D,console.error("auctionTimeout is out of range (".concat(500," - ").concat(4e3,"), using default value: ").concat(D))),"__tcfapi"in window&&(Z("GDPR - consent management framework was found on the page"),window.__tcfapi("getTCData",2,(function(e,t){t?(Z("getTCData cbk success",e),kt.tcData=e):Z("getTCData cbk fail",e)}))),"__uspapi"in window&&(Z("CCPA - consent management framework was found on the page"),window.__uspapi("getUSPData",1,(function(e,t){t?(Z("getUSPData cbk success",e),kt.usPrivacyData=e):Z("getUSPData cbk fail",e)}))),void 0===this.globalTargeting.SDK&&e.version&&(this.globalTargeting.SDK=e.version),void 0===this.globalTargeting.domain&&"localhost"!==window.location.hostname&&(this.globalTargeting.domain=window.location.hostname),void 0===this.globalTargeting.auctionTimeout&&this.auctionTimeout&&(this.globalTargeting.auctionTimeout=this.auctionTimeout.toString()),this.uid=me(),this.sessionId=Ue(),this.syncCookies&&this.syncUserCookies(),this.lightMode||(a&&(a.bidTimeout=this.auctionTimeout,Pt(a)),this.sasMode||wt(o,this),this.sasMode&&function(e){var t;window.sas=window.sas||{cmd:[]},t=e?qt(qt({},Wt),e):Wt;var n=window.sas;n.cmd.push((function(){n.setup({networkid:t.networkID,domain:"https://www9.smartadserver.com",async:t.async,inSequence:t.inSequence})}))}(g)),window.addEventListener&&window.addEventListener("scroll",this.onScroll.bind(this))}return e.prototype.setFocusListeners=function(){var e=this;this.internalHasFocus=document.hasFocus(),ne("focus",window,(function(){e.internalHasFocus=!0})),ne("blur",window,(function(){e.internalHasFocus=!1})),ne("scroll",window,(function(){e.internalHasFocus=!0})),ne("visibilitychange",window,(function(){e.internalHasFocus="visible"===document.visibilityState})),ne("touchstart",window,(function(){e.internalHasFocus=!0}))},e.prototype.createSlot=function(e,t){var n=null;switch(e){case ce.GOOGLE:this.lightMode&&Z("making google banner slots in light mode seems sketchy"),n=new rt(this,t),this.createdGoogleSlots.push(n);break;case ce.ANA:this.lightMode||Z("making a lightmode slot without the SDK in lightmode seems sketchy"),n=new et(this,t);break;case ce.SAS:this.lightMode&&Z("making sas banner slots in light mode seems sketchy"),n=new Ft(this,t);break;default:throw Error("Specified slot type is not supported: ".concat(e))}return this.eventsTracker.slotCreated(t.adUnitID,"banner"),this.createdSlots.push(n),n},e.prototype.createVideoSlot=function(e,t){var n=new yt(this,e,t);return this.eventsTracker.slotCreated(t.adUnitID,"video"),this.createdVideoContainers.push(n),n},e.prototype.refreshAllGoogleSlots=function(){var e=this;if(this.lazyLoad)throw new Error("ANA Web SDK does not support refreshAllGoogleSlots when lazy loading is enabled");var t=this.waitGroup;this.refreshedAllSlots=!1;var n=this.createdGoogleSlots;if(null==t){var i=setTimeout(this.onBidsFetchTimeout.bind(this),3e3),r=n.filter((function(e){return e.apsEnabled})).length,o=n.length+r;t=new Rt(o,this.onBidsFetchSuccess.bind(this),i),this.waitGroup=t,n.forEach((function(e){e.slot&&googletag.cmd.push((function(){e.slot.clearTargeting()})),e.resetRequestMgr()})),n.forEach((function(n){n&&(n.fetchANABids().then((function(){Z("refreshAllSlots - ANA responded with bids for ".concat(n)),googletag.cmd.push((function(){Z("ANA BIDS - auction is already completed?",e.refreshedAllSlots),e.refreshedAllSlots||n.updateAnaTargeting(),t.decrement()}))})).catch((function(){n.updateRefreshCountTargeting(),e.waitGroup=null})),n.apsEnabled&&n.fetchAPSBids().then((function(){Z("refreshAllSlots - APS responded for ".concat(n)),googletag.cmd.push((function(){Z("APS BIDS - auction is already completed?",e.refreshedAllSlots),e.refreshedAllSlots||n.updateApsTargeting(),t.decrement()}))})))})),setTimeout(this.onBidsFetchSuccess.bind(this),this.auctionTimeout+_)}else console.warn("calling refreshAllSlots too fast")},e.prototype.hasFocus=function(){return document.hasFocus()||this.internalHasFocus},e.prototype.refreshSubscribedBannerSlots=function(e,t){if(!this.hasFocus())return Z("skipping auto refresh, document not in focus, trying later with slots:",e),void setTimeout(this.refreshSubscribedBannerSlots.bind(this,e,t),300);Z("auto refreshing slots:",e),e.forEach((function(e){return e.refresh()})),setTimeout(this.refreshSubscribedBannerSlots.bind(this,e,t),t)},e.prototype.autoRefreshSlots=function(e,t,n){void 0===t&&(t=3e4),void 0===n&&(n=!1),Z("subscribed slots for auto refresh:",e,"in",t,"ms, firstInstantRefresh=",n),n?this.refreshSubscribedBannerSlots(e,t):setTimeout(this.refreshSubscribedBannerSlots.bind(this,e,t),t)},Object.defineProperty(e,"version",{get:function(){return"3.1.1"},enumerable:!1,configurable:!0}),e.prototype.onBidsFetchTimeout=function(){Z("[WARNING!!!]onBidsFetchTimeout, we got timeout before all bidders where completed"),this.onBidsFetchSuccess()},e.prototype.onBidsFetchSuccess=function(){var e=this;if(Z("onBidsFetchSuccess, this.refreshedAllSlots = ",this.refreshedAllSlots),this.refreshedAllSlots)Z("onBidsFetchSuccess, skipping since all slots were already refreshed");else{this.refreshedAllSlots=!0;var t=[];this.createdGoogleSlots.forEach((function(e){e.adServerRender&&!e.alreadyRendered()&&t.push(e.slot)})),0!==t.length?googletag.cmd.push((function(){e.waitGroup=null,Z("Calling GAM refresh for all the slots"),googletag.pubads().refresh(t),Z("resync all bidders from all slots"),setTimeout((function(){e.syncUserCookies()}),1e3)})):this.waitGroup=null}},e.prototype.updateGlobalTargeting=function(e){var t;this.globalTargeting=Ht(Ht({},this.globalTargeting),e),this.sasMode||(t=this.globalTargeting)&&Object.keys(t).length&&googletag.cmd.push((function(){Object.keys(t).forEach((function(e){googletag.pubads().setTargeting(e,t[e])}))}))},e.prototype.syncUserCookies=function(){if(this.syncCookies){if(!this.propertyId)throw Error("propertyId is needed to initialize SDK");var e=z();De({propertyId:e,uid:this.uid})}},e.prototype.getBannerSlot=function(e){var t=null;return this.createdSlots.forEach((function(n){n.elementID!==e&&0!==e.indexOf(n.elementID)||(t=n)})),t},e.prototype.onScroll=function(){zt([],document.querySelectorAll("div.assembly-semi-sticky-container"),!0).forEach((function(e){try{var t=e.children[0],n=e.getBoundingClientRect(),i=t.getBoundingClientRect().height;if(i>304)return t.style.position="relative",void(t.style.marginTop="0px");n.top<=0&&n.top>i-n.height?(t.style.position="fixed",t.style.top=0,t.style.bottom="auto",t.style.marginTop="0px"):n.top<0&&n.top<i-n.height?(t.style.position="relative",t.style.marginTop=n.height-i+"px"):(t.style.position="relative",t.style.marginTop="0px")}catch(e){console.error(e)}}))},e.prototype.setUserEmail=function(e){this.userEmail=e},e.prototype.getUserIdentity=function(){var e=Y("ml_em");if(e)return Z("IDENTITY: medialabcookie found ".concat(e)),{email:e,envelope:null};if(this.userEmail)return Z("IDENTITY: userEmail found ".concat(e)),{email:this.userEmail,envelope:null};var t=Y("lr_env");if(t)return Z("IDENTITY: liveramp envelope found', ".concat(t)),{email:null,envelope:t};var n=Y(k);if(n)return Z("IDENTITY: rtis envelope found ".concat(n)),{email:null,envelope:n};var i=Y(R);return Z("IDENTITY:rtis envelope not found"),i||(Q(R,1,.5),He.rtis((function(e){Z("IDENTITY: rtis envelope response, ".concat(e)),Q(k,e,21600)}))),Z("IDENTITY: no envelope found"),{email:null,envelope:null}},e}();return function(e){e.VideoMp4="video/mp4",e.VideoOgg="video/ogg"}(Gt||(Gt={})),"loading"!==document.readyState?setTimeout(Bt,0):document.addEventListener("DOMContentLoaded",Bt),window.ANAWeb=Kt,window.SlotTypeEnum=ce,Kt.SlotTypeEnum=ce,Object.defineProperty(Kt,"uid",{get:function(){return me()}}),Object.defineProperty(Kt,"sessionId",{get:function(){return Ue()}}),Kt.AdPosition=Me,Kt.ContentDeliveryMethod=Ne,Kt.PlaybackCessationMode=Ce,Kt.PlaybackMethod=Pe,Kt.StartDelay=ke,Kt.VideoApiFramework=Le,Kt.VideoLinearity=Oe,Kt.VideoPlacementType=Re,Kt.VideoPlayerType=de,Kt.VideoProtocol=Be,Kt.Mime=Gt,r})()));
// MediaLab Inc.