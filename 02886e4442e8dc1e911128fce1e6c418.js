(self.webpackChunk_multimediallc_cb_ts=self.webpackChunk_multimediallc_cb_ts||[]).push([[62],{4918:function(e,t){"use strict";var n,i;function o(e){switch(e){case n.All:case n.Male:case n.Female:case n.Couple:case n.Trans:return e;case n.OldTrans:case i.Transfemme:case i.Transmasc:case i.Nonbinary:return n.Trans;default:return n.All}}t.ej=t.BK=t.aI=t.$p=t.dW=t.Y0=void 0,function(e){e.All="",e.Male="m",e.Female="f",e.Couple="c",e.Trans="t",e.OldTrans="s"}(n||(t.Y0=n={})),function(e){e.Transfemme="tf",e.Transmasc="tm",e.Nonbinary="tn"}(i||(t.dW=i={})),t.$p=o,t.aI=new Map([[n.All,""],[n.Male,"male"],[n.Female,"female"],[n.Couple,"couple"],[n.Trans,"trans"],[n.OldTrans,"trans"]]),t.BK=new Map,t.aI.forEach(((e,n)=>t.BK.set(e,n))),t.BK.set("trans",n.Trans),t.ej=function(){var e,i;const r=window.location.pathname.split("/"),s=window.location.pathname.endsWith("/")?2:1,a=null!==(e=r[r.length-s])&&void 0!==e?e:"",l=a.endsWith("-cams")?a.slice(0,-5):a,c=null!==(i=t.BK.get(l))&&void 0!==i?i:o(l);if(c!==n.All)return c;const u=new URLSearchParams(window.location.search);for(const e of["gender","genders","g"]){const t=u.get(e);if(null!==t)return o(t.split(",")[0])}return n.All}},1896:function(e,t,n){"use strict";n.d(t,{fF:function(){return c},vU:function(){return l},um:function(){return s},ZK:function(){return a}});const i=!1;let o;try{o=!0}catch(e){console.error("@multimediallc/logging failed to initialize, probably due to undefined process.env.NODE_ENV.",e),o=!0}const r=window.newrelic;function s(e,t){i||void 0!==window.console&&(void 0!==console.info||o?console.info(e,h(t)):console.log("INFO ",e,h(t)))}function a(e,t,n=""){if(i)return;let r;void 0!==window.console&&(void 0!==console.warn||o?console.warn(n.concat("WARN "),e,h(t)):console.log(n.concat("WARN "),e,h(t)),u());try{r="object"==typeof e?JSON.stringify(e):e.toString()}catch(t){r=`${e}`}d(n.concat("WARN"),new Error(r),t)}function l(e,t,n=""){if(i)return;let r;void 0!==window.console&&(void 0!==console.error||o?console.error(n.concat("ERROR "),e,h(t)):console.log(n.concat("ERROR "),e,h(t)),u());try{r="object"==typeof e?JSON.stringify(e):e.toString()}catch(t){r=`${e}`}d(n.concat("ERROR"),new Error(r),t)}function c(e,t){i||o||void 0!==window.console&&(void 0!==console.debug||o?console.debug(e,h(t)):console.log("DEBUG ",e,h(t)))}function u(){i||o||void 0!==window.console&&void 0!==console.trace&&console.trace()}function d(e,t,n={}){try{if(void 0===r)return;const i={};if(i["attributes.level"]=e,"object"==typeof n)for(const e in n)"xhrErrorAttributes"!==e?i[`attributes.${e}`]=n[e]:(i["attributes.xhrError"]=!0,i["attributes.xhrState"]=n[e].readyState,i["attributes.xhrStatus"]=n[e].status,i["attributes.xhrReason"]=n[e].reason);else i["attributes.extra"]=n;r.noticeError(t,i)}catch(e){console.error(`New Relic Error in reportError: ${e.toString()}`)}}function h(e){return void 0===e?"":e}},8759:function(e,t,n){"use strict";n.d(t,{qq:function(){return G},I3:function(){return w},jI:function(){return T},IF:function(){return Q},jB:function(){return Z},sQ:function(){return F},BR:function(){return v},Ii:function(){return u},i7:function(){return R},bf:function(){return P},tF:function(){return Y},vU:function(){return M},nv:function(){return c},fh:function(){return b},w1:function(){return N},NP:function(){return j},IU:function(){return l},s2:function(){return _},B3:function(){return g},iC:function(){return y},CG:function(){return C},vA:function(){return I},v8:function(){return W},G6:function(){return A},op:function(){return B},Iq:function(){return E},GR:function(){return $},H$:function(){return z},Fz:function(){return x},E$:function(){return K},AQ:function(){return q},Tt:function(){return U},_1:function(){return L},sg:function(){return O},z8:function(){return D},BV:function(){return V}});var i=n(1896);const o=window.Hls;let r;const s={chrome:79,firefox:78,edge:90,safari:13},a={chrome:79,crios:79,firefox:115,fxios:115,safari:13,samsungbrowser:15};function l(){if(void 0===r){const e="cbModernizr";let t=!0;try{window.localStorage.setItem(e,e),window.localStorage.removeItem(e)}catch(e){t=!1}(0,i.fF)(`local storage support = ${t}`),r=t}return r}function c(){return void 0!==window.history&&void 0!==window.history.pushState}function u(){try{return!!document.createElement("audio").canPlayType}catch(e){return!1}}let d,h,f,p,m;function v(){if(void 0!==d)return d;let e;d=!1;try{if("webkitAudioContext"in window)e=new webkitAudioContext;else{if(!("AudioContext"in window))return d;e=new AudioContext}if(null===e)return d;d="function"==typeof e.createGain&&"function"==typeof e.decodeAudioData&&"function"==typeof e.createBufferSource&&"function"==typeof e.createBufferSource().start,"function"==typeof e.close&&e.close()}catch(e){(0,i.vU)("Error checking for audio context",{reason:e.toString()})}return d}function g(){if(void 0!==h)return h;const e=document.createElement("audio");return h="function"==typeof e.canPlayType&&""!==e.canPlayType("audio/mpeg;codecs=mp3"),h}function y(){const e=document.createElement("video").canPlayType("application/vnd.apple.mpegurl");return"probably"===e||"maybe"===e}function b(){return y()||o.isSupported()}function w(){return window.hasOwnProperty("requestAnimationFrame")?window.requestAnimationFrame:window.hasOwnProperty("webkitRequestAnimationFrame")?window.webkitRequestAnimationFrame:window.hasOwnProperty("mozRequestAnimationFrame")?window.mozRequestAnimationFrame:e=>(window.setTimeout((()=>{e(0)}),1e3/7),Date.now())}function C(){if(void 0!==f)return f;try{const e=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("testPassive",(()=>{}),e),window.removeEventListener("testPassive",(()=>{}),e),void 0===f&&(f=!1)}catch(e){f=!1}return f}function x(){if(void 0!==p)return p;try{const e=document.createElement("audio");e.volume=.5,p=.5===e.volume}catch(e){p=!1}return p}let k,S=!1;function T(){if(null!==document.scrollingElement)return document.scrollingElement;if(void 0!==m&&!S)return m;const e=document.documentElement.scrollTop;return document.documentElement.style.height=`${window.innerHeight+1}px`,document.documentElement.scrollTop=e+1,m=document.documentElement.scrollTop!==e?document.documentElement:document.body,document.documentElement.style.height="",document.documentElement.scrollTop=e,S=!1,m}function I(){return void 0!==window.performance&&void 0!==window.performance.now}function R(){return!(void 0===window.chrome||!window.chrome.loadTimes&&!window.chrome.webstore&&!window.chrome.runtime)}function P(){return/Edge\//i.test(navigator.userAgent)}function M(){return null!==/Firefox/.exec(navigator.userAgent)||void 0!==window.InstallTrigger}function A(){if(U()&&/WebKit/i.test(navigator.userAgent)&&!/CriOS/i.test(navigator.userAgent))return!0;let e=!1;return void 0!==window.safari&&void 0!==window.safari.pushNotification&&(e="[object SafariRemoteNotification]"===window.safari.pushNotification.toString()),/constructor/i.test(window.HTMLElement)||e}function E(){return[/SM-T827R4/,/SM-T550/,/SM-T330/,/SM-T232/,/SM-T335/,/SM-T813/,/SM-T510/].some((e=>e.test(navigator.userAgent)))}function B(){return/SamsungBrowser/i.test(navigator.userAgent)}function L(){return(/iPad/i.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&void 0===window.MSStream}function O(){return/iPhone/i.test(navigator.userAgent)&&void 0===window.MSStream}function D(){return/iPod/i.test(navigator.userAgent)&&void 0===window.MSStream}function U(){return D()||O()||L()}function Z(){if(U()){let e=navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/);if(null===e&&(e=navigator.userAgent.match(/Version\/(\d+)/),null===e))return;return parseInt(e[1])}}function F(){const e=navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/);if(U()&&null!==e)return{major:parseInt(e[1]),minor:parseInt(e[2]),patch:parseInt(e[3])}}function _(){return/Android|webOS|BlackBerry|IEMobile|Opera Mini|SamsungBrowser/i.test(navigator.userAgent)||U()}function N(){return!!document.documentMode}function j(){return N()&&void 0===window.atob}function H(e,t){const n=_()?a:s;return n.hasOwnProperty(e)&&t>=n[e]}function z(){const e=window.navigator.userAgent.toLowerCase(),t=e.match(/edg\/(\d+)/);if(t)return H("edge",parseFloat(t[1]));if(A()){const t=e.match(/version\/([\d.]+)/);if(t)return H("safari",parseFloat(t[1]))}const n=e.match(/(chrome|firefox|samsungbrowser|crios|fxios)/),i=e.match(/(chrome|firefox|samsungbrowser|crios|fxios)[\s\/](\d+)/);if(n&&i){const e=parseFloat(i[2]);return H(n[1],e)}return!1}function W(){return/Puffin/i.test(navigator.userAgent)}function V(){let e="unload";return U()&&A()&&(e="pagehide"),e}function q(){return"object"==typeof navigator&&"object"==typeof navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.getUserMedia}function K(){return Boolean(navigator.userAgent.match(/Puffin/i))}function J(){const e=/Edg(|e|A|iOS)\/\d+/.exec(navigator.userAgent);return null!==e?parseInt(e[0].split("/")[1],10):0}function G(){const e=F();return{platform:navigator.platform,userAgent:navigator.userAgent,maxTouchPoints:void 0!==navigator.maxTouchPoints?navigator.maxTouchPoints:0,iosVersionMajor:void 0!==e?e.major:0,iosVersionMinor:void 0!==e?e.minor:0,iosVersionPatch:void 0!==e?e.patch:0,edgeVersionMajor:J(),isDefinedMSStream:void 0!==window.MSStream,isDefinedInstallTrigger:void 0!==window.InstallTrigger,isPresentChromeLoadTimes:void 0!==window.chrome&&!!window.chrome.loadTimes,isPresentChromeWebStore:void 0!==window.chrome&&!!window.chrome.webstore,isPresentChromeRunTime:void 0!==window.chrome&&!!window.chrome.runtime,isConstructorPresentInHTMLElement:void 0!==window.HTMLElement&&/constructor/i.test(window.HTMLElement),safariPushNotifications:void 0!==window.safari?window.safari.pushNotification.toString():""}}function Y(){return!0===k}window.setTimeout((()=>{S=!0}),200),new Promise((e=>{if(void 0!==k)e(k);else{const t=new Image;t.onerror=()=>{e(!1)},t.onload=()=>{k=2!==t.width,e(k)},t.src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QAiRXhpZgAASUkqAAgAAAABABIBAwABAAAABgASAAAAAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wAARCAABAAIDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD+/iiiigD/2Q=="}})).then((e=>{k=e,(0,i.fF)("exif: ",k)})).catch((()=>{}));const $="scroll-behavior"in document.createElement("div").style;function Q(){return!!(/Android/i.test(navigator.userAgent)||U()||navigator.userAgent.indexOf("Mac"))}},7654:function(e,t,n){"use strict";n.d(t,{$O:function(){return c},B8:function(){return l},DT:function(){return M},FZ:function(){return P},I5:function(){return D},PR:function(){return g},R7:function(){return h},RT:function(){return B},SW:function(){return T},W1:function(){return L},Zv:function(){return R},_A:function(){return O},fq:function(){return A},ip:function(){return y},nA:function(){return m},un:function(){return E},vk:function(){return f}});var i=n(4649),o=n(5809),r=n(4918);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=90,c="api/ts/roomlist/room-list/",u=1e4,d=["offset","limit","genders","regions","hashtags","from_age","to_age","private_prices","apps","asp_app","keywords","enable_recommendations","exhib","new_cams","gaming","hidden","private","sort","after"];function h(){var e=new URLSearchParams(window.location.search);return d.forEach((function(t){return e.delete(t)})),e.delete("g"),e.delete("page"),e.delete("pageb"),Object.fromEntries(e)}function f(){var e={},t=y();void 0!==t&&(e.regions=t);var n=w();if(void 0!==n){var i=(0,o.Z)(n,2);e.from_age=i[0],e.to_age=i[1]}var r=x();void 0!==r&&(e.private_prices=r);var s=function(){var e="current_app_use/",t=A();if(t.startsWith(e))return t.slice(16).split("/")[0]}();void 0!==s&&(e.apps=s);var a=function(){var e="app/",t=A();if(t.startsWith(e))return t.slice(4).split("/")[0]}();void 0!==a&&(e.asp_app=a);var l,c=(l=E(),k.has(l)?k.get(l):S.has(l)?S.get(l):void 0);return"follow"===c&&(e.offline=L()),void 0!==c&&(e[c]=!0),e}var p=250;function m(e){return a(a(a({},(t={},""!==(n=(0,r.ej)())&&(t.genders=n),t)),function(){var e={},t=document.getElementById("filter_location_form");if(null!==t){var n=t.querySelectorAll("input[type=checkbox]"),i=t.querySelectorAll("input[type=checkbox]:checked");n.length!==i.length&&i.length>0&&(e.regions=Array.from(i).map((function(e){return e.value})).join(","))}var o=document.querySelector("#id_enable_recommendations");return null!==o&&(e.enable_recommendations=!o.disabled&&o.checked),e}()),function(e){var t={},n=T(),i=R(e),r=(0,o.Z)(i,2),s=r[0],a=r[1];return void 0!==n&&a.push(n),s.length>0&&(t.keywords=s.join(" ").slice(0,p)),a.length>0&&(t.hashtags=a.join(",")),t}(e));var t,n}var v=new Map([["north-american-cams","NA"],["south-american-cams","SA"],["asian-cams","AS"],["euro-russian-cams","ER"],["other-region-cams","O"]]),g=["NA","SA","AS","ER","O"];function y(){var e=E();return v.get(e)}var b=new Map([["teen-cams",[18,20]],["18to21-cams",[18,22]],["20to30-cams",[20,31]],["30to50-cams",[30,51]],["mature-cams",[50,200]],["18to20-cams",[18,21]],["21to35-cams",[21,36]]]);function w(){var e=E();return b.get(e)}var C=new Map([["6-tokens-per-minute-private-cams",[6]],["12-tokens-per-minute-private-cams",[12]],["18-tokens-per-minute-private-cams",[18]],["30-tokens-per-minute-private-cams",[30,42]],["60-tokens-per-minute-private-cams",[60,72]],["90-tokens-per-minute-private-cams",[90,120,150,180,240]]]);function x(){var e=E();return C.get(e)}var k=new Map([["exhibitionist-cams","exhib"],["new-cams","new_cams"],["gaming-cams","gaming"]]),S=new Map([["spy-on-cams","private"],["followed-cams","follow"]]);function T(){var e=A().split("/");if("tag"===e[0])return e[1]}var I=/[^a-zA-Z0-9_]+/g;function R(e){var t;void 0===e&&(e=null!==(t=new URLSearchParams(window.location.search).get("keywords"))&&void 0!==t?t:"");var n=T(),i=[],o=[];return e.split(" ").forEach((function(e){var t=e.startsWith("#");(e=e.replace(I,"")).length<=0||(t?e!==n&&o.push(e):i.push(e))})),[i,o]}function P(e){var t;e=null!==(t=e)&&void 0!==t?t:"page";var n=new URLSearchParams(window.location.search).get(e);if(null!==n){var i=parseInt(n);if(!isNaN(i))return Math.min(Math.max(i,1),u)}return 1}function M(e,t){var n,i;return{offset:((e=null!==(n=e)&&void 0!==n?n:P())-1)*(t=null!==(i=t)&&void 0!==i?i:l),limit:t}}function A(e){var t=null!=e?e:window.location.pathname;return t.match(/^\/\w{2}\//)?t=t.slice(4):t.startsWith("/")&&(t=t.slice(1)),t.endsWith("/")&&(t=t.slice(0,-1)),t}function E(e){var t;return null!==(t=A(e).split("/")[0])&&void 0!==t?t:""}function B(e){return"followed-cams"===E(e)}function L(){var e,t=null!==(e=A().split("/")[1])&&void 0!==e?e:"";return B()&&"offline"===t}function O(){var e;return[y(),w(),x(),(e=E(),k.get(e))].some((function(e){return void 0!==e}))}function D(){return"spy-on-cams"===E()}},949:function(e,t,n){"use strict";n.d(t,{Ld:function(){return q},Bz:function(){return W},J:function(){return V}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(8759),c=n(7693),u=n(3753),d=n(9),h=n(8263),f=n(1794),p=n(6921),m=n(3705),v=n(9545),g=n(3543),y=n(47),b=n(3243),w=n(7654),C=n(7585),x=n(2080),k=n(8871),S=n(1185);var T=function(e){(0,r.Z)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function c(){return(0,i.Z)(this,c),l.apply(this,arguments)}return(0,o.Z)(c,[{key:"styleRow",value:function(e){}},{key:"styleLabelContainer",value:function(e){}},{key:"styleLabel",value:function(e){(0,S.vP)(e,S.ql.defaultColor)}},{key:"styleFieldContainer",value:function(e){(0,S.vP)(e,S.ql.defaultColor)}},{key:"styleField",value:function(e){}},{key:"styleHelpText",value:function(e){(0,S.vP)(e,S.ql.defaultColor)}}]),c}(n(8785).wj);var I=[{label:g.ag.showLocations,value:!0}],R=[{label:g.ag.showRecommendedCams,value:!0}],P=[{label:g.ag.previewRooms,value:!0}],M=function(e){(0,r.Z)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function c(){return(0,i.Z)(this,c),l.apply(this,arguments)}return(0,o.Z)(c,[{key:"initData",value:function(e){var t=this;(0,b.Z)((0,a.Z)(c.prototype),"initData",this).call(this,e),k.M4.listen((function(){return t.setHidden(t.showLocationCheckboxes,(0,w.W1)())}))}},{key:"createElement",value:function(e){return this.showLocationCheckboxes=new x.Zf({choices:I,name:"show_location",defaultValue:e.showLocation,styles:new T}),this.enableRecommendationsCheckbox=new x.Zf({choices:R,name:"enable_recommendations",defaultValue:e.enableRecommendations,disabled:e.enableRecommendationsDisabled,styles:new T}),this.setDisabled(this.enableRecommendationsCheckbox,e.enableRecommendationsDisabled),this.animateThumbnailsCheckboxes=new x.Zf({choices:P,name:"animate_thumbnails",defaultValue:e.animateThumbnails,disabled:e.animateThumbnailsDisabled,styles:new T}),this.setDisabled(this.animateThumbnailsCheckboxes,e.animateThumbnailsDisabled),this.setHidden(this.showLocationCheckboxes,(0,w.W1)()),(0,y.vz)("div",{id:"advanced_options"},(0,y.vz)("label",null,g.ag.settings,":"),(0,y.vz)("form",{id:"filter_options_form",action:"/ax/update_option_filters/",method:"post"},this.showLocationCheckboxes.getField(),this.enableRecommendationsCheckbox.getField()),(0,y.vz)("form",{id:"animate_thumbnails_form",action:"/ax/update_animate_thumbnails_options/",method:"post"},this.animateThumbnailsCheckboxes.getField()))}},{key:"initUI",value:function(e){(0,b.Z)((0,a.Z)(c.prototype),"initUI",this).call(this,e),this.setIdAndForAttribute(this.showLocationCheckboxes,"id_show_location"),this.setIdAndForAttribute(this.enableRecommendationsCheckbox,"id_enable_recommendations"),this.setIdAndForAttribute(this.animateThumbnailsCheckboxes,"id_animate_thumbnails")}},{key:"setDisabled",value:function(e,t){var n=e.getField().querySelector("input");null!==n&&(n.disabled=t)}},{key:"setHidden",value:function(e,t){e.getField().style.display=t?"none":"block",this.setDisabled(e,t)}},{key:"setIdAndForAttribute",value:function(e,t){var n=e.getField().querySelector("input");if(null!==n){n.id=t;var i=n.closest("td label");null!==i&&(i.htmlFor=n.id)}}}]),c}(C.I);var A=[{label:g.ag.refresh30Seconds,value:"30"},{label:g.ag.refresh45Seconds,value:"45"},{label:g.ag.refresh60Seconds,value:"60"},{label:g.ag.refresh90Seconds,value:"90"},{label:g.ag.refreshDisable,value:"0"}],E=function(e){(0,r.Z)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function c(){return(0,i.Z)(this,c),l.apply(this,arguments)}return(0,o.Z)(c,[{key:"createElement",value:function(e){var t;return this.refreshThumbnailsSelect=new x.Ph({choices:A,name:"refresh_frequency",defaultValue:(null!==(t=e.initial)&&void 0!==t?t:60).toString()}),(0,y.vz)("div",{className:"refresh"},(0,y.vz)("form",{id:"refresh_cams_form",action:"/ax/update_refresh_frequency/",method:"post"},(0,y.vz)("label",null,g.ag.refreshThumbnailsEvery,":"),this.refreshThumbnailsSelect.getField()))}},{key:"initUI",value:function(e){(0,b.Z)((0,a.Z)(c.prototype),"initUI",this).call(this,e);var t=this.element.querySelector("select");null!==t&&(t.id="id_refresh_frequency",(0,h.Zs)(t,{marginTop:"4px"}))}}]),c}(C.I);var B=[{label:g.ag.northAmericaTitle,value:"NA"},{label:g.ag.southAmericaTitle,value:"SA"},{label:g.ag.asiaTitle,value:"AS"},{label:g.ag.europeRussiaTitle,value:"ER"},{label:g.ag.otherTitle,value:"O"}],L=function(e){(0,r.Z)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function c(){return(0,i.Z)(this,c),l.apply(this,arguments)}return(0,o.Z)(c,[{key:"createElement",value:function(e){var t={choices:B,name:"visible_regions",defaultValue:""!==e.initial?e.initial:"NA,SA,AS,ER,O",styles:new T};return this.checkboxes=new x.Zf(t),(0,y.vz)("div",{className:"filter_location checkboxes"},(0,y.vz)("label",null,g.ag.visibleRegionsTag,":"),(0,y.vz)("form",{id:"filter_location_form",method:"post",action:"/ax/update_location_filters/"},this.checkboxes.getField()))}},{key:"initUI",value:function(e){(0,b.Z)((0,a.Z)(c.prototype),"initUI",this).call(this,e),this.bindElementIdsAndForAttributes()}},{key:"bindElementIdsAndForAttributes",value:function(){var e=0;this.element.querySelectorAll("input[type=checkbox]").forEach((function(t){t.id="id_visible_regions_".concat(e),t.closest("label[class=checkboxFieldLabel]").htmlFor=t.id,e+=1}))}}]),c}(C.I),O=n(2800),D=n(6698),U=n(4493);var Z={display:"none",top:"26px",width:"100%",right:"-1px",overflow:""},F=function(e){(0,r.Z)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function c(e,t){var n;(0,i.Z)(this,c),n=l.call(this,e,t);var o=document.getElementById("mobile_advanced_options_container");return null!==o&&(n.mobileAdvancedOptionsContainer=o),(0,h.Zs)(n.element,Z),n}return(0,o.Z)(c,[{key:"hideSuggestions",value:function(){(0,b.Z)((0,a.Z)(c.prototype),"hideSuggestions",this).call(this),(0,h.Zs)(this.mobileAdvancedOptionsContainer,{overflow:"hidden"})}},{key:"showSuggestions",value:function(){(0,b.Z)((0,a.Z)(c.prototype),"showSuggestions",this).call(this),(0,h.Zs)(this.mobileAdvancedOptionsContainer,{overflow:this.suggestionsList.length?"visible":"hidden"})}}]),c}(U.KI),_=n(9395);var N={overflow:"",width:"100%",display:"block",zIndex:106},j={width:"23px",height:"23px",display:"block",position:"absolute",top:"13%",right:"2px",backgroundPosition:"50% top",backgroundSize:"14px 14px"},H=function(e){(0,r.Z)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function c(){var e;(0,i.Z)(this,c),e=l.call(this),(0,h.Zs)(e.element,N),(0,h.Zs)(e.delete,j);var t=(0,y.vz)("button",{className:"submit",onClick:function(t){t.preventDefault(),e.onSubmitSearchInput()}},"search");return e.form.element.appendChild(t),e.handleMobileSortDisplay(),e}return(0,o.Z)(c,[{key:"initSuggestions",value:function(){this.suggestionsDiv=new F(this.input,this)}},{key:"onSubmitSearchInput",value:function(){(0,b.Z)((0,a.Z)(c.prototype),"onSubmitSearchInput",this).call(this),this.handleMobileSortDisplay()}},{key:"handleMobileSortDisplay",value:function(){var e=document.querySelector("#mobile-sort-container");e&&(""!==this.searchKeywords?e.style.display="none":e.style.display="block")}}]),c}(_.Mj),z=n(407);var W=new f.xB("showSearchingOverlay"),V=new f.xB("updateShowLocation"),q=function(e){(0,r.Z)(b,e);var t,n,d=(t=b,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function b(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,i.Z)(this,b),(e=d.call(this)).isMobile=t,e.skipOverlays=n,e.isAnimThumbUnlocked=!1,e.showAnimateThumbnails=!1,e.regionsChanged=new f.xB("regionsChanged"),e.enableRecommendationsChanged=new f.xB("enableRecommendationsChanged"),e.toggle=function(){e.toggleShowHide(),(0,m.fg)("AdvancedSearchOptionsClicked")},e.bindAdvancedSearchRegion=function(){var t=document.querySelectorAll(".advanced_search_region"),n=document.querySelector("#main");null!==n&&t.forEach((function(t){t.onclick=function(){e.showElement(),(0,l.jI)().scrollTop>n.offsetTop&&n.scrollIntoView()}}))},e.setShowAnimateThumbnails=function(){e.showAnimateThumbnails=null!==e.animateThumbnailsInput&&e.animateThumbnailsInput.checked};var o=document.querySelector("#advanced_search_options");if(null!==o){e.element=o;var r=e.createAdvancedSearchForms(),s=o.firstElementChild;null!==s&&s.insertAdjacentElement("afterend",r)}return e.bindAnimateThumbnailForm(),e.bindFloatingPlayerOption(),e.bindFilterLocationForm(),e.bindFilterOptionsForm(),e.bindAdvancedSearchRegion(),e.bindRefreshCamForm(),e.bindEnableRecommendations(),e.bindShowLocationOptionsForm(),e.bindHashtags(),e.bindSearchInput(),e.bindCloseButton(),e.bindOpenCloseButtons(),e.isAnimThumbUnlocked&&(0,D.X7)(e.showAnimateThumbnails),W.listen((function(t){t?e.showSearchingOverlays():e.hideSearchingOverlays()})),e}return(0,o.Z)(b,[{key:"createAdvancedSearchForms",value:function(){var e=!O.J.current.loggedInUser||!O.J.current.loggedInUser.isSupporter;return(0,y.vz)("div",{className:"advance-search-element"},(0,y.vz)(L,{initial:O.J.current.regions}),(0,y.vz)(M,{showLocation:O.J.current.showLocation,enableRecommendations:O.J.current.showRecommendations,enableRecommendationsDisabled:!O.J.current.loggedInUser,animateThumbnails:O.J.current.animateThumbnails,animateThumbnailsDisabled:e}),(0,y.vz)(E,{initial:O.J.current.refreshFrequency}))}},{key:"setTooltipDisplayBehavior",value:function(e,t){e.onmouseover=function(){e.style.display="block"};var n=function(e){return e.matches(":hover")};e.onmouseout=function(){window.setTimeout((function(){n(e)||n(t)||(e.style.display="none")}),75)},t.onmouseover=function(){e.style.display="block"},t.onmouseout=function(){window.setTimeout((function(){n(e)||n(t)||(e.style.display="none")}),75)}}},{key:"createShowRecTooltip",value:function(e,t){t.style.cursor="default",t.style.opacity="0.5",e.style.cursor="default";var n=(0,z.T)({content:g.ag.signUpToUseFeature(),hasHTML:"true",width:"auto",divotPosition:"0",divotLeftOrTop:"40px"});(0,h.Zs)(n,{marginTop:"5px",marginLeft:"42px",borderStyle:"solid"});var i=n.querySelector(".divotTop"),o=n.querySelector(".divotBorder"),r=n.querySelector(".divotBackground");return null!==i&&null!==o&&null!==r&&((0,h.Zs)(i,{top:"-5px"}),(0,h.Zs)(o,{borderWidth:"4px"}),(0,h.Zs)(r,{borderWidth:"5px",top:"1px",left:"-1px"})),this.setTooltipDisplayBehavior(n,t),e.readOnly=!0,e.onclick=function(){},n}},{key:"createRoomAnimTooltip",value:function(e,t){t.style.cursor="default",t.style.opacity="0.5",e.style.cursor="default";var n=(0,z.T)({content:g.ag.supporterToUseFeature(O.J.current.PurchaseEventSources.SUPPORTER_SOURCE_PREVIEW_ROOMS_UPSELL),hasHTML:"true",width:"auto",divotPosition:"0",divotLeftOrTop:"40px"}),i=n.querySelector("a");return null!==i&&(i.onclick=function(){(0,m.fg)("SupporterPageOpened",{source:"AnimateRoomImagesTooltip"})}),(0,h.Zs)(n,{marginTop:"5px",marginLeft:"42px",borderStyle:"solid"}),this.setTooltipDisplayBehavior(n,t),e.readOnly=!0,e.onclick=function(){},n}},{key:"bindFilterLocationForm",value:function(){var e=this,t=document.querySelector("#filter_location_form");null!==t&&(t.onchange=function(){e.onFilterFormChange(t)},t.querySelectorAll("input[type=checkbox]").forEach((function(n){(0,c.j9)("change",n,(function(){var i=new FormData(t).getAll("visible_regions").join(",");e.regionsChanged.fire(i),(0,m.fg)("RoomsFilterRegionClicked",{region:n.value,checked:n.checked})}))})))}},{key:"bindFilterOptionsForm",value:function(){var e=this,t=document.querySelector("#filter_options_form");null!==t&&(t.onchange=function(){e.onFilterFormChange(t)})}},{key:"bindAnimateThumbnailForm",value:function(){var e=this,t=document.querySelector("#animate_thumbnails_form");if(this.animateThumbnailsInput=document.querySelector("#id_animate_thumbnails"),null!==t&&null!==this.animateThumbnailsInput&&(this.animateThumbnailsInput.disabled||(this.isAnimThumbUnlocked=!0),this.showAnimateThumbnails=this.animateThumbnailsInput.checked,(0,c.j9)("change",this.animateThumbnailsInput,(function(){e.isAnimThumbUnlocked&&(e.onFilterFormChange(t),void 0!==document.setAnimateFollowedTab&&document.setAnimateFollowedTab(e.showAnimateThumbnails))})),(this.isAnimThumbUnlocked?this.animateThumbnailsInput:t).onclick=function(t){var n;(0,m.fg)("AnimateRoomImagesClicked",{checked:null===(n=e.animateThumbnailsInput)||void 0===n?void 0:n.checked})},!this.isAnimThumbUnlocked)){var n=t.querySelector("label[for='id_animate_thumbnails']");if(null!==n){var i=this.createRoomAnimTooltip(this.animateThumbnailsInput,n);t.appendChild(i)}}}},{key:"bindOpenCloseButtons",value:function(){var e=document.querySelector(".advanced_search_button");null!==e&&(e.onclick=this.toggle)}},{key:"showEnableFloatingPlayerOption",value:function(){this.showElement();var e=document.querySelector("label[for='id_enable_floatingplayer']");if(null!==e){var t=e.style.color;e.style.color="#ff6b00",this.enableFloatingPlayerForm.onclick=function(){e.style.color=t}}}},{key:"bindFloatingPlayerOption",value:function(){var e=this,t=document.querySelector("#floatingplayer_options_form");if(null!==t){this.enableFloatingPlayerForm=t,window.location.search.includes("advanced_options")&&this.showEnableFloatingPlayerOption();var n=document.querySelector("#id_enable_floatingplayer");null!==n&&(0,c.j9)("change",n,(function(){(0,u.I5)(t.action,new FormData(e.enableFloatingPlayerForm)).then((function(){var e=n.checked;(0,m.fg)("EnableFloatingPlayerOption",{isEnabled:e}),e||void 0!==document.disableFloatingPlayer&&document.disableFloatingPlayer()})).catch(v.Gr)}))}}},{key:"showSearchingOverlays",value:function(){var e=this;clearTimeout(this.optionsUpdateTimeout),document.querySelectorAll(".searching-overlay").forEach((function(t){e.updateOverlayPosition(t),t.style.display="block"}))}},{key:"hideSearchingOverlays",value:function(){var e=this,t=document.querySelectorAll(".searching-overlay");t.forEach((function(t){e.updateOverlayPosition(t)})),clearTimeout(this.optionsUpdateTimeout),this.optionsUpdateTimeout=window.setTimeout((function(){t.forEach((function(e){e.style.display="none"}))}),300)}},{key:"onFilterFormChange",value:function(e){var t=this;this.setShowAnimateThumbnails(),this.skipOverlays||W.fire(!0),(0,u.I5)(e.action,new FormData(e)).then((function(){t.isAnimThumbUnlocked&&(0,D.X7)(t.showAnimateThumbnails),t.bindAdvancedSearchRegion(),D.Bb.getInstance().loadRooms((function(){t.skipOverlays||W.fire(!1)}))})).catch(v.Gr)}},{key:"getTargetedOverlayContainer",value:function(e){var t=e.nextElementSibling;if(null!==t){if("discover_root"===t.id)return t;var n=t.querySelector(".list");return null===n&&(n=t.lastElementChild),null===n?void 0:n}}},{key:"updateOverlayPosition",value:function(e){var t=this.getTargetedOverlayContainer(e);if(void 0!==t){var n=t,i=n.getBoundingClientRect().width,o=n.getBoundingClientRect().height;e.style.height="".concat(o,"px"),e.style.left="".concat(n.offsetLeft,"px"),e.style.top="".concat(n.offsetTop,"px"),e.style.right="".concat(document.documentElement.clientWidth-n.offsetLeft-i,"px"),e.style.lineHeight="".concat(o,"px");var r=e.querySelector(".searching-overlay-spinner");null!==r&&(o<50?(r.classList.add("searching-overlay-spinner-very-small"),r.classList.remove("searching-overlay-spinner-small"),r.classList.remove("searching-overlay-spinner-medium")):o>=50&&o<200?(r.classList.remove("searching-overlay-spinner-very-small"),r.classList.add("searching-overlay-spinner-small"),r.classList.remove("searching-overlay-spinner-medium")):o>=200&&o<550?(r.classList.remove("searching-overlay-spinner-very-small"),r.classList.remove("searching-overlay-spinner-small"),r.classList.add("searching-overlay-spinner-medium")):(r.classList.remove("searching-overlay-spinner-very-small"),r.classList.remove("searching-overlay-spinner-small"),r.classList.remove("searching-overlay-spinner-medium")))}}},{key:"bindEnableRecommendations",value:function(){var e=this,t=document.querySelector("#filter_options_form"),n=document.querySelector("#id_enable_recommendations"),i=!1;if(null!==t){null!==n&&((0,c.j9)("change",n,(function(){(0,m.fg)("EnableRecommendationsOptionClicked",{isEnabled:n.checked}),e.enableRecommendationsChanged.fire()})),n.disabled||(i=!0));var o=t.querySelector("label[for='id_enable_recommendations']");if(!i&&null!==n&&null!==o){var r=this.createShowRecTooltip(n,o);t.appendChild(r)}}}},{key:"bindRefreshCamForm",value:function(){var e=this,t=document.querySelector("#refresh_cams_form");null!==t&&(t.onchange=function(){var n=t.querySelector("#id_refresh_frequency");if(null!==n){var i=parseInt(n.value);e.setShowAnimateThumbnails(),(0,u.I5)(t.action,new FormData(t)).then((function(){(0,m.fg)("RefreshFrequencyChanged",{seconds:i}),e.isAnimThumbUnlocked&&(0,D.X7)(e.showAnimateThumbnails),D.Bb.scheduleImageRefresh(i)})).catch(v.Gr)}})}},{key:"showElement",value:function(){this.isShown()||this.element.classList.remove("collapsed")}},{key:"hideElement",value:function(){this.isShown()&&this.element.classList.add("collapsed")}},{key:"isShown",value:function(){return!this.element.classList.contains("collapsed")}},{key:"bindHashtags",value:function(){document.querySelectorAll("#hashtag_ticker a").forEach((function(e){(0,c.j9)("click",e,(function(t){(0,m.fg)("RoomsFilterTagsClicked",{tagName:e.textContent})}))}))}},{key:"bindSearchInput",value:function(){if(this.isMobile){var e=new H,t=document.getElementById("SearchInputEntry");null!==t&&t.appendChild(e.element)}var n=document.querySelector(".search_input"),i=document.querySelector("#search_icon"),o=document.querySelector(".suggestionsDiv");if(null!==n&&null!==i&&null!==o){var r=function(){(0,m.fg)("RoomsFilterSearchClicked",{keyword:n.value})};[i,o].forEach((function(e){(0,c.j9)("click",e,(function(e){r()}),!0)})),[n,i,o].forEach((function(e){(0,c.j9)("keydown",e,(function(e){(0,p.r$)(e)&&r()}),!0)}))}}},{key:"bindCloseButton",value:function(){if(!this.isMobile){var e=(0,y.vz)("img",{style:{position:"absolute",height:"12px",width:"14px",right:"16px",top:"13px",cursor:"pointer"},src:"".concat(STATIC_URL,"option_close.svg"),onClick:this.toggle});this.element.appendChild(e)}}},{key:"bindShowLocationOptionsForm",value:function(){var e=document.querySelector("#id_show_location");null!==e&&(0,c.j9)("change",e,(function(){(0,m.fg)("ShowLocationClicked",{checked:e.checked}),V.fire(e.checked)}))}}]),b}(d.w)},2018:function(e,t,n){"use strict";n.d(t,{AB:function(){return d},Bk:function(){return v},Fq:function(){return I},HV:function(){return b},KT:function(){return x},L5:function(){return C},Sd:function(){return P},Y2:function(){return k},dk:function(){return y},jO:function(){return S},oz:function(){return w},yk:function(){return g}});var i,o=n(7791),r=n(5809),s=n(824),a=n.n(s),l=n(3753),c=n(391),u=n(2748);function d(e){return(0,l.Ue)("api/public/asp/control/app/".concat(e,"/")).then((function(e){return function(e){var t,n=new c.j(e);if(void 0!==n.getAny("settingsValues")){var i=new c.j(n.getObjectString("settingsValues"));t={},i.keys().map((function(e){t[e]=i.getAny(e)}))}return{id:n.getString("id"),name:n.getString("name"),isPublic:n.getBoolean("isPublic",!1,!1),isInstalled:n.getBoolean("isInstalled",!1,!1),isActive:n.getBoolean("isActive",!1,!1),hasUpdate:n.getBoolean("hasUpdate",!1,!1),installed:void 0!==n.getAny("installed")?f(n.getObjectString("installed")):void 0,latest:f(n.getObjectString("latest")),settingsValues:t,permissionsValues:void 0!==n.getAny("permissionsValues")?h(n.getObjectString("permissionsValues")):void 0,reason:n.getStringOrUndefined("reason"),slot:n.getNumberOrUndefined("slot")}}(e.responseText)}))}function h(e){var t=new c.j(e);return{videoPanel:t.getBoolean("videoPanel"),rewriteMessages:t.getBoolean("rewriteMessages"),tipOptions:t.getBoolean("tipOptions")}}function f(e){var t=new c.j(e);return{version:t.getString("version"),id:t.getString("id"),summary:t.getString("summary"),description:t.getString("description"),author:t.getString("author"),settings:p(t.getObjectString("settings")),permissions:m(t.getObjectString("permissions"))}}function p(e){var t={},n=new c.j(e);return n.keys().map((function(e){t[e]=function(e){var t=new c.j(e);return{type:t.getString("type"),title:t.getStringOrUndefined("title",!1),description:t.getStringOrUndefined("description",!1),minimum:t.getNumberOrUndefined("minimum",!1),maximum:t.getNumberOrUndefined("maximum",!1),minLength:t.getNumberOrUndefined("minLength",!1),maxLength:t.getNumberOrUndefined("maxLength",!1),pattern:t.getStringOrUndefined("pattern",!1),default:t.getAny("default"),required:t.getBoolean("required",!1,!1),order:t.getNumberOrUndefined("order"),enum:t.getStringListOrUndefined("enum")}}(n.getObjectString(e))})),t}function m(e){function t(e){return{settings:new c.j(e).getString("settings")}}var n=new c.j(e);return{videoPanel:t(n.getObjectString("videoPanel")),rewriteMessages:t(n.getObjectString("rewriteMessages")),tipOptions:t(n.getObjectString("tipOptions"))}}function v(e){return{appList:e.getStringList("order").map((function(e){return t=e,{id:(n=new c.j(t)).getString("id"),name:n.getString("name"),panelType:n.getString("system")};var t,n})),appName:e.getString("app_name",!1),template:e.getString("template",!1),layers:e.getList("layers"),url:e.getStringOrUndefined("url",!1),error:e.getStringOrUndefined("error",!1)}}function g(e){for(var t=new FormData,n=function(){var e=(0,r.Z)(o[i],2),n=e[0],s=e[1];Array.isArray(s)?s.forEach((function(e){t.append(n,e)})):t.set(n,s)},i=0,o=Object.entries(e);i<o.length;i++)n();return(0,l.I5)("api/public/asp/control/applist/",t).then((function(e){return t=e.responseText,{items:(n=new c.j(t)).getStringList("items").map((function(e){return function(e){var t=new c.j(e);return{id:t.getString("id"),name:t.getString("name"),isPublic:t.getBoolean("isPublic",!1,!1),isInstalled:t.getBoolean("isInstalled",!1,!1),isActive:t.getBoolean("isActive",!1,!1),hasUpdate:t.getBoolean("hasUpdate",!1,!1),author:t.getString("author"),summary:t.getString("summary"),latestVersion:t.getStringOrUndefined("latestVersion"),installedVersion:t.getStringOrUndefined("installedVersion"),permissionsValues:void 0!==t.getAny("permissionsValues")?h(t.getObjectString("permissionsValues")):void 0,reason:t.getStringOrUndefined("reason"),slot:t.getNumberOrUndefined("slot")}}(e)})),limit:n.getNumber("limit"),offset:n.getNumber("offset"),total:n.getNumber("total")};var t,n}))}function y(){return g({offset:"0",limit:"10",hasSlot:"1"})}function b(e){var t;return void 0===i&&(t=e,i=(0,l.Ue)("api/public/asp/broadcast/applist/".concat(t,"/")).then((function(e){return t=e.responseText,{items:new c.j(t).getStringList("items").map((function(e){return function(e){var t=new c.j(e);return{id:t.getString("id"),name:t.getString("name"),slot:t.getNumber("slot")}}(e)}))};var t}))),window.setTimeout((function(){i=void 0}),1e3),i}function w(){return g({isInstalled:"1",permissions:Object.values(u.X.EXCLUSIVE_PERMISSIONS)})}function C(e,t,n,i,o,r,s){(0,l.I5)("api/public/asp/control/app/install/".concat(e,"/"),{settings:JSON.stringify(t),permissions:JSON.stringify(n),slot:i.toString(),replace_slot:o.toString()}).then((function(e){r()})).catch((function(e){s(e)}))}function x(e,t,n,i,o,r,s){(0,l.I5)("api/public/asp/control/app/update/".concat(e,"/"),{settings:JSON.stringify(t),permissions:JSON.stringify(n),original_settings:JSON.stringify(i),original_permissions:JSON.stringify(o)}).then((function(e){r()})).catch((function(e){s(e)}))}function k(e,t,n,i,o,r){(0,l.I5)("api/public/asp/control/app/upgrade/".concat(e,"/").concat(t,"/"),{settings:JSON.stringify(n),permissions:JSON.stringify(i)}).then((function(e){o()})).catch((function(e){r(e)}))}function S(e,t){return T.apply(this,arguments)}function T(){return(T=(0,o.Z)(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,l.I5)("api/public/asp/control/app/stop/".concat(t,"/"),{}).then((function(e){n()})).catch((function(e){error("Error stopping app",e)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t,n){return R.apply(this,arguments)}function R(){return(R=(0,o.Z)(a().mark((function e(t,n,i){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,l.I5)("api/public/asp/control/app/uninstall/".concat(t,"/"),{delete_slot:n.toString()}).then((function(e){i()})).catch((function(e){error("Error removing app",e)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t,n,i){var o="api/public/asp/panel/".concat(e,"/"),r=new URLSearchParams;return void 0!==n&&r.append("app_id",n),void 0!==i&&r.append("system",i),t&&r.append("bcp_fallback","1"),""!==r.toString()&&(o+="?".concat(r.toString())),(0,l.Ue)(o).then((function(e){return new c.j(e.responseText)}))}},9888:function(e,t,n){"use strict";n.d(t,{F:function(){return c},y:function(){return a}});var i=n(7791),o=n(824),r=n.n(o),s=n(3753);function a(e){return l.apply(this,arguments)}function l(){return(l=(0,i.Z)(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={room_user:t.roomUser,created_by:t.createdBy,banned_user:t.bannedUser,is_silence:t.isSilence.toString()},e.abrupt("return",(0,s.I5)("api/ts/chat/ban-id/",n).then((function(e){return JSON.parse(e.responseText).banid})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(e,t,n,i,o){(0,s.I5)("edit_room_ban/",{banid:String(e),action:t,room_username:n}).then((function(e){var t=e.responseText;if(null!==t){var n;try{n=JSON.parse(t)}catch(e){return void o()}void 0===n.error?i():o()}else o()})).catch((function(){o()}))}},5925:function(e,t,n){"use strict";n.d(t,{Rp:function(){return f},WU:function(){return m},ey:function(){return p},jr:function(){return d},nS:function(){return l},qn:function(){return u}});var i,o=n(3753),r=n(3705),s=n(2800),a=n(8016),l=2e3,c=new Set;function u(e){return(0,o.I5)("api/ts/chat/ignored-users/",{username:e}).then((function(t){var n;return h(t.responseText),(0,r.fg)("IgnoreUser",{username:null===(n=s.J.current.loggedInUser)||void 0===n?void 0:n.username,to_user:e,list_size:p().size}),!0})).catch((function(e){return error("Error posting ignore user",e),!1}))}function d(e){return(0,o.Z2)("api/ts/chat/ignored-users/",{username:e}).then((function(){var t;return c.delete(e),(0,r.fg)("UnignoreUser",{username:null===(t=s.J.current.loggedInUser)||void 0===t?void 0:t.username,to_user:e,list_size:p().size}),!0})).catch((function(e){return error("Error posting unignore user",e),!1}))}function h(e){try{c=new Set(JSON.parse(e).users)}catch(e){error("Cannot parse ignore list",{reason:e.toString()})}}function f(){if((0,o.Ue)("api/ts/chat/ignored-users/").then((function(e){h(e.responseText)})).catch((function(e){error("Network error retrieving ignore list",e)})),void 0===i){var e,t=null===(e=s.J.current.loggedInUser)||void 0===e?void 0:e.userUid;void 0!==t&&(i=new a.zw(t).onMessage.listen((function(e){var t;e.isIgnored?(t=e.username,c.add(t)):function(e){c.delete(e)}(e.username)})))}}function p(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&f(),c}function m(e){var t=p();return void 0===t?(error("ignoreSet should not be undefined"),!1):t.has(e)}},6474:function(e,t,n){"use strict";n.d(t,{Fh:function(){return y},I_:function(){return b},SX:function(){return T},Ug:function(){return I},bG:function(){return E},iT:function(){return w},kG:function(){return v},lW:function(){return g},pc:function(){return P},rw:function(){return C},yW:function(){return S}});var i=n(7791),o=n(824),r=n.n(o),s=n(3753),a=n(391),l=n(5011),c=n(1794),u=n(3705),d=n(1392),h=n(3543),f=n(1289),p=n(2800),m=n(8626),v=50,g=new c.xB("createNewSession");function y(){return p.J.current.dmsEnabled}function b(e){return{message:e.getString("m"),numUnread:e.getNumber("num_unread"),time:1e3*e.getNumber("created_at"),fromUsername:e.getString("from_user"),otherUser:(0,l.yp)(new a.j(e.getObject("other_user"))),hasMedia:e.getBoolean("has_media")}}function w(e){return{username:e,isBroadcaster:!0,inFanclub:!1,hasTokens:!1,isMod:!1,tippedRecently:!1,tippedALotRecently:!1,tippedTonsRecently:!1,exploringHashTag:"",sourceName:"df"}}function C(e){return{message:"",numUnread:0,fromUsername:e,hasMedia:!1,otherUser:w(e)}}function x(e){var t=e.getList("messages");return void 0===t?{messages:[],numUnread:0}:{messages:t.map((function(e){return(0,l.p0)(e)})),numUnread:e.getNumber("num_unread")}}var k=new Map;function S(e,t,n){if(void 0===n)return Promise.resolve({messages:[],numUnread:0});var i="".concat(e,"-").concat(t,"-").concat(n),o=k.get(i);if(void 0===o){var r=(0,f.Ie)({offset:n,room:t});o=(0,s.Ue)("api/ts/chatmessages/pm_list/".concat(e,"/?").concat(r)).then((function(e){return x(new a.j(e.responseText))})),k.set(i,o),window.setTimeout((function(){k.delete(i)}),100)}return o}function T(e,t){var n="api/ts/chatmessages/pm_history/".concat(e,"/");return void 0!==t&&(n+="?".concat((0,f.Ie)({offset:t}))),(0,s.Ue)(n).then((function(e){return x(new a.j(e.responseText))}))}var I=["roomviewPM","mobilePM","mobile","DM"];function R(e,t){var n,i,o={m:e.message};if(void 0!==e.media&&((i=p.J.current).pmMediaEnabled||!0===(null===(n=i.loggedInUser)||void 0===n?void 0:n.isStaff))&&(o.media_id=e.media.map((function(e){return e.mediaId}))),void 0!==t)for(var r=0,s=Object.keys(t);r<s.length;r++){var a=s[r];o[a]=t[a]}return JSON.stringify(o)}function P(e){return M.apply(this,arguments)}function M(){return(M=(0,i.Z)(r().mark((function e(t){var n,i,o,l,c,f,v;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,m.vj)()){e.next=4;break}if(!d.uF.isShortcodeSyntax(t.message)){e.next=4;break}return n={username:t.username,errorMessage:"DM"===t.source?h.ag.shortcodeNotSupportedInDMs:h.ag.shortcodeNotSupportedInPMs,showDmLink:!1},e.abrupt("return",Promise.reject(n));case 4:if(void 0!==p.J.current.loggedInUser){e.next=7;break}return error("Sending private message as anon"),e.abrupt("return",Promise.reject(h.ag.loggedInForFeature));case 7:return i=t.username,o=t.source,l=t.roomName,c=void 0===l?"":l,f=new FormData,v=R(t),f.append("room",c),f.append("to_user",i),f.append("from_user",p.J.current.loggedInUser.username),f.append("message",v),e.abrupt("return",(0,s.I5)("api/ts/chatmessages/pm_publish/",f).then((function(e){var t=new a.j(e.responseText),n={username:i,source:o,is_reply:t.getAny("is_reply"),token_color:t.getStringOrUndefined("token_color"),in_fanclub:t.getBoolean("in_fanclub",void 0,!1),success:"Ok"===t.getString("status")};(0,u.fg)("SendPrivateMessage",n);var r=t.getStringOrUndefined("status",!1);if("Ok"!==r){var s={username:i,errorMessage:null!=r?r:h.ag.errorSendingMessage,showDmLink:t.getBoolean("show_sitewide_pm_link",!1,!1)};return Promise.reject(s)}return Promise.resolve()})).catch((function(e){if(error("Could not send private message: ",e),e instanceof s.GM){var t=new a.j(e.xhr.responseText).getStringOrUndefined("error");return void 0!==t?Promise.reject({errorMessage:t,isOfflineUserError:!1}):Promise.reject({errorMessage:h.ag.errorSendingMessage,isOfflineUserError:!1})}return Promise.reject(e)})));case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A=new Map;function E(e,t){var n="";void 0!==t&&""!==t&&(n="?".concat((0,f.Ie)({room:t})));var i="api/ts/chatmessages/user_info/".concat(e,"/").concat(n);if(A.has(i))return A.get(i);var o=(0,s.Ue)(i).then((function(n){var o,r={numUnread:(o=new a.j(n.responseText)).getNumber("num_unread"),canPm:o.getBoolean("can_pm"),canTip:o.getBoolean("can_tip"),user:(0,l.yp)(new a.j(o.getObject("user"))),sitewideUser:(0,l.yp)(new a.j(o.getObject("sitewide_user")))},s=void 0===t,c=p.q.getState().room;return s&&""!==c&&e===c&&(r.user.isBroadcaster=!0),window.setTimeout((function(){A.delete(i)}),2500),r})).catch((function(n){throw error("Error getting user info",{user:e,room:t,error:n.toString()}),A.delete(i),n}));return A.set(i,o),o}},8213:function(e,t,n){"use strict";n.d(t,{$6:function(){return C},$r:function(){return h},GY:function(){return g},JJ:function(){return w},Je:function(){return f},SZ:function(){return b},aC:function(){return c},lk:function(){return d},xX:function(){return v},zA:function(){return u},zB:function(){return l}});var i=n(3753),o=n(8069),r=n(1794),s=n(2010);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var l=new r.xB("pmMediaDrop",{listenersWarningThreshold:function(){return r.q6}}),c=new r.xB("pmMediaUpload",{listenersWarningThreshold:function(){return r.q6}}),u=new r.xB("pmMediaDeleted",{listenersWarningThreshold:function(){return 2+2*r.q6}}),d=new r.xB("pmMediaRejected",{listenersWarningThreshold:function(){return 2+2*r.q6}}),h=!1;function f(){h=!0}var p,m=52428800;function v(e,t){var n;if(e.size>m)n=Promise.reject("file_too_large");else{var o=new FormData;o.append("media",e),n=(0,i.I5)("api/ts/chatmessages/media/upload/",o).then((function(e){var t=JSON.parse(e.responseText).payload;return{mediaId:t.media_id,url:t.media_url,thumbnailUrl:t.media_thumbnail_url,opened:!1,fromUserUID:t.user_uid}}))}return c.fire({toUser:t,promise:n}),n}function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.ec,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,i.Ue)("api/ts/chatmessages/media/?media_type=I&limit=".concat(e,"&offset=").concat(t)).then((function(e){var t,n=[],i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw r}}}}(JSON.parse(e.responseText).media);try{for(i.s();!(t=i.n()).done;){var o=t.value;n.push({mediaId:o.media_id,url:o.media_url,thumbnailUrl:o.media_thumbnail_url,opened:!1,fromUserUID:o.user_uid})}}catch(e){i.e(e)}finally{i.f()}return n.sort((function(e,t){return Number(t.mediaId)-Number(e.mediaId)})),n}))}var y=new o.d((function(){p=g()}),{bounceLimitMS:10,debounceType:0});function b(){return y.callFunc(),p}function w(e){return(0,i.I5)("api/ts/chatmessages/media/delete/",{media_id:e.toString()}).then((function(t){return 200===t.status?(u.fire(e),Promise.resolve()):Promise.reject()})).catch((function(e){return Promise.reject()}))}function C(e,t,n){var o=new FormData;return o.append("from_user_uid",e),o.append("message_id",t),o.append("media_id",n.toString()),(0,i.I5)("api/ts/chatmessages/media/opened/",o).then((function(e){return 204===e.status})).catch((function(){return!1}))}},7804:function(e,t,n){"use strict";n.d(t,{h:function(){return r}});var i=n(3753),o=n(8959);function r(e){return new Promise((function(t,n){(0,i.I5)("api/ts/accounts/editsubgender/",e).then((function(){t(e.get("subgender")),"function"==typeof window[o.Z]&&window[o.Z]()})).catch((function(){n()}))}))}},6272:function(e,t,n){"use strict";n.d(t,{A3:function(){return c},Co:function(){return u},H2:function(){return l},d1:function(){return p},yX:function(){return h}});var i=n(3753),o=n(391),r=n(1794),s=n(2800);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var l=new r.xB("tipsInPast24HoursUpdate"),c=new r.xB("tokenBalanceUpdate"),u=6;function d(e){var t,n=[],i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw r}}}}(JSON.parse(e));try{for(i.s();!(t=i.n()).done;){var r=t.value,s=new o.j(JSON.stringify(r));n.push({label:s.getAsString("label")}),s.logUnusedDebugging("parseOptions")}}catch(e){i.e(e)}finally{i.f()}return n}function h(e){return new Promise((function(t,n){(0,i.Ue)("tipping/current_tokens/?room=".concat(e)).then((function(e){var n,i,r,s,a=(n=e.responseText,i=new o.j(n),r={tokenBalance:i.getNumber("token_balance")},void 0!==(s=i.getStringOrUndefined("tip_options"))&&(r.tipOptions=function(e){var t=new o.j(e),n=t.getObjectStringOrUndefined("tip_options");if(void 0!==n){var i={label:(t=new o.j(n)).getAsString("label"),options:d(t.getObjectString("options"))};return t.logUnusedDebugging("parseTipOptions"),i}}(s)),i.logUnusedDebugging("parseCurrentTokensResponse"),r);c.fire({tokens:a.tokenBalance}),t(a)})).catch((function(e){n(e.status)}))}))}var f=!1;function p(e){return new Promise((function(t,n){var r,a;f||(f=!0,(0,i.I5)("tipping/send_tip/".concat(e.roomName,"/"),{tip_amount:e.tipAmount,message:e.message,source:e.source,tip_room_type:e.tipRoomType,tip_type:e.tipType,video_mode:e.videoMode,from_username:null!==(r=null===(a=s.J.current.loggedInUser)||void 0===a?void 0:a.username)&&void 0!==r?r:""}).then((function(e){f=!1;var n=function(e){var t=new o.j(e),n={success:t.getBoolean("success")},i=t.getStringOrUndefined("error",!1);return void 0!==i?(n.error=i,n.showPurchaseLink=t.getBoolean("show_purchase_tokens",!1,!1)):(n.tokenBalance=t.getNumber("token_balance"),n.tipsInPast24Hours=t.getNumber("tipped_performer_last_24hrs")),t.logUnusedDebugging("parseSendTipResponse"),n}(e.responseText);void 0!==n.tokenBalance&&c.fire({tokens:n.tokenBalance}),t(n)})).catch((function(e){f=!1,n(e.xhr.status)})))}))}},2915:function(e,t,n){"use strict";n.d(t,{zv:function(){return W},G0:function(){return z},Nt:function(){return H}});var i=n(3243),o=n(7591),r=n(9492),s=n(7597),a=n(2951),l=n(1976),c=n(8759),u=n(7804),d=n(4028),h=n(7693),f=n(1522),p=n(2394),m=n(2400),v=function(){function e(t){(0,a.Z)(this,e),this.algorithm=2,this.level=0,void 0!==t&&(this.algorithm=t)}return(0,l.Z)(e,[{key:"avgAlgorithm",value:function(e){var t=e.reduce((function(e,t){return e+t*t}));this.level=Math.sqrt(t/e.length)}},{key:"maxAlgorithm",value:function(e){var t=Number.MIN_SAFE_INTEGER;e.map((function(e){return e>t&&(t=e),e})),0===e.length||t<0?t=0:t>1?t=1:this.level=t}},{key:"connect",value:function(e){var t=this;this.level=0,(0,c.BR)()&&("webkitAudioContext"in window?this.context=new webkitAudioContext:this.context=new AudioContext,this.script=this.context.createScriptProcessor(2048,1,1),this.mic=this.context.createMediaStreamSource(e),this.mic.connect(this.script),this.script.connect(this.context.destination),this.script.onaudioprocess=function(e){var n=e.inputBuffer.getChannelData(0);1===t.algorithm?t.avgAlgorithm(n):2===t.algorithm?t.maxAlgorithm(n):error("invalid algorithm choice",t.algorithm)})}},{key:"stop",value:function(){return(0,c.BR)()?(this.mic.disconnect(),this.script.disconnect(),this.context.close()):Promise.resolve()}}]),e}(),g=n(1986),y=n(6767),b=n(9),w=n(8263),C=n(9165),x=n(3682),k=n(3705),S=n(3544),T=n(3543),I=n(7906),R=n(1185),P=n(6547),M=n(851),A=n(2800);function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,s.Z)(e);if(t){var o=(0,s.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,r.Z)(this,n)}}var L="we-only-need-a-silent-mic",O="382px",D=["public","private","hidden","away","connecting"];function U(e){var t=document.createElement("div");return t.style.paddingLeft="10px",t.style.paddingTop="3px",t.style.fontSize="20px",t.textContent=e,t}function Z(e){var t=U(e);return t.style.paddingTop="10px",t.style.fontFamily="UbuntuRegular",t.style.fontSize="15px",t}function F(){var e=document.createElement("select");return(0,R.vP)(e,"select"),e.style.width="177px",e.style.height="20px",e.style.marginLeft="10px",e.style.marginTop="10px",e.style.fontFamily="UbuntuRegular",e.style.fontSize="12px",e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.borderRadius="4px",e.style.overflow="hidden",e}function _(){var e=document.createElement("video");return e.autoplay=!0,e.muted=!0,e.setAttribute("playsinline",""),e.oncontextmenu=function(e){e.preventDefault()},e}var N=function(){function e(){(0,a.Z)(this,e),this.broadcasting=!1,this.stopPromise=void 0}return(0,l.Z)(e,[{key:"setup",value:function(e,t,n){var i=this,o={video:{deviceId:{exact:n.camId},width:{ideal:n.width}},frameRate:{min:24,max:30}};return(0,c.s2)()?o.aspectRatio=1.777777778:o.video.height={ideal:n.height},n.micId!==L&&(o.audio={deviceId:{exact:n.micId}},o.audio.advanced=[{autoGainControl:!0},{noiseSuppression:!0}],(0,c.i7)()&&(o.audio.advanced.push({googEchoCancellation:!0}),o.audio.advanced.push({googExperimentalEchoCancellation:!0}),o.audio.advanced.push({googHighpassFilter:!0}))),this.handler=new g.nC(t,e,"desktop"),this.uuid=this.handler.uuid,new Promise((function(e,t){void 0!==i.handler&&i.handler.setup(o).then((function(t){i.stream=t,void 0!==i.handler&&i.handler.setMute(n.muted),e()})).catch((function(e){t(e)}))}))}},{key:"stop",value:function(){var e=this;return void 0===this.stopPromise&&(this.stopPromise=new Promise((function(t){var n=function(){e.handler=void 0,e.stream=void 0,e.broadcasting=!1,t()};void 0!==e.handler?e.handler.stop().then((function(t){e.uuid===t&&n()})).catch((function(){})):n()}))),this.stopPromise}},{key:"start",value:function(){var e=this;if(this.broadcasting=!1,void 0!==this.handler){if((0,x.qn)()&&!(0,x.P0)(this.handler.streamSettings.facingMode)){var t=T.ag.turnDevice180;return(0,x.gr)()&&(t=T.ag.turnDeviceLandscape),Promise.reject(new Error(t))}return new Promise((function(t,n){if(void 0!==e.handler){var i=!1,o=function(n){void 0!==n&&n!==e.uuid||!1===i&&(e.broadcasting=!0,i=!0,g.OO.removeListener(r),t())},r=function(e){o(e)};g.OO.listen(r),e.handler.start().then((function(){o()})).catch((function(e){!0===e.fatal&&(g.OO.removeListener(r),n(e))}))}}))}return Promise.resolve()}},{key:"streaming",value:function(){return void 0!==this.handler}},{key:"setMute",value:function(e){return void 0!==this.handler&&void 0!==this.stream&&(this.handler.setMute(e),!0)}}]),e}(),j=function(e){(0,o.Z)(n,e);var t=B(n);function n(e,i,o,r){var s;return(0,a.Z)(this,n),(s=t.call(this)).videoWidth=268,s.dossier=e,s.user=r,s.config=o,s.constraints=i,s.helpOverlay=s.createHelpOverlay(),s.createPreviewPanel(),s}return(0,l.Z)(n,[{key:"start",value:function(){var e=this,t=function(){if(void 0!==e.streamer){(0,P.bG)((function(){return e.setStartButtonDisabled(!1)}));var t=Math.floor(e.videoWidth/e.videoRatio);e.video.style.height="".concat(t,"px"),e.startMeter()}};this.stop().then((function(){e.streamer=new N,e.streamer.setup(e.video,e.dossier,e.constraints).then(t).catch((function(e){(0,c.i7)()&&(0,c.Iq)()&&"Could not start video source"===e.message?t():(0,f.Cj)("".concat(T.ag.couldNotSetupPreview,":\n").concat(e.message))}))})).catch((function(){}))}},{key:"stop",value:function(){var e=this;return this.setStartButtonDisabled(!0),this.stopMeter().then((function(){return void 0!==e.streamer?e.streamer.stop():Promise.resolve()}))}},{key:"stopMeter",value:function(){var e=this;return new Promise((function(t){void 0!==e.volumeRange&&(e.volumeRange.style.width="0%"),void 0!==e.volumeMeter?e.volumeMeter.stop().then((function(){clearInterval(e.volumeMeterInterval),e.volumeMeter=void 0,t()})).catch((function(){})):t()}))}},{key:"startMeter",value:function(){var e=this;this.stopMeter().then((function(){(0,c.BR)()&&void 0!==e.streamer&&void 0!==e.streamer.stream&&e.streamer.stream.getAudioTracks().length>0&&(e.volumeMeter=new v,e.volumeMeter.connect(e.streamer.stream),e.volumeMeterInterval=window.setInterval((function(){if(void 0!==e.volumeMeter&&void 0!==e.volumeRange){var t=100*e.volumeMeter.level;e.volumeRange.style.width="".concat(t,"%")}})))})).catch((function(){}))}},{key:"updateResolution",value:function(e){var t=this.devices.cams.get(this.constraints.camId);if(void 0!==t){var n=t.resolutions.get(e.value);void 0!==n&&(this.constraints.width=n.width,this.constraints.height=n.height,this.videoRatio=n.ratio,void 0!==this.hdLabel&&(n.isHD?this.hdLabel.style.visibility="visible":this.hdLabel.style.visibility="hidden"),this.start())}}},{key:"updateResolutions",value:function(){var e=this,t=this.devices.cams.get(this.constraints.camId);if(void 0!==t){for(var n=this.resSelect.options.length-1;n>=0;n-=1)this.resSelect.removeChild(this.resSelect.options[n]);var i=(0,y.sv)("selected_res"),o=0,r=-1,s=(0,c.op)();t.resolutions.forEach((function(t){if(!s||960!==t.width){var n=document.createElement("option");n.label=t.label,n.text=t.label,n.value=t.id,e.resSelect.add(n),n.value===i&&(r=o),o+=1}})),-1===r&&(r=Math.floor(this.resSelect.options.length/2));var a=this.resSelect.options[r];a.selected=!0,this.updateResolution(a)}}},{key:"onCamChange",value:function(){var e=this.camSelect.selectedIndex;if(e>=0){var t=this.camSelect.options[e];this.constraints.camId=t.value,(0,y.C)("selected_cam",t.value,60),(0,y.C)("selected_res","",0),this.updateResolutions()}}},{key:"onResChange",value:function(){var e=this.resSelect.selectedIndex;if(e>=0){var t=this.resSelect.options[e];(0,y.C)("selected_res",t.value,60),this.updateResolution(t)}}},{key:"createPreviewPanel",value:function(){(0,R.vP)(this.element,"previewPanel"),this.element.style.height=O,this.element.style.width="488px",this.element.style.paddingLeft="5px",this.element.appendChild(this.createTitle()),this.element.appendChild(this.createMediaSettingsPanel()),this.element.appendChild(this.createVideoPanel())}},{key:"createTitle",value:function(){var e=document.createElement("div");(0,R.vP)(e,"welcomeTitle"),e.style.width="100%",e.style.height="32px";var t=document.createElement("span");return t.style.paddingLeft="10px",t.style.verticalAlign="sub",t.style.lineHeight="32px",t.textContent="".concat(T.ag.welcomeBack,", ").concat(this.dossier.room),e.appendChild(t),e}},{key:"createMediaSettingsPanel",value:function(){var e=this,t=document.createElement("div");return t.style.width="198px",t.style.cssFloat="left",t.style.height="318px",t.style.padding="10px 0 10px 0",t.appendChild(this.createCamSettingsPanel()),t.appendChild(this.createMicSettingsPanel()),(0,p.N2)().then((function(t){t?e.getUserMedia():(e.setStartButtonDisabled(!0),e.showHelpOverlay())})).catch((function(){e.getUserMedia()})),t}},{key:"getUserMedia",value:function(){var e=this;this.hideHelpOverlay(),(0,p.Ru)(!1).then((function(t){if(e.setStartButtonDisabled(!1),e.devices=t,t.mics.size>0&&void 0!==e.micSelect){var n=document.createElement("option");n.label=T.ag.noMicrophone,n.text=n.label,n.value=L,e.micSelect.add(n);var i=(0,y.sv)("selected_mic"),o=1,r=1;n.value===i&&(r=0),t.mics.forEach((function(t){var n=document.createElement("option");n.label=t.label,n.text=t.label,n.value=t.id,void 0!==e.micSelect&&e.micSelect.add(n),n.value===i&&(r=o),o+=1}));var s=e.micSelect.options[r];s.selected=!0,e.constraints.micId=s.value}if(t.cams.size>0){var a=(0,y.sv)("selected_cam"),l=0,c=0;t.cams.forEach((function(t){var n=document.createElement("option");n.label=t.label,n.text=t.label,n.value=t.id,e.camSelect.add(n),n.value===a&&(c=l),l+=1}));var u=e.camSelect.options[c];u.selected=!0,e.constraints.camId=u.value,e.updateResolutions()}})).catch((function(t){e.setStartButtonDisabled(!0);var n="",i="";null!==t.message&&void 0!==t.message?n="OverconstrainedError"===t.name||"NotFoundError"===t.name||"DevicesNotFoundError"===t.name?T.ag.noCameraFound:"PermissionDeniedError"===t.name||"NotAllowedError"===t.name?T.ag.camAndMicPermissionDenied:"NotReadableError"===t.name?"".concat(t.message,". ").concat(T.ag.noOtherTabsOpen):t.message:null!==t.name&&void 0!==t.name&&(n=t.name),""!==n&&(i=". "),e.showHelpOverlay("".concat(T.ag.couldNotGetDevices).concat(i).concat(n))}))}},{key:"hideHelpOverlay",value:function(){for(var e=0,t=[this.camSelect,this.resSelect,this.micSelect];e<t.length;e++){var n=t[e];void 0!==n&&(n.disabled=!1)}this.helpOverlay.style.display="none"}},{key:"showHelpOverlay",value:function(e){void 0!==e&&(n.permissionsErrorString=e),void 0!==n.permissionsErrorString?(this.permissionsErrorSpan.textContent=n.permissionsErrorString,this.permissionsErrorSpan.style.display="",this.requestDevicesButton.style.display="none"):(this.permissionsErrorSpan.style.display="none",this.requestDevicesButton.style.display="");for(var t=0,i=[this.camSelect,this.resSelect,this.micSelect];t<i.length;t++){var o=i[t];void 0!==o&&(o.disabled=!0)}this.helpOverlay.style.display=""}},{key:"createHelpOverlay",value:function(){var e=this,t=document.createElement("div");(0,R.vP)(t,"helpOverlay"),t.style.fontSize="14px",t.style.fontFamily="UbuntuRegular",t.style.display="none",t.style.width="304px",t.style.fontWeight="bold",t.style.borderRadius="6px",t.style.textAlign="center",t.style.padding="8px",t.style.position="absolute",t.style.top="25%",t.style.left="50%",t.style.transform="translateX(-50%)",t.style.zIndex="1",t.style.borderWidth="2px",t.style.borderStyle="solid";var n=document.createElement("div");n.style.marginBottom="16px",(0,c.vU)()?(n.textContent=T.ag.camAndMicPermissionPromptFF,indexedDB.open("test").onerror=function(){e.showHelpOverlay(T.ag.privateBrowsingMessage)}):n.textContent=T.ag.camAndMicPermissionPrompt,t.appendChild(n),this.permissionsErrorSpan=document.createElement("div"),(0,R.vP)(this.permissionsErrorSpan,"error"),this.permissionsErrorSpan.style.display="none",t.appendChild(this.permissionsErrorSpan),this.requestDevicesButton=document.createElement("button"),this.requestDevicesButton.style.width="268px",this.requestDevicesButton.style.padding="7px 6px",this.requestDevicesButton.style.margin="auto",this.requestDevicesButton.style.fontWeight="normal",this.requestDevicesButton.style.fontSize="14px",this.requestDevicesButton.style.fontFamily="UbuntuRegular",this.requestDevicesButton.style.cursor="pointer",this.requestDevicesButton.innerText=T.ag.requestDevicePermissions,this.requestDevicesButton.onclick=function(){e.getUserMedia()},t.appendChild(this.requestDevicesButton);var i=document.createElement("div");i.style.marginTop="16px",i.innerHTML=T.ag.camAndMicPermissionSupportInfo();var o=i.querySelector("#camAndMicInfoLink");return null!==o&&(o.onclick=function(){return(0,k.fg)("DevicePermsInfoLinkClicked")}),t.appendChild(i),this.element.appendChild(t),t}},{key:"createCamSettingsPanel",value:function(){var e=this,t=document.createElement("div");(0,R.vP)(t,"settingsPanel"),t.style.width="100%",t.style.height="158px",t.style.marginBottom="5px",t.style.borderWidth="1px",t.style.borderStyle="solid",t.style.boxSizing="border-box";var n=U(T.ag.cameraLabel);n.style.lineHeight="28px",n.style.paddingTop="8px",t.appendChild(n);var i=F();i.style.marginTop="8px",i.style.height="32px",t.appendChild(i);var o=Z(T.ag.resolutionLabel);o.style.marginTop="16px",o.style.fontSize="12px",o.style.paddingTop="0",t.appendChild(o);var r=F();return r.style.marginTop="5px",r.style.height="32px",t.appendChild(r),i.onchange=function(){e.onCamChange()},r.onchange=function(){e.onResChange()},this.camSelect=i,this.resSelect=r,t}},{key:"createMicSettingsPanel",value:function(){var e=this,t=document.createElement("div");(0,R.vP)(t,"settingsPanel"),t.style.width="100%",t.style.height="162px",t.style.paddingTop="8px",t.style.borderWidth="1px",t.style.borderStyle="solid",t.style.boxSizing="border-box";var n=U(T.ag.microphoneLabel);n.style.lineHeight="28px",t.appendChild(n);var i=F();t.appendChild(i),i.style.marginTop="8px",i.style.height="32px",i.onchange=function(){var t=i.selectedIndex;if(t>=0){var n=i.options[t];e.constraints.micId=n.value,(0,y.C)("selected_mic",n.value,60),e.start()}};var o=(0,c.BR)();if(o){var r=document.createElement("div"),s=Z("".concat(T.ag.inputLevelLabel,":"));s.style.paddingTop="16px",s.style.paddingLeft="8px",s.style.display="inline-block";for(var a=16;(0,w.WG)("".concat(T.ag.inputLevelLabel,":"),"".concat(a,"px UbuntuRegular"))>85&&a>1;)a-=1;s.style.fontSize="".concat(a,"px"),r.appendChild(s);var l=document.createElement("div");(0,R.vP)(l,"inputLevelBar"),l.style.width="82px",l.style.margin="23px 8px 0 10px",l.style.borderWidth="1px",l.style.borderStyle="solid",l.style.display="inline-block",l.style.height="7px";var u=document.createElement("div");u.style.width="78px",u.style.height="7px",u.style.width="0%",u.style.backgroundColor="lightgreen",this.volumeRange=u,l.appendChild(u),r.appendChild(l),t.appendChild(r)}var d=document.createElement("div"),h=new M.S(16,!1,(function(){var t=!e.constraints.muted;p(t)&&(e.constraints.muted=t)}));h.setCheckboxValue("Mute"),h.element.id="mutebox",h.element.style.marginTop="8px",h.element.style.marginLeft="8px",h.disable();var f=window.setInterval((function(){p(e.constraints.muted)&&(h.enable(),clearInterval(f))}),200);d.appendChild(h.element);var p=function(t){return void 0!==e.streamer&&!!e.streamer.setMute(t)&&(t?h.setCheckedDirectly(!0):h.setCheckedDirectly(!1),(0,y.C)("broadcast_muted",String(t),60),!0)},m=document.createElement("label");return m.textContent=T.ag.muteLabel,m.htmlFor="mutebox",m.style.paddingLeft="5px",m.style.transform="translateY(-4px)",m.style.fontFamily="UbuntuRegular",m.style.fontSize="14px",m.style.display="inline-block",m.style.lineHeight="22px",d.appendChild(m),o||(h.element.style.marginTop="100px",m.style.marginTop="70px"),t.appendChild(d),this.micSelect=i,t}},{key:"createVideoPanel",value:function(){var e=this,t=document.createElement("div");t.style.width="289px",t.style.cssFloat="left",t.style.height="318px",t.style.padding="10px 0 10px 0";var n=_();n.style.width="".concat(this.videoWidth,"px"),n.style.height="150px",n.style.marginLeft="10px",n.style.marginRight="10px",t.appendChild(n),this.video=n;var i=document.createElement("div");(0,R.vP)(i,"hdLabel"),i.style.fontSize="24px",i.style.fontFamily="UbuntuBold",i.style.marginLeft="10px",i.style.marginTop="10px",i.textContent="HD",i.style.visibility="hidden",this.hdLabel=i,t.appendChild(i),t.appendChild(this.createStartButton());var o=Z("".concat(T.ag.highQualityStream,":"));o.style.fontSize="11px",o.style.paddingLeft="0",o.style.paddingTop="5px",o.style.textAlign="center",t.appendChild(o);var r=document.createElement("div");r.style.textAlign="center";var s=document.createElement("a");return(0,R.vP)(s,R.ql.hrefColor),s.style.fontSize="12px",s.text=T.ag.useOBS,s.style.cursor="pointer",r.appendChild(s),t.appendChild(r),s.onclick=function(){e.config.onOBSClick()},t}},{key:"createStartButton",value:function(){var e=this,t=document.createElement("div");t.style.textAlign="center";var n=document.createElement("button");if((0,R.vP)(n,"startButton"),n.style.marginTop="75px",n.style.width="268px",n.style.height="32px",n.style.fontWeight="normal",n.style.fontSize="14px",n.textContent=T.ag.startBroadcasting,n.style.fontFamily="UbuntuBold",n.style.cursor="pointer",t.appendChild(n),n.disabled=!0,n.onclick=function(){if(e.user)if(e.user.gender===C.Y0.OldTrans&&void 0===e.user.subgender){var t=new d.i,n={acceptText:T.ag.subgenderSelectionConfirm,separator:!1,allowDecline:!1,orange:!0};(0,f.F1)(t.element,(function(){(0,u.h)(new FormData(t.element)).then((function(t){e.user&&(e.user.subgender=t),e.startBroadcast()})).catch((function(){}))}),void 0,void 0,n)}else e.startBroadcast();(0,h.j9)("keydown",window,(function(e){"Escape"===e.key&&e.stopImmediatePropagation()}),!0)},this.startButton=n,(0,c.vU)()){var i=Z("".concat(T.ag.firefoxWarning));(0,w.Zs)(i,{fontSize:"11px",paddingLeft:"5px",textAlign:"center"}),n.before(i),n.style.marginTop="15px"}return t}},{key:"setStartButtonDisabled",value:function(e){this.startButton.disabled=e,this.startButton.style.opacity=e?".5":"1",this.startButton.style.cursor=e?"default":"pointer"}},{key:"startBroadcast",value:function(){var e=this;(0,m.m)((function(){(0,P.Iu)().then((function(t){""!==t?((0,f.Cj)(T.ag.showMyCamCurrentlySharing(t)),e.setStartButtonDisabled(!0),(0,P.bG)((function(){e.setStartButtonDisabled(!1)}))):e.stop().then((function(){e.config.onStartBroadcast()})).catch((function(){}))})).catch((function(){}))}))}}]),n}(b.w),H=function(e){(0,o.Z)(n,e);var t=B(n);function n(e,i,o){return(0,a.Z)(this,n),t.call(this,e,i,o)}return(0,l.Z)(n,[{key:"stop",value:function(){return(0,i.Z)((0,s.Z)(n.prototype),"stop",this).call(this)}},{key:"start",value:function(){(0,i.Z)((0,s.Z)(n.prototype),"start",this).call(this)}},{key:"createPreviewPanel",value:function(){this.element.style.width="402px",this.element.style.backgroundColor="transparent",this.element.style.position="relative",this.element.appendChild(this.createTitle()),this.element.appendChild(this.createClose()),this.element.appendChild(this.createVideoPanel()),this.element.appendChild(this.createInfoPanel()),this.element.appendChild(this.createMediaSettingsPanel()),this.element.appendChild(this.createStartButton())}},{key:"createTitle",value:function(){var e=document.createElement("div");e.style.width="200px",e.style.height="26px",e.style.display="inline-block";var t=document.createElement("div");return(0,R.vP)(t,"title"),t.style.fontFamily="UbuntuBold",t.style.fontSize="18px",t.textContent=this.config.title,e.appendChild(t),e}},{key:"createClose",value:function(){var e=document.createElement("div");e.style.display="inline-block",e.style.position="relative",e.style.right="-1px",e.style.width=e.style.height="17px",e.style.cssFloat="right",e.style.cursor="pointer",e.onclick=this.config.onClose;var t=document.createElement("img");return t.src="".concat(STATIC_URL_ROOT,"tsdefaultassets/close-gray.svg"),t.style.width=t.style.height="100%",e.appendChild(t),e}},{key:"createVideoPanel",value:function(){this.videoWidth=400;var e=document.createElement("div");e.style.textAlign="center";var t=_();return t.style.width="".concat(this.videoWidth,"px"),t.style.height="".concat(this.videoWidth/this.videoRatio,"px"),e.appendChild(t),this.video=t,e}},{key:"createInfoPanel",value:function(){var e=document.createElement("div");(0,R.vP)(e,"infoPanel"),e.style.marginTop="6px",e.style.padding="6px 5px 9px 4px",e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.boxSizing="border-box";var t,n,i=function(){var e=document.createElement("div");return e.style.fontFamily="UbuntuRegular",e.style.fontStyle="normal",e.style.fontWeight="bold",e.style.fontSize="12px",e.style.lineHeight="14px",e.style.textAlign="center",e},o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(this.config.infoText);try{for(o.s();!(n=o.n()).done;){t=n.value;var r=i();r.textContent=t,e.appendChild(r)}}catch(e){o.e(e)}finally{o.f()}return e}},{key:"createMediaSettingsPanel",value:function(){var e=(0,i.Z)((0,s.Z)(n.prototype),"createMediaSettingsPanel",this).call(this);return e.style.width="100%",e.style.height="auto",e.style.padding="9px 0px 0px 0px",e.style.cssFloat="",e}},{key:"createHelpOverlay",value:function(){var e=(0,i.Z)((0,s.Z)(n.prototype),"createHelpOverlay",this).call(this);return e.style.top="11%",e}},{key:"createCamSettingsPanel",value:function(){var e=this,t=document.createElement("div");(0,R.vP)(t,"settingsPanel"),t.style.width="100%",t.style.height="68px",t.style.paddingTop="5px",t.style.borderWidth="2px",t.style.borderStyle="solid",t.style.boxSizing="border-box";var n=document.createElement("div");n.style.display="inline-block";var i=this.createMediaSettingLabel(T.ag.cameraLabel),o=F();o.style.marginLeft="8px",o.style.marginTop="8px",n.appendChild(i),n.appendChild(o);var r=document.createElement("div");r.style.display="inline-block",r.style.paddingLeft="16px";var s=this.createMediaSettingLabel(T.ag.resolutionLabel);s.style.paddingLeft="10px";var a=F();return a.style.marginTop="8px",r.appendChild(s),r.appendChild(a),t.appendChild(n),t.appendChild(r),o.onchange=function(){e.onCamChange()},a.onchange=function(){e.onResChange()},this.camSelect=o,this.resSelect=a,t}},{key:"createMicSettingsPanel",value:function(){this.constraints.micId=L;var e=document.createElement("div");return e.style.display="none",e}},{key:"createStartButton",value:function(){var e=this,t=document.createElement("div");t.style.textAlign="center",t.style.paddingTop="10px";var n=document.createElement("button");return(0,R.vP)(n,"startButton"),n.style.width="305px",n.style.height="27px",n.style.borderWidth="1px",n.style.borderStyle="solid",n.style.borderRadius="4px",n.textContent=this.config.startButtonText,n.style.fontFamily="UbuntuBold",n.style.fontSize="16px",n.style.cursor="pointer",n.style.whiteSpace="nowrap",n.style.overflow="hidden",n.style.textOverflow="ellipsis",t.appendChild(n),n.disabled=!0,n.onclick=function(){n.disabled=!0,e.startBroadcast()},this.startButton=n,t}},{key:"createMediaSettingLabel",value:function(e){var t=document.createElement("div");return t.style.paddingLeft="8px",t.style.paddingTop="3px",t.style.fontSize="16px",t.style.fontFamily="UbuntuBold",t.textContent=e,t}}]),n}(j),z=function(e){(0,o.Z)(n,e);var t=B(n);function n(e,i,o){var r;(0,a.Z)(this,n),(r=t.call(this)).stopping=!1,r.timeStarted=0,r.dossier=e,r.config=o,r.constraints=i,r.createBroadcastPanel();var s=!1,l=!1,c=!1,u=!0,d=function(e,t){void 0!==r.status&&void 0!==r.warning&&(!0!==t||l?!0!==t&&l&&(r.status.style.color="black",r.status.style.fontFamily="UbuntuRegular",r.status.style.width="",r.status.style.paddingLeft="0px",r.status.style.cssFloat="none",r.status.title="",r.warning.style.display="none",l=!1):(l=!0,r.status.style.color="#D80000",r.status.style.fontFamily="UbuntuBold",r.status.style.width="28%",r.status.style.paddingLeft="18%",r.status.style.cssFloat="left",r.status.title=r.warning.title=T.ag.poorBroadcast,r.warning.style.display=""),r.status.textContent=e,e.length>27?r.status.style.paddingTop="2px":r.status.style.paddingTop="10px")},h=function(){var e=performance.now(),t=window.setInterval((function(){if(u){var n=performance.now(),i=Math.floor((n-e)/1e3);i<1||(i>=10&&(e=n),void 0!==r.fps&&(r.fps.textContent=""),void 0!==r.status&&(r.status.textContent="".concat(T.ag.pleaseWaitConnecting," ").concat(10-i+1,"..."),r.status.textContent.length>33?r.status.style.paddingTop="2px":"ja"===A.J.current.languageCode?r.status.style.fontSize="14px":r.status.style.paddingTop="10px"))}else clearInterval(t)}),200)};return h(),r.onStreamStatusUpdate=function(e){if(void 0!==r.streamer&&r.streamer.uuid===e.uuid){var t=e.data;if(void 0!==t.fps&&(s=!r.setFPS(t.fps)),void 0!==t.status){var n=t.status;if("connecting"!==n&&(u=!1),r.isStatusOffline(n))return void d("(Offline)");if("away"!==n||c)if("away"!==n&&c)void 0!==r.away&&(r.away.style.display="none"),r.main.style.display="",c=!1;else{var i=n.charAt(0).toUpperCase()+n.slice(1);"connecting"===n?u||(u=!0,h()):s&&r.timeStarted>0&&performance.now()-r.timeStarted>5e3?d(T.ag.lowFPS,!0):d("(".concat(i," Broadcasting)"))}else r.main.style.display="none",void 0!==r.away&&(r.away.style.display=""),c=!0}}},r.onStreamStop=function(e){void 0===r.streamer||r.streamer.uuid!==e||r.stopping||r.stop(!0)},g.QU.listen(r.onStreamStatusUpdate),g.uT.listen(r.onStreamStop),r.start(),r}return(0,l.Z)(n,[{key:"createBroadcastPanel",value:function(){var e=this.createMain();e.appendChild(this.createVideo()),e.appendChild(this.createControls());var t=document.createElement("div");t.innerText=T.ag.incorrectOrientation,(0,w.Zs)(t,{color:"#ffffff",position:"absolute",fontSize:"1.0em",fontWeight:"bold",top:"8px",left:"8px",zIndex:100,display:"none",backgroundColor:"rgba(255, 255, 255, 0.5)",lineHeight:"150%",padding:"1px"}),t.setAttribute("draggable","false"),(0,h.j9)("orientationchange",window,(function(){(0,x.qn)()&&!(0,x.P0)()?(t.style.display="",(0,x.gr)()?t.innerText=T.ag.incorrectPortrait:t.innerText=T.ag.incorrectLandscape):t.style.display="none"})),e.appendChild(t);var n=this.createAway();n.appendChild(this.createTitle()),n.appendChild(this.createMessage()),n.appendChild(this.createLink()),(0,R.vP)(this.element,"broadcastPanel"),this.element.appendChild(e),this.element.appendChild(n),this.main=e,this.away=n}},{key:"isBroadcasting",value:function(){return void 0!==this.streamer&&this.streamer.broadcasting}},{key:"start",value:function(){var e=this;this.stop().then((function(){var t=0;new Promise((function n(i,o){e.streamer=new N,e.streamer.setup(e.video,e.dossier,e.constraints).then((function(){void 0!==e.streamer&&e.streamer.start().then((function(){e.onBeforeUnload=function(e){return e.preventDefault(),e.returnValue=!1,T.ag.wantToLeaveConfirmation},(0,h.j9)("beforeunload",window,e.onBeforeUnload),e.onUnload=function(){e.stop(!0)},(0,h.j9)((0,c.BV)(),window,e.onUnload),I.PU.fire(!0),i()})).catch((function(e){o("".concat(T.ag.couldNotStartBroadcast,": ").concat(e.message))}))})).catch((function(r){if((0,c._1)()&&"Invalid constraint"===r.message){if((t+=1)<=5)return void e.stop().then((function(){window.setTimeout((function(){n(i,o)}),500)})).catch((function(){}));o(T.ag.ipadFailedToSetup)}o("".concat(T.ag.couldNotSetupBroadcast,": ").concat(r.message))}))})).catch((function(t){(0,f.Cj)(t),e.stop(!0)}))})).catch((function(){}))}},{key:"stop",value:function(e){var t=this;this.stopping=!0,void 0!==this.onBeforeUnload&&((0,h.SC)("beforeunload",window,this.onBeforeUnload),this.onBeforeUnload=void 0),void 0!==this.onUnload&&((0,h.SC)((0,c.BV)(),window,this.onUnload),this.onUnload=void 0);var n=Promise.resolve();return void 0!==this.streamer&&(n=this.streamer.stop()),!0===e&&(0,y.C)("last_broadcast_dt",Date.now().toString(10),1),new Promise((function(i,o){n.then((function(){t.stopping=!1,!0===e&&(g.QU.removeListener(t.onStreamStatusUpdate),g.uT.removeListener(t.onStreamStop),t.config.onStopBroadcast(),I.PU.fire(!1)),i()})).catch(o)}))}},{key:"setFPS",value:function(e){var t=20,n=15;(0,c.s2)()&&(t=12,n=9);var i,o=!0;return(e=Math.round(e))>=t?i="frameRateGood":e>=n?i="frameRateAvg":(i="frameRateBad",o=!1),void 0!==this.fps&&(this.fps.className="",(0,R.vP)(this.fps,i),this.fps.textContent="".concat(e," FPS")),o}},{key:"createMain",value:function(){var e=document.createElement("div");return e.style.height=O,e.style.width="100%",e.style.overflow="unset",e}},{key:"createAway",value:function(){var e=document.createElement("div");return e.style.height=O,e.style.width="100%",e.style.backgroundColor="black",e.style.display="none",e}},{key:"createVideo",value:function(){var e=_();return e.style.width="100%",e.style.height="370px",e.style.backgroundColor="black",this.video=e,e}},{key:"createControls",value:function(){var e=this,t=document.createElement("div");(0,R.vP)(t,"controls"),t.style.width="100%",t.style.height="35px";var n=document.createElement("button");n.style.border="0px";var i=document.createElement("div");(0,R.vP)(i,"muteImg"),i.textContent="",i.style.height="20px",i.style.width="20px",i.style.border="0px",i.style.paddingTop="9px",(0,c.G6)()&&!(0,c.s2)()&&(i.style.paddingTop="3px"),i.style.outline="none",n.appendChild(i);var o=document.createElement("div");o.style.cssFloat="left",o.style.textAlign="center",o.style.height="34px",o.style.borderRight="1px solid black",o.style.width="10%",(0,c.Tt)()&&(0,c.G6)()&&(o.style.width="12%"),o.appendChild(n),t.appendChild(o);var r=function(t){return void 0!==e.streamer&&!!e.streamer.setMute(t)&&(t?(0,R.vP)(i,"muted"):(0,R.FU)(i,"muted"),(0,y.C)("broadcast_muted",String(t),60),!0)};n.onclick=function(){var t=!e.constraints.muted;r(t)&&(e.constraints.muted=t)},n.disabled=!0;var s=window.setInterval((function(){r(e.constraints.muted)&&(n.disabled=!1,clearInterval(s))}),200),a=document.createElement("div");(0,R.vP)(a,"inBrowserStatus"),a.style.cssFloat="left",a.style.textAlign="center",a.style.height="34px",a.style.width="51%",a.dataset.testid="stream-status",(0,c.Tt)()&&(a.style.width="44%"),a.style.borderRight="1px solid black",a.style.padding="0px",a.style.fontFamily="UbuntuRegular";var l=U("");l.style.cssFloat="left",l.style.paddingLeft="5px",l.style.paddingTop="10px";var u=Z("");u.style.paddingLeft="0px";var d=document.createElement("img");d.src="".concat(STATIC_URL_ROOT,"broadcastassets/warning.png"),d.style.height="16px",d.style.paddingTop="9px",d.style.paddingLeft="5px",d.style.display="none",d.style.cssFloat="left",a.appendChild(l),a.appendChild(u),a.appendChild(d),this.fps=l,this.status=u,this.warning=d,t.appendChild(a);var h=document.createElement("button"),f=document.createElement("input");f.type="image",f.src="".concat(STATIC_URL_ROOT,"broadcastassets/stop.svg"),f.style.verticalAlign="middle",f.style.height="16px",f.style.paddingTop="1px",h.appendChild(f);var p=document.createElement("span");p.style.fontFamily="UbuntuRegular",p.textContent=p.innerText=T.ag.stopBroadcasting;var m=p.innerText.length;m>24?(p.style.fontSize="11px",p.style.paddingLeft="1px"):m<24&&m>18?(p.style.fontSize="13px",p.style.paddingLeft="2px"):(p.style.fontSize="18px",p.style.paddingLeft="7px"),p.style.verticalAlign="middle",h.appendChild(p),h.style.paddingTop="5px",h.style.cssFloat="right",h.style.border="0",h.dataset.testid="stop-broadcasting-web-rtc-button";var v=document.createElement("div");return v.style.cssFloat="left",v.style.textAlign="center",v.style.height="34px",v.appendChild(h),t.appendChild(v),h.onclick=function(){e.stop(!0)},t}},{key:"createTitle",value:function(){var e=document.createElement("div");e.style.textAlign="center",e.style.paddingTop="90px";var t=document.createElement("span");return(0,R.vP)(t,"awayTitle"),t.textContent=T.ag.youAreAway,t.style.fontFamily="UbuntuRegular",t.style.fontSize="40px",e.appendChild(t),e}},{key:"createMessage",value:function(){var e=document.createElement("div");e.style.textAlign="center",e.style.paddingLeft="16%",e.style.paddingRight="16%",e.style.paddingTop="50px";var t=document.createElement("span");return(0,R.vP)(t,"inBrowserAwayMessage"),t.style.fontFamily="UbuntuRegular",t.style.fontSize="14px",t.textContent=T.ag.wentToAway,e.appendChild(t),e}},{key:"createLink",value:function(){var e=document.createElement("div");e.style.textAlign="center",e.style.paddingTop="35px";var t=document.createElement("a");return(0,R.vP)(t,"awayLink"),t.text=T.ag.exitAwayMode,t.style.fontFamily="UbuntuRegular",t.style.fontSize="20px",t.style.cursor="pointer",t.style.textDecoration="underline",e.appendChild(t),t.onclick=function(){(0,S.ve)()},e}},{key:"isStatusOffline",value:function(e){return!D.some((function(t){return t===e}))}}]),n}(b.w),W=function(e){(0,o.Z)(n,e);var t=B(n);function n(e,i,o){var r;(0,a.Z)(this,n),(r=t.call(this)).startCounter=1,r.dossier=e,r.user=o,r.config=i;var s=(0,y.ld)("broadcast_muted");return r.constraints={micId:"",camId:"",width:0,height:0,muted:void 0!==s&&s},(0,R.vP)(r.element,"Broadcast"),r.element.style.width="498px",r.element.style.height="407px",r.element.style.fontFamily="UbuntuBold",r.element.style.fontSize="18px",r.element.style.position="relative",r.previewPanel=r.createPreview(),r.addChild(r.previewPanel),r}return(0,l.Z)(n,[{key:"isBroadcasting",value:function(){return void 0!==this.broadcastPanel&&this.broadcastPanel.isBroadcasting()}},{key:"createPreview",value:function(){var e=this;return new j(this.dossier,this.constraints,{onOBSClick:this.config.onOBSClick,onStartBroadcast:function(){void 0!==e.previewPanel&&(e.removeChild(e.previewPanel),e.previewPanel=void 0),(0,k.fg)("WebRTCBroadcastStart",{startCount:e.startCounter}),e.startCounter+=1,e.broadcastPanel=e.createBroadcast(),e.addChild(e.broadcastPanel)}},this.user)}},{key:"createBroadcast",value:function(){var e=this;return new z(this.dossier,this.constraints,{onStopBroadcast:function(){void 0!==e.broadcastPanel&&(e.removeChild(e.broadcastPanel),e.broadcastPanel=void 0),e.previewPanel=e.createPreview(),e.addChild(e.previewPanel)}})}}]),n}(b.w)},7906:function(e,t,n){"use strict";n.d(t,{PE:function(){return s},PU:function(){return r},c6:function(){return o}});var i=n(1794),o=new i.xB("anyRTCBroadcastStartStop"),r=new i.xB("webRTCBroadcastStartStop"),s=new i.xB("OBSBroadcastStartStop"),a=function(e){o.fire(e)};r.listen(a),s.listen(a)},1185:function(e,t,n){"use strict";n.d(t,{FU:function(){return s},ql:function(){return o},vP:function(){return r}});var i=n(9),o={textColor:"textColor",bgColor:"bgColor",tabSectionBorder:"tabSectionBorder",tabBorder:"tabBorder",tabActiveBorder:"tabActiveBorder",tabInactiveBgColor:"tabInactiveBgColor",tabInactiveColor:"tabInactiveColor",tabActiveBgColor:"tabActiveBgColor",tabActiveColor:"tabActiveColor",chatAreaTabColor:"chatAreaTabColor",defaultColor:"defaultColor",defaultTooltipColor:"defaultTooltipColor",disabledTooltipColor:"disabledTooltipColor",roomSubjectToolTipColor:"roomSubjectToolTipColor",hrefColor:"hrefColor",tagFontColor:"tagFontColor",tagExhibColor:"tagExhibColor",tagNewColor:"tagNewColor",tagLineColor:"tagLineColor",tagOfflineColor:"tagOfflineColor",tagPrivateGroupColor:"tagPrivateGroupColor",tagGamingColor:"tagGamingColor",camBgColor:"camBgColor",camBorderColor:"camBorderColor",camSubjectColor:"camSubjectColor",camSubjectTagColor:"camSubjectTagColor",camAltTextColor:"camAltTextColor",camHrefColor:"camHrefColor",nextCamBgColor:"nextCamBgColor",navigationAlt2BgImage:"navigationAlt2BgImage",navigationAlt2BgColor:"navigationAlt2BgColor",dismissibleMessageColor:"dismissibleMessageColor",userInfoDropdownBgColor:"userInfoDropdownBgColor",userInfoDropdownHighlightColor:"userInfoDropdownHighlightColor",userInfoDropdownTextColor:"userInfoDropdownTextColor"};function r(e,t){(e instanceof i.w?e.element:e).classList.add(t)}function s(e,t){(e instanceof i.w?e.element:e).classList.remove(t)}},1194:function(e,t,n){"use strict";n.d(t,{d:function(){return c}});var i=n(7591),o=n(9492),r=n(7597),s=n(2951),a=n(1976);var l=function(e){(0,i.Z)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,r.Z)(t);if(n){var s=(0,r.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,o.Z)(this,e)});function c(e,t){var n;(0,s.Z)(this,c),n=l.call(this);var i=document.createElement("span");return i.style.color="red",i.textContent="Error loading component",t.appendChild(i),warn("Created dummy React component"),n}return(0,a.Z)(c,[{key:"update",value:function(e){warn("Update called on dummy React component")}},{key:"dispose",value:function(){warn("Dispose called on dummy React component")}}]),c}(function(){function e(){(0,s.Z)(this,e)}return(0,a.Z)(e,[{key:"update",value:function(e){}},{key:"dispose",value:function(){}}]),e}()),c=function(){function e(){(0,s.Z)(this,e)}return(0,a.Z)(e,null,[{key:"get",value:function(e){return void 0===window.ReactComponentRegistry?(error("ReactComponentRegistry is undefined - React code is likely not loaded",{argument:e}),l):void 0===window.ReactComponentRegistry[e]?(error("ReactComponentRegistry does not contain component ".concat(e," - React code may not be up to date"),{argument:e}),l):window.ReactComponentRegistry[e]}}]),e}()},8542:function(e,t,n){"use strict";n.d(t,{MH:function(){return M},bY:function(){return C},sQ:function(){return w}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(4649),u=n(391),d=n(7968),h=n(7585),f=n(3543),p=n(47),m=n(2750),v=n(2018),g=n(1185);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e){var t=new u.j(e),n=t.getStringOrUndefined("detail",!1);if(void 0!==n)return{msg:n,type:"legacy"};var i=t.getMap("detail");return{msg:i.getString("msg"),type:i.getString("type"),app:i.getStringOrUndefined("app",!1)}}function C(e){return"".concat(function(e){return e.id.split("-",1)[0]}(e),"-").concat(e.name.replace(/[^a-zA-Z0-9]/g,"-"))}var x=function(e){var t="/apps2/".concat(e.slot,"/");return(0,p.vz)("a",{style:L,colorClass:g.ql.hrefColor,href:t,onClick:function(e){e.preventDefault(),(0,m.Pv)(e.target.href,"_blank",m.uX)},"data-test":"choose-app-btn-".concat(e.slot)},e.text)},k=function(e){var t="/apps2/".concat(e.app.slot,"/").concat(C(e.app),"/");return(0,p.vz)("a",{style:b(b({},L),{},{visibility:e.hidden?"hidden":"visible"}),colorClass:g.ql.hrefColor,href:t,onClick:function(e){e.preventDefault(),(0,m.Pv)(e.target.href,"_blank",m.uX)},"data-test":"app-".concat(e.text.toLowerCase(),"-link-").concat(e.app.slot)},e.text)},S=function(e){var t={width:"50px",display:"inline-block",textAlign:"left"};return e.app.isActive?(0,p.vz)("span",{style:t,colorClass:"activeStatus","data-test":"app-status-".concat(e.app.slot)},f.ag.running):(0,p.vz)("span",{style:t,colorClass:"noneSelected","data-test":"app-status-".concat(e.app.slot)},f.ag.stopped)},T=function(e){return(0,p.vz)("a",{style:b(b({},L),{},{width:"40px",textAlign:"left"}),colorClass:"deactivate",href:"#",onClick:function(t){(0,v.jO)(e.app.id,(function(){d.q.fire()})).catch((function(e){error(e)}))},"data-test":"app-stop-btn-".concat(e.app.slot)},f.ag.stop)},I=function(e){return(0,p.vz)("a",{style:L,colorClass:"deactivate",href:"#",onClick:function(t){(0,v.Fq)(e.app.id,!0,(function(){d.q.fire()})).catch((function(e){error(e)}))},"data-test":"app-uninstall-btn-".concat(e.app.slot)},e.text)},R=function(e){return(0,p.vz)("tr",{colorClass:"row"},(0,p.vz)("td",{style:E},(0,p.vz)("legend",{style:B,colorClass:"label","data-test":"app-label-".concat(e.slot)},"v2 App #".concat(e.slot,":"))),(0,p.vz)("td",{style:{fontStyle:"italic"},colorClass:"noneSelected","data-test":"app-name-".concat(e.slot)},f.ag.noneSelected),(0,p.vz)("td",{colSpan:4},(0,p.vz)("span",{style:{cssFloat:"right",paddingRight:"8px"}},(0,p.vz)(x,{text:f.ag.chooseAnApp,slot:e.slot}))))},P=function(e){return(0,p.vz)("tr",{colorClass:"row"},(0,p.vz)("td",{style:E},(0,p.vz)("legend",{style:B,colorClass:"label","data-test":"app-label-".concat(e.slot)},"v2 App #",e.slot,":")),(0,p.vz)("td",{style:{fontStyle:e.app.isActive?"normal":"italic",width:"430px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},colorClass:e.app.isActive?"activeStatus":"noneSelected","data-test":"app-name-".concat(e.slot)},e.app.name),(0,p.vz)("td",null,(0,p.vz)(S,{app:e.app})),(0,p.vz)("td",null,(0,p.vz)(k,{app:e.app,text:e.app.hasUpdate?f.ag.upgrade:f.ag.settings,hidden:!e.app.isActive})),(0,p.vz)("td",null,!e.app.isActive&&(0,p.vz)(k,{app:e.app,text:f.ag.restart,hidden:!1}),e.app.isActive&&(0,p.vz)(T,{app:e.app})),(0,p.vz)("td",{style:{width:0,paddingRight:"8px"}},(0,p.vz)(I,{app:e.app,text:f.ag.uninstall})))},M=function(e){(0,s.Z)(u,e);var t,n,c=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function u(){return(0,i.Z)(this,u),c.apply(this,arguments)}return(0,o.Z)(u,[{key:"initData",value:function(e){this.authUrl=e.authUrl,this.savedApps=e.savedApps,this.populateAppsRows()}},{key:"initUI",value:function(){(0,r.Z)((0,l.Z)(u.prototype),"initUI",this).call(this),this.element=(0,p.vz)("div",{style:{width:"850px",borderStyle:"solid",borderWidth:"1px",borderRadius:"5px 5px 0 0"}},this.createAppsTable(),(0,p.vz)("div",{style:{margin:"10px 8px"}},this.createDevportalMessage())),(0,g.vP)(this.element,"aspPanel")}},{key:"createAppsTable",value:function(){return(0,p.vz)("table",{style:A},(0,p.vz)("tr",null,(0,p.vz)("th",{colSpan:6,style:{fontSize:"14px",padding:"8px",borderRadius:"5px 5px 0 0"},colorClass:"header","data-test":"v2-apps-header"},"v2 ",f.ag.apps,(0,p.vz)("span",{colorClass:"headerBadge",style:{padding:"2px 7px",margin:"0 5px",borderRadius:"2px"}},f.ag.newCapitalized))),(0,p.vz)("tr",null,(0,p.vz)("td",{colSpan:6},(0,p.vz)("div",{style:{fontSize:"12px",margin:"8px 8px",padding:"8px 10px",borderRadius:"5px"},colorClass:"notice","data-test":"v2-apps-header-text"},f.ag.v2AppsDescription))),this.appRows.slice(0,10).map((function(e){return e})))}},{key:"populateAppsRows",value:function(){var e=this;this.appRows=[];for(var t=0;t<10;++t)this.appRows.push((0,p.vz)(R,{slot:t+1}));this.savedApps.forEach((function(t){void 0!==t.slot?e.appRows[t.slot-1]=(0,p.vz)(P,{app:t,slot:t.slot}):error("".concat(t.name," has no slot"))}))}},{key:"createDevportalMessage",value:function(){var e=f.ag.devportalMessage(this.authUrl),t=document.createElement("p");return t.innerHTML=e.replace(/\s{2,}/gm," "),t.style.margin="0",t.style.fontSize="12px",t.setAttribute("data-test","dev-portal-link-text"),t}},{key:"render",value:function(){return this.element}}]),u}(h.I),A={borderCollapse:"collapse",textAlign:"left",width:"100%"},E={width:"110px"},B={padding:"3px 8px"},L={verticalAlign:"middle",display:"inline-block"}},2748:function(e,t,n){"use strict";n.d(t,{X:function(){return b}});var i=n(4649),o=n(126),r=n(2951),s=n(1976),a=n(7591),l=n(9492),c=n(7597),u=n(9),d=n(3543),h=n(47),f=n(1185),p=n(851);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var b=function(e){(0,a.Z)(u,e);var t,n,i=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(e){return(0,r.Z)(this,u),i.call(this,"div",e)}return(0,s.Z)(u,[{key:"initData",value:function(e){this.app=e.app,this.onChange=e.onChange,this.submit=e.submit,this.exclusiveApps=e.exclusiveApps,this.cbappAppUsed=e.cbappsAppUsed,this.showPermissions=!1,this.initExclusivePermissions()}},{key:"initUI",value:function(e){var t=this;this.permissionsForm=this.createPermissionsForm(),this.permissionsForm.style.display="none",this.element=(0,h.vz)("div",null,this.showPermissions&&(0,h.vz)("div",{onClick:function(){t.togglePermissionsForm()},style:{display:"flex",justifyContent:"space-between",margin:"10px 10px 0"}},(0,h.vz)("h3",{style:{fontSize:"12px",fontFamily:"ubuntumedium",fontWeight:500,minWidth:"200px",color:"#494949"}},d.ag.permissions),(0,h.vz)("h3",{ref:function(e){t.permissionsStatus=e},style:{fontSize:"12px"},colorClass:"subText"},this.getStatusText()),(0,h.vz)("div",null),(0,h.vz)("div",null),(0,h.vz)("div",null,(0,h.vz)("div",{style:{margin:"10px 10px 0 0",width:"15px",height:"15px",backgroundSize:"cover"},ref:function(e){t.chevronDown=e},colorClass:"chevronDown"}),(0,h.vz)("div",{style:{margin:"10px 10px 0 0",width:"15px",height:"15px",backgroundSize:"cover",display:"none"},ref:function(e){t.chevronUp=e},colorClass:"chevronUp"}))),(0,h.vz)("div",null,this.permissionsForm)),(0,f.vP)(this.element,"appForm"),!this.app.isInstalled&&this.showPermissions&&this.togglePermissionsForm()}},{key:"togglePermissionsForm",value:function(){this.showPermissions&&(this.permissionsForm.style.display="none"===this.permissionsForm.style.display?"block":"none",this.chevronDown.style.display="none"===this.chevronDown.style.display?"block":"none",this.chevronUp.style.display="none"===this.chevronUp.style.display?"block":"none")}},{key:"initialValue",value:function(e,t){var n;return!this.app.isInstalled||(!(!this.app.hasUpdate||"ask"===(null===(n=this.app.installed)||void 0===n?void 0:n.permissions[e].settings)||e in u.EXCLUSIVE_PERMISSIONS&&""!==this.exclusivePermissions[e])||t)}},{key:"createPermissionsForm",value:function(){var e=this,t={};if(this.app.isInstalled&&void 0!==this.app.permissionsValues)t=this.app.permissionsValues;else for(var n=0,i=Object.keys(u.APP_PERMISSIONS);n<i.length;n++){var o=i[n];t[o]=!1}return(0,h.vz)("form",{onKeyPress:function(t){"Enter"===t.key&&(t.preventDefault(),t.stopPropagation(),e.submit())}},(0,h.vz)("ul",null,Object.keys(t).map((function(n){if("ask"===e.app.latest.permissions[n].settings){e.showPermissions=!0;var i=e.initialValue(n,t[n]);return e.renderPermission(n,i)}return""}))))}},{key:"initExclusivePermissions",value:function(){var e=Object.keys(u.EXCLUSIVE_PERMISSIONS);this.exclusivePermissions={};for(var t=0,n=e;t<n.length;t++){var i=n[t];this.exclusivePermissions[i]=""}var o,r=g(this.exclusiveApps);try{for(r.s();!(o=r.n()).done;){var s=o.value;if(this.app.id!==s.id){var a,l=g(e);try{for(l.s();!(a=l.n()).done;){var c,d=a.value;Boolean(null===(c=s.permissionsValues)||void 0===c?void 0:c[d])&&(this.exclusivePermissions[d]=s.name)}}catch(e){l.e(e)}finally{l.f()}}}}catch(e){r.e(e)}finally{r.f()}}},{key:"getStatusText",value:function(){var e=0;(0,o.Z)(this.permissionsForm.elements).forEach((function(t){t.checked&&(e+=1)}));var t=e/this.permissionsForm.elements.length;return 1===t?d.ag.allPermissionsText:0===t?d.ag.noPermissionsText:d.ag.somePermissionsText}},{key:"exclusiveAppTextElement",value:function(e){var t,n=null===(t=this.exclusivePermissions)||void 0===t?void 0:t[e],i=u.APP_PERMISSIONS[e].exclusiveText;return this.cbappAppUsed&&""!==i?i=d.ag.activeAppOverrideText:e in this.exclusivePermissions&&""!==this.exclusivePermissions[e]&&(i=d.ag.usedByText(n)),(0,h.vz)("p",{style:{width:"450px",padding:"0 0 0 25px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},i)}},{key:"checkboxElement",value:function(e,t){var n=new p.S(16,t,this.onChange);return n.setName(e),n.element.style.minWidth="16px",n.element}},{key:"renderPermission",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e in u.APP_PERMISSIONS){var i=u.APP_PERMISSIONS[e],o=this.checkboxElement(e,t);return(0,h.vz)("li",{style:{display:"flex",justifyContent:"left",cssFloat:"none",alignItems:"center",borderBottom:"1px solid #E5E5E5",padding:"10px",margin:"0"}},(0,h.vz)("div",{style:{minWidth:"220px",margin:"0 8px 0 0"}},(0,h.vz)("p",{style:{fontSize:"12px",margin:0,padding:0,fontFamily:"ubuntumedium",fontWeight:500}},i.label),(0,h.vz)("p",{style:{fontSize:"10px",margin:0,padding:0},colorClass:"subText"},i.description)),o,n?"":this.exclusiveAppTextElement(e))}}},{key:"updateStatusText",value:function(){void 0!==this.permissionsStatus&&(this.permissionsStatus.innerText=this.getStatusText(),(0,o.Z)(this.permissionsForm.elements).forEach((function(e){if(e.checked){var t=e.nextSibling;""!==t.innerText&&(t.innerText="")}})))}},{key:"formData",value:function(){for(var e=u.ALL_PERMISSIONS,t={},n=0,i=Object.values(e);n<i.length;n++)t[i[n]]=!1;var o,r=g(new FormData(this.permissionsForm).keys());try{for(r.s();!(o=r.n()).done;){var s=o.value;s in e&&(t[e[s]]=!0)}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"modalFormData",value:function(e){var t,n=u.ALL_PERMISSIONS,i={},o=g(e.elements);try{for(o.s();!(t=o.n()).done;){var r=t.value;r.name in n&&(i[n[r.name]]=r.checked)}}catch(e){o.e(e)}finally{o.f()}return i}},{key:"getFormData",value:function(e){var t={};return void 0!==e&&(t=this.modalFormData(e)),v(v({},this.formData()),t)}},{key:"getSelectedExclusiveConflicts",value:function(){var e,t=[],n=g(new FormData(this.permissionsForm).keys());try{for(n.s();!(e=n.n()).done;){var i=e.value;i in this.exclusivePermissions&&""!==this.exclusivePermissions[i]&&t.push(i)}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"shouldConfirmModal",value:function(){return this.getSelectedExclusiveConflicts().length>0}},{key:"confirmModalForm",value:function(){var e=this,t=this.getSelectedExclusiveConflicts();return(0,h.vz)("form",null,(0,h.vz)("ul",null,t.map((function(n,i){var o=e.renderPermission(n,!0,!0);return void 0!==o&&t.length===i+1&&(o.style.borderBottom="none"),o}))))}},{key:"render",value:function(){return this.element}}]),u}(u.w);b.EXCLUSIVE_PERMISSIONS={videoPanel:"videoPanel",tipOptions:"tipOptions"},b.ALL_PERMISSIONS=v(v({},b.EXCLUSIVE_PERMISSIONS),{},{rewriteMessages:"rewriteMessages"}),b.APP_PERMISSIONS={videoPanel:{label:d.ag.videoPanelLabel,description:d.ag.exclusiveAppPermissionText,exclusiveText:d.ag.aspPermissionOverrideText},rewriteMessages:{label:d.ag.transformMessagesLabel,description:"",exclusiveText:""},tipOptions:{label:d.ag.tipOptionsLabel,description:d.ag.exclusiveAppPermissionText,exclusiveText:""}}},8945:function(e,t,n){"use strict";n.d(t,{X:function(){return v}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(7585),u=n(9598),d=n(3543),h=n(47),f=n(2800),p=n(6265);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var v=function(e){(0,s.Z)(n,e);var t=m(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"callFollowApi",value:function(e){var t,n=e?(0,u.kr)(this.props.slug,u.wk,this.isAnonymous):(0,u.c5)(this.props.slug,u.wk,this.isAnonymous);return null!==(t=null==n?void 0:n.then((function(e){return e?Promise.resolve():Promise.reject()})))&&void 0!==t?t:Promise.reject()}}]),n}(function(e){(0,s.Z)(n,e);var t=m(n);function n(e){var o;return(0,i.Z)(this,n),(o=t.call(this,e)).props=e,o.isAnonymous=void 0===f.J.current.loggedInUser,o.isMobile=f.J.current.isMobile,o}return(0,o.Z)(n,[{key:"initData",value:function(e){(0,r.Z)((0,l.Z)(n.prototype),"initData",this).call(this,e),this.setState({isActive:e.isFollowing})}},{key:"createElement",value:function(e){var t=this;return this.hideTitle=void 0!==e.hideTitle&&e.hideTitle,(0,h.vz)("div",{bind:{className:function(){return"follow_star ".concat(t.getIconClass())},title:function(){return t.getTitle()},style:function(){return t.getStyle()}},"data-slug":e.slug,onClick:function(n){t.handleClick(),!0!==e.allowPropagation&&n.stopPropagation(),n.preventDefault()}})}},{key:"getIconClass",value:function(){return void 0===this.state.isActive?"icon_update_following":this.state.isActive?"icon_following":"icon_not_following"}},{key:"getTitle",value:function(){return this.hideTitle||void 0===this.state.isActive?"":this.state.isActive?d.ag.unfollowText:d.ag.followText}},{key:"getStyle",value:function(){return{}}},{key:"setHover",value:function(){var e=this;this.element.classList.add("no_hover"),window.setTimeout((function(){e.element.classList.remove("no_hover")}),3e3)}},{key:"setFollowing",value:function(e){this.setState({isActive:e})}},{key:"handleClick",value:function(){var e=this;if(!this.isAnonymous||this.isMobile){var t=!0===this.state.isActive;this.setState({isActive:void 0}),this.callFollowApi(!t).then((function(){e.setState({isActive:!t}),e.setHover()})).catch((function(){e.setState({isActive:t})}))}else(0,p.iW)({fromFeature:!0})}}]),n}(c.I))},6853:function(e,t,n){"use strict";n.d(t,{GB:function(){return I},KR:function(){return h},MG:function(){return u},On:function(){return w},RH:function(){return T},Ve:function(){return v},YX:function(){return g},_t:function(){return y},iq:function(){return m},js:function(){return b},yY:function(){return d}});var i=n(8759),o=n(7693),r=n(3753),s=n(391),a=n(1794);function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var u=new a.xB("newFollowedOnline"),d=new a.xB("onlineFollowedStorage"),h=new a.xB("onlineFollowedStorage"),f="onlineFollowedTab",p="followedDropdownClicked";function m(e,t,n,o,r){if((0,i.IU)()){var s={username:e,onlineFollowedList:k(t),seenRooms:n,unseenRooms:C(r),flash:o,timestamp:Date.now()};window.localStorage.setItem(f,JSON.stringify(s))}}function v(){if((0,i.IU)()){var e=window.localStorage.getItem(f);if(null!==e){var t,n=JSON.parse(e),o=l(n.unseenRooms);try{for(o.s();!(t=o.n()).done;){var r=t.value;n.seenRooms[r.room]=!0}}catch(e){o.e(e)}finally{o.f()}n.timestamp=Date.now(),n.flash=!1,n.unseenRooms=[],window.localStorage.setItem(f,JSON.stringify(n))}}}function g(){(0,i.IU)()&&window.localStorage.setItem(p,JSON.stringify({timestamp:Date.now()}))}function y(){if((0,i.IU)()){var e=window.localStorage.getItem(f);if(null!==e){var t=JSON.parse(e);t.timestamp=Date.now(),window.localStorage.setItem(f,JSON.stringify(t))}}}function b(){if((0,i.IU)()){var e=window.localStorage.getItem(f);if(null!==e){var t=JSON.parse(e);return{username:t.username,onlineFollowedList:S(t.onlineFollowedList),seenRooms:t.seenRooms,unseenRooms:x(t.unseenRooms),flash:t.flash,timestamp:t.timestamp}}}}function w(){(0,i.IU)()&&(0,o.j9)("storage",window,(function(e){if(e.key===f){var t=b();void 0!==t&&d.fire(t)}if(e.key===p&&null!==e.newValue){var n=b();void 0!==n&&(n.timestamp=JSON.parse(e.newValue).timestamp,n.flash=!1,n.unseenRooms=[],h.fire(n))}}))}function C(e){var t,n=[],i=l(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;n.push({room:o.room,image:o.image})}}catch(e){i.e(e)}finally{i.f()}return n}function x(e){var t,n=[],i=l(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;n.push({room:o.room,image:o.image})}}catch(e){i.e(e)}finally{i.f()}return n}function k(e){var t,n={onlineFollowed:{online:e.onlineFollowed.online,total:e.onlineFollowed.total},roomList:[]},i=l(e.roomList);try{for(i.s();!(t=i.n()).done;){var o=t.value;n.roomList.push({room:o.room,image:o.image})}}catch(e){i.e(e)}finally{i.f()}return n}function S(e){var t,n={onlineFollowed:{online:e.onlineFollowed.online,total:e.onlineFollowed.total},roomList:[]},i=l(e.roomList);try{for(i.s();!(t=i.n()).done;){var o=t.value;n.roomList.push({room:o.room,image:o.image})}}catch(e){i.e(e)}finally{i.f()}return n}function T(e){var t=e.split(/[()/]+/);return 4!==t.length?{online:0,total:0}:{online:parseInt(t[1]),total:parseInt(t[2])}}function I(){return(0,r.Ue)("follow/api/online_followed_rooms/").then((function(e){var t,n=new s.j(e.responseText);return{onlineFollowed:{online:n.getNumber("online"),total:n.getNumber("total")},roomList:(t=n.getAny("online_rooms"),t.map((function(e){return{room:e.room,image:e.image}})))}}))}},9034:function(e,t,n){"use strict";n.d(t,{A:function(){return R},p:function(){return I}});var i=n(7791),o=n(126),r=n(2951),s=n(1976),a=n(7591),l=n(9492),c=n(7597),u=n(4649),d=n(824),h=n.n(d),f=n(8759),p=n(3753),m=n(391),v=n(9),g=n(8263),y=n(1794),b=n(3543),w=n(47),C=n(1612);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=function(){return(0,w.vz)("img",{src:C.w.logoImageName,style:{maxWidth:"198px"}})},T=function(e){var t,n=function(e){return(0,w.vz)("div",{style:k({display:"inline-block",verticalAlign:"middle"},e.style)},e.children)};return(0,w.vz)("div",{className:"game-search-result",style:{marginTop:"12px",position:"relative"}},(0,w.vz)(n,{style:{paddingRight:"1em"}},(0,w.vz)("img",{src:e.image,style:{borderRadius:"5px",objectFit:"cover",overflow:"hidden"},width:"42px",height:"42px"})),(0,w.vz)(n,null,(0,w.vz)("div",{style:{fontSize:"14px",lineHeight:"22px",fontFamily:"UbuntuMedium, Helvetica, Arial, sans-serif",height:"50%"}},(0,w.vz)("a",{href:"#",onClick:function(t){t.preventDefault(),e.onClick()}},e.name)),(0,w.vz)("div",{style:{fontSize:"12px",lineHeight:"20px",height:"50%"}},"Viewers: ",null!==(t=e.viewers)&&void 0!==t?t:0)),(0,w.vz)(n,{style:{position:"absolute",right:"0",top:"50%",transform:"translateY(-50%)"}},(0,w.vz)("div",{style:{fontSize:"12px",lineHeight:"14px",borderRadius:"4px",cursor:"pointer",display:"inline-block",padding:"7px 8px",marginRight:"18px",userSelect:"none"},className:"selectGameButton",onClick:e.onClick},"Select game")))},I=function(e){var t=document.createElement("p");return t.innerHTML=e.replace(/\s{2,}/gm," "),t.style.width="90%",t},R=function(e){(0,a.Z)(R,e);var t,n,u,d,v,y,x,k=(y=R,x=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,c.Z)(y);if(x){var n=(0,c.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,l.Z)(this,e)});function R(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1?arguments[1]:void 0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return(0,r.Z)(this,R),(t=k.call(this)).totalGames=i,t.currentPage=o,t.searchQuery=s,t.OBS_TUTORIAL_URL="https://support.chaturbate.com/hc/en-us/articles/360037971952-How-do-I-set-up-OBS-",t.SEARCH_DELAY=500,(0,g.Zs)(t.element,{position:"relative",width:"unset",height:"unset"}),t.element.appendChild(t.render()),t.searchAPIResults=n,t.renderSearchResults(),t.renderPagination(),null===(e=document.getElementById("search_games_input"))||void 0===e||e.focus(),t.searchTimer=void 0,t}return(0,s.Z)(R,[{key:"render",value:function(){var e,t=this,n=document.body.classList.contains("darkmode");return(0,w.vz)("div",{className:"GameSelection",ref:function(e){t.displayElement=e}},(0,w.vz)("div",{className:"title"},(0,w.vz)("h1",{style:{color:"#494949",marginBottom:"0px",fontSize:"1.3em",fontWeight:"bolder"}},b.ag.selectGameHeaderText),(0,w.vz)("p",{style:{fontSize:"14px",lineHeight:"22px",margin:"12px 0 0"},className:"title"},I(b.ag.selectGameSectionText(C.w.siteName,C.w.cbGamesUrl)))),(0,w.vz)("div",null,(0,w.vz)("div",{style:{borderRadius:"4px",display:"inline-block",padding:"5px 8px",verticalAlign:"middle",fontSize:"14px"},className:"searchBar"},(0,w.vz)("input",{id:"search_games_input",type:"text",placeholder:"Search Games",style:{width:"210px",border:"0",outline:"none"},onInput:function(e){t.searchQueryChanged(e)},value:null!==(e=this.searchQuery)&&void 0!==e?e:"",maxLength:50}),(0,w.vz)("label",{for:"search_games_input"},(0,w.vz)("img",{src:"".concat(STATIC_URL_ROOT,"images/search").concat(n?"_dm":"",".svg"),width:"12",height:"12",style:{verticalAlign:"middle"}})))),(0,w.vz)("div",{ref:function(e){t.searchResults=e}}),(0,w.vz)("ul",{ref:function(e){t.paginationDOM=e}}))}},{key:"renderSearchResults",value:function(){var e;if(void 0!==this.searchAPIResults){var t=this.searchAPIResults.length>0?(0,w.vz)("div",null,this.searchAPIResults.map((function(e){return(0,w.vz)(T,{name:e.name,gameUrl:e.gameUrl,viewers:e.viewers,image:e.image,uid:e.uid,onClick:function(){window.location.href=(0,p.BN)(encodeURI("/games/confirm_game/".concat(e.uid,"/")))}})}))):(0,w.vz)("h3",{style:{fontSize:"14px",color:"#0B5D81"}},"No Results"),n=(0,w.vz)("div",null,t);null===(e=this.displayElement)||void 0===e||e.replaceChild(n,this.searchResults),this.searchResults=n}}},{key:"renderPagination",value:function(){var e,t=this,n=Math.floor(this.totalGames/20);this.totalGames%20>0&&(n+=1);var i,r=""===this.searchQuery?"?":"?q=".concat(this.searchQuery,"&"),s=(0,o.Z)((i=n,Array.from({length:i},(function(e,t){return t})))).map((function(e){e+=1;var n=t.currentPage===e?"active":"ok";return(0,w.vz)("li",{className:n,style:{margin:"0 2px",display:t.totalGames<=20?"none":""}},(0,w.vz)("a",{href:encodeURI("".concat(r,"p=").concat(e))},"".concat(e)))})),a=(0,w.vz)("ul",{className:"paging",style:{display:"flex",justifyContent:"center"}},(0,w.vz)("li",{style:{display:1===this.currentPage?"none":"inline-block",cursor:"pointer"}},(0,w.vz)("a",{className:"prev",style:{height:"100%"},href:encodeURI("".concat(r,"p=").concat(this.currentPage-1))})),s,(0,w.vz)("li",{style:{display:this.totalGames<20||this.currentPage===n?"none":"inline-block",cursor:"pointer"}},(0,w.vz)("a",{href:encodeURI("".concat(r,"p=").concat(this.currentPage+1)),className:"next",style:{height:"100%"}})));null===(e=this.displayElement)||void 0===e||e.replaceChild(a,this.paginationDOM),this.paginationDOM=a}},{key:"searchQueryChanged",value:function(e){if(e.stopPropagation(),this.searchQuery=e.target.value,0===this.searchQuery.length||this.searchQuery.length>1){this.currentPage=1,this.scheduleSearch();var t=document.getElementsByTagName("title")[0].innerHTML,n=0===this.searchQuery.length?{}:{q:this.searchQuery},i=0===this.searchQuery.length?"".concat(location.pathname):"".concat(location.pathname,"?q=").concat(this.searchQuery);window.history.replaceState(n,t,(0,p.BN)(i))}}},{key:"scheduleSearch",value:function(){var e=this;void 0!==this.searchTimer&&clearTimeout(this.searchTimer),this.searchTimer=window.setTimeout((0,i.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.doSearch();case 2:case"end":return t.stop()}}),t)}))),this.SEARCH_DELAY)}},{key:"doSearch",value:(v=(0,i.Z)(h().mark((function e(){var t,n,i,o,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n="".concat(R.GAME_QUERY_URL,"?q=").concat(encodeURI(this.searchQuery)),1!==this.currentPage&&(n+="&p=".concat(this.currentPage)),e.next=5,(0,p.Ue)(n);case 5:i=e.sent,o=new m.j(i.responseText),this.totalGames=o.getNumber("total"),r=o.getList("games"),this.searchAPIResults=void 0!==r?R.parseSearchResults(r):[],this.renderSearchResults(),this.renderPagination(),null===(t=document.getElementById("search_games_input"))||void 0===t||t.focus(),(0,f.jI)().scrollTop=0,this.searchTimer=void 0,e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),this.searchTimer=void 0;case 20:case"end":return e.stop()}}),e,this,[[0,17]])}))),function(){return v.apply(this,arguments)})},{key:"selectGameAndClose",value:(d=(0,i.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.selectGame(t);case 2:case"end":return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)})}],[{key:"selectGame",value:(u=(0,i.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=(0,i.Z)(h().mark((function e(n){var i,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,p.I5)(R.GAME_SELECT_URL,{uid:t});case 3:i=e.sent,o=R.parseSelection(i.responseText),R.selectionChange.fire(o),n(!0),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),n(!1);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"deselectGame",value:(n=(0,i.Z)(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.I5)(R.GAME_DESELECT_URL,{});case 2:R.selectionChange.fire(void 0);case 3:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"getCurrentGame",value:(t=(0,i.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=(0,i.Z)(h().mark((function e(n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.Ue)("".concat(R.GAME_CURRENT_URL).concat(encodeURI(t)));case 2:i=e.sent,n(R.parseSelection(i.responseText));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"parseSearchResults",value:function(e){return e.map((function(e){var t=e.getNumberOrUndefined("viewers");return{image:e.getString("image_64x64"),name:e.getString("name"),gameUrl:e.getString("game_url"),uid:e.getString("uid"),viewers:void 0===t?0:t}}))}},{key:"parseSelection",value:function(e){if(void 0!==e){var t=JSON.parse(e);if(null!==t)return{description:t.description,gameUrl:t.game_url,image:t.image_64x64,name:t.name,uid:t.uid,viewers:t.viewers}}}},{key:"generateHeader",value:function(){var e=(0,w.vz)("a",null),t=(0,w.vz)("div",null);return{headerContainer:(0,w.vz)("div",{className:"OBSInfoSection"},(0,w.vz)("div",null,(0,w.vz)(S,null)),(0,w.vz)("div",{className:"title"},(0,w.vz)("a",{href:"#",style:{display:"none"},ref:function(t){e=t}},(0,w.vz)("p",{style:{fontSize:"24px",lineHeight:"32px",fontFamily:"UbuntuMedium, Helvetica, Arial, sans-serif",margin:"16px 0 10px",color:"#0a5a83"}},"Games")),(0,w.vz)("p",{ref:function(e){t=e},style:{fontSize:"24px",lineHeight:"32px",fontFamily:"UbuntuMedium, Helvetica, Arial, sans-serif",margin:"16px 0 10px",display:"block"}},"Games"))),headerWithPageLink:e,header:t}}}]),R}(v.w);R.GAME_QUERY_URL="api/ts/games/search/",R.GAME_SELECT_URL="api/ts/games/select/",R.GAME_INFO_URL="api/ts/games/info/",R.GAME_DESELECT_URL="api/ts/games/deselect/",R.GAME_CURRENT_URL="api/ts/games/current/room/",R.selectionChange=new y.xB("gameSelectionChanged")},9809:function(e,t,n){"use strict";n.d(t,{kK:function(){return g},k5:function(){return y},Q1:function(){return b}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(7693),u=n(9874),d=n(47),h=n(8213),f=n(2800),p=n(9839),m=n(3871);function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var g=function(e){(0,s.Z)(g,e);var t,n,u=(t=g,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function g(){var e;return(0,i.Z)(this,g),(e=u.call(this,{onShow:function(){e.element.classList.add("data-hj-suppress"),e.element.style.display="block",e.repositionChildren()},easyExit:!0})).currentIndex=0,h.zA.listen((function(t){e.deleteMedia(t)}),!1),h.lk.listen((function(t){e.deleteMedia(t)}),!1),e}return(0,o.Z)(g,[{key:"mediaList",get:function(){return this.mediasetProps.mediaList}},{key:"currentItem",get:function(){return this.mediaList[this.currentIndex]}},{key:"init",value:function(e){var t,n,i,o,r;this.mediasetProps=e,this.mediasetProps.outgoing=null!==(t=this.mediasetProps.outgoing)&&void 0!==t&&t;var s=(null!==(n=null===(i=visualViewport)||void 0===i?void 0:i.height)&&void 0!==n?n:window.innerHeight)>(null!==(o=null===(r=visualViewport)||void 0===r?void 0:r.width)&&void 0!==o?o:window.innerWidth),a="calc(100% - ".concat(s?72:20,"px)"),l="calc(100% - ".concat(s?20:72,"px)");this.mediaList.length>1&&(l="calc(100% - ".concat(f.J.current.isMobile?92:180,"px)"));var c,u=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(this.mediaList);try{for(u.s();!(c=u.n()).done;){var h=c.value;if(void 0!==h.imageElement)break;h.imageElement=(0,d.vz)("img",{src:h.url,style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",maxHeight:a,maxWidth:l},onLoad:function(){var e;null===(e=g.instance)||void 0===e||e.repositionChildren()}})}}catch(e){u.e(e)}finally{u.f()}this.rebuildUI()}},{key:"rebuildUI",value:function(){var e,t,n=this;this.arrowContainers=void 0,this.mediaList.filter((function(e){return""!==e.thumbnailUrl})).length>1&&(this.arrowContainers=new p.u((function(){n.previous()}),(function(){n.next()})),this.arrowContainers.shiftArrows(f.J.current.isMobile?8:25)),this.element=(0,d.vz)("div",{tabIndex:-1,style:{position:"fixed",zIndex:1101,outline:"none",width:"80vw",height:"80vh",top:"50%",left:"50%",transform:"translate(-50%, -50%)",boxSizing:"border-box"},colorClass:"ChatMediaCarousel"},(e=function(){n.hide()},t=(0,d.vz)("path",{fill:"#E2E2E2",d:"M11.7255 0.392534C11.6095 0.276307 11.4717 0.184097 11.32 0.121183C11.1684 0.0582692 11.0058 0.0258858 10.8415 0.0258858C10.6773 0.0258858 10.5147 0.0582692 10.363 0.121183C10.2113 0.184097 10.0735 0.276307 9.95753 0.392534L6.23553 4.11453C6.18867 4.16125 6.1252 4.18748 6.05903 4.18748C5.99287 4.18748 5.9294 4.16125 5.88253 4.11453L2.15953 0.392534C2.0448 0.270837 1.90682 0.173402 1.75375 0.106C1.60068 0.0385979 1.43564 0.00259895 1.26841 0.000135597C1.10118 -0.00232775 0.935151 0.0287947 0.780163 0.0916592C0.625176 0.154524 0.484381 0.247852 0.366117 0.366117C0.247852 0.484381 0.154524 0.625176 0.0916592 0.780163C0.0287947 0.935151 -0.00232775 1.10118 0.000135597 1.26841C0.00259895 1.43564 0.0385979 1.60068 0.106 1.75375C0.173402 1.90682 0.270837 2.0448 0.392534 2.15953L4.11453 5.88153C4.13782 5.90476 4.15629 5.93234 4.16889 5.96272C4.18149 5.99309 4.18798 6.02565 4.18798 6.05853C4.18798 6.09142 4.18149 6.12398 4.16889 6.15435C4.15629 6.18472 4.13782 6.21231 4.11453 6.23553L0.392534 9.95953C0.158287 10.1941 0.0267145 10.512 0.0267145 10.8435C0.0267145 11.175 0.158287 11.493 0.392534 11.7275C0.629353 11.9575 0.946449 12.0861 1.27653 12.0861C1.60662 12.0861 1.92371 11.9575 2.16053 11.7275L5.88253 8.00553C5.90567 7.98228 5.93317 7.96383 5.96346 7.95124C5.99375 7.93865 6.02623 7.93217 6.05903 7.93217C6.09184 7.93217 6.12431 7.93865 6.1546 7.95124C6.18489 7.96383 6.2124 7.98228 6.23553 8.00553L9.95953 11.7255C10.1967 11.9548 10.5137 12.0829 10.8435 12.0829C11.1734 12.0829 11.4904 11.9548 11.7275 11.7255C11.9618 11.491 12.0934 11.173 12.0934 10.8415C12.0934 10.51 11.9618 10.1921 11.7275 9.95753L8.00553 6.23553C7.98225 6.21231 7.96378 6.18472 7.95118 6.15435C7.93857 6.12398 7.93209 6.09142 7.93209 6.05853C7.93209 6.02565 7.93857 5.99309 7.95118 5.96272C7.96378 5.93234 7.98225 5.90476 8.00553 5.88153L11.7255 2.15953C11.8416 2.04354 11.9337 1.90581 11.9965 1.75422C12.0593 1.60262 12.0917 1.44013 12.0917 1.27603C12.0917 1.11194 12.0593 0.949446 11.9965 0.797851C11.9337 0.646255 11.8416 0.508526 11.7255 0.392534Z"}),(0,d.vz)("div",{className:"closeButton",style:{position:"absolute",width:"15px",padding:"15px",right:"0px",zIndex:1102,cursor:"pointer"},onMouseEnter:function(){t.style.fill="#B8B8B8"},onMouseLeave:function(){t.style.fill="#E2E2E2"},onClick:e},(0,d.vz)("svg",{viewBox:"0 0 13 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t))),void 0!==this.arrowContainers?this.arrowContainers.leftContainer:void 0,void 0!==this.arrowContainers?this.arrowContainers.rightContainer:void 0),(0,c.j9)("keydown",this.element,(function(e){switch(e.key){case"Left":case"ArrowLeft":n.previous();break;case"Right":case"ArrowRight":n.next();break;case"Esc":case"Escape":n.hide()}}))}},{key:"clearCurrent",value:function(){var e;null===(e=this.currentItem)||void 0===e||null===(e=e.imageElement)||void 0===e||null===(e=e.parentElement)||void 0===e||e.removeChild(this.currentItem.imageElement)}},{key:"displayImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.show(),this.clearCurrent(),this.currentIndex=e,void 0!==this.currentItem&&void 0!==this.currentItem.imageElement&&(this.element.appendChild(this.currentItem.imageElement),this.mediasetProps.outgoing||!1!==this.currentItem.opened||(this.currentItem.opened=!0,(0,h.$6)(this.currentItem.fromUserUID,this.mediasetProps.messageId,this.currentItem.mediaId),m.s.markOpened(this.mediasetProps.messageId,this.currentItem.mediaId))),this.repositionChildren()}},{key:"hide",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,r.Z)((0,l.Z)(g.prototype),"hide",this).call(this,e),this.clearCurrent()}},{key:"deleteMedia",value:function(e){var t,n=this.mediaList.findIndex((function(t){return t.mediaId===e}));-1!==n&&(this.currentIndex===n&&this.hide(),this.mediaList.splice(n,1),this.currentIndex>n&&(this.currentIndex-=1),1===this.mediaList.length&&(null===(t=this.arrowContainers)||void 0===t||t.hideArrows()))}},{key:"next",value:function(){for(var e=(this.currentIndex+1)%this.mediaList.length;""===this.mediaList[e].thumbnailUrl;)e=(e+1)%this.mediaList.length;this.displayImage(e)}},{key:"previous",value:function(){for(var e=this.currentIndex>0?this.currentIndex-1:this.mediaList.length-1;""===this.mediaList[e].thumbnailUrl;)e=e>0?e-1:this.mediaList.length-1;this.displayImage(e)}},{key:"repositionChildren",value:function(){var e;null===(e=this.arrowContainers)||void 0===e||e.repositionArrows(this.element.offsetHeight)}}],[{key:"loadMedia",value:function(e,t){void 0===g.instance&&(g.instance=new g),g.instance.mediasetProps!==e&&g.instance.init(e),g.instance.displayImage(g.instance.mediaList.indexOf(t))}}]),g}(u.z),y=64,b={width:"".concat(y,"px"),height:"".concat(y,"px"),margin:"0px 1px",display:"inline-block",backgroundSize:"cover",backgroundPosition:"center",position:"relative",cursor:"pointer",borderRadius:"4px",overflow:"hidden",zIndex:0}},7510:function(e,t,n){"use strict";n.d(t,{p:function(){return $},L:function(){return Y}});var i=n(7791),o=n(4649),r=n(2951),s=n(1976),a=n(7169),l=n(3243),c=n(7591),u=n(9492),d=n(7597),h=n(824),f=n.n(h),p=n(695),m=n(4793),v=n(9),g=n(1794),y=n(3705),b=n(9545),w=n(3543),C=n(47),x=n(9420),k=n(6474),S=n(1185),T=n(2800),I=n(1612),R=n(6208),P=n(6832),M=n(8759),A=n(9493),E=n(8263),B=n(6479),L=n(9482),O=n(9491),D=n(1006),U=n(1359);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _="calc(100% - 36px)",N=function(e){(0,c.Z)(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,d.Z)(t);if(n){var o=(0,d.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,u.Z)(this,e)});function o(e){return(0,r.Z)(this,o),i.call(this,"div",e)}return(0,s.Z)(o,[{key:"initData",value:function(e){this.isDropdown=e.isDropdown,this.userColorClass=(0,L.c9)(e.rawData.otherUser),this.otherUsername=e.rawData.otherUser.username,this.fromUser=e.rawData.fromUsername,this.message=e.rawData.message,this.hasMedia=e.rawData.hasMedia,this.numUnread=e.rawData.numUnread,this.time=e.rawData.time,this.isDropdown=e.isDropdown,this.rawData=e.rawData}},{key:"getRawData",value:function(){return this.rawData}},{key:"initUI",value:function(e){var t=this,n={display:"inline-block",left:"".concat(o.CHAT_HEADER_LEFT_PX,"px"),position:"absolute",verticalAlign:"bottom",whiteSpace:"nowrap"},i={bottom:"8px",paddingLeft:"".concat(o.CHAT_HEADER_LEFT_PX-8,"px"),overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:_,boxSizing:"border-box"},r=this.getElapsedTimeString(),s=this.getMessagePreview(),a=this.otherUsername!==this.fromUser;a&&(s.style.maxWidth="calc(100% - 14px)");var l=this.numUnread>0&&(""!==this.message||this.hasMedia);this.numUnreadContainer=(0,C.vz)("span",null,l?" (".concat(this.numUnread,")"):""),this.elapsedTimeContainer=(0,C.vz)("div",{className:"timeString",style:{fontSize:"10px",position:"absolute",right:"8px",textAlign:"right",top:"8px"}},r),this.usernameSpan=this.getUsernameSpan({fontFamily:"Tahoma, Arial, Helvetica, sans-serif",fontWeight:"bold",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",verticalAlign:"bottom"}),this.updateUsernameMaxWidth(),this.element=(0,C.vz)("div",{colorClass:["conversationListItem","".concat(l?"unreadBg":"")],style:{borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",fontFamily:"Tahoma, Arial, Helvetica, sans-serif",fontSize:"12px",height:"40px",lineHeight:"14px",overflowX:"hidden",padding:"8px",position:"relative",textAlign:"left"},onClick:function(){e.openConversationEvent.fire(t.otherUsername)}},(0,C.vz)(j,{name:this.otherUsername,style:{marginTop:"-16px",position:"absolute",top:"50%"},color:"",size:"32px",userColorClass:this.userColorClass}),(0,C.vz)("div",{style:n,ref:function(e){return t.chatHeader=e}},this.usernameSpan,this.numUnreadContainer,(0,D.gH)()&&!this.isDropdown&&(0,C.vz)(U.T,{classRef:function(e){return t.inRoomIndicator=e},username:this.otherUsername,style:{verticalAlign:"middle",position:"relative",top:"-1px"}})),this.elapsedTimeContainer,(0,C.vz)("div",{colorClass:"messageDiv",style:i,ref:function(e){return t.messageDiv=e}},a&&""!==this.message?(0,O.WX)("replyIconSvg",{display:"inline-block",verticalAlign:"top"}):"",s))}},{key:"render",value:function(){return this.element}},{key:"hide",value:function(){var e;null===(e=this.parent)||void 0===e||e.removeChild(this),this.element.remove(),this.dispose()}},{key:"dispose",value:function(){var e;null===(e=this.inRoomIndicator)||void 0===e||e.dispose()}},{key:"repositionChildren",value:function(){(0,l.Z)((0,d.Z)(o.prototype),"repositionChildren",this).call(this),this.hideElapsedTimeResponsive()}},{key:"afterDOMConstructed",value:function(){(0,l.Z)((0,d.Z)(o.prototype),"afterDOMConstructed",this).call(this),this.hideElapsedTimeResponsive()}},{key:"updateTimeContainer",value:function(){var e=void 0===this.time||this.isEmptyMessage()?"":(0,A.ek)(new Date(this.time));this.elapsedTimeContainer.innerText=e,this.updateUsernameMaxWidth(),this.updateCloseButtonTop()}},{key:"updateUsernameMaxWidth",value:function(){var e,t;if(this.isDropdown){var n=228-(0,E.mY)(null!==(e=this.elapsedTimeContainer.textContent)&&void 0!==e?e:"",this.elapsedTimeContainer)-(0,E.mY)(null!==(t=this.numUnreadContainer.textContent)&&void 0!==t?t:"",this.numUnreadContainer);this.usernameSpan.style.maxWidth="".concat(n,"px")}}},{key:"getUsernameSpan",value:function(e){return(0,C.vz)("span",{colorClass:this.userColorClass,style:e},this.otherUsername)}},{key:"addCloseBtn",value:function(){var e=this;this.closeButton=(0,O.bo)();var t=this.closeButton;(0,E.Zs)(t,{position:"absolute",right:"8px"}),t.onclick=function(t){t.stopPropagation(),t.preventDefault(),Y(e.otherUsername,e.isDropdown)},(0,M.s2)()?(t.style.display="block",this.messageDiv.style.width="calc(".concat(_," - 20px)")):(t.style.display="none",(0,E.nH)(this.element).listen((function(n){n?(t.style.display="block",e.elapsedTimeContainer.style.display="none",e.messageDiv.style.width="calc(".concat(_," - 20px)")):(t.style.display="none",e.elapsedTimeContainer.style.display="block",e.messageDiv.style.width=_)}))),this.updateCloseButtonTop(),this.element.appendChild(t)}},{key:"updateCloseButtonTop",value:function(){void 0!==this.closeButton&&((0,M.s2)()&&""!==this.elapsedTimeContainer.textContent?this.closeButton.style.top="50%":this.closeButton.style.top="calc(50% - 8px)")}},{key:"hideElapsedTimeResponsive",value:function(){if(this.element.clientWidth>0){var e=this.chatHeader.clientWidth>this.element.clientWidth-o.CHAT_HEADER_LEFT_PX-8-this.elapsedTimeContainer.clientWidth;this.elapsedTimeContainer.style.visibility=e?"hidden":""}}},{key:"getOtherUsername",value:function(){return this.otherUsername}},{key:"getNumUnread",value:function(){return this.numUnread}},{key:"setNumUnread",value:function(e){this.numUnread=e,0===this.numUnread?(this.numUnreadContainer.innerText="",(0,S.FU)(this.element,"unreadBg")):(this.numUnreadContainer.innerText=" (".concat(this.numUnread,")"),(0,S.vP)(this.element,"unreadBg"))}},{key:"getUserColorClass",value:function(){return this.userColorClass}},{key:"getMessagePreview",value:function(){if(""===this.message&&this.hasMedia)return(0,C.vz)("span",null,w.ag.imageAttached);for(var e=new B.w(this.message),t=e.stringParts()[0],n=(0,C.vz)("span",{style:{maxWidth:"100%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",display:"inline-block"}},t.split("\n")[0]),i=1;i<e.stringParts().length;i+=1){var o=(0,C.vz)("span",{style:{cursor:"pointer"}},":".concat(e.emoticons()[i-1].name));if(n.appendChild(o),""!==e.stringParts()[i]){var r=(0,C.vz)("span",null,e.stringParts()[i]);n.appendChild(r)}}return(0,M.IF)()?n:twemoji.parse(n)}},{key:"isEmptyMessage",value:function(){return""===this.message&&!this.hasMedia}},{key:"getElapsedTimeString",value:function(){return void 0===this.time||this.isEmptyMessage()?"":(0,A.ek)(new Date(this.time))}}]),o}(v.w);N.CHAT_HEADER_LEFT_PX=48;var j=function(e){var t={width:e.size,height:e.size,borderRadius:"50%",background:e.color,textAlign:"center",display:"table-cell",fontFamily:"UbuntuLight, Tahoma, Arial, Helvetica, sans-serif",fontSize:"16px",lineHeight:"14px",margin:"auto",verticalAlign:"middle"};return(0,C.vz)("div",{colorClass:"avatarBubble",style:F(F({},{position:"relative"}),e.style)},(0,C.vz)("div",{colorClass:e.userColorClass,style:t},e.name.charAt(0).toLocaleUpperCase()))},H=n(7397),z=n(8525),W=n(8015);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function K(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return J(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var G=new Set;function Y(e,t){t||W.SO.fire(e),P.wV.hide(e),G.forEach((function(n){n.isDms===t&&n.hideConversation(e)})),t&&H.Lj.fire({username:e})}var $=function(e){(0,c.Z)(I,e);var t,n,o,h,v,w=(h=I,v=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,d.Z)(h);if(v){var n=(0,d.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,u.Z)(this,e)});function I(e){var t;return(0,r.Z)(this,I),(t=w.call(this,"div",e)).currentIndex=-1,t.currentConversationColorClass="currentConvo",G.add((0,a.Z)(t)),m.kN.listen((function(e){t.room=e.dossier.room,P.wV.clear(),t.addBroadcasterToTopOfDOM()})).addTo(t.listenerGroup),P.zS.conversationDataChanged.listen((function(e){void 0!==e&&(t.room=e.dossier.room),t.updateList()})).addTo(t.listenerGroup),P.zS.conversationRead.listen((function(e){var n=e.username;if(e.isDm===t.isDms){var i=t.renderedConversations.find((function(e){return e.getOtherUsername()===n}));void 0!==i&&i.setNumUnread(0)}})),P.zS.conversationItemAdded.listen((function(e){if(!(t.isDms&&""!==e.room||!t.isDms&&""===e.room)){P.wV.show(e.fromUsername);var n=!t.isDms&&1===t.renderedConversations.length;0===t.renderedConversations.length||n?t.updateList():(t.removeOldConversation(e.otherUser.username),t.addConversationIfPrefixMatch(e,!0))}})),x.sC.listen((function(e){P.wV.show(e.username)})),e.openConversationEvent.listen((function(){e.clearSearchOnSelect&&(t.currentIndex=-1,t.filterConversations("").catch(b.$x),t.searchBar.clear())})).addTo(t.listenerGroup),t.startTimeContainerUpdates(),t}return(0,s.Z)(I,[{key:"searchPrefix",get:function(){return this.searchBar.value.trim()}},{key:"startTimeContainerUpdates",value:function(){var e=this;window.setTimeout((function t(){var n,i=K(e.renderedConversations);try{for(i.s();!(n=i.n()).done;)n.value.updateTimeContainer()}catch(e){i.e(e)}finally{i.f()}window.setTimeout(t,1e4)}),1e4)}},{key:"conversationIsRendered",value:function(e){return this.renderedConversations.findIndex((function(t){return t.getRawData().otherUser.username===e}))>-1}},{key:"initData",value:function(e){this.isDms=!0===e.isDms,this.isFullVideoMode=e.isFullVideoMode,this.inBroadcast=!0===e.inBroadcast,this.listenerGroup=new g.mM,this.renderedConversations=[],(0,p.TF)()||(this.conversationListData=P.zS.getInstance()),this.openConversationEvent=e.openConversationEvent,this.room="",this.emptyListMessage=(0,C.vz)(Q,null)}},{key:"initUI",value:function(e){var t=q({fontSize:"12px",fontFamily:"UbuntuRegular, Tahoma, Arial, Helvetica, sans-serif",height:"100%",lineHeight:"16px",overflowX:"hidden",overflowY:"hidden",position:"relative",textAlign:"left",width:"100%",zIndex:2},this.isDms&&{flex:1,display:"flex",flexDirection:"column"}),n=q({maxHeight:"calc(100% - 32px)",overflowY:"auto",width:"100%"},this.isDms&&{flex:1});this.conversationBodyRoot=(0,C.vz)("div",{style:n,colorClass:"conversationBodyRoot"},(0,C.vz)("div",{className:"loadingDiv",style:{position:"absolute",top:"60px",left:"50%",transform:"translateX(-50%)"}},(0,C.vz)(R.L,null))),this.element=(0,C.vz)("div",{style:t,colorClass:"conversationList"},this.conversationBodyRoot),this.renderSearchBar()}},{key:"render",value:function(){return this.element}},{key:"repositionChildrenRecursive",value:function(){(0,l.Z)((0,d.Z)(I.prototype),"repositionChildrenRecursive",this).call(this);var e,t=K(this.renderedConversations);try{for(t.s();!(e=t.n()).done;)e.value.repositionChildrenRecursive()}catch(e){t.e(e)}finally{t.f()}}},{key:"afterDOMConstructedIncludingChildren",value:function(){(0,l.Z)((0,d.Z)(I.prototype),"afterDOMConstructedIncludingChildren",this).call(this);var e,t=K(this.renderedConversations);try{for(t.s();!(e=t.n()).done;)e.value.afterDOMConstructedIncludingChildren()}catch(e){t.e(e)}finally{t.f()}}},{key:"renderSearchBar",value:function(){var e=this;this.searchBar=new z.E({isFullVideoMode:this.isFullVideoMode,room:this.room}),this.searchBar.events.navigateSuggestions.listen((function(t){e.navigateSuggestions(t.event)})).addTo(this.listenerGroup),this.searchBar.events.openCurrentSuggestion.listen((function(){e.openCurrentSuggestion()})).addTo(this.listenerGroup),this.searchBar.events.inputChange.listen((function(t){t.isFullVideo===e.isFullVideoMode&&(e.currentIndex=-1,t.isValid?e.filterConversations(t.prefix):e.clearConversationListDOM())})).addTo(this.listenerGroup);var t=(0,C.vz)("div",null,this.searchBar.element);this.element.insertBefore(t,this.element.firstChild)}},{key:"updateList",value:(o=(0,i.Z)(f().mark((function e(){var t,n,i,o=this;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,p.TF)()){e.next=2;break}return e.abrupt("return");case 2:return this.clearConversationListDOM(),e.next=5,this.addBroadcasterToTopOfDOM();case 5:t=e.sent,void 0!==this.conversationListData&&(n=this.isDms?this.conversationListData.getDms():this.conversationListData.getPms(),i=n.filter((function(e){return o.conversationMatchesPrefix(e)})),this.populateConversationsToDOM(i,t));case 7:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"dispose",value:function(){this.listenerGroup.removeAll(),this.searchBar.dispose()}},{key:"clearConversationListDOM",value:function(){for(;null!==this.conversationBodyRoot.firstChild;)this.conversationBodyRoot.removeChild(this.conversationBodyRoot.firstChild);this.renderedConversations.forEach((function(e){return e.dispose()})),this.renderedConversations=[]}},{key:"getRoomUserCount",value:function(){return this.conversationBodyRoot.childNodes.length}},{key:"shouldAddBroadcaster",value:function(e){var t,n=(null===(t=T.J.current.loggedInUser)||void 0===t?void 0:t.username)===this.room;if(""===this.room||n)return!1;var i=void 0===e||this.room.startsWith(e);return!this.isDms&&i&&!this.inBroadcast&&((0,p.TF)()||!n)}},{key:"addBroadcasterToTopOfDOM",value:(n=(0,i.Z)(f().mark((function e(){var t,n,i,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.shouldAddBroadcaster())){e.next=18;break}if(!(0,p.TF)()){e.next=8;break}this.clearConversationListDOM(),n=(0,k.rw)(this.room),this.addConversationIfPrefixMatch(n),e.next=18;break;case 8:if(void 0===this.conversationListData){e.next=18;break}if(void 0!==(i=this.conversationListData.getConversation(this.room))){e.next=16;break}return e.next=13,(0,k.bG)(this.room,this.room);case 13:return o=e.sent,void 0===this.conversationListData.getConversation(this.room)&&(this.clearConversationListDOM(),this.addConversationIfPrefixMatch({message:"",numUnread:o.numUnread,fromUsername:o.user.username,otherUser:o.user,hasMedia:!1})),e.abrupt("return",t);case 16:this.clearConversationListDOM(),this.addConversationIfPrefixMatch(i);case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"shouldSkipPopulating",value:function(e,t){return P.wV.have(e.otherUser.username)?!P.wV.isShowing(e.otherUser.username):!(!t||this.room!==e.otherUser.username)}},{key:"maybeAddEmptyListMessage",value:function(){this.isDms&&""===this.searchPrefix&&0===this.renderedConversations.length&&this.conversationBodyRoot.appendChild(this.emptyListMessage)}},{key:"populateConversationsToDOM",value:function(e,t){var n=this;e.forEach((function(e){n.shouldSkipPopulating(e,t)||(n.addConversationListItemToDOM(e),n.isDms||k.lW.fire(e.otherUser.username))})),this.maybeAddEmptyListMessage()}},{key:"addConversationListItemToDOM",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.conversationIsRendered(e.otherUser.username)){var i=(0,C.vz)(N,{rawData:e,openConversationEvent:this.openConversationEvent,isDropdown:this.isDms,classRef:function(i){var o=e.otherUser.username===t.room;t.isDms||o||i.addCloseBtn(),n?t.isDms||o?t.renderedConversations.unshift(i):t.renderedConversations.splice(1,0,i):t.renderedConversations.push(i)}});if(n){var o,r=this.conversationBodyRoot.firstChild,s=(null===(o=T.J.current.loggedInUser)||void 0===o?void 0:o.username)===this.room,a=e.otherUser.username===this.room;this.isDms||a||s||null===r?this.conversationBodyRoot.insertBefore(i,r):this.conversationBodyRoot.insertBefore(i,r.nextSibling)}else this.conversationBodyRoot.appendChild(i);e.otherUser.username===this.currentConversation&&(0,S.vP)(i,this.currentConversationColorClass),this.repositionChildrenRecursive(),(0,y.fg)("PmListItemAdded",{rendered_pm_count:this.renderedConversations.length,other_user:e.otherUser.username})}}},{key:"hideConversation",value:function(e){var t=this.renderedConversations.find((function(t){return t.getOtherUsername()===e})),n=!this.isDms&&(null==t?void 0:t.getOtherUsername())===this.room;void 0===t||n||(this.renderedConversations.splice(this.renderedConversations.indexOf(t),1),t.hide(),(0,y.fg)("PmListItemRemoved",{rendered_pm_count:this.renderedConversations.length,other_user:e})),this.maybeAddEmptyListMessage()}},{key:"filterConversations",value:(t=(0,i.Z)(f().mark((function e(t){var n,i,o,r,s,a=this;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,void 0!==this.conversationListData&&(this.clearConversationListDOM(),i=this.isDms?this.conversationListData.getDms():this.conversationListData.getPms(),this.shouldAddBroadcaster(t)&&(r=this.conversationListData.getConversation(this.room),o=void 0!==r?r:(0,k.rw)(this.room),this.addConversationListItemToDOM(o),n=!0),s=i.filter((function(e){return a.conversationMatchesPrefix(e,t)})),this.populateConversationsToDOM(s,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"conversationMatchesPrefix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.searchPrefix;return 0===t.length||e.otherUser.username.startsWith(t)}},{key:"addConversationIfPrefixMatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;this.conversationMatchesPrefix(e,n)&&this.addConversationListItemToDOM(e,t)}},{key:"removeOldConversation",value:function(e){for(var t,n=this.renderedConversations.length-1;n>=0;n-=1){var i=this.renderedConversations[n];i.getOtherUsername()===e&&(t=i,this.renderedConversations.splice(n,1),i.element.remove())}return t}},{key:"navigateSuggestions",value:function(e){if(this.unHighlightSelectedIndex(this.currentIndex),"ArrowDown"===e.key||40===e.keyCode?this.currentIndex=this.currentIndex+1>=this.renderedConversations.length?-1:this.currentIndex+1:"ArrowUp"!==e.key&&38!==e.keyCode||(this.currentIndex=this.currentIndex-1<-1?this.renderedConversations.length-1:this.currentIndex-1),this.currentIndex>-1){var t=this.renderedConversations[this.currentIndex].getOtherUsername();this.highlightSelectedIndex(this.currentIndex,!0),this.searchBar.events.suggestionActiveEvent.fire({slug:t})}else this.searchBar.events.suggestionActiveEvent.fire({slug:""})}},{key:"openCurrentSuggestion",value:function(){if(this.currentIndex>-1){var e=this.renderedConversations[this.currentIndex],t=""===this.room?"PMWindow":"PMTab",n=e.getUserColorClass();(0,y.fg)("PMSearchResultClicked",{location:t,color:n}),this.searchBar.events.suggestionActiveEvent.fire({slug:""}),this.openConversationEvent.fire(e.getOtherUsername())}}},{key:"highlightSelectedIndex",value:function(e,t){if(e>-1){var n=this.renderedConversations[e];if(t){var i=this.conversationBodyRoot.clientHeight,o=n.element.clientHeight;this.conversationBodyRoot.scrollTop=this.currentIndex*o-i/2}(0,S.FU)(n.element,"unreadBg"),(0,S.vP)(n.element,"selected")}}},{key:"unHighlightSelectedIndex",value:function(e){if(e>-1){var t=this.renderedConversations[e];(0,S.FU)(t.element,"selected"),t.getNumUnread()>0?(0,S.vP)(t.element,"unreadBg"):(0,S.FU)(t.element,"unreadBg")}}},{key:"setCurrentConversation",value:function(e){var t=this;this.currentConversation=e,this.renderedConversations.forEach((function(n){n.getOtherUsername()===e?(0,S.vP)(n.element,t.currentConversationColorClass):(0,S.FU)(n.element,t.currentConversationColorClass)}))}},{key:"focusSearchBar",value:function(){this.searchBar.focus()}}]),I}(v.w),Q=function(){return(0,C.vz)("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",lineHeight:"20px",padding:"50px",boxSizing:"border-box"}},(0,C.vz)("img",{src:"".concat(STATIC_URL,"pms/empty-chat-state.svg"),style:{margin:"13px",width:"30px"},alt:"empty-chat-state"}),(0,C.vz)("span",{style:{fontFamily:"UbuntuBold, Arial, Helvetica, sans-serif",fontSize:"14px"},colorClass:"sendDmPrompt"},w.ag.sendDirectMessage),(0,C.vz)("span",{colorClass:"cautionMessage"},w.ag.conversationCautionMessage(I.w.siteName)))}},6832:function(e,t,n){"use strict";n.d(t,{zS:function(){return q},wV:function(){return V}});var i=n(126),o=n(7791),r=n(4649),s=n(2951),a=n(1976),l=n(824),c=n.n(l),u=n(3753),d=n(391),h=n(695),f=n(9617),p=n(4793),m=n(1794),v=n(9545),g=n(1289),y=n(9420),b=n(3243),w=n(7591),C=n(9492),x=n(7597),k=n(8759),S=n(7693),T=n(6767),I=n(8069);function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,x.Z)(e);if(t){var o=(0,x.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,C.Z)(this,n)}}var P=function(){function e(){var t=this;(0,s.Z)(this,e),this.queuedPmReads=new Set,this.sendDebouncer=new I.d((function(){t.sendPost()}),{bounceLimitMS:0,debounceType:1}),(0,S.j9)((0,k.Tt)()?"pagehide":"beforeunload",window,(function(){return t.sendBeacon()}))}return(0,a.Z)(e,[{key:"sendRead",value:function(e){this.queuedPmReads.add(e),this.sendDebouncer.callFunc()}},{key:"getFormData",value:function(){if(0!==this.queuedPmReads.size){this.pmReadsBatch=new Set(this.queuedPmReads),this.queuedPmReads.clear();var e=new FormData;return this.pmReadsBatch.forEach((function(t){e.append("from_usernames",t)})),e.append("csrfmiddlewaretoken",(0,T.ve)("csrftoken")),e}}},{key:"requeueData",value:function(){var e,t=this;null===(e=this.pmReadsBatch)||void 0===e||e.forEach((function(e){return t.queuedPmReads.add(e)}))}},{key:"sendPost",value:function(){var t=this,n=this.getFormData();void 0!==n&&(0,u.I5)(e.endpoint,n).catch((function(e){error("post error marking PMs as read",e),t.requeueData()}))}},{key:"sendBeacon",value:function(){var t=this.getFormData();void 0!==t&&(navigator.sendBeacon((0,u.BN)(e.endpoint),t)||(error("beacon error marking PMs as read"),this.requeueData()))}}]),e}();P.endpoint="api/ts/chatmessages/update_pms_last_seen/";var M,A,E=function(e){(0,w.Z)(n,e);var t=R(n);function n(){var e;return(0,s.Z)(this,n),e=t.call(this),p.kN.listen((function(t){e.room=t.chatConnection.room()})),p.QN.listen((function(){e.sendPost()})),e}return(0,a.Z)(n,[{key:"getFormData",value:function(){var e=(0,b.Z)((0,x.Z)(n.prototype),"getFormData",this).call(this);return void 0!==e&&void 0!==this.room?(e.append("room",this.room),e):void 0}}]),n}(P),B=function(e){(0,w.Z)(n,e);var t=R(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,a.Z)(n)}(P),L=n(6474),O=n(8213),D=n(8015),U=n(2800),Z=n(7600),F=n(7212),_=n(8016),N=n(7397),j=n(3871);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var V=new(function(){function e(){(0,s.Z)(this,e),this.showList=new Set,this.hideList=new Set}return(0,a.Z)(e,[{key:"show",value:function(e){this.showList.add(e),this.hideList.delete(e)}},{key:"hide",value:function(e){this.hideList.add(e),this.showList.delete(e)}},{key:"remove",value:function(e){this.showList.delete(e),this.hideList.delete(e)}},{key:"isShowing",value:function(e){return this.showList.has(e)}},{key:"isHiding",value:function(e){return this.hideList.has(e)}},{key:"have",value:function(e){return this.showList.has(e)||this.hideList.has(e)}},{key:"clear",value:function(){this.showList.clear(),this.hideList.clear()}}]),e}()),q=function(){function e(){var t=this;(0,s.Z)(this,e),this.pms=new Map,this.dms=new Map,this.room="",this.roomListeners=new m.mM,this.listenToMessagePushTopics(),D.gd.listen((function(e){t.markAsRead(e,!1)})),D.SO.listen((function(e){D.vz.fire(e)})),D.vz.listen((function(e){t.markAsRead(e,!1)})),D.Zn.listen((function(e){t.markAsRead(e.username,!0)})),D.Kd.listen((function(e){t.handleIncomingMessage(e,!0).catch(v.$x)})),D.Cb.listen((function(e){t.handleIncomingMessage(e,!1).catch(v.$x)})),p.kN.listen((function(n){var i;t.room=n.dossier.room,t.pms.clear(),t.removeEmptyDms();var o,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return W(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(t.dms.values());try{for(r.s();!(o=r.n()).done;){var s=o.value;s.otherUser.isBroadcaster=s.otherUser.username===t.room}}catch(e){r.e(e)}finally{r.f()}void 0!==e.instance&&e.conversationDataChanged.fire(n),(null===(i=U.J.current.loggedInUser)||void 0===i?void 0:i.username)!==t.room&&(0,L.bG)(t.room,t.room).then((function(e){t.addConversation({message:"",numUnread:0,time:Date.now(),fromUsername:t.room,otherUser:e.user,hasMedia:!1,room:t.room})})).catch(v.$x),t.listenToRoomPushTopics(n.dossier.roomUid)})),p.QN.listen((function(){t.roomListeners.removeAll()})),y.sC.listen((function(n){n.focus&&(t.pms.has(n.username)?e.conversationDataChanged.fire(void 0):(0,L.bG)(n.username,t.room).then((function(e){t.addConversation({message:"",numUnread:0,time:Date.now(),fromUsername:t.room,otherUser:e.user,hasMedia:!1,room:t.room})})).catch(v.$x))})),N.nh.listen((function(e){void 0===t.getConversation(e,!0)&&(0,L.bG)(e).then((function(n){t.addConversation({message:"",numUnread:0,time:Date.now(),fromUsername:e,otherUser:n.user,hasMedia:!1,room:""})})).catch(v.$x)})),y.CD.listen((function(n){var i,o=!1,r=t.pms.get(n.username);if(void 0!==r&&(r.otherUser.isMod=n.isMod,o=!0),(null===(i=U.J.current.loggedInUser)||void 0===i?void 0:i.username)===t.room){var s=t.dms.get(n.username);void 0!==s&&(s.otherUser.isMod=n.isMod,o=!0)}o&&e.conversationDataChanged.fire(void 0)})),this.fetchInitialDms()}var t;return(0,a.Z)(e,[{key:"fetchInitialDms",value:function(){var t=this;if((0,L.Fh)()&&!(0,h.TF)()){var n=(0,g.Ie)({offset:"0"});(0,u.Ue)("api/ts/chatmessages/pm_users/?".concat(n)).then((function(n){JSON.parse(n.responseText).reverse().forEach((function(e){var n=(0,L.I_)(new d.j(e));t.addConversation(z(z({},n),{},{room:""}))})),e.conversationDataChanged.fire(void 0)})).catch((function(e){error("Error fetching dm conversations",e)}))}}},{key:"getDms",value:function(){return Array.from(this.dms.values()).reverse()}},{key:"getPms",value:function(){return Array.from(this.pms.values()).reverse()}},{key:"handleIncomingMessage",value:(t=(0,o.Z)(c().mark((function e(t,n){var i,o,r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(i=this.removeConversation(t.otherUsername,n))){e.next=9;break}return e.next=4,(0,L.bG)(t.otherUsername,n?void 0:this.room);case 4:s=e.sent,o=s.user,r=n?s.numUnread:1,e.next=11;break;case 9:o=i.otherUser,r=i.numUnread+1;case 11:t.fromUser.username!==t.otherUsername&&(r=0),this.addConversation({message:t.message,time:Date.now(),numUnread:r,fromUsername:t.fromUser.username,otherUser:o,hasMedia:t.mediaList.length>0,room:n?"":this.room});case 13:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"addConversation",value:function(t){var n,i=""===t.room,o=i?this.dms:this.pms;o.delete(t.otherUser.username),o.set(t.otherUser.username,t),e.conversationItemAdded.fire(t),t.fromUsername===(null===(n=U.J.current.loggedInUser)||void 0===n?void 0:n.username)&&e.conversationRead.fire({username:t.otherUser.username,isDm:i}),this.updateUnreadCount()}},{key:"getConversation",value:function(e){return(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.dms:this.pms).get(e)}},{key:"removeConversation",value:function(e,t){var n=t?this.dms:this.pms,i=n.get(e);return n.delete(e),i}},{key:"removeEmptyDms",value:function(){var e,t=this,n=null===(e=N.qd.getInstance())||void 0===e?void 0:e.shownWindowUsername();this.dms.forEach((function(e,i){""!==e.message||e.hasMedia||i===n||t.dms.delete(i)}))}},{key:"markAsRead",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(n?this.dms:this.pms).get(t);void 0!==o&&0!==o.numUnread&&(o.numUnread=0,e.conversationRead.fire({username:t,isDm:n}),this.updateUnreadCount(),i||function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?(void 0===A&&(A=new B),A.sendRead(e)):(void 0===M&&(M=new E),M.sendRead(e))}(t,n))}},{key:"updateUnreadCount",value:function(){e.unreadConversationsCountUpdate.fire({dmsCount:(0,i.Z)(this.dms.values()).filter((function(e){return e.numUnread>0})).length,pmsCount:(0,i.Z)(this.pms.values()).filter((function(e){return e.numUnread>0})).length})}},{key:"listenToMessagePushTopics",value:function(){var e,t=this,n=null===(e=U.J.current.loggedInUser)||void 0===e?void 0:e.userUid;void 0!==n&&(new _.Tz(n).onMessage.listen((function(e){Z._.isEnabledForPM()&&(0,f.SZ)(e,t.room,e.room)})),new _.Zv(n).onMessage.listen((function(e){j.s.markOpened(e.messageId,e.mediaId)})),new _.Ol(n).onMessage.listen((function(e){e.isCompliance?O.lk.fire(e.mediaId):O.zA.fire(e.mediaId)})),new _.l7(n).onMessage.listen((function(e){void 0===e.room?t.markAsRead(e.otherUsername,!0,!0):e.room===t.room&&t.markAsRead(e.otherUsername,!1,!0)})))}},{key:"listenToRoomPushTopics",value:function(t){var n=this;new F.AE(t).onMessage.listen((function(t){var i,o=!1,r=n.pms.get(t.fromUser.username);if(void 0!==r&&(r.otherUser.inFanclub=!0,o=!0),(null===(i=U.J.current.loggedInUser)||void 0===i?void 0:i.username)===n.room){var s=n.dms.get(t.fromUser.username);void 0!==s&&(s.otherUser.inFanclub=!0,o=!0)}o&&e.conversationDataChanged.fire(void 0)})).addTo(this.roomListeners),new F.nf(t).onMessage.listen((function(e){var t,i=null===(t=U.J.current.loggedInUser)||void 0===t?void 0:t.username;i===n.room?N.Lj.fire({username:e.username}):i===e.username&&N.Lj.fire({username:n.room})})).addTo(this.roomListeners)}}],[{key:"getInstance",value:function(){return void 0===e.instance&&(e.instance=new e),e.instance}}]),e}();q.conversationDataChanged=new m.xB("conversationDataChanged"),q.conversationItemAdded=new m.xB("conversationItemAdded"),q.unreadConversationsCountUpdate=new m.xB("unreadConversationsCountUpdate"),q.conversationRead=new m.xB("conversationRead")},2952:function(e,t,n){"use strict";n.d(t,{a:function(){return T},y:function(){return S}});var i=n(3243),o=n(7591),r=n(9492),s=n(7597),a=n(2951),l=n(1976),c=n(8759),u=n(3753),d=n(9),h=n(1794),f=n(3543),p=n(47),m=n(2750),v=n(2800),g=n(7510),y=n(6832),b=n(932),w=n(7397),C=n(1994),x=n(8015);var k="changePopoutConvo",S=function(){function e(){(0,a.Z)(this,e)}return(0,l.Z)(e,null,[{key:"show",value:function(t){var n=this;if(e.showingEvent.fire(),void 0!==this.popout&&!this.popout.closed)if((0,c.Tt)())this.popout.close();else if(void 0!==this.popout[k])return this.popout.focus(),void window.setTimeout((function(){document.hasFocus()?e.openNewPopoutWindow(t):void 0!==n.popout&&n.popout[k](t)}),0);e.openNewPopoutWindow(t)}},{key:"openNewPopoutWindow",value:function(e){var t=this,n="/dm/";void 0!==e&&(n+="".concat(e,"/"));var i=(screen.width/2-425).toString(),o=(screen.height/2-384).toString(),r="resizable,dependent,scrollbars,height=".concat(768,",width=").concat(850,",top=").concat(o,",left=").concat(i);(0,m.MY)(n,"dmpopout",r).then((function(e){t.popout=e})).catch((function(){}))}}]),e}();S.showingEvent=new h.xB("DmPopoutShowingEvent");var T=function(e){(0,o.Z)(d,e);var t,n,c=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,s.Z)(t);if(n){var o=(0,s.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,r.Z)(this,e)});function d(e){var t,n;return(0,a.Z)(this,d),(n=c.call(this,"div",e)).bindListeners(),window[k]=function(e){void 0!==e&&n.showConversation(e)},void 0!==e.username&&e.username!==(null===(t=v.J.current.loggedInUser)||void 0===t?void 0:t.username)&&n.showConversation(e.username),n}return(0,l.Z)(d,[{key:"initData",value:function(e){(0,i.Z)((0,s.Z)(d.prototype),"initData",this).call(this,e),this.dmList=new g.p({isDms:!0,clearSearchOnSelect:!1,isFullVideoMode:!1,openConversationEvent:w.nh}),this.dmWindowsMap=new Map}},{key:"initUI",value:function(e){var t=this;(0,i.Z)((0,s.Z)(d.prototype),"initUI",this).call(this,e),this.element=(0,p.vz)("div",{style:{display:"flex",justifyContent:"space-between",height:"100%"},colorClass:"DmPopout",className:"fill-view-height"},(0,p.vz)("div",{style:{width:"300px",display:"inline-flex",flexDirection:"column",borderRightStyle:"solid",borderRightWidth:"1px",flexShrink:0},colorClass:"dmListContainer"},(0,p.vz)("div",{style:{paddingLeft:"8px",height:"34px",display:"flex",flexDirection:"column",justifyContent:"center",borderBottomWidth:"2px",borderBottomStyle:"solid",fontFamily:"UbuntuRegular, Tahoma, Arial, Helvetica, sans-serif",fontSize:"14px"},colorClass:"header"},(0,p.vz)("span",null,f.ag.directMessageLabel,(0,p.vz)("span",{style:{marginLeft:"4px"},ref:function(e){return t.numUnreadDOM=e}}))),this.dmList.element),(0,p.vz)("div",{style:{width:"calc(100vw - 301px)",display:"inline-block",flexGrow:1},ref:function(e){return t.dmWindowContainer=e}}))}},{key:"bindListeners",value:function(){var e=this;x.Kd.listen((function(t){var n;null===(n=e.dmWindowsMap.get(t.otherUsername))||void 0===n||n.handleNewMessage(t)})),w.nh.listen((function(t){e.showConversation(t)})),w.Lj.listen((function(t){var n,i=t.username,o=t.deleteWindow;(null===(n=e.currentDmWindow)||void 0===n?void 0:n.username)===i&&e.hideCurrentDmWindow(),!0===o&&e.dmWindowsMap.delete(i)})),y.zS.conversationRead.listen((function(t){var n=t.username;if(t.isDm){var i=e.dmWindowsMap.get(n);null==i||i.markRead()}})),y.zS.unreadConversationsCountUpdate.listen((function(t){var n=t.dmsCount;e.updateNumUnread(n)})),(0,C.I)((function(t){return e.dmWindowsMap.get(t)}))}},{key:"showConversation",value:function(e){var t,n,i=this.dmWindowsMap.get(e);if(void 0===i)i=new b.MA(e),this.dmWindowsMap.set(e,i);else if(i===this.currentDmWindow)return void i.scrollAndFocus();this.hideCurrentDmWindow(),this.dmWindowContainer.appendChild(i.element),i.setIsShowing(!0),i.openOrCollapseWindow(!0,!0),this.dmList.setCurrentConversation(e),this.currentDmWindow=i,document.title=f.ag.directMessagesPageTitle(null!==(t=null===(n=v.J.current.loggedInUser)||void 0===n?void 0:n.username)&&void 0!==t?t:"",e),window.history.pushState("","",(0,u.BN)("/dm/".concat(e)))}},{key:"hideCurrentDmWindow",value:function(){var e;null===(e=this.currentDmWindow)||void 0===e||e.removeFromDOM(),this.currentDmWindow=void 0}},{key:"updateNumUnread",value:function(e){this.numUnreadDOM.textContent=e>0?"(".concat(e,")"):""}}]),d}(d.w)},2906:function(e,t,n){"use strict";n.d(t,{e:function(){return i},o:function(){return o}});var i=new(n(1794).xB)("requestDmInputFocus",{listenersWarningThreshold:1,reportIfNoListeners:!1});function o(e){i.listenerCount()>0?i.fire(e):e instanceof HTMLElement&&e.focus()}},932:function(e,t,n){"use strict";n.d(t,{PZ:function(){return Be},Tx:function(){return Le},Dv:function(){return Oe},MA:function(){return De},kb:function(){return Ae}});var i=n(3243),o=n(126),r=n(2951),s=n(1976),a=n(7591),l=n(9492),c=n(7597),u=n(4649),d=n(8759),h=n(7693),f=n(1522),p=n(3753),m=n(391),v=n(4793),g=n(9),y=n(8263),b=n(1794),w=n(9598),C=n(3705),x=n(9545),k=n(3543),S=n(47),T=n(2974),I=n(6272),R=n(2800),P=n(795),M=n(2906);var A=function(e){(0,a.Z)(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function o(e,t){var n;return(0,r.Z)(this,o),(n=i.call(this)).username=e,n.removeUI=t,n.handleTipKeyPress=function(e){e.metaKey||8===e.charCode||0===e.charCode||(n.tipInputDOM.value.length>P.oV?e.preventDefault():e.charCode>=48&&e.charCode<=57||(13===e.keyCode&&n.sendTipFn(),e.preventDefault()))},n.handlePaste=function(){window.setTimeout((function(){/^[1-9]\d*$/.test(n.tipInputDOM.value)||(n.tipInputDOM.value=""),n.tipInputDOM.value=n.tipInputDOM.value.substring(0,P.oV)}),0)},n.handleTipKeyUp=function(e){n.isHighTipAmountWarningActive&&13!==e.keyCode&&n.resetTipButtonText(),n.checkValidTip()},n.sendTipFn=function(){if("none"===n.wrongTipNoticeDOM.style.display){var e=parseInt(n.tipInputDOM.value);if(!isNaN(e)){if((0,C.fg)("SendTipClicked",{amount:e,location:"DmWindow"}),e>100&&!n.isHighTipAmountWarningActive)return n.setTipButtonText(k.ag.tipConfirmationMessage(e)),n.isHighTipAmountWarningActive=!0,void n.sendTipButtonDOM.focus();(0,I.d1)({roomName:n.username,tipAmount:n.tipInputDOM.value,message:n.tipMessageDOM.value,source:"DM",tipRoomType:"sitewidePMs",tipType:"public",videoMode:T.S.getVideoMode()}).then((function(t){t.success?((0,C.fg)("SendTipSuccess",{amount:e,location:"DmWindow"}),n.hideTipping()):void 0!==t.error?!0===t.showPurchaseLink?(0,P.dg)(t.error):(0,f.Cj)(t.error):(error("unknown send tip error"),(0,f.Cj)(k.ag.errorSendingTip)),n.tipMessageDOM.value="",void 0!==t.tipsInPast24Hours&&I.H2.fire({tokens:t.tipsInPast24Hours,roomName:n.username})})).catch((function(e){error("Error sending tip (".concat(e,")")),(0,f.Cj)(k.ag.errorSendingTip)})).finally((function(){n.resetTipButtonText()}))}}},n.hideTipping=function(){n.removeUI()},n.listenerGroup=new b.mM,n.isHighTipAmountWarningActive=!1,n.updateCurrentTipBalance(),I.A3.listen((function(e){n.updateTokenBalance(e.tokens)}),!1).addTo(n.listenerGroup),n}return(0,s.Z)(o,[{key:"createOverlay",value:function(){var e={display:"block",width:"100%",height:"calc(100% - ".concat(Le.headerHeight,")"),position:"absolute",bottom:0,left:0,cursor:"pointer"};return this.overlay=(0,S.vz)("div",{style:e,colorClass:"dmWindowTipOverlay",onClick:this.hideTipping}),this.overlay}},{key:"createUI",value:function(){var e=this;return this.element=(0,S.vz)("div",{colorClass:"dmWindowTipCallout",style:{position:"absolute",bottom:"0px",right:"0px",height:"183px",minWidth:"280px",maxWidth:"100%",fontSize:"12px",zIndex:999}},(0,S.vz)("div",{style:{height:"31px",lineHeight:"31px",borderRadius:"4px 4px 0px 0px",padding:"0 6px"},colorClass:"titleBar"},(0,S.vz)("span",{style:{fontSize:"14px",fontWeight:"bold"}},k.ag.sendTipText),(0,S.vz)(Be,{style:{right:"5px",top:"-4px",cursor:"pointer"},clickHandler:this.hideTipping})),(0,S.vz)("div",{style:{padding:"6px",boxSizing:"border-box"}},(0,S.vz)("div",null,(0,S.vz)("span",null,k.ag.currentBalanceText),(0,S.vz)("span",{style:{margin:"0 5px",display:"inline-block",width:"90px"},colorClass:"tokenBalance",ref:function(t){return e.currentBalanceDOM=t}}),(0,S.vz)("a",{onClick:function(){(0,P.Hi)({source:R.J.current.PurchaseEventSources.TOKEN_SOURCE_PRIVATE_MESSAGE_WINDOW})},colorClass:"purchaseLink",style:{textDecoration:"underline",cursor:"pointer"},ref:function(t){return e.getMoreLinkDOM=t}},k.ag.getMoreLabel)),(0,S.vz)("div",null,(0,S.vz)("span",null,k.ag.tipAmountText),(0,S.vz)("input",{type:"text",style:{width:"69px",height:"24px",borderWidth:"1px",borderStyle:"solid",boxSizing:"border-box",borderRadius:"4px",marginLeft:"5px"},colorClass:"tipInput",value:25,onKeyPress:this.handleTipKeyPress,onPaste:this.handlePaste,onKeyUp:this.handleTipKeyUp,onPointerDown:M.o,ref:function(t){e.tipInputDOM=t}}),(0,S.vz)("span",{style:{marginLeft:"8px",display:"none"},colorClass:"tokenInputError",ref:function(t){e.wrongTipNoticeDOM=t}},k.ag.invalidAmount)),(0,S.vz)("div",null,k.ag.TipOptionalMessageLabel),(0,S.vz)("textarea",{style:{width:"100%",height:"32px",borderRadius:"4px",resize:"none",borderWidth:"1px",borderStyle:"solid",margin:"5px 0 0 0",boxSizing:"border-box"},colorClass:"tipMessage",onPointerDown:M.o,ref:function(t){return e.tipMessageDOM=t}}),(0,S.vz)("div",{style:{width:"100%",display:"flex",justifyContent:"flex-end",marginTop:"5px"}},(0,S.vz)("button",{style:{boxSizing:"border-box",maxWidth:"100%",height:"32px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},colorClass:"sendTipButton","data-testid":"send-tip-button",onClick:this.sendTipFn,ref:function(t){return e.sendTipButtonDOM=t}},k.ag.sendTipToUser(this.username))))),this.element}},{key:"dispose",value:function(){this.listenerGroup.removeAll()}},{key:"focus",value:function(){(0,M.o)(this.tipInputDOM),this.tipInputDOM.setSelectionRange(0,9999)}},{key:"setFields",value:function(e,t){void 0!==e&&(this.tipInputDOM.value=String(e)),void 0!==t&&(this.tipMessageDOM.value=t),this.checkValidTip(),this.updateCurrentTipBalance()}},{key:"updateCurrentTipBalance",value:function(){var e=this;(0,I.yX)(this.username).then((function(t){e.currentBalanceDOM.innerText="".concat(t.tokenBalance," ").concat(k.ag.tokenOrTokensText(t.tokenBalance,!1))})).catch(x.$x)}},{key:"updateTokenBalance",value:function(e){this.currentBalanceDOM.innerText="".concat(e," ").concat(k.ag.tokenOrTokensText(e,!1))}},{key:"checkValidTip",value:function(){/^[1-9]\d*$/.test(this.tipInputDOM.value)?(this.hideInvalidTipNotice(),this.sendTipButtonDOM.style.cursor="pointer",this.sendTipButtonDOM.disabled=!1):(this.showInvalidTipNotice(),this.sendTipButtonDOM.style.cursor="",this.sendTipButtonDOM.disabled=!0)}},{key:"showInvalidTipNotice",value:function(){this.wrongTipNoticeDOM.style.display=""}},{key:"hideInvalidTipNotice",value:function(){this.wrongTipNoticeDOM.style.display="none"}},{key:"setTipButtonText",value:function(e){this.sendTipButtonDOM.textContent=e,this.sendTipButtonDOM.title=e}},{key:"resetTipButtonText",value:function(){this.setTipButtonText(k.ag.sendTipToUser(this.username)),this.isHighTipAmountWarningActive=!1}}]),o}(g.w),E=n(5937);var B=function(e){(0,a.Z)(u,e);var t,n,o=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(e,t){return(0,r.Z)(this,u),o.call(this,e,t)}return(0,s.Z)(u,[{key:"createOverlay",value:function(){return this.overlay=(0,S.vz)("div",{style:{display:"block",width:"100%",position:"absolute",top:0,right:0,bottom:0,left:0},colorClass:"dmWindowTipOverlay",onClick:this.hideTipping}),this.overlay}},{key:"createUI",value:function(){var e=(0,i.Z)((0,c.Z)(u.prototype),"createUI",this).call(this);return this.tipInputDOM.type=(0,E.JR)()?"number":"tel",(0,y.Zs)(e,{bottom:"",height:"",top:"50%",left:"50%",transform:"translate(-50%, -50%"}),(0,y.Zs)(this.tipInputDOM,{fontSize:"16px",fontFamily:"UbuntuRegular, Helvetica, Arial, sans-serif"}),(0,y.Zs)(this.tipMessageDOM,{fontSize:"16px",fontFamily:"UbuntuRegular, Helvetica, Arial, sans-serif"}),(0,y.Zs)(this.wrongTipNoticeDOM,{marginLeft:""}),(0,y.Zs)(this.getMoreLinkDOM,{display:"block",textAlign:"right"}),e}},{key:"showInvalidTipNotice",value:function(){this.wrongTipNoticeDOM.style.display="block"}}]),u}(A),L=n(1392),O=n(9420),D=n(6474),U=n(1185),Z=n(7397);var F=function(e){(0,a.Z)(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function o(e){var t;return(0,r.Z)(this,o),(t=i.call(this,"div",e)).props=e,t.isInputExpanded=!1,t.disableSend=!0,t.disableTip=!0,t}return(0,s.Z)(o,[{key:"initData",value:function(e){var t=this;this.listenerGroup=new b.mM,O.He.listen((function(e){t.emojiButton})).addTo(this.listenerGroup)}},{key:"initUI",value:function(e){var t=this,n={position:"absolute",bottom:"0",width:"calc(100% - 4px)",height:this.trueHeight(!1),margin:"0px 2px 3px",boxSizing:"border-box",borderWidth:"1px",borderStyle:"solid",borderRadius:"2px"};this.element=(0,S.vz)("div",{style:n,colorClass:"dmWindowInput"},(0,S.vz)("textarea",{style:{position:"absolute",width:"100%",resize:"none",boxSizing:"border-box",backgroundColor:"transparent",border:"none",outline:"none",fontFamily:"Tahoma, Helvetica, Arial, sans-serif",fontSize:"12px",padding:"8px 0 0 8px"},className:"noScrollbar",placeholder:k.ag.sendAMessageDesktop,maxLength:Ae,ref:function(e){return t.inputBar=e},onKeyDown:function(e){return t.keyDownHandler(e)},onInput:function(){return t.expandOrCollapseInputBar()},onFocus:e.onFocus,onPointerDown:function(e){return t.focus(e)},"data-testid":"dmInput"}),(0,S.vz)("div",{style:{position:"absolute",bottom:"4px",right:"0px",padding:"2px 6px 0px",margin:"4px 0px"},ref:function(e){return t.buttonsContainer=e}},(0,S.vz)("span",{style:{height:"23px",width:"47px",borderRadius:"4px",fontSize:"12px",lineHeight:"14px",cursor:"pointer",padding:"4px"},colorClass:["sendButton","disabled"],onClick:function(){return t.submit()},ref:function(e){return t.sendDmButton=e},"data-testid":"dmSendButton"},k.ag.sendCAPS),(0,S.vz)("span",{style:{height:"23px",width:"47px",borderRadius:"4px",fontSize:"12px",lineHeight:"14px",padding:"4px",cursor:"pointer",marginLeft:"4px",display:"none"},colorClass:["tipButton"],onClick:function(){return t.props.showTipping()},ref:function(e){return t.sendTipButton=e}},k.ag.tipCAPS)))}},{key:"enableSend",value:function(){this.disableSend=!1,(0,U.FU)(this.sendDmButton,"disabled")}},{key:"enableTip",value:function(){this.disableTip=!1,this.sendTipButton.style.display=""}},{key:"focus",value:function(e){(0,M.o)(null!=e?e:this.inputBar)}},{key:"blur",value:function(){this.inputBar.blur()}},{key:"isFocused",value:function(){return document.activeElement===this.inputBar}},{key:"dispose",value:function(){this.listenerGroup.removeAll()}},{key:"submit",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.disableSend){var n=this.inputBar.value.trim();if(this.inputBar.value="",this.expandOrCollapseInputBar(),t&&this.focus(),""!==n){var i=(0,L.DO)(n,"DM");if(1===i.messageType){var o=i;this.handleTipRequestMessage(o)}else(0,D.pc)({message:n,username:this.props.toUsername,source:"DM"}).catch((function(t){e.props.sendDmFailedCallback(t)}))}}}},{key:"handleTipRequestMessage",value:function(e){this.disableTip||this.props.showTipping(e.messageData.amount,e.messageData.message)}},{key:"keyDownHandler",value:function(e){switch(e.keyCode){case 76:(e.ctrlKey||e.metaKey)&&(e.preventDefault(),e.stopPropagation(),Z.Lj.fire({username:this.props.toUsername}));break;case 13:e.shiftKey||(e.preventDefault(),this.submit())}}},{key:"expandOrCollapseInputBar",value:function(){var e=this,t=this.buttonsContainer.getBoundingClientRect().x-this.element.getBoundingClientRect().x;(0,y.mY)(this.inputBar.value,this.inputBar)>=t-20||this.inputBar.value.includes("\n")?e.isInputExpanded||(e.props.onInputExpand(),e.element.style.height=e.trueHeight(!0),e.isInputExpanded=!0):e.isInputExpanded&&(e.props.onInputCollapse(),e.element.style.height=e.trueHeight(!1),e.isInputExpanded=!1)}},{key:"render",value:function(){return this.element}},{key:"trueHeight",value:function(e){var t=e?o.expandedHeight:o.height;return"calc(".concat(t," - 3px)")}}]),o}(g.w);F.height="38px",F.expandedHeight="76px";var _=function(e){(0,a.Z)(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function o(e){return(0,r.Z)(this,o),i.call(this,e)}return(0,s.Z)(o,[{key:"initUI",value:function(e){var t=this;this.element=(0,S.vz)("div",{style:{bottom:"1px",width:"100%",height:"33px",borderWidth:"1px",borderStyle:"solid",borderRadius:"2px",boxSizing:"border-box",display:"flex"},colorClass:"dmWindowInput"},(0,S.vz)("textarea",{style:{width:"274px",resize:"none",boxSizing:"border-box",backgroundColor:"transparent",border:"none",outline:"none",fontFamily:"Tahoma, Helvetica, Arial, sans-serif",fontSize:"16px",padding:"6px 0 0 6px"},className:"noScrollbar",placeholder:k.ag.sendAMessageDesktop,maxLength:Ae,ref:function(e){return t.inputBar=e},onKeyDown:function(e){return t.keyDownHandler(e)},onInput:function(){return t.expandOrCollapseInputBar()}}),(0,S.vz)("div",{style:{padding:"0 3px 3px 3px",display:"flex",alignItems:"flex-end"},ref:function(e){return t.buttonsContainer=e}},(0,S.vz)("span",{style:{borderRadius:"4px",fontSize:"12px",lineHeight:"14px",cursor:"pointer",padding:"4px"},colorClass:["sendButton","disabled"],onClick:function(){return t.submit(!1)},ref:function(e){return t.sendDmButton=e}},k.ag.sendCAPS),(0,S.vz)("span",{style:{borderRadius:"4px",fontSize:"12px",lineHeight:"14px",padding:"4px",cursor:"pointer",marginLeft:"4px",display:"none"},colorClass:["tipButton"],onClick:function(){return t.props.showTipping()},ref:function(e){return t.sendTipButton=e}},k.ag.tipCAPS)))}},{key:"handleTipRequestMessage",value:function(e){this.disableTip||this.props.showTipping(e.messageData.amount,e.messageData.message,(0,d.Tt)())}}]),o}(F),N=n(4043),j=n(5004),H=n(3607),z=n(9482),W=n(5925),V=n(8016),q=n(1612),K=n(6208),J=n(8945),G=function(){function e(){(0,r.Z)(this,e),this.historyDms=new Set,this.newDms=new Set}return(0,s.Z)(e,[{key:"filterDuplicates",value:function(e,t){var n=t?this.historyDms:this.newDms,i=t?this.newDms:this.historyDms;if(void 0===n||void 0===i)return e;if(0===i.size)return e.forEach((function(e){return n.add(e.messageID)})),e;var o=e.filter((function(e){return!i.has(e.messageID)}));return o.length>0&&(this.historyDms=void 0,this.newDms=void 0),o}},{key:"isMessageDuplicate",value:function(e,t){return 0===this.filterDuplicates([e],t).length}}]),e}(),Y=n(9493),$=n(7201),Q=n(10);function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e,t,n,i,o){var r={padding:"5px 8px",display:"inline-block",textAlign:"left",maxWidth:"77%",borderRadius:"10px",overflowWrap:"break-word"},s=ee(ee({},r),{},{marginRight:"8px"}),a=ee(ee({},r),{},{borderWidth:"1px",borderStyle:"solid",position:"relative"}),l={textAlign:t?"right":"left",paddingTop:"2px"},c=t?s:a;return(0,S.vz)("div",{colorClass:n,style:l},(0,S.vz)("div",{colorClass:i,style:c,title:null!=o?o:""},e))}var ne=function(e){(0,a.Z)(u,e);var t,n,o=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(e){var t;return(0,r.Z)(this,u),(t=o.call(this,"div",e)).timestampThresholdSeconds=3600,t.updateForPrevTimestamp(e.prevTimestamp),t}return(0,s.Z)(u,[{key:"initData",value:function(e){(0,i.Z)((0,c.Z)(u.prototype),"initData",this).call(this,e),this.dm=e.dm,this.timestamp=e.dm.createdAt}},{key:"initUI",value:function(e){(0,i.Z)((0,c.Z)(u.prototype),"initUI",this).call(this,e);var t=e.isMine?"me":"other",n=void 0!==this.dm.createdAt?this.tooltipTimestampString(this.dm.createdAt):"",o=(0,Q.hk)(this.dm),r=(0,$.F$)(this.dm.message);r.style.display="block",this.element=(0,S.vz)("div",{style:{marginTop:"1px"}},this.createTimestamp(),""!==this.dm.message&&te(r,e.isMine,"dmWindowMessage",t,n),o&&te(o,e.isMine,"dmWindowMessage",t))}},{key:"showTimestamp",value:function(){this.timestampDiv.style.display="block"}},{key:"updateForPrevTimestamp",value:function(e){this.timestampDiv.style.display=this.shouldShowTimestamp(e)?"block":"none"}},{key:"createTimestamp",value:function(){var e="";return void 0!==this.dm.createdAt&&(e=this.timestampString(this.dm.createdAt)),this.timestampDiv=(0,S.vz)("div",{style:{textAlign:"center",display:"none",padding:"8px 0 2px"},colorClass:"timestamp"},e),this.timestampDiv}},{key:"timestampString",value:function(e){return e.toLocaleDateString()===(new Date).toLocaleDateString()?k.ag.todayAtTime(e.toLocaleTimeString([],{hour:"numeric",minute:"numeric"})):e.toLocaleDateString()===new Date(Date.now()-864e5).toLocaleDateString()?k.ag.yesterdayAtTime(e.toLocaleTimeString([],{hour:"numeric",minute:"numeric"})):e.getFullYear()===(new Date).getFullYear()?e.toLocaleString([],{month:"short",day:"numeric",weekday:"short",hour:"numeric",minute:"numeric"}):e.toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})}},{key:"tooltipTimestampString",value:function(e){return e.toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})}},{key:"shouldShowTimestamp",value:function(e){return void 0!==this.timestamp&&void 0!==e&&(0,Y.b1)(this.timestamp,e)>this.timestampThresholdSeconds}}]),u}(g.w),ie=n(2952),oe=n(695),re=n(2008),se=n(27),ae=n(2896),le=n(7108),ce=n(1194);function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var he=function(e){(0,a.Z)(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function o(e){var t;return(0,r.Z)(this,o),(t=i.call(this)).props=e,t.tearDown=function(){var e;t.props.tearDownFunc(),null===(e=t.reactUserNote)||void 0===e||e.dispose()},t.popoutConversation=function(){t.props.popoutFunc(),t.tearDown()},t.ignoreUser=function(){t.props.ignoreFunc(),t.tearDown()},t.unignoreUser=function(){t.props.unignoreFunc(),t.tearDown()},t.reportUser=function(){void 0!==t.lastReceivedMessage?((0,C.fg)("reportPMUser",{location:"PMWindow"}),t.chatReport=new re.T(t.props.userInfo.username,t.lastReceivedMessage,t.ignoreUser),t.element.removeChild(t.menuContents),t.element.appendChild(t.chatReport.element),t.chatReport.focusForm(),t.chatReport.closeChatReportRequest.listen((function(){t.tearDown()}))):error("PMUserContextMenu - reporting with no received message")},t.element=t.createMenuContents(),t.overlayClick.listen((function(){t.element.style.display="none",t.tearDown()})),t}return(0,s.Z)(o,[{key:"createMenuContents",value:function(){var e,t,n=this,i={display:"inline-block",cssFloat:"right",verticalAlign:"top",width:"36px",marginRight:"8px"};(0,se.a)(this.props.userInfo.username).then((function(e){n.menuRightSpan.replaceWith((0,S.vz)("span",{style:i},(0,S.vz)(me,{menuData:e}),(0,S.vz)(ve,{gender:e.gender}))),e.online&&(n.element.insertBefore((0,S.vz)(fe,{imgURL:e.imageUrl}),n.menuContents),n.props.dontRepositionForThumbnail||(n.element.style.top="-75px"))})).catch((function(e){error("Could not process user menu request",{username:n.props.userInfo.username,reason:e.toString()})})),this.ucmDescription=(0,S.vz)(ge,{user:this.props.userInfo});var o=this.createUcmLinks(),r=document.createElement("div"),s=ce.d.get("UserNote");this.reactUserNote=new s({username:this.props.userInfo.username,handleInputFocus:M.o,badgeManager:ae.$.getOrCreateInstance(),isNotLoggedIn:oe.Cg,removeMenu:this.tearDown},r);var a=null!==(e=null===(t=this.props.usernameLabel)||void 0===t?void 0:t.element)&&void 0!==e?e:(0,S.vz)(pe,{userInfo:this.props.userInfo});return(0,S.vz)("div",{style:{borderWidth:"1px",borderStyle:"solid",borderRadius:"4px",fontFamily:"Tahoma, Arial, Helvetica, sans-serif",cursor:"initial",display:"none",position:"absolute",left:"0px",top:"0",minWidth:"188px",maxWidth:"220px",zIndex:1001},colorClass:"pmUcmContainer",onClick:function(e){return e.stopPropagation()}},(0,S.vz)("div",{ref:function(e){return n.menuContents=e}},(0,S.vz)("div",{style:{padding:"9px 0 4px 9px",position:"relative",overflow:"hidden",boxSizing:"border-box"},colorClass:"pmUcmHeader"},a,(0,S.vz)("span",{style:i,ref:function(e){return n.menuRightSpan=e}},(0,S.vz)("span",{colorClass:"placeholder",style:{width:"14px",height:"14px",cssFloat:"left"}}),(0,S.vz)("span",{colorClass:"placeholder",style:{width:"14px",height:"14px",cssFloat:"right"}}))),this.ucmDescription,o,r))}},{key:"createUcmLinks",value:function(){var e=this;return(0,S.vz)("ul",{style:{borderTopWidth:"1px",borderTopStyle:"solid",listStyle:"none",padding:"5px 0",margin:0},colorClass:"pmUcmLinks"},this.props.includePopoutLink&&(0,S.vz)(ye,{iconColorClass:"pmUcmPopoutIcon",innerText:k.ag.popoutInNewWindow,clickHandler:this.popoutConversation,newIconStyle:{width:"12px",height:"12px",marginBottom:"1px"}}),(0,S.vz)(ye,{iconColorClass:"pmUcmIgnoreIcon",innerText:(0,W.WU)(this.props.userInfo.username)?k.ag.unignoreThisUserText:k.ag.ignoreThisUserText,clickHandler:(0,W.WU)(this.props.userInfo.username)?this.unignoreUser:this.ignoreUser}),(0,S.vz)(ye,{ref:function(t){return e.reportLinkItem=t},iconColorClass:"pmUcmReportIcon",innerText:k.ag.reportThisUserText,clickHandler:this.reportUser,newLinkItemStyle:void 0!==this.lastReceivedMessage?{}:{display:"none"}}))}},{key:"setLastReceivedMessage",value:function(e){void 0!==e&&(this.lastReceivedMessage=e,this.reportLinkItem.style.display="flex")}},{key:"render",value:function(){return this.element}}]),o}(le.B),fe=function(e){return(0,S.vz)("div",{style:{width:"100%",height:"75px",overflow:"hidden",borderRadius:"4px 4px 0px 0px"}},(0,S.vz)("img",{style:{position:"relative",width:"188px",top:"-50%",left:"50%",transform:"translateX(-50%)"},src:e.imgURL}))},pe=function(e){var t=(0,S.vz)("a",{href:"/".concat(e.userInfo.username,"/"),target:"_blank",rel:"noopener noreferrer",style:{fontWeight:"bold",textDecoration:"none",overflow:"hidden",textOverflow:"ellipsis",width:"120px",display:"inline-block",cursor:"pointer"},onClick:function(t){(0,C.fg)("ViewProfile",{username:e.userInfo.username}),t.stopPropagation()}},e.userInfo.username);return t.onmouseenter=function(){t.style.textDecoration="underline"},t.onmouseleave=function(){t.style.textDecoration="none"},t},me=function(e){var t,n=de({display:"inline-block",width:"15px",minHeight:"14px",fontSize:"12px",fontWeight:"bold",marginRight:"6px",verticalAlign:"top"},e.newAgeStyle),i="";return!0===(null===(t=e.menuData)||void 0===t?void 0:t.canAccess)&&!isNaN(e.menuData.displayAge)&&e.menuData.displayAge>=18&&(i=e.menuData.displayAge),n.background="",(0,S.vz)("span",{style:n,colorClass:"ageIcon"},i)},ve=function(e){var t=de({display:"inline-block",width:"15px",height:"14px",verticalAlign:"top"},e.newGenderSpanStyle),n=de({display:"inline-block",width:"14px",height:"14px"},e.newGenderIconStyle),i=(0,S.vz)("img",null);return void 0!==e.gender&&""!==e.gender&&(i=(0,S.vz)("img",{style:n,src:(0,z.Fg)(e.gender),title:k.ag.genderSymbolToIconTitle(e.gender)})),(0,S.vz)("span",{style:t},i)},ge=function(e){var t=(0,z.Lj)(e.user),n=(0,z.c9)(e.user),i=(0,z.Ow)(e.user);if(void 0!==t){var o="";return void 0!==i&&(o=(0,S.vz)("div",{style:{height:"10px",fontSize:"10px",marginTop:"4px",WebkitTextSizeAdjust:"none"}},i)),(0,S.vz)("div",{style:{padding:"9px 10px",borderTopWidth:"1px",borderTopStyle:"solid",fontSize:"12px"},colorClass:"pmUcmDescription"},(0,S.vz)("div",{style:{height:"12px",width:"100%",fontWeight:"bold"},colorClass:n},t),o)}},ye=function(e){var t=de({display:"flex",padding:"3px 8px 3px 12px",whiteSpace:"nowrap",fontWeight:"normal",fontFamily:"Tahoma, Arial, Helvetica, sans-serif",fontSize:"12px",WebkitTextSizeAdjust:"none",cursor:"pointer",boxSizing:"border-box"},e.newLinkItemStyle),n=de({flexShrink:0,padding:"0px 4px 0px 0px",width:"14px",height:"14px",display:"inline-block",marginRight:"4px",marginTop:"2px"},e.newIconStyle);return(0,S.vz)("li",{style:t,onClick:e.clickHandler,colorClass:"pmUcmLinkItem",title:e.innerText},(0,S.vz)("span",{style:n,colorClass:e.iconColorClass}),(0,S.vz)("span",{style:{fontWeight:"normal",fontFamily:"Tahoma, Arial, Helvetica, sans-serif",fontSize:"12px",overflow:"hidden",textOverflow:"ellipsis",WebkitTextSizeAdjust:"none"}},e.innerText))},be=n(407);var we=function(e){(0,a.Z)(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function o(e){return(0,r.Z)(this,o),i.call(this,"div",e)}return(0,s.Z)(o,[{key:"initUI",value:function(e){var t=void 0!==e.divotPosition?e.divotPosition:1;this.element=(0,be.T)({content:e.message,hasHTML:!1,width:"auto",divotPosition:t,divotLeftOrTop:"auto"}),(0,y.Zs)(this.element,{fontFamily:"Tahoma, Arial, Helvetica, sans-serif",lineHeight:"27px",bottom:void 0===e.toolTipBottom?"40px":e.toolTipBottom,right:void 0===e.toolTipRight?"0px":e.toolTipRight,padding:"0px 8px",whiteSpace:"nowrap"});var n=this.element.querySelector(".divot");null!==n&&(0,y.Zs)(n,{right:void 0===e.caretRight?"21px":e.caretRight,bottom:void 0===e.caretBottom?"auto":e.caretBottom})}},{key:"changeMessage",value:function(e){this.element.firstChild&&(this.element.firstChild.textContent=e)}},{key:"show",value:function(){this.element.style.display="block"}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"render",value:function(){return this.element}}]),o}(g.w),Ce=n(8015);function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var Te=function(e){(0,a.Z)(n,e);var t=Se(n);function n(e){var i,o;return(0,r.Z)(this,n),(o=t.call(this,"div",e)).props=e,o.colorClass=null!==(i=e.colorClass)&&void 0!==i?i:"defaultUser",o.applyColor(o.colorClass),o}return(0,s.Z)(n,[{key:"initUI",value:function(e){var t=this;this.element=(0,S.vz)("div",{style:{position:"relative",display:"inline-block",margin:"10px 0 0 8px",width:"calc(100% - 48px)",fontSize:"12px",fontFamily:"Tahoma, Arial, Helvetica, sans-serif",fontWeight:"bold",lineHeight:"14px"}},(0,S.vz)("a",{style:{maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block",cursor:"pointer"},onClick:function(t){t.stopPropagation(),e.clickUsernameFn()},target:"_blank",ref:function(e){return t.usernameLink=e}},e.username),(0,S.vz)(Ie,{classRef:function(e){return t.numUnreadDisplay=e}}))}},{key:"applyColor",value:function(e){(0,U.FU)(this.usernameLink,this.colorClass),this.colorClass=e,(0,U.vP)(this.usernameLink,e),"inFanclub"===e?void 0===this.icon&&(this.icon=document.createElement("img"),this.icon.src="".concat(STATIC_URL,"badge_star.svg"),this.icon.height=16,this.element.insertBefore(this.icon,this.usernameLink),this.usernameLink.style.position="relative",this.usernameLink.style.marginLeft="5px",this.usernameLink.style.marginBottom="2px",this.usernameLink.style.maxWidth="calc(100% - 24px)"):void 0!==this.icon&&(this.element.removeChild(this.icon),this.icon=void 0,this.usernameLink.style.position="",this.usernameLink.style.marginLeft="",this.usernameLink.style.marginBottom="",this.usernameLink.style.maxWidth="100%")}},{key:"updateNumUnread",value:function(e){this.numUnreadDisplay.updateNum(e)}},{key:"toggleUnreadDot",value:function(e){this.numUnreadDisplay.toggleDot(e)}},{key:"activateUsernameLink",value:function(){this.usernameLink.href=(0,p.BN)("/".concat(this.props.username))}},{key:"clone",value:function(){var e=new n(ke(ke({},this.props),{},{colorClass:this.colorClass}));return e.updateNumUnread(this.numUnreadDisplay.getNum()),e.toggleUnreadDot(this.numUnreadDisplay.usingDot()),e}},{key:"render",value:function(){return this.element}}]),n}(g.w),Ie=function(e){(0,a.Z)(n,e);var t=Se(n);function n(){return(0,r.Z)(this,n),t.call(this,"div")}return(0,s.Z)(n,[{key:"initUI",value:function(){var e=this;this.element=(0,S.vz)("div",{style:{display:"none"}},(0,S.vz)("div",{className:"numDisplay",style:{position:"relative",display:"none",left:"4px",bottom:"2px",minWidth:"16px",height:"15px",paddingTop:"1px",backgroundColor:"#F47321",color:"#FFFFFF",fontFamily:"Tahoma, Arial, Helvetica, sans-serif",textAlign:"center",borderRadius:"4px",fontWeight:"normal"},ref:function(t){return e.numDisplay=t}}),(0,S.vz)("img",{src:"".concat(STATIC_URL,"orange_dot.svg"),style:{position:"relative",top:"-8px",marginLeft:"4px",display:"none"},ref:function(t){return e.dot=t}}))}},{key:"updateNum",value:function(e){this.numUnread=e,e>0?(this.element.style.display="inline-block",this.numDisplay.textContent=e>9?"9+":"".concat(e),this.numDisplay.style.width="".concat((0,y.mY)(this.numDisplay.textContent,this.numDisplay)+4,"px")):this.element.style.display="none"}},{key:"getNum",value:function(){return this.numUnread}},{key:"toggleDot",value:function(e){e?(this.numDisplay.style.display="none",this.dot.style.display=""):(this.numDisplay.style.display="",this.dot.style.display="none")}},{key:"usingDot",value:function(){return""===this.dot.style.display}},{key:"render",value:function(){return this.element}}]),n}(g.w);function Re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ae=4096,Ee=function(e){return(0,S.vz)("div",{style:Me({position:"absolute",height:"25px",width:"25px",borderRadius:"5px",top:"5px"},e.style),onMouseEnter:function(){return e.parentDiv&&(0,U.vP)(e.parentDiv,"noHighlight")},onMouseLeave:function(){return e.parentDiv&&(0,U.FU)(e.parentDiv,"noHighlight")},colorClass:"button",onClick:e.clickHandler},e.children)},Be=function(e){return(0,S.vz)(Ee,{parentDiv:e.parentDiv,style:e.style,clickHandler:function(t){t.stopPropagation(),e.clickHandler()}},(0,S.vz)("img",{src:"".concat(STATIC_URL,"close-gray.svg"),height:"13px",width:"13px",style:{position:"relative",height:"13px",width:"13px",left:"6px",top:"7px"}}))},Le=function(e){(0,a.Z)(n,e);var t=Re(n);function n(e){var i,o;(0,r.Z)(this,n),(o=t.call(this)).fetchFailed=!1,o.isShowing=!0,o.fetched=!1,o.isAllHistoryLoaded=!1,o.dmDuplicateChecker=new G,o.removeMenu=function(){void 0!==o.menu&&(o.element.removeChild(o.menu.overlay),o.element.removeChild(o.menu.element),o.unHighlightHeader(),o.menu=void 0)},o.popoutConvo=function(){ie.y.show(o.username),o.openOrCollapseWindow(!1)},o.ignoreUser=function(){var e=function(){return o.appendRoomNotice(o.createLogMessage(k.ag.errorIgnoringUser(o.username)))};(0,W.qn)(o.username).then((function(t){return!t&&e()})).catch(e)},o.unignoreUser=function(){var e=function(){return o.appendRoomNotice(o.createLogMessage(k.ag.errorUnignoringUser(o.username)))};(0,W.jr)(o.username).then((function(t){return!t&&e()})).catch(e)},o.username=e.username,o.myUsername=e.myUsername,o.raiseWindowZIndexToTop=e.raiseWindowZIndexToTop,o.listenerGroup=new b.mM,o.initTippingUI(),o.constructElement(),o.openOrCollapseWindow(e.open,e.markAsRead,!0);var s=null===(i=R.J.current.loggedInUser)||void 0===i?void 0:i.userUid;if(void 0!==s){var a=new V.Tz(s);a.isSubscribed()?o.enableSend():a.onSubscribeChange.listen((function(e){e.subscribed&&o.enableSend()})).addTo(o.listenerGroup)}return(0,D.bG)(o.username).then((function(t){var n=t.sitewideUser,i=t.canPm,r=t.canTip;o.userInfo=n,o.colorClass=(0,z.c9)(n),o.canSendDm=i,r&&o.enableTip(),o.usernameLabel.applyColor(o.colorClass),o.fetchConversation(e.markAsRead),v.kN.listen((function(e){o.userInfo.isBroadcaster=o.username===e.dossier.room,o.colorClass=(0,z.c9)(o.userInfo),o.usernameLabel.applyColor(o.colorClass)}))})).catch((function(e){var t=new m.j(e.xhr.responseText).getStringOrUndefined("error");void 0!==t?(0,f.Cj)(t):(0,f.Cj)(k.ag.errorLoadingDms(o.username)),Z.Lj.fire({username:o.username,deleteWindow:!0})})),o}return(0,s.Z)(n,[{key:"constructElement",value:function(){this.createHeaderBar(),this.createChatDiv(),this.createFollowStar();var e={cssFloat:"right",position:"relative",marginRight:"7px",borderRadius:"4px 4px 0px 0px",width:"280px",height:n.expandedHeight};this.element=(0,S.vz)("div",{colorClass:"dmWindow",style:e},this.headerBar,this.chatDiv)}},{key:"createHeaderBar",value:function(){var e=this,t={position:"relative",height:n.headerHeight,borderRadius:"4px 4px 0px 0px",borderBottomWidth:"2px",borderBottomStyle:"solid",cursor:"pointer"};this.headerBar=(0,S.vz)("div",{style:t,colorClass:"dmWindowHeader",onMouseEnter:function(){e.highlightHeader()},onMouseLeave:function(){e.unHighlightHeader()},onClick:function(){return e.openOrCollapseWindow(!e.isOpen)}}),this.usernameLabel=new Te({username:this.username,colorClass:this.colorClass,clickUsernameFn:function(){return e.showUCM()}}),this.headerBar.appendChild(this.usernameLabel.element);var i=(0,S.vz)(Be,{parentDiv:this.headerBar,style:{right:"5px"},clickHandler:function(){return Z.Lj.fire({username:e.username})}});this.closeToolTip=new we({message:k.ag.dmCloseTabShortcut}),(0,h.j9)("mouseenter",i,(function(){var t;null===(t=e.closeToolTip)||void 0===t||t.show()})),(0,h.j9)("mouseleave",i,(function(){var t;null===(t=e.closeToolTip)||void 0===t||t.hide()})),i.appendChild(this.closeToolTip.element),this.headerBar.appendChild(i)}},{key:"initTippingUI",value:function(){var e=this;this.tippingUI=new A(this.username,(function(){return e.hideTipping()})),this.tippingWindow=this.tippingUI.createUI(),this.tippingOverlay=this.tippingUI.createOverlay()}},{key:"enableSend",value:function(){this.input.enableSend()}},{key:"enableTip",value:function(){this.input.enableTip()}},{key:"changeWindowZIndex",value:function(e){this.element.style.zIndex="".concat(e)}},{key:"onIgnoreUnignore",value:function(e){e?this.appendRoomNotice(this.createLogMessage(k.ag.ignoringUser(this.username))):this.appendRoomNotice(this.createLogMessage(k.ag.noLongerIgnoring(this.username)))}},{key:"showUCM",value:function(){if(this.isOpen){if(void 0===this.menu){var e=this.usernameLabel.clone();e.activateUsernameLink(),e.element.style.margin="0",this.menu=new he({currentUsername:this.myUsername,userInfo:this.userInfo,usernameLabel:e,tearDownFunc:this.removeMenu,popoutFunc:this.popoutConvo,ignoreFunc:this.ignoreUser,unignoreFunc:this.unignoreUser,includePopoutLink:!(this instanceof De),dontRepositionForThumbnail:this instanceof De}),this.element.appendChild(this.menu.overlay),this.element.appendChild(this.menu.element)}this.menu.setLastReceivedMessage(this.lastReceivedMessage),this.raiseWindowZIndexToTop(this.username),"none"===this.menu.element.style.display&&(this.menu.element.style.display="block",this.menu.showOverlay(),(0,C.fg)("DmMenuClicked",{location:"DmWindow"}))}else this.openOrCollapseWindow(!0)}},{key:"showTipping",value:function(e,t,n){var i=this;this.tippingUI.setFields(e,t),this.element.appendChild(this.tippingOverlay),this.element.appendChild(this.tippingWindow),!0===n?window.setTimeout((function(){i.tippingUI.focus()}),990):this.tippingUI.focus(),(0,C.fg)("SendTipViewed",{location:"DmWindow",tipType:"public",localStorage:(0,d.IU)()})}},{key:"hideTipping",value:function(){var e,t;null===(e=this.tippingOverlay.parentElement)||void 0===e||e.removeChild(this.tippingOverlay),null===(t=this.tippingWindow.parentElement)||void 0===t||t.removeChild(this.tippingWindow)}},{key:"onTip",value:function(e){var t,n=e.fromUser.username===this.myUsername;t=n?k.ag.sentTipDmNotice(e.amount):e.message.length>0?k.ag.receivedTipDmNoticeWithMessage(this.username,e.amount,e.message):k.ag.receivedTipDmNotice(this.username,e.amount);var i=this.createLogMessage(t,n?2:1,"tipNotice");(0,y.Zs)(i,{fontWeight:"bold"}),this.appendRoomNotice(i)}},{key:"getNumUnread",value:function(){var e;return null!==(e=this.numUnread)&&void 0!==e?e:0}},{key:"createChatDiv",value:function(){var e,t,i=this,o={height:"calc(100% - ".concat(n.headerHeight,")"),position:"relative",fontFamily:"Tahoma, Arial, Helvetica, sans-serif",fontSize:"12px"},r={position:"relative",height:"calc(100% - ".concat(F.height,")"),paddingBottom:"8px",boxSizing:"border-box",overflowY:"auto"};this.chatDiv=(0,S.vz)("div",{style:o,ref:function(e){i.chatDiv=e}},(0,S.vz)("div",{style:r,onScroll:function(){i.handleChatDivScroll()},onMouseDown:function(n){e=n.pageX,t=n.pageY},onMouseUp:function(n){var o=n.pageX-e,r=n.pageY-t;Math.sqrt(o*o+r*r)<2&&i.input.focus()},ref:function(e){return i.messageDiv=e}},(0,S.vz)("div",{style:{width:"100%",boxSizing:"border-box",padding:"0px 4px"},ref:function(e){return i.messageList=e}},this.createLogMessage(k.ag.privateConversationWithText(this.username)),this.createLogMessage(k.ag.conversationCautionMessage(q.w.siteName)),(0,S.vz)("div",{ref:function(e){return i.messageHistoryDiv=e}},(0,S.vz)("div",{style:{marginTop:"44px"},ref:function(e){return i.loadingDiv=e}},(0,S.vz)(K.L,{extraStyle:{margin:"auto"}}))))),(0,S.vz)(F,{classRef:function(e){return i.input=e},toUsername:this.username,onInputExpand:function(){return i.onInputExpand()},onInputCollapse:function(){return i.onInputCollapse()},showTipping:function(e,t){return i.showTipping(e,t)},sendDmFailedCallback:function(e){i.appendRoomNotice(i.createLogMessage(e.errorMessage))},onFocus:function(){return i.onInputFocus()}}))}},{key:"handleChatDivScroll",value:function(){var e=this.messageDiv.scrollTop;0!==e||this.isAllHistoryLoaded||this.fetchConversation(!0,this.earliestMessageId),this.messageDiv.scrollHeight-e-this.messageDiv.clientHeight<2&&this.fireDmsRead()}},{key:"createFollowStar",value:function(){var e=this;(0,w.w5)(this.username).then((function(t){e.followProhibited=!t,(0,p.Ue)("follow/is_following/".concat(e.username,"/")).then((function(n){var i=JSON.parse(n.responseText).following;(t||i)&&e.constructFollowStarUI(i)})).catch(x.$x)})).catch(x.$x)}},{key:"constructFollowStarUI",value:function(e){var t=this;this.followButton=(0,S.vz)(Ee,{parentDiv:this.headerBar,style:{right:"30px"},clickHandler:function(){}}),this.followStar=new J.X({slug:this.username,isFollowing:e,hideTitle:!0}),(0,y.Zs)(this.followStar,{height:"20px",width:"20px",backgroundSize:"20px 20px",backgroundPosition:"center",padding:"2px 3px",margin:"0px"}),this.constructFollowToolTip(e),(0,h.j9)("mouseenter",this.followButton,(function(){var e;t.followStar.isShown()&&(null===(e=t.followToolTip)||void 0===e||e.show())})),(0,h.j9)("mouseleave",this.followButton,(function(){var e;null===(e=t.followToolTip)||void 0===e||e.hide()})),this.followButton.appendChild(this.followStar.element),void 0!==this.followToolTip&&this.followButton.appendChild(this.followToolTip.element),this.headerBar.appendChild(this.followButton)}},{key:"constructFollowToolTip",value:function(e){this.followToolTip=new we({message:e?k.ag.unfollowText:k.ag.followText})}},{key:"followUnfollow",value:function(e){var t;this.followStar.setFollowing(e),null===(t=this.followToolTip)||void 0===t||t.changeMessage(e?k.ag.unfollowText:k.ag.followText),this.followProhibited&&!e&&(this.followButton.style.display="none")}},{key:"getUserInfo",value:function(){return this.userInfo}},{key:"setUserInfo",value:function(e){this.userInfo=Me(Me({},this.userInfo),e),this.usernameLabel.applyColor((0,z.c9)(this.userInfo))}},{key:"openWindow",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.chatDiv.style.display="block",(0,U.FU)(this.element,"collapsed"),this.element.style.bottom=n.expandedHeight,this.element.style.height=n.expandedHeight,null===(t=this.closeToolTip)||void 0===t||t.changeMessage(k.ag.dmCloseTabShortcut),this.usernameLabel.toggleUnreadDot(!0),e&&(i||this.scrollAndFocus(),this.fireDmsRead()),void 0!==this.followButton&&(this.followButton.style.display="block")}},{key:"collapseWindow",value:function(){var e;this.chatDiv.style.display="none",(0,U.vP)(this.element,"collapsed"),this.element.style.bottom="36px",this.element.style.height="36px",null===(e=this.closeToolTip)||void 0===e||e.changeMessage(k.ag.dmCloseTab),this.usernameLabel.toggleUnreadDot(!1),this.getNumUnread()>0&&this.usernameLabel.updateNumUnread(this.getNumUnread()),void 0!==this.followButton&&(this.followButton.style.display="none"),this.hideTipping()}},{key:"openOrCollapseWindow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.isOpen=e,e?this.openWindow(t,n):this.collapseWindow();var i={username:this.username,isOpen:e};Z.Ql.fire(i),Z._j.fire(void 0)}},{key:"setIsShowing",value:function(e){this.isShowing=e,e&&this.fetchFailed&&this.fetchConversation(!0)}},{key:"removeFromDOM",value:function(){var e;null===(e=this.closeToolTip)||void 0===e||e.hide(),this.hideTipping(),this.element.remove(),this.setIsShowing(!1)}},{key:"isWindowOpen",value:function(){return this.isOpen}},{key:"isInputFocused",value:function(){return this.input.isFocused()}},{key:"blurInput",value:function(){this.input.blur()}},{key:"isScrolledUp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40;return this.messageList.offsetHeight-(this.messageDiv.scrollTop+this.messageDiv.offsetHeight)>e}},{key:"scrollToBottom",value:function(){this.messageDiv.scrollTop=this.messageList.offsetHeight}},{key:"handleImageLoadScrolling",value:function(e){var t=this;this.isScrolledUp()||e.querySelectorAll("img").forEach((function(e){var n=e.src;e.src="",e.onload=function(){return t.scrollToBottom()},e.src=n}))}},{key:"scrollAndFocus",value:function(){this.scrollToBottom(),document.activeElement!==this.input.element&&this.input.focus()}},{key:"onInputFocus",value:function(){this.isScrolledUp()||this.fireDmsRead()}},{key:"onInputExpand",value:function(){var e=this.isScrolledUp();this.messageDiv.style.height="calc(100% - ".concat(F.expandedHeight,")"),e||this.scrollToBottom()}},{key:"onInputCollapse",value:function(){this.messageDiv.style.height="calc(100% - ".concat(F.height,")")}},{key:"fetchConversation",value:function(e,t){var n=this;(0,D.SX)(this.username,t).then((function(i){var r=i.messages;if(r.length<D.kG&&(n.isAllHistoryLoaded=!0),n.fetched||(n.fetched=!0,n.fetchFailed=!1,n.loadingDiv.remove(),n.setNumUnread(i.numUnread),e&&n.fireDmsRead()),r.length>0)if(n.earliestMessageId=r[0].messageID,void 0===n.lastReceivedMessage&&(n.lastReceivedMessage=(0,o.Z)(r).reverse().find((function(e){return e.fromUser.username===n.username}))),void 0===n.latestTimestamp&&(n.latestTimestamp=r[r.length-1].createdAt),void 0===t){var s=n.dmDuplicateChecker.filterDuplicates(r,!0);n.addPreviousBatch(s),n.maybeAddCanDmNotice(),n.scrollToBottom(),n.handleImageLoadScrolling(n.messageHistoryDiv)}else n.addPreviousBatch(r);else void 0===t&&n.maybeAddCanDmNotice()})).catch((function(){n.appendRoomNotice(n.createLogMessage(k.ag.errorLoadingConversationHistory)),n.loadingDiv.remove(),n.fetchFailed=!0}))}},{key:"addPreviousBatch",value:function(e){var t=this;if(0!==e.length){var n,i,o=(0,S.vz)("div",null);void 0!==this.oldestMessage&&this.oldestMessage.updateForPrevTimestamp(e[e.length-1].createdAt),e.forEach((function(e,r){var s=e.fromUser.username===t.myUsername;n=new ne({dm:e,isMine:s,prevTimestamp:i}),o.appendChild(n.element),i=e.createdAt,0===r&&(n.showTimestamp(),t.oldestMessage=n)})),this.messageHistoryDiv.insertBefore(o,this.messageHistoryDiv.firstChild),this.messageDiv.scrollTop=o.offsetHeight}}},{key:"createLogMessage",value:function(e){var t=arguments.length>2?arguments[2]:void 0;switch(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0){case 0:return(0,S.vz)("div",{style:{maxWidth:"271px",textAlign:"center",fontSize:"11px",lineHeight:"12px",padding:"4px",margin:"auto"},colorClass:"logMessage"},e);case 2:return te(e,!0,"logMessage",t);case 1:return te(e,!1,"logMessage",t)}}},{key:"appendRoomNotice",value:function(e){this.messageList.appendChild(e),this.scrollToBottom()}},{key:"addMessageToEnd",value:function(e){var t=e.fromUser.username===this.myUsername;t||(this.lastReceivedMessage=e);var n=new ne({dm:e,isMine:t,prevTimestamp:this.latestTimestamp});this.handleImageLoadScrolling(n.element),this.messageList.appendChild(n.element),this.latestTimestamp=e.createdAt,void 0===this.oldestMessage&&(n.showTimestamp(),this.oldestMessage=n)}},{key:"maybeAddCanDmNotice",value:function(){if(!this.canSendDm){var e,t=!0===(null===(e=R.J.current.loggedInUser)||void 0===e?void 0:e.isAgeVerified)?k.ag.dmSupporterNoticeAgeVerified:k.ag.dmSupporterNotice;this.appendRoomNotice(this.createLogMessage(t))}}},{key:"handleNewMessage",value:function(e){if(!this.dmDuplicateChecker.isMessageDuplicate(e,!1)){var t=e.fromUser.username===this.myUsername,n=t?0:this.getNumUnread()+1,i=this.isScrolledUp();this.addMessageToEnd(e),!t&&i||this.scrollToBottom(),t||this.setNumUnread(n),this.isOpen&&this.isShowing&&!i&&this.fireDmsRead()}}},{key:"setNumUnread",value:function(e){0!==e?(this.numUnread=e,this.usernameLabel.updateNumUnread(e)):this.fireDmsRead()}},{key:"fireDmsRead",value:function(){0!==this.getNumUnread()&&document.hasFocus()&&(this.markRead(),Ce.Zn.fire({username:this.username}))}},{key:"markRead",value:function(){0!==this.getNumUnread()&&(this.numUnread=0,this.usernameLabel.updateNumUnread(0))}},{key:"highlightHeader",value:function(){(0,U.vP)(this.headerBar,"highlight")}},{key:"unHighlightHeader",value:function(){(0,U.FU)(this.headerBar,"highlight")}},{key:"highlightHeaderForShow",value:function(){var e=this;(0,U.vP)(this.headerBar,"loadedHighlight"),window.clearTimeout(this.loadedHighlightTimeout),this.loadedHighlightTimeout=window.setTimeout((function(){return(0,U.FU)(e.headerBar,"loadedHighlight")}),4e3)}}]),n}(g.w);Le.headerHeight="34px",Le.expandedHeight="260px";var Oe=function(e){(0,a.Z)(n,e);var t=Re(n);function n(e){var i;return(0,r.Z)(this,n),i=t.call(this,e),"ResizeObserver"in window&&new ResizeObserver((function(){return i.onResize()})).observe(i.messageDiv),i}return(0,s.Z)(n,[{key:"constructElement",value:function(){var e=this;this.createHeaderBar(),this.createChatDiv(),this.createFollowStar(),this.element=(0,S.vz)("div",{colorClass:"dmWindow",style:{boxShadow:"none",display:"flex",flexDirection:"column",flex:1,height:"1px"}},this.headerBar,this.chatDiv,(0,S.vz)(_,{classRef:function(t){return e.input=t},toUsername:this.username,onInputExpand:function(){},onInputCollapse:function(){},showTipping:function(t,n,i){return e.showTipping(t,n,i)},sendDmFailedCallback:function(t){e.appendRoomNotice(e.createLogMessage(t.errorMessage))},onFocus:function(){return e.onInputFocus()}}))}},{key:"createHeaderBar",value:function(){var e=this;this.headerBar=(0,S.vz)("div",{style:{position:"relative",height:"34px",borderRadius:"4px 4px 0px 0px",borderBottomWidth:"1px",borderBottomStyle:"solid"},colorClass:"dmWindowHeader"}),this.usernameLabel=new Te({username:this.username,colorClass:this.colorClass,clickUsernameFn:function(){return e.showUserPanel()}}),this.headerBar.appendChild(this.usernameLabel.element)}},{key:"createChatDiv",value:function(){var e=this;this.chatDiv=(0,S.vz)("div",{style:{fontFamily:"Tahoma, Arial, Helvetica, sans-serif",fontSize:"12px",flex:1,height:"1px",display:"flex"},ref:function(t){e.chatDiv=t}},(0,S.vz)("div",{style:{width:"100%",height:"100%",overflowY:"auto"},onScroll:function(){e.handleChatDivScroll()},ref:function(t){return e.messageDiv=t}},(0,S.vz)("div",{style:{width:"100%",boxSizing:"border-box",padding:"4px 4px 8px 4px"},ref:function(t){return e.messageList=t}},this.createLogMessage(k.ag.privateConversationWithText(this.username)),this.createLogMessage(k.ag.conversationCautionMessage(q.w.siteName)),(0,S.vz)("div",{ref:function(t){return e.messageHistoryDiv=t}},(0,S.vz)("div",{style:{marginTop:"44px"},ref:function(t){return e.loadingDiv=t}},(0,S.vz)(K.L,{extraStyle:{margin:"auto"}}))))))}},{key:"initTippingUI",value:function(){var e=this;this.tippingUI=new B(this.username,(function(){return e.hideTipping()})),this.tippingWindow=this.tippingUI.createUI(),this.tippingOverlay=this.tippingUI.createOverlay()}},{key:"constructFollowStarUI",value:function(e){this.followStar=new J.X({slug:this.username,isFollowing:e}),(0,y.Zs)(this.followStar,{height:"20px",width:"20px",backgroundSize:"20px 20px",backgroundPosition:"center",padding:"2px 3px",margin:"0px"}),this.followButton=(0,S.vz)(Ee,{style:{right:"8px"},clickHandler:function(){}}),this.followButton.appendChild(this.followStar.element),this.headerBar.appendChild(this.followButton)}},{key:"openOrCollapseWindow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e?this.showElement():this.hideElement(),(0,i.Z)((0,c.Z)(n.prototype),"openOrCollapseWindow",this).call(this,e,t)}},{key:"openWindow",value:function(e){this.chatDiv.style.display="flex",(0,U.FU)(this.element,"collapsed"),this.scrollToBottom(),e&&this.fireDmsRead(),void 0!==this.followButton&&(this.followButton.style.display="block")}},{key:"resizeTipCallout",value:function(){var e=(0,H.mP)();e<250?(0,y.Zs)(this.tippingUI,{height:"".concat(e,"px"),overflow:"scroll",transform:"translate(-50%)",top:"",bottom:"0",overscrollBehavior:"contain"}):(0,y.Zs)(this.tippingUI,{height:"",overflow:"",transform:"translate(-50%, -50%)",top:"50%",bottom:"",overscrollBehavior:""})}},{key:"showUCM",value:function(){}},{key:"showUserPanel",value:function(){var e=this;void 0===this.userPanel&&(this.userPanel=new j.w,(0,y.Zs)(this.userPanel.element,{top:"".concat(this.headerBar.offsetHeight,"px"),backgroundColor:"#FFF",fontSize:"12px"}),N.ah.listen((function(){e.removeUserPanelDOM()})).addTo(this.listenerGroup),this.userPanel.overlayClick.listen((function(){e.removeUserPanelDOM()})).addTo(this.listenerGroup)),this.userPanel.updateContents(this.username,this.lastReceivedMessage),this.headerBar.appendChild(this.userPanel.overlay),this.headerBar.appendChild(this.userPanel.element),this.userPanel.showOverlay()}},{key:"removeUserPanelDOM",value:function(){var e;null===(e=this.userPanel)||void 0===e||e.hideOverlay(),void 0!==this.userPanel&&null!==this.userPanel.element.parentElement&&this.userPanel.element.parentElement.removeChild(this.userPanel.element)}},{key:"showElement",value:function(){(0,i.Z)((0,c.Z)(n.prototype),"showElement",this).call(this,"flex")}},{key:"highlightHeaderForLoad",value:function(){}},{key:"onResize",value:function(){this.isScrolledUp(600)||this.scrollToBottom()}}]),n}(Le),De=function(e){(0,a.Z)(n,e);var t=Re(n);function n(e){var i,o,s;return(0,r.Z)(this,n),s=t.call(this,{username:e,myUsername:null!==(i=null===(o=R.J.current.loggedInUser)||void 0===o?void 0:o.username)&&void 0!==i?i:"",open:!0,markAsRead:!0,raiseWindowZIndexToTop:function(){}}),new ResizeObserver((function(){return s.onResize()})).observe(s.messageDiv),s}return(0,s.Z)(n,[{key:"constructElement",value:function(){this.createHeaderBar(),this.createFollowStar(),this.createChatDiv(),this.element=(0,S.vz)("div",{colorClass:"dmWindow",style:{position:"relative",height:"100%"}},this.headerBar,this.chatDiv)}},{key:"createHeaderBar",value:function(){var e=this;this.headerBar=(0,S.vz)("div",{style:{position:"relative",height:"34px",borderRadius:"4px 4px 0px 0px",borderBottomWidth:"2px",borderBottomStyle:"solid"},colorClass:"dmWindowHeader"}),this.usernameLabel=new Te({username:this.username,colorClass:this.colorClass,clickUsernameFn:function(){return e.showUCM()}}),this.headerBar.appendChild(this.usernameLabel.element)}},{key:"constructFollowStarUI",value:function(e){(0,i.Z)((0,c.Z)(n.prototype),"constructFollowStarUI",this).call(this,e),this.followButton.style.right="8px"}},{key:"constructFollowToolTip",value:function(e){this.followToolTip=new we({message:e?k.ag.unfollowText:k.ag.followText,toolTipBottom:"auto",toolTipRight:"40px",divotPosition:3,caretRight:"0px",caretBottom:"24px"})}},{key:"openWindow",value:function(e){(0,i.Z)((0,c.Z)(n.prototype),"openWindow",this).call(this,e),this.element.style.bottom="",this.element.style.height="100%"}},{key:"highlightHeaderForLoad",value:function(){}},{key:"onResize",value:function(){this.isScrolledUp(600)||this.scrollToBottom()}}]),n}(Le)},1994:function(e,t,n){"use strict";n.d(t,{I:function(){return l},p:function(){return a}});var i=n(9598),o=n(2800),r=n(7212),s=n(8016);function a(e){var t=(e||document).querySelectorAll(".dmWindow");return Array.from(t).reduce((function(e,t){return Math.max(e,t.offsetHeight)}),0)}function l(e){var t,n=null===(t=o.J.current.loggedInUser)||void 0===t?void 0:t.userUid;void 0!==n&&(new s._G(n).onMessage.listen((function(t){var n,i=null===(n=o.J.current.loggedInUser)||void 0===n?void 0:n.username,r=t.fromUser.username!==i?t.fromUser.username:t.toUsername,s=e(null!=r?r:"");null==s||s.onTip(t)})),new s.zw(n).onMessage.listen((function(t){var n=e(t.username);null==n||n.onIgnoreUnignore(t.isIgnored)})),i.wk.listen((function(t){var n=e(t.roomName);null==n||n.followUnfollow(t.following)})),new r.AE(n).onMessage.listen((function(t){var n=e(t.fromUser.username);null==n||n.setUserInfo({inFanclub:!0})})))}},7397:function(e,t,n){"use strict";n.d(t,{FP:function(){return O},GH:function(){return A},Lj:function(){return R},Ql:function(){return P},S_:function(){return M},_j:function(){return E},nh:function(){return I},qd:function(){return L}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(8759),u=n(7693),d=n(9),h=n(1794),f=n(3607),p=n(3682),m=n(3276),v=n(47),g=n(9420),y=n(5925),b=n(2800),w=n(2358),C=n(6832),x=n(2906),k=n(932),S=n(1994),T=n(8015);var I=new h.xB("createDmWindowRequest"),R=new h.xB("removeDMWindowRequest"),P=new h.xB("updateWindowIsOpenEvent"),M=new h.xB("removeDmChatBarRequest"),A=new h.xB("restoreDmChatBarRequest"),E=new h.xB("repositionFloatingPlayer");E.listen((function(){void 0!==document.repositionFloatingPlayer&&document.repositionFloatingPlayer()}));var B="pmChatWindow",L=function(e){(0,s.Z)(h,e);var t,n,d=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function h(e){var t;return(0,i.Z)(this,h),(t=d.call(this)).allDmWindowsMap=new Map,t.focusingTablet=!1,t.tabletFocusState=2,t.raiseWindowZIndexToTop=function(e){t.allDmWindowsMap.forEach((function(t,n){n===e?t.changeWindowZIndex(2):t.changeWindowZIndex(1)}))},t.myUsername=e,t.bindListeners(),(0,u.j9)("mousedown",t.element,(function(){return(0,m.ZE)(!1)})),(0,u.j9)("mouseup",window,(function(){return(0,m.ZE)(!0)})),t}return(0,o.Z)(h,[{key:"initData",value:function(){this.manuallyHandlingTabletKeyboard=(0,c.s2)()&&!!window.visualViewport&&void 0===navigator.virtualKeyboard}},{key:"initUI",value:function(){var e,t,n=this;if((0,r.Z)((0,l.Z)(h.prototype),"initUI",this).call(this),this.shownDmContainer=(0,v.vz)("div",{style:{display:"inline-block",cssFloat:"right"}}),this.element=(0,v.vz)("div",{id:"DmWindowBar",style:{position:"fixed",bottom:"0px",right:"10px",minWidth:"350px",width:"100vw",height:"0px",backgroundColor:"rgba(255, 255, 255, 0.5)",zIndex:1005}},this.shownDmContainer),x.e.listen((function(e){return n.handleInputFocus(e)})),this.manuallyHandlingTabletKeyboard)(0,u.j9)("focus",this.element,(function(){return n.onTabletFocus()}),!0),(0,u.j9)("blur",this.element,(function(){return n.onTabletBlur()}),!0),(0,w._V)(document,(function(){n.focusingTablet||n.blur()})),(0,u.j9)("touchstart",document,(function(e){e.target instanceof Element&&!n.element.contains(e.target)&&n.blur()}));else if(void 0!==navigator.virtualKeyboard){var i=navigator.virtualKeyboard;(0,u.j9)("focus",document,(function(e){i.overlaysContent=e.target instanceof Element&&n.element.contains(e.target)}),!0),(0,u.j9)("blur",this.element,(function(){n.element.style.bottom="0px"}),!0),i.addEventListener("geometrychange",(function(e){n.element.contains(document.activeElement)&&(n.element.style.bottom="".concat(e.target.boundingRect.height,"px"))}))}(0,c.s2)()&&((0,u.j9)("focusin",document,(function(e){e.target instanceof HTMLElement&&(["input","textarea"].includes(e.target.tagName.toLowerCase())||"true"===e.target.contentEditable)&&!n.element.contains(e.target)&&(n.element.style.visibility="hidden")})),(0,u.j9)("focusout",document,(function(){n.element.style.visibility=""})),null===(e=window.visualViewport)||void 0===e||e.addEventListener("resize",(function(){var e=window.visualViewport?Math.round(10*window.visualViewport.scale):void 0;void 0!==t&&e!==t&&n.blur(),t=e})))}},{key:"handleInputFocus",value:function(e){if(this.manuallyHandlingTabletKeyboard){var t;if(e instanceof HTMLElement)t=e;else{if(!(e.target instanceof HTMLElement))return;if(document.activeElement===e.target&&(0,c.Tt)()&&this.isPositionedForKeyboard())return;e.preventDefault(),t=e.target}this.handleTabletInputFocus(t)}else e instanceof HTMLElement&&e.focus()}},{key:"handleTabletInputFocus",value:function(e){var t=this;e.blur();var n=window.scrollX,i=window.scrollY;this.maxZoomedTabletTop=document.body.offsetHeight,this.focusingTablet=!0;var o=function(){window.scrollTo(n,i),(0,f.Fd)()&&t.setTabletStyleForZoomFocus()};(0,u.j9)("scroll",document,o),window.setTimeout((function(){(0,u.SC)("scroll",document,o),t.focusingTablet=!1}),1e3),this.setTabletStyleForFocus(0),e.focus()}},{key:"onTabletFocus",value:function(){var e=this;window.setTimeout((function(){e.setTabletStyleForFocus(1)}),(0,c.Tt)()?75:350)}},{key:"onTabletBlur",value:function(){var e=this;window.setTimeout((function(){e.setTabletStyleForFocus(0),window.setTimeout((function(){e.element.contains(document.activeElement)?(0,c.Tt)()&&e.setTabletStyleForFocus(1):e.setTabletStyleForFocus(2)}),0)}),0)}},{key:"setTabletStyleForFocus",value:function(e){if(e!==this.tabletFocusState)if(this.tabletFocusState=e,(0,f.Fd)())this.setTabletStyleForZoomFocus();else if(!(0,c.op)()){var t=!this.isPositionedForKeyboard();switch(this.element.style.top="unset",this.element.style.bottom="unset",this.element.style.visibility="",e){case 0:t?(0,c.Tt)()?(this.element.style.visibility="none",this.element.style.bottom="60vh"):this.element.style.bottom=(0,p.gr)()?"35vh":"60vh":this.element.style.top="calc(var(--vh, 1vh) * 100 - 2px)";break;case 1:this.element.style.top="calc(var(--vh, 1vh) * 100)";break;case 2:this.element.style.bottom="0px";break;default:error("DmWindowManager - invalid focusState"),this.element.style.bottom="0px"}}}},{key:"setTabletStyleForZoomFocus",value:function(){if(!(0,c.Tt)())return this.element.style.position="fixed",void(this.element.style.bottom="0px");switch(this.element.style.top="unset",this.element.style.bottom="unset",this.tabletFocusState){case 0:case 1:if(window.visualViewport){this.element.style.position="absolute";var e=Math.min(window.scrollY+window.visualViewport.height,this.maxZoomedTabletTop);this.element.style.top="".concat(e,"px")}break;case 2:this.element.style.position="fixed",this.element.style.bottom="0px";break;default:error("DmWindowManager - invalid zoom focusState"),this.element.style.position="fixed",this.element.style.bottom="0px"}}},{key:"isPositionedForKeyboard",value:function(){return this.element.getBoundingClientRect().bottom<=window.innerHeight-5}},{key:"blur",value:function(){document.activeElement instanceof HTMLElement&&this.element.contains(document.activeElement)&&document.activeElement.blur()}},{key:"bindListeners",value:function(){var e=this;R.listen((function(t){var n,i=t.username,o=t.deleteWindow;(null===(n=e.shownWindow)||void 0===n?void 0:n.username)===i&&e.removeShownWindow(),!0===o&&e.allDmWindowsMap.delete(i)})),P.listen((function(){e.updateLocalStorage()})),T.Kd.listen((function(t){var n=e.allDmWindowsMap.get(t.otherUsername);null==n||n.handleNewMessage(t)})),C.zS.conversationRead.listen((function(t){var n=t.username;if(t.isDm){var i=e.allDmWindowsMap.get(n);null==i||i.markRead()}})),b.J.current.isBroadcast&&g.CD.listen((function(t){var n=e.allDmWindowsMap.get(t.username);null==n||n.setUserInfo({isMod:t.isMod})})),(0,S.I)((function(t){return e.allDmWindowsMap.get(t)}))}},{key:"shownWindowUsername",value:function(){var e;return null===(e=this.shownWindow)||void 0===e?void 0:e.username}},{key:"showUserConversation",value:function(e,t,n){if(!this.transferToShown(e,n)){var i=new k.Tx({username:e,myUsername:this.myUsername,open:t,markAsRead:n,raiseWindowZIndexToTop:this.raiseWindowZIndexToTop});this.allDmWindowsMap.set(e,i),this.shownDmContainer.appendChild(i.element),this.showWindow(i,t,n)}}},{key:"removeShownWindow",value:function(){void 0!==this.shownWindow&&(this.shownWindow.removeFromDOM(),this.shownWindow=void 0,this.updateLocalStorage(),E.fire(void 0))}},{key:"transferToShown",value:function(e,t){var n=this.allDmWindowsMap.get(e);return void 0!==n&&(this.shownDmContainer.appendChild(n.element),this.showWindow(n,!0,t),!0)}},{key:"showWindow",value:function(e,t,n){this.removeShownWindow(),this.shownDmContainer.appendChild(e.element),e.setIsShowing(!0),e.openOrCollapseWindow(t,n,!n),n&&e.highlightHeaderForShow(),this.shownWindow=e,this.updateLocalStorage(),E.fire(void 0)}},{key:"updateLocalStorage",value:function(){if((0,c.IU)()){var e;void 0!==this.shownWindow&&(e={username:this.shownWindow.username,isOpen:this.shownWindow.isWindowOpen()});var t=window.localStorage.getItem(B),n=null!==t?JSON.parse(t):{};n[this.myUsername]=JSON.stringify(e),window.localStorage.setItem(B,JSON.stringify(n))}}}],[{key:"getOrCreateInstance",value:function(e){return void 0===h.instance&&(h.instance=new h(e)),h.instance}},{key:"getInstance",value:function(){return h.instance}}]),h}(d.w);function O(e){var t,n=!1;(0,y.Rp)();var i=function(n,i,o){e!==n&&(void 0===t&&(t=L.getOrCreateInstance(e),document.body.appendChild(t.element)),t.showUserConversation(n,i,o))},o=function(){if((0,c.IU)()){var t=window.localStorage.getItem(B);if(null!==t){var n=JSON.parse(t)[e];if(void 0===n)return;var o=JSON.parse(n);i(o.username,o.isOpen,!1),E.fire(void 0)}}};o(),M.listen((function(e){e&&(n=!0),void 0!==t&&(document.body.removeChild(t.element),t=void 0)})),A.listen((function(){n&&(o(),n=!1)})),I.listen((function(e){n||i(e,!0,!0)}))}},1359:function(e,t,n){"use strict";n.d(t,{T:function(){return w}});var i=n(4649),o=n(2951),r=n(1976),s=n(7591),a=n(9492),l=n(7597),c=n(7693),u=n(9),d=n(8263),h=n(1794),f=n(3543),p=n(47),m=n(1185),v=n(1006),g=n(407);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}(0,c.j9)("scroll",document,(function(){return w.documentClick.fire()}),!0),(0,c.j9)("click",document,(function(){return w.documentScroll.fire()}),!0);var w=function(e){(0,s.Z)(u,e);var t,n,i=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function u(e){var t;(0,o.Z)(this,u),(t=i.call(this,"span",e)).listeners=new h.mM,t.hideTooltip=function(){var e;null===(e=t.shownTooltip)||void 0===e||null===(e=e.parentElement)||void 0===e||e.removeChild(t.shownTooltip),t.shownTooltip=void 0};var n=b({display:"inline-block",width:"16px",height:"16px",marginLeft:"4px"},e.style);return t.element=(0,p.vz)("span",{colorClass:"InRoomIndicator",style:n}),t.createTooltips(),t.setupTooltipListeners(),v.rS.listen((function(){t.userInRoomState=v._B.getInstance().userInRoomState(e.username),t.updateUI()})).addTo(t.listeners),t.userInRoomState=v._B.getInstance().userInRoomState(e.username),t.updateUI(),t}return(0,r.Z)(u,[{key:"dispose",value:function(){this.listeners.removeAll()}},{key:"setupTooltipListeners",value:function(){var e=this;u.documentClick.listen(this.hideTooltip).addTo(this.listeners),u.documentScroll.listen(this.hideTooltip).addTo(this.listeners),(0,d.nH)(this.element).listen((function(t){t?e.showTooltip():e.hideTooltip()})),(0,c.j9)("touchend",this.element,(function(t){void 0===e.shownTooltip?e.showTooltip():e.hideTooltip(),t.preventDefault()}))}},{key:"createTooltips",value:function(){var e={hasHTML:!1,divotPosition:1,divotLeftOrTop:"5px"};this.inRoomTooltip=(0,g.T)(b({content:f.ag.userInRoom},e)),this.notInPrivateTooltip=(0,g.T)(b({content:f.ag.userNotInPrivate},e)),this.notInRoomTooltip=(0,g.T)(b({content:f.ag.userNotInRoom},e));for(var t=0,n=[this.inRoomTooltip,this.notInPrivateTooltip,this.notInRoomTooltip];t<n.length;t++){var i=n[t];i.style.position="fixed",i.style.display=""}}},{key:"showTooltip",value:function(){var e,t;switch(this.hideTooltip(),this.userInRoomState){case 0:t=this.inRoomTooltip;break;case 1:t=this.notInPrivateTooltip;break;case 2:t=this.notInRoomTooltip}document.body.appendChild(t);var n=this.element.getBoundingClientRect(),i=(0,d.i6)(),o=-i.left+n.left-7,r=-i.top+n.top-t.offsetHeight-6;t.style.top="".concat(r,"px"),t.style.left="".concat(o,"px"),t.style.width="".concat((0,d.mY)(null!==(e=t.textContent)&&void 0!==e?e:"",t)+1,"px"),this.shownTooltip=t}},{key:"updateUI",value:function(){switch((0,m.FU)(this.element,"inRoom"),(0,m.FU)(this.element,"notInPrivate"),(0,m.FU)(this.element,"notInRoom"),this.userInRoomState){case 0:(0,m.vP)(this.element,"inRoom");break;case 1:(0,m.vP)(this.element,"notInPrivate");break;case 2:(0,m.vP)(this.element,"notInRoom")}}},{key:"render",value:function(){return this.element}}]),u}(u.w);w.documentClick=new h.xB("InRoomIndicator.documentClick",{listenersWarningThreshold:function(){return 50+3*h.q6}}),w.documentScroll=new h.xB("InRoomIndicator.documentScroll",{listenersWarningThreshold:function(){return 50+3*h.q6}})},2010:function(e,t,n){"use strict";n.d(t,{OY:function(){return U},WN:function(){return j},ec:function(){return L}});var i=n(126),o=n(7169),r=n(3243),s=n(7791),a=n(2951),l=n(1976),c=n(7591),u=n(9492),d=n(7597),h=n(4649),f=n(824),p=n.n(f),m=n(7693),v=n(1522),g=n(3753),y=n(9),b=n(8263),w=n(1794),C=n(3543),x=n(47),k=n(2974),S=n(8213),T=n(1185),I=n(6208),R=n(9809);function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,d.Z)(e);if(t){var o=(0,d.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,u.Z)(this,n)}}function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){(0,h.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B=E(E({},R.Q1),{},{cursor:"default"}),L=20,O=function(e){(0,c.Z)(i,e);var t,n=M(i);function i(e){var t;(0,a.Z)(this,i),(t=n.call(this)).parentContents=e,t.scrollSize=D.itemWidth,t.listeners=new w.mM;var o={height:"100%",position:"absolute",zIndex:1e3,opacity:.8,borderRadius:0,border:"none",fill:"currentColor",cursor:"pointer"},r={minHeight:"77px",width:"auto",minWidth:"100%",cssFloat:"left",boxSizing:"border-box",padding:"".concat(i.padding,"px"),whiteSpace:"nowrap",position:"relative"};return t.dock=new y.w,(0,b.Zs)(t.dock,r),t.element=(0,x.vz)("div",{className:"pmMediaDockContainer",style:{flexShrink:0,position:"relative",display:"none",overflowX:"hidden",whiteSpace:"nowrap",bottom:0}},(0,x.vz)("button",{ref:function(e){return t.scrollLeftBtn=e},onClick:function(){t.scrollLeft()},style:E(E({},o),{},{left:0}),colorClass:"scrollButton"},(0,x.vz)("svg",{width:"8",height:"12",viewBox:"0 0 8 12",xmlns:"http://www.w3.org/2000/svg"},(0,x.vz)("path",{d:"M9.19276e-07 5.98581C-0.000425611 5.65497 0.147594 5.33999 0.406233 5.12135L6.21431 0.216066C6.6146 -0.106384 7.20982 -0.0630863 7.55493 0.313586C7.90004 0.690259 7.8688 1.26253 7.48456 1.6025L2.40562 5.89181C2.37742 5.91555 2.36125 5.9498 2.36125 5.98581C2.36125 6.02182 2.37742 6.05607 2.40562 6.07981L7.48456 10.3691C7.75191 10.5845 7.87679 10.922 7.81086 11.251C7.74493 11.58 7.49854 11.8489 7.16704 11.9537C6.83554 12.0584 6.47093 11.9826 6.21431 11.7556L0.408316 6.85177C0.149051 6.63276 0.000328855 6.31734 9.19276e-07 5.98581Z",fill:"#222222"}))),(0,x.vz)("button",{ref:function(e){return t.scrollRightBtn=e},onClick:function(){t.scrollRight()},style:E(E({},o),{},{right:0}),colorClass:"scrollButton"},(0,x.vz)("svg",{width:"8",height:"12",viewBox:"0 0 8 12",xmlns:"http://www.w3.org/2000/svg"},(0,x.vz)("path",{d:"M8 5.98581C8.00043 5.65497 7.85241 5.33999 7.59377 5.12135L1.78569 0.216066C1.3854 -0.106384 0.790178 -0.0630863 0.44507 0.313586C0.0999627 0.690259 0.131205 1.26253 0.515437 1.6025L5.59438 5.89181C5.62258 5.91555 5.63875 5.9498 5.63875 5.98581C5.63875 6.02182 5.62258 6.05607 5.59438 6.07981L0.515437 10.3691C0.248085 10.5845 0.123215 10.922 0.189144 11.251C0.255072 11.58 0.501458 11.8489 0.832959 11.9537C1.16446 12.0584 1.52907 11.9826 1.78569 11.7556L7.59168 6.85177C7.85095 6.63276 7.99967 6.31734 8 5.98581Z",fill:"#222222"}))),(0,x.vz)("div",{ref:function(e){return t.scrollContainer=e},onScroll:function(){t.setScrollButtonVisibility()},style:{overflow:"scroll",width:"100%",position:"relative"},className:"noScrollbar"},t.dock.element)),t.setScrollButtonVisibility(),S.zA.listen((function(e){var n;null===(n=t.getImageById(e))||void 0===n||n.removeElement()})).addTo(t.listeners),S.lk.listen((function(e){var n;null===(n=t.getImageById(e))||void 0===n||n.markRejected()})).addTo(t.listeners),t}return(0,l.Z)(i,[{key:"repositionChildren",value:function(){this.setScrollButtonVisibility()}},{key:"scrollLeft",value:function(){this.scrollContainer.scrollLeft-=this.scrollSize,this.setScrollButtonVisibility()}},{key:"scrollRight",value:function(){this.scrollContainer.scrollLeft+=this.scrollSize,this.setScrollButtonVisibility()}},{key:"setScrollButtonVisibility",value:function(){var e=this.scrollContainer;this.scrollLeftBtn.style.display=e.scrollLeft>0?"block":"none",this.scrollRightBtn.style.display=e.scrollLeft<e.scrollWidth-e.offsetWidth?"block":"none"}},{key:"toggle",value:function(){var e=this;this.isShown()?this.hide():this.show(),window.setTimeout((function(){e.setScrollButtonVisibility()}),0)}},{key:"show",value:function(){this.isShown()||(this.showElement(),this.scrollRightBtn.click(),this.scrollLeftBtn.click(),this.parentContents.repositionChildrenRecursive())}},{key:"hide",value:function(){this.hideElement(),this.onHide(),this.parentContents.repositionChildrenRecursive()}},{key:"removeItem",value:function(e){this.dock.removeChild(e)}},{key:"items",value:function(){return this.dock.children()}},{key:"getImageById",value:function(e){return this.items().find((function(t){var n;return(null===(n=t.media)||void 0===n?void 0:n.mediaId)===e}))}},{key:"clear",value:function(){for(;this.items().length>0;)this.items().forEach((function(e){e.remove()}))}},{key:"isEmpty",value:function(){return 0===this.items().length}},{key:"mediaList",value:(t=(0,s.Z)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(this.items().map((function(e){return e.mediaPromise}))));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"onHide",value:function(){}}]),i}(y.w);O.padding=5;var D=function(e){(0,c.Z)(n,e);var t=M(n);function n(e,i){var o;return(0,a.Z)(this,n),(o=t.call(this)).mediaPromise=e,o.parentDock=i,o.element=(0,x.vz)("div",{style:E(E({},B),{},{backgroundImage:""}),colorClass:"mediaDockItem"},(0,x.vz)("img",{src:"".concat(STATIC_URL_ROOT,"tsdefaultassets/mediaDock/closeButton.svg"),onClick:function(e){e.stopPropagation(),o.remove()},ref:function(e){return o.removeBtn=e},style:{position:"absolute",top:0,right:0,zIndex:1,cursor:"pointer"}}),(0,x.vz)("div",{style:E(E({},B),{},{position:"absolute"}),ref:function(e){return o.imageContainer=e}},(0,x.vz)(I.I,{myRef:function(e){o.loadingSpinner=e}}))),e.then((function(e){o.onload(e)})),o.loadingSpinner.dataset.testid="chat-image-loading-spinner",o}return(0,l.Z)(n,[{key:"onload",value:function(e){var t=this;this.media=e;var n=new Image;n.onload=function(){var e=new Image;e.src=n.src,e.style.width="100%",e.style.height="auto",t.imageContainer.appendChild(e),t.loadingSpinner.style.display="none"},n.src=e.thumbnailUrl}},{key:"removeElement",value:function(){this.parentDock.removeItem(this)}}]),n}(y.w);D.itemWidth=R.k5+2;var U=function(e){(0,c.Z)(h,e);var t,n,u=M(h);function h(e,t,n){var r;(0,a.Z)(this,h),(r=u.call(this,e)).toUser=t,r.videoModes=n,r.fileInput=(0,x.vz)("input",{type:"file",accept:"image/*",multiple:!0}),r.loadingSpinner=new Z,r.initSibling();var s=(0,x.vz)("div",{style:E(E({},B),{},{cursor:"pointer",backgroundImage:"none",backgroundColor:"#2C2C2C"})},(0,x.vz)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%) scale(1.5)"}},(0,x.vz)("img",{src:"".concat(STATIC_URL_ROOT,"tsdefaultassets/mediaDock/uploadBackground.svg")}),(0,x.vz)("img",{src:"".concat(STATIC_URL_ROOT,"tsdefaultassets/mediaDock/uploadSymbol.svg"),style:{position:"absolute",bottom:0,right:0,transform:"translate(50%, 25%) scale(0.66)"}})));return s.dataset.testid="upload-image-button",s.onclick=function(){r.showSelectDialog()},r.dock.element.appendChild(s),r.dock.element.dataset.testid="image-dock",r.fileInput.onchange=function(){r.onFileInputChange()},r.getLatest(),k.S.changeVideoMode.listen((function(e){r.videoModes.includes(e.currentMode)&&r.getLatest()})).addTo(r.listeners),S.zB.listen((function(e){var t,n=k.S.getVideoMode();r.videoModes.includes(n)&&r.toUser===e.toUser&&((t=r).handleFileUpload.apply(t,(0,i.Z)(e.files)),r.show())})).addTo(r.listeners),S.aC.listen((function(e){r.videoModes.includes(k.S.getVideoMode())&&r.addItem(new F(e.promise,(0,o.Z)(r),r.toUser===e.toUser))}),!1).addTo(r.listeners),r}return(0,l.Z)(h,[{key:"initSibling",value:function(){this.sibling=new _(this.parentContents),this.sibling.sibling=this}},{key:"dispose",value:function(){this.listeners.removeAll(),this.sibling.dispose()}},{key:"onFileInputChange",value:(n=(0,s.Z)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!==this.fileInput.files&&(this.handleFileUpload.apply(this,(0,i.Z)(this.fileInput.files)),this.fileInput.value="");case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"handleFileUpload",value:(t=(0,s.Z)(p().mark((function e(){var t,n,i,o,r,s,a=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,n=new Array(t),i=0;i<t;i++)n[i]=a[i];o=0,r=n;case 2:if(!(o<r.length)){e.next=9;break}return s=r[o],e.next=6,(0,S.xX)(s,this.toUser);case 6:o++,e.next=2;break;case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"showSelectDialog",value:function(){this.fileInput.click()}},{key:"addItem",value:function(e){var t=this;for(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&this.items().length>0?this.dock.addChildBeforeIndex(e,0):this.dock.addChild(e),e.mediaPromise.then((function(n){var i=t.sibling.getImageById(n.mediaId);void 0!==i&&e.setSibling(i)}));this.items().length>L;)this.dock.removeChild(this.dock.lastChild());this.setScrollButtonVisibility()}},{key:"getImageById",value:function(e){return this.items().find((function(t){var n;return(null===(n=t.media)||void 0===n?void 0:n.mediaId)===e}))}},{key:"getLatest",value:function(){var e=this;this.dock.removeAllChildren(),this.dock.addChild(this.loadingSpinner),this.setScrollButtonVisibility(),(0,S.SZ)().then((function(t){e.dock.removeAllChildren(),e.loadingSpinner.element.style.display="none";var n,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;e.addItem(new F(Promise.resolve(o),e),!0)}}catch(e){i.e(e)}finally{i.f()}e.setScrollButtonVisibility()})).catch((function(){e.loadingSpinner.element.style.display="none",e.setScrollButtonVisibility()}))}},{key:"items",value:function(){return(0,r.Z)((0,d.Z)(h.prototype),"items",this).call(this)}},{key:"show",value:function(){(0,r.Z)((0,d.Z)(h.prototype),"show",this).call(this),this.sibling.showIfNonempty()}},{key:"hide",value:function(){(0,r.Z)((0,d.Z)(h.prototype),"hide",this).call(this),this.sibling.hide()}}]),h}(O),Z=function(e){(0,c.Z)(n,e);var t=M(n);function n(){var e;return(0,a.Z)(this,n),(e=t.call(this)).element=(0,x.vz)("div",{style:E(E({},B),{},{backgroundImage:""})},(0,x.vz)("div",{style:E(E({},B),{},{position:"absolute"})},(0,x.vz)(I.I,null))),e}return(0,l.Z)(n)}(y.w),F=function(e){(0,c.Z)(n,e);var t=M(n);function n(e,i){var o,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,a.Z)(this,n),(o=t.call(this,e,i)).autoselect=r,o.selected=!1,o.rejected=!1,e.catch((function(e){if(o.removeElement(),e instanceof g.GM){if(400===e.xhr.status){var t=JSON.parse(e.xhr.responseText).errors;if(void 0!==t&&"invalid_media"===t.media)return void(0,v.Cj)(C.ag.invalidFileErrorUploadingMedia)}(0,v.Cj)(C.ag.errorUploadingMedia)}else"file_too_large"===e&&(0,v.Cj)(C.ag.fileSizeErrorUploadingMedia)})),o.selectedIcon=(0,x.vz)("img",{ref:function(e){return o.selectedIcon=e},src:"".concat(STATIC_URL_ROOT,"tsdefaultassets/mediaDock/selected.svg"),style:{position:"absolute",bottom:0,right:0,zIndex:1,display:"none"}}),o.element.appendChild(o.selectedIcon),o.removeBtn.style.display="none",o}return(0,l.Z)(n,[{key:"onload",value:function(e){var t=this;(0,r.Z)((0,d.Z)(n.prototype),"onload",this).call(this,e),this.removeBtn.style.display="block",this.autoselect&&window.setTimeout((function(){t.select()}),0),this.element.onclick=function(){t.toggleSelect()}}},{key:"toggleSelect",value:function(){this.selected?this.deselect():this.select()}},{key:"select",value:function(){this.selected||(this.selected=!0,this.removeBtn.style.display="none",this.selectedIcon.style.display="block",this.createSibling(),this.parentDock.sibling.addItem(this.sibling),this.parentDock.sibling.show(),this.parentDock.sibling.setScrollButtonVisibility())}},{key:"createSibling",value:function(){void 0===this.sibling&&(this.sibling=new N(this.mediaPromise,this.parentDock.sibling),this.sibling.sibling=this)}},{key:"setSibling",value:function(e){void 0===this.sibling?(this.selected=!0,this.removeBtn.style.display="none",this.selectedIcon.style.display="block",this.sibling=e,this.sibling.sibling=this):error("LibraryMediaDockItem sibling exists")}},{key:"deselect",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.selected=!1,this.removeBtn.style.display="block",this.selectedIcon.style.display="none",t||null===(e=this.sibling)||void 0===e||e.remove(!0)}},{key:"remove",value:function(){var e=this;this.rejected?this.removeElement():(0,v.oB)(C.ag.confirmPhotoDelete,(function(){if(void 0!==e.media){e.loadingSpinner.style.display="block";var t=e.imageContainer.querySelector("img");e.imageContainer.removeChild(t),(0,S.JJ)(e.media.mediaId).then((function(){})).catch((function(){e.loadingSpinner.style.display="none",e.imageContainer.appendChild(t),(0,v.Cj)(C.ag.errorDeletingMedia)}))}else error("Attempting to delete media before it is loaded")}))}},{key:"markRejected",value:function(){this.element.removeChild(this.imageContainer),this.element.onclick=null;var e=(0,x.vz)("div",{style:{whiteSpace:"break-spaces",fontSize:"11px",width:"100%",height:"100%",padding:"2px"},colorClass:"rejected"},C.ag.removedForViolation);this.element.appendChild(e),this.rejected=!0}},{key:"removeElement",value:function(){var e,t=this;(0,r.Z)((0,d.Z)(n.prototype),"removeElement",this).call(this),(0,S.GY)(1,L-1).then((function(e){var i;if(e.length>0){var o=new n(Promise.resolve(e[0]),t.parentDock);t.parentDock.addItem(o,!0)}null===(i=t.parentDock)||void 0===i||i.setScrollButtonVisibility()})),this.loadingSpinner.style.display="none",null===(e=this.parentDock)||void 0===e||e.setScrollButtonVisibility()}}]),n}(D),_=function(e){(0,c.Z)(n,e);var t=M(n);function n(e){var i;return(0,a.Z)(this,n),(i=t.call(this,e)).element.style.boxSizing="border-box",i.element.style.borderTopLeftRadius="4px",i.element.style.borderTopRightRadius="4px",i.element.style.borderBottom="none",i.element.dataset.testid="staged-image-dock",(0,T.vP)(i.element,"SelectedMediaDock"),i}return(0,l.Z)(n,[{key:"addItem",value:function(e){this.dock.addChild(e)}},{key:"getImageById",value:function(e){return(0,r.Z)((0,d.Z)(n.prototype),"getImageById",this).call(this,e)}},{key:"showIfNonempty",value:function(){this.isEmpty()||this.show()}},{key:"hideIfEmpty",value:function(){this.isEmpty()&&this.hide()}},{key:"onHide",value:function(){this.clear()}},{key:"dispose",value:function(){this.listeners.removeAll()}}]),n}(O),N=function(e){(0,c.Z)(n,e);var t=M(n);function n(e,i){return(0,a.Z)(this,n),t.call(this,e,i)}return(0,l.Z)(n,[{key:"remove",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.removeElement(),this.parentDock.setScrollButtonVisibility(),this.parentDock.hideIfEmpty(),t||null===(e=this.sibling)||void 0===e||e.deselect(!0)}},{key:"markRejected",value:function(){this.remove()}}]),n}(D);function j(e,t){if(S.$r){var n=(0,x.vz)("div",{style:{position:"absolute",top:"0",left:"0",boxSizing:"border-box",height:"100%",width:"100%",background:"rgba(0,0,0,0.5)",padding:"10px",display:"none",zIndex:1e3}},(0,x.vz)("div",{style:{border:"3px dashed white",padding:"10px",height:"calc(100% - 26px)"}}));e.appendChild(n),(0,m.Zf)(["dragenter","dragover","dragleave","drop"],e,(function(e){e.preventDefault(),e.stopPropagation()})),(0,m.Zf)(["dragenter","dragover"],e,(function(e){e.dataTransfer&&e.dataTransfer.types.includes("Files")&&(n.style.display="block")})),(0,m.Zf)(["dragleave","drop"],n,(function(e){n.style.display="none"})),(0,m.j9)("drop",n,(function(e){var n,i,o=Array.from(null!==(n=null===(i=e.dataTransfer)||void 0===i?void 0:i.files)&&void 0!==n?n:[]);S.zB.fire({toUser:t,files:o})}))}}},3871:function(e,t,n){"use strict";n.d(t,{s:function(){return x}});var i=n(126),o=n(4649),r=n(7791),s=n(2951),a=n(1976),l=n(824),c=n.n(l),u=n(8759),d=n(1522),h=n(8263),f=n(3543),p=n(47),m=n(8213),v=n(6208),g=n(9809);function y(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=function(){function e(t){var n,i=this;(0,s.Z)(this,e),this.mediasetProps=t,this.element=(0,p.vz)("div",null),this.unopened=new Map,this.thumbnails=new Map,T(),e.messageLedger.has(t.messageId)||e.messageLedger.set(t.messageId,[]),null===(n=e.messageLedger.get(t.messageId))||void 0===n||n.push(this),this.mediasetProps.mediaList.forEach((function(t){var n,o=i.createThumbnail(t);i.element.appendChild(o),i.thumbnails.set(t.mediaId,o),e.mediaLedger.has(t.mediaId)||e.mediaLedger.set(t.mediaId,[]),null===(n=e.mediaLedger.get(t.mediaId))||void 0===n||n.push(i)}))}return(0,a.Z)(e,[{key:"createThumbnail",value:function(e){var t,n,o=this;if(""===e.url){var s=(0,p.vz)("div",{style:g.Q1});return k(s),s}var a=!1,l=function(){var e=(0,r.Z)(c().mark((function e(n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,u.w1)()){e.next=5;break}return e.next=3,new Promise((function(e){return window.setTimeout(e,300)}));case 3:if(!a){e.next=5;break}return e.abrupt("return");case 5:k(t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(t=(0,p.vz)("div",{style:g.Q1},(0,p.vz)(v.I,{extraStyle:{background:"rgba(0,0,0,0.6)"}}),(0,p.vz)("img",{src:e.thumbnailUrl,ref:function(e){return n=e},style:{position:"absolute",maxHeight:"100%"},onLoad:function(){if(a=!0,!0!==e.opened)if(o.mediasetProps.outgoing){var i=function(){var e=document.createElement("span");return e.innerText=f.ag.unopenedCAPS,(0,h.Zs)(e,{color:"#FFFFFF",backgroundColor:"#2067AB",fontFamily:"'UbuntuBold', Arial, Helvetica, sans-serif",fontSize:"8px",position:"absolute",bottom:"2px",right:"2px",padding:"0px 1px",zIndex:1}),e}();o.unopened.set(e.mediaId,i),t.appendChild(i)}else{var r=function(e){var t=document.createElement("canvas"),n=t.getContext("2d"),i=e.width,o=e.height;t.width=i,t.height=o;return n.drawImage(e,0,0,8,8),n.imageSmoothingEnabled=!1,n.drawImage(t,0,0,8,8,0,0,t.width,t.height),t}(n);r.style.zIndex="1000",r.style.position="absolute",o.unopened.set(e.mediaId,r),t.insertBefore(r,t.firstChild)}},onError:l}))).onclick=function(){var t=C(C({},o.mediasetProps),{},{mediaList:(0,i.Z)(o.mediasetProps.mediaList)});g.kK.loadMedia(t,e)},t}},{key:"deleteMedia",value:function(e){this.mediasetProps.mediaList=this.mediasetProps.mediaList.filter((function(t){return t.mediaId!==e}));var t=this.thumbnails.get(e);void 0!==t&&k(t)}}],[{key:"markOpened",value:function(t,n){var i,o,r=y(null!==(i=e.messageLedger.get(t))&&void 0!==i?i:[]);try{for(r.s();!(o=r.n()).done;){var s=o.value;if(void 0!==s){var a,l=s.unopened.get(n);null==l||null===(a=l.parentElement)||void 0===a||a.removeChild(l),s.unopened.delete(n)}}}catch(e){r.e(e)}finally{r.f()}}},{key:"deleteMediasetsMedia",value:function(t){var n,i,o=y(null!==(n=e.mediaLedger.get(t))&&void 0!==n?n:[]);try{for(o.s();!(i=o.n()).done;)i.value.deleteMedia(t)}catch(e){o.e(e)}finally{o.f()}}}]),e}();function k(e){for(var t=(0,p.vz)("img",{src:"".concat(STATIC_URL_ROOT,"images/no_thumbnail_1.jpg"),style:{position:"absolute",maxHeight:"100%",left:"-9px"}});null!==e.firstChild;)e.removeChild(e.firstChild);e.appendChild(t),e.onclick=function(){(0,d.Cj)(f.ag.errorLoadingMedia)}}x.messageLedger=new Map,x.mediaLedger=new Map;var S=!1;function T(){S||(m.zA.listen((function(e){x.deleteMediasetsMedia(e)})),m.lk.listen((function(e){x.deleteMediasetsMedia(e)})),S=!0)}},4463:function(e,t,n){"use strict";n.d(t,{E:function(){return l}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597);var l=function(e){(0,r.Z)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function c(e){var t;return(0,i.Z)(this,c),(t=l.call(this)).config=e,t.openConversationElement=document.createElement("a"),t.openConversationElement.style.textDecoration="none",t.openConversationElement.innerText=" (open conversation)",t.openConversationElement.style.cursor="pointer",t.openConversationElement.className="pmChatLink",t.openConversationElement.onclick=function(e){e.stopPropagation(),t.config.onClick()},t}return(0,o.Z)(c,[{key:"forceClick",value:function(){this.config.onClick()}}]),c}(n(9).w)},8642:function(e,t,n){"use strict";n.d(t,{OF:function(){return y},is:function(){return m},mq:function(){return g},sD:function(){return v}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(9),c=n(1794),u=n(3543),d=n(47),h=n(2800),f=n(1006),p=n(1359);var m=new c.xB("goPMList"),v=new c.xB("ignoreUser"),g=function(e){(0,r.Z)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function c(e,t){var n;(0,i.Z)(this,c),n=l.call(this);var o={marginLeft:"8px",display:t===h.q.getState().room?"none":""};return n.element=(0,d.vz)("div",{colorClass:"PMControlBar",style:{width:"100%",height:"31px",lineHeight:"32px",borderBottomWidth:"1px",borderBottomStyle:"solid",fontSize:"12px",justifyContent:"flex-start"},id:"pm-control-bar"},(0,d.vz)("span",{colorClass:"backButton",style:{marginLeft:"10px",cursor:"pointer"},onClick:function(){m.fire(e)},"data-testid":"back-to-conversation-list-button"},u.ag.back),(0,d.vz)("span",{style:o},u.ag.ctrlLToClose),(0,f.gH)()&&(0,d.vz)(p.T,{classRef:function(e){return n.inRoomIndicator=e},username:t,style:{marginTop:"8px"}})),n.element.classList.add("pm-control-bar"),n}return(0,o.Z)(c,[{key:"dispose",value:function(){var e;null===(e=this.inRoomIndicator)||void 0===e||e.dispose()}}]),c}(l.w),y=(0,o.Z)((function e(){var t=this;(0,i.Z)(this,e),this.showing=!1,this.getElement=function(){return t.element},this.isShowing=function(){return t.showing},this.hideLoading=function(){t.element.style.display="none",t.showing=!1},this.showLoading=function(){t.element.style.display="block",t.showing=!0},this.element=(0,d.vz)("div",{style:{display:"none",textAlign:"center"}},u.ag.loadingMoreMessages)}))},8525:function(e,t,n){"use strict";n.d(t,{E:function(){return v}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(8759),c=n(8069),u=n(9),d=n(1794),h=n(3705),f=n(3543),p=n(47),m=n(2800);var v=function(e){(0,r.Z)(v,e);var t,n,u=(t=v,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function v(e){var t;return(0,i.Z)(this,v),(t=u.call(this,"div",e)).listenerGroup=new d.mM,t.events={navigateSuggestions:new d.xB("navigateSuggestions"),openCurrentSuggestion:new d.xB("openCurrentSuggestion"),inputChange:new d.xB("inputChange"),suggestionActiveEvent:new d.xB("suggestionActiveEvent")},t.value="",t.events.suggestionActiveEvent.listen((function(e){var n=e.slug;t.input.value=""===n?t.value:n})).addTo(t.listenerGroup),t.debouncer=new c.d((function(){var n=t.value.match(/^[\w-]*$/);t.events.inputChange.fire({isFullVideo:e.isFullVideoMode,isValid:null!==n,prefix:t.value})}),{bounceLimitMS:100,debounceType:1}),t}return(0,o.Z)(v,[{key:"initUI",value:function(e){var t=this,n={background:"none",height:"24px",borderWidth:"1px",borderStyle:"solid",boxSizing:"border-box",borderRadius:"3px",margin:"0",padding:"5px 22px 5px 8px",width:"100%",outline:"none",fontFamily:"Tahoma, Arial, Helvetica, sans-serif",fontSize:m.J.current.isMobile?"16px":"12px"},i={height:"1em",margin:"auto",position:"absolute",right:"10px",top:m.J.current.isMobile?"7px":"10px"};this.element=(0,p.vz)("div",{colorClass:"SearchBar",style:{position:"relative",width:"100%",padding:"4px",boxSizing:"border-box",borderBottomWidth:"1px",borderBottomStyle:"solid"}},(0,p.vz)("input",{colorClass:"searchUserInput",className:"search_autocomplete",type:"text",placeholder:f.ag.searchUsers,style:n,onFocus:function(){var t=""===e.room?"PMWindow":"PMTab";(0,h.fg)("PMSearchStarted",{location:t})},onKeyDown:function(e){!function(e){return"ArrowDown"===e.key||"ArrowUp"===e.key||40===e.keyCode||38===e.keyCode}(e)?"Enter"!==e.key&&13!==e.keyCode||(e.preventDefault(),(0,l.s2)()&&t.input.blur(),t.events.openCurrentSuggestion.fire(void 0)):(e.preventDefault(),t.events.navigateSuggestions.fire({event:e}))},onInput:function(){var e=t.input.value.toLowerCase();t.value=e,t.input.value=e,t.debouncer.callFunc()},ref:function(e){return t.input=e}}),(0,p.vz)("img",{src:"".concat(STATIC_URL,"pms/icon-search.svg"),alt:"Search",style:i}))}},{key:"getInput",value:function(){return this.input}},{key:"focus",value:function(){this.input.focus()}},{key:"render",value:function(){return this.element}},{key:"clear",value:function(){this.input.value=""}},{key:"dispose",value:function(){this.listenerGroup.removeAll()}}]),v}(u.w)},8015:function(e,t,n){"use strict";n.d(t,{Cb:function(){return o},Kd:function(){return r},SO:function(){return a},Zn:function(){return c},gd:function(){return s},vz:function(){return l}});var i=n(1794),o=new i.xB("privateMessage"),r=new i.xB("directMessage"),s=new i.xB("showPmSession"),a=new i.xB("closePmSession"),l=new i.xB("allPmsRead"),c=new i.xB("allDmsRead")},322:function(e,t,n){"use strict";n.d(t,{_i:function(){return r},tS:function(){return l},yE:function(){return s}});var i=n(3543);function o(e){return"unknown"!==a(e)}function r(e){return void 0!==e&&o(e)}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown";if(void 0!==e){var n=a(e);if(o(n))return n.toLowerCase()}return t}function a(e){switch(e){case"Recommended":return"Recommended";case"Recommended_popular":return"Recommended_popular";default:return"unknown"}}function l(e){switch(e){case"recommended":return i.ag.recommendedCAPS;case"recommended_popular":return i.ag.recommendedPopularCAPS;default:return e}}},4189:function(e,t,n){"use strict";n.d(t,{bp:function(){return A},jD:function(){return R},dt:function(){return E},vx:function(){return I}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(7693),u=n(1903),d=n(7585),h=n(6921),f=n(1301),p=n(6422),m=n(3543),v=n(47),g=n(1185),y=n(6698),b=n(8945),w=n(322),C=n(8871);function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var k=function(e){(0,s.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function u(){return(0,i.Z)(this,u),r.apply(this,arguments)}return(0,o.Z)(u,[{key:"initUI",value:function(){var e,t=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(this.element.querySelectorAll("a"));try{for(t.s();!(e=t.n()).done;){var n=e.value;(0,g.vP)(n,g.ql.camSubjectTagColor),(0,c.j9)("click",n,(function(e){C.k4.fire(e)}))}}catch(e){t.e(e)}finally{t.f()}(0,y.Iu)(this.element)}},{key:"createElement",value:function(e){var t=(0,v.vz)("ul",{className:"subject ".concat(g.ql.camSubjectColor)},(0,v.vz)("li",{dangerouslySetInnerHTML:{__html:e.subject}}));return t.title=t.textContent,t}}]),u}(d.I);var S=function(e){(0,s.Z)(c,e);var t,n,r=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function c(){return(0,i.Z)(this,c),r.apply(this,arguments)}return(0,o.Z)(c,[{key:"createElement",value:function(e){var t=e.roomInfo.viewers,n=t>-1?m.ag.numViewerOrViewers(t):"",i=""!==n&&""!==e.roomInfo.timeOnline;return(0,v.vz)("div",{className:"details"},(0,v.vz)("div",{className:"cardTitle title"},(0,h.HK)((0,v.vz)("a",{href:"/".concat(e.roomInfo.room,"/"),"data-room":e.roomInfo.room,"data-room-nav":"true","data-testid":"room-card-username"},e.roomInfo.room)),(0,v.vz)("div",{className:"age_gender_container"},(0,v.vz)("span",{className:"age"},e.roomInfo.displayAge),(0,v.vz)("span",{className:"".concat(g.ql.camAltTextColor," ").concat(c.getGenderClassName(e.roomInfo.gender)),title:m.ag.genderSymbolToIconTitle(e.roomInfo.gender)}))),(0,v.vz)(k,{subject:e.roomInfo.subject}),(0,v.vz)("ul",{className:"sub-info ".concat(g.ql.camAltTextColor)},void 0!==e.roomInfo.location?(0,v.vz)("li",{className:"location",style:c.subInfoItemStyle},e.roomInfo.location):"",(0,v.vz)("li",{className:"cams ".concat(i?"":"no-viewers"),style:c.subInfoItemStyle},(0,v.vz)("span",{className:"time".concat(-1===e.roomInfo.viewers?" time-since":"")},e.roomInfo.timeOnline),(0,v.vz)("span",{className:"comma"},i?", ":""),(0,v.vz)("span",{className:"viewers"},n))))}}],[{key:"getGenderClassName",value:function(e){return e.includes("t")?"genders":"gender".concat(e)}}]),c}(d.I);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}function I(e){var t=function(e,t){var n=e.getNumber(t,!1);return isNaN(n)?-1:n},n=e.getString("label",!1),i=e.getNumberOrUndefined("start_timestamp",!1);return{room:e.getString("room",!1)||e.getString("username",!1),label:n,img:e.getString("img"),gender:e.getString("gender"),subject:e.getString("subject",!1)||e.getString("room_subject",!1),timeOnline:(0,u.J7)("offline"===n,0===i?void 0:i),viewers:Math.max(t(e,"viewers"),t(e,"num_users")),location:e.getStringOrUndefined("location"),displayAge:e.getStringWithNumbers("display_age",!1)||e.getStringWithNumbers("age",!1),isFollowing:e.getBoolean("is_following",!1,!1),sourceName:(0,y.AY)(e.getStringOrUndefined("source_name")),sourcePosition:e.getNumberOrUndefined("source_position"),sourceInfo:e.getStringOrUndefined("source_info"),startTimestamp:i}}S.subInfoItemStyle={whiteSpace:"nowrap"};var R=function(e){(0,s.Z)(n,e);var t=T(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"initUI",value:function(e){var t=this;this.props=e,this.setImageStreamer(),(0,c.Zf)(["click","mousedown","touchstart"],this.element,(function(e){t.fireBeforeRoomClick(e)}))}},{key:"fireBeforeRoomClick",value:function(e){e.target instanceof HTMLElement&&null!==e.target.getAttribute("data-room-nav")&&this.props.roomList.roomBeforeClickEvent.fire({index:this.props.roomIndex,roomInfo:this.props.roomInfo,event:e})}},{key:"fireRoomClick",value:function(e){e.target instanceof HTMLElement&&null!==e.target.getAttribute("data-room-nav")&&this.props.roomList.roomClickEvent.fire({index:this.props.roomIndex,roomInfo:this.props.roomInfo,event:e})}},{key:"onRoomClick",value:function(e){var t=this;this.element.querySelector("a[".concat(f.rt,"]"))?p.ly.listen((function(){return t.fireRoomClick(e)})):this.fireRoomClick(e)}},{key:"createElement",value:function(e){var t=this,i=(0,w.yE)(e.roomInfo.sourceInfo,e.roomInfo.label);return(0,v.vz)("li",{className:"roomCard ".concat(g.ql.camBgColor),style:n.roomStyle,onClick:function(e){return t.onRoomClick(e)}},(0,h.HK)((0,v.vz)("a",{href:"/".concat(e.roomInfo.room,"/"),"data-room-nav":"true","data-room":e.roomInfo.room},(0,v.vz)("img",{width:180,height:101,src:e.roomInfo.img,loading:"lazy",alt:e.roomInfo.room,"data-room-nav":"true",ref:function(e){t.img=e},className:"room_thumbnail"}))),(0,v.vz)(P,{roomLabel:i}),(0,v.vz)(S,{roomInfo:e.roomInfo}),this.createFollowStar(e))}},{key:"createFollowStar",value:function(e){var t=this;return(0,v.vz)(b.X,{slug:e.roomInfo.room,isFollowing:e.roomInfo.isFollowing,classRef:function(e){return t.followStar=e}})}},{key:"setImageStreamer",value:function(){var e=this;(0,c.j9)("mouseenter",this.element,(function(){(0,y.fr)()&&(e.img.removeAttribute("loading"),(0,y._M)(e.props.roomInfo.room,e.img))})),(0,c.j9)("mouseleave",this.element,(function(){(0,y.fr)()&&(0,y.E9)(e.props.roomInfo.room)}))}},{key:"afterRemovedFromParent",value:function(){(0,y.fr)()&&void 0!==this.props&&(0,y.E9)(this.props.roomInfo.room),(0,r.Z)((0,l.Z)(n.prototype),"afterRemovedFromParent",this).call(this)}},{key:"getRoomName",value:function(){return this.props.roomInfo.room}},{key:"updateFollowStar",value:function(e){var t;null===(t=this.followStar)||void 0===t||t.setFollowing(e)}}]),n}(d.I);R.labelTextMap={promoted:m.ag.promotedCAPS,recommended:m.ag.recommendedCAPS,recommended_popular:m.ag.recommendedPopularCAPS,offline:m.ag.offlineCAPS,exhib:m.ag.exhibitionistCAPS,new:m.ag.newCAPS,private:m.ag.inPrivateCAPS,gaming:m.ag.gamingCAPS},R.labelClassMap={promoted:"thumbnail_label thumbnail_label_c_promoted",offline:"thumbnail_label thumbnail_label_offline",exhib:"thumbnail_label thumbnail_label_exhibitionist",new:"thumbnail_label thumbnail_label_c_new",private:"thumbnail_label_featured thumbnail_label_c_private_show",gaming:"thumbnail_label thumbnail_label_c_gaming",recommended:"thumbnail_label thumbnail_label_c thumbnail_label_recommender",recommended_popular:"thumbnail_label thumbnail_label_c thumbnail_label_recommender"},R.roomStyle={margin:"0 7px 7px 0"};var P=function(e){var t,n;return(0,v.vz)("div",{className:null!==(t=R.labelClassMap[e.roomLabel])&&void 0!==t?t:"thumbnail_label"},null!==(n=R.labelTextMap[e.roomLabel])&&void 0!==n?n:"")},M=function(e){(0,s.Z)(n,e);var t=T(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"initUI",value:function(e){}},{key:"createElement",value:function(e){return(0,v.vz)("li",{className:"roomCard placeholder ".concat(g.ql.camBgColor),style:R.roomStyle},(0,v.vz)("a",null,(0,v.vz)("div",{className:"room_thumbnail"})),(0,v.vz)("div",{className:"details"},(0,v.vz)("div",{className:"title"},"Â "),(0,v.vz)("div",{className:"subject"},"Â "),(0,v.vz)("div",{className:"sub-info"},"Â ")))}}]),n}(R),A={roomList:{},roomIndex:0,roomInfo:{},animate:!1},E=function(){return new M(A)}},9808:function(e,t,n){"use strict";n.d(t,{P:function(){return C},x:function(){return x}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(7654),u=n(3753),d=n(391),h=n(7585),f=n(1794),p=n(3340),m=n(4043),v=n(9545),g=n(47),y=n(949),b=n(2800),w=n(6698);var C=function(e){(0,s.Z)(C,e);var t,n,h=(t=C,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function C(e){var t;return(0,i.Z)(this,C),(t=h.call(this,e)).rooms=[],window.addEventListener("pageshow",(function(){t.updateFollowStars()})),t}return(0,o.Z)(C,[{key:"createElement",value:function(){return(0,g.vz)("ul",{className:"list"})}},{key:"initData",value:function(e){this.listeners=new f.mM}},{key:"initUI",value:function(e){var t=this;(0,r.Z)((0,l.Z)(C.prototype),"initUI",this).call(this,e),this.roomListProps=e,this.roomClickEvent=new f.xB("roomClick"),this.listeners.add(this.roomClickEvent.listen((function(e){var t=e.event;t.ctrlKey||t.metaKey||t.shiftKey||(b.J.current.isMobile?m.WP.fire(e.roomInfo.room):(e.event.preventDefault(),p.WP.fire(e.roomInfo.room)))}))),this.roomBeforeClickEvent=new f.xB("roomBeforeClick"),this.listeners.add(this.roomBeforeClickEvent.listen((function(n){t.saveRoomListSourceCookie(n,e)}))),this.updateShowLocation(e.showLocation),this.listeners.add(y.J.listen((function(e){return t.updateShowLocation(e)})))}},{key:"saveRoomListSourceCookie",value:function(e,t){var n="un"===e.roomInfo.sourceName?t.roomListSource:e.roomInfo.sourceName;(0,w.bc)(e.roomInfo.room,n,e.index,this.getOptionalSourceInfo(e,t))}},{key:"getOptionalSourceInfo",value:function(e,t){return{sourceIndex:void 0===t.sourceIndex?e.roomInfo.sourcePosition:t.sourceIndex(e),hashtag:void 0===t.hashtag?void 0:t.hashtag(e),sourceInfo:void 0===t.sourceInfo?void 0:t.sourceInfo(e)}}},{key:"updateState",value:function(){(0,r.Z)((0,l.Z)(C.prototype),"updateState",this).call(this),this.resetRooms(),this.updateFollowStars()}},{key:"resetRooms",value:function(){var e=this;this.removeAllChildren(),this.rooms=[];var t=this.roomListProps.rooms(),n=!1;t.forEach((function(t,i){e.appendRoomCard(i+1,t),n=n||void 0!==t.location})),x(this.element,n&&this.showLocation)}},{key:"appendRoomCard",value:function(e,t){var n=this.createRoomCard({roomList:this,roomIndex:e,roomInfo:t,animate:(0,w.fr)()});this.rooms.push(n),this.addChild(n)}},{key:"updateShowLocation",value:function(e){this.showLocation=e,x(this.element,e)}},{key:"updateFollowStars",value:function(){var e=this;if(void 0!==b.J.current.loggedInUser&&!(0,c.RT)()&&0!==this.rooms.length){var t=this.rooms.map((function(e){return e.getRoomName()})),n="api/ts/follow/followed_usernames/?usernames=".concat(encodeURIComponent(t.join(",")));(0,u.Ue)(n).then((function(t){var n=new d.j(t.responseText).getStringList("followed_usernames"),i=new Set(n);e.rooms.forEach((function(e){e.updateFollowStar(i.has(e.getRoomName()))}))})).catch(v.Gr)}}},{key:"dispose",value:function(){this.listeners.removeAll()}}]),C}(h.I);function x(e,t){t?e.classList.add("show-location"):e.classList.remove("show-location")}},3515:function(e,t,n){"use strict";n.d(t,{G:function(){return g},x:function(){return v}});var i=n(126),o=n(5809),r=n(2951),s=n(1976),a=n(7591),l=n(9492),c=n(7597),u=n(7654),d=n(7585),h=n(1794),f=n(3543),p=n(47),m=n(9395);var v=new h.xB("updateNoResultsMessage"),g=function(e){(0,a.Z)(g,e);var t,n,d=(t=g,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function g(){return(0,r.Z)(this,g),d.apply(this,arguments)}return(0,s.Z)(g,[{key:"createElement",value:function(){return(0,p.vz)("div",{className:"searching-keyword"})}},{key:"initData",value:function(e){this.listeners=new h.mM}},{key:"initUI",value:function(){var e=this;this.updateMessage(),this.listeners.add(m.Mj.onSubmit.listen((function(t){e.updateMessage(t)}))),this.listeners.add(v.listen((function(t){0!==t.length&&e.updateNoSearchResultsMessage(t)})))}},{key:"updateMessage",value:function(e){var t=(0,u.SW)(),n=(0,u.Zv)(e),r=(0,o.Z)(n,2),s=r[0],a=r[1];if(0===s.length&&0===a.length)this.removeAllDOMChildren();else{var l=a.map((function(e){return"#".concat(e)}));Boolean(t)&&l.push("#".concat(t));var c=[].concat((0,i.Z)(s),(0,i.Z)(l)).join(" ");this.removeAllDOMChildren(),this.element.appendChild((0,p.vz)("p",null,f.ag.searchResultsFor(c)))}}},{key:"updateNoSearchResultsMessage",value:function(e){var t=document.querySelector(".endless_page_template .no-rooms-available");null!==t&&(t.textContent=this.constructNoResultsMessage(e))}},{key:"constructNoResultsMessage",value:function(e){var t=(0,u.SW)(),n=(0,u.Zv)(e),r=(0,o.Z)(n,2),s=r[0],a=r[1].map((function(e){return"#".concat(e)}));Boolean(t)&&a.push("#".concat(t));var l=[].concat((0,i.Z)(s),(0,i.Z)(a)).join(" ");return f.ag.noSearchResultsMatch(l)}},{key:"dispose",value:function(){this.listeners.removeAll()}}]),g}(d.I)},8871:function(e,t,n){"use strict";n.d(t,{$n:function(){return d},Ek:function(){return m},M4:function(){return p},Me:function(){return h},e2:function(){return g},k4:function(){return f},qh:function(){return y}});var i=n(7654),o=n(6767),r=n(1794),s=n(9165),a=n(8978),l=n(3543),c=n(2800),u=n(1612);function d(){var e=[],t=(0,i.SW)(),n=(0,s.ej)(),o=u.w.siteName;return void 0!==t&&e.push(l.ag.roomlistPageTitleHashtag((0,a.Qs)(t),o)),n===s.Y0.Female?e.push(l.ag.roomlistPageTitleFemale(o)):n===s.Y0.Male?e.push(l.ag.roomlistPageTitleMale(o)):n===s.Y0.Couple?e.push(l.ag.roomlistPageTitleCouple(o)):n===s.Y0.Trans||n===s.Y0.OldTrans?e.push(l.ag.roomlistPageTitleTrans(o)):void 0!==t||(0,i.I5)()||e.push(l.ag.roomlistPageTitleDefault(o)),(0,i.I5)()&&e.push(l.ag.roomlistPageTitlePremium(o)),e.join(" ")}var h=new r.xB("genderFilterUpdateFromNav"),f=new r.xB("spaNavigation"),p=new r.xB("newSpaLoad"),m="data-roomlist-spa-nav",v="jnoldsms";function g(){(0,o.Uj)(v,"1")}function y(e){return!(void 0!==e&&(e.classList.contains("nooverlay")||e.classList.contains("purchase_tokens")||"#"===e.getAttribute("href"))||void 0!==c.J.current.loggedInUser||"1"===(0,o.sv)(v))}},6079:function(e,t,n){"use strict";n.d(t,{M:function(){return Y},D:function(){return ee}});var i=n(3243),o=n(2951),r=n(1976),s=n(7591),a=n(9492),l=n(7597),c=n(8759),u=n(7693),d=n(1522),h=n(3753),f=n(391),p=n(4406),m=n(4411),v=n(1090),g=n(2008),y=n(9),b=n(5392),w=n(1794),C=n(5726),x=n(3705),k=n(710),S=n(6893),T=n(928),I=n(9584),R=n(5190),P=n(758),M=n(3543),A=n(2750),E=n(7906),B=n(1185),L=n(2800),O=n(8016),D=[];function U(e){if(!D.some((function(t){return t.getUserUid()===e}))){var t=new O.Xv(e);t.enterPresence(),D.push(t)}}function Z(e){void 0!==e?D=D.filter((function(t){return t.getUserUid()!==e||(t.leavePresence(),!1)})):(D.forEach((function(e){e.leavePresence()})),D=[])}var F=n(7376),_=n(9760),N=n(7397),j=n(1994),H=n(6547);function z(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return W(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var q=9/16,K="smcPlayerSettings",J=new w.xB("stopCamRequest"),G=new w.xB("shutdownCamRequest"),Y=function(e){(0,s.Z)(n,e);var t=V(n);function n(e){var i,r;(0,o.Z)(this,n),(r=t.call(this)).roomChatConn=e,r.camUserInfos=new Map,r.cams=new Map,r.dummyRoomStatusNotifier=new I.w(!1),r.noticeRateLimits=new Map,r.height=0,r.bottom=16,r.cachedBottom=r.bottom,r.right=16,r.width=208,r.numCams=0,r.listenedForPublicStatus=!1,r.viewCamFailedListeners=new Map,(0,B.vP)(r.element,"SmcBroadcaster"),r.getSettingsLocalstorage(),r.element.style.display="none",r.element.style.width="".concat(r.width,"px"),r.element.style.height="",r.element.style.position="fixed",r.element.style.right="".concat(r.right,"px"),r.element.style.overflow="visible",r.element.style.zIndex="".concat(H.AR),r.recalcPosition(),(0,u.j9)("scroll",window,(function(){r.recalcPosition()})),_.nR.listen((function(){r.recalcPosition()})),r.playerContainer=document.createElement("div"),r.playerContainer.style.display="table-cell",r.playerContainer.style.verticalAlign="bottom",r.playerContainer.style.width="100%",r.element.appendChild(r.playerContainer),r.addDrag(),r.addResize();var s=null===(i=L.J.current.loggedInUser)||void 0===i?void 0:i.userUid;void 0!==s&&new O.Wg(s).onMessage.listen((function(e){e.started?O.xp.fire(e):O.yK.fire(e)}));var a=new Set;return O.xp.listen((function(e){if(2===r.getCamState(e.username)&&!a.has(e.username)){a.add(e.username);var t=!1,n=!1,i=10,o=O.yK.listen((function(t){t.username===e.username&&(n=!0,o.removeListener())}),!1),s=window.setInterval((function(){if(t||n||i<=0)return clearInterval(s),a.delete(e.username),o.removeListener(),void(t&&!n&&(r.camUserInfos.set(e.username,e),r.setCamState(e.username,1)));i-=1,(0,H.cr)(e.username).then((function(e){t=e})).catch((function(){}))}),1e3);(0,H.cr)(e.username).then((function(e){t=e})).catch((function(){}))}})),O.yK.listen((function(e){var t=e.username,n=r.cams.get(t);r.camUserInfos.set(e.username,e),void 0!==(null==n?void 0:n.player)&&r.stopViewingCam(t),r.setCamState(t,2)})),r.roomChatConn.event.statusChange.listen((function(e){"privatewatching"===e.currentStatus&&r.endAllCamsExcept(r.roomChatConn.getPrivateShowUser())})),window.setInterval((function(){r.monitorInactive()}),3e4),E.c6.listen((function(t){t?r.listenedForPublicStatus||e.event.statusChange.listen((function t(n){if("public"===n.currentStatus){e.event.statusChange.removeListener(t),r.listenedForPublicStatus=!0;var i=[],o=O.yK.listen((function(e){i.push(e.username)}));(0,h.Ue)("api/ts/chat/share-my-cam/").then((function(e){var t=new f.j(e.responseText).getList("shared_rooms");if(void 0!==t){var n,r=z(t);try{for(r.s();!(n=r.n()).done;){var s=n.value;-1===i.indexOf(s.getString("username"))&&O.xp.fire((0,H.pb)(s))}}catch(e){r.e(e)}finally{r.f()}}o.removeListener()})).catch((function(){}))}})):(r.stopAllCams(),r.listenedForPublicStatus=!1)})),J.listen((function(e){r.stopViewingCam(e.username)})),G.listen((function(e){var t=r.cams.get(e);void 0!==(null==t?void 0:t.player)&&r.stopViewingCam(e),r.setCamState(e,2)})),(0,u.j9)("beforeunload",window,(function(){r.stopAllCams()})),r.noticeRateLimitSetting=L.q.getState().userChatSettings.c2cNotificationLimit,P.gO.listen((function(e){r.noticeRateLimitSetting=e.c2cNotificationLimit;var t,n=z(r.noticeRateLimits.keys());try{for(n.s();!(t=n.n()).done;){var i=t.value;r.unsetNoticeRateLimit(i)}}catch(e){n.e(e)}finally{n.f()}})),N._j.listen((function(){r.recalcPosition()})),p.x.registerGenerator("smcBadge",(function(e){return r.createChatBadge(e)})),r}return(0,r.Z)(n,[{key:"addDrag",value:function(){var e=this;(0,b.T)(this.playerContainer,(function(t,n,i){var o=e.getCorrectedRight(e.right),r=e.getCorrectedBottom(e.bottom),s=o,a=r,l=n,c=i,u=!1;return{enabled:!0,move:function(t,n){var i=t-l,d=n-c;!u&&(Math.abs(i)>5||Math.abs(d)>5)&&(u=!0,e.forEachPlayer((function(e,t){t.setDragging(!0)}))),a=e.getCorrectedBottom(r-d),s=e.getCorrectedRight(o-i),e.element.style.bottom="".concat(a,"px"),e.element.style.right="".concat(s,"px"),e.forEachPlayer((function(e,t){t.positionChanged()}))},end:function(){e.right=s,e.bottom=a,e.cachedBottom=a,e.saveSettingsLocalstorage(),u=!1,window.setTimeout((function(){e.forEachPlayer((function(e,t){t.setDragging(!1)}))}),100)}}}))}},{key:"addResize",value:function(){var e=this;(0,F.$)(this.element,(function(t){return function(n,i,o){n.stopPropagation();var r={initialBottom:e.bottom,initialRight:e.right,initialWidth:e.width,initialX:i,initialY:o,minWidth:200,ratio:q},s=e.right,a=e.bottom,l=e.width;return{enabled:!0,move:function(n,i){var o=(0,F.G)(r,n,i,t),c=[o.right,o.bottom,o.width];s=c[0],a=c[1],l=c[2],s=e.getCorrectedRight(s,l),e.element.style.right="".concat(s,"px"),e.element.style.width="".concat(l,"px"),e.forEachPlayer((function(e,t){t.updateHeight()}));var u=e.element.offsetHeight;a=e.getCorrectedBottom(a,u),e.element.style.bottom="".concat(a,"px"),e.forEachPlayer((function(e,t){t.positionChanged()}))},end:function(){e.bottom=a,e.cachedBottom=a,e.right=s,e.width=l,e.height=e.element.getBoundingClientRect().height,e.saveSettingsLocalstorage()}}}}))}},{key:"getCorrectedBottom",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.height;return Math.max(0,Math.min(window.innerHeight-t,e))}},{key:"getCorrectedRight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.width;return Math.max(0,Math.min(window.innerWidth-t,e))}},{key:"recalcPosition",value:function(){var e=(0,j.p)();this.bottom=e>0?Math.max(this.cachedBottom,e+4):this.cachedBottom,this.element.style.bottom="".concat(this.getCorrectedBottom(this.bottom),"px"),this.element.style.right="".concat(this.getCorrectedRight(this.right),"px")}},{key:"getSettingsLocalstorage",value:function(){if((0,c.IU)()){var e=window.localStorage.getItem(K);if(null!==e){var t=JSON.parse(e);this.bottom=t.bottom,this.cachedBottom=t.bottom,this.right=t.right,this.width=t.width}}}},{key:"saveSettingsLocalstorage",value:function(){if((0,c.IU)()){var e={bottom:this.bottom,right:this.right,width:this.width};window.localStorage.setItem(K,JSON.stringify(e))}}},{key:"startViewingCam",value:function(e){var t=this;return this.unsetNoticeRateLimit(e),this.numCams>=5?((0,d.Cj)(M.ag.showMyCamTooManyCams),(0,x.fg)("SharedCamViewStartFailed",{cam_user:e}),void(0,x.fg)("SharedCamViewStartTooManyCams",{cam_user:e})):2===this.getCamState(e)?(error("smcBroadcaster - no such cam"),void(0,x.fg)("SharedCamViewStartFailed",{cam_user:e})):void(0,H.cr)(e).then((function(n){n?(0,T.ss)(e).then((function(n){var i=t.cams.get(e);if(void 0===i||void 0===i.player){t.element.style.display="table";var o=new $(n,t.roomChatConn,t.dummyRoomStatusNotifier);t.playerContainer.appendChild(o.element),o.updateHeight(),o.startViewing(),t.numCams+=1,t.height=t.element.getBoundingClientRect().height,t.recalcPosition(),(0,x.fg)("SharedCamViewStarted",{cam_user:e,num_cams_open:t.numCams}),t.setCamState(e,1,o);var r=window.setTimeout((function(){var n=t.cams.get(e);void 0!==(null==n?void 0:n.player)&&t.stopViewingCam(e),s.removeListener(),(0,x.fg)("SharedCamViewStartFailed",{cam_user:e})}),1e3*(S.g1-1)),s=o.playerComponent.playbackStart.once((function(){var i=t.cams.get(e);if(void 0!==i&&o===i.player){var s;t.setCamState(e,0,o),U(n.roomUid),null===(s=t.viewCamFailedListeners.get(e))||void 0===s||s.removeListener();var a=new O.Xv(n.roomUid).onAuthFail.listen((function(){0===t.getCamState(e)&&(t.stopViewingCam(e),(0,d.Cj)(M.ag.showMyCamCouldNotView))}));t.viewCamFailedListeners.set(e,a),clearTimeout(r)}})),a=o.playerComponent.videoOfflineChange.listen((function(n){n&&(t.stopViewingCam(e),a.removeListener())}))}})).catch((function(){})):(t.setCamState(e,2),(0,d.Cj)(M.ag.showMyCamCamOffline),(0,x.fg)("SharedCamViewStartFailed",{cam_user:e}))})).catch((function(){}))}},{key:"stopViewingCam",value:function(e){var t,n=this;null===(t=this.viewCamFailedListeners.get(e))||void 0===t||t.removeListener();var i=this.getCamState(e),o=this.cams.get(e);if((0,R.s6)(!1,1),void 0!==o&&void 0!==o.player){o.player.stopViewing(),this.setCamState(e,1);var r=o.player;void 0!==o.player.reportMenu?o.player.reportMenu.closeChatReportRequest.once((function(){n.cleanUpCam(e,r)})):this.cleanUpCam(e,r)}else warn("stopViewingCam no player for cam",{camUser:e,state:i})}},{key:"cleanUpCam",value:function(e,t){t.element.style.height="0",t.element.style.width="0",this.numCams-=1,this.height=this.element.getBoundingClientRect().height,this.recalcPosition(),0===this.numCams&&(this.element.style.display="none"),(0,x.fg)("SharedCamPlayerRemoved",{cam_user:e,num_cams_open:this.numCams})}},{key:"forEachPlayer",value:function(e){var t,n=z(this.cams.keys());try{for(n.s();!(t=n.n()).done;){var i=t.value,o=this.cams.get(i);void 0!==o&&void 0!==o.player&&e(i,o.player)}}catch(e){n.e(e)}finally{n.f()}}},{key:"stopAllCams",value:function(){var e=this;this.forEachPlayer((function(t,n){e.stopViewingCam(t)}))}},{key:"endAllCamsExcept",value:function(e){var t,n=z(this.cams.keys());try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i!==e){var o=this.cams.get(i);void 0!==o&&void 0!==o.player&&this.stopViewingCam(i),this.setCamState(i,2)}}}catch(e){n.e(e)}finally{n.f()}}},{key:"monitorInactive",value:function(){var e,t=this,n=z(this.cams.keys());try{var i=function(){var n=e.value;2!==t.getCamState(n)&&(0,H.cr)(n).then((function(e){if(!e){var i=t.cams.get(n);void 0!==(null==i?void 0:i.player)&&t.stopViewingCam(n),t.setCamState(n,2)}})).catch((function(){}))};for(n.s();!(e=n.n()).done;)i()}catch(e){n.e(e)}finally{n.f()}}},{key:"getCamState",value:function(e){var t=this.cams.get(e);return void 0!==t?t.state:2}},{key:"setCamState",value:function(e,t,n){var i=this.camUserInfos.get(e),o=this.getCamState(e);switch(t){case 2:this.cams.delete(e),this.camUserInfos.delete(e),2!==o&&(0,x.fg)("SharedCamViewerBroadcastStopped",{cam_user:e,num_cams_total:this.cams.size});break;case 1:this.cams.set(e,{state:1,player:n}),2===o&&(0,x.fg)("SharedCamViewerBroadcastStarted",{cam_user:e,num_cams_total:this.cams.size});break;case 0:void 0!==n?this.cams.set(e,{state:0,player:n}):error("smcBroadcaster - no player provided for active cam")}this.updateChatBadges(e),void 0!==i&&this.sendChatNoticeForStateChange(i,o,t)}},{key:"sendChatNoticeForStateChange",value:function(e,t,n){var i;if(t!==n&&(2===t&&2!==n&&(i=this.getCamStartNotice(e.username)),void 0!==i)){var o=(0,C.Ng)(this.roomChatConn.room(),e);this.roomChatConn.event.roomNotice.fire({messages:[[(0,v.vK)("User "===o?M.ag.showMyCamSharingPrefix:o),(0,v.iL)(e),(0,v.vK)(i)]],showInPrivateMessage:!1})}}},{key:"getCamStartNotice",value:function(e){var t=this.noticeRateLimits.get(e);if(!0!==(null==t?void 0:t.preventStartNotice))return this.setNoticeRateLimit(e),M.ag.showMyCamStartedSharing}},{key:"setNoticeRateLimit",value:function(e){var t,n,i=this;switch(this.noticeRateLimitSetting){case"0":t=!1;break;case"300":t=!0,n=window.setTimeout((function(){return i.unsetNoticeRateLimit(e)}),3e5);break;case"-1":t=!0;break;default:error("smcBroadcaster - invalid rate limit setting",this.noticeRateLimitSetting),t=!1}this.noticeRateLimits.set(e,{preventStartNotice:t,timeout:n})}},{key:"unsetNoticeRateLimit",value:function(e){var t=this.noticeRateLimits.get(e);void 0!==t?(window.clearTimeout(t.timeout),this.noticeRateLimits.set(e,{preventStartNotice:!1})):error("smcBroadcaster - no notice rate limit to unset")}},{key:"getContextMenuLinkInfo",value:function(e){var t=this,n=this.getCamState(e);if(2===n)return{linkText:"",icon:"",action:function(){}};var i,o,r,s=this.cams.get(e);return o="".concat(STATIC_URL_ROOT,1===n?"broadcastassets/inactive-cam.svg":"broadcastassets/active-cam.svg"),void 0!==s&&void 0!==s.player?(i=M.ag.showMyCamStopView,r=function(){(0,x.fg)("SharedCamViewStopClicked",{cam_user:e}),t.stopViewingCam(e)}):(i=M.ag.showMyCamView,r=function(){(0,x.fg)("SharedCamViewStartClicked",{cam_user:e}),t.startViewingCam(e)}),{linkText:i,icon:o,action:r}}},{key:"createChatBadge",value:function(e){var t=this.getCamState(e),n=document.createElement("img");return n.style.marginRight=".2em",n.style.height="1.2em",n.style.position="relative",n.title=M.ag.sharingCam,2===t?n.style.display="none":n.src="".concat(STATIC_URL_ROOT,1===t?"broadcastassets/inactive-cam.svg":"broadcastassets/active-cam.svg"),n}},{key:"updateChatBadges",value:function(e){var t=this.getCamState(e),n=p.x.getBadgeElements("smcBadge",e),i="";1===t?i="".concat(STATIC_URL_ROOT,"broadcastassets/inactive-cam.svg"):0===t&&(i="".concat(STATIC_URL_ROOT,"broadcastassets/active-cam.svg"));for(var o=n.length-1;o>=0;o-=1){var r=n[o];r.src=i,r.style.display=""!==i?"":"none"}}}],[{key:"getOrCreateInstance",value:function(e){return void 0===n.singletonInstance&&(n.singletonInstance=new n(e)),n.singletonInstance}},{key:"getInstance",value:function(){return n.singletonInstance}}]),n}(y.w),$=function(e){(0,s.Z)(n,e);var t=V(n);function n(e,i,r){var s;(0,o.Z)(this,n),(s=t.call(this,!0,r)).camDossier=e,s.roomChatConn=i,s.dragging=!1,s.hideAllTooltips=new w.xB("hideAllTooltips"),s.blockMouseEvent=function(e){e.stopPropagation()},s.watermark.style.visibility="hidden",s.element.style.position="relative",s.element.style.width="100%",s.element.style.minWidth="".concat(200,"px"),s.element.style.backgroundColor="#000",s.element.style.border="1px solid #FFF",s.element.style.marginTop="-1px",s.element.style.overflow="visible",(0,u.j9)("mouseenter",s.element,(function(e){s.controls.style.display="block"})),(0,u.j9)("mouseleave",s.element,(function(e){s.controlsFrozen||(s.controls.style.display="none")}));var a=0;return(0,u.j9)("touchstart",s.element,(function(e){"none"===s.controls.style.display?(s.controls.style.display="block",a=1):a+=1})),(0,u.j9)("touchend",s.element,(function(e){window.setTimeout((function(){(a>1||s.dragging)&&!s.controlsFrozen&&(s.controls.style.display="none")}),0)})),(0,u.j9)("touchstart",document,(function(e){s.element.contains(e.target)||s.controlsFrozen||(s.controls.style.display="none")})),s.username=e.room,s.element.appendChild(s.createUsernameBar()),s.element.appendChild(s.createControls()),s.element.appendChild(s.createReportDiv()),s}return(0,r.Z)(n,[{key:"startViewing",value:function(){this.chatConn=new m.E(this.camDossier),this.playerComponent.handleRoomLoaded({dossier:this.camDossier,chatConnection:this.chatConn})}},{key:"stopViewing",value:function(){var e,t=this;this.playerComponent.stop(),void 0===this.popoutWindow||this.popoutWindow.closed||this.popoutWindow.close(),this.chatConn.leaveRoom(),Z(this.camDossier.roomUid),void 0!==this.reportMenu?(null!==(null===(e=this.usernameBar)||void 0===e?void 0:e.firstChild)&&(this.usernameBar.firstChild.textContent+=" ".concat(M.ag.showMyCamConnectionClosed)),this.reportMenu.closeChatReportRequest.once((function(){t.attemptRemoveFromDom()}))):this.attemptRemoveFromDom()}},{key:"setDragging",value:function(e){this.dragging=e}},{key:"reportCam",value:function(){var e=this,t=new Q(this,this.username,this.roomChatConn);t.closeChatReportRequest.listen((function(t){void 0!==e.reportMenu&&(e.reportDiv.removeChild(e.reportMenu.element),e.reportMenu.tearDown(),e.reportMenu=void 0),t?((0,x.fg)("SharedCamReportSent",{cam_user:e.username}),e.attemptRemoveFromDom()):(e.reportDiv.style.display="none",e.controls.style.display="none",e.hideAllTooltips.fire(!0),e.freezeControls(!1))})),this.freezeControls(!0),this.reportDiv.appendChild(t.element),this.reportMenu=t,this.reportDiv.style.display="block",this.reportMenu.focusForm()}},{key:"freezeControls",value:function(e){this.controlsFrozen=e,e?((0,u.j9)("mouseenter",this.element,this.blockMouseEvent,!0),(0,u.j9)("mouseleave",this.element,this.blockMouseEvent,!0)):((0,u.SC)("mouseenter",this.element,this.blockMouseEvent,!0),(0,u.SC)("mouseleave",this.element,this.blockMouseEvent,!0))}},{key:"popoutCam",value:function(){var e=this;if(void 0===this.popoutWindow||this.popoutWindow.closed){var t=(screen.width/2-425).toString(),n=(screen.height/2-384).toString(),i="resizable,dependent,scrollbars,height=".concat(768,",width=").concat(850,",top=").concat(n,",left=").concat(t);(0,A.MY)("/popout/".concat(this.username),"_blank",i).then((function(t){e.popoutWindow=t})).catch((function(){}))}else this.popoutWindow.focus()}},{key:"attemptRemoveFromDom",value:function(){null!==this.element.parentElement&&this.element.parentElement.removeChild(this.element)}},{key:"createUsernameBar",value:function(){var e=document.createElement("div");e.style.position="absolute",e.style.bottom="0px",e.style.width="100%",e.style.height="auto",e.style.minHeight="20px",e.style.maxHeight="40px",e.style.color="#FFF",e.style.backgroundColor="rgba(0, 0, 0, 0.4)",e.style.zIndex="".concat(H.AR);var t=document.createElement("span");return t.style.zIndex="".concat(H.AR),t.textContent=this.username,t.style.fontFamily="UbuntuRegular",t.style.fontSize="12px",t.style.color="#EEE",t.style.position="relative",t.style.left="5px",t.style.bottom="-3px",e.appendChild(t),this.usernameBar=e,e}},{key:"createControls",value:function(){var e=this,t=(0,H.kK)(),n=(0,H.vx)({iconAsset:"broadcastassets/close.svg",tooltipText:M.ag.showMyCamCloseCam,iconSize:23,centerTop:"50%",onClick:function(){e.controlsFrozen||e.dragging||((0,x.fg)("SharedCamViewStopClicked",{cam_user:e.username}),J.fire(e))},hideAllTooltips:this.hideAllTooltips});n.style.left="50%",n.style.transform="translateX(-50%) translateX(-50px)",t.appendChild(n);var i=(0,H.vx)({iconAsset:"tsdefaultassets/smc_popout.svg",tooltipText:M.ag.showMyCamPopoutCam,iconSize:23,centerTop:"50%",onClick:function(){e.controlsFrozen||e.dragging||e.popoutCam()},hideAllTooltips:this.hideAllTooltips});i.style.left="50%",i.style.transform="translateX(-50%)",t.appendChild(i);var o=(0,H.vx)({iconAsset:"broadcastassets/report.svg",tooltipText:M.ag.showMyCamReportCam,iconSize:23,centerTop:"50%",onClick:function(){e.controlsFrozen||e.dragging||e.reportCam()},hideAllTooltips:this.hideAllTooltips});return o.style.left="50%",o.style.transform="translateX(-50%) translateX(50px)",t.appendChild(o),this.controls=t,t}},{key:"createReportDiv",value:function(){var e=document.createElement("div");return(0,B.vP)(e,"reportDiv"),e.style.width="207px",e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.position="absolute",e.style.transform="translate(-100%, -100%) translateX(-5px)",e.style.borderRadius="4px",e.style.display="none",e.style.zIndex="999",e.style.fontWeight="normal",e.style.fontSize="12px",e.onmouseenter=function(){e.style.cursor="default"},this.reportDiv=e,e}},{key:"updateHeight",value:function(){this.element.style.height="".concat(this.element.offsetWidth*q,"px")}},{key:"positionChanged",value:function(){this.element.getBoundingClientRect().left-this.reportDiv.offsetWidth<0?this.reportDiv.style.transform="translateY(-100%) translateX(".concat(this.element.offsetWidth+5,"px)"):this.reportDiv.style.transform="translate(-100%, -100%) translateX(-5px)"}}]),n}(k.r),Q=function(e){(0,s.Z)(n,e);var t=V(n);function n(e,i,r){var s;return(0,o.Z)(this,n),(s=t.call(this,i,void 0,r)).cam=e,s.username=i,s.chatConnection=r,(0,u.j9)("touchstart",s.element,(function(e){e.stopPropagation()})),(0,u.j9)("mousedown",s.element,(function(e){e.stopPropagation()})),s}return(0,r.Z)(n,[{key:"categories",value:function(){return{public:M.ag.showMyCamReportPublic,rude:M.ag.showMyCamReportRude,intoxicated:M.ag.showMyCamReportIntoxicated,sleeping:M.ag.showMyCamReportSleeping,spam:M.ag.showMyCamReportSpamming,underage:M.ag.showMyCamReportUnderage,other:M.ag.reportMessageOther}}},{key:"reportEndpoint",value:function(){return"abuse/report/".concat(this.username,"/")}},{key:"additionalFinishReportLinks",value:function(){var e=this,t=this.chatConnection.room(),n=document.createElement("button"),i=document.createElement("button");return(0,B.vP)(n,B.ql.hrefColor),(0,B.vP)(i,B.ql.hrefColor),n.textContent=M.ag.silenceDurationMessage,i.textContent=M.ag.kickBan,i.dataset.testid="kick-ban",n.onclick=function(i){i.preventDefault(),(0,h.I5)("roomsilence/".concat(e.username,"/").concat(t,"/"),{}).catch((function(n){error("smcBroadcaster Unable to silence user",{room:t,username:e.username,reason:n.toString()}),(0,d.Cj)("Error silencing user ".concat(e.username))})),n.style.color="",n.style.cursor="",n.onclick=function(){}},i.onclick=function(o){o.preventDefault(),(0,h.I5)("roomban/".concat(e.username,"/").concat(e.chatConnection.room(),"/"),{}).catch((function(n){error("smcBroadcaster Unable to ban user",{room:t,username:e.username,reason:n.toString()}),(0,d.Cj)(M.ag.banUserError(e.username))})),n.style.color="",n.style.cursor="",n.onclick=function(){},i.style.color="",i.style.cursor="",i.onclick=function(){}},[n,i]}},{key:"onChatReportClosed",value:function(e){(0,i.Z)((0,l.Z)(n.prototype),"onChatReportClosed",this).call(this,e),e&&J.fire(this.cam)}}]),n}(g.P),X=!1;function ee(e,t){var n;X||(X=!0,""!==e.roomUid&&new O.Xv(e.roomUid).onAuthFail.listen((function(){t.stop(),(0,d.Cj)(M.ag.showMyCamCouldNotView),Z(e.roomUid)})),!0===(null===(n=L.J.current)||void 0===n||null===(n=n.loggedInUser)||void 0===n?void 0:n.isBroadcasting)&&(Z(),(0,h.Ue)("api/ts/chat/share-my-cam/").then((function(t){var n=new f.j(t.responseText).getList("shared_rooms");if(void 0!==n){var i,o=z(n);try{for(o.s();!(i=o.n()).done;)i.value.getString("username")===e.room&&U(e.roomUid)}catch(e){o.e(e)}finally{o.f()}}})).catch((function(){}))))}},6547:function(e,t,n){"use strict";n.d(t,{AR:function(){return r},Iu:function(){return c},ZL:function(){return h},b3:function(){return f},bG:function(){return u},cr:function(){return l},kK:function(){return s},pb:function(){return d},vx:function(){return a}});var i=n(7693),o=n(3753),r=1003;function s(){var e=document.createElement("div");return e.style.position="absolute",e.style.width="100%",e.style.height="100%",e.style.top="0px",e.style.left="0px",e.style.display="none",e.style.zIndex="".concat(r+1),e.style.backgroundColor="rgba(0, 0, 0, .3)",e.style.boxShadow="0px 0px 4px rgba(0, 0, 0, 0.5)",e}function a(e){var t=Math.floor(e.iconSize/2),n=document.createElement("div");n.style.display="inline-block",n.style.position="absolute",n.style.width=n.style.height="".concat(e.iconSize,"px"),n.style.top="calc(".concat(e.centerTop," - ").concat(t,"px)");var o=document.createElement("img");o.src="".concat(STATIC_URL_ROOT).concat(e.iconAsset),o.style.position="relative",o.style.height="100%",o.style.width="100%",o.style.zIndex="1",n.appendChild(o);var r=document.createElement("div");r.style.position="absolute",r.style.display="none",r.style.width="39px",r.style.height="39px",r.style.top="".concat(-19+t,"px"),r.style.left="".concat(-19+t,"px"),r.style.borderRadius="4px",r.style.zIndex="0",r.style.backgroundColor="rgba(255, 255, 255, .25)";var s=document.createElement("div");s.textContent=e.tooltipText,s.style.position="relative",s.style.display="inline-block",s.style.top="42px",s.style.left="50%",s.style.transform="translateX(-50%)",s.style.padding="0px 7px",s.style.whiteSpace="nowrap",s.style.fontFamily="UbuntuRegular",s.style.fontSize="12px",s.style.color="#FFF",s.style.backgroundColor="rgba(0, 0, 0, .9)",s.style.border="1px solid #8A8A8A",r.appendChild(s),n.appendChild(r),void 0!==e.hideAllTooltips&&e.hideAllTooltips.listen((function(){r.style.display="none"})),void 0!==e.onClick&&(o.style.cursor="pointer",(0,i.j9)("click",o,e.onClick)),(0,i.j9)("mouseenter",o,(function(){r.style.display="block"})),(0,i.j9)("mouseleave",o,(function(){r.style.display="none"}));var a=!1,l=function e(t){t.target!==o&&(r.style.display="none",a=!1,(0,i.SC)("touchstart",document,e,!0))};return(0,i.j9)("touchstart",o,(function(t){a?void 0!==e.onClick&&(0,i.w$)("touchend",o,e.onClick):(r.style.display="block",a=!0,(0,i.j9)("touchstart",document,l,!0),t.preventDefault(),t.stopPropagation())})),n}function l(e){return(0,o.Ue)("api/online/".concat(e,"/")).then((function(e){return JSON.parse(e.responseText).online}))}function c(){return(0,o.Ue)("api/ts/chat/share-my-cam/").then((function(e){var t=JSON.parse(e.responseText).cam_room;return t.length>0?t[0]:""}))}function u(e){!function t(){c().then((function(n){""===n?e():window.setTimeout(t,5e3)})).catch((function(){}))}()}function d(e){return{username:e.getString("username"),isBroadcaster:!1,inFanclub:e.getBoolean("in_fanclub"),hasTokens:e.getBoolean("has_tokens"),isMod:e.getBoolean("is_mod"),tippedRecently:e.getBoolean("tipped_recently"),tippedALotRecently:e.getBoolean("tipped_alot_recently"),tippedTonsRecently:e.getBoolean("tipped_tons_recently"),exploringHashTag:"",sourceName:"df"}}var h=!1;function f(){h=!0}},9784:function(e,t,n){"use strict";n.d(t,{RH:function(){return W},lO:function(){return q}});var i=n(3243),o=n(7591),r=n(9492),s=n(7597),a=n(2951),l=n(1976),c=n(8759),u=n(7693),d=n(1522),h=n(3753),f=n(391);var p=n(1986),m=n(7611),v=n(1090),g=n(4793),y=n(3149),b=n(5392),w=n(1794),C=n(1625),x=n(9874),k=n(3705),S=n(1809),T=n(3543),I=n(2750),R=n(6474),P=n(2915),M=n(1185),A=n(2800),E=n(8016),B=n(6265),L=n(9760),O=n(7397),D=n(1994),U=n(6547);function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,s.Z)(e);if(t){var o=(0,s.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,r.Z)(this,n)}}function F(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var N,j,H=5e3,z="smcBroadcastSettings";function W(){return N}(0,u.j9)("pageshow",window,(function(e){e.persisted&&void 0!==j&&j.stopCam()})),(0,S.hp)((function(){return new Promise((function(e,t){void 0!==j&&j.isBroadcasting()?(0,d.oB)(T.ag.showMyCamNavigationPrompt,(function(){void 0!==j?e(j.stopCam()):e()}),t):e()}))}));var V=new w.xB("showMyCamDidNotStart");function q(e,t){var n=new w.xB("requestChangeClickListener"),i=new w.xB("showMyCamStateChanged");return n.listen((function(t){e.onclick=t})),i.listen((function(t){switch(t){case"starting":case"inactiveStopped":e.textContent=T.ag.showMyCamShow,e.style.opacity="0.5",e.style.cursor="default";break;case"started":e.textContent=T.ag.showMyCamStop,e.style.opacity="1",e.style.cursor="pointer";break;case"stopped":e.textContent=T.ag.showMyCamShow,e.style.opacity="1",e.style.cursor="pointer"}})),function(e,t,n){return!(!(0,c.AQ)()||!p.nC.canUseWebRTC()||(g.kN.listen((function(o){if(void 0!==j&&o.chatConnection.room()!==j.roomChatConn.room()&&(j.cleanup(),j=void 0),o.chatConnection.viewerIsAnonymous())t.fire((function(){(0,B.iW)({})}));else{void 0===j&&(j=new K(o.chatConnection,e));var r=function e(){n.fire("starting"),t.fire((function(){})),void 0!==i&&i.removeListener(),i=V.listen((function(){n.fire("stopped"),t.fire(e)}),!1),(0,h.Ue)("api/ts/chat/can-share-cam/".concat(o.dossier.room,"/")).then((function(e){var t=new f.j(e.responseText);t.getBoolean("can_share")&&0===t.getStringList("shared_cam").length?void 0!==j&&j.startCam():(t.getBoolean("show_upsell")?(0,d.oB)(T.ag.showMyCamMayNotShareUpsell,(function(){var e="/tipping/purchase_tokens/?source=".concat(A.J.current.PurchaseEventSources.TOKEN_SOURCE_SHOW_MY_CAM);(0,k.fg)("SharedCamPurchaseTokensClicked"),(0,I.Pv)(e,"_blank","height=615, width=850, scrollbars=1")})):t.getBoolean("is_private")?(0,d.Cj)(T.ag.showMyCamMayNotShareIsPrivate):t.getStringList("shared_cam").length>0?((0,d.Cj)(T.ag.showMyCamAlreadyBroadcasting),(0,k.fg)("SharedCamAlreadySharing")):(0,d.Cj)(t.getString("message")),V.fire(void 0))})).catch((function(){}))};j.setOnStart((function(){n.fire("started"),t.fire((function(){(0,k.fg)("SharedCamBroadcastStopClicked"),void 0!==j&&j.stopCam(!0)}))})),j.setOnStop((function(){n.fire("inactiveStopped"),t.fire((function(){(0,d.Cj)(T.ag.showMyCamCooldownAlert(H/1e3))})),window.setTimeout((function(){n.fire("stopped"),t.fire((function(){r()}))}),H)})),t.fire((function(){r()}))}})),0));var i}(t,n,i)}var K=function(){function e(t,n){var i,o=this;(0,a.Z)(this,e),this.onStartBroadcast=[],this.onStopBroadcast=[],this.listenerGroup=new w.mM,this.startBroadcast=function(){if(void 0!==o.previewModal&&o.previewModal.hide(),(0,k.fg)("SharedCamBroadcastStartClicked"),o.roomOffline||o.chatOffline)return(0,d.Cj)(T.ag.showMyCamMustBeConnected),void V.fire(void 0);var e=o.onStopBroadcast;o.onStopBroadcast=[],o.stopCam().then((function(){o.onStopBroadcast=e;var t=!1,n=window.setTimeout((function(){void 0!==o.broadcastModal&&o.broadcastModal.stopBroadcast(),(0,k.fg)("SharedCamBroadcastStartTimedOut"),(0,d.Cj)(T.ag.showMyCamBroadcastTimeoutError),error("smcViewer - timeout starting cam"),t=!0}),2e4);(0,h.I5)("api/ts/chat/share-my-cam/",{username:o.roomChatConn.room()}).then((function(){if(!t){o.broadcastModal=new G(o.camDossier,o.constraints,o.broadcastStop,o.roomChatConn,n),o.broadcastModal.showBroadcast(),o.fullscreenChangeListener=C.gH.listen(o.broadcastModal.showBroadcast);var e,i=F(o.onStartBroadcast);try{for(i.s();!(e=i.n()).done;)(0,e.value)()}catch(e){i.e(e)}finally{i.f()}}})).catch((function(){t||((0,d.Cj)(T.ag.showMyCamBroadcastError),V.fire(void 0))}))})).catch((function(){}))},this.broadcastStop=function(){var e;void 0!==o.broadcastModal&&(null===(e=o.fullscreenChangeListener)||void 0===e||e.removeListener(),o.fullscreenChangeListener=void 0,o.broadcastModal.currentlyViewed&&o.roomChatConn.event.roomNotice.fire({messages:[[(0,v.iL)((0,R.iT)(o.roomChatConn.room())),(0,v.vK)(T.ag.showMyCamStoppedViewing)]],showInPrivateMessage:!0})),o.broadcastModal=void 0;var t,n=F(o.onStopBroadcast);try{for(n.s();!(t=n.n()).done;)(0,t.value)()}catch(e){n.e(e)}finally{n.f()}},this.roomChatConn=t,this.constraints={micId:"",camId:"",width:0,height:0,muted:!0},this.roomOffline=!0,n.listen((function(e){o.roomOffline=e,e&&o.stopCam()}),!1).addTo(this.listenerGroup),this.chatOffline=!0,t.event.statusChange.listen((function(e){switch(o.chatOffline="notconnected"===e.currentStatus,e.currentStatus){case"privatenotwatching":case"privatespying":case"passwordprotected":case"notconnected":o.stopCam()}})).addTo(this.listenerGroup);var r=null===(i=A.J.current.loggedInUser)||void 0===i?void 0:i.userUid;void 0!==r&&new E.HS(r).onMessage.listen((function(e){e.started?E.C$.fire(e):E.qZ.fire(e)})).addTo(this.listenerGroup)}return(0,l.Z)(e,[{key:"startCam",value:function(){var e=this;if((0,k.fg)("SharedCamStartClicked"),this.roomOffline||this.chatOffline)return(0,d.Cj)(T.ag.showMyCamMustBeConnected),void V.fire(void 0);(0,U.cr)(this.roomChatConn.username()).then((function(t){t?((0,d.Cj)(T.ag.showMyCamAlreadyBroadcasting),V.fire(void 0)):m.c.areTermsAccepted()?e.showBroadcastPreview():new m.c(!1,(function(){e.showBroadcastPreview()}),(function(){V.fire(void 0)})).show()})).catch((function(){}))}},{key:"stopCam",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return void 0!==this.broadcastModal?this.broadcastModal.stopBroadcast(e):Promise.resolve()}},{key:"cleanup",value:function(){this.stopCam(),this.listenerGroup.removeAll()}},{key:"showBroadcastPreview",value:function(){var e=this;if(this.roomOffline||this.chatOffline)return(0,d.Cj)(T.ag.showMyCamMustBeConnected),void V.fire(void 0);new Promise((function(e,t){(0,h.Ue)("api/broadcastvideocontext/").then((function(t){var n;e((n=t.responseText,new Promise((function(e,t){var i=new f.j(n);i.getNumber("status",!1)>=400?t("Bad response from server: ".concat(n)):e({room:i.getString("room"),originHost:i.getString("originHost"),originPassword:i.getString("originPassword"),originWSEndpoint:i.getString("originWSEndpoint")})}))))})).catch(t)})).then((function(t){e.camDossier=t,void 0!==e.previewModal&&e.previewModal.hide(),e.previewModal=new J(e.camDossier,e.constraints,e.startBroadcast,e.roomChatConn.room()),e.previewModal.show()})).catch((function(){}))}},{key:"setOnStart",value:function(e){this.onStartBroadcast.push(e)}},{key:"setOnStop",value:function(e){this.onStopBroadcast.push(e)}},{key:"isBroadcasting",value:function(){return void 0!==this.broadcastModal}}]),e}(),J=function(e){(0,o.Z)(n,e);var t=Z(n);function n(e,i,o,r){var s;return(0,a.Z)(this,n),(s=t.call(this)).paused=!1,s.preventChatFocus=!0,s.overlay.style.backgroundColor="rgba(0, 0, 0, 0.4)",(0,M.vP)(s.element,"smc-preview-modal"),s.element.style.boxShadow="0px 0px 10px rgba(0, 0, 0, 0.3)",s.element.style.position="fixed",s.element.style.overflow="hidden",s.element.style.height="auto",s.element.style.width="422px",s.element.style.top="50%",s.element.style.left="50%",s.element.style.transform="translate(-50%, -56%)",s.element.style.borderRadius="6px",s.previewPanel=new P.Nt(e,i,{onOBSClick:function(){},onStartBroadcast:o,title:T.ag.showMyCamPreviewTitle,infoText:[T.ag.showMyCamPreviewInfo1(r),T.ag.showMyCamPreviewInfo2],startButtonText:T.ag.showMyCamStart(r),onClose:function(){V.fire(void 0),s.hide()}}),s.element.style.padding="8px 10px",s.element.style.boxSizing="border-box",s.overlayClick.listen((function(){V.fire(void 0),s.hide()})),s.addChild(s.previewPanel),s}return(0,l.Z)(n,[{key:"show",value:function(){this.paused&&this.previewPanel.start(),(0,i.Z)((0,s.Z)(n.prototype),"show",this).call(this),(0,k.fg)("SharedCamPreviewDisplayed")}},{key:"hide",value:function(){(0,i.Z)((0,s.Z)(n.prototype),"hide",this).call(this),this.previewPanel.stop(),this.paused=!0}}]),n}(x.z),G=function(e){(0,o.Z)(n,e);var t=Z(n);function n(e,i,o,r,s){var l;(0,a.Z)(this,n),(l=t.call(this,e,i,{onStopBroadcast:function(){(0,h.Z2)("api/ts/chat/share-my-cam/?",{username:l.roomUsername}),l.removeFromDom(),l.listenerGroup.removeAll(),N=void 0,o()}})).roomChatConn=r,l.currentlyViewed=!1,l.listenerGroup=new w.mM,l.bottom=16,l.cachedBottom=l.bottom,l.right=16,l.fullscreenBottom=32,l.fullscreenRight=0,l.currentWatchers=new Map,l.showBroadcast=function(){var e=(0,C.Gd)();(0,C.rm)()&&void 0!==e?(e.appendChild(l.element),l.main.style.bottom="".concat(l.fullscreenBottom,"px"),l.main.style.right="".concat(l.fullscreenRight,"px")):(document.body.appendChild(l.element),l.main.style.bottom="".concat(l.bottom,"px"),l.main.style.right="".concat(l.right,"px"))},l.roomUsername=r.room(),l.getSettingsLocalstorage(),l.createBroadcastDisplay(),L.nR.listen((function(){l.recalcPosition()}));var c=!0;return p.QU.listen((function(e){var t=e.data.status;"connecting"!==t&&c&&"hidden"===t?(clearTimeout(s),c=!1,l.onConnected()):!c&&l.isStatusOffline(t)&&(l.stopBroadcast(),(0,d.Cj)(T.ag.showMyCamBroadcastError),error("smcViewer - cam went offline"))}),!1).addTo(l.listenerGroup),O._j.listen((function(){l.recalcPosition()})).addTo(l.listenerGroup),l}return(0,l.Z)(n,[{key:"onConnected",value:function(){var e=this;(0,k.fg)("SharedCamBroadcastStarted"),N=this.roomUsername,E.C$.listen((function(t){e.updateCamStatus(!0,t)}),!1).addTo(this.listenerGroup),E.qZ.listen((function(t){e.updateCamStatus(!1,t)}),!1).addTo(this.listenerGroup)}},{key:"stopBroadcast",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,u.j9)("mouseenter",this.element,(function(e){e.stopPropagation()}),!0),(0,u.j9)("mouseleave",this.element,(function(e){e.stopPropagation()}),!0),e&&(0,k.fg)("SharedCamBroadcastStopClicked",{is_broadcaster_viewing:this.currentlyViewed}),this.stop(!0)}},{key:"removeFromDom",value:function(){null!==this.element.parentElement&&this.element.parentElement.removeChild(this.element)}},{key:"updateCamStatus",value:function(e,t){var n;this.currentlyViewed=e,e?this.currentWatchers.has(t.username)||(this.statusIcon.src="".concat(STATIC_URL_ROOT,"broadcastassets/active-cam-overlaying-video.svg"),this.statusTooltipText.textContent="".concat(this.roomUsername," ").concat(T.ag.showMyCamIsViewing),this.currentWatchers.set(t.username,t),n=T.ag.showMyCamStartedViewing):this.currentWatchers.has(t.username)&&(this.statusIcon.src="".concat(STATIC_URL_ROOT,"broadcastassets/inactive-cam-overlaying-video.svg"),this.statusTooltipText.textContent="".concat(this.roomUsername," ").concat(T.ag.showMyCamNotViewing),this.currentWatchers.delete(t.username),n=T.ag.showMyCamStoppedViewing),void 0!==n&&this.roomChatConn.event.roomNotice.fire({messages:[[(0,v.iL)((0,R.iT)(t.username)),(0,v.vK)(n)]],showInPrivateMessage:!0})}},{key:"createBroadcastPanel",value:function(){}},{key:"createBroadcastDisplay",value:function(){this.element.style.height="auto",this.element.style.width="auto",this.main=this.createMain(),this.main.appendChild(this.createCamStatus()),this.main.appendChild(this.createVideo()),this.main.appendChild(this.createControls()),this.element.appendChild(this.main),this.setupUIEventListeners()}},{key:"createMain",value:function(){var e=document.createElement("div");return e.style.height="117px",e.style.width="".concat(117*this.constraints.width/this.constraints.height,"px"),e.style.backgroundColor="#000",e.style.position="fixed",e.style.zIndex="".concat(U.AR),e.style.border="1px solid #FFF",e}},{key:"createCamStatus",value:function(){var e=document.createElement("div");e.style.position="absolute",e.style.right="5px",e.style.top="5px",e.style.width=e.style.height="15px",e.style.zIndex="".concat(U.AR+2);var t=document.createElement("img");t.src="".concat(STATIC_URL_ROOT,"broadcastassets/inactive-cam-overlaying-video.svg");var n=document.createElement("div");n.style.position="absolute",n.style.backgroundColor="#303030",n.style.border="1px solid #222222",n.style.color="#EEE",n.style.width="175px",n.style.padding="9px",n.style.borderRadius="4px",n.style.fontSize="12px",n.style.display="none",n.style.zIndex="5",n.style.bottom="25px",n.style.left="-168px";var i=document.createElement("span");return i.textContent="".concat(this.roomUsername," ").concat(T.ag.showMyCamNotViewing),n.appendChild(i),n.appendChild((0,y.G3)("#222222","#303030","168px",2)),e.appendChild(t),e.appendChild(n),this.statusIcon=t,this.statusTooltip=n,this.statusTooltipText=i,e}},{key:"createVideo",value:function(){var e=(0,i.Z)((0,s.Z)(n.prototype),"createVideo",this).call(this);return e.style.height="100%",e}},{key:"createControls",value:function(){var e=this,t=(0,U.kK)(),n=document.createElement("div");n.style.width="100%",n.style.height="26px",n.style.backgroundColor="rgba(0, 0, 0, 0.4)",n.style.cursor="move",this.addDrag(n);var i=document.createElement("div");i.style.paddingLeft="10px",i.style.position="relative",i.style.top="50%",i.style.transform="translateY(-50%)",i.style.color="#FFF",i.style.cursor="default",i.textContent=T.ag.showMyCamMyCam,i.style.cursor="move",this.addDrag(i),n.appendChild(i),t.appendChild(n);var o=(0,U.vx)({iconAsset:"broadcastassets/volume-mute-grey.svg",tooltipText:T.ag.showMyCamMuted,iconSize:31,centerTop:"60%"});o.style.left="50%",o.style.transform="translateX(calc(-50% - 30px))",t.appendChild(o);var r=(0,U.vx)({iconAsset:"broadcastassets/close.svg",tooltipText:T.ag.showMyCamCloseCam,iconSize:23,centerTop:"60%",onClick:function(){e.stopBroadcast(!0)}});return r.style.left="50%",r.style.transform="translateX(calc(-50% + 30px))",t.appendChild(r),this.controls=t,t}},{key:"setupUIEventListeners",value:function(){var e=this,t=function(){e.controls.style.display="block",e.currentlyViewed?e.statusIcon.src="".concat(STATIC_URL_ROOT,"broadcastassets/active-cam.svg"):e.statusIcon.src="".concat(STATIC_URL_ROOT,"broadcastassets/inactive-cam.svg")},n=function(){e.controls.style.display="none",e.currentlyViewed?e.statusIcon.src="".concat(STATIC_URL_ROOT,"broadcastassets/active-cam-overlaying-video.svg"):e.statusIcon.src="".concat(STATIC_URL_ROOT,"broadcastassets/inactive-cam-overlaying-video.svg")};(0,u.j9)("mouseenter",this.main,t),(0,u.j9)("mouseleave",this.main,n);var i=0;(0,u.j9)("touchstart",this.main,(function(n){"none"===e.controls.style.display?(t(),i=1):i+=1})),(0,u.j9)("touchend",this.main,(function(e){i>1&&n()})),(0,u.j9)("touchstart",document,(function(t){e.element.contains(t.target)||n()})),(0,u.j9)("mouseenter",this.statusIcon,(function(t){e.statusTooltip.style.display="block"})),(0,u.j9)("mouseleave",this.statusIcon,(function(t){e.statusTooltip.style.display="none"})),(0,u.j9)("touchstart",this.statusIcon,(function(t){e.statusTooltip.style.display="block"})),(0,u.j9)("touchstart",document,(function(t){e.statusTooltip.style.display="none"}),!0)}},{key:"addDrag",value:function(e){var t=this;(0,b.T)(e,(function(e,n,i){var o=t.getCorrectedRight((0,C.rm)()?t.fullscreenRight:t.right),r=t.getCorrectedBottom((0,C.rm)()?t.fullscreenBottom:t.bottom),s=o,a=r,l=n,c=i;return{enabled:!0,move:function(e,n){var i=e-l,u=n-c;a=t.getCorrectedBottom(r-u),s=t.getCorrectedRight(o-i),t.main.style.bottom="".concat(a,"px"),t.main.style.right="".concat(s,"px")},end:function(){(0,C.rm)()?(t.fullscreenRight=s,t.fullscreenBottom=a):(t.right=s,t.bottom=a,t.cachedBottom=a),t.saveSettingsLocalstorage()}}}))}},{key:"getCorrectedBottom",value:function(e){return Math.max(0,Math.min(window.innerHeight-this.main.offsetHeight,e))}},{key:"getCorrectedRight",value:function(e){return Math.max(0,Math.min(window.innerWidth-this.main.offsetWidth,e))}},{key:"recalcPosition",value:function(){if((0,C.rm)())this.main.style.bottom="".concat(this.getCorrectedBottom(this.fullscreenBottom),"px"),this.main.style.right="".concat(this.getCorrectedRight(this.fullscreenRight),"px");else{var e=(0,D.p)();this.bottom=e>0?Math.max(this.cachedBottom,e+4):this.cachedBottom,this.main.style.bottom="".concat(this.getCorrectedBottom(this.bottom),"px"),this.main.style.right="".concat(this.getCorrectedRight(this.right),"px")}}},{key:"getSettingsLocalstorage",value:function(){if((0,c.IU)()){var e=window.localStorage.getItem(z);if(null!==e){var t=JSON.parse(e);this.bottom=t.bottom,this.cachedBottom=t.bottom,this.right=t.right,this.fullscreenBottom=t.fullscreenBottom,this.fullscreenRight=t.fullscreenRight}}}},{key:"saveSettingsLocalstorage",value:function(){if((0,c.IU)()){var e={bottom:this.bottom,right:this.right,fullscreenBottom:this.fullscreenBottom,fullscreenRight:this.fullscreenRight};window.localStorage.setItem(z,JSON.stringify(e))}}}]),n}(P.G0)},851:function(e,t,n){"use strict";n.d(t,{S:function(){return h},Z:function(){return p}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(9),c=n(1185);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,s.Z)(this,n)}}var d=function(e){(0,r.Z)(n,e);var t=u(n);function n(e,o,r){var s;return(0,i.Z)(this,n),(s=t.call(this)).checkbox=document.createElement("input"),s.onChange=function(){},s.disabled=!1,s.checkbox.type="checkbox",s.element.style.overflow="visible",s.element.style.position="relative",(0,c.vP)(s.element,"checkboxComponent"),s.subclassInit(r),void 0!==e&&s.setChecked(e),void 0!==o&&s.setOnChange(o),s.element.appendChild(s.checkbox),s.updateStyles(),s.element.onclick=function(e){s.disabled||e.target===s.checkbox||(s.toggle(),s.checkbox.focus(),e.preventDefault())},s.checkbox.onchange=function(){s.updateStyles(),s.onChange()},s}return(0,o.Z)(n,[{key:"toggle",value:function(){this.checkbox.click()}},{key:"focus",value:function(){this.checkbox.focus()}},{key:"blur",value:function(){this.checkbox.blur()}},{key:"isActiveElement",value:function(){return document.activeElement===this.checkbox}},{key:"isChecked",value:function(){return this.checkbox.checked}},{key:"setChecked",value:function(e){this.checkbox.checked=e,this.updateStyles(),this.onChange()}},{key:"setCheckedDirectly",value:function(e){this.checkbox.checked=e,this.updateStyles()}},{key:"setOnChange",value:function(e){this.onChange=e}},{key:"disable",value:function(){this.disabled=!0,this.checkbox.tabIndex=-1,this.updateStyles()}},{key:"enable",value:function(){this.disabled=!1,this.checkbox.removeAttribute("tabindex"),this.updateStyles()}},{key:"setCheckboxValue",value:function(e){this.checkbox.value=e}},{key:"getCheckboxValue",value:function(){return this.checkbox.value}}]),n}(l.w),h=function(e){(0,r.Z)(n,e);var t=u(n);function n(e,o,r){var s;return(0,i.Z)(this,n),(s=t.call(this,o,r)).element.style.height="".concat(e,"px"),s.element.style.width="".concat(e,"px"),s}return(0,o.Z)(n,[{key:"subclassInit",value:function(){(0,c.vP)(this.element,"transparentCheckbox")}},{key:"updateStyles",value:function(){this.checkbox.checked?(0,c.vP)(this.element,"checked"):(0,c.FU)(this.element,"checked"),this.disabled?((0,c.vP)(this.element,"disabled"),this.element.style.cursor="default"):((0,c.FU)(this.element,"disabled"),this.element.style.cursor="pointer")}},{key:"setName",value:function(e){this.checkbox.name=e}},{key:"getName",value:function(){return this.checkbox.name}},{key:"setTitle",value:function(e){this.checkbox.title=e}}]),n}(d),f="rgb(246, 115, 0)",p=function(e){(0,r.Z)(n,e);var t=u(n);function n(e,o,r){return(0,i.Z)(this,n),t.call(this,e,o,r)}return(0,o.Z)(n,[{key:"subclassInit",value:function(e){var t,n,i=null!==(t=null==e?void 0:e.width)&&void 0!==t?t:50,o=null!==(n=null==e?void 0:e.height)&&void 0!==n?n:30,r="".concat(i,"px"),s="".concat(o,"px"),a="".concat(2*o/3,"px");this.toggledOnLeftStyle="".concat(i-o,"px"),this.element.style.width=r,this.element.style.height=s,this.element.style.borderRadius=a,this.element.style.lineHeight=s,(0,c.vP)(this.element,"toggle"),this.button=document.createElement("div"),this.button.style.height=s,this.button.style.width=s,(0,c.vP)(this.button,"toggleButton"),this.element.appendChild(this.button)}},{key:"updateStyles",value:function(){this.checkbox.checked?(this.element.style.backgroundColor="".concat(f),this.element.style.boxShadow="".concat(f," 0 0 0 16px inset"),this.element.style.border="1px solid ".concat(f),this.button.style.left=this.toggledOnLeftStyle):(this.element.style.backgroundColor="rgb(233, 233, 233)",this.element.style.boxShadow="rgb(233, 233, 233) 0 0 0 16px inset",this.element.style.border="1px solid rgb(223, 223, 223)",this.button.style.left="0")}}]),n}(d)},5712:function(e,t,n){"use strict";n.d(t,{n:function(){return d}});var i=n(2951),o=n(1976),r=n(4793),s=n(1794),a=n(1006),l=n(822);function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var d=function(){function e(){var t=this;(0,i.Z)(this,e),this.invalidMentions=new Set,this.sorted=!1,this.chatListeners=new s.mM,this.userList=[],r.kN.listen((function(e){t.clearUserListPromise(),t.isAnonymous=e.chatConnection.viewerIsAnonymous(),e.chatConnection.event.statusChange.listen((function(e){t.statusChangeShouldRefresh(e.currentStatus,e.previousStatus)})).addTo(t.chatListeners),t.isAnonymous||e.chatConnection.event.roomNotice.listen((function(e){var n,i=c(e.messages);try{for(i.s();!(n=i.n()).done;){var o,r=c(n.value);try{for(r.s();!(o=r.n()).done;){var s=o.value;0===s.partType&&void 0!==s.user&&t.addRecentUser(s.user)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){i.e(e)}finally{i.f()}})).addTo(t.chatListeners)})),r.QN.listen((function(){t.chatListeners.removeAll()}))}return(0,o.Z)(e,[{key:"mentionUserList",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return void 0!==this.userListPromise||(this.userListPromise=this.refreshUserList(e),this.scheduleUserListPromiseReset()),this.userListPromise}},{key:"clearList",value:function(){this.userList=[]}},{key:"clearUserListPromise",value:function(){this.userListPromise=void 0}},{key:"scheduleUserListPromiseReset",value:function(){var e=this;window.setTimeout((function(){e.clearUserListPromise()}),6e4)}},{key:"getSortedList",value:function(){return this.sorted||(this.userList.sort((function(e,t){return e.user.username.toLowerCase()<t.user.username.toLowerCase()?-1:e.user.username.toLowerCase()>t.user.username.toLowerCase()?1:0})),this.sorted=!0),this.userList}},{key:"users",value:function(){return this.userList.map((function(e){return e.user}))}},{key:"count",get:function(){return this.userList.length}},{key:"refreshUserList",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return a._B.getInstance().fetchRoomUsers().then((function(n){var i=document.createElement("div");t?e.removeNonRecentUsers():e.userList=[];var o,r=c(n.roomUsers);try{for(r.s();!(o=r.n()).done;){var s=o.value;e.userInList(s.username)||e.userList.push({user:s,element:i,visible:!1,recent:!1}),e.invalidMentions.has(s.username)&&(l.it.fire(void 0),e.invalidMentions.delete(s.username))}}catch(e){r.e(e)}finally{r.f()}return e.userList})).catch((function(t){return error("Error loading username autocomplete",t),e.userList}))}},{key:"addRecentUser",value:function(e){var t=document.createElement("div");this.sorted=!1;var n=this.getUser(e.username);void 0===n?this.userList.push({user:e,element:t,visible:!1,recent:!0}):(n.user=e,n.recent=!0),this.invalidMentions.has(e.username)&&(l.it.fire(void 0),this.invalidMentions.delete(e.username))}},{key:"addInvalidUsers",value:function(e){var t,n=c(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.invalidMentions.add(i)}}catch(e){n.e(e)}finally{n.f()}}},{key:"shouldNotRefresh",value:function(e){return["offline","notconnected","hidden","passwordprotected"].indexOf(e)>-1}},{key:"statusChangeShouldRefresh",value:function(e,t){if(!this.isAnonymous&&!this.shouldNotRefresh(e)){var n="privatespying"!==t&&"privatewatching"!==t,i="privatespying"!==e&&"privatewatching"!==e;!n&&i?(this.clearUserListPromise(),this.mentionUserList()):n&&!i?(this.clearUserListPromise(),this.mentionUserList(!1)):this.mentionUserList()}}},{key:"removeNonRecentUsers",value:function(){this.userList=this.userList.filter((function(e){return e.recent}))}},{key:"getUser",value:function(e){return this.userList.find((function(t){return t.user.username===e}))}},{key:"userInList",value:function(e){return void 0!==this.getUser(e)}}],[{key:"getInstance",value:function(){return void 0===e.instance&&(e.instance=new e),e.instance}}]),e}()},822:function(e,t,n){"use strict";n.d(t,{AL:function(){return M},W8:function(){return P},it:function(){return T}});var i=n(3243),o=n(7791),r=n(2951),s=n(1976),a=n(7591),l=n(9492),c=n(7597),u=n(824),d=n.n(u),h=n(8759),f=n(7693),p=n(4793),m=n(1794),v=n(2923),g=n(3682),y=n(7108),b=n(9482),w=n(758),C=n(1185),x=n(2800),k=n(5712);function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var T=new m.xB("updateUserMention",{reportIfNoListeners:!1}),I=[40,37,39,38,13,27,32,9],R=new m.xB("hideUserList",{listenersWarningThreshold:20}),P=function(e){(0,a.Z)(i,e);var t,n=S(i);function i(e){var t;return(0,r.Z)(this,i),(t=n.call(this,e)).config=e,t.listenerGroup=new m.mM,t.visible=!1,t.started=!1,t.userList=k.n.getInstance(),t.element.style.visibility="hidden",t.element.style.width="auto",t.element.style.height="auto",t.element.style.borderBottom="none",t.element.style.fontFamily="Helvetica, Arial, sans-serif",t.element.style.cursor="pointer",t.element.style.userSelect="none",t.overlayClick.listen((function(){t.isValidSelectionIndex()&&t.config.inputElement.appendText(" "),t.hide()})),t.list=document.createElement("div"),t.list.style.width="260px",t.list.style.maxHeight="180px",t.list.style.overflowY="scroll",t.element.appendChild(t.list),(0,f.j9)("keyup",t.config.inputElement.element,(function(e){t.config.inputElement.getAvailableLength()>36&&(t.handleInputChange(e),t.repositionChildren())})),(0,f.j9)("keydown",t.config.inputElement.element,(function(e){(t.visible||t.started)&&t.handleKeyPress(e)})),w.gO.listen((function(e){t.delay=parseInt(e.emoticonAutocompleteDelay)})).addTo(t.listenerGroup),R.listen((function(){t.hide()})).addTo(t.listenerGroup),p.kN.listen((function(e){t.delay=parseInt(e.dossier.userChatSettings.emoticonAutocompleteDelay),t.hide(),t.clearList(),t.userList.clearList()})).addTo(t.listenerGroup),(0,C.vP)(t.element,"userMentionModal"),t}return(0,s.Z)(i,[{key:"dispose",value:function(){this.listenerGroup.removeAll()}},{key:"repositionChildren",value:function(){var e=this.config.inputElement.caretXPos(!0)+this.config.leftOffset,t=this.config.inputElement.element.clientWidth-this.config.rightOffset;this.element.style.left="".concat(Math.max(4,Math.min(e,t)),"px")}},{key:"handleInputChange",value:(t=(0,o.Z)(d().mark((function e(t){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.delay>=0&&-1===I.indexOf(t.keyCode))){e.next=11;break}if(null===(n=this.config.inputElement.getCurrentNodeText().match(/(^|\s)@([\w-]*)$/))||!this.config.inputElement.caretAtEndOfInput()){e.next=10;break}return e.next=5,this.userList.mentionUserList();case 5:this.prefix=n[2],this.inputString=this.prefix,this.updateList(),e.next=11;break;case 10:this.hide();case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"handleKeyPress",value:function(e){38===e.keyCode||40===e.keyCode?(e.preventDefault(),this.scrollList(38===e.keyCode)):[9,39,32,13].includes(e.keyCode)?(e.preventDefault(),e.stopPropagation(),this.hide(),x.J.current.isMobile&&13===e.keyCode||this.config.inputElement.appendText(" ")):27!==e.keyCode&&37!==e.keyCode||(e.preventDefault(),this.hide(),this.deleteHighlightedSuffix())}},{key:"clearList",value:function(){for(;null!==this.list.firstChild;)this.list.removeChild(this.list.firstChild);this.selectedIndex=-1}},{key:"updateList",value:function(){var e=this;this.clearList()," "===this.prefix[this.prefix.length-1]&&this.hide();var t=!1;if(this.selectedList=this.userList.getSortedList(),this.selectedList.forEach((function(n,i){""===e.prefix||n.user.username.toLowerCase().startsWith(e.prefix.toLowerCase())?(e.appendUserList(n,i),t=!0):n.visible=!1})),!t)return this.hide(),void(this.started=!0);var n=this.list.children.length<=0?0:this.list.children.item(this.list.children.length-1).offsetTop;this.list.scrollTop=n,this.visible||this.show()}},{key:"appendUserList",value:function(e,t){var n=this,i=document.createElement("div");i.classList.add("userMentionModalItem"),(0,C.vP)(i,(0,b.c9)(e.user)),i.innerText=e.user.username,i.style.padding="2px 8px",i.onclick=function(){n.selectedIndex=t,n.highlightSelectedIndex(!1),n.config.inputElement.focus(),n.hide(),n.config.inputElement.appendText(" ")},i.style.fontWeight="bold",i.style.textOverflow="ellipsis",i.style.overflow="hidden",e.element=i,e.visible=!0,this.list.appendChild(i)}},{key:"scrollList",value:function(e){this.inputString=this.isValidSelectionIndex()?this.selectedList[this.selectedIndex].user.username:this.prefix;var t=!1;this.clearSelection();do{var n;if(this.selectedIndex=this.isValidSelectionIndex()?this.selectedIndex+(e?-1:1):e?this.selectedList.length-1:0,this.selectedIndex<0){if(t)break;this.selectedIndex=this.selectedList.length-1,t=!0}else if(this.selectedIndex>=this.selectedList.length){if(t)break;this.selectedIndex=0,t=!0}}while(null===(n=this.selectedList[this.selectedIndex])||void 0===n||!n.visible);this.highlightSelectedIndex(!0)}},{key:"clearSelection",value:function(){this.list.querySelectorAll("div.highlight").forEach((function(e){var t=e;(0,C.FU)(t,"highlight")}))}},{key:"highlightSelectedIndex",value:function(e){if(this.isValidSelectionIndex()){this.clearSelection();var t=this.selectedList[this.selectedIndex],n=this.list.clientHeight,i=this.list.firstChild.getBoundingClientRect().height;e&&(this.list.scrollTop=this.selectedIndex*i-n/2),(0,C.vP)(t.element,"highlight");var o=t.user.username;this.config.inputElement.setCurrentNodeText(this.config.inputElement.getCurrentNodeText().replace(new RegExp("".concat(this.inputString,"$")),o)),this.inputString=o;var r=this.config.inputElement.getCurrentNodeText().lastIndexOf(o);r>-1&&this.config.inputElement.selectCurrentNodeTail(r)}}},{key:"deleteHighlightedSuffix",value:function(){this.config.inputElement.deleteSelection()}},{key:"show",value:function(){var e=this;this.started=!0,this.delay>=0&&window.setTimeout((function(){e.element.style.visibility="",e.showOverlay(),e.repositionChildrenRecursive(),e.visible=!0}),this.delay)}},{key:"hide",value:function(){this.hideOverlay(),this.element.style.visibility="hidden",this.visible=!1,this.started=!1,this.clearList()}},{key:"isVisible",value:function(){return this.visible}},{key:"isValidSelectionIndex",value:function(){return-1!==this.selectedIndex&&this.selectedIndex<this.selectedList.length}}]),i}(y.B),M=function(e){(0,a.Z)(n,e);var t=S(n);function n(e){var i;return(0,r.Z)(this,n),i=t.call(this,e),(0,v.q)(i.list,!0),(0,f.j9)("touchstart",i.element,(function(){i.config.inputElement.setCurrentNodeText(i.config.inputElement.getCurrentNodeText())})),(0,h.Tt)()||((0,f.j9)("keydown",i.config.inputElement.element,(function(e){i.visible&&(i.savedValue=i.config.inputElement.getCurrentNodeText())})),(0,f.j9)("keyup",i.config.inputElement.element,(function(e){var t=i.config.inputElement.getCurrentNodeText();""!==i.savedValue&&void 0!==i.savedValue&&" "===t[t.length-1]&&(i.config.inputElement.setCurrentNodeText("".concat(i.savedValue," ")),i.hide()),i.savedValue=""}),!0)),i.overlayClick.listen((function(){i.config.inputElement.focus(),i.config.inputElement.setCurrentNodeText(i.config.inputElement.getCurrentNodeText())})),g.bs.listen((function(){i.hide()})).addTo(i.listenerGroup),i}return(0,s.Z)(n,[{key:"initUI",value:function(e){(0,i.Z)((0,c.Z)(n.prototype),"initUI",this).call(this),this.element.style.border="",this.element.style.fontSize="14px",this.element.style.lineHeight="26px",this.element.style.boxShadow="0px 0px 8px rgba(0, 0, 0, 0.32)",this.element.style.marginLeft="7px",this.element.style.boxSizing="content-box",this.element.style.position="fixed",this.element.style.bottom="".concat(e.inputDivHeight-3,"px")}},{key:"repositionChildren",value:function(){}}]),n}(P)},8210:function(e,t,n){"use strict";n.d(t,{oD:function(){return R},vo:function(){return P}});var i=n(2951),o=n(1976),r=n(7169),s=n(3243),a=n(7591),l=n(9492),c=n(7597),u=n(8759),d=n(7693),h=n(695),f=n(1602),p=n(6767),m=n(1794),v=n(444),g=n(6959),y=n(2923),b=n(7108),w=n(758),C=n(3543),x=n(1185),k=n(2800);var S=new Set;function T(e){S.forEach((function(t){e!==t.roomName&&t.dispose()}))}function I(e){return(Array.from(e,(function(e){return e.charCodeAt(0)})).reduce((function(e,t){return(e<<5)-e+t|0}),0)>>>0).toString(16)}function R(){return Array.from(S).some((function(e){return e.isShown()}))}function P(e,t){var n;if(null===(n=e.rulesModal)||void 0===n||n.dispose(),!(0,h.TF)()&&t.chatRules.trim().length>0&&!function(e,t){var n,i=null===(n=k.J.current.loggedInUser)||void 0===n?void 0:n.username;if(i===e)return!0;var o=I(t.trim()),r="rules_accepted_".concat(i,"_").concat(e);return(0,u.IU)()?localStorage.getItem(r)===o:(0,p.sv)(r)===o}(t.room,t.chatRules)){if(e instanceof g.Q){var i=new M({inputContainer:e.centerControlsDiv,customInputField:e.chatInput,roomName:t.room,chatRules:t.chatRules,container:e.getMobileRoot(),chatSettings:t.userChatSettings},!0);return i.element.style.position="fixed",i.element.style.zIndex="999999",i}var o=new M({inputContainer:e.inputDiv,customInputField:e.customInputField,roomName:t.room,chatRules:t.chatRules,container:e,chatSettings:t.userChatSettings});return o.element.style.zIndex="1001",o}}f.y.listen((function(e){T(e.room)}));var M=function(e){(0,a.Z)(f,e);var t,n,h=(t=f,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function f(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,i.Z)(this,f),(t=h.call(this,e)).visibilityChanged=new m.xB("visibilityChanged",{reportIfNoListeners:!1}),t.showFunction=function(e){t.show()},t.listenerAdded=!1,t.listenerGroup=new m.mM,t.isVisible=!1,t.captureKeys=function(e){"Tab"===e.key?(document.activeElement===t.acceptBtn?t.closeBtn.focus():t.acceptBtn.focus(),e.stopPropagation(),e.preventDefault()):"Escape"===e.key?(t.hide(),e.stopPropagation(),e.preventDefault()):"Enter"!==e.key&&(e.stopPropagation(),e.preventDefault())},t.overlayClick.listen((function(){t.hide()})),S.add((0,r.Z)(t)),n?(t.element.style.width="70%",t.element.style.left="15%"):(t.element.style.width="95%",t.element.style.left="2.5%"),t.bindListeners(),t.updateScrollIndicator(),t}return(0,o.Z)(f,[{key:"applyChatSettingsFontStyles",value:function(e){this.element.style.fontFamily=e.fontFamily,this.element.style.fontSize=e.fontSize}},{key:"initData",value:function(e){this.chatRules=e.chatRules.trim()}},{key:"initUI",value:function(e){(0,s.Z)((0,c.Z)(f.prototype),"initUI",this).call(this),this.element.style.bottom="10px",this.element.style.borderWidth="1px",this.element.style.borderStyle="solid",this.element.style.borderRadius="4px",this.element.style.margin="0 auto",this.element.style.padding="10px",this.element.style.boxSizing="border-box",this.element.style.maxHeight="95%",this.applyChatSettingsFontStyles(e.chatSettings),(0,x.vP)(this.element,"rulesModal"),this.inputContainer=e.inputContainer,this.customInput=e.customInputField,this.roomName=e.roomName,this.container=e.container,this.element.style.position="absolute",this.element.style.textAlign="center",this.element.style.height="auto",this.element.style.display="none";var t=document.createElement("div");t.style.fontWeight="bold",t.style.textAlign="left",t.style.paddingBottom="5px",t.style.paddingRight="10px",t.style.whiteSpace="nowrap",t.style.textOverflow="ellipsis",t.style.overflow="hidden";var n="".concat(this.roomName[0].toUpperCase()).concat(this.roomName.substring(1));t.innerText="".concat(n,"'s Rules:"),this.element.appendChild(t),this.textPar=this.createTextContent(this.chatRules),this.scrollIndicator=this.createScrollIndicator();var i=document.createElement("div");i.style.position="relative",i.appendChild(this.textPar),i.appendChild(this.scrollIndicator),i.dataset.testid="chat-rules",this.element.appendChild(i),this.acceptBtn=this.createAcceptButton(),this.closeBtn=this.createCloseButton(),this.element.appendChild(this.acceptBtn),this.element.appendChild(this.closeBtn),this.repositionChildren()}},{key:"createTextContent",value:function(e){var t=this,n=document.createElement("div");return n.style.whiteSpace="pre-line",n.style.textAlign="left",n.style.lineHeight="1.4",n.style.height="auto",n.style.paddingBottom="15px",n.style.boxSizing="border-box",n.style.width="100%",n.style.overflowY="scroll",n.style.overflowWrap="break-word",n.style.wordBreak="break-word",n.style.wordWrap="break-word",n.style.cssText+="; -ms-overflow-style: -ms-autohiding-scrollbar",n.style.marginBottom="3px",n.style.paddingRight="15px",n.onscroll=function(){t.updateScrollIndicator()},n.appendChild(document.createTextNode(e)),(0,y.q)(n),n}},{key:"isTextScrolledToBottom",value:function(){return this.textPar.scrollHeight-this.textPar.scrollTop-this.textPar.clientHeight<=1}},{key:"updateScrollIndicator",value:function(){this.isTextScrolledToBottom()?this.scrollIndicator.style.display="none":this.scrollIndicator.style.display="block"}},{key:"createScrollIndicator",value:function(){var e=document.createElement("div");return(0,x.vP)(e,"scrollIndicator"),e.style.height="50px",e.style.position="absolute",e.style.bottom="0",e.style.fontWeight="bold",e.style.textAlign="center",e.style.boxSizing="border-box",e.style.width="100%",e}},{key:"repositionChildren",value:function(){var e=this.container.element.getBoundingClientRect().height;this.textPar.style.maxHeight="calc(".concat(e,"px - 120px)"),this.updateScrollIndicator()}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isVisible||(this.isVisible=!0,this.element.style.display="block",this.customInput.disable(),this.inputContainer.style.pointerEvents="none",this.showOverlay(),this.repositionChildren(),(0,d.j9)("keydown",document,this.captureKeys,!0),e||this.visibilityChanged.fire(this.isVisible))}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isVisible&&(this.isVisible=!1,this.element.style.display="none",this.customInput.enable(),this.inputContainer.style.pointerEvents="",this.hideOverlay(),this.container.repositionChildrenRecursive(),(0,d.SC)("keydown",document,this.captureKeys,!0),e||this.visibilityChanged.fire(this.isVisible))}},{key:"accept",value:function(){var e,t="rules_accepted_".concat(null===(e=k.J.current.loggedInUser)||void 0===e?void 0:e.username,"_").concat(this.roomName),n=I(this.chatRules);(0,u.IU)()?localStorage.setItem(t,n):(0,p.C)(t,n,1),T(),v.ZB.fire(void 0),this.customInput.focus()}},{key:"bindListeners",value:function(){var e=this;w.gO.listen((function(t){e.applyChatSettingsFontStyles(t)})).addTo(this.listenerGroup),this.listenerAdded||((0,d.j9)("focus",this.customInput.element,this.showFunction),this.listenerAdded=!0)}},{key:"removeInputListener",value:function(){this.listenerAdded&&((0,d.SC)("focus",this.customInput.element,this.showFunction),this.listenerAdded=!1)}},{key:"dispose",value:function(){this.hide(),this.removeInputListener(),this.listenerGroup.removeAll(),void 0!==this.parent&&(delete this.parent.rulesModal,this.parent.removeChild(this)),S.delete(this)}},{key:"createAcceptButton",value:function(){var e=this,t=document.createElement("button");return t.innerText=C.ag.acceptRules,t.style.fontFamily="'UbuntuRegular',sans-serif",t.style.display="inline-block",t.style.boxSizing="content-box",t.style.width="calc(100% - 16px)",t.style.padding="8px",t.style.borderRadius="4px",t.style.cursor="pointer",t.style.fontWeight="500",t.style.lineHeight="16px",t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.style.textOverflow="ellipsis",t.style.fontSize="120%",t.style.zIndex="2",(0,d.j9)("click",t,(function(){e.accept()})),(0,x.vP)(t,"acceptRulesButton"),t}},{key:"createCloseButton",value:function(){var e=this,t=document.createElement("button"),n=document.createElement("img");return n.src="".concat(STATIC_URL,"close_icon.svg"),n.style.backgroundColor="inherit",t.appendChild(n),t.style.boxSizing="border-box",t.style.padding="5px 5px 4px 5px",t.style.position="absolute",t.style.top="2px",t.style.right="2px",t.style.cursor="pointer",(0,d.j9)("click",t,(function(){e.hide()})),(0,x.vP)(t,"closeRulesButton"),t}}]),f}(b.B)},7542:function(e,t,n){"use strict";n.d(t,{F:function(){return i}});var i=new(n(1794).xB)("openFeedbackForm")},2765:function(e,t,n){"use strict";n.d(t,{j:function(){return q},K:function(){return W}});var i=n(3243),o=n(2951),r=n(1976),s=n(7591),a=n(9492),l=n(7597),c=n(7693),u=n(3753),d=n(6767),h=n(9),f=n(8263),p=n(9874),m=n(5190),v=n(3543),g=n(1185),y=n(2800),b=n(1612),w=n(6265),C=n(7169),x=n(8759),k=n(1794),S=n(4880),T=function(){function e(t,n,i){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];(0,o.Z)(this,e),this.element=document.createElement("div"),this.label=document.createElement("label"),this.label.htmlFor=n,this.label.innerText=i,"textarea"===t?this.input=document.createElement("textarea"):(this.input=document.createElement("input"),this.input.type=t),this.input.name=n,r&&(this.input.required=r),this.error=document.createElement("p"),this.error.style.display="none",this.element.appendChild(this.label),this.element.appendChild(this.input),this.element.appendChild(this.error)}return(0,r.Z)(e,[{key:"setError",value:function(e){this.error.textContent=e,this.error.style.display=""}},{key:"clearError",value:function(){this.error.textContent="",this.error.style.display="none"}}]),e}(),I=n(2295);function R(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var A=new k.xB("canvasOpen"),E=new k.xB("canvasClose"),B=function(e){var t=document.createElement("div");return t.style.display="block",void 0!==e&&e.appendChild(t),t},L=function(e){(0,s.Z)(n,e);var t=M(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"initData",value:function(){this.element=B(),this.control=document.createElement("button"),this.control.type="button",this.control.tabIndex=0,this.element.appendChild(this.control)}},{key:"initUI",value:function(){this.element.style.position="absolute",this.element.style.top="0",this.element.style.right="0",this.element.style.margin="12px 12px 0 0",(0,g.vP)(this.control,"closeControl"),this.control.style.padding="4px",this.control.style.cursor="pointer",this.control.style.width="12px",this.control.style.height="12px",this.control.style.border="none",this.control.style.boxSizing="content-box"}}]),n}(h.w),O=function(e){(0,s.Z)(n,e);var t=M(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"initData",value:function(){this.element=B(),(0,g.vP)(this.element,"header"),this.header=document.createElement("h2"),this.header.textContent=v.ag.sendFeedbackTextLc,this.element.appendChild(this.header)}},{key:"initUI",value:function(){(0,f.Zs)(this.header,{fontSize:"14px",lineHeight:"18px",fontFamily:"UbuntuRegular, Helvetica, Arial, sans-serif",margin:"0 0 8px"})}}]),n}(h.w),D=function(e){(0,s.Z)(n,e);var t=M(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"initData",value:function(){this.element=B(),(0,g.vP)(this.element,"submitRow"),this.submit=document.createElement("button"),this.submit.type="submit",this.submit.textContent=v.ag.feedbackSubmit,this.submit.disabled=!0,this.element.appendChild(this.submit)}},{key:"initUI",value:function(){this.element.style.textAlign="right",(0,f.Zs)(this.submit,{fontFamily:"UbuntuRegular, Helvetica, Arial, sans-serif",marginTop:"16px",borderStyle:"solid",borderWidth:"1px",borderRadius:"4px",boxSizing:"border-box",opacity:"0.5",padding:"7px"})}},{key:"disable",value:function(){this.submit.disabled=!0,this.submit.style.opacity="0.5",this.submit.style.cursor="default"}},{key:"enable",value:function(){this.submit.disabled=!1,this.submit.style.opacity="1",this.submit.style.cursor="pointer"}}]),n}(h.w),U=function(e){(0,s.Z)(n,e);var t=M(n);function n(){var e;(0,o.Z)(this,n),(e=t.call(this)).inputChange=new k.xB("inputChange"),e.defaultPrompt=v.ag.feedbackSentimentLabel(b.w.siteName),e.element=B(),e.formInput=new T("hidden","sentiment",e.defaultPrompt,!1),e.element.appendChild(e.formInput.element);var i=B();return(0,f.Zs)(i,{height:"auto",width:"224px",margin:"12px auto 16px",position:"relative"}),i.appendChild(e.createSentimentSelection("0")),i.appendChild(e.createSentimentSelection("1")),i.appendChild(e.createSentimentSelection("2")),i.appendChild(e.createSentimentSelection("3")),i.appendChild(e.createSentimentSelection("4",!0)),e.element.appendChild(i),e}return(0,r.Z)(n,[{key:"createSentimentSelection",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=document.createElement("button");return i.type="button",(0,g.vP)(i,"sentimentOption"),(0,g.vP)(i,(0,m.AF)(e)),(0,f.Zs)(i,{height:"24px",width:"24px",padding:"4px",boxSizing:"content-box",backgroundPosition:"center center",backgroundRepeat:"no-repeat",display:"inline-block",backgroundColor:"transparent",border:"none",cursor:"pointer",marginRight:n?"0":"16px",verticalAlign:"middle"}),this.inputChange.listen((function(t){t===e?(0,g.vP)(i,"selected"):(0,g.FU)(i,"selected")})),i.onclick=function(){t.setValue(e)},i}},{key:"setValue",value:function(e){this.formInput.input.value=e,this.inputChange.fire(e)}},{key:"getValue",value:function(){return this.formInput.input.value}},{key:"setPrompt",value:function(e){this.formInput.label.textContent=""===e?this.defaultPrompt:e}},{key:"clearSelection",value:function(){this.setValue("")}}]),n}(h.w),Z=function(e){(0,s.Z)(n,e);var t=M(n);function n(e){var i;(0,o.Z)(this,n),(i=t.call(this)).props=e,i.commentItems=[],i.element=B();var r,s=R(e.prompts);try{for(s.s();!(r=s.n()).done;){var a=r.value,l=new T("textarea","comments",a,e.required);(0,g.vP)(l.input,"feedbackComment"),(0,f.Zs)(l.input,{width:"306px",resize:"none",minHeight:"".concat(e.textBoxHeight,"px"),boxSizing:"border-box",marginBottom:"8px"}),l.input.maxLength=5e3,(0,g.vP)(l.error,"error"),l.error.style.marginBottom="12px",(0,c.j9)("keyup",l.input,e.onChange),(0,c.j9)("touchend",l.input,e.onChange),(0,c.j9)("paste",l.input,e.onChange),(0,c.j9)("cut",l.input,e.onChange),i.element.appendChild(l.element),i.commentItems.push(l)}}catch(e){s.e(e)}finally{s.f()}for(var u=function(e){(0,c.j9)("keydown",i.commentItems[e].input,(0,f.hI)((function(){return e+1<i.commentItems.length?i.commentItems[e+1].input:void 0}),(function(){return e>0?i.commentItems[e-1].input:void 0})))},d=0;d<i.commentItems.length;d++)u(d);return i}return(0,r.Z)(n,[{key:"prompts",value:function(){return this.props.prompts}},{key:"values",value:function(){return this.commentItems.map((function(e){return e.input.value}))}},{key:"clear",value:function(){var e,t=R(this.commentItems);try{for(t.s();!(e=t.n()).done;)e.value.input.value=""}catch(e){t.e(e)}finally{t.f()}}},{key:"focus",value:function(){this.commentItems[0].input.focus()}},{key:"blur",value:function(){this.commentItems.forEach((function(e){return e.input.blur()}))}},{key:"firstInput",value:function(){return this.commentItems[0].input}},{key:"lastInput",value:function(){return this.commentItems[this.commentItems.length-1].input}},{key:"setError",value:function(e,t){(t<0||t>=this.commentItems.length)&&error("Feedback comments error index out of range"),e.length>0&&this.commentItems[t].setError(e)}},{key:"clearErrors",value:function(){this.commentItems.forEach((function(e){return e.clearError()}))}},{key:"anyCommentsNonempty",value:function(){return this.commentItems.some((function(e){return""!==e.input.value.trim()}))}}]),n}(h.w),F=function(e){(0,s.Z)(n,e);var t=M(n);function n(e,i){var r;return(0,o.Z)(this,n),(r=t.call(this,"div",{control:e})).canvas=i,r}return(0,r.Z)(n,[{key:"initData",value:function(e){var t=this;this.element=document.createElement("div"),(0,g.vP)(this.element,"screenshot"),this.editToggle=document.createElement("button"),this.editToggle.type="button",(0,g.vP)(this.editToggle,"editToggle"),this.editImage=new Image,this.editImage.src="".concat(STATIC_URL_ROOT,"images/feedback/select.svg"),this.editToggle.appendChild(this.editImage),this.editText=document.createElement("div"),this.editText.textContent=v.ag.feedbackCanvasToggle,this.editToggle.appendChild(this.editText),(0,c.j9)("click",this.editToggle,(function(){t.canvas.show()})),(0,c.j9)("mouseenter",this.editToggle,(function(){t.editImage.src="".concat(STATIC_URL_ROOT,"images/feedback/select_active.svg")})),(0,c.j9)("mouseleave",this.editToggle,(function(){t.editImage.src="".concat(STATIC_URL_ROOT,"images/feedback/select.svg")})),this.element.appendChild(this.editToggle),this.closeButton=document.createElement("button"),this.closeButton.type="button",this.closeButton.onclick=function(){e.control.removeScreenshot()},this.element.appendChild(this.closeButton)}},{key:"initUI",value:function(){this.element.style.width="100%",this.element.style.minHeight="140px",this.element.style.maxHeight="340px",this.element.style.position="relative",this.element.style.backgroundSize="contain",this.element.style.backgroundRepeat="no-repeat",this.element.style.backgroundPosition="center",this.element.style.justifyContent="center",this.element.style.alignItems="center",this.element.style.display="none",this.editToggle.style.width="75%",this.editToggle.style.height="100px",this.editToggle.style.boxShadow="0px 4px 16px rgba(0, 0, 0, 0.3)",this.editToggle.style.borderRadius="4px",this.editToggle.style.textAlign="center",this.editToggle.style.cursor="pointer",this.editToggle.style.fontFamily="UbuntuMedium, Helvetica, Arial, sans-serif",this.editText.style.width="100%",(0,f.Zs)(this.closeButton,{position:"absolute",right:"10px",top:"10px",height:"24px",width:"24px",padding:"4px",background:"transparent url(".concat(STATIC_URL,"feedback/remove-screenshot.svg) no-repeat center center"),border:"none",cursor:"pointer"})}}]),n}(h.w),_=function(e){(0,s.Z)(n,e);var t=M(n);function n(e,i){var r;return(0,o.Z)(this,n),(r=t.call(this,"div",{canvas:i})).modal=e,r.canvas=i,r.isCapturing=!1,r}return(0,r.Z)(n,[{key:"initData",value:function(e){var t=this;this.element=B(),this.button=document.createElement("button"),this.button.type="button",this.button.textContent=v.ag.feedbackAddScreenshot,(0,c.j9)("click",this.button,(function(e){e.preventDefault(),t.addScreenshot()})),this.element.appendChild(this.button),this.screenshot=new F(this,e.canvas),this.addChild(this.screenshot,this.element),this.info=document.createElement("div"),this.info.style.display="none",this.element.appendChild(this.info),this.error=document.createElement("span"),this.element.appendChild(this.error)}},{key:"initUI",value:function(){this.element.style.width="306px",this.element.style.textAlign="center",this.element.style.marginBottom="8px",(0,g.vP)(this.element,"screenShotControl"),(0,g.vP)(this.button,"sscButton"),(0,f.Zs)(this.button,{fontFamily:"UbuntuRegular, Arial, Helvetica, sans-serif",border:"none",boxSizing:"border-box",display:"block",cursor:"pointer",textDecoration:"underline",padding:"0",marginBottom:"16px"}),(0,g.vP)(this.error,"error"),(0,g.vP)(this.info,"info"),this.info.style.margin="8px 0 10px"}},{key:"addScreenshot",value:function(){var e=this;if(this.canvas.canScreenshot()&&(this.removeScreenshot(),this.canvas.createScreenshot(),this.error.textContent="",void 0!==this.canvas.screenshot)){var t=this.canvas.screenshot.getContext("2d");if(null!==t){this.isCapturing=!0,this.modal.hide();var n=!1,i=document.createElement("video");i.style.display="none",this.canvas.element.appendChild(i),this.canvas.getDisplayMedia().then((function(o){i.srcObject=o,e.videoStream=o,i.play(),(0,c.j9)("canplay",i,(function(){n||(n=!0,window.setTimeout((function(){var n,o,r=window.innerWidth,s=window.innerHeight,a=i.videoWidth/i.videoHeight;s*a<r?(n=s*a,o=s):(o=r/a,n=r),e.canvas.setScreenshotDims(n,o),t.drawImage(i,0,0,n,o),e.screenshot.element.style.backgroundImage='url("'.concat(t.canvas.toDataURL("image/png"),'")'),e.screenshot.element.style.height="".concat(o/n*306,"px"),e.screenshot.element.style.display="flex",e.info.style.display="block",e.button.style.display="none",i.pause(),e.videoStream.getTracks().forEach((function(e){e.stop()})),e.canvas.element.removeChild(i),e.modal.show(),window.setTimeout((function(){e.isCapturing=!1}),1e3)}),250))}),!1)})).catch((function(t){e.modal.show(),"NotAllowedError"===t.name?e.error.textContent=v.ag.feedbackPermissionDenied:e.error.textContent=v.ag.feedbackUnknownCaptureError,e.canvas.element.removeChild(i),e.removeScreenshot()}))}}}},{key:"removeScreenshot",value:function(){this.canvas.canScreenshot()&&(this.screenshot.element.style.backgroundImage="",this.screenshot.element.style.display="none",this.button.textContent=v.ag.feedbackAddScreenshot,this.info.style.display="none",this.button.style.display="block",this.canvas.deleteScreenshot(),this.canvas.hide())}}]),n}(h.w),N=function(e){(0,s.Z)(n,e);var t=M(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,"div",{canvas:e})).canvas=e,(0,g.vP)(i.element,"drawControls"),i}return(0,r.Z)(n,[{key:"setScreenshot",value:function(e){this.screenshot=e}},{key:"initData",value:function(e){var t=this;this.element=B(),this.element.tabIndex=-1,this.drag=document.createElement("div"),this.drag.style.background="url(".concat(STATIC_URL_ROOT,"images/feedback/drag.svg) no-repeat center"),this.element.appendChild(this.drag),this.highlight=document.createElement("button"),this.highlight.type="button",(0,g.vP)(this.highlight,"highlight"),this.highlightImage=new Image,this.highlightImage.src="".concat(STATIC_URL_ROOT,"images/feedback/highlight_issue.svg"),this.highlight.appendChild(this.highlightImage),this.highlightText=document.createElement("span"),this.highlightText.textContent=v.ag.feedbackHighlightControl,this.highlight.appendChild(this.highlightText),(0,c.j9)("click",this.highlight,(function(){t.canvas.highlightBrush()})),this.element.appendChild(this.highlight),this.hide=document.createElement("button"),this.hide.type="button",this.hideImage=document.createElement("div"),this.hide.appendChild(this.hideImage),this.hideText=document.createElement("span"),this.hideText.textContent=v.ag.feedbackHideControl,this.hide.appendChild(this.hideText),(0,g.vP)(this.hide,"highlight"),(0,c.j9)("click",this.hide,(function(){t.canvas.hideBrush()})),this.element.appendChild(this.hide),this.hr=document.createElement("hr"),this.element.appendChild(this.hr),this.done=document.createElement("a"),(0,g.vP)(this.done,"done"),this.done.style.textDecoration="none",(0,c.j9)("click",this.done,(function(e){e.preventDefault(),t.updateScreenshotBackground(),t.canvas.hide()})),this.element.appendChild(this.done),(0,S.$q)(this.element,{},[this.drag]),(0,c.j9)("keydown",e.canvas.element,(function(e){e.stopPropagation(),27===e.keyCode&&"block"===t.element.style.display&&(e.stopImmediatePropagation(),t.updateScreenshotBackground(),t.canvas.hide())}))}},{key:"updateScreenshotBackground",value:function(){void 0!==this.canvas.screenshot&&void 0!==this.screenshot&&(this.screenshot.element.style.backgroundImage='url("'.concat(this.canvas.screenshot.toDataURL("image/png"),'")'))}},{key:"initUI",value:function(){(0,f.Zs)(this.element,{borderRadius:"4px",padding:"10px 15px 5px 15px",position:"fixed",zIndex:2010,textAlign:"right",width:"115px",height:"101px",fontFamily:"UbuntuMedium, Helvetica, Arial, sans-serif",userSelect:"none",boxShadow:"10px 10px 25px -5px rgba(0,0,0,0.75)"}),(0,f.Zs)(this.drag,{width:"20px",height:"10px",position:"absolute",right:"0",top:"5px"}),(0,g.vP)(this.highlight,"highlight"),(0,f.Zs)(this.highlight,{border:"0",display:"inline-block",padding:"5px",position:"relative",margin:"7px 0 0 0",left:"-15px",width:"145px",textAlign:"left",cursor:"pointer",fontFamily:"UbuntuMedium, Helvetica, Arial, sans-serif"}),(0,f.Zs)(this.highlightImage,{width:"23px",verticalAlign:"middle",marginRight:"10px"}),this.highlightText.style.verticalAlign="middle",(0,g.vP)(this.hide,"highlight"),(0,f.Zs)(this.hide,{border:"0",display:"inline-block",padding:"5px",position:"relative",margin:"0",left:"-15px",width:"145px",textAlign:"left",cursor:"pointer",fontFamily:"UbuntuMedium, Helvetica, Arial, sans-serif"}),(0,g.vP)(this.hideImage,"hideImage"),(0,f.Zs)(this.hideImage,{width:"20px",verticalAlign:"middle",marginRight:"10px",height:"20px",display:"inline-block"}),this.hideText.style.verticalAlign="middle",(0,f.Zs)(this.done,{padding:"4px",cursor:"pointer",textAlign:"right"}),this.done.textContent=v.ag.doneText}}]),n}(h.w),j=function(e){(0,s.Z)(n,e);var t=M(n);function n(){var e;return(0,o.Z)(this,n),(e=t.call(this)).fillRect=!1,e.mediaStreams=navigator.mediaDevices,void 0!==e.mediaStreams&&void 0!==e.mediaStreams.getDisplayMedia||(e.mediaStreams=void 0),void 0===document.createElement("canvas").toBlob&&(e.mediaStreams=void 0),e.controls=new N((0,C.Z)(e)),e.addChild(e.controls,e.element),e}return(0,r.Z)(n,[{key:"initData",value:function(){var e=this;this.element=B(),this.infoTooltip=B(this.element),this.infoTooltip.innerHTML="".concat(v.ag.feedbackHighlightInfo,' (<a href="#" onclick="this.parentNode.style.display=\'none\';">').concat(v.ag.dismissLower,"</a>)"),(0,c.j9)("click",this.infoTooltip,(function(){var t;null===(t=e.draw)||void 0===t||t.focus()})),this.infoTooltip.style.userSelect="none"}},{key:"initUI",value:function(){(0,g.vP)(this.element,"canvas"),(0,f.Zs)(this.element,{display:"none",position:"absolute",height:"100%",width:"100%"}),(0,g.vP)(this.infoTooltip,"infoToolTip"),(0,f.Zs)(this.infoTooltip,{position:"fixed",borderWidth:"1px",borderStyle:"solid",boxSizing:"border-box",zIndex:2020,top:"100px",left:"0",right:"0",margin:"0 auto",padding:"12px",fontWeight:"bold",width:"500px",textAlign:"center",fontFamily:"UbuntuMedium, Helvetica, Arial, sans-serif",fontSize:"1.3em"})}},{key:"canScreenshot",value:function(){return void 0!==this.mediaStreams&&!(0,x.s2)()}},{key:"getDisplayMedia",value:function(){if(!this.canScreenshot())throw new ReferenceError("Display media not supported by browser");return this.mediaStreams.getDisplayMedia({video:{displaySurface:"browser",cursor:!1},audio:!1})}},{key:"createScreenshot",value:function(){this.deleteScreenshot(),this.screenshot=document.createElement("canvas"),(0,f.Zs)(this.screenshot,{zIndex:2e3,top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0px auto",position:"fixed"}),this.hide(),this.element.appendChild(this.screenshot)}},{key:"deleteScreenshot",value:function(){this.deleteDraw(),void 0!==this.screenshot&&(this.element.removeChild(this.screenshot),this.screenshot=void 0)}},{key:"setScreenshotDims",value:function(e,t){void 0!==this.screenshot&&(this.screenshot.width=e,this.screenshot.height=t,this.screenshot.style.width="".concat(e,"px"),this.screenshot.style.height="".concat(t,"px"))}},{key:"createDraw",value:function(){void 0!==this.screenshot&&(void 0!==this.draw&&(this.element.removeChild(this.draw),this.draw=void 0),this.draw=this.screenshot.cloneNode(),this.draw.style.zIndex="2001",this.draw.tabIndex=0,this.element.appendChild(this.draw),this.refreshDraw())}},{key:"deleteDraw",value:function(){void 0!==this.draw&&(this.element.removeChild(this.draw),this.draw=void 0)}},{key:"hide",value:function(){this.element.style.display="none",this.clearBrush(),this.deleteDraw(),I.VY.showOnHomepage(),document.body.style.overflow="",E.fire(void 0)}},{key:"show",value:function(){this.element.style.display="block",this.controls.element.style.left="75px",this.controls.element.style.bottom="30px",this.infoTooltip.style.display="block",I.VY.hideOnHomepage(),document.body.style.overflow="hidden",this.createDraw(),this.highlightBrush(),void 0!==this.draw&&this.draw.focus(),A.fire(void 0)}},{key:"copyCanvas",value:function(e,t){if(void 0!==e&&void 0!==t){var n=t.getContext("2d");if(null!==n){var i=n.globalAlpha;n.globalAlpha=1,n.clearRect(0,0,t.width,t.height),n.drawImage(e,0,0),n.globalAlpha=i}}}},{key:"refreshDraw",value:function(){if(void 0!==this.draw){var e=this.draw.getContext("2d");if(null!==e){this.copyCanvas(this.screenshot,this.draw);var t=e.globalAlpha,n=e.strokeStyle;e.globalAlpha=.1,e.strokeStyle="rgb(0, 0, 0)",e.fillRect(0,0,this.draw.width,this.draw.height),e.globalAlpha=t,e.strokeStyle=n}}}},{key:"clearBrush",value:function(){this.controls.hide.style.backgroundColor="transparent",this.controls.hide.classList.toggle("active",!1),this.controls.highlight.style.backgroundColor="transparent",this.controls.highlight.classList.toggle("active",!1),void 0!==this.draw&&(void 0!==this.brushMouseListeners&&((0,c.SC)("mousedown",this.draw,this.brushMouseListeners.down),(0,c.SC)("mouseup",window,this.brushMouseListeners.up),(0,c.SC)("mousemove",window,this.brushMouseListeners.move),this.brushMouseListeners=void 0),this.draw.style.cursor="default")}},{key:"hideBrush",value:function(){if(this.clearBrush(),this.createDraw(),void 0!==this.draw){var e=this.draw.getContext("2d");null!==e&&((0,g.vP)(this.controls.hide,"active"),e.globalAlpha=1,e.strokeStyle="rgb(0, 0, 0)",e.lineWidth=5,this.fillRect=!0,this.canvasBrush())}}},{key:"highlightBrush",value:function(){if(this.clearBrush(),this.createDraw(),void 0!==this.draw){var e=this.draw.getContext("2d");null!==e&&((0,g.vP)(this.controls.highlight,"active"),e.globalAlpha=.8,e.strokeStyle="rgb(249, 185, 144)",e.lineWidth=5,this.fillRect=!1,this.canvasBrush())}}},{key:"canvasBrush",value:function(){var e=this;if(void 0!==this.draw){this.draw.style.cursor="crosshair";var t=this.draw.getContext("2d");if(null!==t){var n=0,i=0,o=0,r=0,s=0,a=0,l=!1,u=function(){n=0,i=0,s=0,a=0,l=!1};this.brushMouseListeners={down:function(o){l&&(e.drawBoxOnScreenshot(n,i,s,a,t),u());var r=e.draw.getBoundingClientRect();n=o.clientX-r.left,i=o.clientY-r.top,l=!0,t.canvas.style.cursor="crosshair"},up:function(o){l&&(e.drawBoxOnScreenshot(n,i,s,a,t),u())},move:function(c){if(l){var u=e.draw.getBoundingClientRect();o=c.clientX-u.left,r=c.clientY-u.top,e.refreshDraw(),s=o-n,a=r-i,e.drawBox(n,i,s,a,t)}}},(0,c.j9)("mousedown",this.draw,this.brushMouseListeners.down),(0,c.j9)("mouseup",window,this.brushMouseListeners.up),(0,c.j9)("mousemove",window,this.brushMouseListeners.move)}}}},{key:"drawBox",value:function(e,t,n,i,o){o.beginPath(),o.rect(e,t,n,i),this.fillRect?o.fill():o.stroke()}},{key:"drawBoxOnScreenshot",value:function(e,t,n,i,o){if(void 0!==this.screenshot){this.screenshot.style.cursor="crosshair";var r=this.screenshot.getContext("2d");null!==r&&(r.globalAlpha=o.globalAlpha,r.strokeStyle=o.strokeStyle,r.lineWidth=o.lineWidth,this.drawBox(e,t,n,i,r))}}}]),n}(h.w);function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var z=function(e){(0,s.Z)(n,e);var t=H(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,"div",e)).errors=[],i.canvas.canScreenshot()&&(i.updateInfoText(),i.errors.push(i.screenshot.error)),i.errors.push(i.globalError),(0,c.j9)("submit",i.form,(function(e){e.preventDefault(),i.submit()})),i}return(0,r.Z)(n,[{key:"initUI",value:function(e){this.element=B(),this.form=document.createElement("form"),this.form.action=(0,u.BN)("/feedback/submit/"),this.form.method="POST",this.element.appendChild(this.form),this.globalError=document.createElement("p"),this.globalError.style.color="red",this.globalError.style.marginBottom="8px",this.form.appendChild(this.globalError),this.sentiment=this.createSentimentSelection(),this.form.appendChild(this.sentiment.element),this.comments=this.createComments(),this.form.appendChild(this.comments.element),this.canvas=e.canvas,this.canvas.canScreenshot()&&(this.screenshot=new _(e.modal,this.canvas),this.addChild(this.screenshot,this.form)),this.notice=document.createElement("p"),(0,g.vP)(this.notice,"privacyNotice"),this.notice.style.fontSize="10.5px",this.notice.style.lineHeight="14px",this.notice.textContent=v.ag.feedbackNotice.replace("%SITE_NAME%",b.w.siteName),this.form.appendChild(this.notice),this.csrf=document.createElement("input"),this.csrf.type="hidden",this.csrf.name="csrfmiddlewaretoken",this.csrf.value=(0,d.ve)("csrftoken"),this.form.appendChild(this.csrf),this.url=document.createElement("input"),this.url.type="hidden",this.url.name="url",this.url.value=document.location.href.substr(0,255),this.form.appendChild(this.url),this.source=document.createElement("input"),this.source.type="hidden",this.source.name="source",this.source.value="",this.form.appendChild(this.source),this.submitRow=new D,this.addChild(this.submitRow,this.form)}},{key:"createSentimentSelection",value:function(){return new U}},{key:"createComments",value:function(){var e=this;return new Z({prompts:[v.ag.feedbackCommentsLabel],onChange:function(){window.setTimeout((function(){e.comments.anyCommentsNonempty()?e.submitRow.enable():e.submitRow.disable()}),200)},required:!0,textBoxHeight:72})}},{key:"canAddScreenshot",value:function(){return this.canvas.canScreenshot()&&"none"!==this.screenshot.button.style.display}},{key:"updateInfoText",value:function(){this.canAddScreenshot()&&(this.screenshot.info.textContent="footer"===this.source.value?v.ag.feedbackAddScreenshotInfoScrollUp:v.ag.feedbackAddScreenshotInfoScrollDown)}},{key:"updateCSRF",value:function(){this.csrf.value=(0,d.ve)("csrftoken")}},{key:"updateURL",value:function(){this.url.value=document.location.href.substr(0,255)}},{key:"updateSource",value:function(e){this.source.value=e,this.updateInfoText()}},{key:"updateSentiment",value:function(e){this.sentiment.setValue(e)}},{key:"clearErrors",value:function(){this.errors.forEach((function(e){e.textContent=""})),this.comments.clearErrors()}},{key:"resetForm",value:function(){this.forceForm(),this.clearErrors(),this.comments.clear(),this.sentiment.clearSelection(),this.submitRow.disable(),this.form.reset(),this.canvas.canScreenshot()&&this.screenshot.removeScreenshot()}},{key:"forceForm",value:function(){this.removeAllDOMChildren(),this.element.appendChild(this.form),this.comments.focus()}},{key:"submit",value:function(){var e=this;this.clearErrors();var t=new FormData;t.append("sentiment",this.sentiment.formInput.input.value),this.comments.prompts().forEach((function(e){t.append("prompts",e)})),this.comments.values().forEach((function(e){t.append("responses",e)})),t.append("url",document.location.href.substr(0,255)),t.append("source",this.source.value),t.append("csrfmiddlewaretoken",(0,d.ve)("csrftoken")),void 0!==this.canvas.screenshot?this.canvas.screenshot.toBlob((function(n){null!==n&&t.append("screenshot",n,"screenshot.png"),e.postFeedback(t)})):this.postFeedback(t)}},{key:"postFeedback",value:function(e){var t=this;this.submitRow.disable(),(0,u.I5)(this.form.action,e).then((function(e){var n=e.getResponseHeader("content-type");if(null!==n&&n.includes("text/html"))t.globalError.textContent=v.ag.feedbackBannedUser,t.submitRow.enable();else{t.resetForm(),t.element.removeChild(t.form);var i=document.createElement("p");i.textContent=v.ag.feedbackSubmitted,t.element.appendChild(i)}})).catch((function(e){if(429===e.xhr.status)t.globalError.textContent=v.ag.feedbackRateLimitError;else try{var n=JSON.parse(e.xhr.response).responses;void 0!==n&&n.forEach((function(e,n){return t.comments.setError(e,n)}))}catch(e){t.globalError.textContent=v.ag.feedbackUnknownError}t.submitRow.enable()}))}}]),n}(h.w),W=function(e){(0,s.Z)(n,e);var t=H(n);function n(){var e;return(0,o.Z)(this,n),(e=t.call(this,{onShow:function(){e.onShow()},onHide:function(){e.onHide()},easyExit:!0})).isVisible=!1,e.overlayClickStayOpen=!0,e.preventChatFocus=!0,e.element.classList.add("block_CB1_chat_focus"),(0,g.vP)(e.overlay,"overlayOpacity"),(0,g.vP)(e.element,"userFeedbackForm"),(0,g.vP)(e.element,g.ql.defaultColor),A.listen((function(){e.element.style.display="none"})),E.listen((function(){e.element.style.display="block"})),w.Co.listen((function(){e.hide()})),e.overlayClick.listen((function(){e.hide()})),e}return(0,r.Z)(n,[{key:"initData",value:function(){var e=this;this.canvas=new j,this.canvas.canScreenshot()&&document.body.appendChild(this.canvas.element),this.inner=B(this.element),this.close=new L,(0,c.j9)("click",this.close.control,(function(){e.hide()})),this.addChild(this.close,this.inner),this.header=new O,this.addChild(this.header,this.inner),this.form=this.createFormContent(),this.canvas.canScreenshot()&&this.canvas.controls.setScreenshot(this.form.screenshot.screenshot),this.addChild(this.form,this.inner);var t=function(){return e.form.submitRow.submit.disabled?e.close.control:e.form.submitRow.submit};this.element.querySelectorAll(".sentimentOption").forEach((function(t){(0,c.j9)("keydown",t,(0,f.hI)(e.form.comments.firstInput(),e.close.control))})),(0,c.j9)("keydown",this.form.comments.element,(0,f.hI)((function(){return e.form.canAddScreenshot()?e.form.screenshot.button:t()}),this.close.control)),this.form.canAddScreenshot()&&(0,c.j9)("keydown",this.form.screenshot.button,(0,f.hI)(t,this.form.comments.lastInput())),(0,c.j9)("keydown",this.form.submitRow.submit,(0,f.hI)(this.close.control,(function(){return e.form.canAddScreenshot()?e.form.screenshot.button:e.form.comments.lastInput()}))),(0,c.j9)("keydown",this.close.control,(0,f.hI)(this.form.comments.firstInput(),(function(){return e.form.submitRow.submit.disabled?e.form.canAddScreenshot()?e.form.screenshot.button:e.form.comments.lastInput():e.form.submitRow.submit})))}},{key:"initUI",value:function(){var e=this;(0,f.Zs)(this.element,{position:"fixed",top:"150px",fontSize:"12px",left:"50%",marginLeft:"-157px",width:"310px",height:"auto",border:"4px",borderRadius:"4px",padding:"15px",fontFamily:"UbuntuRegular, Helvetica, Arial, sans-serif"}),this.canvas.canScreenshot()&&(0,c.j9)("resize",window,(function(){e.form.screenshot.isCapturing||void 0===e.canvas.screenshot||(e.form.screenshot.removeScreenshot(),e.form.screenshot.error.textContent=v.ag.feedbackResize)}))}},{key:"createFormContent",value:function(){return new z({modal:this,canvas:this.canvas})}},{key:"showFromSource",value:function(e){this.form.updateSource(e.source),void 0!==e.sentiment&&this.form.updateSentiment(e.sentiment),this.show()}},{key:"onShow",value:function(){this.form.updateCSRF(),this.form.updateURL(),this.element.style.display="",this.repositionChildren(),this.isVisible=!0,(0,c.j9)("keydown",this.element,K),(0,c.j9)("keydown",document.body,J),this.form.forceForm()}},{key:"onHide",value:function(){var e=this.isVisible;this.element.style.display="none",this.isVisible=!1,e&&((0,c.SC)("keydown",this.element,K),(0,c.SC)("keydown",document.body,J));try{window.dispatchEvent(new Event("resize"))}catch(e){if(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0){var t=document.createEvent("UIEvents");t.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(t)}else error("Could not fire resize event")}this.canvas.hide()}}],[{key:"show",value:function(e){void 0===n.instance&&(n.instance=new n),n.instance.showFromSource(e)}}]),n}(p.z),V=function(e){(0,s.Z)(n,e);var t=H(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,e)).sentiment.inputChange.listen((function(){i.submitRow.enable()})),i}return(0,r.Z)(n,[{key:"createSentimentSelection",value:function(){var e=new U;return e.setPrompt(v.ag.feedbackBroadcasterLabel(b.w.siteName)),e}},{key:"createComments",value:function(){var e=this;return new Z({prompts:[v.ag.haveYouNoticedAnyBugs],onChange:function(){window.setTimeout((function(){""===e.sentiment.getValue()&&(e.comments.anyCommentsNonempty()?e.submitRow.enable():e.submitRow.disable())}),200)},required:!1,textBoxHeight:52})}},{key:"forceForm",value:function(){(0,i.Z)((0,l.Z)(n.prototype),"forceForm",this).call(this),this.comments.blur()}},{key:"submit",value:function(){var e,t;(0,i.Z)((0,l.Z)(n.prototype),"submit",this).call(this);var o=new FormData;o.append("rating",this.sentiment.formInput.input.value),o.append("url",document.location.href.substr(0,255)),o.append("room_user",null!==(e=null===(t=y.J.current.loggedInUser)||void 0===t?void 0:t.username)&&void 0!==e?e:""),(0,u.I5)(m.MP,o).catch((function(){}))}}]),n}(z),q=function(e){(0,s.Z)(n,e);var t=H(n);function n(){var e;return(0,o.Z)(this,n),(e=t.call(this)).form.updateSource("broadcaster_sentiment_survey"),e}return(0,r.Z)(n,[{key:"createFormContent",value:function(){return new V({modal:this,canvas:this.canvas})}}],[{key:"show",value:function(){void 0===n.instance&&(n.instance=new n),n.instance.show()}}]),n}(W),K=function(e){27!==e.keyCode&&e.stopImmediatePropagation()},J=function(e){32===e.keyCode&&e.target===document.body&&e.preventDefault()}},2800:function(e,t,n){"use strict";n.d(t,{J:function(){return v},q:function(){return g}});var i=n(4649),o=n(1976),r=n(2951),s=n(7591),a=n(9492),l=n(7597),c=n(1794),u=function(){function e(){(0,r.Z)(this,e),this.isSet=!1}return(0,o.Z)(e,[{key:"current",get:function(){return this.value},set:function(e){this.isSet||(this.value=e,this.isSet=!0)}}]),e}(),d=n(457);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=function(e){(0,s.Z)(c,e);var t,n,i=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function c(){return(0,r.Z)(this,c),i.apply(this,arguments)}return(0,o.Z)(c)}(u),m=function(){function e(t){(0,r.Z)(this,e),this.onUpdate=new c.xB("RoomDossierContextUpdate",{maxHistorySize:1}),this.state=t}return(0,o.Z)(e,[{key:"getState",value:function(){return f({},this.state)}},{key:"setState",value:function(e){if(this.hasChanges(e)){var t=this.state;this.state=f(f({},this.state),e),this.onUpdate.fire(t)}}},{key:"hasChanges",value:function(e){for(var t in e)if(!(0,d.d)(e[t],this.state[t]))return!0;return!1}}]),e}(),v=new p,g=new m({room:"",chatUserName:"",viewerPassword:"",roomPassword:"",chatRules:"",roomUid:"",viewerUid:"",host:"",roomTitle:"",appsRunning:[{app_name:"",app_location:""}],roomStatus:"public",userName:"",edgeAuth:"",viewerGender:"m",hlsSource:"",allowAnonymousTipping:!1,privateMinMinutes:0,allowShowRecordings:!1,numViewers:0,isWidescreen:!1,roomGender:"f",allowPrivateShow:!1,privatePrice:6,spyPrice:0,privateShowId:"",hasLowSatisfactionScore:!1,isAgeVerified:!0,hiddenMessage:"",following:!0,followNotificationFrequency:"smart",isModerator:!1,broadcasterIsOnNewChat:!1,tokenBalance:0,isSupporter:!1,needsSupporterToPm:!0,serverName:"",numFollowed:0,numFollowedOnline:0,hasStudio:!1,isMobile:!1,ignoredEmoticons:[],hideSatisfactionScore:!1,satisfactionScore:{upVotes:0,downVotes:0,percent:100},tipsInPast24Hours:0,lastVoteInPast24Hours:0,lastVoteInPast90DaysDown:!1,tfaEnabled:!1,dismissibleMessages:[],showMobileSiteBannerLink:!1,exploringHashTag:"",sourceName:"un",isInFanClub:!1,hasFanClub:!1,paidTokensFanClub:!1,userChatSettings:{fontSize:"",fontColor:"",fontFamily:"",showEmoticons:!0,emoticonAutocompleteDelay:"5",sortUsersKey:"a",modExpiration:0,roomEntryFor:1,roomLeaveFor:1,c2cNotificationLimit:"0",silenceBroadcasters:"false",ignoredUsers:"",allowedChat:"",viewerTipVolume:0,broadcasterTipVolume:0,highestTokenColor:""},browserId:"",aspAuthUrl:"",quality:{quality:"good",rate:0,stopped:!0},edgeRegion:""})},8626:function(e,t,n){"use strict";n.d(t,{gi:function(){return s},vj:function(){return r}});var i=n(1282),o=n(3543),r=function(){return(0,i.L)("Shortcode")},s=([].concat(["fanclub","follow","signup","supporter","help"],["tip"]),function(e,t){var n="".concat(o.ag.shortcodeHelp,"\n\n    ").concat(o.ag.shortcode,": [cb:signup]\n    ").concat(o.ag.shortcodeHelpSignup(),"\n\n    ").concat(o.ag.shortcode,": [cb:supporter]\n    ").concat(o.ag.shortcodeHelpSupporter(),"\n\n    ").concat(o.ag.shortcode,": [cb:fanclub]\n    ").concat(o.ag.shortcodeHelpFanclub(e),"\n\n    ").concat(o.ag.shortcode,": [cb:follow]\n    ").concat(o.ag.shortcodeHelpFollow(e));return t&&(n+="\n\n            ".concat(o.ag.shortcode,': [cb:tip amount=50 message="').concat(o.ag.shortcodeHelpTipExample,'"]\n            ').concat(o.ag.shortcodeHelpTip())),n})},9839:function(e,t,n){"use strict";n.d(t,{u:function(){return l}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597);var l=function(e){(0,r.Z)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function c(e,t){var n,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,i.Z)(this,c),(n=l.call(this)).userCanAccess=o,n.leftContainer=document.createElement("div"),n.rightContainer=document.createElement("div"),n.leftContainer.style.display=n.rightContainer.style.display="inline-block",n.leftContainer.style.height=n.rightContainer.style.height="calc(100% - 20px)",n.leftContainer.style.width=n.rightContainer.style.width="50%",n.leftContainer.style.top=n.rightContainer.style.top="0px",n.leftContainer.style.position=n.rightContainer.style.position="absolute",n.leftContainer.style.left=n.rightContainer.style.right="0px",n.userCanAccess&&(n.leftContainer.style.cursor=n.rightContainer.style.cursor="pointer"),n.leftArrow=document.createElement("div"),n.rightArrow=document.createElement("div"),n.leftArrow.style.position=n.rightArrow.style.position="absolute",n.leftArrow.style.top=n.rightArrow.style.top="".concat((n.leftContainer.offsetHeight-50)/2,"px"),n.leftArrow.style.height=n.rightArrow.style.height="50px",n.leftArrow.style.width=n.rightArrow.style.width="30px",n.leftArrow.style.userSelect=n.rightArrow.style.userSelect="none",n.leftArrow.style.webkitUserSelect=n.rightArrow.style.webkitUserSelect="none",n.leftArrow.style.left=n.rightArrow.style.right="0";var r=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d","M5.7 0L0 5.55 18.6 24 0 42.45 5.7 48 30 24 5.7 0z"),n.setAttribute("fill","#E2E2E2"),"left"===e&&n.setAttribute("transform","translate(30, 0) scale(-1,1)"),t.appendChild(n),t.setAttribute("viewBox","0 0 30 50"),t},s=r("left"),a=r("right");n.leftArrow.appendChild(s),n.rightArrow.appendChild(a),n.leftContainer.appendChild(n.leftArrow),n.rightContainer.appendChild(n.rightArrow);var u=n.leftArrow.firstChild.firstChild,d=n.rightArrow.firstChild.firstChild,h=function(e){n.userCanAccess&&("left"===e?u.style.fill="#B8B8B8":d.style.fill="#B8B8B8")},f=function(e){"left"===e?u.style.fill="#E2E2E2":d.style.fill="#E2E2E2"};return n.leftContainer.onmouseenter=function(){h("left")},n.leftContainer.onmouseleave=function(){f("left")},n.rightContainer.onmouseenter=function(){h("right")},n.rightContainer.onmouseleave=function(){f("right")},n.leftContainer.onclick=e,n.rightContainer.onclick=t,n}return(0,o.Z)(c,[{key:"repositionArrows",value:function(e){this.leftArrow.style.top=this.rightArrow.style.top="".concat((e-50)/2,"px")}},{key:"shiftArrows",value:function(e){this.leftArrow.style.left=this.rightArrow.style.right="".concat(e,"px")}},{key:"showArrows",value:function(){this.leftContainer.style.visibility=this.rightContainer.style.visibility="normal",this.userCanAccess&&(this.leftContainer.style.cursor=this.rightContainer.style.cursor="pointer")}},{key:"hideArrows",value:function(){this.leftContainer.style.visibility=this.rightContainer.style.visibility="hidden"}}]),c}(n(9).w)},457:function(e,t,n){"use strict";n.d(t,{d:function(){return o}});var i=n(3940);function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(isNaN(e)&&isNaN(t)&&"number"==typeof e&&"number"==typeof t)return!0;if(e===t)return!0;if(e instanceof Function)return e===t;if("function"==typeof e&&"function"==typeof t||e instanceof Date&&t instanceof Date||e instanceof RegExp&&t instanceof RegExp||e instanceof String&&t instanceof String||e instanceof Number&&t instanceof Number)return e.toString()===t.toString();if(!(e instanceof Object&&t instanceof Object))return!1;if(e.isPrototypeOf(t)||t.isPrototypeOf(e))return!1;if(e.constructor!==t.constructor)return!1;if(e.prototype!==t.prototype)return!1;for(var r in t)if(!(n.indexOf(r)>=0)){if(t.hasOwnProperty(r)!==e.hasOwnProperty(r))return!1;if((0,i.Z)(t[r])!==(0,i.Z)(e[r]))return!1}for(var s in e)if(!(n.indexOf(s)>=0)){if(t.hasOwnProperty(s)!==e.hasOwnProperty(s))return!1;if((0,i.Z)(t[s])!==(0,i.Z)(e[s]))return!1;switch((0,i.Z)(e[s])){case"object":case"function":if(!o(e[s],t[s],n))return!1;break;default:if(e[s]!==t[s])return!1}}return!0}},7600:function(e,t,n){"use strict";n.d(t,{_:function(){return oe}});var i=n(5809),o=n(2951),r=n(1976),s=n(391),a=n(8069),l=n(1794),c=n(3705),u=n(9545),d=n(2800),h=n(3243),f=n(7591),p=n(9492),m=n(7597),v=n(8759),g=n(7693),y=n(126),b=n(9570);function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function C(e){switch(e){case"initialized":return"initialized";case"connecting":return"connecting";case"connected":return"connected";case"closing":return"closing";case"closed":return"closed";case"disconnected":case"unavailable":return"disconnected";case"failed":return"failed";case"suspended":return"suspended";default:return"unknown"}}function x(e){switch(e){case"initialized":return"initialized";case"attaching":return"subscribing";case"attached":return"subscribed";case"detaching":return"unsubscribing";case"detached":return"unsubscribed";case"failed":return"failed";case"suspended":return"suspended";default:return"unknown"}}function k(e,t){void 0!==t&&Object.keys(t).forEach((function(n){var i=t[n];e.set(n,i)}))}var S=function(){function e(t){(0,o.Z)(this,e),t.ignore("client_id"),this.topicKeyToChannelName=new Map,this.channelNameToTopicKeys=new Map,this.channelNameToTopicsMap=new Map,this.failures=new Map,t.keys().includes("settings")||warn("PushServiceContext: settings not found in context",{contextKeys:t.keys().join(","),context:t.stringMessage});var n=t.getParsedSubMap("settings");this.settings=this.parseSettings(n),k(this.settings.flags,n.getObjectOrUndefined("flags")),this.populateTopics(t.getObjectOrUndefined("channels")),k(this.failures,t.getObjectOrUndefined("failures"))}return(0,r.Z)(e,[{key:"populateTopics",value:function(e){if(void 0!==e)for(var t=0,n=Object.keys(e);t<n.length;t++){var i=n[t],o=i.split("#")[0],r=i.split("#")[1],s=e[i];this.topicKeyToChannelName.set(r,s);var a=this.channelNameToTopicKeys.get(s);void 0===a?this.channelNameToTopicKeys.set(s,[r]):(a.push(r),this.channelNameToTopicKeys.set(s,a));var l=this.channelNameToTopicsMap.get(s);if(void 0===l)l=new Map;else if(l.has(o))return void warn("A topic with different topic keys is being registered on the same channel. This should never happen!",{channelName:s,topicId:o},"PUSH_");l.set(o,r),this.channelNameToTopicsMap.set(s,l)}}},{key:"getChannelName",value:function(e){return this.topicKeyToChannelName.get(e)}},{key:"getTopicKeys",value:function(e){return this.channelNameToTopicKeys.get(e)}},{key:"deleteChannel",value:function(e){this.channelNameToTopicKeys.delete(e)}},{key:"deleteTopic",value:function(e){this.topicKeyToChannelName.delete(e)}},{key:"getChannelTopicMap",value:function(e){return this.channelNameToTopicsMap.get(e)}},{key:"getFailedTopics",value:function(){return Array.from(this.failures.keys(),(function(e){return e.split("#")[1]}))}}]),e}(),T=function(){function e(t){(0,o.Z)(this,e),this.callbacks=t,this.activeSubscriptions=new Set,this.topicsToSubscribe=new Set,this.topicPromises=new Map,this.creationTime=(new Date).getTime(),this.seenMessages=new Map,this.seenMessagesLimit=5e3,this.messagesInChat=new Map,this.failedTopics=new Map,this.criticalFailLimit=3,this.subscribedTopicKeysByChannel=new Map}return(0,r.Z)(e,[{key:"addPageAction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,c.NS)()&&(t.action=e,t.created=this.creationTime,t.client=this.clientName,(0,c.fg)("PushServiceClient",t))}},{key:"connect",value:function(){var e=this;return this.isConnected()?Promise.resolve():this.hasBusyConnection()&&void 0===this.connectPromise?Promise.reject("Connection is currently busy!"):(void 0===this.connectPromise&&(this.connectPromise=new Promise((function(t,n){e.connectionChange.listen((function i(o){"connected"===o.current?e.isConnected()&&(e.connectPromise=void 0,e.connectionChange.removeListener(i),t()):"connecting"===o.previous&&(e.connectPromise=void 0,e.connectionChange.removeListener(i),n(o.reason))})),e._connect()}))),this.connectPromise)}},{key:"isConnected",value:function(){return"connected"===this.getConnectionState()}},{key:"hasBusyConnection",value:function(){return new Set(["connecting","closing"]).has(this.getConnectionState())}},{key:"ensureConnected",value:function(){return this.isConnected()?Promise.resolve():this.connect()}},{key:"ensureConnectedAndAuthed",value:function(e){var t=this;return this.ensureConnected().then((function(){return t.auth.canAccessTopic(e)?Promise.resolve():Promise.reject("Auth context has no access: ".concat(t.auth.serialize()))}))}},{key:"getAuthPromise",value:function(e){var t=this,n=[],i=[];return e.forEach((function(e){-1===t.auth.getTopicKeys().indexOf(e)&&n.push(e),t.isSubscribedTo(e)&&!b.Z.hasPresence(e)||i.push(e)})),n.length<1?Promise.resolve():this.auth.updateAuthToken()}},{key:"isSubscribedTo",value:function(e){return this.auth.canAccessTopic(e)&&this.activeSubscriptions.has(e)}},{key:"subscribe",value:function(e){var t=this;return this.topicsToSubscribe.add(e),this.updateChannelSubscription(e).then((function(){return t.handleSubscribed(e),t.topicPromises.delete(e),Promise.resolve()})).catch((function(n){return t.handleTopicFailure(e),t.topicPromises.delete(e),["closed","closing","disconnected"].includes(t.getConnectionState())?Promise.resolve():Promise.reject(n)}))}},{key:"unsubscribe",value:function(e){var t=this;return this.topicsToSubscribe.delete(e),this.updateChannelSubscription(e).then((function(){t.handleUnsubscribed(e),t.topicPromises.delete(e)})).catch((function(n){return t.handleUnsubscribed(e),t.topicPromises.delete(e),Promise.reject(n)}))}},{key:"updateChannelSubscription",value:function(e){var t=this,n=this.topicPromises.get(e);if(void 0!==n)return n.then((function(){return t.updateChannelSubscription(e)}));var i=this.getChannelName(e);if(void 0===i)return Promise.reject({code:"topic_error",message:"Unknown topic key"});var o=this.getChannelState(i);return this.topicsToSubscribe.has(e)?"subscribed"===o||"subscribing"===o?Promise.resolve():this._subscribe(e):"unsubscribed"===o||"unsubscribing"===o?Promise.resolve():this._unsubscribe(e)}},{key:"checkForReauth",value:function(e){var t=this;if("reauth"===e.getStringOrUndefined("_control")){var n=e.getStringList("_channel_names"),i=[],o=b.Z.getPresenceKeys();n.forEach((function(e){var n=t.getTopicKeys(e);void 0!==n?n.forEach((function(e){i.push(t.unsubscribe(e))})):i.push(Promise.resolve())})),i.push.apply(i,(0,y.Z)(o.map((function(e){return t.unsubscribe(e)})))),Promise.all(i).then((function(){n.forEach((function(e){var n,i=t.getTopicKeys(e);null===(n=t.context)||void 0===n||n.deleteChannel(e),void 0!==i&&i.forEach((function(e){var n;null===(n=t.context)||void 0===n||n.deleteTopic(e)}))})),oe.updateAuthorization()})).catch((function(e){e.topics=n,error("Error during re-auth detach",e,"PUSH_")}))}}},{key:"handleSubscribed",value:function(e){this.failedTopics.delete(e),this.activeSubscriptions.add(e),this.callbacks.onSubscribe(this.clientName,e,!0)}},{key:"handleUnsubscribed",value:function(e){this.failedTopics.delete(e),this.activeSubscriptions.delete(e),this.callbacks.onSubscribe(this.clientName,e,!1)}},{key:"handleTopicFailure",value:function(e){var t=this.failedTopics.get(e);this.failedTopics.set(e,void 0===t?1:t+1)}},{key:"shouldRetrySubscribe",value:function(){var e,t=this.auth.getTopicKeys(),n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(this.failedTopics.entries());try{for(n.s();!(e=n.n()).done;){var o=(0,i.Z)(e.value,2),r=o[0],s=o[1];if(t.includes(r)&&s<this.criticalFailLimit)return!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"getCriticallyFailedTopics",value:function(){var e=this;return Array.from(this.failedTopics.keys()).filter((function(t){var n=e.failedTopics.get(t);return void 0!==n&&n>e.criticalFailLimit}))}},{key:"getConnectionType",value:function(){return""}},{key:"getConnectionId",value:function(){return""}},{key:"getClientId",value:function(){return""}},{key:"getConnectionHost",value:function(){return""}},{key:"getConnectionServer",value:function(){return""}},{key:"getConnectionSerial",value:function(){return""}},{key:"getChannelName",value:function(e){var t;return null===(t=this.context)||void 0===t?void 0:t.getChannelName(e)}},{key:"getTopicKeys",value:function(e){var t;return null===(t=this.context)||void 0===t?void 0:t.getTopicKeys(e)}},{key:"getChannelTopicMap",value:function(e){var t;return null===(t=this.context)||void 0===t?void 0:t.getChannelTopicMap(e)}},{key:"addExternalMessage",value:function(e,t){var n="".concat(this.getChannelName(e),":").concat(t);return void 0!==this.messagesInChat.get(n)||(this.messagesInChat.set(n,[]),void 0!==this.seenMessages.get(n))}},{key:"handleMessageDuplicate",value:function(e,t,n){var i="".concat(e,":").concat(n),o=this.seenMessages.get(i),r=!1;if(void 0===o){if(this.seenMessages.size>this.seenMessagesLimit){var s=Array.from(this.seenMessages.entries());this.seenMessages=new Map(s.splice(Math.floor(-.5*s.length)))}if(this.seenMessages.set(i,[this.getDuplicateMessageMeta(t)]),void 0===this.messagesInChat.get(i))return[!1,r];r=!0}else o.push(this.getDuplicateMessageMeta(t)),0!==o.length&&this.reportDuplicateMessage(e,t,n,o);return[!0,r]}},{key:"reportDuplicateMessage",value:function(e,t,n,i){var o=this.duplicateMessageAttributes(e,t,n,i);debug("[PushService] Duplicate Message: ",o),(0,c.NS)()&&(0,c.fg)("PushDuplicateMessage",o)}},{key:"duplicateMessageAttributes",value:function(e,t,n,i){var o,r=i[0],s=null!==(o=t.getParsedSubMap("providerData").getStringOrUndefined("id"))&&void 0!==o?o:"invalid_provider_id",a=this.hashMessage(t.stringMessage);return{tid:n,first_seen_time:r.timestamp,time_since_first_seen:(new Date).getTime()-r.timestamp,num_duplicates:i.length,client:this.clientName,connection_host:this.getConnectionHost(),connection_type:this.getConnectionType(),connection_state:this.getConnectionState(),num_reconnects:this.getReconnectCount(),same_content:a===r.hash,same_pid:s===r.providerId,same_server:r.server===this.hashMessage(this.getConnectionServer()),same_host:r.host===this.hashMessage(this.getConnectionHost()),orig_connection_serial:r.connectionSerial,channel_name:e,pid:s}}},{key:"hashMessage",value:function(e){return""===e?"":Array.from(e,(function(e){return e.charCodeAt(0)})).reduce((function(e,t){return e+t})).toString()+e.length.toString()}},{key:"getDuplicateMessageMeta",value:function(e){var t;return{timestamp:(new Date).getTime(),hash:this.hashMessage(e.stringMessage),providerId:null!==(t=e.getParsedSubMap("providerData").getStringOrUndefined("id"))&&void 0!==t?t:"invalid_provider_id",server:this.hashMessage(this.getConnectionServer()),host:this.hashMessage(this.getConnectionHost()),connectionSerial:this.getConnectionSerial()}}}]),e}();var I="a",R=function(e){(0,f.Z)(c,e);var t,n,a=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,m.Z)(t);if(n){var o=(0,m.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,p.Z)(this,e)});function c(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,o.Z)(this,c),(n=a.call(this,e)).clientName=I,n.shouldRewind=new Set,n.settings=t,n.connectionChange=new l.xB("AblyClientConnection"),n.shouldAutoDisconnect=!i;try{n.realtime=new Ably.Realtime.Promise(n.getClientOptions())}catch(e){throw Z("connect",e.toString())}n.auth=new U(n.realtime);var r=["disconnected","failed","suspended"];return n.realtime.connection.on((function(e){if(e.previous!==e.current){var t,i=C(e.previous),o=C(e.current),s=F("connect",e.reason);(r.includes(o)&&204!==(null===(t=e.reason)||void 0===t?void 0:t.statusCode)||"connected"===o)&&n.connectionChange.fire({previous:i,current:o,reason:s,client:"a"})}})),n.shouldAutoDisconnect||(0,g.j9)((0,v.BV)(),window,(function(){n.close()})),n}return(0,r.Z)(c,[{key:"getClientOptions",value:function(){var e=this,t={autoConnect:!1,closeOnUnload:this.shouldAutoDisconnect,log:{level:1},authCallback:function(t,n){e.auth.fetchTokenRequest().then((function(t){t.isValid()?(e.context=t,n(void 0,t.getTokenRequest())):n("Invalid token request")})).catch((function(e){n(e.message)}))},restHost:this.settings.restHost,realtimeHost:this.settings.realtimeHost,transportParams:{remainPresentFor:"0"}};return this.settings.fallbackHosts.length>0&&(t.fallbackHosts=this.settings.fallbackHosts),t}},{key:"_connect",value:function(){this.realtime.connect()}},{key:"close",value:function(){this.realtime.close()}},{key:"getConnectionState",value:function(){return C(this.realtime.connection.state)}},{key:"getChannelState",value:function(e){return x(this.realtime.channels.get(e).state)}},{key:"getConnectionType",value:function(){var e,t;return null!==(e=null===(t=this.realtime.connection)||void 0===t||null===(t=t.connectionManager)||void 0===t||null===(t=t.activeProtocol)||void 0===t||null===(t=t.transport)||void 0===t?void 0:t.shortName)&&void 0!==e?e:""}},{key:"getConnectionId",value:function(){return this.realtime.connection.id}},{key:"getClientId",value:function(){var e,t;return null!==(e=null===(t=this.realtime.connection)||void 0===t||null===(t=t.connectionManager)||void 0===t||null===(t=t.connectionDetails)||void 0===t?void 0:t.clientId)&&void 0!==e?e:""}},{key:"getConnectionHost",value:function(){var e,t;return null!==(e=null===(t=this.realtime.connection)||void 0===t||null===(t=t.connectionManager)||void 0===t?void 0:t.host)&&void 0!==e?e:""}},{key:"getConnectionServer",value:function(){var e,t;return null!==(e=null===(t=this.realtime.connection)||void 0===t||null===(t=t.connectionManager)||void 0===t||null===(t=t.connectionDetails)||void 0===t?void 0:t.serverId)&&void 0!==e?e:""}},{key:"getConnectionSerial",value:function(){var e,t;return null!==(e=null===(t=this.realtime.connection)||void 0===t||null===(t=t.connectionManager)||void 0===t?void 0:t.connectionSerial)&&void 0!==e?e:""}},{key:"getReconnectCount",value:function(){return-1}},{key:"duplicateMessageAttributes",value:function(e,t,n,i){var o,r,s,a,l,u,d=(0,h.Z)((0,m.Z)(c.prototype),"duplicateMessageAttributes",this).call(this,e,t,n,i);return d.connection_id=this.getConnectionId(),d.recovery_key=this.realtime.connection.recoveryKey,d.client_id=this.getClientId(),d.server_id=this.getConnectionServer(),d.connection_serial=this.getConnectionSerial(),d.connection_key=null!==(o=null===(r=this.realtime.connection)||void 0===r||null===(r=r.connectionManager)||void 0===r||null===(r=r.connectionDetails)||void 0===r?void 0:r.connectionKey)&&void 0!==o?o:"",d.msg_serial=null!==(s=null===(a=this.realtime.connection)||void 0===a||null===(a=a.connectionManager)||void 0===a?void 0:a.msgSerial)&&void 0!==s?s:"",d.recovery_key=null!==(l=null===(u=this.realtime.connection)||void 0===u?void 0:u.recoveryKey)&&void 0!==l?l:"",d}},{key:"_subscribe",value:function(e){var t=this,n=this.getChannelName(e);if(void 0===n)return Promise.reject(Z("topic_error","Invalid topic key reached subscribe"));var o=this.subscribedTopicKeysByChannel.get(n);if(void 0===o)this.subscribedTopicKeysByChannel.set(n,[e]);else if(!o.includes(e))return o.push(e),this.subscribedTopicKeysByChannel.set(n,o),Promise.resolve();var r=this.realtime.channels.get(n),a=new Promise((function(o,a){t.ensureConnectedAndAuthed(e).then((function(){var n=t.shouldRewind.delete(e);return r.setOptions({cipher:void 0,params:n?{rewind:"30s"}:{},modes:["SUBSCRIBE","PRESENCE"]})})).then((function(){return r.attach()})).then((function(){return r.unsubscribe(),r.subscribe((function(e){e.data.providerData={id:e.id,ts:e.timestamp};var o=new s.j(e.data);t.checkForReauth(o);var r,a=t.getChannelTopicMap(n);if(void 0!==a&&(r=a.get(o.getString("_topic"))),void 0!==r){var l=t.handleMessageDuplicate(n,o,o.getString("tid")),c=(0,i.Z)(l,2),u=c[0],d=c[1];if(u&&!d)return;t.callbacks.onMessage(t.clientName,r,o,d)}else warn("Received message for unknown topic",{topic:o.getString("_topic"),client:t.clientName})}))})).then((function(){o()})).catch((function(e){"suspended"===r.state&&r.detach().then().catch((function(){})),a(Z("subscribe",e))}))}));return this.topicPromises.set(e,a),a}},{key:"_unsubscribe",value:function(e){var t=this.getChannelName(e);if(void 0===t)return Promise.reject(Z("topic_error","Invalid topic key reached unsubscribe"));var n=this.subscribedTopicKeysByChannel.get(t);if(void 0!==n&&n.includes(e)){var i=n.indexOf(e);if(n.splice(i,1),this.subscribedTopicKeysByChannel.set(t,n),0!==n.length)return Promise.resolve();this.subscribedTopicKeysByChannel.delete(t)}var o=this.realtime.channels.get(t),r=x(o.state);if(o.unsubscribe(),["unsubscribed","initialized","failed"].includes(r))return this.handleUnsubscribed(e),Promise.resolve();var s=new Promise((function(e,t){o.detach().then((function(){e()})).catch((function(e){t(Z("unsubscribe",e))}))}));return this.topicPromises.set(e,s),s}},{key:"enterPresence",value:function(e,t){var n=this,i=this.topicPromises.get(e);if(void 0!==i)return Promise.reject(Z("topic_error","Called subscribe while channel is busy"));var o=this.getChannelName(e);if(void 0===o)return Promise.reject(Z("topic_error","Unknown topic key"));var r=this.realtime.channels.get(o);return new Promise((function(i,s){n.ensureConnectedAndAuthed(e).then((function(){return r.setOptions({cipher:void 0,params:{},modes:["SUBSCRIBE","PRESENCE"]})})).then((function(){return r.attach()})).then((function(){var e=n.auth.getCapabilities()[o];return Array.isArray(e)&&e.includes("presence")?void 0!==t&&t.changed?r.presence.update(t.data):Promise.resolve():Promise.reject(Z("presence","Token does not have capability for presence"))})).then((function(){n.handleSubscribed(e),i()})).catch((function(t){n.topicPromises.delete(e),n.handleTopicFailure(e),s(Z("presence",t))}))}))}},{key:"leavePresence",value:function(e){var t=this,n=this.getChannelName(e);return void 0===n?Promise.reject(Z("topic_error","Unknown topic key")):this.realtime.channels.get(n).presence.leave().then((function(){t.handleUnsubscribed(e)})).catch((function(n){return t.handleUnsubscribed(e),Promise.reject(Z("presence",n))}))}},{key:"getSubscriptionState",value:function(e){var t=this.getChannelName(e);return void 0===t?"unknown":x(this.realtime.channels.get(t).state)}},{key:"isSubscribedTo",value:function(e){return"subscribed"===this.getSubscriptionState(e)}}]),c}(T);var P=function(e){(0,f.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,m.Z)(t);if(n){var o=(0,m.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,p.Z)(this,e)});function s(e){var t;return(0,o.Z)(this,s),(t=i.call(this,e)).tokenRequest=e.getObject("token_request"),t.jwtToken=e.getString("token"),""!==t.jwtToken&&void 0!==t.tokenRequest.keyName||warn("invalid AblyContext",{contextKeys:e.keys().join(","),context:e.stringMessage}),e.ignore("token_request"),e.logUnusedDebugging("AblyContext"),t}return(0,r.Z)(s,[{key:"parseSettings",value:function(e){return s.parseSettings(e)}},{key:"isValid",value:function(){return void 0!==this.tokenRequest}},{key:"getTokenRequest",value:function(){if(void 0===this.jwtToken)throw new Error("Access to AblyContext.tokenRequest on an invalid context!");return this.jwtToken}},{key:"serialize",value:function(){return JSON.stringify(this.tokenRequest)}}],[{key:"parseSettings",value:function(e){var t={backend:I,restHost:e.getStringOrUndefined("rest_host"),realtimeHost:e.getStringOrUndefined("realtime_host"),fallbackHosts:e.getStringList("fallback_hosts"),flags:new Map};return k(t.flags,e.getObjectOrUndefined("flags")),t}}]),s}(S),M=n(3940),A=n(4649),E=n(3753);function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var L="push_service/auth/";function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=oe.getClientName()===e,i=oe.getTopicKeysToAuth();i.length>100&&(warn("PushService is attempting to request too many topics",{},"PUSH_"),i.length=100);var o={};i.forEach((function(e){var t=oe.getTopicAuthData(e);void 0===t||t.subscribeOnlyOnPrimaryBackend&&!n||(o[t.key]=t.payload)}));var r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){(0,A.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({presence_id:"".concat(n?"+":"-").concat(oe.presenceId),topics:JSON.stringify(o),backend:e},t);return(0,E.I5)(L,r).then((function(e){try{var t=new s.j(e.responseText);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}))}var D=function(){function e(t){(0,o.Z)(this,e),this.tokenDetails=t,this.capability=this.parseCapability(t.getString("x-ably-capability"))}return(0,r.Z)(e,[{key:"getChannelNames",value:function(){return Object.keys(this.capability)}},{key:"parseCapability",value:function(e){for(var t={},n=JSON.parse(e),i=0,o=Object.keys(n);i<o.length;i++){var r=o[i],s=n[r];s instanceof Array?t[r]=s.map((function(e){return e})):error("Invalid capability type for topic: ".concat(r),{capability:e},"PUSH_")}return t}}]),e}(),U=function(){function e(t,n){(0,o.Z)(this,e),this.consecutiveAuthFails=0,this.realtime=t,this.ablyContext=n}return(0,r.Z)(e,[{key:"serialize",value:function(){var e;return!0!==(null===(e=this.ablyContext)||void 0===e?void 0:e.isValid())?"":this.ablyContext.serialize()}},{key:"getCapabilities",value:function(){var e=this.authToken;return void 0===e?{}:e.capability}},{key:"fetchTokenRequest",value:function(){var e=this;return new Promise((function(t,n){return O(I).then((function(n){e.consecutiveAuthFails=0,e.reportFailedTopics(n),e.ablyContext=new P(n),t(e.ablyContext)})).catch((function(t){var i;e.consecutiveAuthFails+=1;var o=null===(i=e.ablyContext)||void 0===i?void 0:i.settings.flags.get("wowza_disabled");e.consecutiveAuthFails>=3&&!1===o&&e.realtime.connection.close(),n(t)}))}))}},{key:"reportFailedTopics",value:function(e){var t=e.getObjectOrUndefined("failures");"object"===(0,M.Z)(t)&&0!==Object.keys(t).length&&(0,c.fg)("PushServiceClient",{action:"token_request_failed_topics",topics:t,client:I})}},{key:"canAccessTopic",value:function(e){var t,n=null===(t=this.ablyContext)||void 0===t?void 0:t.getChannelName(e);return void 0!==n&&void 0!==this.authToken&&this.authToken.getChannelNames().includes(n)}},{key:"getTopicKeys",value:function(){var e=this;if(void 0===this.authToken)return[];var t=this.authToken.getChannelNames(),n=[];return t.forEach((function(t){var i,o=null===(i=e.ablyContext)||void 0===i?void 0:i.getTopicKeys(t);void 0!==o&&n.push.apply(n,(0,y.Z)(o))})),n}},{key:"updateAuthToken",value:function(){var e=this;return new Promise((function(t,n){e.realtime.auth.authorize().then((function(n){var i=JSON.parse(atob(n.token.split(".")[1]));e.authToken=new D(new s.j(i)),t()})).catch((function(e){var t=Z("auth",e);n(t)}))}))}}]),e}();function Z(e,t){return void 0===t?{code:e,message:"Unknown",providerCode:""}:"string"==typeof t?{code:e,message:t,providerCode:""}:"statusCode"in t?F(e,t):t}function F(e,t){var n={code:e,message:"Unknown failure",providerCode:""};return void 0!==t&&(n.message=t.message,n.providerCode=t.code.toString(),void 0!==t.cause&&"code"in t.cause&&(n.cause=t.cause.code)),n}var _=n(7169);var N=function(e){(0,f.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,m.Z)(t);if(n){var o=(0,m.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,p.Z)(this,e)});function s(e){var t;return(0,o.Z)(this,s),(t=i.call(this,e)).tokenRequest=e.getObject("token_request"),e.logUnusedDebugging("DevContext"),t}return(0,r.Z)(s,[{key:"parseSettings",value:function(e){return s.parseSettings(e)}},{key:"isValid",value:function(){return void 0!==this.tokenRequest}},{key:"getTokenRequest",value:function(){if(void 0===this.tokenRequest)throw new Error("Access to tokenRequest on an invalid context!");return this.tokenRequest}},{key:"serialize",value:function(){return JSON.stringify(this.tokenRequest)}}],[{key:"parseSettings",value:function(e){var t={backend:W,flags:new Map,url:e.getStringOrUndefined("url")};return k(t.flags,e.getObjectOrUndefined("flags")),t}}]),s}(S),j=function(){function e(t,n){(0,o.Z)(this,e),this.client=t,this.consecutiveAuthFails=0,this.context=n}return(0,r.Z)(e,[{key:"serialize",value:function(){var e;return!0!==(null===(e=this.context)||void 0===e?void 0:e.isValid())?"":this.context.serialize()}},{key:"fetchAccessToken",value:function(){var e=this;return this.getRequestToken().then((function(t){return e.getAccessToken(t)}))}},{key:"getRequestToken",value:function(){var e=this;return new Promise((function(t,n){return O(W).then((function(i){e.consecutiveAuthFails=0;var o=i.getObjectOrUndefined("failures");if("object"===(0,M.Z)(o)&&0!==Object.keys(o).length&&(0,c.fg)("PushServiceClient",{action:"token_request_failed_topics",topics:o,client:W}),e.context=new N(i),e.context.isValid()){e.client.context=e.context;var r=e.context.getTokenRequest();t(r)}else n("Invalid token request")})).catch((function(t){e.consecutiveAuthFails+=1,e.consecutiveAuthFails>=3&&debug("Should be closing connection and reverting to ably/wowza"),n(t)}))}))}},{key:"getAccessToken",value:function(e){var t=this;return new Promise((function(n,i){if(void 0!==t.context){var o=new XMLHttpRequest,r=void 0===t.context.settings.url?"":"http://".concat(t.context.settings.url);o.open("POST","".concat(r,"/auth/access_token"),!0),o.setRequestHeader("Content-Type","application/json;charset=UTF-8"),o.onload=function(){if((0,E.nw)(o.status)){var e=new s.j(o.responseText);n(e.getString("access_token"))}else i(new E.GM(o))},o.send(JSON.stringify({request_token:e}))}else i("no context")}))}},{key:"canAccessTopic",value:function(e){var t;return void 0!==(null===(t=this.context)||void 0===t?void 0:t.getChannelName(e))}},{key:"getTopicKeys",value:function(){return[]}},{key:"getFailedTopics",value:function(){return[]}},{key:"updateAuthToken",value:function(){return this.client.updateAuth()}},{key:"reportFailedTopics",value:function(e){debug("Failed topics on dev service",e.stringMessage)}}]),e}();function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){(0,A.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var W="hermod",V=function(e){(0,f.Z)(c,e);var t,n,a=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,m.Z)(t);if(n){var o=(0,m.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,p.Z)(this,e)});function c(e){var t;return(0,o.Z)(this,c),(t=a.call(this,e)).clientName=W,t.connectionState="unknown",t.connectionChange=new l.xB("HermodClientConnection"),t.auth=new j((0,_.Z)(t)),t}return(0,r.Z)(c,[{key:"close",value:function(){var e,t;null===(e=this.websocket)||void 0===e||e.send("send closing message"),null===(t=this.websocket)||void 0===t||t.close()}},{key:"_connect",value:function(){var e=this;this.auth.fetchAccessToken().then((function(t){var n,o,r=void 0===(null===(n=e.auth.context)||void 0===n?void 0:n.settings.url)?"".concat(window.location.hostname,":").concat(window.location.port,"/hermod"):"".concat(null===(o=e.auth.context)||void 0===o?void 0:o.settings.url);e.websocket=new WebSocket("ws://".concat(r)),e.websocket.onmessage=function(t){var n=new s.j(t.data),o=n.getNumber("action"),r=n.getString("channel",!1),a=n.getStringOrUndefined("topicKey");switch(o){case 4:e.connectionChange.fire({previous:e.connectionState,current:"connected"}),e.connectionState="connected";break;case 6:e.connectionChange.fire({previous:e.connectionState,current:"disconnected"}),e.connectionState="disconnected";break;case 9:warn("Error on websocket",n,"PUSH_");break;case 11:void 0!==a&&e.handleSubscribed(a);break;case 13:void 0!==a&&e.handleUnsubscribed(a);break;case 15:var l=n.getList("messages");null==l||l.forEach((function(t,o){var a,l="".concat(n.getString("id"),":").concat(o),c=new s.j(z(z({},t.getParsed()),{},{channel:r,id:l,providerData:{id:l,ts:n.getNumber("timestamp")}})),u=e.getChannelTopicMap(r);if(void 0!==u&&(a=u.get(c.getString("_topic"))),void 0!==a){var d=e.handleMessageDuplicate(r,c,c.getString("tid")),h=(0,i.Z)(d,2),f=h[0],p=h[1];if(f&&!p)return;e.callbacks.onMessage(e.clientName,a,c,p)}else warn("Received message for unknown topic",{topic:c.getString("_topic"),client:e.clientName})}))}},e.websocket.onopen=function(){var n;null===(n=e.websocket)||void 0===n||n.send(JSON.stringify({action:3,message:{accessToken:t}}))}})).catch((function(e){error(e)})),this.connectionState="connecting"}},{key:"updateAuth",value:function(){var e=this;return this.isConnected()?this.auth.fetchAccessToken().then((function(t){return void 0===e.websocket?Promise.reject("Invalid websocket during update"):(e.websocket.send(JSON.stringify({action:17,message:{accessToken:t}})),Promise.resolve())})).catch((function(e){error(e)})):this.connect()}},{key:"getConnectionState",value:function(){return this.connectionState}},{key:"getChannelState",value:function(e){return"unknown"}},{key:"getReconnectCount",value:function(){return-1}},{key:"_subscribe",value:function(e){var t=this,n=this.getChannelName(e);return void 0===n?Promise.reject("invalid channel name reached subscribe"):this.ensureConnectedAndAuthed(e).then((function(){return void 0===t.websocket?Promise.reject("websocket undefined"):(t.websocket.send(JSON.stringify({action:10,channelName:n,topicKey:e})),Promise.resolve())}))}},{key:"_unsubscribe",value:function(e){var t=this,n=this.getChannelName(e);return void 0===n?Promise.reject("invalid channel name reached unsubscribe"):this.ensureConnectedAndAuthed(e).then((function(){return void 0===t.websocket?Promise.reject("websocket undefined"):(t.websocket.send(JSON.stringify({action:12,channelName:n,topicKey:e})),Promise.resolve())}))}},{key:"enterPresence",value:function(e,t){var n=this,i=this.getChannelName(e);return void 0===i?Promise.reject("invalid channel name"):this.ensureConnectedAndAuthed(e).then((function(){return n.subscribe(e)})).then((function(){var e;return void 0===n.websocket?Promise.reject("websocket undefined"):(n.websocket.send(JSON.stringify({action:14,channelName:i,message:null!==(e=null==t?void 0:t.data)&&void 0!==e?e:{}})),Promise.resolve())}))}},{key:"leavePresence",value:function(e){return this.unsubscribe(e)}}]),c}(T);var q="p";function K(e,t){return{providerCode:"",code:e,message:null!=t?t:""}}var J=function(e){(0,f.Z)(c,e);var t,n,a=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,m.Z)(t);if(n){var o=(0,m.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,p.Z)(this,e)});function c(e,t){var n;return(0,o.Z)(this,c),(n=a.call(this,e)).clientName=q,n.connectionChange=new l.xB("PusherClientConnection"),n.settings=t,n.auth=new G((0,_.Z)(n)),n}return(0,r.Z)(c,[{key:"close",value:function(){void 0!==this.client&&this.client.disconnect(),this.auth.reset(),this.client=void 0}},{key:"_connect",value:function(){var e=this,t={cluster:this.settings.cluster,channelAuthorization:{endpoint:L,transport:"ajax",customHandler:function(t,n){var i=e.auth.getAuthToken(t.channelName);void 0!==i?n(null,{auth:i,channel_data:e.auth.channelDataString}):n(new Error("Pusher js no auth token"),null)}}};void 0!==this.settings.host&&""!==this.settings.host&&(t.wsHost="ws.".concat(this.settings.host),t.httpHost="sockjs.".concat(this.settings.host)),this.client=new Pusher(this.settings.key,t),this.client.connection.bind("state_change",(function(t){"connected"===t.current&&void 0!==e.client&&(void 0!==e.socketId&&e.socketId!==e.client.connection.socket_id&&(e.auth.reset(),e.activeSubscriptions.clear()),e.socketId=e.client.connection.socket_id);var n={current:C(t.current),previous:C(t.previous),client:"p"};e.connectionChange.fire(n)})),Pusher.log=function(e){return debug(e)},this.connect().catch((function(){}))}},{key:"getConnectionState",value:function(){return void 0===this.client?"disconnected":C(this.client.connection.state)}},{key:"getChannelState",value:function(e){return void 0===this.client?"unknown":void 0===(t=this.client.channel(e))?"uninitialized":t.subscriptionPending?"subscribing":t.subscribed?"subscribed":t.subscriptionCancelled?"failed":"initialized";var t}},{key:"getReconnectCount",value:function(){return-1}},{key:"_subscribe",value:function(e){var t=this,n=this.getChannelName(e);if(void 0===n)return Promise.reject(K("topic_error","Invalid topic key reached subscribe"));if(void 0===this.client)return Promise.reject(K("connect","Client not initialized at subscribe"));var o=this.client.subscribe(n),r=new Promise((function(r,a){t.ensureConnectedAndAuthed(e).then((function(){o.unbind_all(),o.bind("notify",(function(e){e.providerData={id:"pusher:id:1",ts:(new Date).getTime()};var o=new s.j(e);t.checkForReauth(o);var r,a=t.getChannelTopicMap(n);if(void 0!==a&&(r=a.get(o.getString("_topic"))),void 0!==r){var l=t.handleMessageDuplicate(n,o,o.getString("tid")),c=(0,i.Z)(l,2),u=c[0],d=c[1];if(u&&!d)return;t.callbacks.onMessage(t.clientName,r,o,d)}else warn("Received message for unknown topic",{topic:o.getString("_topic"),client:t.clientName})})),r()})).catch((function(e){o.unbind_all(),o.unsubscribe(),a(K("subscribe",e))}))}));return this.topicPromises.set(e,r),r}},{key:"_unsubscribe",value:function(e){var t=this,n=this.getChannelName(e);if(void 0===n)return Promise.reject(K("topic_error","Invalid topic key reached unsubscribe"));if(void 0===this.client)return Promise.reject(K("connect","Client not initialized at unsubscribe"));var i=this.client.channel(n);if(void 0===i)return Promise.resolve();var o=new Promise((function(e,o){i.unbind_all(),i.unsubscribe(),t.auth.removeTopicAuth(n),e()}));return this.topicPromises.set(e,o),o}},{key:"enterPresence",value:function(e,t){var n=this;return this.subscribe(e).then((function(){var i=n.getChannelName(e);if(void 0===i)return Promise.reject(K("topic_error","Invalid topic key reached enterPresence"));if(void 0===n.client)return Promise.reject(K("connect","Client not initialized at enterPresence"));var o=n.client.channel(i);return void 0===o?Promise.reject(K("topic_error","Invalid channel state after subscribe in enterPresence")):(o.members.me.info=t,Promise.resolve())}))}},{key:"leavePresence",value:function(e){return this.unsubscribe(e)}},{key:"getConnectionType",value:function(){return""}},{key:"getConnectionId",value:function(){var e="";return void 0!==this.client&&(e=this.client.connection.socket_id),e}},{key:"getClientId",value:function(){var e="";return void 0!==this.client&&(e=this.client.sessionID.toString()),e}},{key:"getConnectionHost",value:function(){return this.settings.key}},{key:"getConnectionServer",value:function(){return this.settings.cluster}}]),c}(T),G=function(){function e(t){(0,o.Z)(this,e),this.realtime=t,this.tokens=new Map,this.consecutiveAuthFails=0}return(0,r.Z)(e,[{key:"serialize",value:function(){return JSON.stringify(this.tokens)}},{key:"getTopicKeys",value:function(){var e=this,t=Array.from(this.tokens.keys()),n=[];return t.forEach((function(t){var i,o=null===(i=e.realtime.context)||void 0===i?void 0:i.getTopicKeys(t);void 0!==o&&n.push.apply(n,(0,y.Z)(o))})),n}},{key:"reset",value:function(){this.tokens.clear(),this.consecutiveAuthFails=0}},{key:"removeTopicAuth",value:function(e){this.tokens.delete(e)}},{key:"getAuthToken",value:function(e){return this.tokens.get(e)}},{key:"canAccessTopic",value:function(e){var t;return void 0!==(null===(t=this.realtime.context)||void 0===t?void 0:t.getChannelName(e))}},{key:"updateAuthToken",value:function(){var e=this;return this.realtime.ensureConnected().then((function(){var t=e.realtime.getConnectionId();return O(q,{socket_id:t}).then((function(n){e.consecutiveAuthFails=0,e.reportFailedTopics(n);var i=n.getParsedSubMap("tokens"),o=n.getObject("tokens");return 0===Object.keys(o).length&&warn("Pusher auth has no tokens",{req_socket_id:t,socket_id:e.realtime.getConnectionId(),authCtx:n.stringMessage}),e.channelDataString=n.getStringOrUndefined("channel_data",!0),Array.from(Object.keys(o)).forEach((function(t){e.tokens.set(t,i.getString(t))})),e.realtime.context=new Y(n),Promise.resolve()})).catch((function(t){return e.consecutiveAuthFails+=1,e.consecutiveAuthFails>=3&&e.realtime.close(),Promise.reject(t)}))}))}},{key:"reportFailedTopics",value:function(e){var t=e.getObjectOrUndefined("failures");"object"===(0,M.Z)(t)&&0!==Object.keys(t).length&&(0,c.fg)("PushServiceClient",{action:"token_request_failed_topics",topics:t,client:q})}}]),e}();var Y=function(e){(0,f.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,m.Z)(t);if(n){var o=(0,m.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,p.Z)(this,e)});function s(e){var t;return(0,o.Z)(this,s),t=i.call(this,e),e.logUnusedDebugging("PusherContext"),t}return(0,r.Z)(s,[{key:"parseSettings",value:function(e){return s.parseSettings(e)}},{key:"isValid",value:function(){return!0}}],[{key:"parseSettings",value:function(e){var t={backend:q,flags:new Map,key:e.getString("key"),cluster:e.getString("cluster"),host:e.getStringOrUndefined("host")};return k(t.flags,e.getObjectOrUndefined("flags")),t}}]),s}(S);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){(0,A.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=function(){function e(t){(0,o.Z)(this,e),this.activeClients=t,this.startTime=(new Date).getTime(),this.messages=new Map,this.timeouts=new Set,this.totalFailures=0,this.connectedClients=[],this.connectionHistory={},this.messageCount={},this.expireTime=9e4,this.lateTime=3e3,this.invalidateClient("w")}return(0,r.Z)(e,[{key:"verify",value:function(e,t,n){if(this.setLastMessage(e,(new Date).getTime()),this.activeClients.includes(e)||this.activeClients.push(e),this.connectedClients.includes(e)||this.connectedClients.push(e),!(this.activeClients.length<2)){var i={clientName:e,topicKey:t,tid:n.getString("tid"),messageHash:this.hashMessage(n),initialClients:this.connectedClients};this.doVerify(i)}}},{key:"invalidateClient",value:function(e){this.activeClients=this.activeClients.filter((function(t){return t!==e}))}},{key:"buildMeta",value:function(e){return{messageHash:e.messageHash,timestamp:(new Date).getTime(),clients:[e.clientName],initialClients:e.initialClients}}},{key:"doVerify",value:function(e){var t=this,n=this.messages.get(e.tid);if(void 0!==n)return this.handleItemMatch(n,e);var i=this.buildMeta(e);this.messages.set(e.tid,i),this.trackTimeout((function(){t.handleItemNeverArrived(e.tid,i,e.topicKey),t.messages.delete(e.tid)}))}},{key:"recordFailure",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.totalFailures+=1;var i=Q(Q(Q(Q({},t),this.connectionHistory),this.messageCount),{},{topic:n.split(":")[0],topicKey:n,userid:n.split(":")[1],reason:e,start_time:this.startTime,total_failures:this.totalFailures,room_count:this.roomCount});debug("Push Service clients verifier failure",i),(0,c.NS)()&&(0,c.fg)("PushClientVerifier",i)}},{key:"handleItemMatch",value:function(e,t){if(!e.clients.includes(t.clientName)){e.clients.push(t.clientName);var n=(new Date).getTime()-e.timestamp;n>this.lateTime&&this.handleItemLate(e,t,n),e.messageHash!==t.messageHash&&this.handleItemDiffers(e,t),0===this.activeClients.filter((function(t){return!e.clients.includes(t)})).length&&debug("Push service clients verifier success",e)}}},{key:"handleItemNeverArrived",value:function(e,t,n){var i=this.activeClients.filter((function(e){return!t.clients.includes(e)}));i.length>0&&this.recordFailure("never_arrived",{tid:e,first_ts:t.timestamp,first_client:t.clients[0],failedClients:i,initialClients:t.initialClients,connectedClients:this.connectedClients,isConnected:!!this.connectedClients.includes(i[0])},n)}},{key:"handleItemDiffers",value:function(e,t){this.recordFailure("differs",{tid:t.tid,first_ts:e.timestamp,first_client:e.clients[0],failed_client:t.clientName,first_hash:e.messageHash,differ_hash:t.messageHash},t.topicKey)}},{key:"handleItemLate",value:function(e,t,n){this.recordFailure("late",{late:n,tid:t.tid,first_ts:e.timestamp,first_client:e.clients[0],failed_client:t.clientName},t.topicKey)}},{key:"trackTimeout",value:function(e){var t=this,n=window.setTimeout((function(){e(),t.timeouts.delete(n)}),this.expireTime);this.timeouts.add(n)}},{key:"hashMessage",value:function(e){var t=JSON.parse(e.stringMessage);return delete t.providerData,delete t.id,delete t.pub_ts,delete t.ts,delete t.method,delete t.channel,JSON.stringify(t)}},{key:"recordDisconnect",value:function(e){this.connectedClients=this.connectedClients.filter((function(t){return t!==e}))}},{key:"setLastMessage",value:function(e,t){var n;this.connectionHistory["".concat(e,"_time")]=t,this.messageCount["".concat(e,"_messages")]=(null!==(n=this.messageCount["".concat(e,"_messages")])&&void 0!==n?n:0)+1}},{key:"setRoomCount",value:function(e){this.roomCount=e}},{key:"validateClient",value:function(e){this.activeClients.includes(e)||this.activeClients.push(e)}}]),e}();function ee(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?te(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var ne="w",ie=function(){function e(t){var n=this;(0,o.Z)(this,e),this.clients=new Map,this.resetting=!1,this.counter=0,this.contexts=this.parseContext(t),function e(){n.contexts.forEach((function(t){var i=n.clients.get(t.backend);if(void 0!==i&&i.close(),t.flags.set("verify_enabled",!1),n.setVerified(oe.clientToVerify),t.backend!==ne){var o=n.initializeClient(t);void 0!==o?(n.clients.set(t.backend,o),o.connectionChange.listen((function(t){n.verifier.recordDisconnect(o.clientName),t.primary=n.isPrimaryClient(o),debug("PushClient connection change",{client:o.clientName,event:t}),["failed","closed","disconnected"].includes(t.current)&&!n.resetting&&t.primary&&(n.invalidateClient(o.clientName),n.counter+=1,n.resetting=!0,window.setTimeout((function(){e(),oe.updateAuthorization(),n.resetting=!1,n.informReconnect(o.clientName,n.getPrimaryClient(),n.counter)}),3e3)),oe.connectionChange.fire(t),"connected"===t.current&&(n.lastConnection=Date.now(),oe.updateAuthorization(),n.verifier.validateClient(o.clientName))}))):warn("client not initialized",{client:t.backend},"PUSH_")}}))}(),this.verifier=new X(this.contexts.map((function(e){return e.backend})))}return(0,r.Z)(e,[{key:"getFlag",value:function(e){var t,n=this.contexts.find((function(e){return e.backend!==ne}));return void 0===n&&warn("getting flag without any valid context",{},"PUSH_"),null!==(t=null==n?void 0:n.flags.get(e))&&void 0!==t&&t}},{key:"setVerified",value:function(e){void 0!==e&&this.contexts.forEach((function(t){t.backend===e&&t.flags.set("verify_enabled",!0)}))}},{key:"isWowzaPrimary",value:function(){return this.contexts.length<1||this.contexts[0].backend===ne}},{key:"isPrimaryClient",value:function(e){var t=this.contexts.find((function(e){return e.backend!==ne&&!0===e.flags.get("is_live")}));return(null==t?void 0:t.backend)===e.clientName}},{key:"getPrimaryClient",value:function(){var e=this.contexts.find((function(e){return e.backend!==ne})),t={contexts:Array.from(this.contexts.keys()),clients_keys:Array.from(this.clients.keys()),clients:Array.from(this.clients.values()).map((function(e){return e.clientName}))};if(void 0!==e)return this.clients.get(e.backend);warn("no valid push service context",t,"PUSH_")}},{key:"getActiveClients",value:function(){var e=this;return Array.from(this.clients.values()).filter((function(t){var n=e.contexts.find((function(e){return e.backend===t.clientName}));return e.isPrimaryClient(t)||!0===(null==n?void 0:n.flags.get("verify_enabled"))||!0===(null==n?void 0:n.flags.get("is_live"))}))}},{key:"updateOrder",value:function(e){e.length!==this.contexts.length&&warn("invalid chat backends",{backends:e},"PUSH_"),debug("Changing push service backends",e),this.contexts=this.contexts.filter((function(t){return e.includes(t.backend)})).sort((function(t,n){return e.indexOf(t.backend)-e.indexOf(n.backend)}))}},{key:"initializeClient",value:function(e){var t=this,n=function(e){var n;return(null===(n=t.contexts.find((function(e){return e.backend!==ne})))||void 0===n?void 0:n.backend)===e},i={onMessage:function(e,i,o,r){t.verifier.verify(e,i,o),n(e)&&!r&&b.Z.fireMessage(i,o)},onSubscribe:function(e,t,i){n(e)&&b.Z.fireSubscribeChange(t,{subscribed:i,isCriticalFail:!1})}};try{switch(e.backend){case I:return new R(i,e,oe.isBroadcaster);case q:return new J(i,e);case W:return new V(i)}}catch(t){oe.getClientName()===e.backend&&oe.primaryClientFailure.fire(!0),error("An exception was thrown during client construction",t,"PUSH_")}}},{key:"parseContext",value:function(e){var t,n={backend:ne,flags:new Map},i=[],o=ee(e);try{for(o.s();!(t=o.n()).done;){var r=t.value;switch(r.getStringOrUndefined("backend")){case I:i.push(P.parseSettings(r));break;case W:i.push(N.parseSettings(r));break;case q:i.push(Y.parseSettings(r));break;case ne:i.push(n);break;default:warn("unrecognized backend during parseContext",{failed_context:r},"PUSH_")}}}catch(e){o.e(e)}finally{o.f()}return 1===i.length&&!0!==i[0].flags.get("is_live")&&(warn("first context is not is_live",{context:i[0]},"PUSH_"),i[0].flags.set("is_live",!0)),i}},{key:"invalidateClient",value:function(e){var t,n=ee(this.clients);try{for(n.s();!(t=n.n()).done;){var o=(0,i.Z)(t.value,2);o[0],o[1].close()}}catch(e){n.e(e)}finally{n.f()}this.orderLast(e);for(var r=0;!0!==this.contexts[0].flags.get("is_live")&&r<3;)this.orderLast(this.contexts[0].backend),r+=1}},{key:"orderLast",value:function(e){this.updateOrder(this.contexts.map((function(e){return e.backend})).filter((function(t){return t!==e})).concat([e]))}},{key:"setVerifierRoomCount",value:function(e){this.verifier.setRoomCount(e)}},{key:"informReconnect",value:function(e,t,n){var i=this;window.setTimeout((function(){var o={failedClient:e,lastConnection:i.lastConnection,newClient:null==t?void 0:t.clientName,success:null==t?void 0:t.isConnected(),connectionAttempt:n};(0,c.fg)("PushServiceReconnect",o)}),3e3)}}]),e}(),oe=function(){function e(){(0,o.Z)(this,e)}return(0,r.Z)(e,null,[{key:"initialize",value:function(t){var n,i=new s.j(t);e.servicesContext=i.getList("push_services"),e.presenceId=null!==(n=i.getStringOrUndefined("presence_id"))&&void 0!==n?n:e.presenceId,e.clientToVerify=i.getStringOrUndefined("push_service_verify"),void 0!==e.servicesContext?(e.isBroadcaster=void 0!==i.getAny("broadcastDossier"),e.clientManager=new ie(e.servicesContext),e.clientManager.setVerified(e.clientToVerify)):error("PushService parseContext failed",{context_keys:i.keys()},"PUSH_")}},{key:"isConnected",value:function(){var t=e.getClient();return void 0!==t&&t.isConnected()}},{key:"isEnabledForVerify",value:function(){return e.isEnabledForUI()||void 0!==d.J.current.loggedInUser||e.getFlag("verify_enabled")}},{key:"isEnabledForUI",value:function(){return void 0!==e.clientManager&&!e.clientManager.isWowzaPrimary()}},{key:"isEnabledForPM",value:function(){return e.getFlag("pm_enabled")}},{key:"isEnabledForUserList",value:function(){return e.isConnected()&&e.getFlag("userlist_enabled")}},{key:"isWowzaDisabled",value:function(){return e.getFlag("wowza_disabled")}},{key:"changeChatHandler",value:function(t){void 0!==e.clientManager?e.clientManager.updateOrder(t):error("attempting to change backends on not ready push service",{backends:t},"PUSH_")}},{key:"updateAuthorization",value:function(){e.updateAuthThrottler.callFunc()}},{key:"_updateAuthorizationAndSubscriptions",value:function(){var t,n,i=null!==(t=null===(n=e.clientManager)||void 0===n?void 0:n.getActiveClients())&&void 0!==t?t:[];if(i.length<1)b.Z.getTopicKeys().forEach((function(e){b.Z.fireSubscribeChange(e,{subscribed:!1,isCriticalFail:!0})}));else{e.authId+=1;var o=e.authId;window.clearTimeout(e.pushReconnectTimeout);var r=e.getTopicKeysToAuth(),s=(new Date).getTime();i.forEach((function(t){var n=e.isPrimaryClient(t);t.getAuthPromise(r).then((function(){if(e.pushReconnectTimer=5e3,!(o<e.authId)){var i;n&&(null===(i=t.context)||void 0===i||i.getFailedTopics().forEach((function(e){return b.Z.fireAuthFail(e)})));var r=!1,a=t.connectionChange.listen((function(e){"closed"!==e.current&&"disconnected"!==e.current||(r=!0)}),!1),l=(new Date).getTime();e.subscribeToEligibleTopics(t).then((function(i){var u=(new Date).getTime();if(a.removeListener(),!(o<e.authId)){var d=i.filter((function(e){return"fulfilled"===e.status})).length,h=t.auth.getTopicKeys().filter((function(e){return!t.isSubscribedTo(e)}));if((0,c.fg)("PushServiceTopicSetup",{client:t.clientName,all_topics_success:0===h.length,topics_requested_count:i.length,successful_topic_count:d,failed_topic_list:h.sort(),is_push_connected:e.isConnected(),elapsed_time:u-l,elapsed_time_auth:u-s}),t.shouldRetrySubscribe()&&!r&&(e.pushReconnectTimeout=window.setTimeout((function(){e.updateAuthorization()}),1e4)),n){var f=t.getCriticallyFailedTopics();h.length>0&&e.primaryClientFailure.fire(!0),h.forEach((function(t){b.Z.fireSubscribeChange(t,{subscribed:!1,isCriticalFail:r||f.includes(t),retryCallback:r?void 0:function(){e.updateAuthorization()}})}))}}})).catch((function(){}))}})).catch((function(i){var s,a;o<e.authId||n&&(e.primaryClientFailure.fire(!1),e.pushReconnectTimeout=window.setTimeout((function(){e.updateAuthorization()}),e.pushReconnectTimer),e.isWowzaDisabled()||(e.pushReconnectTimer*=2),r.filter((function(t){return!e.isListeningFor(t)})).forEach((function(e){b.Z.fireAuthFail(e)})),i.message.includes("access denied")||t.addPageAction("auth_failure",{client_id:t.getClientId(),user_uid:null!==(s=null===(a=d.J.current.loggedInUser)||void 0===a?void 0:a.userUid)&&void 0!==s?s:"anon",message:i.message,provider_status:i.providerCode,cause:i.cause,code:i.code}))}))}))}}},{key:"getTopicKeysToAuth",value:function(){return b.Z.getTopicKeys().concat(b.Z.getPendingTopics())}},{key:"getTopicAuthData",value:function(e){var t=b.Z.getTopicAuthData(e);return void 0===t&&warn("undefined topic data",{topic:e},"PUSH_"),t}},{key:"getClient",value:function(){var t,n=null===(t=e.clientManager)||void 0===t?void 0:t.getPrimaryClient();return void 0===n&&error("No valid push service client",{},"PUSH_"),n}},{key:"listenFor",value:function(t,n){return t.isSubscribedTo(n)?Promise.resolve():t.subscribe(n).catch((function(i){t.addPageAction("subscribe_failure",{is_primary:e.isPrimaryClient(t),topic:n,auth:t.auth.serialize(),code:i.code,message:i.message,providerCode:i.providerCode})}))}},{key:"stopListeningFor",value:function(t){var n,i,o=null!==(n=null===(i=e.clientManager)||void 0===i?void 0:i.getActiveClients())&&void 0!==n?n:[];if(o.length<1)return Promise.reject("PushService client is not initialized");var r=o.map((function(n){var i=e.isPrimaryClient(n),o=n.unsubscribe(t).catch((function(e){n.addPageAction("unsubscribe_failure",{is_primary:i,topic:t,auth:n.auth.serialize(),code:e.code,message:e.message,providerCode:e.providerCode})}));return i?o:void 0})).find((function(e){return void 0!==e}));return null!=r?r:Promise.reject("Primary client lost during unsubscribe")}},{key:"isListeningFor",value:function(t){var n=e.getClient();return void 0!==n&&n.isSubscribedTo(t)}},{key:"subscribeToEligibleTopics",value:function(t){var n=b.Z.getTopicKeys().filter((function(e){return(b.Z.hasPresence(e)||!t.isSubscribedTo(e))&&t.auth.canAccessTopic(e)})).map((function(n){var i=b.Z.getPresence(n);return void 0!==i?t.enterPresence(n,i):e.listenFor(t,n)}));return Promise.all((0,u.uK)(n))}},{key:"close",value:function(){var t,n;(null!==(t=null===(n=e.clientManager)||void 0===n?void 0:n.getActiveClients())&&void 0!==t?t:[]).forEach((function(e){return e.close()})),void 0!==e.servicesContext&&(e.clientManager=new ie(e.servicesContext))}},{key:"addExternalMessage",value:function(t,n){var i,o,r,s=!1,a=ee(null!==(i=null===(o=e.clientManager)||void 0===o?void 0:o.getActiveClients())&&void 0!==i?i:[]);try{for(a.s();!(r=a.n()).done;){var l=r.value;l.addExternalMessage(t,n)&&e.isPrimaryClient(l)&&(s=!0)}}catch(e){a.e(e)}finally{a.f()}return s}},{key:"getConnectionType",value:function(){var t=e.getClient();return void 0===t?"not_connected":t.getConnectionType()}},{key:"getConnectionId",value:function(){var t=e.getClient();return void 0===t?"":t.getConnectionId()}},{key:"getFlag",value:function(t){return void 0!==e.clientManager&&e.clientManager.getFlag(t)}},{key:"isPrimaryClient",value:function(t){return void 0!==e.clientManager&&e.clientManager.isPrimaryClient(t)}},{key:"setVerifierRoomCount",value:function(t){var n;null===(n=e.clientManager)||void 0===n||n.setVerifierRoomCount(t)}},{key:"getClientName",value:function(){var t,n;return null!==(t=null===(n=e.getClient())||void 0===n?void 0:n.clientName)&&void 0!==t?t:""}}]),e}();oe.pushReconnectTimer=5e3,oe.isBroadcaster=!1,oe.connectionChange=new l.xB("PushServiceClientConnection"),oe.primaryClientFailure=new l.xB("PushServicePrimaryClientFailure"),oe.updateAuthThrottler=new a.d((function(){oe._updateAuthorizationAndSubscriptions()}),{bounceLimitMS:800,debounceType:1}),oe.presenceId=Math.random().toString(36).substring(2),oe.authId=0},728:function(e,t,n){"use strict";n.d(t,{Z:function(){return c},h:function(){return l}});var i=n(2951),o=n(1976),r=n(1794),s=n(7600),a=n(9570);function l(e){e.providerData={id:"",ts:0},e.pub_ts=0,e.method="UI"}var c=function(){function e(t){var n=this;(0,i.Z)(this,e),this.subscribeOnlyOnPrimaryBackend=!1,this.maxListeners=50,this.routerOptions={listenersWarningThreshold:5,onListenerAdded:function(){n.onListenerAdded()},onListenerRemoved:function(){n.onListenerRemoved()}},this.initData(t),this.authData=t,this.onMessage=new r.xB(this.getKey(),this.routerOptions),this.onAuthFail=new r.xB("TopicAuthFail",this.routerOptions),this.onSubscribeChange=new r.xB("TopicSubscribeChange",this.routerOptions)}return(0,o.Z)(e,[{key:"getAuthKey",value:function(){return"".concat(this.getId(),"#").concat(this.getKey())}},{key:"parseData",value:function(e){return{tid:e.getString("tid"),providerId:e.getParsedSubMap("providerData").getString("id"),publishMethod:e.getString("method")}}},{key:"isSubscribed",value:function(){return s._.isListeningFor(this.getKey())}},{key:"enterPresence",value:function(e){a.Z.enterPresence(this,e)}},{key:"leavePresence",value:function(){a.Z.leavePresence(this)}},{key:"getAuthData",value:function(){return this.authData}},{key:"onListenerAdded",value:function(){1===this.onMessage.listenerCount()+this.onSubscribeChange.listenerCount()+this.onAuthFail.listenerCount()&&a.Z.registerTopic(this)}},{key:"onListenerRemoved",value:function(){0===this.onMessage.listenerCount()+this.onSubscribeChange.listenerCount()+this.onAuthFail.listenerCount()&&a.Z.removeTopic(this)}},{key:"uidCheck",value:function(e){if(7!==e.length&&14!==e.length)throw new Error("Invalid uid passed into topic")}}]),e}()},8666:function(e,t,n){"use strict";n.d(t,{M4:function(){return b},O6:function(){return g},Vx:function(){return y},XM:function(){return m},k1:function(){return v}});var i=n(4649),o=n(3243),r=n(2951),s=n(1976),a=n(7591),l=n(9492),c=n(7597),u=n(5011);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var p=function(e){(0,a.Z)(n,e);var t=f(n);function n(e,i){var o;if((0,r.Z)(this,n),o=t.call(this,{broadcaster_uid:e,show_id:i}),0===e.length)throw new Error("room uid cannot be empty");if(0===i.length)throw new Error("show ID cannot be empty");return o}return(0,s.Z)(n,[{key:"getKey",value:function(){return"".concat(this.getId(),":").concat(this.roomUid,":").concat(this.showId)}},{key:"initData",value:function(e){this.roomUid=e.broadcaster_uid,this.showId=e.show_id}}]),n}(n(728).Z),m=function(e){(0,a.Z)(n,e);var t=f(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).maxListeners=1,e}return(0,s.Z)(n,[{key:"getId",value:function(){return"PrivateRoomUserPresenceTopic"}}]),n}(p),v=function(e){(0,a.Z)(n,e);var t=f(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"PrivateRoomMessageTopic"}},{key:"parseData",value:function(e){return h(h(h({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),(0,u.QY)(e)),{},{ts:Math.floor(1e3*e.getNumber("ts"))})}}]),n}(p),g=function(e){(0,a.Z)(n,e);var t=f(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"PrivateRoomShortcodeTopic"}},{key:"parseData",value:function(e){var t,i=null!==(t=e.getList("shortcodes"))&&void 0!==t?t:[];return h(h(h({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),(0,u.QY)(e)),{},{ts:Math.floor(1e3*e.getNumber("ts")),shortcodes:(0,u.mF)(i)})}}]),n}(p),y=function(e){(0,a.Z)(n,e);var t=f(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"PrivateRoomTipAlertTopic"}},{key:"parseData",value:function(e){return h(h({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{fromUser:(0,u.yp)(e),message:e.getString("message",!1),amount:e.getNumber("amount"),isAnonymousTip:e.getBoolean("is_anonymous_tip"),toUsername:e.getString("to_username"),ts:Math.floor(1e3*e.getNumber("ts")),roomType:"private"})}}]),n}(p),b=function(e){(0,a.Z)(n,e);var t=f(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"PrivateRoomEnterLeaveTopic"}},{key:"parseData",value:function(e){return h(h({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{user:(0,u.PU)(e.getParsedSubMap("user")),action:e.getString("action"),viewers:e.getNumber("count"),connections:e.getNumber("num_connections")})}}]),n}(p)},7212:function(e,t,n){"use strict";n.d(t,{AE:function(){return Z},Dn:function(){return M},GN:function(){return k},Hu:function(){return y},M2:function(){return F},Nm:function(){return B},X:function(){return w},bj:function(){return V},bv:function(){return C},ez:function(){return I},gt:function(){return O},j4:function(){return P},jj:function(){return T},ll:function(){return H},nf:function(){return A},pp:function(){return L},qm:function(){return W},qt:function(){return R},rc:function(){return N},sP:function(){return _},tS:function(){return z},uH:function(){return U},w8:function(){return x},ws:function(){return j},x7:function(){return S},xn:function(){return E},yV:function(){return q},zf:function(){return D}});var i=n(4649),o=n(3243),r=n(2951),s=n(1976),a=n(7591),l=n(9492),c=n(7597),u=n(391),d=n(5011),h=n(9992),f=n(9034),p=n(728);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var y=function(e){(0,a.Z)(n,e);var t=g(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,{broadcaster_uid:e})).uidCheck(i.roomUid),i}return(0,s.Z)(n,[{key:"initData",value:function(e){this.roomUid=e.broadcaster_uid}},{key:"getKey",value:function(){return"".concat(this.getId(),":").concat(this.roomUid)}}]),n}(p.Z),b=function(e){(0,a.Z)(n,e);var t=g(n);function n(e,i){var o;return(0,r.Z)(this,n),(o=t.call(this,{broadcaster_uid:e,user_uid:i})).uidCheck(o.roomUid),o.uidCheck(o.userUid),o}return(0,s.Z)(n,[{key:"getKey",value:function(){return"".concat(this.getId(),":").concat(this.roomUid,":").concat(this.userUid)}},{key:"initData",value:function(e){this.roomUid=e.broadcaster_uid,this.userUid=e.user_uid}}]),n}(p.Z),w=function(e){(0,a.Z)(n,e);var t=g(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).maxListeners=1,e}return(0,s.Z)(n,[{key:"getId",value:function(){return"PrivilegedSessionTopic"}}]),n}(y),C=function(e){(0,a.Z)(n,e);var t=g(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).maxListeners=1,e}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomUserPresenceTopic"}}]),n}(b),x=function(e){(0,a.Z)(n,e);var t=g(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).subscribeOnlyOnPrimaryBackend=!0,e}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomAnonPresenceTopic"}}]),n}(y),k=function(e){(0,a.Z)(n,e);var t=g(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).maxListeners=1,e}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomPasswordProtectedTopic"}}]),n}(y),S=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomTitleChangeTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{title:e.getString("title")})}}]),n}(y),T=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomTipAlertTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{fromUser:(0,d.yp)(e),message:e.getString("message"),amount:e.getNumber("amount"),isAnonymousTip:e.getBoolean("is_anonymous_tip"),toUsername:e.getString("to_username"),ts:Math.floor(1e3*e.getNumber("ts")),roomType:"public"})}}]),n}(y),I=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomStatusTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{status:(0,h.gN)(e.getString("status")),message:e.getString("message"),password:e.getString("hash")})}}]),n}(y),R=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomUserHiddenCamStatusTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{status:e.getString("status")})}}]),n}(b),P=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomMessageTopic"}},{key:"parseData",value:function(e){return v(v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),(0,d.QY)(e)),{},{ts:Math.floor(1e3*e.getNumber("ts"))})}}]),n}(y),M=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomSilenceTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{username:e.getString("username"),fromUser:e.getString("from_username")})}}]),n}(y),A=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomKickTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{username:e.getString("username"),fromUser:"Unknown"})}}]),n}(y),E=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomModeratorPromotedTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{username:e.getString("username"),fromUser:e.getString("from_username")})}}]),n}(y),B=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomModeratorRevokedTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{username:e.getString("username"),fromUser:e.getString("from_username")})}}]),n}(y),L=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomNoticeTopic"}},{key:"parseData",value:function(e){return v(v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),(0,d.Vu)(e)),{},{ts:Math.floor(1e3*e.getNumber("ts")),toGroup:void 0,toUser:void 0})}}]),n}(y),O=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomUserNoticeTopic"}},{key:"parseData",value:function(e){return v(v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),(0,d.Vu)(e)),{},{ts:Math.floor(1e3*e.getNumber("ts")),toGroup:void 0,toUser:this.userUid})}}]),n}(b),D=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomAppLogTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),(0,d.lt)(e))}}]),n}(y),U=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomPurchaseTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{fromUser:(0,d.PU)(e.getParsedSubMap("user")),message:e.getString("message"),ts:Math.floor(1e3*e.getNumber("ts"))})}}]),n}(y),Z=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomFanClubJoinedTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{fromUser:(0,d.PU)(e.getParsedSubMap("user")),message:e.getString("message"),ts:Math.floor(1e3*e.getNumber("ts"))})}}]),n}(y),F=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomSettingsTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{allowPrivateShow:e.getBoolean("allow_private_shows"),privatePrice:e.getNumber("private_show_tokens_per_minute"),spyPrice:e.getNumber("spy_on_private_show_tokens_per_minute"),privateMinMinutes:e.getNumber("private_min_minutes"),allowShowRecordings:e.getBoolean("allow_show_recordings")})}}]),n}(y),_=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomEnterLeaveTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{user:(0,d.PU)(e.getParsedSubMap("user")),action:e.getString("action"),viewers:e.getNumber("count"),connections:e.getNumber("num_connections")})}}]),n}(y),N=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomPrivilegedEnterTopic"}},{key:"parseData",value:function(e){var t,i=v(v({},e.getObject("user")),{},{source_name:e.getStringOrUndefined("source"),exploringHashTag:null!==(t=e.getStringOrUndefined("exploring_hash"))&&void 0!==t?t:""});return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{action:"enter",user:(0,d.PU)(new u.j(i)),connections:e.getNumber("num_connections"),viewers:e.getNumber("count")})}}]),n}(y),j=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomPrivilegedLeaveTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{action:"leave",user:(0,d.PU)(e.getParsedSubMap("user")),viewers:e.getNumber("count"),connections:e.getNumber("num_connections")})}}]),n}(y),H=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomUpdateTopic"}},{key:"parseData",value:function(e){var t=v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{target:e.getString("target"),appId:e.getStringOrUndefined("app_id",!1),appSystem:e.getStringOrUndefined("app_system",!1)}),i=e.getString("target_user");return""!==i&&(t.targetUser=i),t}}]),n}(y),z=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomUserPrivateStatusTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{status:e.getString("status"),privateShowId:e.getStringWithNumbers("show_id")})}}]),n}(b),W=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"QualityUpdateTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{quality:e.getString("quality"),rate:e.getNumber("rate"),stopped:e.getBoolean("stopped")})}}]),n}(y),V=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomShortcodeTopic"}},{key:"parseData",value:function(e){var t,i=null!==(t=e.getList("shortcodes"))&&void 0!==t?t:[];return v(v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),(0,d.QY)(e)),{},{ts:Math.floor(1e3*e.getNumber("ts")),shortcodes:(0,d.mF)(i)})}}]),n}(y),q=function(e){(0,a.Z)(n,e);var t=g(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"GameUpdateTopic"}},{key:"parseData",value:function(e){return v(v({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{game:f.A.parseSelection(e.getObjectStringOrUndefined("game"))})}}]),n}(y)},9570:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var i=n(2951),o=n(1976),r=n(7600),s=function(){function e(){(0,i.Z)(this,e)}return(0,o.Z)(e,null,[{key:"fireMessage",value:function(t,n){var i=e.topics.get(t);if(void 0===i){var o={topicKey:t,client:r._.getClientName()};return void 0!==t&&t.includes(":")&&(o.topic=t.split(":")[0],o.userId=t.split(":")[1],o.subscribedTopics=e.getTopicKeys()),void warn("calling fireMessage with no topics in TopicManager",o,"PUSH_")}i.forEach((function(e){e.onMessage.fire(e.parseData(n))})),n.logUnusedDebugging(t)}},{key:"fireMessageDirect",value:function(t,n){var i=e.topics.get(t.getKey());void 0!==i?i.forEach((function(e){e.onMessage.fire(n)})):warn("calling fireMessageDirect with no topics in TopicManager",{topicKey:t.getKey(),client:r._.getClientName()},"PUSH_")}},{key:"fireSubscribeChange",value:function(t,n){var i;null===(i=e.topics.get(t))||void 0===i||i.forEach((function(e){e.onSubscribeChange.fire(n)}))}},{key:"fireAuthFail",value:function(t){var n;null===(n=e.topics.get(t))||void 0===n||n.forEach((function(e){e.onAuthFail.fire(void 0)}))}},{key:"registerTopic",value:function(t){var n=e.topics.get(t.getKey());void 0===n?n=[t]:(n.length>t.maxListeners&&warn("Too many instances of topic created",{topic:t.getKey(),num_listeners:n.length},"PUSH_"),n.push(t)),e.topics.set(t.getKey(),n),r._.updateAuthorization()}},{key:"removeTopic",value:function(t){var n=e.topics.get(t.getKey());if(void 0!==n){var i=n.indexOf(t);n.splice(i,1),n.length<1?(e.topics.delete(t.getKey()),e.pending.set(t.getKey(),t),r._.stopListeningFor(t.getKey()).then((function(){e.pending.delete(t.getKey())})).catch((function(){}))):e.topics.set(t.getKey(),n)}}},{key:"getTopicKeys",value:function(){var t=Array.from(e.presence.keys()),n=function(e){return e.onMessage.listenerCount()>0||e.onSubscribeChange.listenerCount()>0};return e.topics.forEach((function(e,i){e.some(n)&&t.push(i)})),t}},{key:"getPresenceKeys",value:function(){return Array.from(e.presence.keys())}},{key:"getPendingTopics",value:function(){return Array.from(e.pending.keys())}},{key:"hasPresence",value:function(t){return e.presence.has(t)}},{key:"getPresence",value:function(t){return e.presence.get(t)}},{key:"getTopic",value:function(t){var n=e.presence.get(t);if(void 0!==n)return n.topic;var i=e.pending.get(t);if(void 0!==i)return i;var o=e.topics.get(t);return void 0!==o&&0!==o.length?o[0]:void 0}},{key:"getTopicAuthData",value:function(t){var n=e.getTopic(t);if(void 0!==n)return{key:n.getAuthKey(),payload:n.getAuthData(),subscribeOnlyOnPrimaryBackend:n.subscribeOnlyOnPrimaryBackend}}},{key:"enterPresence",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.presence.set(t.getKey(),{changed:!0,data:n,topic:t}),r._.updateAuthorization()}},{key:"leavePresence",value:function(t){var n=t.getKey();e.presence.has(n)&&(e.presence.delete(n),e.pending.set(n,t),r._.stopListeningFor(t.getKey()).then((function(){e.pending.delete(n)})).catch((function(){})))}}]),e}();s.topics=new Map,s.presence=new Map,s.pending=new Map},8016:function(e,t,n){"use strict";n.d(t,{C$:function(){return M},HL:function(){return S},HS:function(){return B},IH:function(){return x},OC:function(){return Z},Ol:function(){return U},Pg:function(){return I},Tz:function(){return b},Wg:function(){return E},X_:function(){return w},Xv:function(){return L},Z4:function(){return y},Zv:function(){return D},_G:function(){return k},a6:function(){return C},aS:function(){return T},l7:function(){return _},qZ:function(){return A},tL:function(){return O},xp:function(){return R},yK:function(){return P},zw:function(){return F}});var i=n(4649),o=n(3243),r=n(2951),s=n(1976),a=n(7591),l=n(9492),c=n(7597),u=n(5011),d=n(1794),h=n(6547);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var v=function(e){(0,a.Z)(n,e);var t=m(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,{user_uid:e})).uidCheck(i.userUid),i}return(0,s.Z)(n,[{key:"getKey",value:function(){return"".concat(this.getId(),":").concat(this.userUid)}},{key:"initData",value:function(e){this.userUid=e.user_uid}}]),n}(n(728).Z),g=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"parseData",value:function(e){return p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{timestamp:e.getNumber("read_ts")})}}]),n}(v),y=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"UserNewsSeenTopic"}}]),n}(g),b=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"UserMessageTopic"}},{key:"parseData",value:function(e){return p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{room:e.getString("room"),createdAt:new Date(Math.floor(1e3*e.getNumber("ts"))),fromUser:(0,u.yp)(e.getParsedSubMap("from_user")),message:e.getString("message"),textColor:e.getStringOrUndefined("font_color",!1),messageID:e.getString("id",!1),otherUsername:e.getString("other_user"),font:e.getString("font_family"),backgroundColor:e.getStringOrUndefined("background"),mediaList:(0,u.Vi)(e.getObjectOrUndefined("media")),isPrivate:!0})}}]),n}(v),w=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"UserUpdateTopic"}},{key:"parseData",value:function(e){return p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{target:e.getString("target")})}}]),n}(v),C=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"UserColorUpdateTopic"}},{key:"parseData",value:function(e){return p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{hasTokens:e.getBoolean("has_tokens"),tippedRecently:e.getBoolean("tipped_recently"),tippedAlotRecently:e.getBoolean("tipped_alot_recently"),tippedTonsRecently:e.getBoolean("tipped_tons_recently")})}}]),n}(v),x=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"UserTokenUpdateTopic"}},{key:"parseData",value:function(e){return p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{tokens:e.getNumber("tokens")})}}]),n}(v),k=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"UserTipAlertTopic"}},{key:"parseData",value:function(e){return p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{fromUser:(0,u.yp)(e),message:e.getString("message"),amount:e.getNumber("amount"),isAnonymousTip:e.getBoolean("is_anonymous_tip"),toUsername:e.getString("to_username"),ts:Math.floor(1e3*e.getNumber("ts")),roomType:e.getString("room_type")})}}]),n}(v),S=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"OfflineTipNotificationTopic"}},{key:"parseData",value:function(e){return p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),(0,u.fE)(e))}}]),n}(v),T=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"UpdateOfflineTipNotificationTopic"}},{key:"parseData",value:function(e){return p(p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),(0,u.fE)(e)),{},{fromUsername:e.getString("from_username")})}}]),n}(v),I=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"RoomBroadcasterPrivateStatusTopic"}},{key:"parseData",value:function(e){return p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{status:e.getString("status"),privateShowId:e.getStringWithNumbers("show_id"),requester:e.getString("requester",!1)})}},{key:"getAuthData",value:function(){return{broadcaster_uid:this.userUid}}}]),n}(v),R=new d.xB("showMyCamStarted"),P=new d.xB("showMyCamStopped"),M=new d.xB("showMyCamViewStarted"),A=new d.xB("showMyCamViewStopped"),E=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"UserSMCBroadcastNotifyTopic"}},{key:"parseData",value:function(e){return p(p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),(0,h.pb)(e)),{},{started:e.getBoolean("started")})}}]),n}(v),B=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"UserSMCWatchingTopic"}},{key:"parseData",value:function(e){return p(p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),(0,h.pb)(e)),{},{started:e.getBoolean("started")})}}]),n}(v),L=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"SMCPresenceTopic"}},{key:"parseData",value:function(e){return(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)}},{key:"getUserUid",value:function(){return this.userUid}}]),n}(v),O=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"UserAlertTopic"}},{key:"parseData",value:function(e){return p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{message:e.getString("message")})}}]),n}(v),D=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"UserChatMediaOpenedTopic"}},{key:"parseData",value:function(e){return p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{mediaId:e.getNumber("media_id"),messageId:e.getString("message_id")})}}]),n}(v),U=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"UserChatMediaRemovedTopic"}},{key:"parseData",value:function(e){return p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{mediaId:e.getNumber("media_id"),isCompliance:e.getBoolean("is_compliance")})}}]),n}(v),Z=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"UserFollowerTopic"}},{key:"parseData",value:function(e){return p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{followerUsername:e.getString("follower_username"),followedUsername:e.getString("followed_username"),isFollowing:e.getBoolean("is_following")})}}]),n}(v),F=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"UserIgnoreTopic"}},{key:"parseData",value:function(e){return p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{username:e.getString("username"),isIgnored:e.getBoolean("is_ignored")})}}]),n}(v),_=function(e){(0,a.Z)(n,e);var t=m(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getId",value:function(){return"UserPmReadTopic"}},{key:"parseData",value:function(e){return p(p({},(0,o.Z)((0,c.Z)(n.prototype),"parseData",this).call(this,e)),{},{otherUsername:e.getString("other_username"),room:e.getStringOrUndefined("room")})}}]),n}(v)},6698:function(e,t,n){"use strict";n.d(t,{AY:function(){return k},Bb:function(){return I},Db:function(){return x},E9:function(){return U},Iu:function(){return F},PK:function(){return C},X7:function(){return L},_M:function(){return D},bc:function(){return S},d$:function(){return T},fr:function(){return O},kC:function(){return Z},zo:function(){return P}});var i=n(2951),o=n(1976),r=n(4649),s=n(5809),a=n(3753),l=n(6767),c=n(1371),u=n(9165),d=n(3705),h=n(4266),f=n(2800),p=n(1612),m=n(407);function v(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var b=30,w="tbu_",C=1e3,x=900;function k(e){switch(e){case"df":case"rc":case"ft":case"fn":case"fo":case"ff":case"ml":case"mr":case"tp":case"pr":case"bs":case"nc":case"sc":case"dc":case"tr":case"sm":case"ps":case"cc":return e;default:return"un"}}function S(e,t,n,i){var o=JSON.stringify({source:t,index:n,source_index:null==i?void 0:i.sourceIndex,hashtag:null==i?void 0:i.hashtag,source_info:null==i?void 0:i.sourceInfo,row_num:null==i?void 0:i.rowNum,col_num:null==i?void 0:i.colNum,room_list_id:null==i?void 0:i.roomListId},(function(e,t){return""===t?void 0:null!=t?t:void 0}));(function(e){var t=document.cookie;if(!(t.length+e.length<4096)){var n=Object.fromEntries(t.split(";").map((function(e){var t=e.trim().split("="),n=(0,s.Z)(t,2),i=n[0],o=n[1];return["cookielen-".concat(i),o.length]})));(0,d.fg)("BroadcasterSourceOversizedCookie",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({cookie_length:t.length,data_length:e.length},n))}})(o),(0,l.YM)("".concat(function(e){return"".concat(w).concat(e)}(e)),o,b)}function T(e){return f.J.current.isTestbed||f.J.current.noImage?"".concat(STATIC_URL_ROOT,"images/no_thumbnail_1_wide.jpg"):"".concat(p.w.jpegRoomImgUrl,"riw/").concat(e,".jpg?").concat(Math.floor((new Date).getTime()/3e4))}var I=function(){function e(){(0,i.Z)(this,e),this.onLoadhandlers=[],this.streamers=new Map}return(0,o.Z)(e,[{key:"getContainers",value:function(){var e,t=[],n=v(document.querySelectorAll(".endless_page_template, .MoreRooms, .followedDropdown"));try{for(n.s();!(e=n.n()).done;){var i=e.value;t.push(i)}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"addOnLoadHandler",value:function(e){this.onLoadhandlers.push(e)}},{key:"onSuccess",value:function(){var e,t=v(this.onLoadhandlers);try{for(t.s();!(e=t.n()).done;)(0,e.value)()}catch(e){t.e(e)}finally{t.f()}}},{key:"getUrl",value:function(e){var t="",n=e.getAttribute("data-href");if("skip"!==n){var i="?";-1!==(t="string"!=typeof n||0===n.length?window.location.href.replace(""===location.hash?"#":location.hash,""):"/"===n[0]?n.substr(1):n).indexOf("?")&&(i="&");var o=document.getElementById("filter_search_form");return t+i+(null!==o?(0,c.R)(o,!1).serialize():"")}}},{key:"loadRooms",value:function(e){var t,n=this,i=v(this.streamers.values());try{for(i.s();!(t=i.n()).done;)t.value.stopStreaming()}catch(e){i.e(e)}finally{i.f()}this.streamers.clear();var o,r=this.getContainers(),s=[],l=v(r);try{var c=function(){var e=o.value,t=n.getUrl(e);void 0!==t&&s.push((0,a.Ue)(t).then((function(t){e.innerHTML=t.responseText})))};for(l.s();!(o=l.n()).done;)c()}catch(e){l.e(e)}finally{l.f()}Promise.all(s).then((function(){n.onSuccess(),void 0!==e&&e()})).catch((function(){}))}},{key:"loadImages",value:function(){var e,t=v(this.getContainers());try{for(t.s();!(e=t.n()).done;)e.value.querySelectorAll("img.room_thumbnail").forEach((function(e){if(null!==e.parentElement){var t=e.parentElement.dataset.room;if(void 0!==t){var n=new Image(e.width,e.height);n.onload=function(){e.src=n.src},n.src=T(t)}}}))}catch(e){t.e(e)}finally{t.f()}}},{key:"getImageStreamer",value:function(e){return this.streamers.get(e)}},{key:"removeImageStreamer",value:function(e){this.streamers.delete(e)}},{key:"getOrCreateImageStreamer",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0,o=this.getImageStreamer(e);return void 0===o&&(o=new h.hE(e,t,{startStreaming:n,useWideImages:void 0===i?!f.J.current.isMobile:i,streamingFadeoutTimeoutMs:0}),this.streamers.set(e,o)),o}},{key:"safariReloadAllImages",value:function(){var e,t=v(this.streamers.values());try{for(t.s();!(e=t.n()).done;)e.value.safariReloadImage()}catch(e){t.e(e)}finally{t.f()}}}],[{key:"getInstance",value:function(){return void 0===e.instance&&(e.instance=new e),e.instance}},{key:"scheduleRefresh",value:function(t){e.clearRefresh(),t>0&&(e.refreshTimer=window.setTimeout((function(){e.getInstance().loadRooms(),e.scheduleRefresh(t)}),t*C))}},{key:"scheduleImageRefresh",value:function(t){e.clearImageRefresh(),t>0&&(e.refreshImageTimer=window.setTimeout((function(){e.getInstance().loadImages(),e.scheduleImageRefresh(t)}),t*C))}},{key:"clearRefresh",value:function(){clearTimeout(e.refreshTimer)}},{key:"clearImageRefresh",value:function(){clearTimeout(e.refreshImageTimer)}},{key:"exportToJS",value:function(){return{addOnLoadHandler:R,loadRooms:P,scheduleRefresh:M,chatRoomListOnClick:E,startStreaming:D,stopStreaming:U,clearRefresh:A,setRoomAnimation:L}}}]),e}();function R(e){I.getInstance().addOnLoadHandler(e)}function P(e){I.getInstance().loadRooms(e)}function M(e){I.scheduleRefresh(e)}function A(){I.clearRefresh()}function E(e,t,n,i,o,r){S(e,k(t),n,{sourceIndex:i,hashtag:o,roomListId:r})}var B=!1;function L(e){B=e}function O(){return B}function D(e,t,n,i){(void 0===i?O():i)&&null!==t&&I.getInstance().getOrCreateImageStreamer(e,t,!0,n).startStreaming()}function U(e,t){if(void 0===t?O():t){var n=I.getInstance().getImageStreamer(e);void 0!==n&&(n.stopStreaming(),I.getInstance().removeImageStreamer(e))}}var Z={buildTooltip:m.T};function F(e){var t=(0,u.ej)();if(t!==u.Y0.All){var n=f.J.current.isMobile?".subject > a":".subject > li > a";e.querySelectorAll(n).forEach((function(e){e.href=(0,a.BN)(e.href.concat("".concat(u.aI.get(t),"/")))}))}}},1006:function(e,t,n){"use strict";n.d(t,{_B:function(){return B},gH:function(){return P},rS:function(){return M}});var i=n(7791),o=n(2951),r=n(1976),s=n(824),a=n.n(s),l=n(5809),c=n(2800),u=n(1282);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function h(e,t,n,i){var o={username:e,isBroadcaster:!1,inFanclub:!1,isFollowing:"t"===i,hasTokens:!1,isMod:!1,tippedRecently:!1,tippedALotRecently:!1,tippedTonsRecently:!1,exploringHashTag:"",gender:n,sourceName:"un"};return"o"===t?o.isBroadcaster=!0:"m"===t?o.isMod=!0:"f"===t?o.inFanclub=!0:"l"===t?o.tippedTonsRecently=!0:"p"===t?o.tippedALotRecently=!0:"tr"===t?o.tippedRecently=!0:"t"===t?o.hasTokens=!0:"r"===t?o.recentlyEntered=!0:"g"!==t&&error("Unexpected IUserInfo colorGroup",{colorGroup:t}),o}function f(e){return e.isBroadcaster?"o":e.isMod?"m":e.inFanclub?"f":e.tippedTonsRecently?"l":e.tippedALotRecently?"p":e.tippedRecently?"tr":e.hasTokens?"t":"g"}var p=n(4793),m=n(1794),v=n(3705),g=n(9545),y=n(758),b=n(3753),w=n(1289),C=new Map;function x(e,t,n){var i={roomname:e,private:n,sort_by:t,exclude_staff:!0},o=(0,w.Ie)(i),r=C.get(o);if(void 0!==r)return r;var s=new Promise((function(e,t){(0,b.Ue)("api/getchatuserlist/?".concat(o)).then((function(t){e(function(e){var t,n=e.split(","),i=~~n[0],o=[],r=!1,s=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(n=n.slice(1));try{for(s.s();!(t=s.n()).done;){var a=t.value.split("|"),f=(0,l.Z)(a,4),p=f[0],m=f[1],v=f[2],g=f[3];void 0!==c.J.current.loggedInUser&&p===c.J.current.loggedInUser.username&&(r=!0);var y=h(p,m,v,g);o.push(y)}}catch(e){s.e(e)}finally{s.f()}if((0,u.L)("PushEnblRecEnter")&&!r&&void 0!==c.J.current.loggedInUser){var b,w=h(c.J.current.loggedInUser.username,"r",null!==(b=c.J.current.loggedInUser.gender)&&void 0!==b?b:"","f");o.push(w)}return{totalCount:i+o.length,anonCount:i,roomUsers:o}}(t.responseText)),window.setTimeout((function(){return C.delete(o)}),3e3)})).catch((function(e){t(e),C.delete(o)}))}));return C.set(o,s),s}var k=n(8666),S=n(7212),T=function(e,t){return e+Math.floor(Math.random()*t)},I=30*T(1,10)*1e3,R=I+60*T(2,10)*1e3,P=function(){return c.J.current.realtimeUserlistEnabled},M=new m.xB("roomUsersUpdate",{maxHistorySize:1,listenersWarningThreshold:function(){return 50+3*m.q6}}),A=["o","m","f","l","p","tr","t","g"],E=function(e,t){var n=A.indexOf(f(e)),i=A.indexOf(f(t));return n!==i?n<i?-1:1:e.username.localeCompare(t.username)},B=function(){function e(){var t=this;(0,o.Z)(this,e),this.recentPublicEnterLeaves=new Map,this.publicListeners=new m.mM,this.privateListeners=new m.mM,this.refetchDisabled=!1,p.kN.listen((function(e){t.chatConnection=e.chatConnection,t.room=e.dossier.room,t.roomUid=e.dossier.roomUid,t.sortUsersBy=e.dossier.userChatSettings.sortUsersKey,t.roomLoadTime=performance.now(),t.refetchCounter=0,t.initializePublicUserList(),t.chatConnection.event.statusChange.listen((function(e){"privatewatching"===e.currentStatus?t.initializePrivateUserList():"privatewatching"===e.previousStatus&&(t.cleanUpPrivateUserList(),M.fire(t.getRoomUsersInfo()))}))})),y.gO.listen((function(e){e.sortUsersKey!==t.sortUsersBy&&(t.sortUsersBy=e.sortUsersKey,t.refetch(!0).catch(g.$x))})),p.QN.listen((function(){t.cleanupPublicUserList(),t.cleanUpPrivateUserList(),M.fire(t.getRoomUsersInfo())}))}var t;return(0,r.Z)(e,[{key:"activeUserList",get:function(){var e;return null!==(e=this.privateUserList)&&void 0!==e?e:this.publicUserList}},{key:"getRoomUsersInfo",value:function(){var e,t,n,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.publicUserList:this.activeUserList;return{totalCount:null!==(e=null==i?void 0:i.getTotalUsers())&&void 0!==e?e:0,anonCount:null!==(t=null==i?void 0:i.getAnonUsers())&&void 0!==t?t:0,roomUsers:null!==(n=null==i?void 0:i.getUsers())&&void 0!==n?n:[]}}},{key:"userInRoomState",value:function(e){var t,n;return!0===(null===(t=this.activeUserList)||void 0===t?void 0:t.hasUser(e))?0:!0===(null===(n=this.publicUserList)||void 0===n?void 0:n.hasUser(e))?1:2}},{key:"refetch",value:(t=(0,i.Z)(a().mark((function e(){var t,n,i,o,r,s,l,u=this,d=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&void 0!==d[0]&&d[0],n=d.length>1&&void 0!==d[1]&&d[1],c.J.current.isBroadcast){e.next=4;break}return e.abrupt("return");case 4:if(t||void 0===this.refetchedRecentlyTimeout&&!this.refetchDisabled){e.next=6;break}return e.abrupt("return");case 6:return window.clearTimeout(this.refetchedRecentlyTimeout),this.refetchedRecentlyTimeout=window.setTimeout((function(){u.refetchedRecentlyTimeout=void 0}),2e3),e.next=10,this.fetchRoomUsers(!0);case 10:i=e.sent,(o=new L(i,this.sortUsersBy)).includeCurrentUser(),this.recentPublicEnterLeaves.forEach((function(e){var t=e.user;"enter"===e.action?o.addUser(t):o.deleteUser(t)})),r=void 0!==this.publicUserList&&!o.equals(this.publicUserList),(n||c.J.current.isBroadcast&&r)&&(void 0!==this.latestRefetchTime&&(l=((l=performance.now()-this.latestRefetchTime)-I)/6e4),(0,v.fg)("RoomUserListsMismatched",{current_size:null===(s=this.publicUserList)||void 0===s?void 0:s.getUsers().length,new_size:o.getUsers().length,time_elapsed_m:(performance.now()-this.roomLoadTime)/6e4,time_since_last_refetch_m:l,refetch_count:this.refetchCounter,lag_window_m:I/6e4})),this.latestRefetchTime=performance.now(),this.refetchCounter+=1,this.publicUserList=o,M.fire(this.getRoomUsersInfo());case 20:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"toggleRefetch",value:function(e){this.refetchDisabled=!e}},{key:"fetchRoomUsers",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(void 0===this.room)return error("roomUsers: calling fetchRoomUsers when not in a room"),Promise.reject("not in a room");var i=!n&&null!==(e=null===(t=this.chatConnection)||void 0===t?void 0:t.inPrivateRoom())&&void 0!==e&&e;return x(this.room,this.sortUsersBy,i)}},{key:"initializePublicUserList",value:function(){var e=this;this.listenForPublicEnterLeaves(),window.setTimeout((function(){e.refetch().catch(g.$x)}),3e3),window.setTimeout((function(){e.refetch().catch(g.$x)}),I),this.refetchInterval=window.setInterval((function(){e.refetch().catch(g.$x)}),R)}},{key:"cleanupPublicUserList",value:function(){this.publicListeners.removeAll(),this.recentPublicEnterLeaves.clear(),window.clearTimeout(this.refetchedRecentlyTimeout),window.clearInterval(this.refetchInterval),this.refetchedRecentlyTimeout=void 0,this.publicUserList=void 0}},{key:"listenForPublicEnterLeaves",value:function(){var e=this;void 0!==this.roomUid?(c.J.current.isBroadcast||c.q.getState().isModerator)&&(new S.rc(this.roomUid).onMessage.listen((function(t){e.onPublicEnterLeave(t.user,t.action)})).addTo(this.publicListeners),new S.ws(this.roomUid).onMessage.listen((function(t){0===t.connections&&e.onPublicEnterLeave(t.user,t.action)})).addTo(this.publicListeners)):error("roomUsers: listening for public enter/leaves without room uid")}},{key:"onPublicEnterLeave",value:function(e,t){var n,i;"enter"===t?null===(n=this.publicUserList)||void 0===n||n.addUser(e):null===(i=this.publicUserList)||void 0===i||i.deleteUser(e),this.recordRecentPublicEnterLeave(e,t),M.fire(this.getRoomUsersInfo())}},{key:"recordRecentPublicEnterLeave",value:function(e,t){var n=this,i=this.recentPublicEnterLeaves.get(e.username);void 0!==i&&window.clearTimeout(i.timeout);var o=window.setTimeout((function(){n.recentPublicEnterLeaves.delete(e.username)}),I);this.recentPublicEnterLeaves.set(e.username,{user:e,action:t,timeout:o})}},{key:"initializePrivateUserList",value:function(){if(this.privateUserList=new L(void 0,this.sortUsersBy),this.privateUserList.includeCurrentUser(),c.J.current.isBroadcast){var e,t=null===(e=this.chatConnection)||void 0===e?void 0:e.getPrivateShowUser();if(void 0===t)error("roomUsers: no private show user when initializing private user list");else{var n,i=null===(n=this.publicUserList)||void 0===n?void 0:n.getLatestUserInfo(t);void 0!==i&&this.privateUserList.addUser(i)}}M.fire(this.getRoomUsersInfo()),this.listenForPrivateEnterLeaves()}},{key:"cleanUpPrivateUserList",value:function(){this.privateListeners.removeAll(),this.privateUserList=void 0}},{key:"listenForPrivateEnterLeaves",value:function(){var e=this,t=function(t){void 0!==e.roomUid?new k.M4(e.roomUid,t).onMessage.listen((function(t){"leave"===t.action&&0!==t.connections||e.onPrivateEnterLeave(t.user,t.action)})).addTo(e.privateListeners):error("roomUsers: listening for private enter/leaves without room uid")},n=c.q.getState();if(""!==n.privateShowId)t(n.privateShowId);else{var i=-1,o=c.q.onUpdate.listen((function(e){var n=c.q.getState().privateShowId;""!==n&&(t(n),o.removeListener(),clearTimeout(i))}),!1);i=window.setTimeout((function(){error("roomUsers: no private show ID after 10 seconds"),o.removeListener()}),1e4)}}},{key:"onPrivateEnterLeave",value:function(e,t){var n,i;"enter"===t?null===(n=this.privateUserList)||void 0===n||n.addUser(e):null===(i=this.privateUserList)||void 0===i||i.deleteUser(e),M.fire(this.getRoomUsersInfo())}}],[{key:"getInstance",value:function(){return void 0===e.instance&&(e.instance=new e),e.instance}}]),e}(),L=function(){function e(t,n){var i,r,s=this;(0,o.Z)(this,e),this.currentUsersSet=new Set,this.historicalUsers=new Map,this.currentUsers=null!==(i=null==t?void 0:t.roomUsers)&&void 0!==i?i:[],this.anonUsers=null!==(r=null==t?void 0:t.anonCount)&&void 0!==r?r:0,this.sortUsersBy=n,this.currentUsers.forEach((function(e){s.currentUsersSet.add(e.username),s.historicalUsers.set(e.username,e)}))}return(0,r.Z)(e,[{key:"getUsers",value:function(){return this.currentUsers}},{key:"getTotalUsers",value:function(){return this.currentUsers.length+this.anonUsers}},{key:"getAnonUsers",value:function(){return this.anonUsers}},{key:"getLatestUserInfo",value:function(e){return this.historicalUsers.get(e)}},{key:"hasUser",value:function(e){return this.currentUsersSet.has(e)}},{key:"addUser",value:function(e){this.hasUser(e.username)||("a"===this.sortUsersBy?this.addUserAlphaSorted(e):this.addUserTokenSorted(e))}},{key:"deleteUser",value:function(e){if(this.hasUser(e.username)){var t=this.currentUsers.findIndex((function(t){return t.username===e.username}));this.currentUsers.splice(t,1),this.currentUsersSet.delete(e.username)}}},{key:"includeCurrentUser",value:function(){var e=function(){var e;if(void 0!==c.J.current.loggedInUser&&c.J.current.isBroadcast)return h(c.J.current.loggedInUser.username,"o",null!==(e=c.J.current.loggedInUser.gender)&&void 0!==e?e:"","f")}();void 0!==e&&this.addUser(e)}},{key:"equals",value:function(e){return e.getUsers().length===this.currentUsers.length&&this.currentUsers.every((function(t){return e.hasUser(t.username)}))}},{key:"addUserAlphaSorted",value:function(e){var t=function(e,t,n){for(var i=0,o=e.length;i<o;){var r=Math.floor((i+o)/2);n(t,e[r])>=0?i=r+1:o=r}return i}(this.currentUsers,e,E);this.currentUsers.splice(t,0,e),this.currentUsersSet.add(e.username),this.historicalUsers.set(e.username,e)}},{key:"addUserTokenSorted",value:function(e){this.currentUsers.push(e),this.currentUsersSet.add(e.username),this.historicalUsers.set(e.username,e)}}]),e}()},1612:function(e,t,n){"use strict";n.d(t,{D:function(){return y},w:function(){return b}});var i,o,r,s,a,l,c,u,d,h,f,p,m=n(3753),v=n(3543),g=n(7386),y={CBAlias:"chaturbate.com",DBWLDomain:"",tagLine:v.ag.tagLine,tagLineColor:"#0b5d81",siteName:"Chaturbate",jpegStreamUrl:"https://cbjpeg.stream.highwebmedia.com/",jpegRoomImgUrl:"https://roomimg.stream.highwebmedia.com/",cbGamesUrl:"https://games.multimediallc.com/",bgColor:"#ffffff",navigationBgColor:"#0c6a93",navigationFontColor:"#ffffff",navigationAltBgColor:"#f47321",navigationAlt2BgColor:"#ffffff",navigationAlt2BgImage:"url(".concat(STATIC_URL_ROOT,"tsdefaultassets/gender_tab_bg.gif) repeat-x"),h1Color:"#004B5E",textColor:"#494949",defaultColor:"#494949",defaultTooltipColor:"#222222",userInfoAreaTextColor:"#222222",hrefColor:"#0A5B83",tabBorderColor:"#8bb3da",tabActiveColor:"#ffffff",tabInactiveColor:"#dde9f5",tabActiveFontColor:"#dc5500",tabInactiveFontColor:"#5e81a4",tagExhibColor:"#6D85B5",tagFontColor:"#FFF",tagOfflineColor:"#4F4F4F",tagPrivateColor:"#B60A42",contentBgColor:"#FFFFFF",camBgColor:"#F0F1F1",camBorderColor:"#ACACAC",camSubjectColor:"#000",camSubjectTagColor:"#0A5A83",camAltTextColor:"#575757",camHrefColor:"#0A5A83",tokenHrefColor:"#e45900",footerHrefColor:"#676767",footerTextColor:"#494949",copyrightTextColor:"#494949",logoImageName:(0,g.V)(),signupBgColor:"#f47321",logoWidth:void 0,footerHtml:"",headerGif:"#ffffff url(".concat(STATIC_URL_ROOT,"tsdefaultassets/header_bg.gif) repeat-x"),footerGif:"#ffffff url(".concat(STATIC_URL_ROOT,"tsdefaultassets/footer_bg.gif) repeat-x"),userInfoBgColor:"#e9e9e9",usernameColor:"#ffffff",nextCamBgColor:"#FCEADB",footerColNameColor:"#494949",footerRowColor:"#0A5A83",footerSiteNavColor:"#dc5500",chatAreaTabColor:"#4C4C4C",defaultCampaignSlug:"",isWhiteLabel:!1,shouldHideWaterMark:!1,shouldChangeFooterBorder:!1,shouldChangeFooterTextColor:!1,shouldAddWhiteLabelPoweredBy:!1,shouldShowHeaderAd:!0,showEarnFreeTokens:!0,shouldShowAltLanguages:!0,shouldShowFooterAddress:!0,roomSubjectToolTipColor:"#494949",loginOverlayColor:"#000000",dismissibleMessageColor:"#494949",userInfoDropdownBgColor:"#3C87BA",userInfoDropdownHighlightColor:"#F47321",userInfoDropdownTextColor:"#ffffff",userUpdatesFeedbackLink:"https://www.surveymonkey.com/r/DXYF5T8",hideEntranceTerms:!0===window.hide_entrance_terms,carouselActiveCircleColor:"#F47321",carouselArrowBgColor:"#FFFFFF",carouselArrowColor:"#000000",carouselBgColor:"#F8F9fA",carouselBorderColor:"#ACACAC",carouselCircleColor:"#6E6F70",carouselHrefColor:"#0A5B83",carouselTitleColor:"#494949"},b=y;void 0!==window.siteSettings?(o=(i=window.siteSettings).navigation_font_color,r=i.text_color,s=i.tab_inactive_color,a=i.tab_inactive_font_color,l=i.content_bgcolor,c=i.footer_href_color,u=i.footer_text_color,d=i.tab_inactive_color,h=i.tab_active_color,f=i.tab_active_font_color,p=i.cam_href_color,b={CBAlias:i.chaturbate_alias,DBWLDomain:i.dbwl_domain,tagLine:i.tagline,tagLineColor:i.tagline_color,siteName:i.site_name,jpegStreamUrl:i.jpeg_stream_url,jpegRoomImgUrl:i.jpeg_room_img_url,cbGamesUrl:i.cb_games_url,bgColor:i.bgcolor,navigationBgColor:i.navigation_bgcolor,navigationFontColor:o,navigationAltBgColor:i.navigation_alt_bgcolor,navigationAlt2BgColor:i.navigation_alt_2_bgcolor,navigationAlt2BgImage:"",h1Color:i.h1_color,textColor:r,defaultColor:y.defaultColor,defaultTooltipColor:y.defaultTooltipColor,userInfoAreaTextColor:r,hrefColor:i.href_color,tabBorderColor:i.tab_border_color,tabActiveColor:i.tab_active_color,tabInactiveColor:s,tabActiveFontColor:i.tab_active_font_color,tabInactiveFontColor:a,tagExhibColor:i.tag_exhibitionist_color,tagFontColor:i.tag_font_color,tagOfflineColor:i.tag_offline_color,tagPrivateColor:i.tag_private_group_color,contentBgColor:l,camBgColor:i.cam_background_color,camBorderColor:i.cam_border_color,camSubjectColor:i.cam_text_color,camSubjectTagColor:"#0C6A93",camAltTextColor:i.cam_text_alt_color,camHrefColor:p,tokenHrefColor:p,footerHrefColor:c,footerTextColor:u,copyrightTextColor:u,logoImageName:i.logo_image_name,signupBgColor:i.signup_bg_color,logoWidth:i._logo_width,footerHtml:i.footer_html,headerGif:"",footerGif:"",userInfoBgColor:l,usernameColor:o,nextCamBgColor:s,footerColNameColor:a,footerRowColor:c,footerSiteNavColor:c,chatAreaTabColor:"#0C6A93",defaultCampaignSlug:i.default_campaign_slug,isWhiteLabel:!0,shouldHideWaterMark:!0,shouldChangeFooterBorder:!0,shouldChangeFooterTextColor:!0,shouldAddWhiteLabelPoweredBy:!0,shouldShowHeaderAd:!1,showEarnFreeTokens:!1,shouldShowAltLanguages:!1,shouldShowFooterAddress:!1,roomSubjectToolTipColor:"#222222",loginOverlayColor:r,dismissibleMessageColor:r,recordHitURL:i.whitelabel_hit_count_referring_url,userInfoDropdownBgColor:d,userInfoDropdownHighlightColor:h,userInfoDropdownTextColor:f,userUpdatesFeedbackLink:y.userUpdatesFeedbackLink,hideEntranceTerms:y.hideEntranceTerms,carouselActiveCircleColor:i.carousel_active_circle_color,carouselArrowBgColor:i.carousel_arrow_bg_color,carouselArrowColor:i.carousel_arrow_color,carouselBgColor:i.carousel_bg_color,carouselBorderColor:i.carousel_border_color,carouselCircleColor:i.carousel_circle_color,carouselHrefColor:i.carousel_href_color,carouselTitleColor:i.carousel_title_color}):void 0!==window.siteUrls&&(b.jpegStreamUrl=window.siteUrls.jpeg_stream_url,b.jpegRoomImgUrl=window.siteUrls.jpeg_room_img_url,b.cbGamesUrl=window.siteUrls.cb_games_url),void 0!==b.recordHitURL&&(0,m.I5)("whitelabels/record_hit/",{referer:b.recordHitURL}).catch((function(e){error("Error recording whitelabel hit",e)}))},1962:function(e,t,n){"use strict";n.d(t,{b:function(){return f}});var i=n(4649),o=n(2951),r=n(1976),s=n(7591),a=n(9492),l=n(7597),c=n(9),u=n(8263),d=n(47);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var f=function(e){(0,s.Z)(p,e);var t,n,f=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function p(e){return(0,o.Z)(this,p),f.call(this,"div",e)}return(0,r.Z)(p,[{key:"initUI",value:function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({display:"grid",alignItems:"center",columnGap:null==e?void 0:e.columnGap},null==e?void 0:e.containerStyle);this.element=(0,d.vz)("div",{style:t})}},{key:"addButton",value:function(e){e instanceof c.w?this.addChild(e):this.element.appendChild(e),(0,u.Zs)(this.element,{gridTemplateColumns:"repeat(".concat(this.element.childElementCount,", auto)")})}}]),p}(c.w)},6429:function(e,t,n){"use strict";n.d(t,{Q:function(){return S},R:function(){return k}});var i=n(4649),o=n(3940),r=n(7591),s=n(9492),a=n(7597),l=n(2951),c=n(1976),u=n(3753),d=n(391),h=n(9),f=n(4801),p=n(8970),m=n(3543),v=n(1185),g=n(2080),y=n(8785);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var k=function(){function e(){(0,l.Z)(this,e)}return(0,c.Z)(e,null,[{key:"parseData",value:function(t){var n,i=new d.j(t),o=i.getObject("initial"),r=i.getMap("schema"),s=r.getList("fieldsets");n=void 0===s?[]:s.map((function(e){return{fields:e.getStringList("fields"),label:e.getString("label")}}));for(var a=JSON.parse(t).schema.fields,l={},c=0,u=Object.keys(a);c<u.length;c++){var h=u[c],f=new d.j(JSON.stringify(a[h])),p=null===o[h]?void 0:o[h];l[h]=e.parseField(h,f,p),f.logUnusedDebugging("parse DjangoForm field")}return{extra:i.getObject("extra"),initial:o,schema:{prefix:r.getStringOrUndefined("prefix"),fields:l,fieldsets:n,label_suffix:r.getStringOrUndefined("label_suffix"),field_order:r.getStringList("field_order")}}}},{key:"parseField",value:function(t,n,i){return{defaultValue:i,name:t,minLength:n.getNumberOrUndefined("min_length"),maxLength:n.getNumberOrUndefined("max_length"),emptyValue:n.getStringOrUndefined("empty_value"),choices:e.parseSelectOptions(n.getList("choices")),required:n.getBoolean("required"),disabled:n.getBoolean("disabled"),helpText:n.getString("help_text"),labelText:n.getString("label"),fieldType:n.getString("type"),siteKey:n.getStringOrUndefined("site_key")}}},{key:"parseSelectOptions",value:function(e){if(void 0===e)return[];var t,n=[],i=C(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;n.push({label:o.getStringWithNumbers("label"),value:o.getStringWithNumbersOrBoolean("value")})}}catch(e){i.e(e)}finally{i.f()}return n}}]),e}(),S=function(e){(0,r.Z)(d,e);var t,n,i=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function d(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,l.Z)(this,d),(n=i.call(this,"form")).data=e,n.fields={},n.fieldsets={},n.loading=!1,n.initializeOptions(r),n.element.style.position="static";var s=document.createElement("table");n.element.appendChild(s),n.tbody=document.createElement("tbody"),s.appendChild(n.tbody),n.submitButton=n.createSubmitButton(),n.element.appendChild(n.submitButton),n.generateFields();var a=function(e,t){(0,u.I5)(e,t).then((function(){n.loading=!1,n.options.onSubmitSuccess(t)})).catch((function(e){n.loading=!1;var t=JSON.parse(e.xhr.responseText).errors;if(null!==t&&"object"===(0,o.Z)(t)){for(var i=0,r=Object.keys(n.fields);i<r.length;i++){var s,a=r[i];null===(s=n.fields[a])||void 0===s||s.onFormError()}for(var l in t){var c=t[l][0];if("string"!=typeof c)break;var u=n.getField((0,f.NZ)("InCntSUpV2")&&"subgender"===l?"gender":l);if(void 0===u){if((0,f.NZ)("InCntSUpV2")&&"__all__"===l)continue;error("Form error on unknown field ".concat(l))}else u.setError(c,n.options.labelStyleOnError)}n.options.onSubmitError(e)}}))};return n.element.onsubmit=function(e){if(e.preventDefault(),n.hideErrorMessages(),!n.loading){n.loading=!0;var i=new FormData(n.element);if(n.captchaField instanceof g.n1){var o=n.captchaField.getWidget();(0,p.l)(o,n.element)().then((function(e){!0===e&&a(t,new FormData(n.element))})).catch((function(){}))}else a(t,i)}},n}return(0,c.Z)(d,[{key:"initializeOptions",value:function(e){var t={field:new y.rk,checkbox:new y.jW,input:new y.u_,select:new y.WK,textarea:new y.jx,multipleCheckboxes:new y.wj,multipleSelect:new y.lL,noReCaptcha:new y.V,reCaptcha3:new y.Ei};this.options={onSubmitSuccess:void 0===e.onSubmitSuccess?function(){}:e.onSubmitSuccess,onSubmitError:void 0===e.onSubmitError?function(){}:e.onSubmitError,labelStyleOnError:void 0===e.labelStyleOnError||e.labelStyleOnError,styles:void 0===e.styles?t:w(w({},t),e.styles)}}},{key:"generateFields",value:function(){if(this.data.schema.field_order.length>0){var e,t=C(this.data.schema.field_order);try{for(t.s();!(e=t.n()).done;){var n=e.value,i=this.data.schema.fields[n];this.addField(this.createField(i))}}catch(e){t.e(e)}finally{t.f()}}else if(void 0!==this.data.schema.fieldsets){var o,r=C(this.data.schema.fieldsets);try{for(r.s();!(o=r.n()).done;){var s=o.value;this.addFieldset(s.label);var a,l=C(s.fields);try{for(l.s();!(a=l.n()).done;){var c=a.value,u=this.data.schema.fields[c];(0,f.NZ)("InCntSUpV2")&&void 0===u||this.addFieldToFieldset(this.createField(u),s.label)}}catch(e){l.e(e)}finally{l.f()}}}catch(e){r.e(e)}finally{r.f()}}else for(var d=0,h=Object.keys(this.data.schema.fields);d<h.length;d++){var p=h[d],m=this.data.schema.fields[p];this.addField(this.createField(m))}}},{key:"createField",value:function(e){var t,n;switch(e.fieldType){case"CharField":return void 0===e.maxLength?new g.Kx(w(w({},e),{},{styles:this.options.styles.textarea})):new g.II(w(w({},e),{},{styles:this.options.styles.input}));case"EmailField":return new g.II(w(w({},e),{},{styles:this.options.styles.input}));case"BooleanField":return new g.I0(w(w({},e),{},{styles:this.options.styles.checkbox}));case"ChoiceField":case"TypedChoiceField":return new g.Ph(w(w({},e),{},{styles:this.options.styles.select}));case"MultiSelectFormField":return new g.Zf(w(w({},e),{},{styles:this.options.styles.multipleSelect}));case"DateField":return new g.jo(w(w({},e),{},{day:this.data.initial["".concat(e.name,"__day")],month:this.data.initial["".concat(e.name,"__month")],year:this.data.initial["".concat(e.name,"__year")],styles:this.options.styles.select}));case"NoReCaptchaField":var i=null!==(t=e.siteKey)&&void 0!==t?t:"";return""===i&&error("siteKey must be provided for NoReCaptchaField"),this.captchaField=new g.q6(w(w({},e),{},{siteKey:i,styles:this.options.styles.noReCaptcha})),this.captchaField;case"ReCaptcha3Field":var o=null!==(n=e.siteKey)&&void 0!==n?n:"";return""===o&&error("siteKey must be provided for ReCaptcha3Field"),this.captchaField=new g.n1(w(w({},e),{},{siteKey:o,styles:this.options.styles.reCaptcha3})),this.captchaField;default:return error("DjangoForm received an unknown field type: ".concat(e.fieldType)),new g.II({name:""})}}},{key:"addField",value:function(e){void 0===this.fields[e.getName()]?(this.fields[e.getName()]=e,this.tbody.appendChild(e.getField())):error("Field ".concat(e.getName()," already exists"))}},{key:"addFieldToFieldset",value:function(e,t){var n=this.getFieldset(t);void 0!==n?void 0===this.fields[e.getName()]?(this.fields[e.getName()]=e,n.appendChild(e.getField())):error("Field ".concat(e.getName()," already exists")):error("Fieldset ".concat(t," does not exist"))}},{key:"removeField",value:function(e){var t=this.fields[e];void 0!==t&&(t.getField().remove(),delete this.fields[e])}},{key:"createFieldset",value:function(e){var t=document.createElement("fieldset"),n=document.createElement("table"),i=document.createElement("tbody");return t.appendChild(this.createLegend(e)),t.appendChild(n),n.appendChild(i),this.fieldsets[e]=i,t}},{key:"createLegend",value:function(e){var t=document.createElement("legend");return(0,v.vP)(t,"label"),t.innerText=e,t.style.fontSize="1.266em",t.style.fontFamily="'UbuntuMedium', Arial, Helvetica, sans-serif",t.style.fontWeight="normal",t.style.padding="10px 0px 10px 0px",""===e&&(t.style.display="none"),t}},{key:"hideErrorMessages",value:function(){for(var e=0,t=Object.keys(this.fields);e<t.length;e++){var n=t[e],i=this.fields[n];void 0!==i&&i.clearError(this.options.labelStyleOnError)}}},{key:"createSubmitButton",value:function(){var e=document.createElement("input");return e.type="submit",e.value=m.ag.submitCAPS,e.className="button",e.style.display="block",e.style.cursor="pointer",e.style.padding="0px 30px 2px 15px",e.style.margin="15px 0px 0px 137px",e.style.width="auto",e.style.height="28px",e.style.borderRadius="4px",e.style.font="1.16em/1.0em 'UbuntuMedium', Arial, Helvetica, sans-serif",e}},{key:"focusFirstField",value:function(){var e=Object.keys(this.fields)[0];if(void 0!==e){var t=this.fields[e];void 0!==t&&t.getWidget().focus()}}},{key:"getField",value:function(e){return this.fields[e]}},{key:"getFieldset",value:function(e){return this.fieldsets[e]}},{key:"getSubmitButton",value:function(){return this.submitButton}},{key:"prependFieldset",value:function(e){this.tbody.insertBefore(this.createFieldset(e),this.tbody.firstChild)}},{key:"addFieldset",value:function(e){this.tbody.appendChild(this.createFieldset(e))}},{key:"setSubmitText",value:function(e){this.submitButton.value=e}}]),d}(h.w)},5696:function(e,t,n){"use strict";n.d(t,{OF:function(){return C},QY:function(){return w},tB:function(){return k}});var i=n(2951),o=n(1976),r=n(7169),s=n(3243),a=n(7591),l=n(9492),c=n(7597),u=n(9),d=n(8263),h=n(1794),f=n(1185),p=n(9760),m=n(14),v=n(6640);function g(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var w=function(e){(0,a.Z)(n,e);var t=b(n);function n(e,o){var s;return(0,i.Z)(this,n),(s=t.call(this,e)).defaultDisplay="inline-block",s.collapseEvent=new h.xB("collapse",{reportIfNoListeners:!1}),s.overflownSibling=[],s.shownSibling=[],s.spacer=new v.i,s.collapsedTabs=[],s.listeners=new h.mM,void 0!==e&&"string"!=typeof e||s.styleElement(),s.dropDown=s.createDropDown(!0===o),(0,d.Zs)((0,r.Z)(s),{userSelect:"none"}),s.hideElement(),(0,d.Zs)(s.spacer,{cssFloat:"right",height:"100%",visibility:"hidden"}),s.listeners.add(s.dropDown.toggleEvent.listen((function(e){s.onToggle(e)}))),s.listeners.add(p.nR.listen((function(e){s.dropDown.isShown()&&s.dropDown.hideElement(),s.collapseIfNeeded(!e)}))),window.setTimeout((function(){s.attachSpacer(),s.collapseIfNeeded()})),s}return(0,o.Z)(n,[{key:"collapseIfNeeded",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.dropDown.isShown();t&&this.restoreTabsFromDropDown(),this.separateOverflownSiblings(),this.showOrHideBasedOnOverflownSiblings(),e&&this.isShown()&&this.fixLeftPosition(),t&&(0===this.overflownSibling.length?this.dropDown.hideElement():(this.addTabsToDropDown(),this.dropDown.reposition()))}},{key:"showOrHideBasedOnOverflownSiblings",value:function(){0===this.overflownSibling.length?this.isShown()&&(this.hideElement(),this.spacer.element.style.paddingLeft="0px",this.collapseEvent.fire(!1)):1===this.overflownSibling.length&&this.isShown()&&this.lastOverflownElementHasEnoughSpace()?this.tryToHideThisAndShowLastOverflown():this.isShown()||(this.showElement(this.defaultDisplay),this.reposition(),this.collapseEvent.fire(!0),this.separateOverflownSiblings())}},{key:"tryToHideThisAndShowLastOverflown",value:function(){this.hideElement();var e=this.spacer.element.style.paddingLeft;this.spacer.element.style.paddingLeft="0px",this.separateOverflownSiblings(),this.overflownSibling.length>0?(this.showElement(this.defaultDisplay),this.spacer.element.style.paddingLeft=e):this.collapseEvent.fire(!1)}},{key:"lastOverflownElementHasEnoughSpace",value:function(){var e=this.overflownSibling[0],t=getComputedStyle(e.element);return e.element.offsetWidth+(0,d.gV)(t.marginLeft)+(0,d.gV)(t.marginRight)+5<=this.element.offsetWidth+this.spacer.element.offsetLeft-this.element.offsetLeft}},{key:"setSpacerWidth",value:function(e){this.spacer.element.style.width="".concat(e,"px")}},{key:"isTargetOverflownAnchor",value:function(e){return this.overflownSibling.some((function(t){return t.element.children[0]===e}))}},{key:"lastShownSibling",value:function(){return this.shownSibling[this.shownSibling.length-1]}},{key:"firstTab",value:function(){if(void 0!==this.parent){var e,t=g(this.parent.children());try{for(t.s();!(e=t.n()).done;){var n=e.value;if(x(n.element))return n}}catch(e){t.e(e)}finally{t.f()}}}},{key:"repositionChildren",value:function(){(0,s.Z)((0,c.Z)(n.prototype),"repositionChildren",this).call(this),this.collapseIfNeeded()}},{key:"onToggle",value:function(e){e.isShowing?(this.separateOverflownSiblings(),this.addTabsToDropDown()):this.restoreTabsFromDropDown()}},{key:"addTabsToDropDown",value:function(){var e=this;this.overflownSibling.forEach((function(t){e.collapsedTabs.unshift([t,t.nextSibling()]),e.dropDown.addChild(t),t.collapse(!0)}))}},{key:"restoreTabsFromDropDown",value:function(){var e=this.parent;this.collapsedTabs.forEach((function(t){var n=t[0];e.addChildBefore(n,t[1]),n.collapse(!1)})),this.collapsedTabs=[]}},{key:"collapsibleSiblings",value:function(){return void 0===this.parent?[]:this.parent.children().filter((function(e){return e instanceof k&&e.isShown()}))}},{key:"createDropDown",value:function(e){return new m.i(this.element,e)}},{key:"separateOverflownSiblings",value:function(){var e=this;if(null!==this.element.parentElement&&null!==this.element.parentElement.offsetParent){var t=this.collapsibleSiblings();this.overflownSibling=[],this.shownSibling=[],t.forEach((function(t){C(t)?e.overflownSibling.push(t):e.shownSibling.push(t)}))}}},{key:"reposition",value:function(){null!==this.element.parentElement&&((0,d.Zs)(this.element,{position:"absolute",boxSizing:"border-box",textAlign:"center"}),this.spacer.element.style.paddingLeft="".concat(this.element.offsetWidth,"px"),this.element.removeAttribute("data-floatingnav"),""===this.element.style.width&&(this.element.style.width="".concat(this.element.offsetWidth+1,"px")))}},{key:"attachSpacer",value:function(){if(void 0!==this.parent||null!==this.element.parentElement){var e=void 0===this.parent?this.element.parentElement:this.parent.element,t=this.firstTab();void 0!==t&&e.insertBefore(this.spacer.element,t.element.nextSibling)}}},{key:"styleElement",value:function(){return this.element.appendChild(document.createTextNode(n.DOTDOTDOT_TEXT)),(0,f.vP)(this.element,f.ql.chatAreaTabColor),(0,d.Zs)(this.element,{cursor:"pointer",width:"",height:"",padding:"0 10px",textAlign:"center"}),this.element}},{key:"fixLeftPosition",value:function(){var e=this;if(void 0!==this.parent){var t,n=0,i=g(this.parent.children());try{for(i.s();!(t=i.n()).done;){var o=t.value;!x(o.element)||o===this||o instanceof k&&-1===this.shownSibling.indexOf(o)||(n=Math.max(o.element.offsetLeft+o.element.offsetWidth+(0,d.gV)(getComputedStyle(o.element).marginRight),n))}}catch(e){i.e(e)}finally{i.f()}this.element.offsetLeft!==n&&(this.element.style.left="".concat(n,"px"),window.setTimeout((function(){e.element.style.left=""})))}}},{key:"dispose",value:function(){this.dropDown.dispose(),this.listeners.removeAll()}}]),n}(u.w);function C(e){if(null===e.element.parentElement)return!1;if(e.element.parentElement.offsetHeight<=e.element.offsetHeight)return.5*e.element.offsetHeight+e.element.offsetTop>=e.element.parentElement.offsetHeight;var t=e.element.parentElement.scrollHeight>e.element.parentElement.offsetHeight,n=e.element.parentElement.offsetHeight<=.5*e.element.offsetHeight+e.element.offsetTop;return t&&n}function x(e){return"none"!==e.style.display&&"right"!==e.style.cssFloat&&"absolute"!==e.style.position&&"fixed"!==e.style.position}w.DOTDOTDOT_TEXT=".â€‰.â€‰.";var k=function(e){(0,a.Z)(n,e);var t=b(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div";return(0,i.Z)(this,n),(e=t.call(this,o)).onCollapseEvent=new h.xB("collapse",{reportIfNoListeners:!1}),e.collapsed=!1,window.setTimeout((function(){e.onCollapseEvent.fire(e.collapsed)})),e}return(0,o.Z)(n,[{key:"collapse",value:function(e){this.collapsed=e,e?this.element.classList.add("collapsed"):this.element.classList.remove("collapsed"),this.onCollapseEvent.fire(e)}}]),n}(u.w)},8785:function(e,t,n){"use strict";n.d(t,{Ei:function(){return w},V:function(){return b},WK:function(){return h},Wb:function(){return v},jW:function(){return g},jx:function(){return m},lL:function(){return f},rk:function(){return d},u_:function(){return p},wj:function(){return y}});var i=n(3243),o=n(7591),r=n(9492),s=n(7597),a=n(2951),l=n(1976),c=n(1185);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,s.Z)(e);if(t){var o=(0,s.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,r.Z)(this,n)}}var d=function(){function e(){(0,a.Z)(this,e)}return(0,l.Z)(e,[{key:"styleRow",value:function(e){e.style.padding="3px 0"}},{key:"styleLabelContainer",value:function(e){e.style.minWidth="130px",e.style.width="auto",e.style.paddingTop="10px",e.style.paddingBottom="1px",e.style.verticalAlign="top",e.style.textAlign="right"}},{key:"styleLabel",value:function(e){(0,c.vP)(e,c.ql.defaultColor),e.style.textAlign="right",e.style.fontWeight="bold",e.style.font="1em/1.3em 'UbuntuMedium', Arial, Helvetica, sans-serif",e.style.padding="0",e.style.margin="0 4px 0 0"}},{key:"styleFieldContainer",value:function(e){(0,c.vP)(e,c.ql.defaultColor)}},{key:"styleField",value:function(e){(0,c.vP)(e,"field"),e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.borderRadius="4px",e.style.padding="2px 4px",e.style.lineHeight="18px",e.style.marginTop="4px",e.style.width="225px"}},{key:"styleHelpText",value:function(e){(0,c.vP)(e,c.ql.defaultColor),e.style.fontFamily="UbuntuRegular, Arial, Helvetica, sans-serif",e.style.fontSize="11px",e.style.width="350px"}}]),e}(),h=function(e){(0,o.Z)(n,e);var t=u(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"styleField",value:function(e){(0,i.Z)((0,s.Z)(n.prototype),"styleField",this).call(this,e),e.style.width="auto",e.style.marginTop="7px"}}]),n}(d),f=function(e){(0,o.Z)(n,e);var t=u(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"styleField",value:function(e){(0,i.Z)((0,s.Z)(n.prototype),"styleField",this).call(this,e),e.style.height="",e.size=10}}]),n}(h),p=function(e){(0,o.Z)(n,e);var t=u(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n)}(d),m=function(e){(0,o.Z)(n,e);var t=u(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"styleField",value:function(e){(0,c.vP)(e,"fieldTextArea"),e.style.width="350px",e.style.lineHeight="18px",e.style.marginTop="4px",e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.borderRadius="4px",e.style.padding="2px 4px",e.style.overflow="hidden",e.style.height="150px"}}]),n}(d),v=function(e){(0,o.Z)(n,e);var t=u(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"styleLabel",value:function(e){(0,c.vP)(e,c.ql.defaultColor),e.style.width="100%",e.style.textAlign="left",e.style.fontWeight="bold",e.style.font="1em/1.3em 'UbuntuMedium', Arial, Helvetica, sans-serif",e.style.margin="0px 4px 6px"}},{key:"styleLabelContainer",value:function(e){e.style.minWidth="130px",e.style.width="auto",e.style.paddingLeft="10px",e.style.paddingBottom="1px",e.style.verticalAlign="top",e.style.textAlign="right"}}]),n}(m),g=function(e){(0,o.Z)(n,e);var t=u(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"styleFieldContainer",value:function(e){(0,i.Z)((0,s.Z)(n.prototype),"styleFieldContainer",this).call(this,e),e.style.paddingTop="7px"}}]),n}(d),y=function(e){(0,o.Z)(n,e);var t=u(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"styleFieldContainer",value:function(e){(0,i.Z)((0,s.Z)(n.prototype),"styleFieldContainer",this).call(this,e),e.style.paddingTop="7px"}},{key:"styleField",value:function(e){(0,i.Z)((0,s.Z)(n.prototype),"styleField",this).call(this,e),e.style.width="auto",e.style.marginTop="7px"}}]),n}(d),b=function(e){(0,o.Z)(n,e);var t=u(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"styleField",value:function(e){(0,i.Z)((0,s.Z)(n.prototype),"styleField",this).call(this,e),e.style.position="",e.style.padding="",e.style.overflow="",e.style.background="",e.style.border=""}}]),n}(d),w=function(e){(0,o.Z)(n,e);var t=u(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"styleRow",value:function(e){e.style.display="none"}}]),n}(d)},2080:function(e,t,n){"use strict";n.d(t,{I0:function(){return L},Jf:function(){return D},jo:function(){return U},II:function(){return P},Zf:function(){return O},ij:function(){return E},q6:function(){return Z},n1:function(){return F},Ph:function(){return A},M4:function(){return B},Kx:function(){return M}});var i,o=n(4649),r=n(126),s=n(3243),a=n(7591),l=n(9492),c=n(7597),u=n(2951),d=n(1976),h=n(7693),f=n(9),p=n(1794),m=n(3340);var v=new p.xB("recaptchaLoaded",{maxHistorySize:1});window.recaptchaLoadCallback=function(){i=window.grecaptcha,v.fire(void 0)};var g=function(e){(0,a.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function r(){var e;return(0,u.Z)(this,r),(e=o.call(this)).element.style.height="",e.element.style.width="",e}return(0,d.Z)(r,[{key:"render",value:function(e){var t=this;v.once((function(){void 0===e.theme&&(e.theme=document.body.classList.contains("darkmode")?"dark":"light"),void 0===t.listener&&(t.listener=m.rb.listen((function(e){void 0!==t.widgetData&&(t.widgetData.parameters.theme="darkmode"===e?"dark":"light",t.reset())})));var n=i.render(t.element,e);t.widgetData={widgetID:n,parameters:e}}))}},{key:"reset",value:function(){void 0!==this.widgetData&&(i.reset(this.widgetData.widgetID),this.updateTheme())}},{key:"getResponse",value:function(){return void 0!==this.widgetData?i.getResponse(this.widgetData.widgetID):""}},{key:"updateTheme",value:function(){if(void 0!==this.widgetData){var e=this.element.getElementsByTagName("iframe")[0];"dark"===this.widgetData.parameters.theme?e.src=e.src.replace("theme=light","theme=dark"):e.src=e.src.replace("theme=dark","theme=light")}}}]),r}(f.w),y=n(3543),b=n(1185),w=n(851),C=n(8785);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var R=function(){function e(t){(0,u.Z)(this,e),this.required=!1,this.disabled=!1,this.errorMessage="",this.initializeData(t),this.errorContainer=document.createElement("div"),(0,b.vP)(this.errorContainer,"fieldError"),this.errorContainer.style.display="none",this.createLabel(),this.createLabelContainer(),this.createWidgetContainer(),this.labelContainer.appendChild(this.label),this.createRow(),this._assembleField()}return(0,d.Z)(e,[{key:"initializeData",value:function(e){this.name=e.name,this.defaultValue=void 0===e.defaultValue?"":String(e.defaultValue),this.labelText=void 0===e.labelText?"":e.labelText,this.helpText=void 0===e.helpText?"":e.helpText,this.required=void 0!==e.required&&e.required,this.disabled=void 0!==e.disabled&&e.disabled,this.onChange=void 0===e.onChange?function(){}:e.onChange,this.styles=void 0===e.styles?new C.rk:e.styles}},{key:"getField",value:function(){return this.field}},{key:"getWidget",value:function(){return this.widget}},{key:"getErrorContainer",value:function(){return this.errorContainer}},{key:"getHelpText",value:function(){return this.helpText}},{key:"getName",value:function(){return this.name}},{key:"onFormError",value:function(){}},{key:"setError",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.errorContainer.style.display="",this.errorContainer.innerText=e,t&&(0,b.vP)(this.label,"fieldError")}},{key:"clearError",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.errorContainer.style.display="none",this.errorContainer.innerText="",e&&((0,b.FU)(this.label,"fieldError"),this.styles.styleLabel(this.label))}},{key:"setDisabled",value:function(e){this.disabled=e,"disabled"in this.widget&&(this.widget.disabled=e)}},{key:"setOnChange",value:function(e){this.onChange=e}},{key:"_assembleField",value:function(){this.assembleField(),this.afterAssembleField()}},{key:"afterAssembleField",value:function(){this.widgetContainer.appendChild(this.createHelpText()),this.widgetContainer.appendChild(this.errorContainer)}},{key:"createLabel",value:function(){this.label=document.createElement("label"),this.styles.styleLabel(this.label),this.label.innerText=this.formatLabelText()}},{key:"createLabelContainer",value:function(){this.labelContainer=document.createElement("th"),this.styles.styleLabelContainer(this.labelContainer),""===this.labelText&&(this.labelContainer.style.display="none")}},{key:"updateLabelText",value:function(e){this.labelText=e,this.label.innerText=this.formatLabelText(),""===this.labelText?this.labelContainer.style.display="none":this.labelContainer.style.display=""}},{key:"formatLabelText",value:function(){return"".concat(this.labelText,": ").concat(this.required?"*":"")}},{key:"createWidgetContainer",value:function(){this.widgetContainer=document.createElement("td"),this.styles.styleFieldContainer(this.widgetContainer)}},{key:"createHelpText",value:function(){if(this.helpText instanceof HTMLElement)return this.styles.styleHelpText(this.helpText),this.helpText;var e=document.createElement("div");return""===this.helpText?e.style.display="none":(this.styles.styleHelpText(e),e.innerHTML=this.helpText),e}},{key:"createRow",value:function(){this.field=document.createElement("tr"),this.styles.styleRow(this.field),this.field.appendChild(this.labelContainer),this.field.appendChild(this.widgetContainer)}}]),e}(),P=function(e){(0,a.Z)(n,e);var t=I(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,d.Z)(n,[{key:"getValue",value:function(){return this.widget.value}},{key:"createField",value:function(){var e=document.createElement("input");return e.name=this.name,e.value=this.defaultValue,this.styles.styleField(e),e.required=this.required,e.disabled=this.disabled,void 0!==this.minLength&&(e.minLength=this.minLength),void 0!==this.maxLength&&(e.maxLength=this.maxLength),e}},{key:"assembleField",value:function(){this.widget=this.createField(),this.widgetContainer.appendChild(this.widget)}},{key:"initializeData",value:function(e){(0,s.Z)((0,c.Z)(n.prototype),"initializeData",this).call(this,e),this.minLength=e.minLength,this.maxLength=e.maxLength,this.styles=void 0===e.styles?new C.u_:e.styles}}]),n}(R),M=function(e){(0,a.Z)(n,e);var t=I(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,d.Z)(n,[{key:"getValue",value:function(){return this.widget.value}},{key:"createField",value:function(){var e=document.createElement("textarea");e.name=this.name,e.id="id_".concat(this.name),e.value=this.defaultValue,e.required=this.required,e.disabled=this.disabled,void 0!==this.minLength&&(e.minLength=this.minLength),void 0!==this.maxLength&&(e.maxLength=this.maxLength),this.styles.styleField(e);var t=function(){var t=e.offsetHeight-e.clientHeight;e.style.height="auto",e.style.height="".concat(e.scrollHeight+t+15,"px")};return window.setTimeout((function(){t()}),0),(0,h.j9)("input",e,(function(){t()})),e}},{key:"assembleField",value:function(){this.widget=this.createField(),this.widgetContainer.appendChild(this.widget)}},{key:"initializeData",value:function(e){(0,s.Z)((0,c.Z)(n.prototype),"initializeData",this).call(this,e),this.minLength=e.minLength,this.maxLength=e.maxLength,this.styles=void 0===e.styles?new C.jx:e.styles}}]),n}(R),A=function(e){(0,a.Z)(n,e);var t=I(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,d.Z)(n,[{key:"getValue",value:function(){return this.widget.value}},{key:"createField",value:function(){var e=this,t=document.createElement("select");t.name=this.name,t.multiple=this.multiple,t.required=this.required,t.disabled=this.disabled,this.styles.styleField(t);var n,i=this.defaultValue.split(","),o=S(this.choices);try{for(o.s();!(n=o.n()).done;){var r=n.value,s=document.createElement("option");s.innerText=String(r.label),s.value=String(r.value),s.selected=i.includes(s.value),t.appendChild(s)}}catch(e){o.e(e)}finally{o.f()}return(0,h.j9)("change",t,(function(t){e.onChange(e)})),t}},{key:"assembleField",value:function(){this.widget=this.createField(),this.widgetContainer.appendChild(this.widget)}},{key:"initializeData",value:function(e){(0,s.Z)((0,c.Z)(n.prototype),"initializeData",this).call(this,e),this.multiple=void 0!==e.multiple&&e.multiple,this.choices=void 0===e.choices?[]:e.choices,this.styles=void 0===e.styles?new C.WK:e.styles,"true"===this.defaultValue?this.defaultValue="True":"false"===this.defaultValue&&(this.defaultValue="False")}}]),n}(R),E=function(e){(0,a.Z)(n,e);var t=I(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,d.Z)(n,[{key:"getValue",value:function(){var e,t=[],n=S(this.selectedOptions.options);try{for(n.s();!(e=n.n()).done;){var i=e.value;t.push(i.value)}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"createField",value:function(){var e=this,t=document.createElement("select");this.selectedOptions=document.createElement("select");var n=document.createElement("div");n.style.clear="both",n.style.display="none",this.widgetContainer.appendChild(n);var i=function(t){var i=document.createElement("input");i.type="checkbox",i.style.display="none",i.name=e.name,i.value=t,i.checked=!0,i.id="listselect_".concat(e.name,"_").concat(t),n.appendChild(i)};this.styles.styleField(t),this.styles.styleField(this.selectedOptions);var o,s=this.defaultValue.split(","),a=S(this.choices);try{for(a.s();!(o=a.n()).done;){var l=o.value,c=document.createElement("option");c.innerText=String(l.label),c.value=String(l.value),s.includes(c.value)?(this.selectedOptions.appendChild(c),i(c.value)):t.appendChild(c)}}catch(e){a.e(e)}finally{a.f()}t.multiple=!0,t.disabled=this.disabled,this.selectedOptions.multiple=!0,this.selectedOptions.disabled=this.disabled;var u=function(t,o,s){for(var a,l,c=t.selectedOptions.length,u=(0,r.Z)(t.selectedOptions),d=0;d<c;d+=1){var h=u[d];h.selected=!1,o.appendChild(h),s?i(h.value):(a=h.value,void 0,null!==(l=document.getElementById("listselect_".concat(e.name,"_").concat(a)))&&n.removeChild(l))}};return(0,h.j9)("change",t,(function(n){u(t,e.selectedOptions,!0),e.onChange(e)})),(0,h.j9)("change",this.selectedOptions,(function(n){u(e.selectedOptions,t,!1),e.onChange(e)})),t}},{key:"initializeData",value:function(e){(0,s.Z)((0,c.Z)(n.prototype),"initializeData",this).call(this,e),this.selectedHeader=void 0===e.selectedHeader?"":e.selectedHeader,this.unselectedHeader=void 0===e.unselectedHeader?"":e.unselectedHeader,this.styles=void 0===e.styles?new C.lL:e.styles}},{key:"createHeader",value:function(e){var t=document.createElement("strong");return(0,b.vP)(t,"label"),t.style.fontWeight="bold",t.innerText=e,t}},{key:"createSelectContainer",value:function(){var e=document.createElement("div");return e.style.marginRight="5px",e.style.cssFloat="left",e.style.width="200px",e}},{key:"assembleField",value:function(){var e=this.createSelectContainer(),t=this.createSelectContainer(),n=this.createHeader(this.unselectedHeader),i=this.createHeader(this.selectedHeader);this.widget=this.createField(),e.appendChild(n),e.appendChild(this.widget),t.appendChild(i),t.appendChild(this.selectedOptions),this.widgetContainer.appendChild(e),this.widgetContainer.appendChild(t)}}]),n}(A),B=function(e){(0,a.Z)(n,e);var t=I(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,d.Z)(n,[{key:"createField",value:function(){var e=this;return this.transparentCheckbox=new w.S(16,"True"===this.defaultValue,(function(){e.transparentCheckbox.setCheckboxValue(e.getChecked()?"True":"False"),e.onChange(e)})),this.transparentCheckbox.setName(this.name),this.styles.styleField(this.transparentCheckbox.element),this.setDisabled(this.disabled),this.transparentCheckbox.element}},{key:"assembleField",value:function(){this.widget=this.createField(),this.widgetContainer.appendChild(this.widget)}},{key:"getValue",value:function(){return this.transparentCheckbox.getCheckboxValue()}},{key:"initializeData",value:function(e){(0,s.Z)((0,c.Z)(n.prototype),"initializeData",this).call(this,e),this.styles=void 0===e.styles?new C.jW:e.styles,"true"===this.defaultValue?this.defaultValue="True":"false"===this.defaultValue&&(this.defaultValue="False")}},{key:"setChecked",value:function(e){this.transparentCheckbox.setCheckedDirectly(e)}},{key:"getChecked",value:function(){return this.transparentCheckbox.isChecked()}},{key:"setDisabled",value:function(e){e?this.transparentCheckbox.disable():this.transparentCheckbox.enable()}}]),n}(R),L=function(e){(0,a.Z)(n,e);var t=I(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,d.Z)(n,[{key:"createField",value:function(){var e=this,t=document.createElement("input");return t.name=this.name,t.value=this.defaultValue,t.checked="True"===this.defaultValue,t.required=this.required,t.disabled=this.disabled,t.type="checkbox",this.styles.styleField(t),(0,h.j9)("change",t,(function(n){e.widget.value=t.checked?"True":"False",e.onChange(e)})),t}},{key:"getValue",value:function(){return this.widget.value}},{key:"initializeData",value:function(e){(0,s.Z)((0,c.Z)(n.prototype),"initializeData",this).call(this,e),this.styles=void 0===e.styles?new C.jW:e.styles,"true"===this.defaultValue?this.defaultValue="True":"false"===this.defaultValue&&(this.defaultValue="False")}},{key:"setChecked",value:function(e){this.widget.checked=e}},{key:"getChecked",value:function(){return this.widget.checked}}]),n}(P),O=function(e){(0,a.Z)(n,e);var t=I(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,d.Z)(n,[{key:"getValue",value:function(){var e,t=[],n=S(this.checkboxes);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.isChecked()&&t.push(i.getCheckboxValue())}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"initializeData",value:function(e){(0,s.Z)((0,c.Z)(n.prototype),"initializeData",this).call(this,e),this.choices=void 0===e.choices?[]:e.choices,this.styles=void 0===e.styles?new C.wj:e.styles}},{key:"createCheckboxesField",value:function(){var e=document.createElement("div");this.checkboxes=[];var t,n=S(this.choices);try{for(n.s();!(t=n.n()).done;){var i=t.value,o=-1!==this.defaultValue.indexOf(String(i.value)),r=new w.S(16,o);r.setName(this.name),r.setCheckboxValue(String(i.value)),this.styles.styleField(r.element),this.disabled&&r.disable(),this.checkboxes.push(r);var s=document.createElement("label");s.className="checkboxFieldLabel";var a=document.createTextNode(String(i.label));s.appendChild(r.element),s.appendChild(a),e.appendChild(s)}}catch(e){n.e(e)}finally{n.f()}return e}},{key:"assembleField",value:function(){var e=this.createCheckboxesField();this.widgetContainer.appendChild(e)}}]),n}(P),D=function(e){(0,a.Z)(n,e);var t=I(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,d.Z)(n,[{key:"initializeData",value:function(e){(0,s.Z)((0,c.Z)(n.prototype),"initializeData",this).call(this,e),this.customElement=e.customElement}},{key:"getValue",value:function(){return""}},{key:"createField",value:function(){return document.createElement("div")}},{key:"assembleField",value:function(){this.widgetContainer.appendChild(this.customElement)}}]),n}(R),U=function(e){(0,a.Z)(n,e);var t=I(n);function n(e){return(0,u.Z)(this,n),t.call(this,k(k({},e),{},{choices:[]}))}return(0,d.Z)(n,[{key:"initializeData",value:function(e){(0,s.Z)((0,c.Z)(n.prototype),"initializeData",this).call(this,k(k({},e),{},{choices:[]})),this.defaultDay=void 0===e.day?"0":e.day.toString(10),this.defaultMonth=void 0===e.month?"0":e.month.toString(10),this.defaultYear=void 0===e.year?"0":e.year.toString(10)}},{key:"getValue",value:function(){return[this.monthField.value,this.dayField.value,this.yearField.value]}},{key:"createDateField",value:function(e,t,n){var i=document.createElement("select");i.name="".concat(this.name,"_").concat(n),this.styles.styleField(i);var o,r=S(e);try{for(r.s();!(o=r.n()).done;){var s=o.value,a=document.createElement("option");a.innerText="".concat(s.label),a.value="".concat(s.value),i.appendChild(a)}}catch(e){r.e(e)}finally{r.f()}return i.value=t,i.required=this.required,i}},{key:"getDayOptions",value:function(){var e=[];e.push({label:"---",value:"0"});for(var t=1;t<=31;t+=1){var n=t.toString(10);e.push({label:n,value:n})}return e}},{key:"getMonthOptions",value:function(){var e=[],t=[y.ag.january,y.ag.february,y.ag.march,y.ag.april,y.ag.may,y.ag.june,y.ag.july,y.ag.august,y.ag.september,y.ag.october,y.ag.november,y.ag.december];e.push({label:"---",value:"0"});for(var n=0;n<t.length;n+=1)e.push({label:t[n],value:(n+1).toString(10)});return e}},{key:"getYearOptions",value:function(){var e=[],t=(new Date).getFullYear()-18;e.push({label:"---",value:"0"});for(var n=t;n>1900;n-=1){var i=n.toString(10);e.push({label:i,value:i})}return e}},{key:"assembleField",value:function(){this.dayField=this.createDateField(this.getDayOptions(),this.defaultDay,"day"),this.monthField=this.createDateField(this.getMonthOptions(),this.defaultMonth,"month"),this.yearField=this.createDateField(this.getYearOptions(),this.defaultYear,"year"),this.widgetContainer.appendChild(this.monthField),this.widgetContainer.appendChild(this.dayField),this.widgetContainer.appendChild(this.yearField)}}]),n}(A),Z=function(e){(0,a.Z)(n,e);var t=I(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,d.Z)(n,[{key:"initializeData",value:function(e){(0,s.Z)((0,c.Z)(n.prototype),"initializeData",this).call(this,e),this.styles=void 0===e.styles?new C.V:e.styles,this.sitekey=e.siteKey}},{key:"getValue",value:function(){return this.recaptcha.getResponse()}},{key:"createField",value:function(){return this.recaptcha=new g,this.styles.styleField(this.recaptcha.element),this.recaptcha.element}},{key:"assembleField",value:function(){var e=this;this.widget=this.createField(),this.recaptcha.render({sitekey:this.sitekey,callback:function(t){e.clearError()}}),this.widgetContainer.appendChild(this.widget)}},{key:"onFormError",value:function(){(0,s.Z)((0,c.Z)(n.prototype),"onFormError",this).call(this),this.recaptcha.reset()}}]),n}(R),F=function(e){(0,a.Z)(n,e);var t=I(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,d.Z)(n,[{key:"createField",value:function(){var e=(0,s.Z)((0,c.Z)(n.prototype),"createField",this).call(this);return e.required=!1,e.type="hidden",e}}]),n}(P)},2295:function(e,t,n){"use strict";n.d(t,{MO:function(){return B},VY:function(){return D},YO:function(){return L}});var i=n(4649),o=n(5809),r=n(2951),s=n(1976),a=n(3243),l=n(7591),c=n(9492),u=n(7597),d=n(8759),h=n(7693),f=n(3753),p=n(4793),m=n(9),v=n(8263),g=n(5392),y=n(1794),b=n(9598),w=n(1625),C=n(6893),x=n(2833),k=n(8978),S=n(1809),T=n(3543),I=n(1185),R=n(8945),P=n(7397),M=n(1994),A=n(7376);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var B=new y.xB("floatingPlayerShow"),L=new y.xB("floatingPlayerHide"),O="floatingPlayerSettings",D=function(e){(0,l.Z)(y,e);var t,n,m=(t=y,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var o=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,c.Z)(this,e)});function y(e,t,n){var i;(0,r.Z)(this,y),(i=m.call(this)).player=e,i.onexpand=t,i.onclose=n,i.videoSection=document.createElement("a"),i.roomName=document.createElement("a"),i.isDragging=!1,i.isShowing=!1,i.isWidescreen=!0,i.menuBubbleIsOpen=!1,i.width=280,i.right=15,i.bottom=15,i.cachedBottom=15;var s={right:"6px",top:"7px"},a={right:"6px",top:"6px"};(0,I.vP)(i.element,"floatingPlayer"),(0,v.Zs)(i.element,{zIndex:1004,right:"0px",bottom:"0px",position:"fixed",overflow:"visible",animationName:"fadein",WebkitAnimationName:"fadein",animationDuration:"0.2s",WebkitAnimationDuration:"0.2s",animationTimingFunction:"linear",WebkitAnimationTimingFunction:"linear",height:"auto",width:"auto",borderWidth:"1px",borderStyle:"solid",borderRadius:"4px"}),i.element.onclick=function(e){e.stopPropagation()},(0,h.j9)("touchstart",document.getElementsByTagName("body")[0],(function(){})),i.getSettingsLocalstorage(),p.kN.listen((function(e){i.isWidescreen=e.dossier.isWidescreen}));var l=document.createElement("div");(0,I.vP)(l,"header"),(0,v.Zs)(l,{height:"30px",lineHeight:"30px",width:"100%",position:"relative",top:"0px",left:"0px",borderTopLeftRadius:"4px",borderTopRightRadius:"4px"}),i.element.appendChild(l),(0,v.Zs)(i.roomName,{marginLeft:"15px",userSelect:"none",msUserSelect:"none",WebkitUserSelect:"none",fontFamily:"UbuntuMedium, Arial, Helvetica, sans-serif",overflow:"hidden",textOverflow:"ellipsis",height:"30px",maxWidth:"calc(100% - 60px)",whiteSpace:"nowrap",cursor:"pointer",position:"relative",display:"inline-block"}),(0,v.nH)(i.roomName).listen((function(e){i.roomName.style.textDecoration=!0===e?"underline":"none"})),l.appendChild(i.roomName),i.moveArea=i.createClickableOverlay(l,"move"),(0,v.Zs)(i.moveArea,{position:"absolute",top:"0px",left:"0px",height:"30px",width:"calc(100% - 60px)"});var c=document.createElement("div");(0,I.vP)(c,"optionsArea"),(0,v.Zs)(c,{position:"absolute",right:"30px",top:"3px",height:"25px",width:"25px",borderRadius:"4px",cursor:"pointer"}),c.ontouchstart=function(e){i.openCloseMenuBubble(),e.preventDefault()},c.onclick=function(e){i.openCloseMenuBubble(),e.preventDefault()},l.appendChild(c);var u=i.createIcon("".concat(STATIC_URL,"menu.svg"),c,a);(0,I.vP)(u,"lightOptionsIcon");var f=i.createIcon("".concat(STATIC_URL,"darkmode-menu.svg"),c,a);(0,I.vP)(f,"darkOptionsIcon"),c.style.display="None";var w=document.createElement("div");(0,I.vP)(w,"closeArea"),(0,v.Zs)(w,{position:"absolute",right:"5px",top:"3px",height:"25px",width:"25px",borderRadius:"4px",cursor:"pointer"}),w.ontouchstart=function(e){i.close(),e.preventDefault()},w.onclick=function(){i.close()},l.appendChild(w);var k=i.createIcon("".concat(STATIC_URL,"floating-player-close.svg"),w,s);(0,I.vP)(k,"lightCloseIcon");var S=i.createIcon("".concat(STATIC_URL,"floating-player-close-darkmode.svg"),w,s);(0,I.vP)(S,"darkCloseIcon"),(0,v.Zs)(i.videoSection,{position:"relative",cursor:"pointer",display:"block"});var T=i.createClickableOverlay(i.videoSection,"pointer");if((0,v.Zs)(T,{top:"0",left:"0",right:"0",bottom:"0",borderBottomRightRadius:"4px",borderBottomLeftRadius:"4px"}),i.createReturnIcon(T),i.videoSection.onclick=function(e){e.metaKey||e.ctrlKey||e.shiftKey||(e.preventDefault(),i.isDragging||i.expand())},i.element.appendChild(i.videoSection),(0,A.$)(i.element,(function(e){return function(t,n,r){var s=i.isWidescreen?x.fo:x.$V,a={initialBottom:i.bottom,initialRight:i.right,initialWidth:i.width,initialX:n,initialY:r,minWidth:150,ratio:s},l=i.right,c=i.bottom,u=i.width,d=i.availableWidth(),h=(0,o.Z)(d,2),f=h[0],p=h[1];return i.isDragging=!0,t.stopPropagation(),{enabled:!0,move:function(t,n){var o=(0,A.G)(a,t,n,e),r=[o.right,o.bottom,o.width];l=r[0],c=r[1];var d=(u=r[2])*s;i.setPosition(Math.min(Math.max(c,0),f-(d+30)),Math.min(Math.max(l,0),p-u)),i.videoSection.style.width="".concat(u,"px"),i.videoSection.style.height="".concat(d,"px"),i.element.style.height="".concat(d+30),i.element.style.width=i.videoSection.style.width},end:function(){i.bottom=c,i.cachedBottom=c,i.right=l,i.width=u,i.saveSettingsLocalstorage(),M()}}}})),(0,d.v8)()){var R=document.createElement("object");R.style.position="absolute",R.style.width="calc(100% + 10px)",R.style.height="calc(100% + 10px)",R.style.top="-5px",R.style.left="-5px",R.style.zIndex="-1",R.type="application/x-mpegURL",R.data="",R.setAttribute("wmode","transparent"),i.element.appendChild(R)}var M=function(){window.setTimeout((function(){i.isDragging=!1}),100)};return(0,g.T)(i.moveArea,(function(e,t,n){var r=i.element.offsetHeight,s=i.element.offsetWidth,a=i.right,l=i.bottom,c=i.bottom,u=i.right,d=t,h=n,f=i.availableWidth(),p=(0,o.Z)(f,2),m=p[0],v=p[1];return{enabled:!0,move:function(e,t){var n,o;n=e-d,o=t-h,c=Math.min(Math.max(l-o,0),m-r),u=Math.min(Math.max(a-n,0),v-s),i.setPosition(c,u)},end:function(){i.bottom=c,i.cachedBottom=c,i.right=u,i.saveSettingsLocalstorage()}}})),C.tb.listen((function(e){i.element.style.visibility=e.active?"hidden":"visible"})),b.wk.listen((function(e){e.roomName===i.room&&void 0!==i.followStar&&i.followStar.setFollowing(e.following)})),P._j.listen((function(){i.repositionChildren()})),i.repositionChildren(),i}return(0,s.Z)(y,[{key:"openCloseMenuBubble",value:function(){void 0===this.menuBubble?this.createMenuBubble():this.menuBubbleIsOpen?(this.menuBubble.style.display="none",this.menuBubbleIsOpen=!1):(this.menuBubble.style.display="block",this.menuBubbleIsOpen=!0)}},{key:"createMenuBubble",value:function(){var e=this;this.menuBubbleIsOpen=!0,this.menuBubble=document.createElement("div"),(0,I.vP)(this.menuBubble,"menuBubble"),this.menuBubble.innerHTML=T.ag.floatingPlayerMenuBubbleText();var t=this.menuBubble.querySelector("a");(0,I.vP)(t,"link"),t.onclick=function(n){(0,S.U_)(n)||(n.preventDefault(),(0,S.cr)(t.href),e.openCloseMenuBubble())};var n=document.createElement("div");(0,I.vP)(n,"caret"),n.style.position="absolute",n.style.height="0px",n.style.width="0px",n.style.right="5px",n.style.top="-5px",n.style.borderBottomWidth="5px",n.style.borderBottomStyle="solid",n.style.borderRight="5px solid transparent",n.style.borderLeft="5px solid transparent";var i={position:"relative",verticalAlign:"middle",marginLeft:"4px",height:"14px",width:"14px"},o=this.createIcon("".concat(STATIC_URL,"option_cog_light.svg"),t,i);(0,I.vP)(o,"lightAdvancedOptionsIcon");var r=this.createIcon("".concat(STATIC_URL,"option_cog_dark.svg"),t,i);(0,I.vP)(r,"darkAdvancedOptionsIcon"),this.menuBubble.appendChild(n),this.menuBubble.style.position="absolute",this.menuBubble.style.width="240px",this.menuBubble.style.right="32px",this.menuBubble.style.top="40px",this.menuBubble.style.opacity="0.8",this.menuBubble.style.borderWidth="1px",this.menuBubble.style.borderStyle="solid",this.menuBubble.style.boxSizing="border-box",this.menuBubble.style.borderRadius="4px",this.menuBubble.style.padding="4px",this.menuBubble.style.zIndex="1005",this.element.appendChild(this.menuBubble)}},{key:"getSettingsLocalstorage",value:function(){if((0,d.IU)()){var e=window.localStorage.getItem(O);if(null!==e){var t=JSON.parse(e);this.bottom=t.bottom,this.cachedBottom=t.bottom,this.right=t.right,this.width=t.width}}}},{key:"saveSettingsLocalstorage",value:function(){if((0,d.IU)()){var e={bottom:this.bottom<0?0:this.bottom,right:this.right,width:this.width};window.localStorage.setItem(O,JSON.stringify(e))}}},{key:"setPosition",value:function(e,t){(0,v.Zs)(this.element,{bottom:"".concat(e<0?0:e,"px"),right:"".concat(t,"px")})}},{key:"repositionChildren",value:function(e){(0,a.Z)((0,u.Z)(y.prototype),"repositionChildren",this).call(this);var t=this.availableWidth(),n=(0,o.Z)(t,2),i=n[0],r=n[1],s=this.isWidescreen?x.fo:x.$V,l=Math.min(this.width,.66*r);this.videoSection.style.height="".concat(l*s,"px"),this.videoSection.style.width="".concat(l,"px"),this.element.style.width=this.videoSection.style.width;var c=(0,M.p)(e);this.bottom=c>0?Math.max(this.cachedBottom,c+4):this.cachedBottom,this.setPosition(Math.min(this.bottom,Math.max(0,i-this.element.offsetHeight)),Math.min(this.right,Math.max(0,r-this.element.offsetWidth)))}},{key:"createIcon",value:function(e,t,n){var o=document.createElement("img");return o.src=e,o.height=13,o.width=13,(0,v.Zs)(o,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({height:"13px",width:"13px",position:"absolute",cursor:"pointer",userSelect:"none",msUserSelect:"none",WebkitUserSelect:"none"},n)),o.setAttribute("draggable","false"),t.appendChild(o),o}},{key:"createReturnIcon",value:function(e){var t=this.createIcon("".concat(STATIC_URL,"return-to-room.svg"),e,{top:"50%",left:"50%",width:"25px",height:"25px",display:"none",transform:"translate(-50%, -50%)"});return(0,v.nH)(e).listen((function(n){!0===n?(e.style.backgroundColor="rgba(0, 0, 0, 0.6)",t.style.display="block"):(e.style.backgroundColor="rgba(0, 0, 0, 0.01)",t.style.display="none")})),L.listen((function(){e.style.backgroundColor="rgba(0, 0, 0, 0.01)",t.style.display="none"})),t}},{key:"createClickableOverlay",value:function(e,t){var n=document.createElement("div");return n.style.position="absolute",n.style.cursor=t,n.style.backgroundColor="rgba(0, 0, 0, 0.01)",e.appendChild(n),n}},{key:"setRoomName",value:function(e){this.room=e,this.roomName.textContent="".concat(T.ag.watchingText," ").concat((0,k.Qs)(e)),this.roomName.href=(0,f.BN)("/".concat(e,"/")),this.videoSection.href=(0,f.BN)("/".concat(e,"/"))}},{key:"addFollowStar",value:function(e){void 0!==this.followStar&&this.videoSection.removeChild(this.followStar.element),this.followStar=new R.X({slug:this.room,isFollowing:e,location:"FloatingPlayer"}),this.followStar.element.style.top="5px",this.followStar.element.style.right="5px",this.videoSection.appendChild(this.followStar.element)}},{key:"show",value:function(){(0,w.rm)()||this.isShowing||(this.videoSection.insertBefore(this.player.playerComponent.element,this.videoSection.firstChild),document.body.appendChild(this.element),this.isShowing=!0,this.repositionChildrenRecursive(),B.fire(void 0))}},{key:"hide",value:function(){this.isShowing&&(this.isShowing=!1,this.player.element.insertBefore(this.player.playerComponent.element,this.player.element.firstChild),null!==this.element.parentElement&&this.element.parentElement.removeChild(this.element),L.fire(void 0))}},{key:"availableWidth",value:function(){var e,t;return"BackCompat"===document.compatMode?(e=document.body.clientHeight,t=document.body.clientWidth):(e=document.documentElement.clientHeight,t=document.documentElement.clientWidth),(window.innerWidth-t>40||window.innerWidth<t)&&(e=window.innerHeight,t=window.innerWidth),[e,t]}},{key:"close",value:function(){this.onclose(),this.hide()}},{key:"expand",value:function(){this.onexpand(),this.hide()}}],[{key:"showOnHomepage",value:function(){window.top!==window&&null!==window.top&&(window.top.document.body.style.display="")}},{key:"hideOnHomepage",value:function(){window.top!==window&&null!==window.top&&(window.top.document.body.style.display="none")}}]),y}(m.w)},6265:function(e,t,n){"use strict";n.d(t,{Co:function(){return R},aS:function(){return _},av:function(){return F},iW:function(){return Z}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(8759),u=n(7693),d=n(3753),h=n(4793),f=n(6767),p=n(1794),m=n(1625),v=n(2923),g=n(3682),y=n(9874),b=n(3705),w=n(2578),C=n(3543),x=n(47),k=n(2750),S=n(2800);function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var R=new p.xB("loginOverlayShown"),P="".concat(w.Ng,"?src=login_gate"),M=function(e){"Escape"!==e.key&&e.stopImmediatePropagation()},A="";h.kN.listen((function(e){A=e.chatConnection.room()}));var E=0;function B(e){var t=(0,w.yU)("/auth-sso/login/".concat(e.provider,"/?popup=1"),(0,w.GC)({ignoreExistingRoom:!0}));return(0,x.vz)("a",{className:"auth_option",href:"#",onClick:function(n){n.preventDefault(),(E+=1)>1||((0,b.fg)("SsoSignupClick",{provider:e.provider,source:"loginOverlay"}),(0,k.Pv)(t,"_blank",k.rq)),window.setTimeout((function(){E=0}),1e3)}},(0,x.vz)("div",null,(0,x.vz)("img",{src:"".concat(STATIC_URL_ROOT,"images/sso-").concat(e.provider,".svg"),alt:e.provider}),(0,x.vz)("p",null,C.ag.signInWithSocialAuth(e.name))))}var L,O,D=function(e){(0,s.Z)(n,e);var t=I(n);function n(){var e;(0,i.Z)(this,n),(e=t.call(this,{onShow:function(){e.repositionChildren(),e.isVisible=!0,e.usernameInput.focus(),(0,u.j9)("keydown",e.element,M),e.fullscreenChangeListener=m.gH.listen((function(){return e.hideBodyElement()})),e.hideBodyElement()},onHide:function(){var t,n=e.isVisible;e.element.style.display="none",e.isVisible=!1,n&&((0,u.SC)("keydown",e.element,M),null===(t=e.fullscreenChangeListener)||void 0===t||t.removeListener(),e.fullscreenChangeListener=void 0),e.unhideBodyElement(),e.clearAutofillPollInterval()},easyExit:!0})).isVisible=!1,e.autofillPollInterval=0,e.tabListenerFactory=function(e,t){return function(n){"Tab"===n.key&&(n.preventDefault(),n.shiftKey?t.focus():e.focus())}},e.detectInputFilled=function(){""!==e.passwordInput.value.trim()&&""!==e.usernameInput.value.trim()?(e.loginButton.removeAttribute("disabled"),e.rememberMeCheckBox.onkeydown=e.tabListenerFactory(e.loginButton,e.forgotPasswordLink),e.loginButton.onkeydown=e.tabListenerFactory(e.signupLink,e.rememberMeCheckBox),e.signupLink.onkeydown=e.tabListenerFactory(e.closeButton,e.loginButton),e.clearAutofillPollInterval()):(e.loginButton.disabled=!0,e.rememberMeCheckBox.onkeydown=e.tabListenerFactory(e.signupLink,e.forgotPasswordLink),e.signupLink.onkeydown=e.tabListenerFactory(e.closeButton,e.rememberMeCheckBox),e.createAutofillPollInterval())},e.clearAutofillPollInterval=function(){e.autofillPollInterval&&(window.clearInterval(e.autofillPollInterval),e.autofillPollInterval=0)},e.createAutofillPollInterval=function(){e.autofillPollInterval||(e.autofillPollInterval=window.setInterval((function(){e.detectInputFilled()}),200))};var o=function(e){var t=document.createElement("div");return t.style.display="block",t.style.margin="10px 0 0 0",e.appendChild(t),t};e.element.style.display="none",e.element.style.position="fixed",e.element.style.fontSize="12px",e.element.style.width="364px",e.element.style.height="auto",e.element.style.color="currentSiteSettings.defaultColor",e.element.style.margin="auto",e.element.style.boxShadow="0px 0px 10px rgba(0, 0, 0, 0.4)",e.element.style.background="white",e.element.style.border="3px solid #0E6C92",e.element.style.borderRadius="10px",e.element.style.visibility="visible",e.element.id="LoginOverlay",e.element.dataset.testid="login-form",e.overlay.classList.add("blurred-login-overlay"),e.overlay.style.visibility="visible",e.overlay.style.background="",e.overlay.style["-webkit-overflow-scrolling"]="touch",e.loginContainer=document.createElement("form"),e.loginContainer.target="_top",e.loginContainer.style.padding="5px 30px 10px 30px",e.loginContainer.action=(0,d.BN)((0,w.yU)(w.PU,(0,w.GC)({ignoreExistingRoom:!0}))),e.loginContainer.method="POST",e.loginContainer.onclick=function(e){e.stopPropagation()},e.element.appendChild(e.loginContainer);var r=o(e.loginContainer),s=o(e.loginContainer),a=o(e.loginContainer),l=o(e.loginContainer),c=o(e.loginContainer),p=o(e.loginContainer),v=o(e.loginContainer),g=o(e.loginContainer),y=o(e.loginContainer);c.style.display="flex",c.style.alignItems="center",e.closeButton=document.createElement("input"),e.closeButton.type="button",e.closeButton.onclick=function(t){t.preventDefault(),e.hide()},e.closeButton.value="",e.closeButton.style.background="transparent url(".concat(STATIC_URL,"close_icon2.svg) no-repeat center center"),e.closeButton.style.backgroundSize="10px",e.closeButton.style.padding="10px 20px 8px 12px",e.closeButton.style.border="none",e.closeButton.style.cursor="pointer",r.appendChild(e.closeButton),r.style.position="absolute",r.style.top="0px",r.style.right="0px",r.style.margin="0px",e.header=document.createElement("h1"),e.header.style.font="18px ubuntumedium,Arial,Helvetica,sans-serif",e.header.style.color="#f47422",s.appendChild(e.header),s.style.textAlign="center",e.usernameInput=e.createFormInput(a,"".concat(C.ag.usernameText,":"),"text","username"),e.usernameInput.required=!0,e.usernameInput.dataset.testid="username-input",e.forgotPasswordLink=document.createElement("a"),e.forgotPasswordLink.target="_top",e.forgotPasswordLink.href=(0,d.BN)("/auth/password_reset/"),e.forgotPasswordLink.tabIndex=0,e.forgotPasswordLink.textContent=C.ag.forgotPassword,e.forgotPasswordLink.style.cssFloat="right",e.forgotPasswordLink.dataset.testid="forgot-password-link",l.appendChild(e.forgotPasswordLink),e.passwordInput=e.createFormInput(l,"".concat(C.ag.passwordText,":"),"password","password"),e.passwordInput.required=!0,e.passwordInput.dataset.testid="password-input",e.rememberMeCheckBox=e.createFormInput(c,"".concat(C.ag.keepLoggedInText,":"),"checkbox","rememberme"),e.rememberMeCheckBox.style.marginLeft="10px",e.rememberMeCheckBox.dataset.testid="remember-me-check-box",e.loginButton=document.createElement("input"),e.loginButton.dataset.testid="login-button",e.loginButton.id="id_login_btn",e.loginButton.type="submit",e.loginButton.disabled=!0,e.loginButton.value=C.ag.loginVerbText,p.appendChild(e.loginButton);var b=S.J.current.socialAuths;if(void 0!==b&&b.length>0){var k=(0,x.vz)("div",{className:"or_separator"},(0,x.vz)("p",null,"Â orÂ "));v.appendChild(k);var I,R=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(b);try{for(R.s();!(I=R.n()).done;){var A=I.value;v.appendChild(B(A))}}catch(e){R.e(e)}finally{R.f()}v.style.marginBottom="16px"}var E,L=document.createElement("p");return L.textContent="".concat(C.ag.dontHaveAccountYet," "),L.style.display="inline",e.signupLink=document.createElement("a"),e.signupLink.target="_top",e.signupLink.classList.add("signupLogin"),e.signupLink.href=P,e.signupLink.tabIndex=0,e.signupLink.textContent=C.ag.signUpText,g.appendChild(L),g.appendChild(e.signupLink),g.style.textAlign="center",e.nextField=document.createElement("input"),e.csrfField=document.createElement("input"),e.nextField.type=e.csrfField.type="hidden",e.nextField.name="next",e.nextField.value=(E=(0,w.GC)({ignoreExistingRoom:!0}),-1!==(0,w.N0)().indexOf("/al/")||void 0===E.nextParam?"/":E.nextParam),e.csrfField.name="csrfmiddlewaretoken",e.csrfField.value=(0,f.ve)("csrftoken"),y.appendChild(e.nextField),y.appendChild(e.csrfField),y.style.display="none",e.closeButton.onkeydown=e.tabListenerFactory(e.usernameInput,e.signupLink),e.usernameInput.onkeydown=e.tabListenerFactory(e.passwordInput,e.closeButton),e.passwordInput.onkeydown=e.tabListenerFactory(e.forgotPasswordLink,e.usernameInput),e.forgotPasswordLink.onkeydown=e.tabListenerFactory(e.rememberMeCheckBox,e.passwordInput),e.rememberMeCheckBox.onkeydown=e.tabListenerFactory(e.loginButton,e.forgotPasswordLink),e.loginButton.onkeydown=e.tabListenerFactory(e.signupLink,e.rememberMeCheckBox),e.signupLink.onkeydown=e.tabListenerFactory(e.closeButton,e.loginButton),e.usernameInput.oninput=e.detectInputFilled,e.passwordInput.oninput=e.detectInputFilled,h.kN.listen((function(){e.nextField.value=(0,w.N0)()})),e}return(0,o.Z)(n,[{key:"initAndShow",value:function(e){if((0,k.zd)()&&""!==A)(0,k.Pv)("/auth/login/?next=/".concat(A,"/"));else{if(R.fire(void 0),this.header.innerText=void 0!==e.fromFeature&&e.fromFeature?C.ag.loginToUseFeature:C.ag.loginToContinue,this.csrfField.value=(0,f.ve)("csrftoken"),this.element.style.display="block",(0,r.Z)((0,l.Z)(n.prototype),"show",this).call(this),void 0!==e.seeBackground&&e.seeBackground&&(this.unhideBodyElement(),this.overlay.style.backgroundColor="rgba(0, 0, 0, 0.5)"),this.signupLink.href=(0,d.BN)(!0===e.returnToPage?(0,w.yU)(P,(0,w.GC)({})):P),!0===e.refreshOpener){var t=(0,w.GC)({ignoreExistingRoom:!0});void 0!==t.nextParam&&(t.nextParam.endsWith("/")?t.nextParam+="?refresh_opener=1":t.nextParam+="/refresh_opener=1",this.nextField.value=t.nextParam),this.loginContainer.action=(0,d.BN)((0,w.yU)("".concat(w.PU),t)),this.signupLink.href="".concat(this.signupLink.href,"?refresh_opener=1")}this.createAutofillPollInterval(),this.usernameInput.focus()}}},{key:"createFormInput",value:function(e,t,n,i){var o=this,r=document.createElement("label"),s=document.createElement("input");return r.innerText=t,r.htmlFor=i,s.type=n,s.id=i,s.name=i,s.style.height="checkbox"===n?"18px":"26px",s.style.width="checkbox"===n?"18px":"100%",s.style.font="100% Arial,Helvetica,sans-serif",s.style.color="#000",s.style.boxSizing="border-box",s.style.border="1px solid #d5d5d5",s.style.padding="2px 4px",s.style.margin="1px 0",s.style.lineHeight="18px",s.style.borderRadius="4px",(0,u.j9)("keydown",s,(function(e){"Enter"===e.key&&(e.preventDefault(),o.loginButton.click())})),e.appendChild(r),e.appendChild(s),s}},{key:"unhideBodyElement",value:function(){void 0!==this.bodyElement&&(this.bodyElement.style.visibility="",this.bodyElement.style.backgroundColor="",this.bodyElement.style.overflow="",this.bodyElement.style.position="",this.bodyElement.classList.remove("blurred-login-overlay-shown","embed-blurred-login-overlay"))}},{key:"hideBodyElement",value:function(){this.unhideBodyElement(),null!==this.element.parentElement&&(this.bodyElement=this.element.parentElement,this.bodyElement.style.overflow="hidden",this.bodyElement.classList.add("blurred-login-overlay-shown"),(0,c.op)()&&(this.bodyElement.style.position="fixed",this.bodyElement.classList.add("embed-blurred-login-overlay")))}},{key:"repositionChildren",value:function(){var e=Math.max(document.documentElement.clientWidth,window.innerWidth),t=Math.max(document.documentElement.clientHeight,window.innerHeight);this.element.style.left="".concat((e-this.loginContainer.offsetWidth)/2,"px"),this.element.style.top="".concat((t-this.loginContainer.offsetHeight)/2,"px")}}]),n}(y.z),U=function(e){(0,s.Z)(n,e);var t=I(n);function n(){var e;return(0,i.Z)(this,n),(e=t.call(this)).element.style.width="calc(96% - 6px)",e.element.style.maxWidth="364px",e.element.style.margin="",e.element.style.fontSize="12px",e.element.style.position="fixed",e.element.style.overflow="scroll",(0,v.q)(e.element),e}return(0,o.Z)(n,[{key:"createFormInput",value:function(e,t,i,o){var s=(0,r.Z)((0,l.Z)(n.prototype),"createFormInput",this).call(this,e,t,i,o);return s.style.fontFamily="'UbuntuRegular', Arial, Helvetica, sans-serif",s.style.fontSize="16px",s}},{key:"repositionChildren",value:function(){var e=Math.max(document.documentElement.clientWidth,window.innerWidth),t=Math.max(document.documentElement.clientHeight,window.innerHeight),n=(e-this.loginContainer.offsetWidth)/2,i=Math.max(50,(t-this.loginContainer.offsetHeight)/2),o=(0,g.gr)(),r=!o&&t<576;this.element.style.left="".concat(n,"px"),this.element.style.top=r?"0px":"".concat(i,"px"),this.element.style.bottom=r?"0px":"",(document.activeElement===this.usernameInput||document.activeElement===this.passwordInput)&&!o&&window.setTimeout((function(){var e;null===(e=document.activeElement)||void 0===e||e.scrollIntoView()}),510)}}]),n}(D);function Z(e){!function(e){void 0===e.fromFeature&&(e.fromFeature=e.fromFeature),void 0===e.seeBackground&&(e.seeBackground=e.seeBackground),void 0===e.returnToPage&&(e.returnToPage=e.returnToPage),void 0===e.refreshOpener&&(e.refreshOpener=e.refreshOpener)}(e),S.J.current.isMobile?(void 0===O&&(O=new U,(0,b.fg)("LoginOverlayOpened")),O.initAndShow(e)):(void 0===L&&(L=new D,(0,b.fg)("LoginOverlayOpened")),L.initAndShow(e))}function F(){void 0!==L&&L.hide()}function _(){return void 0!==L&&L.isVisible}},7386:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var i=n(2800);function o(){var e,t;return null!==(e=null===(t=i.J.current)||void 0===t?void 0:t.current_logo)&&void 0!==e?e:"".concat(STATIC_URL_ROOT,"images/logo.svg")}},6132:function(e,t,n){"use strict";n.d(t,{fb:function(){return w},pw:function(){return b},s6:function(){return x},sP:function(){return g},x5:function(){return y}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(7693),u=n(1522),d=n(1794),h=n(3705),f=n(7108),p=n(3543),m=n(1185),v=n(2800);function g(){var e=document.createElement("div");return(0,m.vP)(e,"title"),e.innerText=p.ag.followerBrowserNotifications,e.style.fontFamily="UbuntuBold, Helvetica, Arial, sans-serif",e}function y(){var e=document.createElement("div");return e.innerText=p.ag.allowBrowserNotificationsMessage,e.style.margin="5px 0 10px",e.style.fontSize="11px",e}function b(e){var t=document.createElement("div");return(0,m.vP)(t,"confirmButton"),t.innerText=p.ag.yesText,t.style.display="inline-block",t.style.padding="5px 30px",t.style.marginLeft="10px",t.style.borderRadius="3px",t.style.cursor="pointer",(0,c.j9)("click",t,e),t}function w(e){var t=document.createElement("div");return(0,m.vP)(t,"denyButton"),t.innerText=p.ag.notNowText,t.style.display="inline-block",t.style.padding="5px 18px",t.style.cursor="pointer",(0,c.j9)("click",t,e),t}var C={numTimeoutsKey:"numPushNotificationTimeouts",timeoutDateKey:"pushNotificationTimeout"},x=function(e){(0,s.Z)(m,e);var t,n,f=(t=m,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function m(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,i.Z)(this,m),(e=f.call(this,t)).closed=new d.xB("closed"),n){e.skipOverlay=!0;var o=function(t){t.target!==e.element&&e.element.contains(t.target)||e.close()};return(0,c.j9)("click",document,o),e.closed.once((function(){try{(0,c.SC)("click",document,o)}catch(e){debug("NotificationsModal listener was already removed")}})),(0,a.Z)(e)}return e.overlayClick.listen((function(){e.close()})),e}return(0,o.Z)(m,[{key:"initData",value:function(e){(0,r.Z)((0,l.Z)(m.prototype),"initData",this).call(this),this.numTimeoutsLocalStorageKey=e.numTimeoutsKey,this.timeoutDateLocalStorageKey=e.timeoutDateKey;var t=window.localStorage.getItem(this.numTimeoutsLocalStorageKey),n=window.localStorage.getItem(this.timeoutDateLocalStorageKey);null!==t&&null!==n?(this.timeoutDate=new Date(n),this.numTimeouts=parseInt(t)+1):(this.timeoutDate=new Date,this.numTimeouts=1)}},{key:"afterDOMConstructedIncludingChildren",value:function(){(0,r.Z)((0,l.Z)(m.prototype),"afterDOMConstructedIncludingChildren",this).call(this),this.skipOverlay||this.showOverlay()}},{key:"canRequestPermission",value:function(){return new Date>=this.timeoutDate}},{key:"close",value:function(){this.element.style.display="none",this.skipOverlay||this.hideOverlay(),this.closed.fire(void 0)}},{key:"subscribeToBrowserPush",value:function(e,t){var n=window.subscribeUserToPush;void 0!==v.J.current.loggedInUser&&n(v.J.current.loggedInUser.signedUsername).then((function(){e(),(0,h.fg)("PushNotificationSettingsUpdated",{new_status:!0,old_status:!1,location:"notif-modal"})})).catch(t)}},{key:"onConfirmClick",value:function(){var e=this;this.subscribeToBrowserPush((function(){}),(function(t){void 0===t||400===t.status?(0,u.Cj)(p.ag.followSubscribeFailedMessage):(window.localStorage.removeItem(e.numTimeoutsLocalStorageKey),window.localStorage.removeItem(e.timeoutDateLocalStorageKey))}))}},{key:"onDenyClick",value:function(){var e=new Date,t=Math.min(Math.pow(2,this.numTimeouts),168);this.timeoutDate.setTime(e.getTime()+60*t*60*1e3),window.localStorage.setItem(this.numTimeoutsLocalStorageKey,this.numTimeouts.toString()),window.localStorage.setItem(this.timeoutDateLocalStorageKey,this.timeoutDate.toString())}}]),m}(f.B)},7376:function(e,t,n){"use strict";n.d(t,{$:function(){return o},G:function(){return r}});var i=n(5392);function o(e,t){var n=function(t){var n=document.createElement("div");return n.style.position="absolute",n.style.cursor=t,n.style.backgroundColor="rgba(0, 0, 0, 0.01)",e.appendChild(n),n},o=n("nwse-resize");o.style.height="10px",o.style.width="10px",o.style.top="-5px",o.style.left="-5px";var r=n("nesw-resize");r.style.height="10px",r.style.width="10px",r.style.top="-5px",r.style.right="-5px";var s=n("nwse-resize");s.style.height="10px",s.style.width="10px",s.style.bottom="-5px",s.style.right="-5px";var a=n("nesw-resize");a.style.height="10px",a.style.width="10px",a.style.bottom="-5px",a.style.left="-5px";var l=n("ew-resize");l.style.height="calc(100% - 10px)",l.style.width="10px",l.style.top="5px",l.style.left="-5px";var c=n("ew-resize");c.style.height="calc(100% - 10px)",c.style.width="10px",c.style.top="5px",c.style.right="-5px";var u=n("ns-resize");u.style.height="10px",u.style.width="calc(100% - 10px)",u.style.left="5px",u.style.bottom="-5px";var d=n("ns-resize");d.style.height="5px",d.style.width="calc(100% - 10px)",d.style.left="5px",d.style.top="-5px",(0,i.T)(s,t(2)),(0,i.T)(a,t(3)),(0,i.T)(r,t(1)),(0,i.T)(o,t(0)),(0,i.T)(l,t(4)),(0,i.T)(c,t(5)),(0,i.T)(u,t(6)),(0,i.T)(d,t(7))}function r(e,t,n,i){var o=function(e,t,n,i){switch(i){case 0:return e.ratio*(e.initialX-t+(e.initialY-n));case 1:return e.ratio*(-(e.initialX-t)+(e.initialY-n));case 2:return e.ratio*(-(e.initialX-t)-(e.initialY-n));case 3:return e.ratio*(e.initialX-t-(e.initialY-n));case 4:return e.initialX-t;case 5:return-(e.initialX-t);case 6:return-(e.initialY-n)/e.ratio;case 7:return(e.initialY-n)/e.ratio}}(e,t,n,i),r=Math.min(Math.max(e.minWidth,e.initialWidth+o),.66*window.innerWidth),s=e.initialWidth-r,a=e.initialBottom,l=e.initialRight;switch(i){case 1:l=e.initialRight+s;break;case 2:l=e.initialRight+s,a=e.initialBottom+s*e.ratio;break;case 3:a=e.initialBottom+s*e.ratio;break;case 4:a=e.initialBottom+s*e.ratio/2;break;case 5:l=e.initialRight+s,a=e.initialBottom+s*e.ratio/2;break;case 6:l=e.initialRight+s/2,a=e.initialBottom+s*e.ratio;break;case 7:l=e.initialRight+s/2}return{bottom:a,right:l,width:r}}},9760:function(e,t,n){"use strict";n.d(t,{FR:function(){return y},nR:function(){return v},os:function(){return b}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(8759),u=n(7693),d=n(8069),h=n(9),f=n(8263),p=n(1794),m=n(3607);var v=new(function(e){(0,s.Z)(u,e);var t,n,c=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function u(){return(0,i.Z)(this,u),c.apply(this,arguments)}return(0,o.Z)(u,[{key:"listen",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(0,r.Z)((0,l.Z)(u.prototype),"listen",this).call(this,e,t);return g.callFunc(),n}},{key:"addListener",value:function(e,t){(0,r.Z)((0,l.Z)(u.prototype),"addListener",this).call(this,e,t),g.callFunc()}}]),u}(p.xB))("resizeDebounceEvent"),g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:80,n=new d.d((function(){e(!0)}),{bounceLimitMS:t,debounceType:2}),i=new d.d((function(){e(!1)}),{bounceLimitMS:200,debounceType:1});return(0,u.j9)("resize",window,(function(){n.callFunc(),i.callFunc()})),(0,u.j9)("orientationchange",window,(function(){e(!1),window.setTimeout((function(){e(!1)}),80)})),i}((function(){v.fire(!1)}));function y(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:500,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1003,s=arguments.length>6?arguments[6]:void 0,a=function(){var a=n instanceof Function?n():n,l=a+((i instanceof Function?i():i)-a)*(Math.max(Math.min(document.body.clientWidth,r),o)-o)/(r-o),c=e instanceof h.w?e.element:e;t instanceof Array?t.forEach((function(e){c.style[e]="".concat(l,"px")})):c.style[t]="".concat(l,"px"),e instanceof h.w&&e.repositionChildrenRecursive(),void 0!==s&&s(l)};return v.addListener(a,e),window.setTimeout((function(){a()})),a}function b(e){var t=new p.xB("width-less-than".concat(e)),n=!1;return v.listen((function(){(0,m._U)()<e?n||(n=!0,t.fire(!0)):n&&(n=!1,t.fire(!1))})),t}if((0,c._1)()&&(0,c.G6)()){var w=document.createElement("div");(0,f.Zs)(w,{position:"absolute",width:"100%"}),document.body.appendChild(w);var C=w.offsetWidth;window.setInterval((function(){C!==w.offsetWidth&&(v.fire(!0),C=w.offsetWidth)}),150)}},2358:function(e,t,n){"use strict";n.d(t,{Jq:function(){return f},_V:function(){return p},li:function(){return d},u7:function(){return h}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(7693),u=n(8069);function d(e,t){var n=new u.l(t);return(0,c.j9)("scroll",e,(function(){n.callFunc()})),n}var h=function(e){(0,s.Z)(u,e);var t,n,c=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function u(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0;return(0,i.Z)(this,u),(t=c.call(this,"scrollEndDebounceEvent",o)).listenerObj=e,t.scrollOrientation=n,t.lastScroll=t.getCurrentScroll(),t}return(0,o.Z)(u,[{key:"element",get:function(){return this.listenerObj instanceof Document?this.listenerObj.documentElement:this.listenerObj}},{key:"getCurrentScroll",value:function(){return 0===this.scrollOrientation?this.element.scrollTop:this.element.scrollLeft}},{key:"listen",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(0,r.Z)((0,l.Z)(u.prototype),"listen",this).call(this,e,t);return this.registerDebouncer(),n}},{key:"addListener",value:function(e,t){(0,r.Z)((0,l.Z)(u.prototype),"addListener",this).call(this,e,t),this.registerDebouncer()}},{key:"registerDebouncer",value:function(){var e=this;d(this.listenerObj,(function(t){var n=e.getCurrentScroll();e.fire({isStart:t,scrollDirection:n>e.lastScroll?1:0}),e.lastScroll=n}))}}]),u}(n(1794).xB);function f(e,t,n){var i,o=e.scrollLeft,r=n;window.requestAnimationFrame((function n(s){var a=s-(i=void 0===i?s:i);e.scrollLeft=o<t?o+(t-o)*a/r:o-(o-t)*a/r,a<r?window.requestAnimationFrame(n):e.scrollLeft=t}))}function p(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,i=new u.d(t,{bounceLimitMS:n,debounceType:2});return(0,c.j9)("scroll",e,(function(){i.callFunc()})),i}},4493:function(e,t,n){"use strict";n.d(t,{KI:function(){return $},Ze:function(){return G}});var i=n(7791),o=n(2951),r=n(1976),s=n(7591),a=n(9492),l=n(7597),c=n(824),u=n.n(c),d=n(8759),h=n(3753),f=n(391),p=n(695),m=n(9),v=n(8263),g=n(6921),y=n(9165),b=n(3705),w=n(1185),C=n(9076),x=n(7585),k=n(1794),S=n(47),T=n(2800),I=n(7642),R=n(9395);var P=new k.xB("SuggestionClicked"),M={fontSize:"9px",position:"relative",width:"105px"},A={display:"inline-block",position:"relative",top:"6px",height:"18px",padding:"5px 10px",width:"18px"},E={display:"inline-block",margin:"0px",position:"relative"},B={borderBottomStyle:"solid",borderBottomWidth:"1px",cursor:"pointer",height:"42px",position:"relative"},L={textDecoration:"none"},O={display:"inline-block",position:"absolute",top:"6px",height:"35px",width:(0,d.s2)()?"calc(100% - 38px)":"180px"},D={font:"12px UbuntuBold, Arial, Helvetica, sans-serif",marginRight:"0px"},U={font:"12px UbuntuRegular, Arial, Helvetica, sans-serif",marginRight:"0px"},Z=function(e){(0,s.Z)(c,e);var t,n,i=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function c(){return(0,o.Z)(this,c),i.apply(this,arguments)}return(0,r.Z)(c,[{key:"getIconClassName",value:function(){return""}},{key:"getStatusText",value:function(){return""}},{key:"getRowClassName",value:function(){return""}},{key:"createLabelElements",value:function(e){var t=e.input;t=e.labelText.startsWith("#")?t.replace(/%23/g,"#"):t.replace(/#/g,"");var n=e.labelText.toLowerCase().indexOf(t.toLowerCase()),i=n>=0?e.labelText.slice(n,n+t.length):e.labelText,o=n>0?e.labelText.slice(0,n):"",r=n+t.length<e.labelText.length&&n>=0?e.labelText.slice(n+t.length):"";return[(0,S.vz)("span",{style:D},o),(0,S.vz)("span",{style:U},i),(0,S.vz)("span",{style:D},r),(0,S.vz)("div",{className:"statusText",style:M},this.getStatusText())]}},{key:"createElement",value:function(e){var t=this;return(0,S.vz)("a",{style:L,href:e.href,tabIndex:-1,onKeyDown:function(n){(0,g.r$)(n)&&t.onClickHandler(e)},onContextMenu:function(e){return!(0,d.s2)()&&!T.J.current.isMobile||(e.preventDefault(),!1)},onBlur:function(e){R.K_.fire(e)},onClick:function(n){""===e.href&&n.preventDefault(),t.onClickHandler(e,n)}},(0,S.vz)("div",{className:this.getRowClassName(),style:B},(0,S.vz)("div",{className:this.getIconClassName(),style:A}),(0,S.vz)("div",{style:O},(0,S.vz)("p",{className:this.getRowClassName(),style:E},this.createLabelElements(e)))))}},{key:"onClickHandler",value:function(e,t){(0,I.BM)(e.labelText,"online");var n={resultType:"broadcaster",resultString:e.labelText};(0,b.fg)("SearchBarResultsClick",n)}}]),c}(x.I),F=n(8871);var _=function(e){(0,s.Z)(c,e);var t,n,i=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function c(){return(0,o.Z)(this,c),i.apply(this,arguments)}return(0,r.Z)(c,[{key:"getIconClassName",value:function(){return"icon-hashtag"}},{key:"getStatusText",value:function(){return""}},{key:"getRowClassName",value:function(){return"hashtag_suggestion"}},{key:"onClickHandler",value:function(e,t){var n="#".concat(e.labelText);(0,I.BM)(n,"hashtags");var i={resultType:"hashtag",resultString:n};(0,b.fg)("SearchBarResultsClick",i),void 0!==t&&F.k4.fire(t)}}]),c}(Z),N=n(3243),j=n(3543);var H=new k.xB("historyDeleteClicked"),z={width:"23px",height:"23px",display:"block",position:"absolute",top:"20%",left:"unset",right:"2px",backgroundPosition:"50% top",backgroundSize:"14px 14px"},W=function(e){(0,s.Z)(c,e);var t,n,i=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function c(){return(0,o.Z)(this,c),i.apply(this,arguments)}return(0,r.Z)(c,[{key:"getIconClassName",value:function(){return"icon-history"}},{key:"getStatusText",value:function(){return j.ag.previouslySearched}},{key:"getRowClassName",value:function(){return"history_suggestion"}},{key:"onClickHandler",value:function(e,t){var n={resultType:"history",resultString:e.labelText};(0,b.fg)("SearchBarResultsClick",n),e.href.includes("/tag/")?((0,I.BM)(e.labelText,"hashtags"),void 0!==t&&F.k4.fire(t)):""!==e.href?(0,I.BM)(e.labelText,"online"):P.fire(e.labelText)}},{key:"createElement",value:function(e){var t=(0,N.Z)((0,l.Z)(c.prototype),"createElement",this).call(this,e),n=(0,d.s2)()?z:{},i=(0,S.vz)("div",{style:n,className:"historyDelete",onClick:function(e){e.preventDefault(),e.stopPropagation()},onMouseDown:function(t){t.ctrlKey||t.metaKey||2===t.button||((0,I.Mi)(e.labelText),H.fire(e.labelText),t.preventDefault(),t.stopPropagation())}}),o=t.firstElementChild;if(null!==o){var r=o.lastElementChild;null!==r&&r.appendChild(i)}return this.isFloatingNavAllowed(e)&&t.setAttribute("data-floatingnav",""),t}},{key:"isFloatingNavAllowed",value:function(e){return!(""!==e.href&&!e.href.includes("/tag/"))}}]),c}(Z);var V=function(e){(0,s.Z)(c,e);var t,n,i=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function c(){return(0,o.Z)(this,c),i.apply(this,arguments)}return(0,r.Z)(c,[{key:"getIconClassName",value:function(){return"icon-offline"}},{key:"getStatusText",value:function(){return j.ag.recentlyOnline}},{key:"getRowClassName",value:function(){return"broadcaster_suggestion"}}]),c}(Z);var q=function(e){(0,s.Z)(c,e);var t,n,i=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function c(){return(0,o.Z)(this,c),i.apply(this,arguments)}return(0,r.Z)(c,[{key:"getIconClassName",value:function(){return"icon-online"}},{key:"getStatusText",value:function(){return j.ag.broadcastingNow}},{key:"getRowClassName",value:function(){return"broadcaster_suggestion"}}]),c}(Z);function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var J=["hashtags","online","offline"],G="Tab",Y={borderWidth:"1px",borderStyle:"solid",height:"",display:"none",font:"12px UbuntuBold, Arial, Helvetica, sans-serif",overflow:"",position:"absolute",right:"0px",top:"25px",width:"227px"},$=function(e){(0,s.Z)(x,e);var t,n,c,m=(n=x,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,l.Z)(n);if(c){var i=(0,l.Z)(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return(0,a.Z)(this,e)});function x(e,t){var n;return(0,o.Z)(this,x),(n=m.call(this)).currentIndex=-1,n.highestIndex=-1,n.keyNavigated=!1,n.pauseSuggestions=!1,n.timeoutId=0,n.input=e,n.searchInput=t,n.suggestionsList=[],n.gender=(0,y.ej)(),R.Mj.onSubmit.listen((function(){n.lastSearch=void 0})),P.listen((function(e){null!==e&&(n.input.element.value=e,n.searchInput.onSubmitSearchInput())})),H.listen((function(e){var t=n.suggestionsList.findIndex((function(t){return t.label===e}));n.suggestionsList[t].element.remove(),n.suggestionsList.splice(t,1),n.highestIndex=n.suggestionsList.length-1,n.showSuggestions(),n.input.element.focus(),n.input.element.select()})),(0,w.vP)(n.element,"suggestionsDiv"),n}return(0,r.Z)(x,[{key:"initUI",value:function(){(0,v.Zs)(this.element,Y)}},{key:"styleActiveSuggestion",value:function(e){(0,w.vP)(e,"active")}},{key:"styleInactiveSuggestion",value:function(e){(0,w.FU)(e,"active")}},{key:"removeExistingSuggestions",value:function(){for(this.suggestionsList=[],this.highestIndex=-1;null!==this.element.lastChild;)this.element.removeChild(this.element.lastChild);this.hideElement()}},{key:"createSuggestion",value:function(e,t,n,i,o){var r,s=this,a="/".concat(e,"/");switch(this.gender=(0,y.ej)(),n){case"online":r=new q({labelText:e,input:t,count:i,href:a}).element;break;case"offline":r=new V({labelText:e,input:t,count:i,href:a}).element;break;case"hashtags":a=(0,C.WX)(e,this.gender),r=new _({labelText:e,input:t,count:i,href:a}).element;break;default:"hashtags"===o?a=(0,C.WX)(e.replace("#",""),this.gender):"history"===o&&(a=""),r=new W({labelText:e,input:t,count:i,href:a}).element}this.element.appendChild(r);var l=r.firstElementChild;l.onmouseenter=function(){s.styleInactiveLastSug(),s.styleActiveSuggestion(l);var e=r.getAttribute("index");null!==e&&(s.currentIndex=parseInt(e,10)),s.keyNavigated=!1},l.onmouseleave=function(){s.styleInactiveLastSug(),s.styleInactiveSuggestion(l),s.currentIndex=-1,s.keyNavigated=!1},this.suggestionsList.push({label:e,element:l})}},{key:"navigateSuggestions",value:function(e){if(this.suggestionsList.length>0){this.saveFirstText(),this.keyNavigated=!0;var t=this.currentIndex;t>-1&&this.styleInactiveSuggestion(this.suggestionsList[t].element),this.tabThroughSuggestions(e),(0,g.aZ)(e)?this.currentIndex=this.currentIndex+1<=this.highestIndex?this.currentIndex+1:0:(0,g.si)(e)&&(this.currentIndex=this.currentIndex-1>=0?this.currentIndex-1:this.highestIndex,e.preventDefault());var n=this.suggestionsList[this.currentIndex];void 0!==n&&(this.replaceInputValue(n),this.styleActiveSuggestion(n.element)),this.styleAllInactiveSuggestions()}}},{key:"replaceInputValue",value:function(e){var t,n=null!==(t=e.element.getAttribute("class"))&&void 0!==t?t:"";void 0!==n&&(this.input.element.value=n.includes("hashtag_suggestion")?"#".concat(e.label):e.label)}},{key:"tabThroughSuggestions",value:function(e){if(e.key===G)if(this.currentIndex>-1&&this.currentIndex<=this.highestIndex){if(e.shiftKey){if(0===this.currentIndex)return this.resetSuggestionsNavigation(),void(this.input.element.value=this.firstText);this.currentIndex=this.currentIndex-1}else{if(this.currentIndex===this.highestIndex)return this.resetSuggestionsNavigation(),void(this.input.element.value=this.firstText);this.currentIndex=this.currentIndex+1}e.preventDefault()}else-1!==this.currentIndex||e.shiftKey||(this.currentIndex=0,e.preventDefault())}},{key:"saveFirstText",value:function(){this.keyNavigated||(this.firstText=this.input.element.value)}},{key:"getSuggestionsAfterTime",value:function(e){var t=this;if(this.pauseSuggestions)""===this.input.element.value&&this.removeExistingSuggestions();else{0!==this.timeoutId&&window.clearTimeout(this.timeoutId);var n=this.input.element.value.trim().replace(/^#/,"%23"),i=n.split(" "),o=function(e){return e.some((function(e){return e.length>30}))||e.length>6||n.length>60},r=(0,y.ej)();n===this.lastSearch&&this.gender===r||o(i)?(o(i)&&this.showHistorySuggestions(n),e?this.showSuggestions():this.hideSuggestions()):this.timeoutId=window.setTimeout((function(){t.suggestionPromise=t.getSuggestions(e)}),250)}}},{key:"styleAllInactiveSuggestions",value:function(){var e,t=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(this.suggestionsList);try{for(t.s();!(e=t.n()).done;){var n=e.value;n!==this.suggestionsList[this.currentIndex]&&this.styleInactiveSuggestion(n.element)}}catch(e){t.e(e)}finally{t.f()}}},{key:"getSuggestions",value:(t=(0,i.Z)(u().mark((function e(t){var n,i,o=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.input.element.value,i=n.trim().replace(/^#/,"%23"),this.timeoutId=0,""!==n){e.next=8;break}return this.lastSearch=void 0,this.showHistorySuggestions(n),this.showSuggestions(),e.abrupt("return");case 8:return e.next=10,(0,h.Ue)("ax/search/?keywords=".concat(i)).then((function(e){if(o.input.element.value===n){o.lastSearch=i,o.showHistorySuggestions(i);var r=o.suggestionsList.length,s=new f.j(e.responseText);J.forEach((function(e){var t=s.getAny(e);void 0!==t&&Object.keys(t).forEach((function(i){if(!(r>=10)){var s=t[i];o.createSuggestion(s,n,e,r),o.highestIndex=r,r+=1}}))})),o.preventShow?o.preventShow=!1:t?o.showSuggestions():o.hideSuggestions()}})).catch((function(e){o.pauseSuggestions=!0,window.setTimeout((function(){o.pauseSuggestions=!1}),6e4),(0,b.fg)("TooManySearchAutocompleteError"),warn("Too many autocomplete queries, wait before resuming",e)}));case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"showHistorySuggestions",value:function(e){this.removeExistingSuggestions(),this.createHistorySuggestions(e),this.highestIndex=this.suggestionsList.length-1}},{key:"createHistorySuggestions",value:function(e){var t=this;if((0,d.IU)()){(0,I.eK)();var n=0;if(!(0,p.TF)()){var i=window.localStorage.getItem((0,I.HQ)());null!==i&&JSON.parse(i).forEach((function(i){void 0!==i.content&&i.content.includes(e.replace(/%23/g,"#").toLowerCase())&&(n+=1,t.createSuggestion(i.content,e,"history",n,i.type))}))}}}},{key:"hideSuggestions",value:function(){var e=this;this.styleInactiveLastSug(),this.hideElement(),this.resetSuggestionsNavigation(),window.setTimeout((function(){document.activeElement instanceof HTMLElement&&e.element.contains(document.activeElement)&&document.activeElement.blur()}))}},{key:"getCurrentNavigatedSuggestion",value:function(){return this.suggestionsList[this.currentIndex]}},{key:"isSuggestionsNavigated",value:function(){return this.keyNavigated&&this.currentIndex>-1&&this.suggestionsList.length>this.currentIndex}},{key:"resetSuggestionsNavigation",value:function(){this.currentIndex=-1,this.keyNavigated=!1}},{key:"styleInactiveLastSug",value:function(){this.currentIndex>-1&&this.suggestionsList.length>this.currentIndex&&this.styleInactiveSuggestion(this.suggestionsList[this.currentIndex].element)}},{key:"preventShowOnGetSuggestions",value:function(e){this.preventShow=e}},{key:"showSuggestions",value:function(){this.suggestionsList.length&&document.activeElement===this.input.element?this.showElement():this.hideElement()}}]),x}(m.w)},7642:function(e,t,n){"use strict";n.d(t,{BM:function(){return u},HQ:function(){return c},Mi:function(){return d},eK:function(){return h}});var i=n(8759),o=n(2800);function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var a="searchHistory",l=5;function c(){return void 0!==o.J.current.loggedInUser?"".concat(a,":").concat(o.J.current.loggedInUser.username):""}function u(e,t){if((0,i.IU)()&&void 0!==o.J.current.loggedInUser&&""!==e){var n=e.toLowerCase().trim(),s=window.localStorage.getItem(c()),a={content:n,type:t},u=JSON.stringify([a]);if(null!==s){var d,h=JSON.parse(s),f=0,p=r(h);try{for(p.s();!(d=p.n()).done;){if(d.value.content===n){h.splice(f,1);break}f+=1}}catch(e){p.e(e)}finally{p.f()}h.unshift(a),h.length>l&&h.pop(),u=JSON.stringify(h)}window.localStorage.setItem(c(),u)}}function d(e){if((0,i.IU)()){var t=window.localStorage.getItem(c());if(null!==t){var n=null!==t?JSON.parse(t):[];n.splice(n.findIndex((function(t){return t.content===e})),1);var o=JSON.stringify(n);window.localStorage.setItem(c(),o)}}}function h(){var e=window.localStorage.getItem(c());if(null!==e)try{var t,n=r(JSON.parse(e));try{for(n.s();!(t=n.n()).done;){var i=t.value;if(void 0===i.content||void 0===i.type)return void window.localStorage.removeItem(c())}}catch(e){n.e(e)}finally{n.f()}}catch(t){return warn("Failed to parse and iterate search history, clearing",{searchHistory:e}),void window.localStorage.removeItem(c())}}},9395:function(e,t,n){"use strict";n.d(t,{K_:function(){return I},Mj:function(){return R}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(8759),c=n(3753),u=n(9),d=n(8263),h=n(1794),f=n(6921),p=n(3543),m=n(1289),v=n(1185),g=n(3515),y=n(2800),b=n(6698),w=n(4493),C=n(7642);function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var k={display:"inline-block",position:"relative"},S={position:"relative",overflow:"",width:"",height:""},T={height:"",width:"",overflow:"",position:"relative",borderRadius:"3px",borderStyle:"solid",borderWidth:"1px",display:"inline-block",paddingRight:"23px",marginTop:"3px",right:"0px"},I=new h.xB("SearchBlur"),R=function(e){(0,r.Z)(x,e);var t,n,h=(t=x,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function x(){var e,t;return(0,i.Z)(this,x),(t=h.call(this)).searchKeywords="",t.pushSearches=!1,t.element.id="SearchInput",(0,d.Zs)(t.element,k),t.form=new u.w("form"),t.form.element.method="GET",t.form.element.action=(0,c.BN)("/"),t.form.element.id="filter_search_form",t.input=new u.w("input"),t.input.element.name="keywords",t.input.element.className="search_input",t.input.element.type="text",t.input.element.placeholder="".concat(p.ag.searchBarPlaceholder),t.input.element.maxLength=150,t.input.element.autocomplete="off",t.input.element.id="keywords",t.searchKeywords=P(null!==(e=new URLSearchParams(window.location.search).get("keywords"))&&void 0!==e?e:""),(0,m.Vf)(new Map([["keywords",t.searchKeywords]])),g.x.fire(t.searchKeywords),t.input.element.value=t.searchKeywords,(0,d.Zs)(t.input.element,T),t.delete=new u.w,(0,v.vP)(t.delete.element,"inputDelete"),t.form.addChild(t.input),(0,d.Zs)(t.form.element,S),t.addChild(t.form),t.form.addChild(t.delete),(0,d.Zs)(t.delete.element,{visibility:""!==t.input.element.value?"visible":"hidden"}),t.input.element.oninput=function(){t.suggestionsDiv.getSuggestionsAfterTime(!0),t.styleInputDelete()},I.listen((function(e){t.isFocusInsideSearch(e)||window.setTimeout((function(){t.onInputBlur()}),250)})),t.input.element.onkeydown=function(e){(0,f.r$)(e)?(e.preventDefault(),t.suggestionsDiv.styleInactiveLastSug(),t.suggestionsDiv.isSuggestionsNavigated()?t.suggestionsDiv.getCurrentNavigatedSuggestion().element.click():t.onSubmitSearchInput()):"ArrowDown"===e.key||"ArrowUp"===e.key||e.key===w.Ze?t.suggestionsDiv.navigateSuggestions(e):e.shiftKey||e.key===w.Ze||(t.suggestionsDiv.styleInactiveLastSug(),t.suggestionsDiv.resetSuggestionsNavigation()),t.styleInputDelete()},t.input.element.onfocus=function(e){t.isFocusInsideSearch(e)&&t.onInputFocus()},t.input.element.onblur=function(e){I.fire(e)},t.delete.element.onmousedown=function(e){e.ctrlKey||e.metaKey||2===e.button||t.onInputDeleteClick(e)},t.initSuggestions(),t.form.addChild(t.suggestionsDiv),""!==t.input.element.value&&(t.suggestionsDiv.getSuggestionsAfterTime(!1),(0,C.BM)(t.input.element.value,"history")),t}return(0,o.Z)(x,[{key:"initSuggestions",value:function(){this.suggestionsDiv=new w.KI(this.input,this)}},{key:"onInputFocus",value:function(){this.styleInputDelete(),this.suggestionsDiv.getSuggestionsAfterTime(!0)}},{key:"onInputBlur",value:function(){this.suggestionsDiv.hideSuggestions()}},{key:"styleInputDelete",value:function(){""!==this.input.element.value?(0,d.Zs)(this.delete.element,{visibility:"visible"}):(0,d.Zs)(this.delete.element,{visibility:"hidden"})}},{key:"onInputDeleteClick",value:function(e){this.input.element.value="",this.styleInputDelete(),(0,l._1)()&&this.onInputFocus(),this.input.element.focus(),this.suggestionsDiv.getSuggestionsAfterTime(!0),e.preventDefault(),e.stopImmediatePropagation()}},{key:"showInputBar",value:function(){this.input.showElement(),this.delete.showElement()}},{key:"hideInputBar",value:function(){this.input.hideElement(),this.delete.hideElement(),this.suggestionsDiv.hideSuggestions()}},{key:"onSubmitSearchInput",value:function(){0===this.input.element.value.trim().length&&(this.input.element.value=""),this.searchKeywords=P(this.input.element.value);var e=window.location.pathname.includes("/tags/");e||(this.pushSearches?(0,m.Lm)(new Map([["keywords",this.searchKeywords]])):(0,m.Vf)(new Map([["keywords",this.searchKeywords]]))),this.input.element.blur();var t=window.location.pathname.includes("/discover/")||e;0===this.searchKeywords.length&&t?this.input.element.value="":(this.styleInputDelete(),this.suggestionsDiv.hideSuggestions(),(0,C.BM)(this.searchKeywords,"history"),this.completeSearch())}},{key:"completeSearch",value:function(){var e=this;x.onSubmit.fire(this.searchKeywords),this.suggestionsDiv.preventShowOnGetSuggestions(!0),window.setTimeout((function(){e.suggestionsDiv.preventShowOnGetSuggestions(!1)}),400),b.Bb.getInstance().loadRooms((function(){e.input.element.value=e.searchKeywords,""===e.input.element.value&&(y.J.current.isMobile?e.styleInputDelete():e.hideInputBar()),g.x.fire(e.searchKeywords)}))}},{key:"isFocusInsideSearch",value:function(e){return this.element.contains(document.activeElement)||this.input.element===document.activeElement||e.relatedTarget instanceof Node&&this.element.contains(e.relatedTarget)}}]),x}(u.w);function P(e){var t=[],n=new RegExp(/[a-zA-Z0-9_#\s]+/g),i=e.match(n),o=!1;if(null!==i){var r,s=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(i.join("").split(" ").filter((function(e){return e.length>0})));try{for(s.s();!(r=s.n()).done;){var a=r.value,l=a.startsWith("#")?"#":"",c=a.replace(/#/g,""),u=c.length>0?"".concat(l).concat(c):"";t.push(u),c.length>=2&&(o=!0)}}catch(e){s.e(e)}finally{s.f()}}return o?t.join(" ").trim():""}R.onSubmit=new h.xB("onSubmit")},6208:function(e,t,n){"use strict";n.d(t,{I:function(){return l},L:function(){return a}});var i=n(4649),o=n(47);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e){var t=s({width:"30px",height:"31px",background:'url("'.concat(STATIC_URL_ROOT,'images/loading_spinner.svg")'),backgroundSize:"cover",animationName:"spin",animationDuration:"2s",animationTimingFunction:"linear",animationIterationCount:"infinite"},e.extraStyle);return(0,o.vz)("div",{style:t})}function l(e){var t=s({display:!0===e.startHidden?"none":"block",width:"100%",height:"100%",position:"absolute"},e.extraStyle);return(0,o.vz)("div",{style:t,ref:e.myRef},(0,o.vz)(a,{extraStyle:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"-15px 0 0 -15px"}}))}},4028:function(e,t,n){"use strict";n.d(t,{i:function(){return p}});var i=n(1976),o=n(2951),r=n(7591),s=n(9492),a=n(7597),l=n(9),c=n(9165),u=n(3543),d=n(47);var h={marginLeft:"8px",verticalAlign:"middle",fontSize:"14px"},f={marginLeft:"10px",fontSize:"14px"},p=function(e){(0,r.Z)(p,e);var t,n,l=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function p(){var e;return(0,o.Z)(this,p),(e=l.call(this)).element=(0,d.vz)("form",{className:"subgenderModal",style:{position:"relative"}},(0,d.vz)("p",{style:f},u.ag.subgenderSelectionHeader),(0,d.vz)("p",{style:f},u.ag.subgenderSelectionPrompt),(0,d.vz)("div",{style:{margin:"5px"}},(0,d.vz)("input",{type:"radio",name:"subgender",id:"subgender1",value:c.dW.Transfemme,checked:!0}),(0,d.vz)("label",{style:h,htmlFor:"subgender1"},u.ag.subgenderFemme)),(0,d.vz)("div",{style:{margin:"5px"}},(0,d.vz)("input",{type:"radio",name:"subgender",id:"subgender2",value:c.dW.Transmasc}),(0,d.vz)("label",{style:h,htmlFor:"subgender2"},u.ag.subgenderMasc)),(0,d.vz)("div",{style:{margin:"5px"}},(0,d.vz)("input",{type:"radio",name:"subgender",id:"subgender3",value:c.dW.Nonbinary}),(0,d.vz)("label",{style:h,htmlFor:"subgender3"},u.ag.subgenderNonbinary))),e}return(0,i.Z)(p)}(l.w)},6402:function(e,t,n){"use strict";n.d(t,{C:function(){return r},R:function(){return o}});var i=n(47);function o(){return(0,i.vz)("div",{style:{height:"1.2em",width:"1.2em",display:"inline-block",position:"relative"},colorClass:"followerStarSvg"},(0,i.vz)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"8 7 48 46"},(0,i.vz)("g",{transform:"translate(0,-952.36218)"},(0,i.vz)("path",{d:"M32,959.4l8,14.3l16,3.2L44.9,989l1.9,16.3L32,998.4l-14.8,6.9l1.9-16.3L8,976.9l16-3.2L32,959.4z"}))))}function r(){return(0,i.vz)("div",{style:{height:"1.2em",width:"1.2em",display:"inline-block",position:"relative"},colorClass:"grayFollowerStarSvg"},(0,i.vz)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"8 7 48 46"},(0,i.vz)("g",{transform:"translate(0,-952.36218)"},(0,i.vz)("path",{d:"M32,959.4l8,14.3l16,3.2L44.9,989l1.9,16.3L32,998.4l-14.8,6.9l1.9-16.3L8,976.9l16-3.2L32,959.4z"}))))}},4484:function(e,t,n){"use strict";n.d(t,{Le:function(){return x},NQ:function(){return k},et:function(){return S}});var i=n(4649),o=n(2951),r=n(1976),s=n(7169),a=n(7591),l=n(9492),c=n(3243),u=n(7597),d=n(7693),h=n(9),f=n(8263),p=n(1185),m=n(5696),v=n(6640);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,u.Z)(e);if(t){var o=(0,u.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var x=function(e){(0,a.Z)(n,e);var t=C(n);function n(){var e,i;return(0,o.Z)(this,n),(i=t.call(this)).tabHandleStyle={position:"relative",padding:"5px",margin:"2px 0 0 2px",borderRadius:"4px 4px 0 0",minWidth:"16px",width:"auto",height:"100%",fontSize:"10px",cursor:"pointer",cssFloat:"left",textSizeAdjust:"none",WebkitTextSizeAdjust:"none",userSelect:"none"},i.tabHandleActiveStyle={cursor:"default"},(0,p.vP)(i.element,"BaseTabsContainer"),i.tabHandlesRow=new v.i,i.tabHandlesRow.element.id="tab-row",i.tabHandlesRow.element.style.overflow="hidden",i.tabHandlesRow.element.style.width="100%",i.tabHandlesRow.element.style.borderRadius="2px 2px 0 0",(0,c.Z)((e=(0,s.Z)(i),(0,u.Z)(n.prototype)),"addChild",e).call(e,i.tabHandlesRow),i.window=document.createElement("div"),i.window.style.width="100%",i.window.style.position="absolute",(0,p.vP)(i.window,"window"),i.element.appendChild(i.window),i}return(0,r.Z)(n,[{key:"addFooter",value:function(e){this.element.appendChild(e)}},{key:"getTabRow",value:function(){return this.tabHandlesRow}},{key:"repositionChildren",value:function(){var e=this.element.clientHeight-this.tabHandlesRow.element.offsetHeight;this.window.style.height="".concat(e,"px")}},{key:"addChild",value:function(e){throw new Error("addChild not implemented")}},{key:"addTab",value:function(e){return e.element.style.width="100%",e.element.style.height="100%",e.element.style.display="none",(0,c.Z)((0,u.Z)(n.prototype),"addChild",this).call(this,e,this.window),this.attachTabToDOM(e),e}},{key:"attachTabToDOM",value:function(e){var t=e.constructTabHandle();return this.tabHandlesRow.addChild(t),e.adjustTab(),(0,p.vP)(t,"tab"),(0,p.vP)(t,p.ql.chatAreaTabColor),t}},{key:"children",value:function(){return(0,c.Z)((0,u.Z)(n.prototype),"children",this).call(this).filter((function(e){return e instanceof k}))}},{key:"changeToTab",value:function(e){e!==this.currentTab&&(this.currentTab=e,e.setAsCurrentTab()),this.showCurrentTab()}},{key:"changeToFirstTab",value:function(){this.changeToTab(this.children()[0])}},{key:"getCurrentTab",value:function(){return this.currentTab}},{key:"showCurrentTab",value:function(){for(var e=this.children(),t=e.length-1;t>=0;t-=1){var n=e[t];n!==this.currentTab?n.hideElement():this.currentTab.active||n.showElement()}this.repositionChildrenRecursive(),this.afterDOMConstructedIncludingChildren()}},{key:"refreshTabs",value:function(){var e,t=!1,n=b(this.children());try{for(n.s();!(e=n.n()).done;)t=e.value.adjustTab()||t}catch(e){n.e(e)}finally{n.f()}t&&this.tabHandlesRow.repositionChildrenRecursive()}},{key:"getHandleStyle",value:function(e){return e.active?(0,p.vP)(e.handle,"active"):((0,p.FU)(e.handle,"active"),e instanceof S&&(e.collapsed?(0,p.vP)(e.handle,"collapsed"):(0,p.FU)(e.handle,"collapsed"))),y(y(y({},this.tabHandleStyle),e instanceof S&&e.collapsed?e.handleCollapseStyle:{}),e.active?this.tabHandleActiveStyle:{})}}]),n}(h.w),k=function(e){(0,a.Z)(n,e);var t=C(n);function n(){var e;return(0,o.Z)(this,n),(e=t.call(this)).active=!1,e.isHandleHovered=!1,e.element.style.position="relative",e}return(0,r.Z)(n,[{key:"tabHandleClicked",value:function(e){this.changeToThisTab()}},{key:"isTabHandleHidden",value:function(){return"none"===this.handle.element.style.display}},{key:"getTabHandleContent",value:function(){return[document.createTextNode("Â ")]}},{key:"getTabId",value:function(){return""}},{key:"setAsCurrentTab",value:function(){}},{key:"adjustTab",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.handle.element.textContent;if(!e){var n=document.createElement("span");null!==this.handle.element.firstChild&&((n=this.handle.element.firstChild).innerHTML="");var i,o=b(this.getTabHandleContent());try{for(o.s();!(i=o.n()).done;){var r=i.value;n.appendChild(r)}}catch(e){o.e(e)}finally{o.f()}this.handle.element.appendChild(n)}this.adjustHandleStyle();var s="none"===this.handle.element.style.display;return this.isTabHandleHidden()?this.handle.element.style.display="none":this.handle.element.style.display="inline-block",t!==this.handle.element.textContent||s!==("none"===this.handle.element.style.display)}},{key:"constructTabHandle",value:function(){var e=this;for(this.handle=this.constructTabHandleComponent(),(0,d.Zf)(["click","touchstart"],this.handle.element,(function(t){e.tabHandleClicked(t),e instanceof S&&e.collapsed&&(e.isHandleHovered=!1)}));null!==this.handle.element.firstChild;)this.handle.element.removeChild(this.handle.element.firstChild);var t,n=document.createElement("span"),i=b(this.getTabHandleContent());try{for(i.s();!(t=i.n()).done;){var o=t.value;n.appendChild(o)}}catch(e){i.e(e)}finally{i.f()}return this.handle.element.appendChild(n),this.handle.element.id=this.getTabId(),this.handle.element.dataset.testid=this.getTabId(),this.adjustHandleStyle(),(0,f.nH)(this.handle).listen((function(t){e.isHandleHovered=t,e.adjustHandleStyle()})),this.handle}},{key:"constructTabHandleComponent",value:function(){return new h.w(document.createElement("div"))}},{key:"changeToThisTab",value:function(){void 0!==this.parent?this.parent.changeToTab(this):error("no parent")}},{key:"isCurrentTab",value:function(){return void 0===this.parent?(error("no parent"),!1):this.parent.getCurrentTab()===this}},{key:"refreshTabs",value:function(){void 0!==this.parent?this.parent.refreshTabs():error("no parent")}},{key:"getHandleStyle",value:function(){return void 0!==this.parent?this.parent.getHandleStyle(this):{}}},{key:"adjustHandleStyle",value:function(){(0,f.Zs)(this.handle,this.getHandleStyle())}},{key:"hideElement",value:function(){(0,c.Z)((0,u.Z)(n.prototype),"hideElement",this).call(this),this.active=!1,this.adjustHandleStyle()}},{key:"showElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"block";(0,c.Z)((0,u.Z)(n.prototype),"showElement",this).call(this,e),this.active=!0,this.adjustHandleStyle()}}]),n}(h.w),S=function(e){(0,a.Z)(n,e);var t=C(n);function n(){var e;return(0,o.Z)(this,n),(e=t.apply(this,arguments)).handleCollapseStyle={display:"block",cssFloat:"none",padding:"9px 12px",margin:0,borderRadius:"",border:"none",boxSizing:"border-box",width:"100%",height:"auto"},e}return(0,r.Z)(n,[{key:"constructTabHandleComponent",value:function(){var e=this,t=new m.tB(document.createElement("div"));return t.onCollapseEvent.listen((function(t){e.collapsed=t,void 0!==e.onCollapse&&e.onCollapse(t),e.adjustTab()})),t}}]),n}(k)},795:function(e,t,n){"use strict";n.d(t,{IK:function(){return j},oV:function(){return F},sh:function(){return $},_r:function(){return K},Hi:function(){return J},dg:function(){return G},Ky:function(){return V},rv:function(){return H},f_:function(){return Y}});var i=n(3243),o=n(2951),r=n(1976),s=n(7591),a=n(9492),l=n(7597),c=n(8759),u=n(2800),d=n(7693),h=n(1522),f=n(3753),p=n(4793),m=n(7988),v=n(9),g=n(1794),y=n(4801),b=n(3705),w=n(7108),C=n(3543),x=n(2750),k=n(1185),S=n(4649),T=n(8263),I=n(3682),R=n(9874),P=n(1194);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){(0,S.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E="TokenSourcePurchaseMedia",B=function(e){(0,s.Z)(u,e);var t,n,c=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function u(e,t){var n;(0,o.Z)(this,u),n=c.call(this),(0,T.Zs)(n.element,{width:"100%",position:"fixed",minHeight:"250px",maxHeight:"100%",height:"unset",overflowY:"auto",transition:"bottom 500ms",zIndex:1006,bottom:"-400px",borderRadius:"8px 8px 0px 0px",backgroundColor:"#F8F9FA",touchAction:"none"}),(0,T.Zs)(n.overlay,{zIndex:1005,background:"rgba(0, 0, 0, 0.5)",touchAction:"none"}),n.content=document.createElement("div"),n.element.appendChild(n.content);var i=document.createElement("div");i.onclick=function(){return n.hide()};var r=e===E?{height:"14.6px",width:"14.6px",right:"25px",top:"20px"}:{height:"12.73px",width:"12.73px",right:"15px",top:"10px"};(0,T.Zs)(i,A({display:"inline-block",cursor:"pointer",position:"absolute"},r));var s=function(t){var n=document.createElement("div"),i=e===E?{width:"4.5px",height:"22px",left:"10px"}:{width:"3px",height:"15px",left:"5px"};return(0,T.Zs)(n,A({position:"absolute",background:"#C4C4C4",transform:t},i)),n};return i.appendChild(s("rotate(-135deg)")),i.appendChild(s("rotate(-45deg)")),n.element.appendChild(i),n.show(e,t),n}return(0,r.Z)(u,[{key:"show",value:function(e,t){var n=this;this.orientationChangeListener=I.bs.once((function(){n.hide()}),!1);var o=P.d.get("OneClickFlow");this.oneClickFlowInstance=new o({source:null!=e?e:"",roomType:null!=t?t:"public",closeModal:function(){return n.hide()}},this.content),(0,i.Z)((0,l.Z)(u.prototype),"show",this).call(this),void 0===e||e!==E||(0,I.gr)()?window.setTimeout((function(){n.element.style.bottom="0"}),1):window.setTimeout((function(){n.element.style.bottom="-60px"}),1)}},{key:"hide",value:function(){var e,t=this;this.element.style.bottom="-400px",null===(e=this.orientationChangeListener)||void 0===e||e.removeListener(),window.setTimeout((function(){var e;(0,i.Z)((0,l.Z)(u.prototype),"hide",t).call(t),null===(e=t.oneClickFlowInstance)||void 0===e||e.dispose()}),1)}}]),u}(R.z);var L=function(e){(0,s.Z)(h,e);var t,n,c=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function h(){var e;(0,o.Z)(this,h),(e=c.call(this,{easyExit:!1})).isClosed=!1,e.canClose=!0,e.width=430,e.contentOffset=135,e.url="/tipping/purchase_tokens/".concat(window.location.search,"&source=").concat(u.J.current.PurchaseEventSources.TOKEN_SOURCE_PURCHASE_PAGE_IFRAME),e.element.style.width="".concat(e.width+20,"px"),e.element.style.position="fixed",e.element.style.right="0",e.element.style.top="".concat(e.contentOffset,"px"),e.element.style.minHeight="200px",e.element.style.zIndex="1001",e.element.style.overflow="hidden",e.element.style.opacity="0",e.element.style.transition="opacity 1s",e.element.style.zIndex="1003",e.overlay.style.zIndex="1002",e.overlay.style.background="rgba(0, 0, 0, 0.5)",e.content=document.createElement("div"),e.content.style.position="absolute",e.content.style.right="-500px",e.content.style.minHeight="200px",e.content.style.maxHeight="735px",e.content.style.width="".concat(e.width,"px"),e.content.style.border="1px solid #ccc",e.content.style.borderRadius="5px",e.content.style.background="#FFF",e.content.style.transition="right 500ms",e.content.style.zIndex="1002",e.element.appendChild(e.content);var t=e.createIframe(),n=function(){clearInterval(e.resizeTimeout),e.element.style.opacity="0",e.content.style.right="-500px",window.setTimeout((function(){e.hide()}),500)},i=function(){e.canClose&&!e.isClosed&&(e.isClosed=!0,(0,d.SC)("message",window,v),(0,d.SC)("keydown",document,r),n())},r=function(e){"Esc"!==e.key&&"Escape"!==e.key||i()},s=document.createElement("div");e.content.appendChild(s);var a=e.createBackButton();s.appendChild(a);var l=document.createElement("div");l.onclick=n,l.style.display="inline-block",l.style.height="12.73px",l.style.width="12.73px",l.style.cursor="pointer",l.style.position="absolute",l.style.right="15px",l.style.top="10px";var p=function(e){var t=document.createElement("div");return t.style.position="absolute",t.style.width="3px",t.style.height="15px",t.style.left="5px",t.style.background="#C4C4C4",t.style.transform=e,t};l.appendChild(p("rotate(-135deg)")),l.appendChild(p("rotate(-45deg)")),s.appendChild(l),e.spinner=e.createLoadingSpinner(),e.content.appendChild(e.spinner),e.overlay.onclick=function(t){t.stopPropagation(),i(),e.overlayClick.fire(void 0)},a.onclick=function(){t.src=e.url},t.onload=function(){clearInterval(e.resizeTimeout);var i=document.createElement("a");i.href=(0,f.BN)(t.src),-1===e.url.indexOf("".concat(i.pathname).concat(i.search))&&(a.style.display="inline-block",l.onclick=n)},window.setTimeout((function(){e.content.appendChild(t)}),1);var m=function(t,n,o){window.open((0,f.BN)(t),"_blank","status=0,toolbar=0,menubar=0,directories=0,resizable=1,scrollbars=1,height=".concat(n,",width=").concat(o)),e.canClose=!0,i()},v=function(n){if("close"===n.data)e.canClose=!0,i();else if("hide-spinner"===n.data)e.spinner.style.display="none";else if("crypto-submit"===n.data)e.canClose=!1,e.overlay.onclick=function(e){e.preventDefault()},l.onclick=function(e){e.preventDefault()};else if("crypto-error"===n.data)e.canClose=!0,e.overlay.onclick=function(t){t.stopPropagation(),i(),e.overlayClick.fire(void 0)},l.onclick=i;else if(0===n.data.indexOf("crypto-redirect: ")){var o=n.data.substring(17);m(o,950,780)}else if(0===n.data.indexOf("billing-redirect: ")){var s=n.data.substring(18);m(s,715,430)}else n.origin.indexOf(window.location.hostname)>=0&&("/tipping/purchase_tokens/"===n.data&&(a.style.display="none"),l.onclick=i,null!==t.contentWindow&&(0,d.j9)("keydown",t.contentWindow,r))};return(0,d.j9)("message",window,v),(0,d.j9)("keydown",document,r),e.show(),window.setTimeout((function(){t.style.opacity="1"}),1e3),e.repositionChildren(),e}return(0,r.Z)(h,[{key:"createIframe",value:function(){var e=document.createElement("iframe");return e.className="purchaseFrame",e.src=this.url,e.style.border="none",e.style.padding="0",e.style.background="transparent",e.style.height="calc(100% - 5px)",e.style.width="100%",e.style.transition="height 200ms, opacity 1s",e.style.opacity="0",e}},{key:"createBackButton",value:function(){var e=document.createElement("div");e.innerHTML="&lt; ",e.style.display="none",e.style.color="#999",e.style.cursor="pointer",e.style.fontSize="20px",e.style.fontWeight="bold",e.style.borderRadius="50px",e.style.padding="2px 0 5px 7px";var t=document.createElement("small");return t.innerText="Back",t.style.fontSize="12px",t.style.verticalAlign="middle",t.style.lineHeight="9px",e.appendChild(t),e}},{key:"createLoadingSpinner",value:function(){var e=document.createElement("div");return e.style.animationName="spin",e.style.position="absolute",e.style.top="50%",e.style.left="50%",e.style.width="30px",e.style.height="31px",e.style.margin="-15px 0 0 -15px",e.style.background='url("'.concat(STATIC_URL,'images/loading_spinner.svg")'),e.style.backgroundSize="cover",e.style.animationName="spin",e.style.animationDuration="2s",e.style.webkitAnimationDuration="2s",e.style.animationTimingFunction="linear",e.style.webkitAnimationTimingFunction="linear",e.style.animationIterationCount="infinite",e.style.webkitAnimationIterationCount="infinite",e.style.zIndex="-1",e}},{key:"show",value:function(){var e=this;(0,i.Z)((0,l.Z)(h.prototype),"show",this).call(this),window.setTimeout((function(){e.element.style.opacity="1"}),1),window.setTimeout((function(){e.content.style.right="10px"}),500)}},{key:"repositionChildren",value:function(){this.content.style.height="".concat(window.innerHeight-this.contentOffset-10,"px"),this.element.style.top="".concat(Math.min(this.contentOffset,window.innerHeight-this.content.offsetHeight-10),"px")}}]),h}(R.z),O=n(407);function D(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var F=15,_=function(e){(0,s.Z)(n,e);var t=Z(n);function n(e){var i;(0,o.Z)(this,n),(i=t.call(this)).data=e,i.disabled=!1,i.onTouch=function(e){i.disabled&&(e.preventDefault(),void 0!==i.data.disabledModalText?(0,h.oB)(i.data.disabledModalText,(function(){void 0!==i.disabledMouseClick&&i.disabledMouseClick(e)})):void 0!==i.disabledMouseClick&&i.disabledMouseClick(e))},i.showTooltip=function(){void 0!==i.disabledTooltip&&(i.disabledTooltip.style.display="block")},i.hideTooltip=function(){void 0!==i.disabledTooltip&&(i.disabledTooltip.style.display="none")},i.element.removeAttribute("id"),(0,k.vP)(i.element,"menuItem"),i.element.style.padding="9px 0",i.element.style.cursor="pointer",i.element.style.boxSizing="border-box",i.element.style.position="relative",i.element.style.overflow="visible",i.element.style.borderWidth="1px",i.element.style.borderStyle="solid",void 0!==e.disabledTooltip&&(i.disabledTooltip=e.disabledTooltip,i.disabledTooltip.style.top="57px",i.element.appendChild(e.disabledTooltip)),i.dt=document.createElement("dt"),i.dt.style.margin="0",i.dt.style.padding="0 8px 5px 28px",i.dt.style.backgroundSize="14px 14px",i.dt.innerText=e.label,i.element.appendChild(i.dt);var r=e.description;void 0!==r&&r.length>0&&(i.dd=document.createElement("dd"),i.dd.style.margin="0",i.dd.style.padding="0 8px 0 28px",i.dd.innerText=r,i.element.appendChild(i.dd));var s=n.createItemId("ButtonMenuItem");return i.input=document.createElement("input"),i.input.id=s,i.input.name=s,i.input.type="radio",i.input.style.cursor="pointer",i.input.style.position="absolute",i.input.style.opacity="0",i.input.style.width="0",i.input.style.height="0",i.element.appendChild(i.input),void 0!==e.disabledMouseClick&&(i.disabledMouseClick=e.disabledMouseClick),(0,d.j9)("mouseenter",i.element,(function(){i.disabled&&void 0!==i.disabledTooltip&&i.showTooltip()})),(0,d.j9)("mouseleave",i.element,(function(){i.disabled&&void 0!==i.disabledTooltip&&i.hideTooltip()})),i.enabledMouseClick=e.enabledMouseClick,(0,d.j9)("click",i.element,(function(e){i.disabled?void 0!==i.disabledMouseClick&&i.disabledMouseClick(e):i.enabledMouseClick(e)})),(0,d.j9)("touchstart",i.element,i.onTouch),(0,d.j9)("focus",i.input,(function(){i.element.style.outline="2px solid Highlight"})),(0,d.j9)("blur",i.input,(function(){i.element.style.removeProperty("outline")})),i}return(0,r.Z)(n,[{key:"select",value:function(){(0,k.vP)(this.dt,"selected")}},{key:"deselect",value:function(){(0,k.FU)(this.dt,"selected")}},{key:"getValue",value:function(){return this.data.value}},{key:"getButtonLabel",value:function(){var e=this.data.buttonLabel;return void 0===e?this.data.label:e}},{key:"disable",value:function(){this.disabled||(this.disabled=!0,(0,k.vP)(this.element,"disabled"))}},{key:"enable",value:function(){this.disabled&&(this.disabled=!1,(0,k.FU)(this.element,"disabled"))}}],[{key:"createItemId",value:function(e){return n.lastId+=1,e+n.lastId.toString()}}]),n}(v.w);_.lastId=0;var N=function(e){(0,s.Z)(n,e);var t=Z(n);function n(e,i){var r;(0,o.Z)(this,n),(r=t.call(this)).width=280,r.visible=!1,r.visibilityChange=new g.xB("visibilityChange"),r.selectionChange=new g.xB("selectionChange");var s=[],a=e.length;0===a&&error("ButtonMenu requires at least one option!"),(0,k.vP)(r.element,"menu"),r.element.style.padding="0",r.element.style.display="none",r.element.style.width="".concat(r.width,"px"),r.element.style.textAlign="left",r.element.style.fontSize="14px",r.element.style.lineHeight="14px",r.element.style.borderRadius="4px",r.overlay.style.zIndex="1002",r.element.style.zIndex="1003",r.element.style.overflow="visible",r.element.style.removeProperty("height");for(var l=-1,c=a-1,u=function(){var t=e[h];t.value===i&&(l=h),t.enabledMouseClick=function(e){e.stopPropagation(),r.onItemClick(n)};var n=r.createMenuItem(t),o=function(e){return e.preventDefault(),e.stopPropagation(),r.onItemClick(n),!1};(0,d.j9)("keyup",n.input,(function(e){return 32!==e.keyCode||o(e)})),(0,d.j9)("keydown",n.input,(function(e){return 13!==e.keyCode||o(e)})),0===h&&(n.element.style.borderTopWidth="1px",n.element.style.borderTopLeftRadius="2px",n.element.style.borderTopRightRadius="2px"),h===c&&(n.element.style.borderBottomLeftRadius="2px",n.element.style.borderBottomRightRadius="2px"),r.addChild(n),s.push(n.input)},h=0;h<a;h+=1)u();var f=r.children();return l=-1===l?0:l,r.selectedItem=f[l],r.focusElements=s,r.selectionChange.listen((function(e){r.onSelectionChange(e)})),r.overlayClick.listen((function(){r.hide()})),r}return(0,r.Z)(n,[{key:"getValue",value:function(){return this.selectedItem.getValue()}},{key:"getButtonLabel",value:function(){return this.selectedItem.getButtonLabel()}},{key:"isVisible",value:function(){return this.visible}},{key:"show",value:function(e){this.isVisible()||(this.visibilityChange.fire(!0),this.element.style.display="inline-block",this.element.style.top="".concat(e.top,"px"),this.element.style.left="".concat(e.left,"px"),this.showOverlay(),this.visible=!0,this.repositionChildrenRecursive())}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isVisible()&&(e||this.visibilityChange.fire(!1),this.visible=!1,this.element.style.display="none",this.hideOverlay())}},{key:"toggle",value:function(e){this.isVisible()?this.hide():this.show(e)}},{key:"disableItem",value:function(e){var t=this.children();e<t.length&&t[e].disable()}},{key:"enableItem",value:function(e){var t=this.children();e<t.length&&t[e].enable()}},{key:"afterDOMConstructedIncludingChildren",value:function(){(0,i.Z)((0,l.Z)(n.prototype),"afterDOMConstructedIncludingChildren",this).call(this),this.onSelectionChange({current:this.selectedItem})}},{key:"findBoundary",value:function(){for(var e,t=this.parent;void 0!==t;t=t.parent)if("hidden"===window.getComputedStyle(t.element).overflowY){e=t.element;break}return e}},{key:"repositionChildren",value:function(){if(this.isVisible()){var e=this.findBoundary(),t=(void 0!==e?e.getBoundingClientRect().bottom:document.documentElement.clientHeight)-this.element.getBoundingClientRect().bottom;t<32&&(this.element.style.top="".concat(this.element.offsetTop-(32-t),"px"))}}},{key:"createMenuItem",value:function(e){return new _(e)}},{key:"onSelectionChange",value:function(e){e.current.select(),void 0!==e.previous&&e.previous.deselect()}},{key:"onItemClick",value:function(e){var t=this.selectedItem;this.hide(),e!==t&&(this.selectedItem=e,this.selectionChange.fire({previous:t,current:e}))}}]),n}(w.B),j=function(e){(0,s.Z)(n,e);var t=Z(n);function n(e){var i;(0,o.Z)(this,n),(i=t.call(this)).menuEnabled=!0,i.anonymousEnabled=!0,i.enabled=!0,i.tipTypeChange=new g.xB("tipTypeChange"),(0,k.vP)(i.element,"sendTip"),i.element.style.margin="6px",i.element.style.display="inline-block",i.element.style.verticalAlign="top",i.element.style.cssFloat="right",i.element.style.overflow="visible",i.element.style.position="static",i.element.style.removeProperty("width"),i.element.style.removeProperty("height"),i.submitButton=i.createSubmitButton(),i.submitButton.dataset.testid="send-tip",i.dropDownButton=i.createDropDownMenu(),i.dropDownButton.innerHTML="&#9660;",i.dropDownButton.id="id_tip_type_select_tm",i.dropDownButton.dataset.testid="tip-type-dropdown-button",i.dropDownMenu=new N(n.menuItemsData,e),i.submitButton.innerText=i.dropDownMenu.getButtonLabel();var r,s=D(i.dropDownMenu.children());try{for(s.s();!(r=s.n()).done;){var a=r.value;i.styleButtonMenuItem(a)}}catch(e){s.e(e)}finally{s.f()}return i.element.appendChild(i.submitButton),i.element.appendChild(i.dropDownButton),i.tipType=i.dropDownMenu.getValue(),i.addChild(i.dropDownMenu),i.dropDownMenu.selectionChange.listen((function(e){if(i.isAnonymousEnabled()){var t=e.current.getValue();i.changeTipType(t),i.submitButton.focus()}})),(0,d.j9)("mouseenter",i.submitButton,(function(e){i.submitButton.style.textDecoration="underline"})),(0,d.j9)("mouseleave",i.submitButton,(function(e){i.submitButton.style.textDecoration="none"})),(0,d.j9)("click",i.dropDownButton,(function(e){return e.preventDefault(),e.stopPropagation(),i.dropDownMenu.toggle(i.getMenuOffsets()),!1})),i.dropDownMenu.visibilityChange.listen((function(e){e||i.submitButton.focus()})),i.focusElements=[i.submitButton,i.dropDownButton],p.kN.listen((function(e){e.dossier.allowAnonymousTipping?i.enableAnonymousTips():i.disableAnonymousTips()})),i}return(0,r.Z)(n,[{key:"getOffsetWidth",value:function(){return this.element.offsetWidth}},{key:"hideMenu",value:function(){this.dropDownMenu.hide(!0)}},{key:"promptUser",value:function(e){this.submitButton.innerHTML="".concat(e," &#9656;"),this.submitButton.title=e,this.disableMenu()}},{key:"cancelPrompt",value:function(){this.resetText(),this.isAnonymousEnabled()&&this.enableMenu()}},{key:"resetText",value:function(){this.isAnonymousEnabled()?(this.submitButton.innerText=this.dropDownMenu.getButtonLabel(),this.submitButton.title=this.dropDownMenu.getButtonLabel()):(this.submitButton.innerHTML=C.ag.sendTipButtonText,this.submitButton.title=C.ag.sendTipButtonText)}},{key:"isAnonymousEnabled",value:function(){return this.anonymousEnabled}},{key:"isEnabled",value:function(){return this.enabled}},{key:"disable",value:function(){this.isEnabled()&&(this.enabled=!1,this.dropDownMenu.hide(),this.submitButton.disabled=!0,(0,k.vP)(this.submitButton,"disabled"),this.dropDownButton.disabled=!0,(0,k.vP)(this.dropDownButton,"disabled"))}},{key:"enable",value:function(){this.isEnabled()||(this.enabled=!0,this.submitButton.disabled=!1,(0,k.FU)(this.submitButton,"disabled"),this.dropDownButton.disabled=!1,(0,k.FU)(this.dropDownButton,"disabled"))}},{key:"getTipType",value:function(){return this.tipType}},{key:"hasFocus",value:function(){return this.getCurrentFocusData().index>-1}},{key:"focusPrev",value:function(){var e=this.getCurrentFocusData(),t=e.elements.length;if(e.index-=1,-2===e.index)e.index=t-1;else if(-1===e.index)return!1;return this.focusElement(e),!0}},{key:"focusPrevMenuItem",value:function(){if(!this.menuEnabled||!this.dropDownMenu.isVisible())return!1;var e=this.getCurrentFocusData(),t=e.elements.length;return e.index-=1,e.index<=t-this.dropDownMenu.focusElements.length-1&&(e.index=t-1),this.focusElement(e),!0}},{key:"focusNext",value:function(){var e=this.getCurrentFocusData(),t=e.elements.length;return e.index+=1,!(e.index>=t||(this.focusElement(e),0))}},{key:"focusNextMenuItem",value:function(){if(!this.menuEnabled||!this.dropDownMenu.isVisible())return!1;var e=this.getCurrentFocusData(),t=e.elements.length;return e.index+=1,(e.index>=t||e.index<=t-this.dropDownMenu.focusElements.length-1)&&(e.index=t-this.dropDownMenu.focusElements.length),this.focusElement(e),!0}},{key:"focusElement",value:function(e){var t=e.index;e.elements[t].focus()}},{key:"getCurrentFocusData",value:function(){var e=this.focusElements;return this.menuEnabled&&this.dropDownMenu.isVisible()&&(e=this.focusElements.concat(this.dropDownMenu.focusElements)),{elements:e,index:e.indexOf(document.activeElement)}}},{key:"getMenuOffsets",value:function(){var e=this.element,t=(0,m.cQ)(this.submitButton),n=e.offsetLeft+e.offsetWidth+1-this.dropDownMenu.width;return{top:t.height+2*t.top,left:n}}},{key:"enableAnonymousTips",value:function(){var e=this.dropDownMenu.getValue();this.anonymousEnabled=!0,this.dropDownMenu.enableItem(1),this.changeTipType(e)}},{key:"disableAnonymousTips",value:function(){this.anonymousEnabled=!1,this.dropDownMenu.disableItem(1),this.changeTipType("public")}},{key:"enableMenu",value:function(){this.menuEnabled||(this.menuEnabled=!0,this.submitButton.style.borderRadius="4px 0 0 4px",this.dropDownButton.style.display="inline-block",this.focusElements=[this.submitButton,this.dropDownButton],this.repositionChildrenRecursive())}},{key:"disableMenu",value:function(){this.menuEnabled&&(this.hasFocus()&&this.submitButton.focus(),this.menuEnabled=!1,this.dropDownMenu.hide(),this.submitButton.style.borderRadius="4px",this.dropDownButton.style.display="none",this.focusElements=[this.submitButton])}},{key:"changeTipType",value:function(e){this.tipType=e,this.tipTypeChange.fire(e),this.resetText()}},{key:"styleButtonMenuItem",value:function(e){e.dt.style.fontFamily="'UbuntuMedium', Helvetica, Arial, sans-serif",void 0!==e.dd&&(e.dd.style.fontFamily="'UbuntuRegular', Helvetica, Arial, sans-serif")}},{key:"createCommonButton",value:function(){var e=document.createElement("button");return(0,k.vP)(e,"buttons"),e.style.position="relative",e.style.display="inline-block",e.style.cursor="pointer",e.style.fontSize="14px",e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.height="32px",e.style.verticalAlign="top",e.style.margin="0",(0,d.j9)("focus",e,(function(){e.style.zIndex="100"})),(0,d.j9)("blur",e,(function(){e.style.zIndex="auto"})),e}},{key:"createSubmitButton",value:function(){var e=this.createCommonButton();return e.type="submit",e.title=C.ag.sendTipButtonText,e.style.padding="6px 18px",e.style.borderRadius="4px 0 0 4px",e.style.borderRight="0 none transparent",e.style.maxWidth="145px",e.style.overflow="hidden",e.style.textOverflow="ellipsis",e.style.whiteSpace="nowrap",e}},{key:"createDropDownMenu",value:function(){var e=this.createCommonButton();return e.style.padding="6px 0",e.style.borderRadius="0 4px 4px 0",e.style.width="24px",e}}]),n}(v.w);function H(e,t){window.setTimeout((function(){if(t.isAnonymousEnabled()){var n=t.getTipType();(0,b.fg)("SendTipViewed",{source:e,tipType:n,localStorage:(0,c.IU)()})}}),0)}j.menuItemsData=[{label:C.ag.publicTippingText,value:"public",description:C.ag.publicTippingDesc,buttonLabel:C.ag.sendTipButtonText,enabledMouseClick:function(){}},{label:C.ag.anonTippingText,value:"anonymous",description:C.ag.anonTippingDesc,buttonLabel:C.ag.anonButtonText,enabledMouseClick:function(){},disabledMouseClick:function(e){(0,b.fg)("SupporterPageOpened",{source:"anon_tip"}),null!==window.top&&(window.top.location.href=(0,f.BN)("/supporter/upgrade/?source=".concat(u.J.current.PurchaseEventSources.SUPPORTER_SOURCE_ANON_TIP_UPSELL)))},disabledTooltip:(0,O.T)({content:C.ag.mustBeSupporterFeature,hasHTML:!1,width:240,divotPosition:0,divotLeftOrTop:"40px"}),disabledModalText:"".concat(C.ag.mustBeSupporterFeature," ").concat(C.ag.anonTipDisabledModalCont)}];var z,W,V="/tipping/purchase_tokens/";function q(e){var t,n=e.source,i=void 0===u.J.current.loggedInUser;return""===window.location.search?(t=V,null!=n&&""!==n?(t+="?source=".concat(n),i&&(t+="&refresh_opener=1")):i&&(t+="?refresh_opener=1")):(t="".concat(V).concat(window.location.search),null!=n&&""!==n&&(t+="&source=".concat(n)),i&&(t+="&refresh_opener=1")),t}function K(){var e=document.createElement("input");return(0,k.vP)(e,"tipAmountInput"),e.dataset.testid="tip-amount-input",(0,d.j9)("keypress",e,(function(t){t.metaKey||8===t.charCode||0===t.charCode||13===t.charCode||(e.value.length>F?t.preventDefault():t.charCode>=48&&t.charCode<=57||t.preventDefault())})),(0,d.j9)("paste",e,(function(){window.setTimeout((function(){/^[1-9]\d*$/.test(e.value)||(e.value=""),e.value=e.value.substring(0,F)}),0)})),e}function J(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.popupOnly,n=void 0!==t&&t,i=e.source,o=void 0===i?void 0:i,r=e.roomType,s=void 0===r?"public":r,a=q({source:o}),l=new y.BJ(["PrchPgIfrmV4","PrchPgPopupV4"],"purchaseredesign"),c=u.J.current.loggedInUser&&u.J.current.isMobile&&u.J.current.loggedInUser.canWegOneClick;if(l.eligible&&l.active)return l.record(),void function(e,t,n,i,o){var r=q({source:o});if("PrchPgIfrmV4"===e){if(i)return void(0,x.Pv)(r,"_blank","height=715, width=430, scrollbars=1");void 0===z||z.isClosed?z=new L:z.show()}else"PrchPgPopupV4"===e?(0,x.Pv)(r,"_blank","height=715, width=430, scrollbars=1"):(0,x.Pv)(r,"_blank","height=615, width=850, scrollbars=1")}(l.activeSide,0,0,n,o);void 0!==c&&c?W?W.show(null!=o?o:"",s):W=new B(null!=o?o:"",s):(0,x.Pv)(a,"_blank","height=615, width=850, scrollbars=1")}function G(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;(0,h.oB)(e,(function(){J({popupOnly:t,source:n,roomType:i})}),void 0,{acceptText:C.ag.purchaseTokensText})}function Y(e){var t,n=D(document.querySelectorAll(".tokencount[updatable-count]"));try{for(n.s();!(t=n.n()).done;)t.value.textContent="".concat(e)}catch(e){n.e(e)}finally{n.f()}}function $(e){e.onclick=function(t){if(e.classList.contains("welcome-page-purchase-tokens")&&(0,b.fg)("WelcomePagePurchaseTokensClicked"),!t.ctrlKey&&!t.metaKey){var n=function(e){var t=e.dataset.purchaseEventSource;if(null!=t&&""!==t)return Object.values(u.J.current.PurchaseEventSources).includes(t)?Object.values(u.J.current.PurchaseEventSources).find((function(e){return e===t})):void 0}(e);t.preventDefault(),J({popupOnly:t.target.className.includes("popup_only"),source:n})}},""===e.href&&(e.href=(0,f.BN)(V))}},407:function(e,t,n){"use strict";n.d(t,{T:function(){return w},t:function(){return b}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(8759),c=n(7693),u=n(9),d=n(3149),h=n(8263),f=n(1794),p=n(9491),m=n(9429),v=n(2974),g=n(1185),y=n(9760);var b=function(e){(0,r.Z)(d,e);var t,n,u=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function d(e,t,n){var o,r,s,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:document.body;return(0,i.Z)(this,d),(s=u.call(this)).target=e,s.storageKey=t,s.params=n,s.parentElm=a,s.listenerGroup=new f.mM,s.hOffsetFunc=function(e){return 0},s.vOffsetFunc=function(e){return 0},s.element=w(n),s.element.style.paddingRight="28px",!0!==n.noCloseButton&&s.addCloseButton(),s.divotPosition=n.divotPosition,s.divotLeftOrTop=n.divotLeftOrTop,s.hOffsetFunc=null!==(o=n.hOffsetFunc)&&void 0!==o?o:s.hOffsetFunc,s.vOffsetFunc=null!==(r=n.vOffsetFunc)&&void 0!==r?r:s.vOffsetFunc,y.nR.listen((function(){s.updateLocation()})).addTo(s.listenerGroup),d.dismissed.listen((function(e){s.storageKey===e&&s.dispose()})).addTo(s.listenerGroup),void 0!==n.showInModes&&(s.videoModes=n.showInModes,v.S.changeVideoMode.listen((function(e){s.updateLocation(),s.showIfCorrectMode()})).addTo(s.listenerGroup),m.Ox.splitModeDragResize.listen((function(){s.updateLocation()})).addTo(s.listenerGroup)),s.updateLocation(),s.showIfCorrectMode(),a.appendChild(s.element),s}return(0,o.Z)(d,[{key:"dismiss",value:function(){this.dispose(),void 0!==this.storageKey&&(d.dismissed.fire(this.storageKey),(0,l.IU)()&&localStorage.setItem(this.storageKey,"true")),void 0!==this.params.onAfterDismiss&&this.params.onAfterDismiss()}},{key:"dispose",value:function(){var e,t;this.hide(),null===(e=this.parent)||void 0===e||e.removeChild(this),null===(t=this.element.parentElement)||void 0===t||t.removeChild(this.element),this.listenerGroup.removeAll()}},{key:"addCloseButton",value:function(){var e=this,t=(0,p.bo)("12px");(0,h.Zs)(t,{position:"absolute",right:"8px",top:"8px"}),(0,g.vP)(t,"tooltipCloseButton"),(0,c.j9)("click",t,(function(){e.dismiss()})),this.element.appendChild(t)}},{key:"updateLocation",value:function(){if(!1!==this.params.autoUpdateLocation){var e=this.parentElm.getBoundingClientRect(),t=this.target.getBoundingClientRect(),n=t.top-e.top,i=t.left-e.left,o=(0,h.gV)(this.divotLeftOrTop);1===this.divotPosition?(this.element.style.top="".concat(n-this.element.clientHeight-this.target.clientHeight+this.vOffsetFunc(this.target),"px"),this.element.style.left="".concat(i-o+this.hOffsetFunc(this.target),"px")):0===this.divotPosition?(this.element.style.top="".concat(n+this.target.clientHeight+this.vOffsetFunc(this.target),"px"),this.element.style.left="".concat(i-o+this.hOffsetFunc(this.target),"px")):2===this.divotPosition?(this.element.style.top="".concat(n-o+this.vOffsetFunc(this.target),"px"),this.element.style.left="".concat(i+this.target.clientWidth+this.hOffsetFunc(this.target),"px")):3===this.divotPosition&&(this.element.style.top="".concat(n-o+this.vOffsetFunc(this.target),"px"),this.element.style.left="".concat(i-this.element.clientWidth+this.hOffsetFunc(this.target),"px"))}}},{key:"setDivotPosition",value:function(e,t){var n;this.divotLeftOrTop=null!=t?t:this.divotLeftOrTop,this.divotPosition=e;var i=this.element.querySelector(".divot");null==i||null===(n=i.parentElement)||void 0===n||n.removeChild(i);var o=C(this.divotPosition,this.divotLeftOrTop);void 0!==o&&this.element.appendChild(o),this.updateLocation()}},{key:"show",value:function(){this.showIfCorrectMode()}},{key:"showIfCorrectMode",value:function(){void 0===this.videoModes||this.videoModes.includes(v.S.getVideoMode())?this.element.style.display="block":this.hide()}},{key:"hide",value:function(){this.element.style.display="none"}}],[{key:"create",value:function(e,t,n,i){if(!0===n.skipStorageCheck||void 0===t||!(0,l.IU)()||"true"!==localStorage.getItem(t))return new d(e,t,n,i)}}]),d}(u.w);function w(e){var t;t=void 0===e.hasHTML?e:{content:e.content,hasHTML:"true"===e.hasHTML,width:parseInt(e.width),divotPosition:parseInt(e.divotPosition),divotLeftOrTop:e.divotLeftOrTop,borderWidth:void 0!==e.borderWidth?parseInt(e.borderWidth):void 0};var n=document.createElement("div");(0,g.vP)(n,"tooltip"),t.hasHTML?n.innerHTML=t.content:n.textContent=t.content,void 0!==t.width&&(n.style.width="".concat(t.width,"px")),n.style.borderWidth="1px",n.style.position="absolute",n.style.borderStyle="solid",n.style.borderRadius="4px",n.style.fontSize="12px",n.style.padding="8px",n.style.display="none",n.style.zIndex="5";var i=C(t.divotPosition,t.divotLeftOrTop,t.borderWidth);return void 0!==i&&n.appendChild(i),n}function C(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,o="";switch(e){case 0:n=d.fR,o="divotTop";break;case 1:n=d.G3,o="divotBottom";break;case 2:n=d.vV,o="divotLeft";break;case 3:n=d.sz,o="divotRight";break;default:n=void 0}if(void 0!==n){var r=n("","",t,i);return(0,g.vP)(r,o),(0,g.vP)(r,"divot"),r}}b.dismissed=new f.xB("key")},14:function(e,t,n){"use strict";n.d(t,{i:function(){return l}});var i=n(1976),o=n(2951),r=n(7591),s=n(9492),a=n(7597);var l=function(e){(0,r.Z)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function c(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(0,o.Z)(this,c),(t=l.call(this,{},e,n)).toggleElement=e,t.alignRight=n,t}return(0,i.Z)(c)}(n(761).M)},761:function(e,t,n){"use strict";n.d(t,{M:function(){return m},P:function(){return v}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(9),u=n(8263),d=n(7191),h=n(8978),f=n(9760);function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var m=function(e){(0,s.Z)(n,e);var t=p(n);function n(e,o){var r,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(0,i.Z)(this,n),(r=t.call(this,e,o,!1)).toggleElement=o,r.alignRight=s,r.topMargin=4,r.toggleStylesToKeep=["color","background-color","text-decoration"],r.initAddChildren(),r.resizeDebounceListener=f.nR.listen((function(){r.isShown()&&r.reposition()})),document.body.appendChild(r.element),r.hideElement(),r}return(0,o.Z)(n,[{key:"initAddChildren",value:function(){this.connectedOverlay=new v,this.addChild(this.connectedOverlay)}},{key:"showElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"block",t=arguments.length>1?arguments[1]:void 0;return!!(0,r.Z)((0,l.Z)(n.prototype),"showElement",this).call(this,e,t)&&(this.toggleElement.classList.add("active"),this.reposition(),!0)}},{key:"hideElement",value:function(e){return!!(0,r.Z)((0,l.Z)(n.prototype),"hideElement",this).call(this,e)&&(this.toggleElement.classList.remove("active"),!0)}},{key:"reposition",value:function(){var e=(0,u.r7)(this.toggleElement),t=this.alignRight||e.left+this.element.offsetWidth>document.documentElement.clientWidth&&e.right-this.element.offsetWidth>0;this.setDropDownStyleFromToggle(t);var n=(0,u.gV)(getComputedStyle(this.element).borderBottomWidth)-(0,u.gV)(getComputedStyle(this.toggleElement).borderLeftWidth);this.setDropDownPosition(e,n,t),this.connectedOverlay.positionAndStyle(this.toggleElement,this,n,t),this.element.style.zIndex=getComputedStyle(this.connectedOverlay.element).zIndex}},{key:"dispose",value:function(){(0,r.Z)((0,l.Z)(n.prototype),"dispose",this).call(this),this.element.remove(),this.resizeDebounceListener.removeListener()}},{key:"setBorderRadius",value:function(e,t){""!==t&&(this.element.style.borderRadius="".concat(e?"".concat(t," 0"):"0 ".concat(t)," ").concat(t," ").concat(t))}},{key:"setDropDownStyleFromToggle",value:function(e){this.element.style.position="absolute",this.element.style.backgroundColor=(0,u.dF)(this.toggleElement),"0px"!==this.getToggleStyle(e?"borderRightWidth":"borderLeftWidth")&&(this.element.style.borderWidth=this.getToggleStyle(e?"borderRightWidth":"borderLeftWidth"),this.element.style.borderStyle=this.getToggleStyle(e?"borderRightStyle":"borderLeftStyle"),this.element.style.borderColor=this.getToggleStyle(e?"borderRightColor":"borderLeftColor"));var t=this.getToggleStyle(e?"borderTopRightRadius":"borderTopLeftRadius");this.setBorderRadius(e,t)}},{key:"setDropDownPosition",value:function(e,t,n){if(this.element.style.top="".concat(e.bottom+this.topMargin,"px"),n){this.element.style.left="";var i=document.documentElement.clientWidth-e.right-t;this.element.style.right="".concat(i,"px"),this.element.style.right="".concat(i-y(this.toggleElement,this.element)-t,"px")}else{this.element.style.right="";var o=e.left-t;this.element.style.left="".concat(o,"px"),this.element.style.left="".concat(o+g(this.toggleElement,this.element)-t,"px")}}},{key:"getToggleStyle",value:function(e){var t=getComputedStyle(this.toggleElement);return(0,h.gB)(this.toggleElement.style[e],t[e])}}]),n}(d.Ku),v=function(e){(0,s.Z)(n,e);var t=p(n);function n(){var e;return(0,i.Z)(this,n),e=t.call(this),(0,u.Zs)(e.element,{position:"absolute",zIndex:4}),e}return(0,o.Z)(n,[{key:"positionAndStyle",value:function(e,t,n,i){var o=getComputedStyle(t.element);this.element.style.borderLeftWidth=o.borderLeftWidth,this.element.style.borderLeftStyle=o.borderLeftStyle,this.element.style.borderLeftColor=o.borderLeftColor,this.element.style.borderRightWidth=o.borderLeftWidth,this.element.style.borderRightStyle=o.borderLeftStyle,this.element.style.borderRightColor=o.borderLeftColor;var r=(0,u.gV)(getComputedStyle(e).width)+2*n;this.element.style.width="".concat(r,"px");var s=t.element.offsetTop-(0,u.r7)(e).bottom+1;this.element.style.height="".concat(s+2,"px"),this.element.style.top="-".concat(s+2,"px"),this.element.style.backgroundColor=o.backgroundColor;var a=(0,h.gB)(o.borderWidth,o.borderLeftWidth);this.element.style.right=i?"-".concat(a):"",this.element.style.left=i?"":"-".concat(a),this.element.style.zIndex=(0,h.gB)(o.zIndex,this.element.style.zIndex),this.element.style.width="".concat(i?r-g(e,this.element)+n:r+y(e,this.element)+n,"px")}}]),n}(c.w);function g(e,t){return e.getBoundingClientRect().left-t.getBoundingClientRect().left}function y(e,t){return e.getBoundingClientRect().right-t.getBoundingClientRect().right}},6640:function(e,t,n){"use strict";n.d(t,{i:function(){return c}});var i=n(1976),o=n(2951),r=n(7591),s=n(9492),a=n(7597),l=n(9);var c=function(e){(0,r.Z)(u,e);var t,n,c=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function u(e){var t;return(0,o.Z)(this,u),(t=c.call(this,"div")).element.style.height="",t.element.style.width="",t.element.style.position="relative",void 0!==e&&(e instanceof l.w?t.addChild(e):t.element.appendChild(e)),t}return(0,i.Z)(u)}(l.w)},8107:function(e,t,n){"use strict";n.d(t,{K:function(){return o},x:function(){return r}});var i=n(8069),o=new(n(1794).xB)("cssVhVarUpdate",{reportIfNoListeners:!1});function r(){var e;s();var t=new i.d(s,{bounceLimitMS:100,debounceType:1});null===(e=window.visualViewport)||void 0===e||e.addEventListener("resize",(function(){return t.callFunc()})),window.setInterval((function(){return t.callFunc()}),500)}function s(){var e,t,n=document.documentElement.style.getPropertyValue("--vh"),i=null!==(e=null===(t=window.visualViewport)||void 0===t?void 0:t.height)&&void 0!==e?e:window.innerHeight,r="".concat(.01*i,"px");r!==n&&(document.documentElement.style.setProperty("--vh",r),o.fire())}},9076:function(e,t,n){"use strict";n.d(t,{WX:function(){return r},p0:function(){return s},r5:function(){return a}});var i=n(3753),o=n(9165);function r(e,t){return t===o.Y0.All||""===e?(0,i.BN)("/tag/".concat(e,"/")):(0,i.BN)("/tag/".concat(e,"/").concat(o.aI.get(t),"/"))}function s(e){var t="/tags/".concat(e!==o.Y0.All?"".concat(o.aI.get(e),"/"):"");return(0,i.BN)(t)}function a(e){var t=(0,o.eN)(e),n=""===t?"/":"/".concat(t,"/");return(0,i.BN)(n)}},8263:function(e,t,n){"use strict";n.d(t,{PZ:function(){return S},WG:function(){return C},Zs:function(){return u},at:function(){return l},dF:function(){return h},eE:function(){return c},gV:function(){return p},hI:function(){return x},i6:function(){return k},mY:function(){return w},nH:function(){return v},np:function(){return g},pY:function(){return d},r7:function(){return f},sj:function(){return m}});var i,o=n(7693),r=n(9),s=n(1794),a=n(8978);function l(e,t){var n=e.getBoundingClientRect(),i=t.getBoundingClientRect();return!(n.right<i.left||n.left>i.right||n.bottom<i.top||n.top>i.bottom)}function c(e){var t=Array.from(document.querySelectorAll("*[style*=z-index]:not(.floatingPlayer)")),n=0;return t.forEach((function(t){if(t instanceof HTMLElement&&!e.contains(t)&&l(e,t))try{n=Math.max(n,parseInt((0,a.gB)(t.style.zIndex,"0")))}catch(e){}})),n}function u(e,t){var n;n=e instanceof r.w?e.element:e;var i=t;t instanceof Function&&(i=t(e));for(var o=0,s=Object.keys(i);o<s.length;o++){var a=s[o];n.style[a]=t[a]}}function d(e){(0,o.j9)("mouseenter",e,(function(){e.style.textDecoration="underline"})),(0,o.j9)("mouseleave",e,(function(){e.style.textDecoration=""}))}function h(e){var t="rgba(0, 0, 0, 0)";if(null===e)return t;var n=getComputedStyle(e).backgroundColor;return""===n||n===t||"transparent"===n?h(e.parentElement):n}function f(e){function t(e,t,n){return 0===e?0===t?void 0===n?0:n:t:e}var n=e.getBoundingClientRect(),i=document.body,o=document.documentElement,r=t(window.pageYOffset,o.scrollTop,i.scrollTop),s=t(window.pageXOffset,o.scrollLeft,i.scrollLeft),a=t(o.clientTop,i.clientTop),l=t(o.clientLeft,i.clientLeft),c=n.top+r-a,u=n.left+s-l;return new DOMRect(u,c,n.width,n.height)}function p(e){if(null===e)return 0;try{var t=parseFloat(e.substring(0,e.indexOf("px")));return isNaN(t)?0:t}catch(e){return 0}}function m(e){return e.offsetLeft+e.offsetWidth}function v(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new s.xB("hover"),i=e instanceof r.w?e.element:e;return(0,o.j9)("mouseenter",i,(function(){n.fire(!0)})),(0,o.j9)("mouseleave",i,(function(){n.fire(!1)})),t&&((0,o.j9)("click",i,(function(){n.fire(!0)})),(0,o.j9)("touchstart",document,(function(){n.fire(!1)})),(0,o.j9)("touchmove",document,(function(){n.fire(!1)})),(0,o.j9)("touchend",document,(function(){n.fire(!1)}))),n}function g(){if(void 0!==i)return i;var e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var n=document.createElement("div");n.style.width="100%",e.appendChild(n);var o=n.offsetWidth;return document.body.removeChild(e),i=t-o}var y,b=document.createElement("canvas");function w(e,t){var n=b.getContext("2d");return null!==n?(n.font=getComputedStyle(t).font,n.measureText(e).width):0}function C(e,t){var n=b.getContext("2d");return null!==n?(n.font=t,n.measureText(e).width):0}function x(e,t){return function(n){var i;"Tab"===n.key&&(n.preventDefault(),void 0!==(i=n.shiftKey?t instanceof HTMLElement?t:t():e instanceof HTMLElement?e:e())&&(i.focus(),n.stopPropagation()))}}function k(){void 0===y&&(u(y=document.createElement("div"),{position:"fixed",top:"0px",left:"0px"}),document.body.appendChild(y));var e=y.getBoundingClientRect();return{top:e.top,left:e.left}}function S(e){var t=e.getBoundingClientRect();return"none"!==e.style.display&&t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}},7693:function(e,t,n){"use strict";n.d(t,{SC:function(){return d},Zf:function(){return u},j9:function(){return c},w$:function(){return h}});var i=n(8759);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var r=42,s={},a={};function l(e){return Number.isNaN(Number(e))?0:Number(e)}function c(e,t,n){var o,c,u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],d=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(t===window)o=s[e]=l(s[e])+1;else if(t===document)o=a[e]=l(a[e])+1;else if(t instanceof HTMLElement){var h="data-listener-count-".concat(e);o=l(t.getAttribute(h))+1,t.setAttribute(h,"".concat(o))}else o=1,debug("EventListener attached to non-HTMLElement object (possibly frame document): ".concat(t));if(o>r&&(c=t===document?"document":t===window?"window":"".concat(t.outerHTML.split(">")[0],">"),warn("Too many event listeners on element",{event:e,element:c,listeners:o,maxListeners:r})),void 0!==window.addEventListener){var f=(0,i.CG)()?{capture:u,passive:d}:u;t.addEventListener(e,n,f)}else void 0!==window.attachEvent?t.attachEvent("on".concat(e),n):error("Could not resolve addEventListenerPoly( ".concat(e," ) to ").concat(t))}function u(e,t,n){var i,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw s}}}}(e);try{for(a.s();!(i=a.n()).done;)c(i.value,t,n,r,s)}catch(e){a.e(e)}finally{a.f()}}function d(e,t,n){var o,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(t===window)o=s[e]=l(s[e])-1;else if(t===document)o=a[e]=l(a[e])-1;else if(t instanceof HTMLElement){var u="data-listener-count-".concat(e);o=l(t.getAttribute(u))-1,t.setAttribute(u,"".concat(o))}else o=1,debug("EventListener removed from non-HTMLElement object (possibly frame document): ".concat(t));if(o<0&&warn('event listener "'.concat(e,'" removed without being added'),{listeners:o}),void 0!==window.removeEventListener){var d=(0,i.CG)()?{capture:r,passive:c}:r;t.removeEventListener(e,n,d)}else void 0!==window.detachEvent?t.detachEvent("on".concat(e),n):error("Could not resolve removeEventListenerPoly( ".concat(e," ) from ").concat(t))}function h(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];c(e,t,(function r(s){n(s),d(e,t,r,i,o)}),i,o)}},1522:function(e,t,n){"use strict";n.d(t,{Bp:function(){return b},Cj:function(){return g},F1:function(){return C},oB:function(){return y}});var i=n(3243),o=n(7591),r=n(9492),s=n(7597),a=n(2951),l=n(1976),c=n(1185),u=n(7693),d=n(8263),h=n(1625),f=n(534);var p={backgroundColor:"#F47321",color:"#FFFFFF",border:"1px solid #CD5D26"},m=function(){function e(){var t=this;(0,a.Z)(this,e),this.message=document.createElement("div"),this.container=document.createElement("div"),this.dialog=document.createElement("div"),this.title=document.createElement("div"),this.decline=document.createElement("div"),this.accept=document.createElement("div"),this.teardown=function(){},this.queue=[],this.rotateDismissTeardownHandler=function(){(0,u.SC)("orientationchange",window,t.rotateDismissTeardownHandler),t.teardown()},(0,c.vP)(this.container,"modalAlert"),this.container.style.display="none",this.container.style.position="fixed",this.container.style.overflow="auto",this.container.style.top="0",this.container.style.left="0",this.container.style.width="100%",this.container.style.height="100%",this.container.style.zIndex="2000",(0,c.vP)(this.dialog,"dialog"),this.dialog.style.width="440px",this.dialog.style.minWidth="240px",this.dialog.style.position="relative",this.dialog.style.display="inline-block",this.dialog.style.borderRadius="10px",this.dialog.style.textAlign="left",this.dialog.style.overflow="hidden",this.dialog.style.zIndex="2001",this.dialog.style.fontFamily="UbuntuRegular, Helvetica, Arial, sans-serif",this.title.style.display="block",this.title.style.fontSize="20px",this.title.style.paddingTop="20px",this.title.style.paddingLeft="20px",this.title.style.paddingRight="20px",this.title.style.whiteSpace="nowrap",this.title.style.fontWeight="bold",this.title.style.overflow="hidden",this.title.style.textOverflow="ellipsis",this.dialog.appendChild(this.title),this.message.style.display="inline-block",this.message.style.wordWrap="break-word",this.message.style.padding="20px",this.message.style.textAlign="left",this.dialog.appendChild(this.message);var n=document.createElement("div");(0,c.vP)(n,"dialogForm"),n.style.borderTopWidth="1px",n.style.borderTopStyle="solid",n.style.textAlign="center",n.style.height="40px",(0,c.vP)(this.accept,"accept"),this.accept.style.minWidth="70px",this.accept.style.padding="3px",this.accept.style.display="inline-block",this.accept.style.cssFloat="right",this.accept.style.position="relative",this.accept.style.top="7px",this.accept.style.right="10px",this.accept.style.boxSizing="border-box",this.accept.innerText="OK",this.accept.style.cursor="pointer",this.accept.style.borderWidth="1px",this.accept.style.borderStyle="solid",this.accept.onclick=function(e){e.stopPropagation(),void 0!==t.yesCallback&&t.yesCallback(),v.teardown()},n.appendChild(this.accept),(0,c.vP)(this.decline,"decline"),this.decline.style.minWidth="70px",this.decline.style.padding="3px",this.decline.style.display="inline-block",this.decline.style.cssFloat="right",this.decline.style.position="relative",this.decline.style.top="7px",this.decline.style.right="25px",this.decline.innerText="Cancel",this.decline.style.cursor="pointer",this.decline.onclick=function(e){e.stopPropagation(),void 0!==t.noCallback?t.noCallback():void 0!==t.yesCallback&&t.yesCallback(),v.teardown()},n.appendChild(this.decline),this.dialog.appendChild(n),this.container.appendChild(this.dialog)}return(0,l.Z)(e,[{key:"resize",value:function(){this.dialog.style.width="".concat(Math.min(440,document.documentElement.clientWidth-40),"px"),this.dialog.style.left="".concat(Math.max(0,(this.container.offsetWidth-this.dialog.offsetWidth)/2),"px"),this.dialog.style.top="".concat(Math.max(0,(this.container.offsetHeight-80-this.dialog.offsetHeight)/2),"px")}},{key:"display",value:function(e,t,n,i){var o=this;if(this.active)this.queue.push({msg:e,yesCallback:t,noCallback:n,config:i});else{this.message.innerText=e,this.handleConfig(i),this.container.style.display="block",this.yesCallback=t,void 0===n?v.decline.style.display="none":(this.noCallback=n,v.decline.style.display="");var r=new f.a,s=function(e){e.stopPropagation(),e.preventDefault(),r.execute(e)};r.addHandler({keyCode:13,requiresCtrlOrMeta:!1,handle:function(e){t(),o.teardown()}}),r.addHandler({keyCode:27,requiresCtrlOrMeta:!1,handle:function(e){void 0!==n?n():t(),o.teardown()}}),this.active=!0;var a=function(){o.resize()};(0,u.j9)("keydown",document,s,!0),(0,u.j9)("resize",window,a),(0,u.j9)("orientationchange",window,a),this.teardown=function(){try{(0,u.SC)("keydown",document,s,!0)}catch(e){debug("ModalAlert keydown listener was already removed")}try{(0,u.SC)("resize",window,a)}catch(e){debug("ModalAlert resize listener was already removed")}o.container.style.display="none",o.active=!1,o.container.parentElement===document.body&&document.body.removeChild(o.container),o.yesCallback=void 0,o.noCallback=void 0;var e=o.queue.shift();void 0!==e&&o.display(e.msg,e.yesCallback,e.noCallback)};var l=(0,h.Gd)();void 0!==l&&Boolean(l)?l.appendChild(this.container):document.body.appendChild(this.container),this.resize()}}},{key:"handleConfig",value:function(e){void 0!==(null==e?void 0:e.title)?(this.title.style.display="block",this.title.innerText=e.title):this.title.style.display="none",!1===(null==e?void 0:e.allowDecline)&&(0,d.Zs)(this.decline,{display:"none"}),void 0!==(null==e?void 0:e.acceptText)?this.accept.innerText=e.acceptText:this.accept.innerText="OK",void 0!==(null==e?void 0:e.declineText)?this.decline.innerText=e.declineText:this.decline.innerText="Cancel"}}]),e}(),v=new m;function g(e,t,n){void 0===t&&(t=function(){}),v.display(e,t,void 0,n)}function y(e,t,n,i){var o,r;t=null!==(o=t)&&void 0!==o?o:function(){},n=null!==(r=n)&&void 0!==r?r:function(){},v.display(e,t,n,i)}function b(e,t,n){v.display(e,(function(){void 0!==t&&t(),(0,u.SC)("orientationchange",window,v.rotateDismissTeardownHandler)}),void 0,n),(0,u.j9)("orientationchange",window,v.rotateDismissTeardownHandler)}var w=new(function(e){(0,o.Z)(u,e);var t,n,c=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,s.Z)(t);if(n){var o=(0,s.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,r.Z)(this,e)});function u(){return(0,a.Z)(this,u),c.call(this)}return(0,l.Z)(u,[{key:"displayForm",value:function(e,t,n,o,r){var a,l=this;this.cancelActiveForm(),o=null!==(a=o)&&void 0!==a?a:"",(0,i.Z)((0,s.Z)(u.prototype),"display",this).call(this,o,t,n,r);var c=document.createElement("div");(0,d.Zs)(c,{minHeight:void 0!==r&&!0===r.separator?"15px":"0px"}),this.message.appendChild(c),this.form=e,this.message.appendChild(this.form),void 0===(null==r?void 0:r.acceptText)&&(this.accept.innerText="Apply"),!0===(null==r?void 0:r.orange)&&(0,d.Zs)(this.accept,p),this.accept.onclick=function(e){e.stopPropagation(),void 0!==l.yesCallback&&l.yesCallback(l.form),w.teardown()},this.decline.onclick=function(e){e.stopPropagation(),void 0!==l.noCallback&&l.noCallback(),w.teardown()}}},{key:"cancelActiveForm",value:function(){this.active&&(void 0!==this.noCallback&&this.noCallback(),w.teardown())}}]),u}(m));function C(e,t,n,i,o){var r;n=null!==(r=n)&&void 0!==r?r:function(){},w.displayForm(e,t,n,i,o)}},3753:function(e,t,n){"use strict";n.d(t,{BN:function(){return d},GM:function(){return h},I5:function(){return y},Ue:function(){return v},Z2:function(){return w},nw:function(){return f},q0:function(){return g},tt:function(){return b}});var i=n(1976),o=n(2951),r=n(7591),s=n(9492),a=n(7597),l=n(434),c=n(2800),u=n(6767);function d(e){if([".","?","#"].some((function(t){return e.startsWith(t)})))return e;var t="";return null===e.match(/^[a-zA-Z]+:\/\//)&&(t=e.startsWith("/")?"":"/"),"".concat(t).concat(e)}var h=function(e){(0,r.Z)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function c(e){var t;return(0,o.Z)(this,c),t=l.call(this,function(e){switch(e.readyState){case 0:return"request not sent";case 4:switch(e.status){case 0:return"network error";case 400:return"bad request";case 401:return"unauthorized";case 403:return"access denied";case 404:return"not found";case 429:return"request throttled";case 500:return"server error";default:return"unknown status ".concat(e.status)}default:return"unknown ready state ".concat(e.readyState)}}(e)),t.xhr=e,t.toString=function(){return"XhrError: ".concat(t.message)},t.xhrErrorAttributes={status:e.status,reason:e.statusText,readyState:e.readyState},t}return(0,i.Z)(c)}((0,l.Z)(Error));function f(e){return e>=200&&e<=299||1223===e}function p(e,t,n){e.withCredentials=!0,e.onerror=function(){n(new h(e))},e.onload=function(){f(e.status)?t(e):n(new h(e))},e.setRequestHeader("X-Requested-With","XMLHttpRequest")}function m(e,t){var n=Object.keys(t).map((function(e){return function(e,t){return"".concat(e,"=").concat(encodeURIComponent(t))}(e,t[e])})).join("&");return d(""===n?e:"".concat(e,"?").concat(n))}function v(e){return g(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:6e4)[1]}function g(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6e4,i=new XMLHttpRequest;return[i,new Promise((function(o,r){i.open(t,d(e)),p(i,o,r),i.timeout=n,i.send()}))]}(e,"GET",arguments.length>1&&void 0!==arguments[1]?arguments[1]:6e4)}function y(e,t){var n=t instanceof FormData?t:function(e){for(var t=new FormData,n=0,i=Object.keys(e);n<i.length;n++){var o=i[n];t.append(o,e[o])}return t}(t),i=C(n);return void 0===i?error("CSRF token is undefined"):n.set("csrfmiddlewaretoken",i),new Promise((function(t,i){var o=new XMLHttpRequest;o.open("POST",d(e),!0),p(o,t,i),o.send(n)}))}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=C();return new Promise((function(i,o){var r=new XMLHttpRequest;if(r.open("PUT",m(e,t),!0),p(r,i,o),void 0===n)return error("CSRF token is undefined"),void o(new h(r));r.setRequestHeader("X-CSRFToken",n),r.send()}))}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=C();return new Promise((function(i,o){var r=new XMLHttpRequest;if(r.open("DELETE",m(e,t),!0),p(r,i,o),void 0===n)return error("CSRF token is undefined"),void o(new h(r));r.setRequestHeader("X-CSRFToken",n),r.send()}))}function C(e){var t,n=(0,u.sv)("csrftoken");return void 0!==n?n:void 0!==c.J.current.csrftoken?c.J.current.csrftoken:(void 0!==e&&e.has("csrfmiddlewaretoken")&&(t=e.get("csrfmiddlewaretoken")),t)}},2425:function(e,t,n){"use strict";n.d(t,{C5:function(){return _},Dh:function(){return Z},dD:function(){return O},Uh:function(){return L},vA:function(){return U}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(8759),c=n(2018),u=n(2800),d=n(7693),h=n(3753),f=n(391),p=n(4793),m=n(9),v=n(8263),g=n(1794),y=n(1282);function b(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function C(e){var t={name:e.getString("name",!1),template:e.getString("template",!1)},n=e.getAny("layers");if(void 0!==n){var i=n;if(i instanceof Array&&0!==i.length){var o,r=[],s=b(i);try{for(s.s();!(o=s.n()).done;){var a=o.value;r.push(x(JSON.stringify(a)))}}catch(e){s.e(e)}finally{s.f()}t.layers=r}}var l=e.getObjectString("table",!1);if(0!==l.length){var c=function(e){var t=new f.j(e),n={backgroundColor:t.getStringWithNumbers("background-color",!1),color:t.getStringWithNumbers("color",!1),textAlign:t.getStringWithNumbers("text-align",!1),fontStyle:t.getStringWithNumbers("font-style",!1),fontWeight:t.getStringWithNumbers("font-weight",!1)},i=t.getObjectString("row_1",!1);""!==i&&(n.rowOne=k(i));var o=t.getObjectString("row_2",!1);""!==o&&(n.rowTwo=k(o));var r=t.getObjectString("row_3",!1);return""!==r&&(n.rowThree=k(r)),n}(l);t.table=c}return function(e){var t=document.createElement("div");if(t.style.position="absolute",t.style.height="".concat(O,"px"),t.style.width="".concat(L,"px"),t.style.backgroundColor="transparent",t.style.overflow="hidden",t.style.font="1em 'UbuntuRegular', Arial, Helvetica, sans-serif",void 0!==e.layers){var n,i=b(e.layers);try{for(i.s();!(n=i.n()).done;){var o=n.value;"text"===o.layerType?t.appendChild(T(o)):"image"===o.layerType&&(t.appendChild(I(o)),t.style.color="#000000")}}catch(e){i.e(e)}finally{i.f()}}if(void 0!==e.table){var r=function(e){var t=document.createElement("div");t.style.height="".concat(O,"px"),t.style.width="".concat(L,"px"),t.style.backgroundColor=e.backgroundColor,t.style.color=e.color,t.style.fontStyle=e.fontStyle,t.style.fontWeight=e.fontWeight,t.style.textAlign=e.textAlign;for(var n=0,i=[e.rowOne,e.rowTwo,e.rowThree];n<i.length;n++){var o,r=i[n];o=void 0!==r?R(r):R(),t.appendChild(o)}return t}(e.table);t.appendChild(r)}return t}(t)}function x(e){var t=new f.j(e);return{color:t.getStringWithNumbers("color",!1),filename:t.getStringWithNumbers("filename",!1),fontFamily:t.getStringWithNumbers("font-family",!1),fontSize:t.getStringWithNumbers("font-size",!1),fontStyle:t.getStringWithNumbers("font-style",!1),fontWeight:t.getStringWithNumbers("font-weight",!1),height:t.getStringWithNumbers("height",!1),imageUrl:t.getStringWithNumbers("image_url",!1),layerType:t.getStringWithNumbers("type",!1),left:t.getStringWithNumbers("left",!1),maxWidth:t.getStringWithNumbers("max-width",!1),opacity:t.getStringWithNumbers("opacity",!1),text:t.getStringWithNumbers("text",!1),textAlign:t.getStringWithNumbers("text-align",!1),top:t.getStringWithNumbers("top",!1),width:t.getStringWithNumbers("width",!1)}}function k(e){var t=new f.j(e),n={backgroundColor:t.getStringWithNumbers("background-color",!1),color:t.getStringWithNumbers("color",!1),textAlign:t.getStringWithNumbers("text-align",!1),fontStyle:t.getStringWithNumbers("font-style",!1),fontWeight:t.getStringWithNumbers("font-weight",!1)},i=t.getObjectString("col_1",!1);""!==i&&(n.header=S(i));var o=t.getObjectString("col_2",!1);return""!==o&&(n.data=S(o)),n}function S(e){var t=new f.j(e);return{backgroundColor:t.getStringWithNumbers("background-color",!1),color:t.getStringWithNumbers("color",!1),left:t.getStringWithNumbers("left",!1),textAlign:t.getStringWithNumbers("text-align",!1),fontStyle:t.getStringWithNumbers("font-style",!1),fontWeight:t.getStringWithNumbers("font-weight",!1),value:t.getStringWithNumbers("value",!1),width:t.getStringWithNumbers("width",!1)}}function T(e){var t=document.createElement("span");return t.style.position="absolute",t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.style.textOverflow="ellipsis",t.style.lineHeight="normal",t.style.color=e.color,t.style.fontFamily=e.fontFamily,t.style.fontSize=e.fontSize,t.style.fontStyle=e.fontStyle,t.style.fontWeight=e.fontWeight,t.style.left=e.left,t.style.maxWidth=e.maxWidth,t.innerText=e.text,t.style.textAlign=e.textAlign,t.style.top=e.top,t.style.width=e.width,t}function I(e){var t=document.createElement("img");return t.style.position="absolute",t.alt="",t.style.height=e.height,t.src=e.imageUrl,t.style.left=e.left,t.style.top=e.top,t.style.width=e.width,t.style.opacity=e.opacity,t}function R(e){var t=document.createElement("div");if(t.style.height="".concat(O/3,"px"),t.style.lineHeight="".concat(O/3,"px"),t.style.width="".concat(L,"px"),void 0!==e){if(t.style.backgroundColor=e.backgroundColor,t.style.color=e.color,t.style.fontStyle=e.fontStyle,t.style.fontWeight=e.fontWeight,t.style.textAlign=e.textAlign,void 0!==e.header){var n=P(e.header);t.appendChild(n)}if(void 0!==e.data){var i=P(e.data);t.appendChild(i)}}return t}function P(e){var t=document.createElement("div");return t.style.position="absolute",t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.style.textOverflow="ellipsis",t.style.position="absolute",t.style.backgroundColor=e.backgroundColor,t.style.color=e.color,t.style.fontStyle=e.fontStyle,t.style.fontWeight=e.fontWeight,t.style.textAlign=e.textAlign,t.innerText=e.value,t.style.width=e.width,t.style.left=e.left,t}var M=n(9905),A=n(3543),E=n(2974);function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,s.Z)(this,n)}}var L=270,O=69,D=new g.xB("panelUpdated"),U=(0,y.L)("MultiAppPanel"),Z=function(e){(0,r.Z)(n,e);var t=B(n);function n(){var e;return(0,i.Z)(this,n),(e=t.call(this)).panelUpdated=D,e.hasContent=!0,e.bcpFallback=!1,e.element.style.width="320px",e.element.style.height="".concat(O,"px"),e.element.style.position="relative",e.element.style.overflow="",p.kN.listen((function(t){e.roomUid=t.dossier.roomUid,e.getInitialPanel(!0),e.chatConnection=t.chatConnection,t.chatConnection.event.refreshPanel.listen((function(t){void 0===t||void 0===t.appId||void 0===t.appSystem?e.getInitialPanel(!1):e.refreshPanel(t.appId,t.appSystem)}))})),E.S.changeVideoMode.listen((function(t){t.currentMode!==t.previousMode&&"split"===t.currentMode&&e.getInitialPanel(!1)})),e.appPanelWrapper=document.createElement("div"),e.appPanelWrapper.style.height="".concat(O,"px"),e.appPanelWrapper.style.overflow="hidden",e.appPanelWrapper.style.boxSizing="border-box",e.appPanel=(new F).element,e.appPanelWrapper.appendChild(e.appPanel),e.element.appendChild(e.appPanelWrapper),(0,d.j9)("message",window,(function(t){"webc-bcp-fallback"===t.data&&(e.bcpFallback=!0,e.chatConnection.event.refreshPanel.fire(void 0))})),e.setupListeners(),e}return(0,o.Z)(n,[{key:"getAppIndex",value:function(e){if(void 0===e)return-1;for(var t=0;t<this.panelList.length;t++)if(e===this.panelList[t].id)return t;return-1}},{key:"getInitialPanel",value:function(e){var t=this;(0,c.Sd)(this.roomUid,this.bcpFallback).then((function(n){t.reset(n,e)})).catch((function(){}))}},{key:"reset",value:function(e,t){this.clear(),this.hasContent=!0;var n=(0,c.Bk)(e);if(this.panelList=n.appList,this.panelList.length>0){var i,o=this.getAppIndex(null===(i=this.currentApp)||void 0===i?void 0:i.id);-1===o&&(o=0),this.currentApp=this.panelList[o],void 0===n.error?this.appPanel=new F(e,t).element:(this.hasContent=!1,this.appPanel=(new F).element)}else this.currentApp=void 0,this.hasContent=!1,this.appPanel=(new F).element;this.appPanelWrapper.appendChild(this.appPanel),this.panelUpdated.fire(void 0)}},{key:"extendPanel",value:function(){this.appPanel.style.position="absolute",this.appPanel.style.zIndex="1000",this.appPanel.style.height="".concat(337,"px")}},{key:"shrinkPanel",value:function(){this.appPanel.style.position="static",this.appPanel.style.zIndex="auto",this.appPanel.style.height="".concat(O,"px")}},{key:"setupListeners",value:function(){var e=this;(0,v.nH)(this.appPanelWrapper,!0).listen((function(t){t&&void 0!==e.currentApp?e.extendPanel():e.shrinkPanel()})),(0,l.Tt)()&&window.setInterval((function(){e.element.contains(document.activeElement)&&void 0!==e.currentApp?e.extendPanel():e.shrinkPanel()}),300)}},{key:"previous",value:function(){var e,t=this.getAppIndex(null===(e=this.currentApp)||void 0===e?void 0:e.id);t<1||(this.currentApp=this.panelList[t-1],this.refreshPanel(this.currentApp.id,this.currentApp.panelType))}},{key:"next",value:function(){var e,t=this.getAppIndex(null===(e=this.currentApp)||void 0===e?void 0:e.id);t!==this.panelList.length-1&&(this.currentApp=this.panelList[t+1],this.refreshPanel(this.currentApp.id,this.currentApp.panelType))}},{key:"refreshPanel",value:function(e,t){var n=this;(0,c.Sd)(this.roomUid,this.bcpFallback,e,t).then((function(t){var i,o=(0,c.Bk)(t);n.panelList=o.appList,void 0===o.error||(null===(i=n.currentApp)||void 0===i?void 0:i.id)!==e?n.reset(t,!1):n.getInitialPanel(!1)})).catch((function(){}))}},{key:"removeDOMChildren",value:function(e){for(;null!==e.firstChild;)e.removeChild(e.firstChild)}},{key:"clearAppPanel",value:function(){this.removeDOMChildren(this.appPanelWrapper)}},{key:"clear",value:function(){this.clearAppPanel()}}]),n}(m.w),F=function(e){(0,r.Z)(n,e);var t=B(n);function n(e){var o,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(0,i.Z)(this,n),(o=t.call(this)).previewTime=5e3,o.element.style.position="relative",o.element.style.display="inline-block",o.element.style.width="".concat(L,"px"),o.element.style.overflow="hidden",o.element.style.textShadow="none",o.element.style.fontSize="11px",o.element.style.lineHeight="1.7em",o.update(e,r),o}return(0,o.Z)(n,[{key:"update",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.cleanupPanel(),void 0===e)return this.panel=(0,M.x)(),void this.element.appendChild(this.panel);var n=(0,c.Bk)(e);void 0!==n.url?(this.element.style.width="320px",this.prepareIframePanel(n.url,t)):this.panel=this.createHTMLPanel(n.template,e),this.element.appendChild(this.panel)}},{key:"prepareIframePanel",value:function(e,t){var n=this;u.J.current.isBroadcast&&t?(this.preview=document.createElement("div"),this.preview.style.width="320px",this.preview.style.height="69px",this.preview.style.textAlign="center",this.preview.style.lineHeight="5em",this.preview.style.fontSize="14px",this.preview.style.fontWeight="bold",this.preview.style.boxShadow="inset 0 0 100px 10px rgba(0, 0, 0, 0.32)",this.preview.innerText=A.ag.loadingPreview,this.element.appendChild(this.preview),this.panel=this.createIframePanel(""),this.panel.style.display="none",this.previewTimer=window.setTimeout((function(){n.element.removeChild(n.preview),n.panel.src=e,n.panel.style.display="block"}),this.previewTime)):this.panel=this.createIframePanel(e)}},{key:"createHTMLPanel",value:function(e,t){switch(e){case"image_template":return C(t);case"3_rows_11_21_31":case"3_rows_11_22_32":case"3_rows_12_21_31":case"3_rows_12_22_31":case"3_rows_of_labels":return(0,M.x)(t);default:return warn("template of type (".concat(e,"): is not supported")),(0,M.x)()}}},{key:"createIframePanel",value:function(e){var t=this,n=document.createElement("iframe");return n.id="appPanelFrame",n.src=e,n.style.border="none",n.style.padding="0",n.style.background="#FFFFFF",n.style.width="100%",n.style.height="100%",(0,v.nH)(n).listen((function(e){t.element.style.filter=e?"drop-shadow(0px 0px 16px rgba(0, 0, 0, 0.3))":""})),(0,l.Tt)()&&window.setInterval((function(){t.element.contains(document.activeElement)?t.element.style.filter="drop-shadow(0px 0px 16px rgba(0, 0, 0, 0.3))":t.element.style.filter=""}),300),n}},{key:"cleanupPanel",value:function(){clearTimeout(this.previewTimer),this.removeAllDOMChildren()}}]),n}(m.w),_=function(e){(0,r.Z)(n,e);var t=B(n);function n(){var e;return(0,i.Z)(this,n),(e=t.call(this)).panelUpdated=new g.xB("panelUpdated"),e.hasContent=!1,e.element.style.display="inline-block",e.element.style.paddingLeft="5px",e.element.style.paddingTop="3px",e.element.style.paddingRight="5px",e.element.style.paddingBottom="3px",e.element.style.position="",e.element.style.width="".concat(L,"px"),e.element.style.height="".concat(O,"px"),e.element.style.textShadow="none",e.element.style.fontSize="11px",e.element.style.lineHeight="1.7em",e.element.style.overflow="hidden",p.kN.listen((function(t){e.updateAppPanel(t.chatConnection.room()),t.chatConnection.event.refreshPanel.listen((function(){e.updateAppPanel(t.chatConnection.room())})),t.chatConnection.event.clearApp.listen((function(){e.updateAppPanel(t.chatConnection.room())}))})),e.appPanelTable=(0,M.x)(),e.element.appendChild(e.appPanelTable),e}return(0,o.Z)(n,[{key:"updateAppPanel",value:function(e){var t=this;(0,h.Ue)("api/panel_context/".concat(e,"/")).then((function(e){t.cleanupPanel();var n=new f.j(e.responseText);if("no-content"===n.getString("code",!1))return t.hasContent=!1,t.appPanelTable=(0,M.x)(),t.element.appendChild(t.appPanelTable),void t.panelUpdated.fire(void 0);t.hasContent=!0;var i=n.getString("template",!1);switch(i){case"image_template":t.appPanelTable=C(n);break;case"3_rows_11_21_31":case"3_rows_11_22_32":case"3_rows_12_21_31":case"3_rows_12_22_31":case"3_rows_of_labels":t.appPanelTable=(0,M.x)(n);break;default:t.hasContent=!1,t.appPanelTable=(0,M.x)(),warn("template of type (".concat(i,"): is not supported"))}n.logUnusedDebugging("updateAppPanel"),t.element.appendChild(t.appPanelTable),t.panelUpdated.fire(void 0)})).catch((function(e){error("Error fetching app panel",e)}))}},{key:"cleanupPanel",value:function(){this.element.children.length>0&&this.element.removeChild(this.appPanelTable)}}]),n}(m.w)},6297:function(e,t,n){"use strict";n.d(t,{V:function(){return a},h:function(){return l}});var i=n(2951),o=n(1976),r=n(2425),s=n(4793),a=2e3,l=function(){function e(t){var n=this;(0,i.Z)(this,e),this.config=t,this.appPanel=new r.C5,this.appPanel.element.style.width="".concat(r.Uh,"px"),this.appPanel.element.style.position="relative",this.hasContent=!1,this.canUpdatePanel=!1,s.kN.listen((function(e){n.hasContent=!1,n.canUpdatePanel=!1,n.appPanelLastId=void 0,n.lastClone=void 0,window.setTimeout((function(){n.canUpdatePanel=!0,n.hasContent&&n.updatePanel()}),a)})),this.appPanel.panelUpdated.listen((function(){n.hasContent=!0,n.canUpdatePanel&&n.updatePanel()}))}return(0,o.Z)(e,[{key:"updatePanel",value:function(){var e=this;if(this.appPanel.hasContent){if(void 0!==this.lastClone){for(var t=0;t<this.lastClone.children.length;t+=1)this.lastClone.removeChild(this.lastClone.children.item(t));this.lastClone.appendChild(this.cloneAppPanel())}if(void 0===this.appPanelLastId)return this.config.appendMessageDiv(this.appPanel.element,(function(){return e.pureChatCloner()})),void(this.appPanelLastId=this.config.getLastMessageId());var n=this.appPanel.element.offsetTop-this.config.getMessagesScrollTop();(n<0||n>this.config.getMessagesOffsetHeight()-30)&&this.config.messagesSinceId(this.appPanelLastId)>20&&(this.config.removeMessageDiv(this.appPanel.element),this.config.appendMessageDiv(this.appPanel.element,(function(){return e.pureChatCloner()})),this.appPanelLastId=this.config.getLastMessageId())}}},{key:"cloneAppPanel",value:function(){var e=this.appPanel.element.cloneNode(!0);return e.style.width="".concat(r.Uh,"px"),e}},{key:"pureChatCloner",value:function(){return void 0!==this.lastClone&&null!==this.lastClone.parentNode&&this.lastClone.parentNode.removeChild(this.lastClone),this.lastClone=document.createElement("div"),this.lastClone.appendChild(this.cloneAppPanel()),this.lastClone}}]),e}()},391:function(e,t,n){"use strict";n.d(t,{j:function(){return u}});var i=n(4649),o=n(3940),r=n(2951),s=n(1976);function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var u=function(){function e(t){if((0,r.Z)(this,e),this.usedFields={},"string"==typeof t){this.stringMessage=t;try{this.parsed=JSON.parse(t)}catch(e){this.parsed={},error("Cannot JSON parse",{message:t})}}else"object"===(0,o.Z)(t)?(this.parsed=t,this.stringMessage=JSON.stringify(t)):error("Invalid input type",{message:t})}return(0,s.Z)(e,[{key:"keys",value:function(){return Object.keys(this.parsed)}},{key:"unusedFields",value:function(){var e=[];for(var t in this.parsed)!0!==this.usedFields[t]&&e.push(t);return e}},{key:"ignore",value:function(e){this.usedFields[e]=!0}},{key:"getParsed",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.parsed)}},{key:"getAny",value:function(e){if(this.ignore(e),null!==this.parsed[e])return this.parsed[e]}},{key:"getList",value:function(t){if(this.ignore(t),null!==this.parsed[t]&&void 0!==this.parsed[t])return this.parsed[t].map((function(t){return new e(t)}))}},{key:"getStringList",value:function(e){return this.ignore(e),Array.isArray(this.parsed[e])?this.parsed[e].map((function(e){return e})):[]}},{key:"getStringListOrUndefined",value:function(e){if(this.ignore(e),Array.isArray(this.parsed[e]))return this.getStringList(e)}},{key:"getAsString",value:function(e){var t=this.getAny(e);return"".concat(t)}},{key:"getStringOrUndefined",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getAny(e);if("string"==typeof n)return n;t&&void 0!==n&&warn("getStringOrUndefined(".concat(e,"): ").concat(n," is wrong type"),{message:this.stringMessage})}},{key:"getString",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getAny(e);return"string"!=typeof n?(t&&warn("getString(".concat(e,"): ").concat(n," is wrong type"),{message:this.stringMessage}),""):n}},{key:"getStringWithNumbers",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getAny(e);return"string"!=typeof n&&"number"!=typeof n?(t&&warn("getStringWithNumbers(".concat(e,"): ").concat(n," is wrong type"),{message:this.stringMessage}),""):"".concat(n)}},{key:"getStringWithNumbersOrBoolean",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getAny(e);return"string"!=typeof n&&"number"!=typeof n&&"boolean"!=typeof n?(t&&warn("getStringWithNumbersOrBoolean(".concat(e,"): ").concat(n," is wrong type"),{message:this.stringMessage}),""):"boolean"==typeof n?n:"".concat(n)}},{key:"getStrings",value:function(e){var t,n=new Map,i=a(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;void 0!==this.getStringOrUndefined(o,!1)&&n.set(o,this.getStringOrUndefined(o,!1))}}catch(e){i.e(e)}finally{i.f()}return n}},{key:"getBoolean",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.getAny(e);return"boolean"!=typeof i?(n&&warn("getBoolean(".concat(e,"): ").concat(i," is wrong type"),{message:this.stringMessage}),t):i}},{key:"getBooleanOrUndefined",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getAny(e);if("boolean"==typeof n)return n;t&&void 0!==n&&warn("getBoolean(".concat(e,"): ").concat(n," is wrong type"),{message:this.stringMessage})}},{key:"getNumber",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getAny(e);return"number"!=typeof n?(t&&warn("getNumber(".concat(e,"): ").concat(n," is wrong type"),{message:this.stringMessage}),NaN):n}},{key:"getNumberOrUndefined",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getAny(e);if("number"==typeof n)return n;t&&void 0!==n&&warn("getNumberOrUndefined(".concat(e,"): ").concat(n," is wrong type"),{message:this.stringMessage})}},{key:"getParsedSubMap",value:function(t){return new e(this.getObject(t))}},{key:"getParsedSubMapOrUndefined",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.getObjectOrUndefined(t,n);if(void 0!==i)return new e(i)}},{key:"getMap",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.getObjectString(t,n);return new e(""===i?"{}":i)}},{key:"getObjectString",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getAny(e);return"object"!==(0,o.Z)(n)?(t&&warn("getObjectString(".concat(e,"): ").concat(n," is wrong type"),{message:this.stringMessage}),""):JSON.stringify(n)}},{key:"getObjectStringOrUndefined",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getAny(e);if("object"===(0,o.Z)(n))return JSON.stringify(n);t&&void 0!==n&&warn("getObjectStringOrUndefined(".concat(e,"): ").concat(n," is wrong type"),{message:this.stringMessage})}},{key:"getObject",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getAny(e);return"object"!==(0,o.Z)(n)?(t&&warn("getObject(".concat(e,"): ").concat(n," is wrong type"),{message:this.stringMessage}),{}):n}},{key:"getObjectOrUndefined",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getAny(e);if("object"===(0,o.Z)(n))return n;t&&void 0!==n&&warn("getObjectOrUndefined(".concat(e,"): ").concat(n," is wrong type"),{message:this.stringMessage})}},{key:"logUnusedDebugging",value:function(e){var t,n=a(this.unusedFields());try{for(n.s();!(t=n.n()).done;){var i=t.value,r="object"===(0,o.Z)(this.parsed[i])?JSON.stringify(this.parsed[i]):this.parsed[i];debug("Unhandled message argument: . Key:".concat(i," Value:").concat(r," in ").concat(e))}}catch(e){n.e(e)}finally{n.f()}}}],[{key:"fromParsedJson",value:function(t){return warn("ArgJSONMap.fromParsedJson is deprecated. Use `new ArgJSONMap(parsed)` instead."),new e(t)}}]),e}()},8138:function(e,t,n){"use strict";n.d(t,{n:function(){return l}});var i=n(2951),o=n(1976),r=n(8759),s=n(7693),a=n(2750),l=function(){function e(){var t=this;(0,i.Z)(this,e),this.soundMap=new Map,this.supported=!0,this.supported=(0,r.B3)()&&((0,r.BR)()||(0,r.Ii)()),this.init(),(0,s.j9)("beforeunload",window,(function(e){t.close()})),a.UG.listen((function(e){if(e&&(0,r.Tt)()){var n=(0,r.jB)();void 0!==n&&n<13?t.init():void 0!==t.context&&t.context.resume()}}))}return(0,o.Z)(e,[{key:"init",value:function(){var e=this;if(this.supported)if((0,r.BR)()){info("Using audio context"),this.close(),this.ensureContextCreated(!1);var t=function t(){e.playEmptySound(),(0,s.SC)("click",document,t),(0,s.SC)("touchstart",document,t),(0,s.SC)("touchend",document,t)};(0,s.j9)("click",document,t),(0,s.j9)("touchstart",document,t),(0,s.j9)("touchend",document,t)}else info("Using audio elements");else warn("Sounds are not supported.")}},{key:"close",value:function(){void 0!==this.context&&("close"in this.context&&this.context.close(),this.context=void 0)}},{key:"loadSound",value:function(e,t){var n=this;if(this.soundMap.set(e,{ready:!1}),void 0!==this.context){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){i.status<200||i.status>=300?error("Error requesting sound",{soundName:e,status:i.status,statusText:i.statusText}):void 0!==n.context?n.context.decodeAudioData(i.response.slice(0),(function(t){debug("Loaded sound ".concat(e)),n.soundMap.set(e,{ready:!0,buffer:t})}),(function(t){error("Error decoding sound",{soundName:e,message:t})})):n.supported&&error("audioHolder loadSound missing context")},i.onerror=function(){error("Error requesting sound",{soundName:e,status:i.status,statusText:i.statusText})},i.send()}else(0,r.Ii)()&&this.soundMap.set(e,{ready:!0,audioElement:new Audio(t)})}},{key:"loadTipSounds",value:function(){this.loadSound("HugeTip","".concat(STATIC_URL,"sounds/classic/huge.mp3")),this.loadSound("LargeTip","".concat(STATIC_URL,"sounds/classic/large.mp3")),this.loadSound("MediumTip","".concat(STATIC_URL,"sounds/classic/medium.mp3")),this.loadSound("SmallTip","".concat(STATIC_URL,"sounds/classic/small.mp3")),this.loadSound("TinyTip","".concat(STATIC_URL,"sounds/classic/tiny.mp3"))}},{key:"loadPrivateShowSounds",value:function(){this.loadSound("PrivateShow","".concat(STATIC_URL,"sounds/show.mp3"))}},{key:"playSound",value:function(e,t){if(this.canPlaySound(e,t)){var n=this.soundMap.get(e);if(void 0!==n)if(n.ready)if(void 0!==n.buffer){if(this.ensureContextCreated(),void 0===this.context)return void(this.supported&&error("audioHolder playSound missing context"));var i=this.context.createBufferSource();i.buffer=n.buffer;var o=this.context.createGain();i.connect(o),o.connect(this.context.destination),o.gain.value=t/3.5/100,debug("play sound ".concat(e," volume ").concat(t/3.5," (video at ").concat(t,") gain ").concat(o.gain.value)),i.start(0)}else if(void 0!==n.audioElement){n.audioElement.volume=t/100;var r=n.audioElement.play();void 0!==r&&r.catch((function(t){error("Error playing sound ".concat(e," (").concat(t,")"))}))}else error("Missing sound buffer or element for ".concat(e));else warn("sound ".concat(e," not ready yet (and may never will be ready)"))}}},{key:"ensureContextCreated",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.supported&&void 0===this.context&&(e&&warn("audioHolder context unexpectedly missing"),"webkitAudioContext"in window?this.context=new webkitAudioContext:this.context=new AudioContext)}},{key:"canPlaySound",value:function(e,t){return this.supported?0===t?(debug("Not playing sound ".concat(e," at volume 0")),!1):t>100||t<0||isNaN(t)?(error("setSoundVolume: invalid volume ".concat(t)),!1):!!this.soundMap.has(e)||(error("Unknown sound: ".concat(e)),!1):(debug("Not playing sound ".concat(e," because sound is not supported")),!1)}},{key:"playEmptySound",value:function(){if(void 0!==this.context){var e=this.context.createBufferSource();e.buffer=this.context.createBuffer(1,1,22050),e.connect(this.context.destination),e.start(0)}}}]),e}()},695:function(e,t,n){"use strict";n.d(t,{Cg:function(){return l},M5:function(){return c},TF:function(){return a}});var i,o=n(2800),r=n(6265),s=n(1522);function a(){var e;return void 0===(null===(e=o.J.current)||void 0===e?void 0:e.loggedInUser)}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Login required",t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;return!!a()&&(void 0!==i&&t?i():(0,s.oB)(e,(function(){(0,r.iW)({fromFeature:o})}),n),!0)}function c(e){i=e}},3423:function(e,t,n){"use strict";n.d(t,{e:function(){return x}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(1185),u=n(2800),d=n(7693),h=n(3753),f=n(4793),p=n(8069),m=n(8263),v=n(1794),g=n(5108),y=n(7108),b=n(758);function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var C=[40,37,39,38,13,27,32,9],x=function(e){(0,s.Z)(x,e);var t,n,y=(t=x,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function x(e){var t;return(0,i.Z)(this,x),(t=y.call(this)).config=e,t.cacheTTL=-1,t.throttledGetData=new p.d((function(){t.getData().then((function(e){var n;t.items=t.parseResponse(e.responseText),t.cache.set(t.prefix,t.items);var i=null!==(n=t.inputMatch())&&void 0!==n?n:[];t.updateList(i[1])})).catch((function(e){error("Error autocomplete modal",e)}))}),{bounceLimitMS:200,debounceType:2}),t.overlayClick.listen((function(){void 0!==t.selectedIndex&&(t.config.inputElement.appendText(" "),t.config.inputElement.focus()),t.hide()})),t.initEventListeners(),t}return(0,o.Z)(x,[{key:"initEventListeners",value:function(){var e=this;(0,d.j9)("keyup",this.config.inputElement.element,(function(t){e.config.inputElement.getAvailableLength()>e.maxOptionLength&&e.config.inputElement.caretAtEndOfInput()&&e.handleKeyup(t)})),(0,d.j9)("keydown",this.config.inputElement.element,(function(t){e.handleKeydown(t)}))}},{key:"handleKeyup",value:function(e){this.handleInputChange(e)}},{key:"handleKeydown",value:function(e){this.visible&&(38===e.keyCode&&(e.preventDefault(),this.scrollList(!0)),40===e.keyCode&&(e.preventDefault(),this.scrollList(!1)),[9,39,32,13].includes(e.keyCode)&&(e.preventDefault(),e.stopPropagation(),this.hide(),u.J.current.isMobile&&13===e.keyCode||this.config.inputElement.appendText(" ")),27!==e.keyCode&&37!==e.keyCode||(e.preventDefault(),this.hide(),this.deleteHighlightedSuffix()))}},{key:"initData",value:function(){(0,r.Z)((0,l.Z)(x.prototype),"initData",this).call(this),this.list=document.createElement("div"),this.textBeforeItem="",this.visible=!1,this.listenerGroup=new v.mM,this.initDelay()}},{key:"initUI",value:function(){(0,r.Z)((0,l.Z)(x.prototype),"initUI",this).call(this),(0,c.vP)(this.element,"autocompleteModal"),this.element.style.visibility="hidden",this.element.style.width="auto",this.element.style.maxWidth="260px",this.element.style.height="auto",this.element.style.borderWidth="1px",this.element.style.borderStyle="solid",this.element.style.borderBottom="none",this.element.style.fontFamily="Helvetica, Arial, sans-serif",this.element.style.cursor="pointer",this.list.style.width="auto",this.list.style.maxHeight="180px",this.list.style.overflowY="scroll",this.element.appendChild(this.list)}},{key:"dispose",value:function(){this.listenerGroup.removeAll()}},{key:"initDelay",value:function(){var e=this;this.delay=parseInt(u.q.getState().userChatSettings.emoticonAutocompleteDelay),f.kN.listen((function(t){e.delay=parseInt(t.dossier.userChatSettings.emoticonAutocompleteDelay)})).addTo(this.listenerGroup),b.gO.listen((function(t){e.delay=parseInt(t.emoticonAutocompleteDelay)})).addTo(this.listenerGroup)}},{key:"repositionChildren",value:function(){var e=this.config.inputElement.caretXPos(!0)+this.config.leftOffset,t=this.config.inputElement.element.clientWidth-this.config.rightOffset;this.element.style.left="".concat(Math.max(4,Math.min(e,t)),"px")}},{key:"handleInputChange",value:function(e){if(this.delay>=0&&!this.isSpecialFunctionKey(e)){var t=this.inputMatch();if(null!==t){if(this.prefix=t[2],void 0!==this.maxPrefixLength&&this.prefix.length>this.maxPrefixLength)return void warn("Autocomplete prefix >".concat(this.maxPrefixLength," chars. Not updating."));var n=this.getCache().get(this.normalizedPrefix());void 0!==n?(this.items=n,this.updateList(t[1])):this.throttledGetData.callFunc()}else this.hide()}}},{key:"getCache",value:function(){return void 0===this.cache&&(this.cache=new g.S(this.filterAfterSize,this.cacheTTL)),this.cache}},{key:"normalizedPrefix",value:function(){return this.prefix}},{key:"inputMatch",value:function(){return this.config.inputElement.getCurrentNodeText().match(this.regex)}},{key:"isSpecialFunctionKey",value:function(e){return-1!==C.indexOf(e.keyCode)}},{key:"updateList",value:function(e){this.clearList(),0===this.items.length?this.element.style.display="none":this.element.style.display="block";for(var t=0;t<this.items.length;t+=1)this.appendItem(this.items[t],t);var n=this.list.children.length<=0?0:this.list.children.item(this.list.children.length-1).offsetTop;this.list.scrollTop=n,this.textBeforeItem=e,this.visible||this.show()}},{key:"clearList",value:function(){for(;null!==this.list.firstChild;)this.list.removeChild(this.list.firstChild);this.selectedIndex=void 0}},{key:"scrollList",value:function(e){this.clearSelection();var t=void 0===this.selectedIndex?e?this.items.length-1:0:this.selectedIndex+(e?-1:1);t<0?t=this.items.length-1:t>=this.items.length&&(t=0),this.pickItem(t,!0)}},{key:"highlightSelectedIndex",value:function(e){if(void 0!==this.selectedIndex&&this.items.length>0){if(this.clearSelection(),(0,c.vP)(this.items[this.selectedIndex].element,"selectedEmoticon"),e){var t=this.list.clientHeight,n=this.list.firstChild.clientHeight;this.list.scrollTop=this.selectedIndex*n-t/2}var i=this.config.inputElement.getCurrentNodeText().replace(new RegExp("".concat(this.previousSlug,"$")),this.items[this.selectedIndex].slug);this.config.inputElement.setCurrentNodeText(i),this.config.inputElement.selectCurrentNodeTail(this.textBeforeItem.length+1)}}},{key:"deleteHighlightedSuffix",value:function(){this.config.inputElement.deleteSelection()}},{key:"show",value:function(){var e=this;this.delay>=0&&window.setTimeout((function(){null!==e.inputMatch()&&(e.element.style.visibility="visible",0===(0,m.gV)(e.element.style.width)&&(e.element.style.width="auto",e.element.style.width="-moz-available",e.element.style.width="-webkit-fill-available",e.element.style.width="fill-available"),e.element.style.height="auto",e.showOverlay(),e.repositionChildrenRecursive(),e.visible=!0)}),this.delay)}},{key:"hide",value:function(){this.hideOverlay(),this.element.style.visibility="hidden",this.element.style.width="0",this.element.style.height="0",this.visible=!1,this.clearList()}},{key:"clearSelection",value:function(){var e,t=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(this.items);try{for(t.s();!(e=t.n()).done;){var n=e.value;(0,c.FU)(n.element,"selectedEmoticon")}}catch(e){t.e(e)}finally{t.f()}}},{key:"getData",value:function(){var e=this,t=new XMLHttpRequest;return new Promise((function(n,i){t.onload=function(){(0,h.nw)(t.status)?n(t):i(new h.GM(t))},t.onerror=function(){i(new h.GM(t))},t.open("GET",e.getDataEndpoint()),t.withCredentials=!1,t.timeout=6e4,t.send()}))}},{key:"appendItem",value:function(e,t){var n=this,i=document.createElement("div");i.style.padding="2px 8px",this.shouldIgnoreItem(e)&&(i.style.display="none"),i.onclick=function(e){n.pickItem(t,!1),e.preventDefault()};var o=document.createElement("div");return o.textContent=e.slug,o.title=e.slug,o.style.overflow="hidden",o.style.textOverflow="ellipsis",i.appendChild(o),this.list.appendChild(i),e.element=i,i}},{key:"pickItem",value:function(e,t){this.previousSlug=void 0===this.selectedIndex?this.prefix:this.items[this.selectedIndex].slug,this.selectedIndex=e,this.highlightSelectedIndex(t),this.config.inputElement.focus()}},{key:"shouldIgnoreItem",value:function(e){return!1}},{key:"isVisible",value:function(){return this.visible}}]),x}(y.B)},8824:function(e,t,n){"use strict";n.d(t,{Z7:function(){return f},lr:function(){return h},nw:function(){return u},rv:function(){return d},uc:function(){return p}});var i=n(2800),o=n(3753),r=n(391),s=n(3705),a=n(8978);function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var u=150;function d(e,t){var n,o=new r.j(e),c={infoSection:{username:t,fanClubCost:o.getNumber("fan_club_cost",!1),isInFanClub:o.getBoolean("fan_club_is_member"),hasFanClub:o.getBoolean("performer_has_fanclub"),fanClubJoinUrl:"".concat(o.getString("fan_club_join_url"),"?source=").concat(null===(n=i.J.current)||void 0===n?void 0:n.PurchaseEventSources.SUPPORTER_SOURCE_JOIN_FAN_CLUB_BUTTON),location:o.getString("location"),interestedIn:o.getObjectString("interested_in"),realName:o.getString("real_name"),sex:(0,a.Qs)(o.getString("sex")),subgender:(0,a.Qs)(o.getString("subgender")),followersCount:o.getNumber("follower_count"),displayAge:o.getNumber("display_age",!1),bodyDecorations:o.getString("body_decorations"),displayBirthday:o.getString("display_birthday",!1),lastBroadcast:o.getStringOrUndefined("time_since_last_broadcast"),smokeDrink:o.getString("smoke_drink"),bodyType:o.getString("body_type"),languages:o.getString("languages"),roomStatus:o.getString("room_status"),needsSupporterToPm:o.getBoolean("needs_supporter_to_pm")},aboutMe:o.getString("about_me"),wishList:o.getString("wish_list"),photoSets:function(e){var t,n=[],i=l(JSON.parse(e));try{for(i.s();!(t=i.n()).done;){var o=t.value,s=new r.j(JSON.stringify(o));n.push({id:s.getNumber("id"),name:s.getString("name"),coverUrl:s.getString("cover_url"),tokens:s.getNumber("tokens"),isVideo:s.getBoolean("is_video"),videoHasSound:s.getBoolean("video_has_sound"),userCanAccess:s.getBoolean("user_can_access"),fanClubOnly:s.getBoolean("fan_club_only"),labelText:s.getString("label_text"),labelColor:s.getString("label_color"),pendingApproval:s.getBoolean("pending_approval",!1,!1),userHasPurchased:s.getBoolean("user_has_purchased")}),s.logUnusedDebugging("parseBioApiResponse.photoset")}}catch(e){i.e(e)}finally{i.f()}return n}(o.getObjectString("photo_sets")),socialMedias:function(e){var t,n=[],i=l(JSON.parse(e));try{for(i.s();!(t=i.n()).done;){var o=t.value,s=new r.j(JSON.stringify(o));n.push({id:s.getNumber("id"),titleName:s.getString("title_name"),imageUrl:s.getString("image_url"),tokens:s.getNumber("tokens"),purchased:s.getBoolean("purchased"),labelText:s.getString("label_text"),labelColor:s.getString("label_color")}),s.logUnusedDebugging("parseBioApiResponse.socials")}}catch(e){i.e(e)}finally{i.f()}return n}(o.getObjectString("social_medias")),gameSelection:function(e){if(void 0!==e)return{description:e.description,gameUrl:e.game_url,image:e.image_64x64,name:e.name,uid:e.uid,viewers:e.viewers}}(o.getObjectOrUndefined("game_selection"))};return o.logUnusedDebugging("parseBioApiResponse.bioParsed"),(0,s.fg)("BioLoaded"),c}function h(e){return new Promise((function(t,n){(0,o.Ue)("api/biocontext/".concat(e,"/")).then((function(n){t(d(n.responseText,e))})).catch((function(e){n(e)}))}))}function f(e,t){(0,s.fg)("PhotoSetClicked",{source:t,photoset_id:e.id,cost:e.tokens,is_video:e.isVideo})}function p(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e.getElementsByTagName("*");t.style.position="relative";var r,s=l(o);try{var a=function(){var e=r.value;if(!(e instanceof HTMLElement))return 1;e.style.position.includes("fixed")&&(e.style.position="absolute");var t=parseInt(e.style.zIndex);if(!isNaN(t)&&t>=100&&(e.style.zIndex="99"),n&&function(e){null!==e.style.top&&parseInt(e.style.top,10)<0&&(e.style.top="0"),null!==e.style.marginTop&&parseInt(e.style.marginTop,10)<0&&(e.style.marginTop="0"),null!==e.style.left&&parseInt(e.style.left,10)<0&&(e.style.left="0"),null!==e.style.marginLeft&&parseInt(e.style.marginLeft,10)<0&&(e.style.marginLeft="0")}(e),i&&"img"===e.tagName.toLowerCase()){var o=e.cloneNode();o.style.visibility="hidden",document.body.appendChild(o),o.onload=function(){e.style.height="".concat(.5*o.offsetHeight,"px"),e.style.width="".concat(.5*o.offsetWidth,"px"),document.body.removeChild(o)},o.onerror=function(){document.body.removeChild(o)}}};for(s.s();!(r=s.n()).done;)a()}catch(e){s.e(e)}finally{s.f()}}},6181:function(e,t,n){"use strict";n.d(t,{q:function(){return R}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(8759),u=n(1185),d=n(9760),h=n(407),f=n(3753),p=n(8824),m=n(7393),v=n(4793),g=n(8263),y=n(5937),b=n(8978),w=n(6422),C=n(758),x=n(3543),k=n(47),S=n(2750);function T(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var R=function(e){(0,s.Z)(I,e);var t,n,m=(t=I,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function I(){var e;return(0,i.Z)(this,I),(e=m.call(this)).customSections=[],(0,u.vP)(e.element,"BioContents"),e.element.dataset.testid="room-bio-tab-contents",e.element.style.width="100%",e.element.style.margin="0 0 14px",e.loadingMsg.style.padding="14px 14px 0",e.errorMsg.style.padding="14px 14px 0",v.jr.listen((function(t){e.loadRoom(t.dossier.room)})),v.kN.listen((function(t){e.loadRoom(t.dossier.room)})),window.refreshSocials=function(){e.load()},e}return(0,o.Z)(I,[{key:"loadRoom",value:function(e){this.room=e,this.setResourceUrl("api/biocontext/".concat(this.room,"/")),this.load()}},{key:"show",value:function(){this.element.style.display="",this.element.style.height="",this.element.style.minHeight="325px",void 0!==this.adjustMargin&&this.adjustMargin(),void 0!==this.adjustWidth&&this.adjustWidth(),this.showingError&&this.load()}},{key:"hide",value:function(){this.element.style.height="0",this.element.style.minHeight="0",this.element.style.margin="0"}},{key:"parseData",value:function(e){return(0,p.rv)(e,this.room)}},{key:"createContent",value:function(e){this.createBioContents(e)}},{key:"clearContent",value:function(){(0,r.Z)((0,l.Z)(I.prototype),"clearContent",this).call(this),this.clearResizeListeners()}},{key:"clearResizeListeners",value:function(){void 0!==this.adjustWidth&&d.nR.removeListener(this.adjustWidth),void 0!==this.adjustMargin&&d.nR.removeListener(this.adjustMargin)}},{key:"createResizeListeners",value:function(){this.clearResizeListeners(),this.adjustWidth=(0,d.FR)(this.labelRef,["width","min-width"],117,150,500,600),this.adjustMargin=(0,d.FR)(this.tableRef,["margin-right","padding-right"],0,14,500,530)}},{key:"repositionChildren",value:function(){var e,t=T(this.customSections);try{for(t.s();!(e=t.n()).done;){var n=e.value;(0,p.uc)(n,this.bioRootWrapper)}}catch(e){t.e(e)}finally{t.f()}}},{key:"createPhotoVideos",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.photoSets.filter((function(e){return e.isVideo})),i=e.photoSets.filter((function(e){return!e.isVideo}));if(n.length>0||t){var o=this.generatePhotoVideoSection(n,e.infoSection.username,"video");this.bioRootElement.appendChild(o)}if(i.length>0||t){var r=this.generatePhotoVideoSection(i,e.infoSection.username);this.bioRootElement.appendChild(r)}}},{key:"createBioContents",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.bioRootWrapper=(0,k.vz)("div",{style:{paddingLeft:(0,y.j$)()?"4px":"14px",overflow:"hidden"}}),this.bioRootElement=(0,k.vz)("table",{style:{tableLayout:"fixed",width:"100%"},ref:function(e){t.tableRef=e}},(0,k.vz)("tr",{style:{height:"1px"}},(0,k.vz)("th",{style:{width:"150px",minWidth:"150px"},ref:function(e){t.labelRef=e}}),(0,k.vz)("th",null)),(0,k.vz)("tr",{style:{verticalAlign:"top"}},(0,k.vz)("th",{colSpan:2},(0,k.vz)("h1",{colorClass:[u.ql.defaultColor,"bioHeader"],style:{fontSize:"".concat(P,".4px"),fontFamily:"UbuntuMedium, Arial, Helvetica, sans-serif",fontWeight:"normal",margin:"10px 0 20px",lineHeight:"20px",textAlign:"left"},ref:function(e){t.header=e},"data-testid":"bio-header"})))),this.bioRootWrapper.appendChild(this.bioRootElement),this.element.appendChild(this.bioRootWrapper),this.createResizeListeners();var i=e.infoSection;if(this.room===i.username){if(this.header.innerText="".concat((0,b.Qs)(this.room),"'s ").concat(x.ag.bioAndFreeWebCamText),this.createSections(i),this.shouldShowSocialMediaSection(e.socialMedias.length)){var o=this.generateSocialMediaSection(e.socialMedias,e.infoSection.username);this.bioRootElement.appendChild(o)}if(this.shouldShowPicsSection(e.photoSets.length)&&this.createPhotoVideos(e,n),e.aboutMe.length>=1){var r=this.generateSectionWithUserHTML(e.aboutMe,x.ag.aboutMeText);(0,w.Wk)(r),this.bioRootElement.appendChild(r),this.afterCustomSectionCreated(r)}if(e.wishList.length>=1){var s=this.generateSectionWithUserHTML(e.wishList,x.ag.wishListText);(0,w.Wk)(s),this.bioRootElement.appendChild(s),this.afterCustomSectionCreated(s)}this.repositionChildren()}}},{key:"createSections",value:function(e){if(""!==e.realName&&this.bioRootElement.appendChild(this.createSection(x.ag.realNameText,e.realName,!1)),this.bioRootElement.appendChild(this.createFollowersSection(e.followersCount)),""!==e.displayBirthday&&this.bioRootElement.appendChild(this.createSection(x.ag.birthdateText,e.displayBirthday,!1)),isNaN(e.displayAge)||this.bioRootElement.appendChild(this.createSection(x.ag.ageText,e.displayAge.toString(),!1)),"A Couple"===e.sex?this.bioRootElement.appendChild(this.createSection(x.ag.sexTextCouple,e.sex,!1)):"Trans"===e.sex&&e.subgender?this.bioRootElement.appendChild(this.createSection(x.ag.sexText,"".concat(e.sex," (").concat(e.subgender,")"),!1)):this.bioRootElement.appendChild(this.createSection(x.ag.sexText,e.sex,!1)),""!==e.interestedIn){var t=e.interestedIn;if(""!==(t=t.slice(1,t.length-1))){for(;t.includes('"');)t=t.replace('"',"");t=t.split(",").join(", "),this.bioRootElement.appendChild(this.createSection(x.ag.interstedInText,t,!1))}}""!==e.location&&this.bioRootElement.appendChild(this.createSection(x.ag.locationText,e.location,!1)),void 0!==e.lastBroadcast&&""!==e.lastBroadcast&&this.bioRootElement.appendChild(this.createSection(x.ag.lastBroadcastText,e.lastBroadcast,!1)),""!==e.languages&&this.bioRootElement.appendChild(this.createSection(x.ag.languagesText,e.languages,!1)),""!==e.bodyType&&this.bioRootElement.appendChild(this.createSection(x.ag.bodyTypeText,e.bodyType,!1)),""!==e.smokeDrink&&this.bioRootElement.appendChild(this.createSection(x.ag.smokeOrDrinkText,e.smokeDrink,!1)),""!==e.bodyDecorations&&this.bioRootElement.appendChild(this.createSection(x.ag.bodyDecorationsText,e.bodyDecorations,!1))}},{key:"createFollowersSection",value:function(e){return this.createSection(x.ag.followersText,isNaN(e)?"0":e.toString(),!1)}},{key:"shouldShowSocialMediaSection",value:function(e){return e>=1}},{key:"shouldShowPicsSection",value:function(e){return e>=1}},{key:"generateSocialMediaSection",value:function(e,t){var n,i=function(e){var n=(new w.dM).anchor,i="/socials/social_media/".concat(t,"/").concat(e.id);n.href=(0,f.BN)(i),n.style.position="relative",n.style.display="inline-block",n.style.marginBottom="17px",n.style.marginRight="5px",n.style.cursor="pointer",n.className="userUpload socialMediaUpload",n.title=e.titleName,(0,g.pY)(n),n.onclick=function(){return(0,S.Pv)(i,void 0,"resizable,dependent,scrollbars,height=700,width=700,top=".concat(screen.height/2-600,",left=").concat(screen.width/2-800)),!1};var o=document.createElement("img");(0,u.vP)(o,"previewBorder"),o.src=e.imageUrl,o.width=M,o.height=A,o.style.borderWidth="1px",o.style.borderStyle="solid",o.style.display="block",o.style.borderRadius="3%",o.style.display="block",n.appendChild(o);var r=document.createElement("span");(0,u.vP)(r,"tokenText"),r.innerText=e.labelText,r.style.backgroundColor=e.labelColor,r.style.position="absolute",r.style.top="80px",r.style.right="8px",r.style.fontSize="9px",r.style.borderRadius="2px",r.style.padding="1px 3px",r.style.lineHeight="12px",n.appendChild(r);var s=document.createElement("div");return(0,u.vP)(s,"link"),s.innerText=e.titleName,s.style.fontSize="".concat(P,"px"),s.style.left="0px",s.style.maxWidth="145px",s.style.whiteSpace="nowrap",s.style.textOverflow="ellipsis",s.style.overflow="hidden",s.style.lineHeight="16px",s.style.textDecoration="none",n.appendChild(s),n},o=[],r=0,s=T(e);try{for(s.s();!(n=s.n()).done;){var a=n.value;if(8===r)break;o.push(i(a)),r+=1}}catch(e){s.e(e)}finally{s.f()}var l=e.length>8;o.push(this.generateSocialMediaLinks(t,l));var c=this.createSection(x.ag.socialMediaText,o);return(0,u.vP)(c,"smContainer"),c}},{key:"generateSocialMediaLinks",value:function(e,t){var n=document.createElement("div");if(n.style.marginBottom="20px",t){var i=(new w.dM).anchor,o="/socials/social_media/list_popup/".concat(e,"/");(0,u.vP)(i,"link"),i.href=(0,f.BN)(o),i.innerText=x.ag.showMoreText,i.style.fontSize="14px",i.style.cursor="pointer",(0,g.pY)(i),i.onclick=function(e){(0,S.Pv)(o,void 0,"resizable,dependent,scrollbars,height=600,width=800,top=".concat(screen.height/2,",left=").concat(screen.width/2)),e.preventDefault()},n.appendChild(i)}return n}},{key:"generatePhotoVideoSection",value:function(e,t){var n,i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"photo",r=function(e){var n=(new w.dM).anchor;n.href=(0,f.BN)("/photo_videos/photoset/detail/".concat(t,"/").concat(e.id)),n.target="_blank",n.style.position="relative",n.style.display="inline-block",n.style.marginBottom="17px",n.style.marginRight="5px",n.style.cursor="pointer",(0,g.pY)(n),n.className="userUpload",(0,c.w1)()||(n.title=e.name),n.onclick=function(t){(0,p.Z7)(e,"BioTab"),i.handlePictureClick(t,e.id,n.href)};var o=document.createElement("img");if((0,u.vP)(o,"previewBorder"),o.src=e.coverUrl,o.width=M,o.height=A,o.style.borderWidth="1px",o.style.borderStyle="solid",o.style.display="block",o.style.borderRadius="3%",o.style.display="block",n.appendChild(o),e.userCanAccess){if(e.userCanAccess&&e.userHasPurchased){var r=document.createElement("span");(0,u.vP)(r,"purchasedBadge"),r.style.backgroundColor="#6d85b5",r.style.color="#fff",r.style.position="absolute",r.style.top="80px",r.style.right="8px",r.style.padding="1px 3px",r.style.lineHeight="12px",r.style.borderRadius="2px",r.style.fontSize="9px",r.textContent=x.ag.purchasedCAPS,n.appendChild(r)}}else{var s=document.createElement("div");s.style.width="".concat(M+1,"px"),s.style.height="".concat(A+1,"px"),s.style.borderRadius="3%",s.style.position="absolute",s.style.left="0px",s.style.top="0px",s.style.backgroundColor="rgba(0, 0, 0, .55)",n.appendChild(s);var a=document.createElement("img");if(a.src="".concat(STATIC_URL,"lock.svg"),a.width=18,a.height=18,a.style.marginLeft="".concat(-9,"px"),a.style.marginTop="".concat(-9,"px"),a.style.position="absolute",a.style.left="50%",a.style.top="40%",a.style.padding="4px",a.style.border="none",n.appendChild(a),""!==e.labelText){var l=document.createElement("span");(0,u.vP)(l,"tokenText"),l.innerText=e.labelText,l.style.backgroundColor=e.labelColor,l.style.position="absolute",l.style.top="80px",l.style.right="8px",l.style.fontSize="9px",l.style.padding="1px 3px",l.style.lineHeight="12px",l.style.borderRadius="2px",n.appendChild(l)}}if(e.isVideo){var d=document.createElement("img");d.src="".concat(STATIC_URL,"video.svg"),d.height=18,d.style.position="absolute",d.style.top="8px",d.style.right="8px",n.appendChild(d)}if(e.isVideo&&!e.videoHasSound&&!e.pendingApproval){var m=document.createElement("img");m.src="".concat(STATIC_URL,"no-audio.svg"),m.height=18,m.style.position="absolute",m.style.top="8px",m.style.right="32px";var v=(0,h.T)({content:"".concat(x.ag.audioRemovedText),hasHTML:!1,width:175,divotPosition:1,divotLeftOrTop:"90px"});v.style.textAlign="center";var y=document.createElement("span");v.appendChild(y),n.appendChild(v),m.onmouseenter=function(){v.style.display="block",v.style.left="12px",v.style.top="-32px"},m.onmouseleave=function(){v.style.display="none"},n.appendChild(m)}var b=document.createElement("div");return(0,u.vP)(b,"link"),b.innerText=e.name,b.style.fontSize="".concat(P,"px"),b.style.left="0px",b.style.maxWidth="145px",b.style.whiteSpace="nowrap",b.style.textOverflow="ellipsis",b.style.overflow="hidden",b.style.lineHeight="16px",b.style.textDecoration="none",n.appendChild(b),n},s=[],a=0,l=T(e);try{for(l.s();!(n=l.n()).done;){var d=n.value;if(8===a)break;s.push(r(d)),a+=1}}catch(e){l.e(e)}finally{l.f()}var m,v=e.length>8;v&&(m=e[0].id);var y=this.generatePicsLinks(t,v,o,m);y.style.marginBottom="20px",s.push(y);var b=this.createSection("video"===o?x.ag.vidsText:x.ag.picsText,s);return(0,u.vP)(b,"psContainer"),b}},{key:"handlePictureClick",value:function(e,t,n){C.jS.fire(t),e.preventDefault()}},{key:"generatePicsLinks",value:function(e,t){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=document.createElement("div");if(t){var o=(new w.dM).anchor;o.href=(0,f.BN)("/photo_videos/photoset/list_popup/".concat(e,"/")),(0,u.vP)(o,"link"),o.innerText=x.ag.showMoreText,o.style.fontSize="14px",o.style.cursor="pointer",(0,g.pY)(o),o.onclick=function(e){C.jS.fire(n),e.preventDefault()},i.appendChild(o)}return i}},{key:"createSection",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,k.vz)("tr",{style:{fontSize:"".concat(P,"px"),fontWeight:"normal",lineHeight:"15px",verticalAlign:"top",textAlign:"left"}},(0,k.vz)("td",{colorClass:"label",style:{paddingBottom:"9px",fontFamily:"UbuntuMedium, Arial, Helvetica, sans-serif",height:"16px"}},(0,k.vz)("span",null,e,":")),(0,k.vz)("td",{colorClass:"contentText",style:{fontSize:"".concat(P,"px"),lineHeight:"16px",fontFamily:"UbuntuRegular, Arial, Helvetica, sans-serif"},ref:function(e){if("string"==typeof t)if(n){var i=(0,k.vz)("div",null);e.appendChild(i),i.innerHTML=t,0!==i.children.length&&(i.children[0].style.display="unset")}else e.innerText=t;else t.forEach((function(t){e.appendChild(t)}))}}))}},{key:"generateSectionWithUserHTML",value:function(e,t){return this.createSection((0,b.Qs)(t),e,!0)}},{key:"afterCustomSectionCreated",value:function(e){this.customSections.push(e),(0,p.uc)(e,this.bioRootWrapper)}}]),I}(m.d),P=14,M=150,A=100},7611:function(e,t,n){"use strict";n.d(t,{c:function(){return p}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(1185),c=n(6767),u=n(8263),d=n(9874),h=n(47);var f="broadcast_terms",p=function(e){(0,r.Z)(p,e);var t,n,d=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function p(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return(0,i.Z)(this,p),e=d.call(this,{easyExit:!1}),(0,u.Zs)(e.element,{position:"fixed",overflow:"hidden",height:"auto",maxWidth:"1000px",minWidth:"450px",width:"90%",top:"50%",transform:"translateY(-50%)",left:"0px",right:"0px",margin:"auto",padding:"20px",borderWidth:"2px",borderStyle:"solid",borderRadius:"20px",zIndex:1e4}),(0,l.vP)(e.element,"broadcastTermsModal"),e.overlay.style.background="",t?((0,l.vP)(e.overlay,"blackOverlay"),e.overlayClickStayOpen=!0):((0,l.vP)(e.overlay,"transparentOverlay"),e.overlayClick.listen(o)),e.element.appendChild(e.createHeader()),e.element.appendChild(e.createBody()),e.element.appendChild(e.createAcceptButton(n)),e}return(0,o.Z)(p,[{key:"createHeader",value:function(){return(0,h.vz)("div",{colorClass:"header"},(0,h.vz)("h3",{style:{textAlign:"center"}},"WARNING:  THIS SITE HAS A ZERO TOLERANCE POLICY ON UNDERAGE BROADCASTING."))}},{key:"createBody",value:function(){var e={textDecoration:"underline",fontWeight:"bold"};return this.body=(0,h.vz)("div",{style:{height:"200px",overflow:"auto",padding:"0 15px 0 10px",borderWidth:"1px",borderStyle:"solid",margin:"0 auto",textAlign:"left"},colorClass:"body"},(0,h.vz)("p",null,"The Chaturbate service is for use by adults only.  By clicking the link below, you are affirming your representation and warranty to us that:"),(0,h.vz)("ol",null,(0,h.vz)("li",null,'You are at least 18 years old or the age of majority in your jurisdiction, whichever is older (the "Age of Majority");'),(0,h.vz)("li",null,"Anyone appearing on camera with you has also reached the Age of Majority;"),(0,h.vz)("li",null,"At no time will anyone who has not reached the Age of Majority be present while you are using the Chaturbate service;"),(0,h.vz)("li",null,"You will not permit anyone who has not reached the Age of Majority to use the Chaturbate service; and"),(0,h.vz)("li",null,"You will immediately report by email to ",(0,h.vz)("a",{href:"mailto:support@chaturbate.com"},"support@chaturbate.com")," any and all instances you become aware of wherein an individual has used the Chaturbate service without first reaching the Age of Majority."),(0,h.vz)("li",null,"Obviously, you consent to and request your image being broadcast on the Chaturbate platform."),(0,h.vz)("li",null,"You agree that you will be governed by the Chaturbate Terms and by the Chaturbate Broadcaster Agreement."),(0,h.vz)("li",null,"You agree that only age verified broadcasters associated with this room may broadcast in this room.")),(0,h.vz)("p",null,"If we suspect, in our sole discretion, that you are using the Chaturbate service without having complied in every respect with the foregoing statements, your account ",(0,h.vz)("span",{style:e},"will")," be terminated immediately, and we ",(0,h.vz)("span",{style:e},"will")," report your conduct to law enforcement.")),this.body}},{key:"createAcceptButton",value:function(e){var t=this;return(0,h.vz)("div",{style:{textAlign:"center",color:"#222"}},(0,h.vz)("a",{style:{width:"200px",height:"30px",lineHeight:"30px",fontWeight:"bold",margin:"10px 5px 0px 5px",borderWidth:"1px",borderStyle:"solid",display:"inline-block",textAlign:"center",cursor:"pointer"},"data-testid":"agree-broadcast-terms-button",colorClass:"acceptLink",ref:function(e){t.acceptLink=e},onClick:function(n){n.stopPropagation(),t.hide(),(0,c.C)(f,"1",7),e()}},"I AGREE"))}}],[{key:"areTermsAccepted",value:function(){return"1"===(0,c.ve)(f)}}]),p}(d.z)},8498:function(e,t,n){"use strict";n.d(t,{Q:function(){return L},B:function(){return O}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(8759),c=n(7906),u=n(1185),d=n(1522),h=n(3753),f=n(9),p=n(1794),m=n(3544),v=n(2239),g=n(3543),y=n(1289);function b(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function C(e){var t,n=0,i=b(e);try{for(i.s();!(t=i.n()).done;)n+=t.value}catch(e){i.e(e)}finally{i.f()}return n/e.length}function x(e){return Math.sqrt(function(e){var t,n=C(e),i=[],o=b(e);try{for(o.s();!(t=o.n()).done;){var r=t.value;i.push(Math.abs(r-n))}}catch(e){o.e(e)}finally{o.f()}return Math.sqrt(C(i))}(e))}var k=n(1903),S={9:"H.263",7:"H.264",12:"H.265",8:"VPX"},T={11:"Speex",12:"Opus",2:"MP3",10:"AAC",1:"AC3",9:"Vorbis"},I={480:800,576:1200,720:3e3,1080:5e3,1440:8e3,2160:12e3},R={480:900,576:3e3,720:5e3,1080:7500,1440:11e3,2160:18e3},P=function(e,t){return null==e?t:e},M=window.SmoothieChart,A=window.TimeSeries,E=function(){function e(){(0,i.Z)(this,e),this.started=!1,this.closed=!1,this.fpsData=[],this.MAX_FPS_LENGTH=40,this.bitrateData=[],this.MAX_BITRATE_LENGTH=100,this.lastUpdate=0,this.lastWidth=0,this.lastHeight=0,this.streamTime=0,this.infoInterval=0,this.streamDataUpdate=new p.xB("streamDataUpdate",{listenersWarningThreshold:1}),this.pollingStatusUpdate=new p.xB("pollingStatusUpdate",{listenersWarningThreshold:1}),this.startPollingEvent=new p.xB("streamWatcherStartPolling",{listenersWarningThreshold:1}),this.closeEvent=new p.xB("streamWatcherClose",{listenersWarningThreshold:1})}return(0,o.Z)(e,[{key:"processData",value:function(e){var t=P(e.fps,0),n=P(e.bitrate,0),i=P(e.region,""),o=P(e.host,""),r=P(e.streamType,"obs");this.streamTime=P(e.secondsOnline,0),this.lastWidth=P(e.videoWidth,0),this.lastHeight=P(e.videoHeight,0),this.lastHeight>0&&(this.lastRatio=this.lastWidth/this.lastHeight);var s=P(e.videoCodecString,P(S[P(e.videoCodec,"")],"Unknown")),a=P(e.audioCodecString,P(S[P(e.audioCodec,"")],"Unknown"));this.transcodeCount=P(e.transcodeCount,void 0),this.fpsData.push(t),this.bitrateData.push(n),this.fpsData.length>this.MAX_FPS_LENGTH&&this.fpsData.shift(),this.bitrateData.length>this.MAX_BITRATE_LENGTH&&this.bitrateData.shift(),this.fpsSeries.append((new Date).getTime(),t),this.bitrateSeries.append((new Date).getTime(),n),this.streamDataUpdate.fire({host:o,region:i,streamType:r,fps:Math.round(t),bitrate:Math.round(n),streamTime:(0,k.WQ)(this.streamTime),videoWidth:this.lastWidth,videoHeight:this.lastHeight,videoCodec:s,audioCodec:a}),this.lastUpdate=(new Date).getTime()}},{key:"statusMessage",value:function(){var e,t,n=[],i=[],o=[],r=0,s=!1,a=0,l=0;if(this.lastHeight>0){for(var c in I)I.hasOwnProperty(c)&&this.lastHeight>=Number(c)&&(e=I[c],t=R[c]);this.lastHeight<480&&this.streamTime<120&&this.streamTime>2?i.push("Your stream resolution is lower than the recommended minimum of 480 pixels, we suggest you increase your stream resolution"):this.lastHeight<720&&this.streamTime>2&&o.push("Note: Your stream is <strong>not</strong> HD, a minimum height of 720 pixels is required."),void 0!==this.lastRatio&&this.lastRatio<1.7&&this.streamTime<120&&this.streamTime>2&&(i.push("Your stream is not widescreen. We recommend all streams to be widescreen (16:9 ratio) with external encoders"),r+=1)}void 0!==this.transcodeCount&&this.streamTime>10&&this.transcodeCount<3&&n.push("Error handling your stream, please restart it and contact support if this persists.");var u=0,d=30,h=30;this.fpsData.length>0&&(u=x(this.fpsData.slice(-100)),d=C(this.fpsData.slice(-10)),h=C(this.fpsData.slice(-5)));var f=e;if(h>45&&d>45&&(s=!0,f=t),void 0!==f&&this.streamTime>5){var p=x(this.bitrateData.slice(-100)),m=C(this.bitrateData.slice(-10)),v=C(this.bitrateData.slice(-5));m>.01&&m<.95*f&&v<.95*f?m<.7*f&&v<.7*f?s?n.push("Your bitrate is much lower than the recommended minimum of ".concat(f,"kbps for this resolution at a high frame rate. You may need to switch to a standard frame rate.")):n.push("Your bitrate is much lower than the recommended minimum of ".concat(f,"kbps for this resolution.")):s?i.push("Your bitrate is lower than the recommended minimum of ".concat(f,"kbps for this resolution at a high frame rate. You may need to switch to a standard frame rate.")):i.push("Your bitrate is lower than the recommended minimum of ".concat(f,"bps for this resolution.")):p>m/8&&this.streamTime>50&&this.bitrateData.length>20?(r+=1,i.push("Your bitrate is unstable which can indicate a poor connection.")):m>1.5*f&&o.push("Your bitrate is very good!"),a=v<.7*f?1:v<.95*f?2:0}else a=0;h>.01&&d<21&&h<21&&this.streamTime>5?d<15&&h<15?n.push("Your frame rate is much lower than the recommended minimum of 24 fps"):i.push("Your frame rate is lower than the recommended minimum of 24 fps"):h>45&&d>45?this.streamTime<120&&this.streamTime>2&&o.push("You are broadcasting with a high frame rate. Please only use this if your camera is set to a high frame rate."):h>62&&d>62?n.push("Your frame rate is higher than the maximum of 60 fps. This will result in a poor stream output."):u>6&&this.streamTime>30&&this.fpsData.length>20?(r+=1,i.push("Your fps is very unstable. Your encoder may be overloaded.")):u>3&&this.streamTime>30&&this.fpsData.length>20&&(r+=1,i.push("Your fps is unstable. Your encoder may be overloaded.")),this.streamTime>5&&this.fpsData.length>20&&(l=h<15?1:h>63||h>33&&h<45||h<21?2:0),this.lastUpdate>0&&(new Date).getTime()-this.lastUpdate>1e4&&i.push("Unable to get quality information, please contact support if this persists. Your stream is not affected.");var g,y=0,b="",w=[];n.length>0?(b="Alert",w=n.slice(0,2),y=1):i.length>0?(b="Warning",w=i.slice(0,2),y=2):o.length>0||this.streamTime>10?(b="Your stream is good",w=o.length>0?o.slice(0,2):["No issues to report"],y=3):y=0;var k="",S="",T=i.length-r;this.lastHeight>=2160&&T<1&&0===n.length?(g=3,k="4K",S="4K"):this.lastHeight>=1080&&T<1&&0===n.length?(g=2,k="HD+",S="Full High Definition"):this.lastHeight>=720&&T<1&&0===n.length?(g=1,k="HD",S="High Definition"):(g=0,k="SD",S="Standard Definition"),this.pollingStatusUpdate.fire({feedbackHeader:b,feedbackMessages:w,feedbackType:y,resolutionTitle:S,resolutionType:g,resolutionText:k,bitrateFeedback:a,fpsFeedback:l})}},{key:"startPolling",value:function(){var e=this;if(this.startPollingEvent.fire(void 0),!this.started){this.started=!0;var t={millisPerPixel:90,maxValueScale:1.3,grid:{fillStyle:"rgba(209, 209, 209, 0.69)",strokeStyle:"rgba(141, 142, 126, 0.82)",sharpLines:!0,borderVisible:!0,millisPerLine:6e3,verticalSections:2},labels:{fillStyle:"rgba(35, 34, 34, 0.79)",fontSize:10,precision:0},minValue:0,responsive:!0};this.fpsChart=new M(t),this.fpsSeries=new A,this.fpsChart.addTimeSeries(this.fpsSeries,{lineWidth:1.2,strokeStyle:"#033E58"}),this.fpsChart.streamTo(document.getElementById("fps_chart"),2e3),this.bitrateChart=new M(t),this.bitrateSeries=new A,this.bitrateChart.addTimeSeries(this.bitrateSeries,{lineWidth:1.2,strokeStyle:"#033E58"}),this.bitrateChart.streamTo(document.getElementById("bitrate_chart"),2e3),this.infoInterval=window.setInterval((function(){e.statusMessage()}),1500)}}},{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){this.started||(this.closed=!1,this.startPolling())}},{key:"close",value:function(){!this.closed&&this.started&&(this.closed=!0,this.started=!1,this.closeEvent.fire(void 0),this.fpsChart.stop(),this.bitrateChart.stop(),clearInterval(this.infoInterval))}},{key:"reset",value:function(){this.isStarted()&&this.close(),this.started=!1,this.closed=!1,this.fpsData=[],this.bitrateData=[],this.lastUpdate=0,this.transcodeCount=0,this.lastWidth=0,this.lastHeight=0,this.lastRatio=void 0,this.streamTime=0,this.infoInterval=0,this.start()}}]),e}(),B=function(){function e(t){(0,i.Z)(this,e),this.originWSEndpoint=t,this.streamWatcher=new E,this.closed=!1,this.lastInfo=(new Date).getTime(),this.streamName="",this.roomStatusUpdate=new p.xB("originWatcherRoomStatusUpdate"),this.alternativeStreamEvent=new p.xB("originWatcherAlternativeStream")}return(0,o.Z)(e,[{key:"close",value:function(){this.closed||(this.closed=!0,void 0!==this.websocket&&this.websocket.readyState<2&&this.websocket.close(),this.streamWatcher.close())}},{key:"start",value:function(){var e=this;if(void 0!==this.origin&&void 0!==this.auth&&void 0!==this.username){if(void 0!==this.websocket){if(this.websocket.readyState<2)return;try{this.websocket.close()}catch(e){}}this.closed=!1,this.websocket=new WebSocket("wss://".concat(this.origin).concat(this.originWSEndpoint)),this.websocket.onopen=function(t){void 0!==e.websocket&&e.websocket.send(JSON.stringify({method:"connect",username:e.username,password:e.auth}))},this.websocket.onmessage=function(t){var n,i=t.data;try{n=JSON.parse(i)}catch(e){}if(void 0!==n)switch(n.method){case"auth_valid":break;case"stream_info":case"origin_info":e.lastInfo=(new Date).getTime(),e.handleInfo(n);break;default:console.warn("Unhandled",n)}},this.websocket.onerror=function(e){},this.websocket.onclose=function(t){e.closed||window.setTimeout((function(){e.start()}),100)}}}},{key:"isConnected",value:function(){return!this.closed&&void 0!==this.websocket&&(new Date).getTime()-this.lastInfo<5e3}},{key:"handleInfo",value:function(e){var t=P(e.status,"offline"),n=P(e.roomPassword,"");"public"===t&&n.length>0&&(t="password protected");var i=P(e.streamType,"obs"),o=Boolean((0,y.dD)(window.location.search).graph);if(this.roomStatusUpdate.fire(t),"obs"!==i&&!o){var r="Unknown";"webrtc"===i&&(r="WebRTC"),this.alternativeStreamEvent.fire(r)}void 0===e.streamName||"obs"!==i&&!o?(this.streamWatcher.close(),void 0!==e.remoteHost&&void 0!==e.remoteStatus&&e.remoteHost!==this.origin&&""!==e.remoteStatus&&"offline"!==e.remoteStatus&&this.update(e.remoteHost,e.username,e.originPassword)):e.streamName!==this.streamName?(this.streamWatcher.reset(),this.streamName=e.streamName):this.streamWatcher.processData(e)}},{key:"getStreamWatcher",value:function(){return this.streamWatcher}},{key:"update",value:function(e,t,n){var i=this;this.origin=e,this.username=t,this.auth=n,this.close(),window.setTimeout((function(){i.start()}),10)}},{key:"getOrigin",value:function(){return this.origin}}]),e}();var L=function(e){(0,r.Z)(y,e);var t,n,f=(t=y,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function y(e,t){var n;(0,i.Z)(this,y),(n=f.call(this)).originWSEndpoint=e,n.roomNameStaffView=t,n.roomStatus="offline",n.obsInfo=n.createLink("Show RTMP/OBS broadcast information"),n.backToWebRTC=n.createLink("Use In-Browser Broadcaster"),n.originWatcher=new B(n.originWSEndpoint),n.obsRoomStatusBlock=document.createElement("div"),n.obsRoomStatusContainer=document.createElement("div"),n.obsRoomStatus=document.createElement("span"),n.obsExitAway=document.createElement("div"),n.obsStreamStatsBlock=document.createElement("div"),n.obsStreamStatsOther=document.createElement("div"),n.obsAlternativeStreamType=document.createElement("p"),n.obsStreamRegion=document.createElement("div"),n.obsStreamGraphFPS=document.createElement("div"),n.obsStreamGraphBitrate=document.createElement("div"),n.obsStreamGraphFPSDisp=document.createElement("span"),n.obsStreamGraphBitrateDisp=document.createElement("span"),n.obsDetailsBoxTimeDisp=document.createElement("span"),n.obsDetailsBoxResDisp=document.createElement("span"),n.obsDetailsBoxCodecVideo=document.createElement("span"),n.obsDetailsBoxCodecAudio=document.createElement("span"),n.statsLoadingMessage=document.createElement("div"),n.resolutionFloatBox=document.createElement("div"),n.resolutionFloatBoxText=document.createElement("div"),n.obsStreamFeedbackBox=document.createElement("div"),n.obsFeedbackBoxHeader=document.createElement("h4"),n.obsFeedbackBoxMessages=document.createElement("div"),n.obsStreamRejected=document.createElement("div"),n.obsStreamRejectedReason=document.createElement("p"),n.obsControl=document.createElement("div"),n.obsStarted=new p.xB("obsStarted"),n.element.id="OBSOverlay";var o=void 0!==t;return n.createOBSVideo(),o||(n.hide(),n.createOtherStreamOptions()),n.originWatcher.alternativeStreamEvent.listen((function(e){n.obsStreamStatsOther.style.display="",n.updateAlternativeStreamType(e),n.obsStreamStatsBlock.style.display="none",n.statsLoadingMessage.style.display="none"})),n.originWatcher.getStreamWatcher().closeEvent.listen((function(){n.obsStreamStatsBlock.style.display="none",n.statsLoadingMessage.style.display="none",n.styleGraph(n.obsStreamGraphFPS,0),n.styleGraph(n.obsStreamGraphBitrate,0),n.styleFeedbackBox(0),n.obsStreamGraphFPSDisp.innerText="",n.obsStreamGraphBitrateDisp.innerText="",n.resolutionFloatBox.title="",n.obsDetailsBoxCodecVideo.innerText="",n.obsDetailsBoxCodecAudio.innerText="",n.obsDetailsBoxTimeDisp.innerText="",n.obsDetailsBoxResDisp.innerText=""})),n.originWatcher.getStreamWatcher().startPollingEvent.listen((function(){n.statsLoadingMessage.style.display="none",n.styleFeedbackBox(0),n.obsStreamStatsBlock.style.display=""})),n.originWatcher.getStreamWatcher().pollingStatusUpdate.listen((function(e){n.resolutionFloatBox.title=g.ag.obsStreamClass(e.resolutionTitle),n.resolutionFloatBoxText.innerText=e.resolutionText,n.styleResolutionFloatBox(e.resolutionType),n.styleFeedbackBox(e.feedbackType),n.styleGraph(n.obsStreamGraphFPS,e.fpsFeedback),n.styleGraph(n.obsStreamGraphBitrate,e.bitrateFeedback),n.obsFeedbackBoxHeader.innerText=e.feedbackHeader,n.obsFeedbackBoxMessages.innerHTML=e.feedbackMessages.join("<br>")})),n.originWatcher.getStreamWatcher().streamDataUpdate.listen((function(e){n.obsStreamStatsBlock.style.display="",n.obsStreamRegion.innerText=g.ag.obsConnectionDescription(e.host,e.region,e.streamType),n.obsStreamGraphFPSDisp.innerText=g.ag.obsFPS(Math.round(e.fps)),n.obsStreamGraphBitrateDisp.innerText=g.ag.obsBitrate(Math.round(e.bitrate)),n.obsDetailsBoxTimeDisp.innerText="".concat(e.streamTime),n.obsDetailsBoxResDisp.innerText="".concat(e.videoWidth,"x").concat(e.videoHeight),n.obsDetailsBoxCodecVideo.innerText="".concat(e.videoCodec),n.obsDetailsBoxCodecAudio.innerText="".concat(e.audioCodec)})),n.originWatcher.roomStatusUpdate.listen((function(e){n.updateRoomStatus(e)})),n}return(0,o.Z)(y,[{key:"monitorRoomStatus",value:function(){var e=this;void 0!==this.monitorTimeout&&clearTimeout(this.monitorTimeout);var t="api/get_my_broadcast_status/".concat(void 0!==this.roomNameStaffView?"".concat(this.roomNameStaffView,"/"):"").concat("offline"===this.roomStatus?"?auth=1":"");(0,h.I5)(t,{}).then((function(t){var n=JSON.parse(t.responseText);e.originWatcher.isConnected()||e.updateRoomStatus(n.status);var i=n.errors;if(null!=i&&"offline"===n.status){e.obsStreamRejected.style.display="";var o="Your stream was recently rejected for the following reasons:<br />";void 0!==i.reasons&&i.reasons.forEach((function(e){switch(e){case"ratio":o="".concat(o,"Having an incorrect ratio, please either broadcast at 4:3 or 16:9.<br />");break;case"height":o="".concat(o,"Having an invalid height of ").concat(P(i.height,"Unknown")," pixels, the stream height must be between 240 and 2160 pixels.<br />");break;case"codec_video":o="".concat(o,"Having an invalid video codec of ").concat(P(S[P(i.video_codec,"")],"Unknown"),", the stream must use the H.264 video codec baseline, main or high 4:2:0.<br />");break;case"codec_audio":o="".concat(o,"Having an invalid video codec of ").concat(P(T[P(i.audio_codec,"")],"Unknown")," the stream must use the AAC audio codec.<br />");break;case"high_res_fps":o="".concat(o,"Having a high frame rate and resolution. Resolutions above 1080p are limited to 30fps.<br />");break;case"video_fps":o="".concat(o,"Having an invalid video fps of ").concat(Math.round(P(i.video_fps,0))," the stream must be at least 24 fps.<br />");break;default:o="".concat(o,"An unknown reason.<br />")}})),e.obsStreamRejectedReason.innerHTML=o}var r=n.origin,s=n.username,a=n.originPassword,l=n.status;void 0!==r&&void 0!==s&&void 0!==a&&void 0!==l&&(!e.originWatcher.isConnected()||e.originWatcher.getOrigin()!==r&&"offline"!==l)&&e.originWatcher.update(r,s,a)})).catch((function(){})),this.monitorTimeout=window.setTimeout((function(){e.monitorRoomStatus()}),1e4)}},{key:"createOBSVideo",value:function(){var e=document.createElement("div"),t=document.createElement("span"),n=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div"),r=document.createElement("div"),s=this.createDetailsBox(),a=this.createDetailsBox(),l=this.createDetailsBox(),c=document.createElement("div");e.appendChild(n),n.appendChild(this.obsRoomStatusBlock),this.obsRoomStatusContainer.appendChild(t),this.obsRoomStatusContainer.appendChild(this.obsRoomStatus),this.obsRoomStatusBlock.appendChild(this.obsRoomStatusContainer),this.obsRoomStatusBlock.appendChild(this.obsExitAway),n.appendChild(i),i.appendChild(this.obsStreamRejected),i.appendChild(this.statsLoadingMessage),i.appendChild(this.obsStreamStatsBlock),this.obsStreamStatsBlock.appendChild(o),o.appendChild(this.obsStreamFeedbackBox),this.obsStreamStatsBlock.appendChild(r),r.appendChild(s),this.resolutionFloatBox.appendChild(this.resolutionFloatBoxText),r.appendChild(a),r.appendChild(l),this.obsStreamStatsBlock.appendChild(c),c.appendChild(this.obsStreamGraphFPS),c.appendChild(this.obsStreamGraphBitrate),this.obsStreamStatsBlock.appendChild(this.obsStreamRegion),i.appendChild(this.obsStreamStatsOther),this.element.appendChild(e),r.style.lineHeight="18px",(0,u.vP)(t,"roomStatusLabel"),t.innerText=g.ag.yourStreamIsCurrently,this.obsRoomStatusContainer.style.textAlign="center",this.obsRoomStatusContainer.style.display="none",this.obsRoomStatusContainer.style.fontSize="1.1em",this.obsRoomStatusContainer.style.paddingTop="25px",(0,u.vP)(this.obsRoomStatus,"roomStatus"),this.obsRoomStatus.style.fontWeight="bolder",n.style.font="1.2em/1.4em 'UbuntuRegular', Arial, Helvetica, sans-serif",n.style.height="434px",this.obsStreamStatsBlock.style.display="none",this.obsRoomStatusBlock.style.height="145px",this.obsRoomStatusBlock.style.lineHeight="1em",this.obsRoomStatusBlock.style.textAlign="center",(0,u.vP)(this.obsStreamRegion,"streamRegion"),this.obsStreamRegion.style.textAlign="left",this.obsStreamRegion.style.fontSize="9px",this.obsStreamRegion.style.paddingLeft="5px",i.style.fontWeight="normal",r.style.width="100%",r.style.padding="8px",r.style.height="55px",r.style.boxSizing="border-box",r.style.textAlign="center",c.style.width="100%",c.style.height="110px",c.style.padding="3px",c.style.boxSizing="border-box",c.style.marginTop="5px",this.obsStreamGraphFPS.style.cssFloat="left",this.obsStreamGraphFPS.style.width="240px",this.obsStreamGraphFPS.style.textAlign="center",(0,v.pS)(this.obsStreamGraphFPS,"background 500ms ease-in-out"),this.obsStreamGraphBitrate.style.cssFloat="right",this.obsStreamGraphBitrate.style.width="240px",this.obsStreamGraphBitrate.style.textAlign="center",(0,v.pS)(this.obsStreamGraphBitrate,"background 500ms ease-in-out"),this.obsExitAway.style.fontSize="0.9em",this.obsExitAway.style.lineHeight="1.4em",this.obsExitAway.style.maxWidth="90%",this.obsExitAway.style.margin="10px auto 0",this.obsExitAway.style.display="none",o.style.width="100%",o.style.padding="5px",o.style.height="104px",o.style.boxSizing="border-box",this.obsStreamFeedbackBox.style.width="85%",this.obsStreamFeedbackBox.style.padding="5px",this.obsStreamFeedbackBox.style.textAlign="center",this.obsStreamFeedbackBox.style.fontSize="12px",this.obsStreamFeedbackBox.style.margin="4px auto 0",(0,u.vP)(this.obsStreamRejected,"streamRejected"),this.obsStreamRejected.style.display="none",this.obsStreamRejected.style.width="85%",this.obsStreamRejected.style.padding="5px",this.obsStreamRejected.style.textAlign="center",this.obsStreamRejected.style.color="#ffffff",this.obsStreamRejected.style.fontSize="14px",this.obsStreamRejected.style.margin="15px auto 0",this.obsStreamRejected.style.borderWidth="1px",this.obsStreamRejected.style.borderStyle="solid",this.resolutionFloatBox.style.display="none",this.resolutionFloatBox.style.fontSize="16px",this.resolutionFloatBox.style.width="33px",this.resolutionFloatBox.style.height="23px",this.resolutionFloatBox.style.borderRadius="3px",this.resolutionFloatBox.style.position="absolute",this.resolutionFloatBox.style.right="2px",this.resolutionFloatBox.style.top="10px",this.resolutionFloatBox.style.fontWeight="bold",this.resolutionFloatBox.style.textAlign="center",this.resolutionFloatBoxText.style.padding="10% 0";var d=document.createElement("p");(0,u.vP)(d,"obsAwayMessage"),d.innerText=g.ag.obsAwayMessage,d.style.margin="3px";var h=this.createLink("Exit Away Mode");(0,u.vP)(h,"exitAwayLink"),h.style.fontSize="1.6em",h.onclick=function(e){e.preventDefault(),(0,m.ve)()},this.obsExitAway.appendChild(d),this.obsExitAway.appendChild(h);var f=document.createElement("h4");f.innerText=g.ag.streamRejected,this.obsStreamRejected.appendChild(f),this.obsStreamRejected.appendChild(this.obsStreamRejectedReason);var p=document.createElement("p");(0,u.vP)(p,"waitingMessage"),p.innerText=g.ag.waitingforStreamStats,p.style.textAlign="center";var y=document.createElement("img");y.src="".concat(STATIC_URL,"ellipsis.svg"),y.style.height="110px",y.style.width="auto",y.style.opacity="0.5",y.style.margin="0 auto",y.style.display="block",this.statsLoadingMessage.appendChild(p),this.statsLoadingMessage.appendChild(y),this.obsFeedbackBoxHeader.innerText=g.ag.streamStatusUnknown,this.obsFeedbackBoxHeader.style.color="inherit",this.obsFeedbackBoxHeader.style.fontWeight="bold",this.obsFeedbackBoxHeader.style.fontSize="15px",this.obsFeedbackBoxHeader.style.margin="3px",this.obsStreamFeedbackBox.appendChild(this.obsFeedbackBoxHeader),this.obsStreamFeedbackBox.appendChild(this.obsFeedbackBoxMessages),this.obsStreamFeedbackBox.style.display="none",(0,u.vP)(s,"resolutionText");var b=document.createElement("span");b.innerText=g.ag.resolutionLabel,s.appendChild(b),s.appendChild(document.createElement("br")),this.obsDetailsBoxResDisp=document.createElement("span"),this.obsDetailsBoxResDisp.style.fontSize="0.8em",s.appendChild(this.obsDetailsBoxResDisp),s.appendChild(this.resolutionFloatBox);var w=document.createElement("span");w.innerText=g.ag.streamTime,a.appendChild(w),a.appendChild(document.createElement("br")),this.obsDetailsBoxTimeDisp=document.createElement("span"),this.obsDetailsBoxTimeDisp.style.fontSize="0.8em",a.appendChild(this.obsDetailsBoxTimeDisp),(0,u.vP)(l,"codecText");var C=document.createElement("span");C.innerText=g.ag.codec,l.appendChild(C),l.appendChild(document.createElement("br")),this.obsDetailsBoxCodecVideo=document.createElement("span"),this.obsDetailsBoxCodecVideo.style.fontSize="10px",this.obsDetailsBoxCodecVideo.style.lineHeight="1",this.obsDetailsBoxCodecVideo.style.display="block",this.obsDetailsBoxCodecVideo.style.marginTop="2px",this.obsDetailsBoxCodecAudio=document.createElement("span"),this.obsDetailsBoxCodecAudio.style.fontSize="10px",this.obsDetailsBoxCodecAudio.style.lineHeight="1",this.obsDetailsBoxCodecAudio.style.display="block",this.obsDetailsBoxCodecAudio.style.marginTop="2px",l.appendChild(this.obsDetailsBoxCodecVideo),l.appendChild(this.obsDetailsBoxCodecAudio);var x=document.createElement("span");x.innerText=g.ag.frameRate,this.obsStreamGraphFPSDisp.style.fontWeight="bold";var k=document.createElement("canvas");k.style.width="235px",k.style.height="80px",k.id="fps_chart",this.obsStreamGraphFPS.appendChild(x),this.obsStreamGraphFPS.appendChild(this.obsStreamGraphFPSDisp),this.obsStreamGraphFPS.appendChild(k);var S=document.createElement("span");S.innerText=g.ag.bitrate,this.obsStreamGraphBitrateDisp.style.fontWeight="bold";var T=document.createElement("canvas");T.style.width="235px",T.style.height="80px",T.id="bitrate_chart",this.obsStreamGraphBitrate.appendChild(S),this.obsStreamGraphBitrate.appendChild(this.obsStreamGraphBitrateDisp),this.obsStreamGraphBitrate.appendChild(T),this.obsStreamStatsOther.appendChild(this.obsAlternativeStreamType),this.obsStreamStatsOther.style.display="none",this.obsAlternativeStreamType.style.textAlign="center",this.obsAlternativeStreamType.style.height="260px",this.obsAlternativeStreamType.style.marginTop="40px",this.updateAlternativeStreamType("Unknown")}},{key:"updateAlternativeStreamType",value:function(e){this.obsAlternativeStreamType.innerText=g.ag.obsAlternativeStreamType(e)}},{key:"createDetailsBox",value:function(){var e=document.createElement("div");return e.style.width="33%",e.style.cssFloat="left",e.style.height="30px",e.style.lineHeight="18px",e.style.position="relative",e}},{key:"styleResolutionFloatBox",value:function(e){switch(this.resolutionFloatBox.style.display="",e){case 0:this.resolutionFloatBox.style.backgroundColor="#e67e22",this.resolutionFloatBox.style.color="#fff";break;case 1:this.resolutionFloatBox.style.backgroundColor="#27ae60",this.resolutionFloatBox.style.color="#fff";break;case 2:this.resolutionFloatBox.style.backgroundColor="#16a085",this.resolutionFloatBox.style.color="#fff";break;case 3:this.resolutionFloatBox.style.backgroundColor="#2980b9",this.resolutionFloatBox.style.color="#f1c40f"}}},{key:"styleFeedbackBox",value:function(e){switch(this.obsStreamFeedbackBox.className="",this.obsStreamFeedbackBox.style.display="",this.obsStreamFeedbackBox.style.borderWidth="1px",this.obsStreamFeedbackBox.style.borderStyle="solid",e){case 0:this.obsStreamFeedbackBox.style.display="none";break;case 3:(0,u.vP)(this.obsStreamFeedbackBox,"goodFeedback");break;case 2:(0,u.vP)(this.obsStreamFeedbackBox,"warningFeedback");break;case 1:(0,u.vP)(this.obsStreamFeedbackBox,"badFeedback")}}},{key:"styleGraph",value:function(e,t){switch(t){case 0:e.style.backgroundColor="";break;case 3:e.style.backgroundColor="rgba(46, 204, 113, 0.49)";break;case 2:e.style.backgroundColor="rgba(230, 126, 34, 0.61)";break;case 1:e.style.backgroundColor="rgba(231, 76, 60, 0.58)"}}},{key:"updateRoomStatus",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";-1!==["offline","public","private","group","away","hidden","password protected"].indexOf(t)?("offline"!==t?(this.obsControl.style.marginTop="0",this.obsStreamRejected.style.display="none",this.backToWebRTC.style.display="none","offline"===this.roomStatus&&(c.PE.fire(!0),this.obsStarted.fire(void 0))):(this.obsControl.style.marginTop="-12px",(0,l.AQ)()&&!(0,l.E$)()&&(this.backToWebRTC.style.display=""),"offline"!==this.roomStatus&&(c.PE.fire(!1),clearTimeout(this.monitorTimeout),this.monitorTimeout=window.setTimeout((function(){e.monitorRoomStatus()}),2e3))),this.roomStatus=t,this.obsRoomStatus.innerText=t,this.styleOBSRoomStatus(t)):this.roomStatus="unknown",this.obsExitAway.style.display="away"===t?"":"none"}},{key:"styleOBSRoomStatus",value:function(e){switch(this.obsRoomStatusContainer.style.display="",this.obsStreamStatsOther.style.display="none",this.obsRoomStatusBlock.className="",e){case"offline":(0,u.vP)(this.obsRoomStatusBlock,"offlineBlock");break;case"public":(0,u.vP)(this.obsRoomStatusBlock,"publicBlock");break;case"private":(0,u.vP)(this.obsRoomStatusBlock,"privateBlock");break;case"group":(0,u.vP)(this.obsRoomStatusBlock,"groupBlock");break;case"away":(0,u.vP)(this.obsRoomStatusBlock,"awayBlock");break;case"hidden":(0,u.vP)(this.obsRoomStatusBlock,"hiddenBlock");break;case"password protected":(0,u.vP)(this.obsRoomStatusBlock,"passwordProtectedBlock")}}},{key:"createOtherStreamOptions",value:function(){var e=this;this.element.appendChild(this.obsControl),this.obsControl.appendChild(this.backToWebRTC),this.obsControl.appendChild(this.obsInfo),this.obsControl.style.paddingTop="7px",this.obsControl.style.width="100%",this.obsControl.style.height="10%",this.obsControl.style.marginTop="-12px",this.obsControl.style.textAlign="center",this.backToWebRTC.style.paddingLeft="5px",this.obsInfo.style.display="block",this.backToWebRTC.onclick=function(){e.webBroadcaster()}}},{key:"webBroadcaster",value:function(){"private"===this.roomStatus||"group"===this.roomStatus?(0,d.oB)("Warning! This will end your ".concat(this.roomStatus," show.  Are you sure?"),(function(){""===window.location.search?window.location.reload():window.location.search=""})):""===window.location.search?window.location.reload():window.location.search=""}},{key:"show",value:function(){this.element.style.display="block"}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"createLink",value:function(e){var t=document.createElement("a");return(0,u.vP)(t,u.ql.hrefColor),t.innerText=e,t.style.padding="0 10px",t.style.fontWeight="bold",t.style.font="1.1em/1.2em 'UbuntuRegular', Arial, Helvetica, sans-serif",t.style.cursor="pointer",t}},{key:"getOBSInfoLink",value:function(){return this.obsInfo}},{key:"isOffline",value:function(){return"offline"===this.roomStatus}}]),y}(f.w),O=new p.xB("showOBSOverlay")},7968:function(e,t,n){"use strict";n.d(t,{E:function(){return x},q:function(){return C}});var i=n(126),o=n(2951),r=n(1976),s=n(7591),a=n(9492),l=n(7597),c=n(2018),u=n(1185),d=n(8542),h=n(1522),f=n(3753),p=n(391),m=n(4793),v=n(1794),g=n(9545),y=n(3543),b=n(2750),w=n(7393);var C=new v.xB("reloadAppTab",{maxHistorySize:1}),x=function(e){(0,s.Z)(w,e);var t,n,v=(t=w,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function w(e){var t;return(0,o.Z)(this,w),(t=v.call(this)).roomDossier=e,(0,u.vP)(t.element,"appsTab"),m.jr.listen((function(){t.showing&&t.load()})),m.kN.listen((function(e){e.chatConnection.event.appTabRefresh.listen((function(){t.showing&&t.load()}))})),C.listen((function(){t.showing&&t.load()})),t}return(0,r.Z)(w,[{key:"createContent",value:function(e){}},{key:"createCbappsTable",value:function(e){var t=this,n=document.createElement("table");(0,u.vP)(n,"table"),n.style.width="850px",n.style.borderWidth="1px",n.style.borderStyle="solid",n.style.borderRadius="5px 5px 0 0",n.style.borderSpacing="0",n.appendChild(this.createCbappsTableHeader()),n.appendChild(this.createCbappsTableFooter());var i=document.createElement("tbody");n.appendChild(i);for(var o=["".concat(y.ag.activeApp,":"),"".concat(y.ag.bot1,":"),"".concat(y.ag.bot2,":"),"".concat(y.ag.bot3,":"),"".concat(y.ag.bot4,":"),"".concat(y.ag.bot5,":")],r=function(n){var r=e["slot".concat(n)],s=e["previous_app_".concat(n)],a=0===n,l=document.createElement("tr");(0,u.vP)(l,"row");var c=document.createElement("td"),d=document.createElement("legend"),p=document.createElement("td"),m=document.createElement("td");(0,u.vP)(d,"label"),d.innerText=o[n],d.style.padding="4px 8px",void 0===r?((0,u.vP)(p,"noneSelected"),p.innerText=y.ag.noneSelected,p.style.fontStyle="italic"):p.innerText=r;var v=document.createElement("a");if((0,u.vP)(v,u.ql.hrefColor),m.appendChild(v),m.style.paddingRight="8px",void 0===r?(v.href=(0,f.BN)(a?"/apps/":"/apps/bot/".concat(n,"/")),v.onclick=function(e){e.preventDefault(),(0,b.Pv)(v.href,"_blank",b.uX)},v.innerText=a?y.ag.chooseAnApp:y.ag.chooseABot):((0,u.vP)(v,"deactivate"),v.name="/app/stop/".concat(n),v.innerText=y.ag.deactivateText,v.href="#",v.onclick=function(e){e.preventDefault(),(0,f.I5)("app/stop/".concat(n,"/"),{}).then((function(){t.load()})).catch((function(){(0,h.Cj)("Error deactivating app")}))}),void 0!==s){var g=document.createElement("span"),w=document.createElement("a");(0,u.vP)(g,"orText"),g.innerText=" ".concat(y.ag.orSimple," "),(0,u.vP)(w,u.ql.hrefColor),w.innerText="".concat(y.ag.restart,' "').concat(s.app_name,'"'),w.href=(0,f.BN)("/app/startup/".concat(s.app_slug,"/?version=").concat(s.app_version,"&slot=").concat(n)),w.onclick=function(e){e.preventDefault(),(0,b.Pv)(w.href,"_blank",b.uX)},m.appendChild(g),m.appendChild(w)}c.style.width="150px",m.style.textAlign="right",i.appendChild(l),c.appendChild(d),l.appendChild(c),l.appendChild(p),l.appendChild(m)},s=0;s<o.length;s+=1)r(s);return n}},{key:"createCbappsTableHeader",value:function(){var e=document.createElement("thead"),t=document.createElement("tr"),n=document.createElement("th");return n.colSpan=3,n.innerText="v1 ".concat(y.ag.appsAndBots),n.style.textAlign="left",n.style.fontSize="13px",n.style.borderRadius="5px 5px 0 0",n.style.padding="7px 10px",n.style.fontWeight="normal",(0,u.vP)(n,"header"),t.appendChild(n),e.appendChild(t),e}},{key:"createCbappsTableFooter",value:function(){var e=document.createElement("tfoot"),t=document.createElement("tr"),n=document.createElement("td");return n.innerHTML=y.ag.v1AppsAndBotsFooterText(),n.colSpan=3,n.style.padding="7px 10px",n.style.fontSize="12px",t.appendChild(n),e.appendChild(t),e}},{key:"loadContent",value:function(e,t){var n=document.createElement("div"),i=document.createElement("p");i.style.color="red",i.style.fontSize="18px",this.element.appendChild(n);var o=document.createElement("p");if(o.style.width="580px",o.style.fontSize="13px",o.style["-webkit-font-smoothing"]="antialiased",o.innerHTML=y.ag.appsTabDescription,o.dataset.test="apps-description",n.appendChild(o),void 0!==t){var r={authUrl:this.roomDossier.aspAuthUrl,savedApps:[]};r.savedApps=t.items,n.appendChild(new d.MH(r).render())}else i.textContent=y.ag.appsLoadingErrorV2,n.appendChild(i);n.appendChild(document.createElement("br")),void 0!==e?n.appendChild(this.createCbappsTable(e)):(i.textContent=y.ag.appsLoadingError,n.appendChild(i))}},{key:"fetchCbappsData",value:function(){var e=this,t="api/ts/chat/app-and-bots/";return this.fetchData(t).then((function(n){return new Promise((function(i,o){try{i(e.parseData(n.responseText))}catch(e){error("Error parsing response from resource",{path:t,reason:e.toString()}),o(e)}}))}))}},{key:"load",value:function(){var e=this;this.showingError=!1,Promise.all((0,g.uK)([this.fetchCbappsData(),(0,c.dk)()])).then((function(t){e.clearContent(),t.every((function(e){return"rejected"===e.status}))?e.showErrorMessage():e.loadContent.apply(e,(0,i.Z)(t.map((function(e){return e.value}))))})).catch((function(){}))}},{key:"parseData",value:function(e){var t=new p.j(e),n={slot0:t.getStringOrUndefined("slot0"),slot1:t.getStringOrUndefined("slot1"),slot2:t.getStringOrUndefined("slot2"),slot3:t.getStringOrUndefined("slot3"),slot4:t.getStringOrUndefined("slot4"),slot5:t.getStringOrUndefined("slot5"),previous_app_0:this.parsePreviousApp(t.getObjectStringOrUndefined("previous_app_0")),previous_app_1:this.parsePreviousApp(t.getObjectStringOrUndefined("previous_app_1")),previous_app_2:this.parsePreviousApp(t.getObjectStringOrUndefined("previous_app_2")),previous_app_3:this.parsePreviousApp(t.getObjectStringOrUndefined("previous_app_3")),previous_app_4:this.parsePreviousApp(t.getObjectStringOrUndefined("previous_app_4")),previous_app_5:this.parsePreviousApp(t.getObjectStringOrUndefined("previous_app_5"))};return t.logUnusedDebugging("AppsAndBotsTab"),n}},{key:"parsePreviousApp",value:function(e){if(void 0!==e){var t=new p.j(e);return{app_slug:t.getString("app_slug"),app_version:t.getString("app_version"),app_name:t.getString("app_name")}}}}]),w}(w.d)},7393:function(e,t,n){"use strict";n.d(t,{d:function(){return h}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(3753),c=n(9),u=n(3543),d=n(1289);var h=function(e){(0,r.Z)(h,e);var t,n,c=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function h(){var e;return(0,i.Z)(this,h),(e=c.call(this)).loadingMsg=document.createElement("div"),e.errorMsg=document.createElement("div"),e.showing=!1,e.showingError=!1,e.params={},e.pathname="",e.element.style.position="static",e.element.style.minHeight="325px",e.element.style.margin="14px",e.element.style.boxSizing="border-box",e.element.style.width="",e.element.style.height="",e.element.style.paddingLeft="8px",e.loadingMsg.innerText="".concat(u.ag.loadingText,"â€¦"),e.loadingMsg.style.fontSize="1.2em",e.errorMsg.innerText="An error occurred trying to load this tab",e.errorMsg.style.fontSize="1.2em",e}return(0,o.Z)(h,[{key:"setResourceUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.pathname=e,this.params=t}},{key:"clearContent",value:function(){this.removeAllDOMChildren()}},{key:"load",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1?arguments[1]:void 0;if(this.showingError=!1,""===this.pathname)return this.clearContent(),void this.createContent({});t&&(this.clearContent(),this.element.appendChild(this.loadingMsg));var i=(0,d.Ie)(this.params);this.fetchData("".concat(this.pathname,"?").concat(i)).then((function(i){var o;try{o=e.parseData(i.responseText)}catch(t){return e.showErrorMessage(),void error("Error parsing response from resource",{path:e.pathname,reason:t.toString()})}t&&e.loadingMsg.parentElement===e.element&&e.element.removeChild(e.loadingMsg),e.clearContent(),e.createContent(o),void 0!==n&&n()})).catch((function(t){error("Fetch data error",{pathname:e.pathname,reason:t.toString()}),e.showErrorMessage()}))}},{key:"fetchData",value:function(e){return(0,l.Ue)(e)}},{key:"showErrorMessage",value:function(){this.clearContent(),this.showingError=!0,this.element.appendChild(this.errorMsg)}},{key:"showLoadingMessage",value:function(){this.clearContent(),this.element.appendChild(this.loadingMsg)}},{key:"show",value:function(e,t){this.showing=!0,this.element.style.display="",this.load(!0,t)}},{key:"hide",value:function(){this.showing=!1,this.element.style.display="none"}}]),h}(c.w)},8959:function(e,t,n){"use strict";n.d(t,{u:function(){return B},Z:function(){return E}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(1185),u=n(6429),d=n(3753),h=n(8824),f=n(6181),p=n(8263),m=n(6422),v=n(3543),g=n(1289),y=n(2750),b=n(2890),w=n(4649),C=n(2080),x=n(8785),k=n(9165);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,w.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var R=function(e){(0,s.Z)(n,e);var t=I(n);function n(e,o,r,s,a){var l;(0,i.Z)(this,n),(l=t.call(this,e,o,T(T({},r),{},{styles:{field:new P,input:new P,select:new M,multipleSelect:new A}}))).roomName=s,l.canUpload=a,l.element.style.marginLeft="50px";var c=l.getField("gender"),u=l.getField("subgender"),d=function(e){if(void 0!==u){var t=u.getWidget();e.value===k.Y0.OldTrans||e.value===k.Y0.Trans?t.style.display="inline":(t.style.display="none",t.value="")}};if(l.placeSubgenderField(),void 0!==c){var h=c.getWidget();d(h),c.setOnChange((function(){h.value===k.Y0.Couple?c.updateLabelText(v.ag.sexTextCouple):c.updateLabelText(v.ag.sexText),d(h)}))}return l.addField(new C.Jf({name:"pics_and_videos",labelText:v.ag.picsAndVideosText,customElement:l.createPicsAndVideos()})),l.setSubmitText(v.ag.updateBio),l}return(0,o.Z)(n,[{key:"placeSubgenderField",value:function(){var e=this.getField("gender"),t=this.getField("subgender");if(void 0!==e&&void 0!==t){var n=e.getField().querySelector("td"),i=t.getField().querySelector("td");null!==n&&null!==i&&i.childNodes.forEach((function(e){return n.appendChild(e)}))}}},{key:"createPicsAndVideos",value:function(){var e=document.createElement("div");e.style.paddingTop="9px";var t=document.createElement("a"),n=document.createElement("a"),i=document.createElement("a");if(t.innerText=v.ag.uploadNewPics,t.href=(0,d.BN)("/photo_videos/photoset/create/"),t.onclick=function(e){e.preventDefault(),(0,y.Pv)(t.href,"_blank",y.jZ)},n.innerText=v.ag.uploadNewVideos,n.href=(0,d.BN)("/photo_videos/photoset/create/video/"),n.target="_blank",n.onclick=function(e){e.preventDefault(),(0,y.Pv)(n.href,"_blank",y.jZ)},i.innerText=v.ag.managePhotoSet,i.href=(0,d.BN)("/photo_videos/photoset/list_popup/".concat(this.roomName,"/")),i.onclick=function(e){e.preventDefault(),(0,y.Pv)(i.href,"_blank",y.jZ)},this.canUpload)e.appendChild(t),e.appendChild(this.createSeparator()),e.appendChild(n);else{var o=document.createElement("span");o.style.fontSize="14px",o.style.color="black",o.innerHTML=v.ag.mustBeAgeVerifiedToUploadContent(),e.appendChild(o)}return e.appendChild(this.createSeparator()),e.appendChild(i),e}},{key:"createSeparator",value:function(){var e=document.createElement("span");return(0,c.vP)(e,"separator"),e.style.fontSize="12px",e.innerText=" | ",e}}]),n}(u.Q),P=function(e){(0,s.Z)(n,e);var t=I(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"styleField",value:function(e){(0,r.Z)((0,l.Z)(n.prototype),"styleField",this).call(this,e),(0,c.FU)(e,"field"),(0,c.vP)(e,"fieldInput")}}]),n}(x.rk),M=function(e){(0,s.Z)(n,e);var t=I(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"styleField",value:function(e){(0,r.Z)((0,l.Z)(n.prototype),"styleField",this).call(this,e),e.style.width=""}}]),n}(P),A=function(e){(0,s.Z)(n,e);var t=I(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"styleField",value:function(e){(0,c.vP)(e,"fieldInput")}}]),n}(P);var E="RefreshBroadcastBioTabSocialMedia",B=function(e){(0,s.Z)(w,e);var t,n,f=(t=w,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function w(e,t,n){var o;return(0,i.Z)(this,w),(o=f.call(this)).isAgeVerified=t,o.canUpload=n,o.state=0,o.editQueryChecked=!1,window[E]=function(){o.load(!1)},window.RefreshBroadcastBioTabPicsAndVideo=function(){o.load(!1)},o.element.id="tabs_content_container",o}return(0,o.Z)(w,[{key:"load",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1?arguments[1]:void 0;(0,r.Z)((0,l.Z)(w.prototype),"load",this).call(this,t,(function(){void 0!==n&&n(),e.editQueryChecked||(e.editQueryChecked=!0,"bio"===(0,g.dD)(window.location.search).edit&&e.setState(1))}))}},{key:"show",value:function(){this.element.style.display="",this.element.style.margin="0 0 14px",this.showingError&&this.load(),this.repositionChildren()}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"parseData",value:function(e){return 0===this.state?(0,h.rv)(e,this.room):u.R.parseData(e)}},{key:"createContent",value:function(e){0===this.state?this.createBioContents(e):1===this.state&&this.createEditBio(e)}},{key:"createEditBio",value:function(e){var t=this;this.createPreHeaderContent();var n=new R(e,"api/ts/accounts/editbio/",{onSubmitSuccess:function(e){b.xF.fire({gender:String(e.get("gender")),subgender:String(e.get("subgender"))}),t.setState(0)}},this.room,this.canUpload);this.element.appendChild(n.element),n.focusFirstField()}},{key:"createSeparator",value:function(){var e=document.createElement("span");return(0,c.vP)(e,"separator"),e.style.fontSize="14px",e.innerText=" | ",e}},{key:"generateSocialMediaSection",value:function(e,t){var n=(0,r.Z)((0,l.Z)(w.prototype),"generateSocialMediaSection",this).call(this,e,t);return this.isAgeVerified||n.querySelectorAll(".socialMediaUpload").forEach((function(e){e.style.opacity="0.6"})),n}},{key:"generateSocialMediaLinks",value:function(e,t){var n=(0,r.Z)((0,l.Z)(w.prototype),"generateSocialMediaLinks",this).call(this,e,t);if(t&&n.appendChild(this.createSeparator()),this.isAgeVerified){var i=document.createElement("a");(0,c.vP)(i,c.ql.hrefColor),i.href=(0,d.BN)("/socials/social_media/create/"),i.onclick=function(e){e.preventDefault(),(0,y.Pv)(i.href,"_blank",y.jZ)},i.innerText=v.ag.addNewSocialMedia,i.style.fontSize="14px",n.appendChild(i)}else{var o=document.createElement("span");o.style.fontSize="14px",o.innerHTML=v.ag.mustBeAgeVerifiedToAddSocialMedia(),n.appendChild(o)}return n}},{key:"generatePicsLinks",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"photo",i=document.createElement("div");if(t){var o=(new m.dM).anchor,r="/photo_videos/photoset/list_popup/".concat(e,"/");(0,c.vP)(o,c.ql.hrefColor),o.href=(0,d.BN)(r),o.innerText=v.ag.showMoreText,o.style.fontSize="14px",o.style.cursor="pointer",(0,p.pY)(o),o.onclick=function(e){e.preventDefault(),(0,y.Pv)(o.href,"_blank",y.jZ)},i.appendChild(o),i.appendChild(this.createSeparator())}var s=function(e,t){var n=document.createElement("a");return(0,c.vP)(n,c.ql.hrefColor),n.href=(0,d.BN)(t),n.onclick=function(e){e.preventDefault(),(0,y.Pv)(n.href,"_blank",y.jZ)},n.innerText=e,n.style.fontSize="14px",n};if(this.canUpload)"photo"===n?i.appendChild(s(v.ag.uploadNewPics,"/photo_videos/photoset/create/")):i.appendChild(s(v.ag.uploadNewVideos,"/photo_videos/photoset/create/video/"));else{var a=document.createElement("span");a.style.fontSize="14px",a.innerHTML=v.ag.mustBeAgeVerifiedToUploadContent(),i.appendChild(a)}return i}},{key:"handlePictureClick",value:function(e,t,n){e.preventDefault(),(0,y.Pv)(n,"_blank",y.jZ)}},{key:"createFollowersSection",value:function(e){var t='<a href="'.concat((0,d.BN)("/accounts/followers/"),'" target="_blank">').concat(isNaN(e)?"0":e.toString(),"</a>");return this.createSection(v.ag.followersText,t,!0)}},{key:"shouldShowSocialMediaSection",value:function(e){return!0}},{key:"shouldShowPicsSection",value:function(e){return!0}},{key:"createBioContents",value:function(e){this.createPreHeaderContent(),(0,r.Z)((0,l.Z)(w.prototype),"createBioContents",this).call(this,e,this.canUpload)}},{key:"createPreHeaderContent",value:function(){var e=this;if(0===this.state){var t=document.createElement("a");this.element.appendChild(t),t.style.cursor="pointer",t.style.display="inline-block",t.style.margin="14px 14px 0",t.innerText=v.ag.editYourBio,t.className="editbio",t.onclick=function(t){e.setState(1)}}else if(1===this.state){var n=document.createElement("a");this.element.appendChild(n),n.style.cursor="pointer",n.style.display="inline-block",n.style.margin="14px 14px 0",n.innerText=v.ag.cancelText,n.onclick=function(t){e.setState(0)}}}},{key:"setState",value:function(e){0===e?(this.state=0,this.setResourceUrl("api/biocontext/".concat(this.room,"/")),this.load(!1)):1===e&&(this.state=1,this.setResourceUrl("api/ts/accounts/editbio/"),this.load(!1))}},{key:"fetchData",value:function(e){return 0===this.state||1===this.state?(0,d.Ue)(e):(0,r.Z)((0,l.Z)(w.prototype),"fetchData",this).call(this,e)}}]),w}(f.q)},2394:function(e,t,n){"use strict";n.d(t,{N2:function(){return d},Ru:function(){return u},pn:function(){return a}});var i=n(8759),o=n(3705),r=n(3543),s=[[640,360],[960,540],[1280,720]];function a(e,t){return void 0===t&&(t=200),e.forEach((function(e){e.stop()})),new Promise((function(e){window.setTimeout((function(){e()}),t)}))}function l(e){return"Invalid constraint"===e.message||"OverconstrainedError"===e.name||"NotReadableError"===e.name}function c(e,t,n){if(!(0,i.Tt)()||!(0,i.G6)()||960!==t||540!==n){var o=t/n,r=o>1.4,s=n>=720;return{id:"".concat(t,"x").concat(n),camId:e,label:"".concat(t," x ").concat(n),width:t,height:n,ratio:o,isWidescreen:r,isHD:s}}}function u(e,t){return new Promise((function(n,i){var u="DevicePermsOnLoadGranted",d="DevicePermsOnLoadDenied",h="PermanentDevicePermsOnLoadDenied",f=Date.now();window.setTimeout((function(){u="DevicePermsRequestGranted",d="DevicePermsRequestDenied",h="PermanentDevicePermsRequestDenied"}),1e3),navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then((function(d){a(d.getTracks(),t).then((function(){navigator.mediaDevices.enumerateDevices().then((function(t){var d=Promise.all(t.map((function(t){if("videoinput"===t.kind){if(void 0!==e&&e)return(i=t.deviceId,new Promise((function(e,t){(function(e){return new Promise((function(t,n){navigator.mediaDevices.getUserMedia({audio:!1,video:{deviceId:{exact:e}}}).then((function(e){var n;e.getTracks().forEach((function(e){void 0===n&&void 0!==e.getCapabilities&&(n=e.getCapabilities())})),a(e.getTracks()).then((function(){t(n)})).catch((function(){}))})).catch((function(e){l(e)?t(void 0):n(e)}))}))})(i).then((function(t){var n,o,r=!1;void 0!==t&&void 0!==t.width&&void 0!==t.height&&(n=[t.width.max,t.height.max],void 0!==t.resizeMode&&(r=t.resizeMode.some((function(e){return"crop-and-scale"===e})))),o=r&&void 0!==n?s.map((function(e){return new Promise((function(t){var i=e[0],o=e[1];void 0!==n&&i<=n[0]&&o<=n[1]?t([i,o]):t(void 0)}))})):s.map((function(e){var t=e[0],n=e[1],o={audio:!1,video:{deviceId:{exact:i},width:{exact:t},height:{exact:n}}};return new Promise((function(e,i){navigator.mediaDevices.getUserMedia(o).then((function(i){a(i.getTracks()).then((function(){e([t,n])})).catch((function(){}))})).catch((function(t){l(t)?e(void 0):i(t)}))}))}));var u=o.reduce((function(e,t){return e.then((function(e){return t.then((function(t){return void 0!==t&&e.push(t),Promise.resolve(e)})).catch((function(){return[]}))}))}),Promise.resolve([]));Promise.resolve(u).then((function(t){void 0!==n&&s.some((function(e){return void 0!==n&&e[0]===n[0]&&e[1]===n[1]}))&&t[t.length-1][0]!==n[0]&&t[t.length-1][1]!==n[1]&&t.push(n);var o=new Map;t.forEach((function(e){var t=c(i,e[0],e[1]);void 0!==t&&o.set(t.id,t)})),e(o)})).catch((function(){}))})).catch((function(e){t(e)}))}))).then((function(e){return Promise.resolve({device:t,resolutions:e})})).catch((function(e){return Promise.reject(e)}));var n=new Map;return s.forEach((function(e){var i=c(t.deviceId,e[0],e[1]);void 0!==i&&n.set(i.id,i)})),Promise.resolve({device:t,resolutions:n})}var i;return Promise.resolve({device:t})}))),p={mics:new Map,cams:new Map};d.then((function(e){var t=!0;if(e.forEach((function(e){var n=e.device;""!==n.label&&(t=!1),"audioinput"===n.kind?p.mics.set(n.deviceId,{id:n.deviceId,label:n.label}):"videoinput"===n.kind&&void 0!==e.resolutions&&e.resolutions.size>0&&p.cams.set(n.deviceId,{id:n.deviceId,label:n.label,resolutions:e.resolutions})})),t){var s=r.ag.permanentPermsMessage;return(0,o.fg)(h,{time_elapsed_ms:Date.now()-f}),void i(new Error(s))}(0,o.fg)(u,{time_elapsed_ms:Date.now()-f}),n(p)})).catch((function(e){i(e)}))})).catch((function(){}))})).catch((function(){}))})).catch((function(e){(0,o.fg)(d,{time_elapsed_ms:Date.now()-f}),i(e)}))}))}function d(){return navigator.mediaDevices.enumerateDevices().then((function(e){var t=!1,n=!1;return e.forEach((function(e){""!==e.label&&("audioinput"===e.kind&&(t=!0),"videoinput"===e.kind&&(n=!0))})),t&&n}))}},2400:function(e,t,n){"use strict";n.d(t,{m:function(){return o}});var i=n(3753),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};(0,i.Ue)("api/ts/accounts/broadcaster_suspension/").then((function(t){JSON.parse(t.responseText).is_suspended?window.location.reload():e()})).catch((function(e){error(e.message)}))}},1903:function(e,t,n){"use strict";n.d(t,{J7:function(){return d},WQ:function(){return o},cO:function(){return u}});var i=n(3543);function o(e){var t=function(e){return e>1?"s":""},n=Math.floor(e/3600),i=Math.floor((e%=3600)/60),o=e%60;return n>0?i>0?"".concat(n," hour").concat(t(n),", ").concat(i," minute").concat(t(i)):"".concat(n," hour").concat(t(n)):i>0?o>0?"".concat(i," minute").concat(t(i),", ").concat(o," second").concat(t(o)):"".concat(i," minute").concat(t(i)):o>0?"".concat(o," second").concat(t(o)):"less than a second"}var r=[{name:"year",seconds:31536e3,translation:i.ag.years,ago:i.ag.yearsAgo,fromNow:i.ag.yearsFromNow},{name:"month",seconds:2592e3,translation:i.ag.months,ago:i.ag.monthsAgo,fromNow:i.ag.monthsFromNow},{name:"week",seconds:604800,translation:i.ag.weeks,ago:i.ag.weeksAgo,fromNow:i.ag.weeksFromNow},{name:"day",seconds:86400,translation:i.ag.days,ago:i.ag.daysAgo,fromNow:i.ag.daysFromNow},{name:"hour",seconds:3600,translation:i.ag.hours,ago:i.ag.hoursAgo,fromNow:i.ag.hoursFromNow},{name:"minute",seconds:60,translation:i.ag.minutes,ago:i.ag.minutesAgo,fromNow:i.ag.minutesFromNow},{name:"second",seconds:1,translation:i.ag.seconds,ago:i.ag.secondsAgo,fromNow:i.ag.secondsFromNow}],s=r.findIndex((function(e){return"hour"===e.name})),a=r.findIndex((function(e){return"minute"===e.name})),l=function(e){return 1===e?"":arguments.length>1&&void 0!==arguments[1]?arguments[1]:"s"},c=function(e){return e?"from now":"ago"};function u(e,t){var n=t.getTime()-e.getTime();if(0===n)return"now";var i=Math.floor(Math.abs(n)/1e3),o=n>0;if(i<60)return"".concat(i," second").concat(l(i)," ").concat(c(o));var s,a=0,u=0,d="";for(s=0;s<r.length;s+=1)if(a=Math.floor(i/r[s].seconds),u=r[s].seconds,0!==a){d="".concat(a," ").concat(r[s].name).concat(l(a));break}if(i>86400&&s+1<r.length){var h=r[s+1],f=Math.floor((i-u*a)/h.seconds);0!==f&&(d="".concat(d,", ").concat(f," ").concat(h.name).concat(l(f)))}return"".concat(d," ").concat(c(o))}function d(e,t){if(void 0===t||0===t)return e?i.ag.never:"";var n=new Date(1e3*t);return e?function(e){for(var t=((new Date).getTime()-e.getTime())/1e3,n=0;n<=r.length;n+=1){var o=r[n];if(t>=o.seconds)return o.ago(Math.floor(t/o.seconds))}return i.ag.now}(n):function(e){for(var t=((new Date).getTime()-e.getTime())/1e3,n=function(e){var n,i=t/r[e].seconds;i=e===s?(n=i,Math.floor(10*n)/10):Math.floor(i);var o=e===s||e===a;return r[e].translation(i,o)},i=0;i<=a;i+=1)if(t>=r[i].seconds)return n(i);return n(a)}(n)}},2890:function(e,t,n){"use strict";n.d(t,{ry:function(){return o},xF:function(){return s},xJ:function(){return r}});var i=n(1794),o=new i.xB("privateSettingsClicked"),r=new i.xB("broadcastSettingsSaved"),s=new i.xB("genderSettingsSaved")},1986:function(e,t,n){"use strict";n.d(t,{nC:function(){return N},OO:function(){return H},QU:function(){return j},uT:function(){return z}});for(var i=n(4649),o=n(1976),r=n(2951),s=n(7591),a=n(9492),l=n(7597),c=n(434),u=n(3940),d=n(8759),h=n(9784),f=n(3753),p=n(2394),m=n(3705),v=[],g=0;g<256;++g)v[g]=(g+256).toString(16).substr(1);var y=n(1522),b=n(1794),w=n(5078),C=n(3543),x=n(8498),k=n(1289),S={v:[{name:"version",reg:/^(\d*)$/,fmt:"%s"}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,fmt:"%s %s %d %s IP%d %s",names:["username","sessionId","sessionVersion","netType","ipVer","address"]}],s:[{name:"name",reg:/(.*)/,fmt:"%s"}],i:[{name:"description",reg:/(.*)/,fmt:"%s"}],u:[{name:"uri",reg:/(.*)/,fmt:"%s"}],e:[{name:"email",reg:/(.*)/,fmt:"%s"}],p:[{name:"phone",reg:/(.*)/,fmt:"%s"}],z:[{name:"timezones",reg:/(.*)/,fmt:"%s"}],r:[{name:"repeats",reg:/(.*)/,fmt:"%s"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,fmt:"%d %d",names:["start","stop"]}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,fmt:"IN IP%d %s",names:["version","ip"]}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,fmt:"%s:%s",names:["type","limit"]}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,fmt:"%s %d %s %s",names:["type","port","protocol","payloads"]}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],fmt:function(e){return void 0!==e.encoding?"rtpmap:%d %s/%s/%s":void 0!==e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],fmt:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,fmt:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],fmt:function(e){return void 0!==e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],fmt:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],fmt:function(e){return void 0!==e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],fmt:function(e){return"extmap:%d"+(void 0!==e.direction?"/%s":"%v")+(void 0!==e["encrypt-uri"]?" %s":"%v")+" %s"+(void 0!==e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/,fmt:"%s"},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],fmt:function(e){return void 0!==e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,fmt:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,fmt:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,fmt:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,fmt:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,fmt:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,fmt:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/,fmt:"%s"},{name:"icelite",reg:/^(ice-lite)/,fmt:"%s"},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,fmt:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,fmt:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],fmt:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],fmt:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=void 0!==e.raddr?" raddr %s rport %d":"%v%v",t+=void 0!==e.tcptype?" tcptype %s":"%v",void 0!==e.generation&&(t+=" generation %d"),(t+=void 0!==e["network-id"]?" network-id %d":"%v")+(void 0!==e["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/,fmt:"%s"},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,fmt:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,fmt:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],fmt:function(e){var t="ssrc:%d";return void 0!==e.attribute&&(t+=" %s",void 0!==e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],fmt:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],fmt:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],fmt:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/,fmt:"%s"},{name:"rtcpRsize",reg:/^(rtcp-rsize)/,fmt:"%s"},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],fmt:function(e){return void 0!==e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,fmt:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],fmt:function(e){return void 0!==e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],fmt:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~,]+))?$"),names:["dir1","list1","dir2","list2"],fmt:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],fmt:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,fmt:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],fmt:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/,fmt:"%s"},{name:"label",reg:/^label:(.+)/,fmt:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,fmt:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,fmt:"max-message-size:%s"},{name:"keywords",reg:/^keywds:(.+)$/,fmt:"keywds:%s"},{name:"content",reg:/^content:(.+)/,fmt:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,fmt:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,fmt:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,fmt:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],fmt:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"],reg:/(.*)/,fmt:"%s"}]},T=/(\r\n|\r|\n)/,I=/%[sdv%]/g,R=RegExp.prototype.test.bind(/^([a-z])=(.*)/),P=function(e){var t=1,n=arguments,i=n.length;return e.replace(I,(function(e){if(t>=i)return e;var o=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(o);case"%d":return String(Number(o));case"%v":return""}return""}))},M=function(e,t,n){var i=t.fmt;if("function"==typeof t.fmt){var o=n;void 0===t.push&&void 0!==t.name&&(o=n[t.name]),i=t.fmt(o)}var r=["".concat(e,"=").concat(i)];if(void 0!==t.names)for(var s=0;s<t.names.length;s+=1){var a=t.names[s];void 0!==t.name?r.push(n[t.name][a]):r.push(n[t.names[s]])}else void 0!==t.name&&r.push(n[t.name]);return P.apply(void 0,r)},A=function(e){return String(Number(e))===e?Number(e):e},E=["v","o","s","i","u","e","p","c","b","t","r","z","a"],B=["i","c","b","a"],L=["H264","VP8","VP9"],O=function(){function e(t){(0,r.Z)(this,e),this.sdpStr=t,this.sdp=function(e){var t,n={},i=[];t=n,e.split(T).filter(R).forEach((function(e){var n=e[0],o=e.slice(2);"m"===n&&(i.push({rtp:[],fmtp:[]}),t=i[i.length-1]),void 0!==S[n]&&S[n].some((function(e){return!!e.reg.test(o)&&(function(e,t,n){void 0!==e.push&&void 0===t[e.push]?t[e.push]=[]:void 0!==e.name&&void 0!==e.names&&void 0===t[e.name]&&(t[e.name]={});var i={};void 0===e.push&&(i=void 0!==e.name&&void 0!==e.names?t[e.name]:t),function(e,t,n,i){if(null!==e)if(void 0!==i&&void 0===n)t[i]=A(e[1]);else if(void 0!==n)for(var o=0;o<n.length;o+=1)o+1<e.length&&(t[n[o]]=A(e[o+1]))}(n.match(e.reg),i,e.names,e.name),void 0!==e.push&&t[e.push].push(i)}(e,t,o),!0)}))}));var o=n;return o.media=i,o}(t);var n=(0,k.dD)(window.location.search)["video-bitrate"];if(void 0!==n){var i=parseInt(n);this.forceVideoBitrate(i),this.videoBitrateOverriden=!0}var o=(0,k.dD)(window.location.search)["video-codecs"];if(void 0!==o){var s,a=o.split(","),l=(0,k.dD)(window.location.search)["video-profiles"];a.length>0&&void 0!==l&&(s=l.split(",")),this.forceVideoCodecs(a,s),this.videoCodecsOverriden=!0}}return(0,o.Z)(e,[{key:"write",value:function(){return function(e,t){void 0===t&&(t={outerOrder:E,innerOrder:B}),void 0===e.version&&(e.version=0),void 0===e.name&&(e.name=" "),e.media.forEach((function(e){void 0===e.payloads&&(e.payloads="")}));var n=[];return t.outerOrder.forEach((function(t){S[t].forEach((function(i){void 0!==i.name&&i.name in e&&void 0!==e[i.name]?n.push(M(t,i,e)):void 0!==i.push&&i.push in e&&void 0!==e[i.push]&&e[i.push].forEach((function(e){n.push(M(t,i,e))}))}))})),e.media.forEach((function(e){n.push(M("m",S.m[0],e)),void 0!==t&&t.innerOrder.forEach((function(t){S[t].forEach((function(i){void 0!==i.name&&i.name in e&&void 0!==e[i.name]?n.push(M(t,i,e)):void 0!==i.push&&i.push in e&&void 0!==e[i.push]&&e[i.push].forEach((function(e){n.push(M(t,i,e))}))}))}))})),n.join("\r\n")+"\r\n"}(this.sdp)}},{key:"forceVideoBitrate",value:function(e){var t=this;if(!this.videoBitrateOverriden){var n=this.videoBitrate(e);return this.sdp.media.forEach((function(e){"video"===e.type&&t.addBitrates(n,e,L)})),n}}},{key:"forceVideoCodecs",value:function(e,t){var n=this;this.videoCodecsOverriden||this.sdp.media.forEach((function(i){"video"===i.type&&n.filterCodecs(e,i,L,t)}))}},{key:"videoBitrate",value:function(e){var t=1500;return void 0!==e&&(e<=360?t=800:e>540&&(t=3e3)),t}},{key:"addBitrates",value:function(e,t,n){var i=this.findCodecs(n,t),o=[];return i.forEach((function(t){o.push({payload:t,config:"x-google-min-bitrate=".concat(e)}),o.push({payload:t,config:"x-google-max-bitrate=".concat(e)})})),t.fmtp=t.fmtp.concat(o),e}},{key:"filterCodecs",value:function(e,t,n,i){var o=this,r=this.findCodecs(n,t),s=this.findCodecs(e,t,i);t.rtp.filter((function(e){return r.some((function(t){return t===e.payload}))&&!s.some((function(t){return t===e.payload}))})).map((function(e){return e.payload})).forEach((function(e){o.removeCodec(e,t)}))}},{key:"findCodecs",value:function(e,t,n){var i,o=t.rtp.filter((function(t){var n=e.some((function(e){return e.toUpperCase()===t.codec.toUpperCase()}));return n&&"VP8"===t.codec.toUpperCase()&&(i=t.payload),n})).map((function(e){return e.payload}));if(void 0!==n){var r=["profile-level-id=","profile-id="],s=t.fmtp.filter((function(e){if(o.some((function(t){return t===e.payload}))){var t=!1;return e.config.split(";").forEach((function(e){r.forEach((function(i){if(e.startsWith(i)){var o=e.split(i)[1].toUpperCase();n.some((function(e){return e.toUpperCase()===o}))&&(t=!0)}}))})),t}return!1})).map((function(e){return e.payload}));void 0!==i&&o.some((function(e){return e===i}))&&s.unshift(i),o=s}return o}},{key:"removeCodec",value:function(e,t){var n=this,i="apt=",o=t.payloads.split(" ");o=o.filter((function(t){return parseInt(t)!==e})),t.payloads=o.join(" "),t.rtp=t.rtp.filter((function(t){return t.payload!==e}));var r=t.rtcpFb;void 0!==r&&(t.rtcpFb=r.filter((function(t){return t.payload!==e}))),t.fmtp=t.fmtp.filter((function(t){return t.payload!==e})),t.fmtp.filter((function(t){var n=t.config;if(n.startsWith(i)){var o=n.split(i)[1];if(parseInt(o)===e)return!0}return!1})).map((function(e){return e.payload})).forEach((function(e){n.removeCodec(e,t)}))}}]),e}(),D=n(2400);function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function F(e){var t;return t=void 0,void 0===e||"number"==typeof e?t=e:void 0!==e.exact?t=e.exact:void 0!==e.ideal&&(t=e.ideal),t}var _=function(e){(0,s.Z)(c,e);var t,n,i=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function c(e){var t;return(0,r.Z)(this,c),(t=i.call(this,e)).fatal=!0,t}return(0,o.Z)(c)}((0,c.Z)(Error)),N=function(){function e(t,n,i){var o;(0,r.Z)(this,e),this.lastMessage=0,this.lastStreamInfoMessage=0,this.bitrateNRSent=!1,this.streamInfo={applicationName:"live-origin",streamName:"stream",sessionId:"[empty]"},this.dossier=t,this.video=n,this.source=i,this.uuid=(o=new Uint8Array(16),window.crypto.getRandomValues(o),o[6]=15&o[6]|64,o[8]=63&o[8]|128,function(e){var t=0,n=v;return[n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]]].join("")}(o)),this.lastStreamInfoMessage=Date.now(),this.started=!1,this.browserAndPlatformInfo=(0,d.qq)()}return(0,o.Z)(e,[{key:"setup",value:function(e){var t=this;return this.constraints=e,new Promise((function(n,i){if("object"===("undefined"==typeof navigator?"undefined":(0,u.Z)(navigator))&&"object"===(0,u.Z)(navigator.mediaDevices)&&"function"==typeof navigator.mediaDevices.getUserMedia){var o="DevicePermsOnLoadDenied";window.setTimeout((function(){o="DevicePermsRequestDenied"}),500),navigator.mediaDevices.getUserMedia(e).then((function(o){t.stream=o;var r=o.getVideoTracks();0!==r.length&&void 0!==r[0]?(t.streamSettings=r[0].getSettings(),void 0!==t.streamSettings.width&&void 0!==t.streamSettings.height&&function(e,t,n){if(void 0!==n.video){var i=function(e){var t,n;t=void 0,n=void 0;var i=e.video;return void 0!==i&&(t=F(i.width),n=F(i.height)),{width:t,height:n}}(n);if(void 0!==i.width&&i.width!==e||void 0!==i.height&&i.height!==t){var o={WebRTCHandlerError:"Stream resolution different from constraint resolution"};if(void 0!==i.width){var r=n.video.width;"object"===(0,u.Z)(r)&&(r=JSON.stringify(r)),o.WebRTCHandlerConstraintWidth=r,o.WebRTCHandlerStreamWidth=e}if(void 0!==i.height){var s=n.video.height;"object"===(0,u.Z)(s)&&(s=JSON.stringify(s)),o.WebRTCHandlerConstraintHeight=s,o.WebRTCHandlerStreamHeight=t}(0,m.fg)("WebRTCHandlerSetup",o)}}}(t.streamSettings.width,t.streamSettings.height,e),debug("Got stream with constraints: ".concat(JSON.stringify(e))),debug("Using video device: ".concat(r[0].label)),t.video.srcObject=o,n(o)):i(new Error("We can't find any cameras, please ensure you have given permission to use your camera."))})).catch((function(e){var t=e.message;"ConstraintNotSatisfiedError"===e.name?t=C.ag.resolutionNotSupported:"OverconstrainedError"===e.name?t=C.ag.minResolutionNotSupported:"PermissionDeniedError"===e.name||"NotAllowedError"===e.name?t=C.ag.needCamAndMicPermission:""!==t&&null!==t||(t=C.ag.unknownDeviceError),(0,m.fg)(o);var n=new Error(t);n.name=e.name,i(n)}))}else i(new Error("Your browser doesn't support broadcasting. Recent versions of Safari, Firefox, or Chrome are recommended."))}))}},{key:"start",value:function(){var e=this;return new Promise((function(t,n){e.started=!0;var i=!1;if(void 0===e.stream)return e.close(),void n(new _("Unable to get video from camera. Try refreshing the page and make sure you allow video/audio if any prompts come up."));try{if(void 0===e.updateStatusInterval&&(e.closed=!1,e.updateStatusInterval=window.setInterval((function(){e.updateStatus()}),1e3)),e.createPeerConnection(),void 0===e.peerConnection)return void n(new Error("Unable to connect to peer"));e.peerConnection.oniceconnectionstatechange=function(o){void 0!==e.peerConnection?(debug("oniceconnectionstatechange (".concat(e.peerConnection.iceConnectionState,")"),o),i||("connected"!==e.peerConnection.iceConnectionState&&"completed"!==e.peerConnection.iceConnectionState||(i=!0,(0,m.fg)("WebRTCHandlerConnected",{WebRTCHandlerSource:e.source}),window.setTimeout((function(){var t;t={room:e.dossier.room,stream_type:"webrtc",origin_host:e.dossier.originHost,origin_region:e.streamData.region,webrtc_browser_info:JSON.stringify((0,d.qq)())},(0,f.I5)("api/ts/chat/webrtc-start/",t)}),1e3),H.fire(e.uuid),t()),"failed"===e.peerConnection.iceConnectionState&&(i=!0,n(new Error("WebRTC failed"))))):debug("oniceconnectionstatechange for closed peer",o)},e.connectOrigin(e.dossier,n)}catch(e){n(e)}}))}},{key:"stop",value:function(e){var t=this,n=!0===e;return new Promise((function(e){var i=function(){n||(t.started=!1,z.fire(t.uuid)),e(t.uuid)};if(n||t.close(),void 0!==t.websocket){if(t.websocket.readyState!==WebSocket.CLOSING&&t.websocket.readyState!==WebSocket.CLOSED)try{t.websocket.close()}catch(e){error("could not close websocket connection",{reason:e.toString()})}t.websocket=void 0}if(void 0!==t.peerConnection){try{t.peerConnection.close()}catch(e){error("could not close peer connection",{reason:e.toString()})}t.peerConnection=void 0}t.lastMessage=Date.now(),n||void 0===t.stream?i():(0,p.pn)(t.stream.getTracks()).then((function(){t.stream=void 0,i()})).catch((function(){}))}))}},{key:"setMute",value:function(e){void 0!==this.stream?this.stream.getAudioTracks().length>0&&(this.stream.getAudioTracks()[0].enabled=!e):error("no stream")}},{key:"reset",value:function(){var e=this;return new Promise((function(t,n){var i=e.started;e.stop().then((function(){void 0!==e.constraints?e.setup(e.constraints).then((function(o){i?e.start().then((function(){t()})).catch((function(e){n(e)})):t()})).catch((function(e){n(e)})):t()})).catch((function(e){n(e)}))}))}},{key:"close",value:function(){this.closed=!0,void 0!==this.updateStatusInterval&&(clearInterval(this.updateStatusInterval),this.updateStatusInterval=void 0)}},{key:"updateStatus",value:function(){var e=this;if(!0!==this.closed){var t=Date.now();if(this.lastStreamInfoMessage<t-1e4){if(this.lastStreamInfoMessage=t,!this.shouldUpdateOrigin())return void this.stop();(0,m.fg)("WebRTCHandlerRestart"),this.stop(!0).then((function(){var t="api/switch_origin/?current_origin=".concat(e.dossier.originHost);(0,f.Ue)(t).then((function(t){e.dossier.originHost=t.responseText,e.start().catch((function(e){error("Could not restart stream",{reason:e.message})}))})).catch((function(e){error("Could not get new origin",{reason:e.message})}))})).catch((function(){}))}var n=this.streamData;void 0===this.websocket&&(n={status:"connecting"}),void 0!==n&&j.fire({uuid:this.uuid,data:n})}else this.stop()}},{key:"shouldUpdateOrigin",value:function(){return void 0===(0,h.RH)()}},{key:"createPeerConnection",value:function(){var e=this;void 0!==this.stream?(void 0!==this.peerConnection&&(error("peerConnection already open"),this.peerConnection.close(),this.peerConnection=void 0),this.peerConnection=new RTCPeerConnection({iceServers:[]}),this.peerConnection.onicecandidate=function(e){debug("onicecandidate",e)},this.stream.getAudioTracks().length>0&&this.peerConnection.addTrack(this.stream.getAudioTracks()[0],this.stream),this.peerConnection.addTrack(this.stream.getVideoTracks()[0],this.stream),this.peerConnection.createOffer().then((function(t){e.updateSDP(t.sdp)})).catch((function(){}))):error("no stream")}},{key:"connectOrigin",value:function(e,t){var n=this;void 0!==this.websocket&&(error("WebSocket already open"),this.websocket.close(),this.websocket=void 0);var i=new WebSocket("wss://".concat(e.originHost).concat(e.originWSEndpoint));i.binaryType="arraybuffer",i.onopen=function(){n.websocket=i,i.send(JSON.stringify({method:"connect",username:e.room,password:e.originPassword}))},i.onerror=function(e){error("webrtc websocket error",{error:e}),t(new Error("WebSocket error: ".concat(JSON.stringify(e))))},i.onclose=function(){n.websocket=void 0},i.onmessage=function(e){var i;try{i=JSON.parse(e.data)}catch(e){return}switch(i.method){case"auth_valid":n.createOffer(t);break;case"stream_info":n.streamData=i,n.lastStreamInfoMessage=Date.now();break;case"already_publishing":n.lastMessage=Date.now(),(0,y.Cj)("You have started publishing from a new location, shutting down stream",(function(){w.u.fire(""),x.B.fire("")})),n.stop();break;case"shutdown":n.lastMessage<Date.now()-1e3&&(0,y.Cj)("Error Publishing Stream",(function(){w.u.fire(""),(0,D.m)((function(){}))})),n.stop();break;case"origin_info":break;default:"sendOffer"===i.command?n.processSdp(i,t):warn("Unhandled",i)}}}},{key:"correctedWidthAndHeight",value:function(){var e=this.streamSettings,t=e.width,n=e.height,i=Number(t)<Number(n),o=(0,d.jB)();return"mobile"===this.source&&i||void 0!==o&&o>=16?{width:n,height:t}:{width:t,height:n}}},{key:"createOffer",value:function(e){var t=this;void 0!==this.websocket?void 0!==this.stream?(this.websocket.send(JSON.stringify(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({method:"publish",frameRate:this.streamSettings.frameRate,source:this.source,browserAndPlatform:JSON.stringify(this.browserAndPlatformInfo)},this.correctedWidthAndHeight()))),void 0!==this.peerConnection?this.peerConnection.createOffer().then((function(n){void 0!==t.peerConnection?(debug("Got description ".concat(n)),n.sdp=t.updateSDP(n.sdp),debug("gotDescription: ".concat(JSON.stringify({sdp:n})," ").concat(t.peerConnection)),t.peerConnection.setLocalDescription(n).then((function(){void 0!==t.websocket?t.websocket.send(JSON.stringify({direction:"publish",command:"sendOffer",streamInfo:t.streamInfo,sdp:n})):e(new Error("ws undefined"))})).catch((function(t){e(t)}))):error("peerConnection not open")})).catch((function(t){e(t)})):error("peerConnection not open")):e(new Error("stream undefined")):e(new Error("ws undefined"))}},{key:"processSdp",value:function(e,t){if(void 0!==this.peerConnection){var n=e.sdp;null!=n&&(debug("sdp: ",n),this.peerConnection.setRemoteDescription(n).catch((function(e){t(e)})));var i=e.iceCandidates;if(void 0!==i){var o,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(i);try{for(r.s();!(o=r.n()).done;){var s=o.value;debug("iceCandidates: ",s),this.peerConnection.addIceCandidate(new RTCIceCandidate(s)).catch((function(e){t(e)}))}}catch(e){r.e(e)}finally{r.f()}}}else error("peerConnection not open")}},{key:"updateSDP",value:function(e){if(void 0===e)return error("sdpStr undefined"),"";debug("Original SDP",e);var t=new O(e);(0,d.Tt)()?t.forceVideoCodecs(["H264"],["42e01f"]):t.forceVideoCodecs(["H264","VP8"],["42e01f"]);var n=t.forceVideoBitrate(this.streamSettings.height);return void 0!==n&&(this.bitrateNRSent||((0,m.fg)("WebRTCHandlerSDPUpdate",{WebRTCHandlerVideoBitrate:n}),this.bitrateNRSent=!0)),e=t.write(),debug("Updated SDP",e),e}}],[{key:"isWebRTCNotYetSupported",value:function(){return(0,d.v8)()}},{key:"isWebRTCNeverSupported",value:function(){return(0,d.bf)()}},{key:"canUseWebRTC",value:function(){return!e.isWebRTCNotYetSupported()&&!e.isWebRTCNeverSupported()}}]),e}(),j=new b.xB("streamStatusUpdate"),H=new b.xB("streamStart"),z=new b.xB("streamStop")},4406:function(e,t,n){"use strict";n.d(t,{x:function(){return a}});var i=n(2951),o=n(1976),r=n(8263),s=["smcBadge","followerBadge","notesBadge"],a=function(){function e(){(0,i.Z)(this,e)}return(0,o.Z)(e,null,[{key:"registerGenerator",value:function(t,n){e.badgeGenerators.has(t)?error("Generator already registered for badge",t):e.badgeGenerators.set(t,n)}},{key:"createBadges",value:function(t){var n=document.createElement("span");return(0,r.Zs)(n,{display:"inline-block",verticalAlign:"middle",marginTop:"-.5em",marginBottom:"-.5em",marginRight:"1px",overflow:"visible"}),s.forEach((function(i){var o=e.badgeGenerators.get(i);if(void 0!==o){var r=o(t);r.classList.add("".concat(i,"_").concat(t)),n.appendChild(r)}})),n}},{key:"getBadgeElements",value:function(e,t){return Array.from(document.body.querySelectorAll(".".concat(e,"_").concat(t)))}}]),e}();a.badgeGenerators=new Map},6626:function(e,t,n){"use strict";n.d(t,{Ds:function(){return l},v:function(){return c}});var i=n(2800),o=n(8069),r=n(3705),s=!0,a=new o.d((function(){void 0===i.J.current.loggedInUser&&(0,r.fg)("AnonChatInputFocused")}),{bounceLimitMS:1500,debounceType:0}),l=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!0===s&&(a.callFunc(),!0!==e&&(s=!1))},c=function(){s=!0}},2008:function(e,t,n){"use strict";n.d(t,{P:function(){return k},T:function(){return S}});var i=n(2951),o=n(1976),r=n(7169),s=n(7591),a=n(9492),l=n(7597),c=n(5925),u=n(1185),d=n(2906),h=n(7693),f=n(1522),p=n(3753),m=n(391),v=n(695),g=n(9),y=n(1794),b=n(3543);function w(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var k=function(e){(0,s.Z)(n,e);var t=x(n);function n(e,o,s){var a;(0,i.Z)(this,n),(a=t.call(this)).username=e,a.message=o,a.chatConnection=s,a.formFocusableElements=[],a.endScreenFocusableElements=[],a.isOnEndScreen=!1,a.closeChatReportRequest=new y.xB("closeChatReportRequest"),a.reportSent=new y.xB("reportSent"),a.ignoreReportedUser=new y.xB("ignoreReportedUser"),a.trapFocus=function(e){e.stopPropagation(),27!==e.keyCode?9===e.keyCode&&(e.preventDefault(),a.isOnEndScreen?a.focusNextElement(a.endScreenFocusableElements,e.shiftKey):a.focusNextElement(a.formFocusableElements,e.shiftKey)):a.onChatReportClosed(!1)},(0,u.vP)(a.element,"chatReport"),a.element.style.position="static",a.element.style.fontFamily="UbuntuBold, Arial, Helvetica, sans-serif",a.element.style.fontSize="11px",a.form=document.createElement("form");var l=document.createElement("div"),c=document.createElement("div");a.commentInput=document.createElement("textarea"),a.form.appendChild(l),a.form.style.width="100%",(0,u.vP)(l,"headerDiv"),l.style.margin="6px",l.style.fontSize="13px",l.style.overflow="hidden",l.style.textOverflow="ellipsis",l.innerText="".concat(b.ag.report," ").concat(a.username);var d=a.categories(),p=function(){var e=document.createElement("label"),t=document.createElement("input"),n=document.createElement("span");e.style.display="flex",e.style.margin="6px 8px",e.style.alignItems="center",t.type="radio",t.style.margin="0 4px 0 2px",t.name="chatReport",t.value=m,n.innerText=d[m],n.style.flex="1",e.appendChild(t),e.appendChild(n),a.form.appendChild(e),e.onclick=function(){a.activeRadioInput=t},a.formFocusableElements.push(t)};for(var m in d)p();c.style.margin="6px 8px",a.commentInput.draggable=!1,a.commentInput.style.resize="none",a.commentInput.style.boxSizing="border-box",a.commentInput.style.height="40px",a.commentInput.style.width="100%",a.commentInput.style.borderWidth="1px",a.commentInput.style.borderStyle="solid",a.commentInput.maxLength=255,a.commentInput.oninput=function(){a.commentInput.value=a.commentInput.value.slice(0,255)},c.appendChild(a.commentInput),a.form.appendChild(c),a.formFocusableElements.push(a.commentInput),a.buttonContainer=document.createElement("div"),a.buttonContainer.style.margin="0 0 8px",a.buttonContainer.style.cssFloat="right",a.buttonContainer.style.fontFamily="UbuntuMedium, Arial, Helvetica, sans-serif";var v=document.createElement("button");(0,u.vP)(v,"submitButton"),v.type="submit",v.innerText=b.ag.reportCAPS,v.style.fontSize="11px",v.style.padding="4px 6px 4px 6px",v.style.marginRight="8px",v.style.borderRadius="4px",v.style.boxSizing="border-box",v.style.cursor="pointer",v.style.display="inline-block";var g=document.createElement("span");return(0,u.vP)(g,"cancelSpan"),g.innerText=b.ag.cancelCAPS,g.style.fontSize="11px",g.style.padding="4px 6px 4px 6px",g.style.marginRight="8px",g.style.borderRadius="4px",g.style.boxSizing="border-box",g.style.cursor="pointer",g.style.display="inline-block",a.buttonContainer.appendChild(g),a.buttonContainer.appendChild(v),a.form.appendChild(a.buttonContainer),a.formFocusableElements.push(g),a.formFocusableElements.push(v),a.createFinishReportScreen(),(0,h.j9)("submit",a.form,(function(e){e.preventDefault(),a.commentInput.blur(),void 0!==a.activeRadioInput?"other"!==a.activeRadioInput.value||""!==a.commentInput.value.trim()?(a.sendReport().then((function(e){e.success?a.setEndScreenText(b.ag.userHasBeenReported(a.username)):a.setEndScreenText(b.ag.unableToReport)})).catch((function(e){403===e.xhr.status?a.setEndScreenText(b.ag.tooManyReports):a.setEndScreenText(b.ag.unableToReport)})),a.onSendReport(),a.showEndReportScreen()):(0,f.Cj)(b.ag.reportAbuseDescriptionRequired,a.focusCommentBox.bind((0,r.Z)(a))):(0,f.Cj)(b.ag.selectReason,a.focusForm.bind((0,r.Z)(a)))})),(0,h.j9)("click",g,(function(e){e.preventDefault(),a.onChatReportClosed(!1)})),a.element.appendChild(a.form),a.element.appendChild(a.finishReportScreenDiv),(0,h.j9)("keydown",a.element,a.trapFocus),a}return(0,o.Z)(n,[{key:"categories",value:function(){return void 0===this.message?(error("ChatReport error: expected categories override"),{}):!0===this.message.isPrivate&&this.message.mediaList.length>0?{inappropriate:b.ag.reportMessageInappropriate,rude:b.ag.reportMessageRudeToBcaster,spam:b.ag.reportMessageSpam,photo:b.ag.reportMessageOffensiveMedia,other:b.ag.reportMessageOther}:{inappropriate:b.ag.reportMessageInappropriate,rude:b.ag.reportMessageRudeToBcaster,spam:b.ag.reportMessageSpam,other:b.ag.reportMessageOther}}},{key:"additionalFinishReportLinks",value:function(){return[]}},{key:"showEndReportScreen",value:function(){var e=this.element.offsetWidth,t=this.element.offsetHeight;this.form.style.display="none",this.finishReportScreenDiv.style.display="block",this.finishReportScreenDiv.style.width="".concat(e,"px"),this.finishReportScreenDiv.style.height="".concat(t,"px");var n=this.finishReportContainer.offsetHeight;this.finishReportContainer.style.padding="".concat(t/2-n/2,"px 0 0"),this.isOnEndScreen=!0}},{key:"reportEndpoint",value:function(){return void 0===this.message?(error("ChatReport error: expected reportEndpoint override"),""):"chatmessages/report/".concat(this.message.messageID,"/")}},{key:"sendReport",value:function(){var e=this;return new Promise((function(t,i){var o=void 0===e.activeRadioInput?"":e.activeRadioInput.value,r=e.commentInput.value;return(0,p.I5)(e.reportEndpoint(),{spammer:e.username,category:o,additional_comments:r}).then((function(e){t(n.parseAbuseReportResult(e.responseText))})).catch((function(e){i(e)}))}))}},{key:"resetForm",value:function(){this.form.reset()}},{key:"createFinishReportScreen",value:function(){var e=this;this.finishReportScreenDiv=document.createElement("div"),this.finishReportContainer=document.createElement("div"),this.userReportedMessage=document.createElement("div"),this.ignoreUserLink=document.createElement("button");var t=this.additionalFinishReportLinks(),n=document.createElement("button");this.endScreenFocusableElements.push(this.ignoreUserLink);var i,o=w(t);try{for(o.s();!(i=o.n()).done;){var r=i.value;this.endScreenFocusableElements.push(r)}}catch(e){o.e(e)}finally{o.f()}this.endScreenFocusableElements.push(n),this.userReportedMessage.innerText=b.ag.sending,this.userReportedMessage.style.margin="0 0 8px 0",this.userReportedMessage.style.textAlign="center",(0,u.vP)(this.ignoreUserLink,"ignoreUserLink"),(0,u.vP)(n,"closeReportLink"),this.ignoreUserLink.style.textAlign="center",this.ignoreUserLink.style.fontSize="13px",this.ignoreUserLink.style.display="block",this.ignoreUserLink.style.margin="0 auto 8px",this.ignoreUserLink.style.background="none",this.ignoreUserLink.style.border="none",this.ignoreUserLink.style.cursor="pointer",this.updateIgnoreText((0,c.WU)(this.username));var s,a=w(t);try{for(a.s();!(s=a.n()).done;){var l=s.value;l.style.textAlign="center",l.style.fontSize="13px",l.style.display="block",l.style.margin="0 auto 8px",l.style.background="none",l.style.border="none",l.style.cursor="pointer"}}catch(e){a.e(e)}finally{a.f()}n.innerText=b.ag.close,n.style.textAlign="center",n.style.fontSize="13px",n.style.display="block",n.style.margin="0 auto 8px",n.style.background="none",n.style.border="none",n.style.cursor="pointer",this.underlineOnHover(n),this.finishReportScreenDiv.style.display="none",this.finishReportContainer.style.fontSize="13px",this.finishReportContainer.style.fontFamily="Arial, Helvetica, sans-serif",this.finishReportContainer.appendChild(this.userReportedMessage),this.shouldShowIgnore()&&this.finishReportContainer.appendChild(this.ignoreUserLink);var d,f=w(t);try{for(f.s();!(d=f.n()).done;){var p=d.value;this.finishReportContainer.appendChild(p)}}catch(e){f.e(e)}finally{f.f()}this.finishReportContainer.appendChild(n),this.finishReportScreenDiv.appendChild(this.finishReportContainer),(0,h.j9)("click",n,(function(t){t.preventDefault(),e.onChatReportClosed(!0)}))}},{key:"setEndScreenText",value:function(e){this.userReportedMessage.innerText=e}},{key:"disableIgnoreTextInteraction",value:function(){this.ignoreUserLink.disabled=!0,this.ignoreUserLink.style.cursor="default",this.ignoreUserLink.style.textDecoration="none",this.ignoreUserLink.onmouseenter=function(){},this.ignoreUserLink.onmouseleave=function(){},this.ignoreUserLink.onclick=function(){},(0,u.vP)(this.ignoreUserLink,"disabled");var e=this.endScreenFocusableElements.indexOf(this.ignoreUserLink);-1!==e&&this.endScreenFocusableElements.splice(e,1),this.ignoreUserLink.blur()}},{key:"focusNextElement",value:function(e,t){if(document.activeElement instanceof HTMLElement){var n,i=e.indexOf(document.activeElement);-1!==i?(t?(n=i-1)<0&&(n+=e.length):n=(i+1)%e.length,e[n].focus()):this.focusForm()}else this.focusForm()}},{key:"updateIgnoreText",value:function(e){var t=this;e?(this.ignoreUserLink.innerText=b.ag.userIsIgnored(this.username),this.disableIgnoreTextInteraction()):(this.ignoreUserLink.innerText=b.ag.ignoreUser(this.username),(0,u.FU)(this.ignoreUserLink,"disabled"),this.underlineOnHover(this.ignoreUserLink),this.ignoreUserLink.disabled=!1,this.ignoreUserLink.onclick=function(){(0,v.Cg)()?t.ignoreUserLink.innerText=b.ag.loginForIgnore:(t.onIgnoreUser(),t.ignoreUserLink.innerText=b.ag.userIsIgnored(t.username),t.ignoreReportedUser.fire(void 0)),t.disableIgnoreTextInteraction()})}},{key:"focusCommentBox",value:function(){this.commentInput.focus()}},{key:"focusForm",value:function(){this.isOnEndScreen?this.endScreenFocusableElements[0].focus():this.formFocusableElements[0].focus()}},{key:"tearDown",value:function(){}},{key:"underlineOnHover",value:function(e){e.onmouseenter=function(){e.style.textDecoration="underline"},e.onmouseleave=function(){e.style.textDecoration="none"}}},{key:"shouldShowIgnore",value:function(){return void 0!==this.chatConnection&&this.chatConnection.username()!==this.chatConnection.room()}},{key:"onIgnoreUser",value:function(){void 0!==this.chatConnection&&this.chatConnection.ignore(this.username)}},{key:"onSendReport",value:function(){this.reportSent.fire(void 0)}},{key:"onChatReportClosed",value:function(e){this.closeChatReportRequest.fire(e)}}],[{key:"parseAbuseReportResult",value:function(e){var t=new m.j(e);return{success:"success"===t.getStringOrUndefined("result"),html:t.getStringOrUndefined("html")}}}]),n}(g.w),S=function(e){(0,s.Z)(n,e);var t=x(n);function n(e,o,r){var s;return(0,i.Z)(this,n),(s=t.call(this,e,o)).ignoreFunc=r,s.element.style.minWidth="188px",s.element.style.maxWidth="268px",(0,h.j9)("pointerdown",s.commentInput,(function(e){return(0,d.o)(e)})),s}return(0,o.Z)(n,[{key:"categories",value:function(){return{inappropriate:b.ag.inappropriateMessage,rude:b.ag.rudeMessage,spam:b.ag.spamMessage,other:b.ag.reportMessageOther}}},{key:"shouldShowIgnore",value:function(){return!0}},{key:"onIgnoreUser",value:function(){this.ignoreFunc()}}]),n}(k)},1602:function(e,t,n){"use strict";n.d(t,{w:function(){return H},y:function(){return j}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(2800),c=n(6265),u=n(9760),d=n(1522),h=n(3753),f=n(391),p=n(8138),m=n(695),v=n(4411),g=n(4793),y=n(9),b=n(1794),w=n(1625),C=n(3340),x=n(3705),k=n(928),S=n(3243),T=n(8759),I=n(6272),R=n(1185),P=n(795),M=n(7693),A=n(3149),E=n(8263),B=n(3607),L=n(7108),O=n(3543),D=n(2974),U=n(9980);function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var F=function(e){(0,r.Z)(u,e);var t,n,c=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function u(e,t,n){var o;(0,i.Z)(this,u),(o=c.call(this)).tipSource=e,o.topSectionWrapper=t,o.sendTipButtonSpan=n,o.roomType="public",o.tokenBalance=0,o.isTokenAmountAlreadyTooHigh=!1,o.isHighTipAmountWarningActive=!1,o.divotOffsetLeft=96,o.tipSent=new b.xB("tipSent"),o.closed=new b.xB("tipClosed"),o.isVisible=!1,o.element.id="SplitModeTipCallout",o.element.dataset.testid="send-tip-callout",(0,R.vP)(o.element,R.ql.defaultColor),o.element.style.display="none",o.element.style.position="absolute",o.element.style.width="390px",o.element.style.height="auto",o.element.style.top="0",o.element.style.borderWidth="2px",o.element.style.borderStyle="solid",o.element.style.borderRadius="4px",o.element.style.fontFamily="UbuntuRegular, Helvetica, Arial, sans-serif",o.element.style.fontSize="12px",o.element.style.overflow="visible";var r=function(e){o.sendTipButton.hasFocus()&&(e?o.sendTipButton.focusNextMenuItem():o.sendTipButton.focusPrevMenuItem())};(0,M.j9)("keydown",o.element,(function(e){27===e.keyCode?o.hide():9===e.keyCode?(e.shiftKey?o.sendTipButton.hasFocus()&&!o.sendTipButton.focusPrev()?o.tipMessageTextarea.focus():document.activeElement===o.tipMessageTextarea?void 0!==o.tipOptionsSelect?o.tipOptionsSelect.focus():o.tipAmountInput.focus():document.activeElement===o.tipOptionsSelect?o.tipAmountInput.focus():o.sendTipButton.hasFocus()||o.sendTipButton.focusPrev():o.sendTipButton.hasFocus()&&!o.sendTipButton.focusNext()?o.tipAmountInput.focus():document.activeElement===o.tipAmountInput?void 0!==o.tipOptionsSelect?o.tipOptionsSelect.focus():o.tipMessageTextarea.focus():document.activeElement===o.tipOptionsSelect?o.tipMessageTextarea.focus():o.sendTipButton.hasFocus()||o.sendTipButton.focusNext(),e.preventDefault()):40===e.keyCode?(e.preventDefault(),r(!0)):38===e.keyCode&&(e.preventDefault(),r(!1))})),o.bottomDivot=(0,A.G3)("","","74px"),(0,R.vP)(o.bottomDivot,"bottomDivot"),o.element.appendChild(o.bottomDivot),o.topDivot=(0,A.fR)("","","74px"),(0,R.vP)(o.topDivot,"topDivot"),o.element.appendChild(o.topDivot),o.leftDivot=(0,A.vV)("","","30px"),(0,R.vP)(o.leftDivot,"leftDivot"),o.element.appendChild(o.leftDivot),o.overlay.style.bottom="";var s=document.createElement("div");(0,R.vP)(s,"titleBar"),s.innerText=O.ag.sendTipText,s.style.fontSize="15px",s.style.fontFamily="UbuntuBold, Helvetica, Arial, sans-serif",s.style.padding="6px",o.element.appendChild(s);var a=document.createElement("div");a.style.display="inline-block",a.style.width="100%";var f=document.createElement("span");f.innerText=O.ag.currentBalanceText,f.style.fontWeight="bold",f.style.display="inline-block",f.style.padding="6px",a.appendChild(f),o.tokenBalanceSpan=document.createElement("span"),o.tokenBalanceSpan.dataset.testid="token-balance",(0,R.vP)(o.tokenBalanceSpan,"tokenBalance"),o.tokenBalanceSpan.style.display="inline-block",o.tokenBalanceSpan.style.fontWeight="bold",o.tokenBalanceSpan.style.padding="6px 6px 6px 0",a.appendChild(o.tokenBalanceSpan);var p=document.createElement("a");(0,R.vP)(p,"purchaseTokens"),p.innerText=O.ag.purchaseTokensText,p.href=(0,h.BN)("".concat(P.Ky,"?source=").concat(l.J.current.PurchaseEventSources.TOKEN_SOURCE_TIP_CALLOUT)),p.style.display="inline-block",p.style.fontSize="11px",p.style.marginLeft="12px",p.style.cssFloat="right",p.style.padding="6px",p.dataset.testid="purchase-tokens",p.onclick=function(){return(0,P.Hi)({popupOnly:"embed"===o.tipSource,source:l.J.current.PurchaseEventSources.TOKEN_SOURCE_TIP_CALLOUT}),!1},a.appendChild(p),o.element.appendChild(a),o.lowScoreWarning=document.createElement("div"),(0,R.vP)(o.lowScoreWarning,"warning"),o.lowScoreWarning.style.display="none",o.lowScoreWarning.style.fontWeight="bold",o.lowScoreWarning.style.padding="6px",o.lowScoreWarning.style.textAlign="center",o.lowScoreWarning.style.position="absolute",o.lowScoreWarning.style.left="50%";var m=document.createElement("div");m.innerText=O.ag.satisfactionWarningText,o.lowScoreWarning.appendChild(m);var v=document.createElement("div");v.innerText=O.ag.tipWarningText,o.lowScoreWarning.appendChild(v),o.element.appendChild(o.lowScoreWarning),o.sendTipForm=document.createElement("form");var y=document.createElement("label"),w=document.createElement("span");w.innerText=O.ag.tipAmountText,w.style.display="inline-block",w.style.padding="6px",y.appendChild(w),o.tipAmountInput=(0,P._r)(),o.tipAmountInput.dataset.testid="tip-amount-input",o.tipAmountInput.value="25",o.tipAmountInput.min="1",o.tipAmountInput.style.width="5em",o.tipAmountInput.style.display="inline-block",o.tipAmountInput.style.padding="4px",o.tipAmountInput.style.borderWidth="1px",o.tipAmountInput.style.borderStyle="solid",o.tipAmountInput.style.borderRadius="4px",o.tipAmountInput.onclick=function(){o.focusTipAmount()},y.appendChild(o.tipAmountInput),o.sendTipForm.appendChild(y),o.tipMessageLabel=document.createElement("div"),o.tipMessageLabel.innerText=O.ag.defaultTipMessageLabel,o.tipMessageLabel.style.padding="6px 6px 0 6px",o.sendTipForm.appendChild(o.tipMessageLabel),o.tipMessageDiv=document.createElement("div"),o.tipMessageTextarea=document.createElement("textarea"),o.tipMessageTextarea.dataset.testid="tip-message-textarea",(0,R.vP)(o.tipMessageTextarea,"tipMessageInput"),o.tipMessageTextarea.maxLength=255,o.tipMessageTextarea.style.width="100%",o.tipMessageTextarea.style.height="40px",o.tipMessageTextarea.style.resize="none",o.tipMessageTextarea.style.margin="".concat(I.Co,"px"),o.tipMessageTextarea.style.padding="4px",o.tipMessageTextarea.style.borderWidth="1px",o.tipMessageTextarea.style.borderStyle="solid",o.tipMessageTextarea.style.borderRadius="4px",o.tipMessageTextarea.style.boxSizing="border-box",o.tipMessageDiv.appendChild(o.tipMessageTextarea),o.sendTipForm.appendChild(o.tipMessageDiv),o.tipMessageLabel.onclick=function(){o.tipMessageTextarea.select()},o.invalidTipAmountDiv=document.createElement("div"),(0,R.vP)(o.invalidTipAmountDiv,"warning"),o.invalidTipAmountDiv.innerText=O.ag.tipAmountInvalid,o.invalidTipAmountDiv.style.display="none",o.invalidTipAmountDiv.style.paddingLeft="5px",o.invalidTipAmountDiv.dataset.testid="invalid-tip",y.appendChild(o.invalidTipAmountDiv);var C=document.createElement("div");return o.tipAmountInput.oninput=function(){o.tipAmountChange()},C.style.textAlign="right",C.style.position="relative",o.ctrlSNotice=document.createElement("div"),o.ctrlSNotice.innerText=O.ag.toggleWindowMessage,o.ctrlSNotice.style.position="absolute",o.ctrlSNotice.style.display="none",o.ctrlSNotice.style.fontSize="10px",o.ctrlSNotice.style.lineHeight="1.3em",o.ctrlSNotice.style.padding="6px",o.ctrlSNotice.style.textAlign="left",o.ctrlSNotice.style.top="6px",o.ctrlSNotice.style.left="0px",C.appendChild(o.ctrlSNotice),o.sendTipButton=new U.U,o.addChild(o.sendTipButton,C),o.sendTipForm.appendChild(C),o.element.appendChild(o.sendTipForm),g.kN.listen((function(e){o.hasLowSatisfactionScore=e.dossier.hasLowSatisfactionScore,o.isAgeVerified=e.dossier.isAgeVerified,o.roomName=e.chatConnection.room(),e.chatConnection.event.statusChange.listen((function(e){"privatewatching"===e.currentStatus?o.roomType="private":o.roomType="public"}))})),I.A3.listen((function(e){o.updateTokenBalance(e.tokens)})),o.repositionChildren(),(0,M.j9)("submit",o.sendTipForm,(function(e){e.preventDefault();var t=parseInt(o.tipAmountInput.value);if(o.isVisible&&!isNaN(t)&&o.sendTipButton.isEnabled()){if((0,x.fg)("SendTipClicked",{amount:t,location:"PMTab"}),t>100&&!o.isHighTipAmountWarningActive)return o.sendTipButton.promptUser(O.ag.tipConfirmationMessage(t)),o.isHighTipAmountWarningActive=!0,void o.repositionChildren();o.tipAmountInput.blur();var n=o.tipMessageTextarea.value;void 0!==o.tipOptionsSelect&&(n=""===o.tipMessageTextarea.value?o.tipOptionsSelect.value:"".concat(o.tipOptionsSelect.value," | ").concat(o.tipMessageTextarea.value)),(0,I.d1)({roomName:o.roomName,tipAmount:o.tipAmountInput.value,message:n,source:o.tipSource,tipRoomType:o.roomType,tipType:o.sendTipButton.getTipType(),videoMode:D.S.getVideoMode()}).then((function(e){e.success?(0,x.fg)("SendTipSuccess",{amount:t,location:"PMTab"}):void 0!==e.error?!0===e.showPurchaseLink?(0,P.dg)("".concat(e.error),!1,l.J.current.PurchaseEventSources.TOKEN_SOURCE_LOW_TOKEN_BALANCE,o.roomType):(0,d.Cj)(e.error):error("unknown send tip error"),o.removeHighTipAmountWarning(),o.tipMessageTextarea.value="",void 0!==e.tipsInPast24Hours&&I.H2.fire({tokens:e.tipsInPast24Hours,roomName:o.roomName}),o.tipSent.fire({amount:t,success:e.success})})).catch((function(e){error("Error sending tip. status: ".concat(e)),(0,d.Cj)(O.ag.errorSendingTip),o.tipSent.fire({amount:t,success:!1})})),o.hide()}})),o.overlayClick.listen((function(){o.hide()})),o.closed.listen((function(){o.sendTipButton.hideMenu()})),o}return(0,o.Z)(u,[{key:"showElement",value:function(){(0,S.Z)((0,a.Z)(u.prototype),"showElement",this).call(this),this.isVisible=!0}},{key:"repositionChildren",value:function(){this.tipMessageDiv.style.width="".concat(Math.max(0,this.element.clientWidth-2*I.Co),"px"),this.ctrlSNotice.style.maxWidth="".concat(Math.max(0,this.element.offsetWidth-this.sendTipButton.getOffsetWidth()-15),"px");var e=(0,E.r7)(this.sendTipButtonSpan);if(this.bottomDivot.style.display="none",this.topDivot.style.display="none",this.leftDivot.style.display="none","fixed"===this.topSectionWrapper.style.position)this.leftDivot.style.display="block",this.element.style.top="".concat(e.top-30,"px"),this.element.style.left="".concat(e.right+12,"px");else{var t=e.left-70,n=Math.max(0,t+this.element.offsetWidth-(0,B._U)()+4);t-n<0&&(n+=t-n),this.element.style.left="".concat(t-n,"px"),(0,T.s2)()||this.element.offsetHeight+e.bottom+20>(0,B.mP)()+document.documentElement.scrollTop?(this.bottomDivot.style.display="block",this.bottomDivot.style.left="".concat(this.divotOffsetLeft+n,"px"),this.element.style.top="".concat(e.top-this.element.offsetHeight-11,"px")):(this.topDivot.style.display="block",this.topDivot.style.left="".concat(this.divotOffsetLeft+n,"px"),this.element.style.top="".concat(e.bottom+14,"px"))}this.overlay.style.height="".concat(document.documentElement.offsetHeight,"px")}},{key:"tipAmountChange",value:function(){/^[1-9]\d*$/.test(this.tipAmountInput.value)?(this.sendTipButton.enable(),this.invalidTipAmountDiv.style.display="none",this.tokenBalance>0&&parseInt(this.tipAmountInput.value)>this.tokenBalance?this.isTokenAmountAlreadyTooHigh||((0,x.fg)("TokenAmountTooHigh"),this.isTokenAmountAlreadyTooHigh=!0):this.isTokenAmountAlreadyTooHigh=!1):(this.sendTipButton.disable(),this.invalidTipAmountDiv.style.display="inline-block"),this.isHighTipAmountWarningActive&&this.removeHighTipAmountWarning()}},{key:"removeHighTipAmountWarning",value:function(){this.sendTipButton.cancelPrompt(),this.isHighTipAmountWarningActive=!1}},{key:"show",value:function(e){var t=this;this.isAgeVerified?(0,m.Cg)('You must be logged in to tip. Click "OK" to login.')||(void 0!==e.amount&&(this.tipAmountInput.value=e.amount.toString(),this.tipAmountChange()),void 0!==e.message?this.tipMessageTextarea.value=e.message:this.tipMessageTextarea.value="",this.hasLowSatisfactionScore?this.lowScoreWarning.style.display="block":this.lowScoreWarning.style.display="none",void 0!==e.usedCtrlS&&e.usedCtrlS?this.ctrlSNotice.style.display="none":this.ctrlSNotice.style.display="block",(0,P.rv)(this.tipSource,this.sendTipButton),this.showElement(),this.showOverlay(),this.repositionChildren(),this.focusTipAmount(),this.tokenBalanceSpan.innerText="".concat(O.ag.loadingTextLower,"..."),(0,I.yX)(this.roomName).then((function(e){if(t.tipAmountInput.max=e.tokenBalance.toString(),void 0!==e.tipOptions){t.tipMessageLabel.innerText=e.tipOptions.label,void 0!==t.tipOptionsSelect&&t.tipMessageDiv.removeChild(t.tipOptionsSelect),t.tipOptionsSelect=document.createElement("select"),(0,R.vP)(t.tipOptionsSelect,"tipOptionsSelect"),t.tipOptionsSelect.style.width="100%",t.tipOptionsSelect.style.fontSize=".8125em",t.tipOptionsSelect.style.margin="".concat(I.Co,"px"),t.tipOptionsSelect.style.borderWidth="1px",t.tipOptionsSelect.style.borderStyle="solid",t.tipOptionsSelect.style.boxSizing="border-box",t.tipMessageDiv.insertBefore(t.tipOptionsSelect,t.tipMessageTextarea);var n=document.createElement("option");n.innerText="-- ".concat(O.ag.selectOneLabel," --"),t.tipOptionsSelect.appendChild(n);var i,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(e.tipOptions.options);try{for(o.s();!(i=o.n()).done;){var r=i.value;(n=document.createElement("option")).innerText=r.label,n.value=r.label,t.tipOptionsSelect.appendChild(n)}}catch(e){o.e(e)}finally{o.f()}}else void 0!==t.tipOptionsSelect&&(t.tipMessageLabel.innerText=O.ag.defaultTipMessageLabel,t.tipMessageTextarea.value="",t.tipMessageDiv.removeChild(t.tipOptionsSelect),t.tipOptionsSelect=void 0)})).catch((function(e){error("Error getting token balance. status: ".concat(e)),t.tokenBalanceSpan.innerText=O.ag.unknownText}))):(0,d.Cj)("This broadcaster doesn't accept tips.")}},{key:"hide",value:function(){this.element.style.display="none",this.tipAmountInput.blur(),this.hideOverlay(),this.isVisible=!1,this.closed.fire(void 0)}},{key:"setTipButtonSpan",value:function(e){this.sendTipButtonSpan=e}},{key:"focusTipAmount",value:function(){document.activeElement!==this.tipAmountInput&&(this.tipAmountInput.focus(),this.tipAmountInput.setSelectionRange(0,9999))}},{key:"updateTokenBalance",value:function(e){this.tokenBalance=e,this.tokenBalanceSpan.innerText="".concat(e," ").concat(O.ag.tokenOrTokensText(e,!1))}}]),u}(L.B),_=n(758),N=n(2750);var j=new b.xB("dossierLoaded",{listenersWarningThreshold:function(){return 10+b.q6}}),H=function(e){(0,r.Z)(S,e);var t,n,y=(t=S,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function S(e,t){var n;return(0,i.Z)(this,S),(n=y.call(this)).audioHolder=new p.n,n.lastLoadRoomId=0,n.listenerGroup=new b.mM,n.loadedRoom={room:"",roomTitle:""},n}return(0,o.Z)(S,[{key:"handleHistory",value:function(e){}},{key:"handleRoomStatusOffline",value:function(e){}},{key:"handleSetWidescreen",value:function(e){}},{key:"handlePlaySound",value:function(e){}},{key:"handleRoomInitiallyOffline",value:function(){}},{key:"handleRoomInitiallyOnline",value:function(){}},{key:"handleRoomStatusPasswordProtected",value:function(e){this.player.playerComponent.stop()}},{key:"handleUpdateChatSettings",value:function(e,t){e.updateEnterLeaveSettings(t.roomEntryFor,t.roomLeaveFor)}},{key:"handleRoomAccessDenied",value:function(e,t){(0,d.Cj)("Access Denied for room: ".concat(e,"\n\n").concat(t.getString("detail")))}},{key:"handleRoomUnauthorized",value:function(e){null!==window.top&&(window.top.location.href=(0,h.BN)("/auth/login/?next=".concat(window.location.pathname).concat(window.location.search)))}},{key:"handleRoomPasswordRequired",value:function(e){}},{key:"handleRoomLoaded",value:function(e){}},{key:"handleRoomStatusChangeNotification",value:function(e){}},{key:"handleResize",value:function(){}},{key:"setupAudio",value:function(){var e=this;_.gO.listen((function(t){e.viewerTipVolume=t.viewerTipVolume}))}},{key:"setupTipCallout",value:function(e,t,n){var i=this;this.tipCallout=this.addChild(new F(e,t,n)),_.jE.listen((function(e){i.tipCallout.isVisible?i.tipCallout.hide():i.tipCallout.show(e)})),this.tipCallout.tipSent.listen((function(){i.tipCallout.hide()}))}},{key:"setupLoginOverlay",value:function(){_.FJ.listen((function(e){(0,c.iW)({fromFeature:e,returnToPage:!0})})),(0,m.M5)((function(){_.FJ.fire(!0)}))}},{key:"setupResizeHandlers",value:function(){var e=this;u.nR.listen((function(){e.repositionChildrenRecursive(),e.handleResize()})),window.onorientationchange=function(){(0,w.Qg)(),e.repositionChildrenRecursive()}}},{key:"setupLoadRoom",value:function(e){var t=this;this.loadRoom(e,!0),C.WP.listen((function(e){(0,N.me)()>172800?window.location.pathname="/".concat(e,"/"):t.loadRoom(e,!0)})),g.kN.listen((function(e){t.handleRoomLoaded(e)}))}},{key:"createChatConnection",value:function(e){this.chatConnection=new v.E(e,!0)}},{key:"setDocumentTitle",value:function(e,t){document.title="".concat(e," at Chaturbate: ").concat(t)}},{key:"loadRoom",value:function(e,t){var n=this;if(!this.isRoomLoaded(e)){this.loadedRoom={room:e,roomTitle:""},this.lastLoadRoomId+=1;var i=this.lastLoadRoomId;this.getRoomDossierPromise(e).then((function(e){i===n.lastLoadRoomId&&n.onRoomDossierLoad(e,t)})).catch((function(t){n.onRoomDossierError(t,e)}))}}},{key:"getRoomDossierPromise",value:function(e){return(0,k.ss)(e)}},{key:"onRoomDossierLoad",value:function(e,t){var n=this;void 0!==this.cleanupLastRoomCallback&&this.cleanupLastRoomCallback(),(0,x.N$)(e.room),void 0!==this.additionalRoomCleanup&&this.additionalRoomCleanup(),this.setDocumentTitle(e.room,e.roomTitle),this.loadedRoom.roomTitle=e.roomTitle,l.q.setState(e),j.fire(e),this.createChatConnection(e),this.chatConnection.event.titleChange.listen((function(t){n.setDocumentTitle(e.room,t)})),this.viewerTipVolume=e.userChatSettings.viewerTipVolume,this.audioHolder.loadTipSounds(),this.chatConnection.event.playSound.listen((function(e){n.handlePlaySound(e)})),this.handleSetWidescreen(e.isWidescreen);var i,o,r={dossier:e,chatConnection:this.chatConnection};this.player.playerComponent.handleRoomLoaded(r),this.cleanupLastRoomCallback=function(){clearInterval(i),window.clearTimeout(o),n.chatConnection.disconnect(),n.player.playerComponent.stop(),n.listenerGroup.removeAll(),g.QN.fire(void 0)},t&&this.handleHistory(e),this.isRoomInitiallyOffline(r.dossier)?this.handleRoomInitiallyOffline():this.handleRoomInitiallyOnline(),g.kN.fire(r),this.listenerGroup.add(this.chatConnection.event.statusChange.listen((function(e){var t=["privatewatching","privatespying"],r=t.includes(e.currentStatus),s=t.includes(e.previousStatus);switch(("notconnected"===e.previousStatus||r||s)&&(clearInterval(i),i=window.setInterval((function(){n.chatConnection.updateRoomCount(r)}),1e3*(r?5:90)),o=window.setTimeout((function(){n.chatConnection.updateRoomCount(r||s)}),2e3)),e.currentStatus){case"passwordprotected":n.handleRoomStatusPasswordProtected(n.chatConnection);break;case"offline":n.handleRoomStatusOffline(n.chatConnection)}n.handleRoomStatusChangeNotification(e)}))),this.listenerGroup.add(_.gO.listen((function(e){n.handleUpdateChatSettings(n.chatConnection,e)}))),this.repositionChildrenRecursive()}},{key:"isRoomInitiallyOffline",value:function(e){return"offline"===e.roomStatus}},{key:"onRoomDossierError",value:function(e,t){if(e instanceof h.GM&&""!==e.xhr.responseText){if("application/json"!==e.xhr.getResponseHeader("Content-Type"))return void error("Error reading room dossier error",{room:t,error:e.xhr.responseText});var n=new f.j(e.xhr.responseText);switch(n.getStringOrUndefined("code",!1)){case"access-denied":this.handleRoomAccessDenied(t,n);break;case"unauthorized":this.handleRoomUnauthorized(t);break;case"password-required":this.handleRoomPasswordRequired(t);break;default:error("Error parsing room dossier error",{room:t,error:e.xhr.responseText})}}else error("Error occurred while processing room dossier",{room:t,error:e})}},{key:"isRoomLoaded",value:function(e){var t=e===this.loadedRoom.room,n=!this.chatConnection||this.chatConnection.room()===e;return t&&n}}]),S}(y.w)},1234:function(e,t,n){"use strict";n.d(t,{l:function(){return H},C:function(){return j}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(8759),c=n(1185),u=n(851),d=n(1612),h=n(407),f=n(7693),p=n(1522),m=n(3753),v=n(695),g=n(8958),y=n(4793),b=n(6767),w=n(9),C=n(8263),x=n(1794),k=n(3705),S=n(928),T=n(2717),I=n(7184),R=n(126),P=n(3243),M=n(5925),A=n(9874),E=n(3543);function B(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,s.Z)(this,n)}}var D=function(e){(0,r.Z)(n,e);var t=O(n);function n(){var e;(0,i.Z)(this,n),e=t.call(this),y.kN.listen((function(t){return e.chatConnection=t.chatConnection})),e.element.id="RemoveIgnoredUsersModal",e.element.style.position="fixed",e.element.style.width="410px",e.element.style.height="127px",e.element.style.borderRadius="6px",e.element.style.padding="10px",e.element.style.fontSize="12px",(0,c.vP)(e.overlay,"overlay"),e.overlay.style.background="",e.overlay.style.opacity="0.4";var o=e.createCloseButton("".concat(STATIC_URL,"close.svg"));(0,c.vP)(o,"lightCloseButton"),o.style.opacity="0.5",e.element.appendChild(o);var r=e.createCloseButton("".concat(STATIC_URL,"close-gray.svg"));(0,c.vP)(r,"darkCloseButton"),e.element.appendChild(r);var s=document.createElement("div");(0,c.vP)(s,"header"),s.innerText=E.ag.removeIgnoredUsers,s.style.fontSize="15px",s.style.fontFamily="UbuntuMedium, Helvetica, Arial, sans-serif",s.style.textAlign="center",e.element.appendChild(s),e.helpText=document.createElement("div"),(0,c.vP)(e.helpText,c.ql.textColor),e.helpText.innerText="",e.helpText.style.margin="10px 0",e.helpText.style.textAlign="center",e.element.appendChild(e.helpText),e.element.appendChild(e.createIgnoreWrapper()),e.element.appendChild(e.createUnignoreWrapper());var a=document.createElement("div");a.style.textAlign="right";var l=document.createElement("span");return(0,c.vP)(l,"saveButton"),l.innerText=E.ag.saveCAPS,l.style.display="inline-block",(0,c.vP)(l,"gradient"),l.style.fontFamily="UbuntuMedium, Helvetica, Arial, sans-serif",l.style.fontSize="14px",l.style.padding="5px 15px 5px 15px",l.style.marginTop="10px",l.style.borderRadius="4px",l.style.cursor="pointer",l.onclick=function(){e.saveButtonHandler()},a.appendChild(l),e.element.appendChild(a),e.overlayClick.listen((function(){e.hide()})),e}return(0,o.Z)(n,[{key:"repositionChildren",value:function(){this.element.style.left="".concat(Math.max(16,(document.documentElement.clientWidth-this.element.offsetWidth)/2),"px"),this.element.style.top="".concat((document.documentElement.clientHeight-this.element.offsetHeight)/2,"px")}},{key:"createSelectLabel",value:function(){var e=document.createElement("div");return(0,c.vP)(e,"bluetxt"),e.innerText=E.ag.unignoredUsers,e.style.fontFamily="UbuntuRegular, Helvetica, Arial, sans-serif",e.style.fontWeight="bold",e}},{key:"createMultipleSelect",value:function(){var e=document.createElement("select");return(0,c.vP)(e,"select"),e.multiple=!0,e}},{key:"createCloseButton",value:function(e){var t=this,n=document.createElement("img");return n.src=e,n.style.position="absolute",n.style.width="14px",n.style.height="14px",n.style.top="10px",n.style.right="10px",n.style.cursor="pointer",n.onclick=function(){t.hide()},n.onmouseenter=function(){n.style.opacity="1"},n.onmouseleave=function(){n.style.opacity="0.5"},n}}]),n}(A.z),U=function(e){(0,r.Z)(n,e);var t=O(n);function n(){var e;return(0,i.Z)(this,n),(e=t.call(this)).element.style.height="307px",e.helpText.innerText=E.ag.clickToUnignoreText,e}return(0,o.Z)(n,[{key:"initAndShow",value:function(){for(;null!==this.ignoredUsersSelect.firstChild;)this.ignoredUsersSelect.removeChild(this.ignoredUsersSelect.firstChild);for(;null!==this.unignoredUsersSelect.firstChild;)this.unignoredUsersSelect.removeChild(this.unignoredUsersSelect.firstChild);var e,t=B((0,M.ey)(!0));try{for(t.s();!(e=t.n()).done;){var i=e.value,o=document.createElement("option");o.innerText=i,o.value=i,this.ignoredUsersSelect.appendChild(o)}}catch(e){t.e(e)}finally{t.f()}(0,P.Z)((0,a.Z)(n.prototype),"show",this).call(this),this.repositionChildrenRecursive()}},{key:"createIgnoreWrapper",value:function(){var e=this,t=document.createElement("div");t.style.display="inline-block",t.style.marginRight="10px";var n=this.createSelectLabel();return n.innerText=E.ag.ignoredUsers,t.appendChild(n),this.ignoredUsersSelect=this.createMultipleSelect(),this.ignoredUsersSelect.style.borderWidth="1px",this.ignoredUsersSelect.style.borderStyle="solid",this.ignoredUsersSelect.style.borderRadius="4px",this.ignoredUsersSelect.style.marginTop="4px",this.ignoredUsersSelect.style.width="200px",this.ignoredUsersSelect.style.height="200px",this.ignoredUsersSelect.style.padding="2px",this.ignoredUsersSelect.style.overflow="auto",this.ignoredUsersSelect.onchange=function(){for(var t=e.ignoredUsersSelect.selectedOptions.length,n=(0,R.Z)(e.ignoredUsersSelect.selectedOptions),i=0;i<t;i+=1){var o=n[i];o.selected=!1,e.unignoredUsersSelect.appendChild(o)}},t.appendChild(this.ignoredUsersSelect),t}},{key:"createUnignoreWrapper",value:function(){var e=this,t=document.createElement("div");t.style.display="inline-block";var n=this.createSelectLabel();return n.innerText=E.ag.unignoredUsers,t.appendChild(n),this.unignoredUsersSelect=this.createMultipleSelect(),this.unignoredUsersSelect.style.borderWidth="1px",this.unignoredUsersSelect.style.borderStyle="solid",this.unignoredUsersSelect.style.borderRadius="4px",this.unignoredUsersSelect.style.marginTop="4px",this.unignoredUsersSelect.style.width="200px",this.unignoredUsersSelect.style.height="200px",this.unignoredUsersSelect.style.padding="2px",this.unignoredUsersSelect.style.overflow="auto",this.unignoredUsersSelect.onchange=function(){for(var t=e.unignoredUsersSelect.selectedOptions.length,n=(0,R.Z)(e.unignoredUsersSelect.selectedOptions),i=0;i<t;i+=1){var o=n[i];o.selected=!1,e.ignoredUsersSelect.appendChild(o)}},t.appendChild(this.unignoredUsersSelect),t}},{key:"saveButtonHandler",value:function(){var e,t=B(this.unignoredUsersSelect.options);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.chatConnection.unignore(n.value)}}catch(e){t.e(e)}finally{t.f()}this.hide()}}]),n}(D),Z=function(e){(0,r.Z)(n,e);var t=O(n);function n(){var e;return(0,i.Z)(this,n),e=t.call(this),(0,l.v8)()&&(e.element.style.height="307px"),e.helpText.innerText=E.ag.clickToUnignoreMobileText,e}return(0,o.Z)(n,[{key:"initAndShow",value:function(){for(;null!==this.unignoredUsersSelect.firstChild;)this.unignoredUsersSelect.removeChild(this.unignoredUsersSelect.firstChild);var e,t=B((0,M.ey)(!0));try{for(t.s();!(e=t.n()).done;){var i=e.value,o=document.createElement("option");o.innerText=i,o.value=i,this.unignoredUsersSelect.appendChild(o)}}catch(e){t.e(e)}finally{t.f()}(0,P.Z)((0,a.Z)(n.prototype),"show",this).call(this),this.repositionChildrenRecursive()}},{key:"createIgnoreWrapper",value:function(){return document.createElement("div")}},{key:"createUnignoreWrapper",value:function(){var e=document.createElement("div");e.style.display="inline-block";var t=this.createSelectLabel();return t.innerText=E.ag.unignoredUsers,e.appendChild(t),this.unignoredUsersSelect=this.createMultipleSelect(),this.unignoredUsersSelect.style.width="200px",(0,l.v8)()&&(this.unignoredUsersSelect.style.height="200px"),e.appendChild(this.unignoredUsersSelect),e}},{key:"saveButtonHandler",value:function(){var e,t=B(this.unignoredUsersSelect.selectedOptions);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.chatConnection.unignore(n.value)}}catch(e){t.e(e)}finally{t.f()}this.hide()}}]),n}(D),F=n(758),_=n(9420);function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var j=new x.xB("getChatMode"),H=function(e){(0,r.Z)(R,e);var t,n,w=(t=R,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function R(){var e;return(0,i.Z)(this,R),(e=w.apply(this,arguments)).chatSettingsSavedRequest=new x.xB("chatSettingsSavedRequest"),e}return(0,o.Z)(R,[{key:"initData",value:function(){this.isModerator=!1,this.isSupporter=!1,this.isAnon=!0,this.notificationsSettings=document.createElement("div"),this.notificationsSettings.dataset.testid="notifications-settings",this.otherSettings=document.createElement("div"),this.otherSettings.dataset.testid="other-settings",this.form=document.createElement("form"),this.usersSettings=document.createElement("div"),this.usersSettings.dataset.testid="users-settings",this.chatColorInput=document.createElement("input"),this.chatColorInput.dataset.testid="chat-color-input",this.chatColorSwatch=document.createElement("span"),this.chatColorSwatch.dataset.testid="chat-color-swatch",this.fontFamilySelect=document.createElement("select"),this.fontFamilySelect.dataset.testid="font-family-select",this.fontSizeSelect=document.createElement("select"),this.fontSizeSelect.dataset.testid="font-size-select",this.emoticonAutocompleteDelaySelect=document.createElement("select"),this.emoticonAutocompleteDelaySelect.dataset.testid="emoticon-autocomplete-delay-select",this.showEmoticonsCheckbox=new u.Z(!1,this.saveSettings.bind(this)),this.showEmoticonsCheckbox.element.dataset.testid="show-emoticons-checkbox",this.highestTokenColorSelect=document.createElement("select"),this.highestTokenColorSelect.dataset.testid="highest-token-color-select",this.notifyEntryForSelect=document.createElement("select"),this.notifyEntryForSelect.dataset.testid="notify-entry-for-select",this.notifyLeaveForSelect=document.createElement("select"),this.notifyLeaveForSelect.dataset.testid="notify-leave-for-select",this.tipVolumeValueLabel=document.createElement("label"),this.tipVolumeValueLabel.dataset.testid="tip-volume-value-label",this.tipVolumeSlider=new T.i({handleDiameter:16,handleColor:"rgb(246, 115, 0)",emptyBarColor:"#cccccc",filledBarColor:"rgb(246, 115, 0)"}),this.tipVolumeSlider.element.dataset.testid="tip-volume-slider",this.manageIgnoredUsersLink=document.createElement("label"),this.manageIgnoredUsersLink.dataset.testid="manage-ignored-users-link"}},{key:"initUI",value:function(){var e=this;this.element.style.width="100%",this.element.style.overflow="auto",this.element.style.boxSizing="border-box",this.element.style.padding="11px",this.element.style.fontSize="12px",this.element.style.position="static",this.form.style.marginBottom="40px",this.form.style.maxWidth="400px",this.element.appendChild(this.form);var t=document.createElement("div");t.dataset.testid="font-settings";var n=document.createElement("div");n.dataset.testid="emoticons-settings",this.form.appendChild(t),this.form.appendChild(n),this.form.appendChild(this.usersSettings),this.form.appendChild(this.notificationsSettings),this.form.appendChild(this.otherSettings),this.getStyles().styleContainer(t),this.getStyles().styleContainer(n),this.getStyles().styleContainer(this.usersSettings),this.getStyles().styleContainer(this.notificationsSettings),this.getStyles().styleContainer(this.otherSettings);var i=this.createHeader(E.ag.fontSettings);i.style.marginTop="0",t.appendChild(i),t.appendChild(this.createColorPicker()),t.appendChild(this.createFontFamilyPicker()),t.appendChild(this.createFontSizePicker()),n.appendChild(this.createHeader(E.ag.emoticonsSettings)),n.appendChild(this.createShowEmoticonsPicker()),n.appendChild(this.createEmoticonAutocompleteDelayPicker()),this.usersSettings.appendChild(this.createHeader(E.ag.usersSettings)),this.createUserSettings(),this.createNotificationSettings(),this.otherSettings.appendChild(this.createHeader(E.ag.otherSettings)),this.createOtherSettings(),F.gO.listen((function(t){e.updateChatSettings(t)})),y.kN.listen((function(t){e.handleRoomLoaded(t)})),_.CD.listen((function(t){e.isModerator=t.isMod,e.updateNotificationsSettingsVisibility()}))}},{key:"hideModals",value:function(){void 0!==this.colorPickerModal&&this.colorPickerModal.hide(),void 0!==this.removeIgnoredUserUI&&this.removeIgnoredUserUI.hide()}},{key:"updateChatColor",value:function(e){this.chatColorInput.value=e,this.chatColorSwatch.style.color=e,this.chatColorSwatch.style.backgroundColor=e}},{key:"openColorSwatch",value:function(e){if(!this.isBroadcaster()){if((0,v.Cg)('You must be logged in to change chat color. Click "OK" to login.'))return void e.preventDefault();if(!this.isSupporter)return(0,p.Cj)("You must be a supporter to change chat color"),void e.preventDefault()}void 0===this.colorPickerModal&&(this.colorPickerModal=this.addChild(this.createColorPickerModal())),this.colorPickerModal.show(this.chatColorInput.value)}},{key:"onColorPicked",value:function(e){this.updateChatColor(e),this.saveSettings()}},{key:"onColorHovered",value:function(e){this.updateChatColor(e)}},{key:"createColorPickerModal",value:function(){return new I.l(this.chatColorSwatch,this.onColorPicked.bind(this),this.onColorHovered.bind(this))}},{key:"createLabelWithTooltip",value:function(e,t){var n=document.createElement("span");(0,c.vP)(n,"tooltip-info-icon");var i=(0,h.T)({content:t,hasHTML:!1,divotPosition:1});i.style.position="fixed",i.style.display="block";var o=document.createElement("div");return o.style.display="inline-block",o.appendChild(e),o.appendChild(n),(0,C.nH)(n,!0).listen((function(e){var t;e?o.appendChild(i):null===(t=i.parentElement)||void 0===t||t.removeChild(i);var r=n.getBoundingClientRect(),s=(0,C.i6)();i.style.top="".concat(-s.top+r.top-i.offsetHeight-r.height/5-5,"px"),i.style.left="".concat(-s.left+r.left+(r.width-22),"px")})),o}},{key:"createRow",value:function(e,t,n,i,o){var r=this,s=document.createElement("div");if(this.getStyles().styleRowWrapper(s),void 0!==o?s.appendChild(this.createLabelWithTooltip(e,o)):s.appendChild(e),s.appendChild(n),void 0!==i&&n instanceof HTMLSelectElement){var a,l=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(i);try{for(l.s();!(a=l.n()).done;){var c=a.value,u=document.createElement("option");u.innerText=c.label.toString(),u.value=c.value.toString(),n.appendChild(u)}}catch(e){l.e(e)}finally{l.f()}}return this.getStyles().styleLabel(e,t),this.getStyles().styleInput(n),s.onclick=function(e){(0,v.Cg)('You must be logged in to change chat settings. Click "OK" to login.')?e.preventDefault():e.target!==n&&n.focus()},n.onmousedown=function(e){(0,v.Cg)('You must be logged in to change chat settings. Click "OK" to login.')&&e.preventDefault()},n instanceof HTMLSelectElement&&this.updateSelectWidth(n),(0,f.j9)("change",n,(function(e){n instanceof HTMLSelectElement&&r.updateSelectWidth(n),r.saveSettings()})),s}},{key:"createColorPicker",value:function(){var e=document.createElement("label"),t=this.createRow(e,E.ag.chatColor,this.chatColorSwatch);return t.dataset.testid="chat-settings-color-picker",t.appendChild(this.chatColorInput),this.styleWrapperCustom(t),this.styleLabelCustom(e),this.styleColorSwatch(this.chatColorSwatch),this.chatColorSwatch.onmousedown=this.openColorSwatch.bind(this),t.onclick=this.openColorSwatch.bind(this),this.chatColorInput.type="hidden",t}},{key:"createFontFamilyPicker",value:function(){var e=this,t=document.createElement("label"),n=this.createRow(t,E.ag.fontFamily,this.fontFamilySelect,this.getFontOptions());n.dataset.testid="chat-settings-font-family-picker";var i=function(t){if(!e.isBroadcaster()){if((0,v.Cg)('You must be logged in to change font family. Click "OK" to login.'))return void t.preventDefault();if(!e.isSupporter)return t.preventDefault(),e.fontFamilySelect.blur(),void(0,p.Cj)("You must be a supporter to change font family")}};return this.fontFamilySelect.onmousedown=i.bind(this),n.onclick=i.bind(this),n}},{key:"createFontSizePicker",value:function(){for(var e=[],t=9;t<=20;t+=1)e.push({label:"".concat(t,"pt"),value:"".concat(t,"pt")});var n=document.createElement("label");return this.createRow(n,E.ag.fontSize,this.fontSizeSelect,e)}},{key:"createShowEmoticonsPicker",value:function(){var e=document.createElement("label"),t=this.createRow(e,E.ag.showEmoticons,this.showEmoticonsCheckbox.element);return this.styleWrapperCustom(t),this.styleLabelCustom(e),this.styleEmoticonsCheckbox(this.showEmoticonsCheckbox.element),t}},{key:"createEmoticonAutocompleteDelayPicker",value:function(){var e=document.createElement("label");return this.createRow(e,E.ag.emoticonAutoCompleteDelay,this.emoticonAutocompleteDelaySelect,this.getEmoticonAutocompleteDelayOptions())}},{key:"createHighestTokenColorPicker",value:function(){var e=document.createElement("label");return this.createRow(e,E.ag.highestTokenColor,this.highestTokenColorSelect,this.getHighestTokenColorOptions(),E.ag.highestTokenColorTooltip)}},{key:"createNotifyEntryPicker",value:function(){var e=document.createElement("label");return this.createRow(e,E.ag.notifyEntryFor,this.notifyEntryForSelect,this.getNotifyEntryLeaveOptions())}},{key:"createNotifyLeavePicker",value:function(){var e=document.createElement("label");return this.createRow(e,E.ag.notifyLeaveFor,this.notifyLeaveForSelect,this.getNotifyEntryLeaveOptions())}},{key:"createTipVolumePicker",value:function(){var e=this,t="";j.listen((function(e){t=e}));var n=this.createRow(this.tipVolumeValueLabel,E.ag.tipVolume,this.tipVolumeSlider.element);return this.styleSlider(this.tipVolumeSlider),this.handleSliderMove(this.tipVolumeSlider.getValue()),this.tipVolumeSlider.valueChangeStart.listen((function(t){e.handleSliderMove(t)})),this.tipVolumeSlider.valueChanged.listen(this.handleSliderMove.bind(this)),this.tipVolumeSlider.valueChangeEnd.listen((function(n){e.handleSliderMove(n),(0,k.fg)("TipVolumeChanged",{tipvol:n,chatmode:t}),e.saveSettingsOrCookie()})),n.onclick=function(){},this.tipVolumeSlider.element.onmousedown=function(){},n}},{key:"handleSliderMove",value:function(e){this.tipVolumeValueLabel.innerText="".concat(E.ag.tipVolume," (").concat(Math.round(e),"%)")}},{key:"createManageIgnoredUsersPicker",value:function(){var e=this,t=this.createSettingsLink(this.manageIgnoredUsersLink,E.ag.viewEditIgnoredUsers);return t.appendChild(this.manageIgnoredUsersLink),this.manageIgnoredUsersLink.onclick=function(){(0,v.Cg)('You must be logged in to edit ignored users. Click "OK" to login.')||(void 0===e.removeIgnoredUserUI&&e.createManageIgnoredUsersUI(),void 0!==e.removeIgnoredUserUI&&e.removeIgnoredUserUI.initAndShow())},t}},{key:"createSettingsLink",value:function(e,t){var n=document.createElement("div");return this.getStyles().styleRowWrapper(n),(0,c.vP)(e,"link"),e.innerText=t,e.style.marginTop="16px",e.style.cursor="pointer",e.onmouseenter=function(){e.style.textDecoration="underline"},e.onmouseleave=function(){e.style.textDecoration="none"},n}},{key:"createManageIgnoredUsersUI",value:function(){void 0===this.removeIgnoredUserUI&&(this.removeIgnoredUserUI=(0,l.s2)()?new Z:new U)}},{key:"createHeader",value:function(e){var t=document.createElement("div");return this.getStyles().styleHeader(t,e),t}},{key:"saveSettingsOrCookie",value:function(){var e=Math.round(this.tipVolumeSlider.getValue());this.isAnon?((0,b.C)("tipvol","".concat(e),60),this.userChatSettings.viewerTipVolume=e,F.gO.fire(this.userChatSettings)):this.saveSettings()}},{key:"saveSettings",value:function(){var e=this;(0,v.Cg)('You must be logged in to change chat settings. Click "OK" to login.')?F.gO.fire(this.userChatSettings):((0,m.I5)(this.getSaveColorEndpoint(),{color:this.chatColorInput.value}).catch((function(t){e.chatColorInput.value=e.userChatSettings.fontColor,error("Error saving user chat color",t)})),(0,m.I5)(this.getSaveEndpoint(),this.getFormData()).then((function(t){e.chatSettingsSavedRequest.fire(void 0),e.setUserChatSettings(),F.gO.fire(e.userChatSettings)})).catch((function(e){error("Error saving user chat settings",e)})))}},{key:"setUserChatSettings",value:function(){this.hasModeratorPrivileges()&&(this.userChatSettings.roomEntryFor=(0,S.iY)(this.notifyEntryForSelect.value),this.userChatSettings.roomLeaveFor=(0,S.iY)(this.notifyLeaveForSelect.value)),this.userChatSettings.fontColor=this.chatColorInput.value,this.userChatSettings.fontFamily=decodeURIComponent(this.fontFamilySelect.value),this.userChatSettings.fontSize=this.fontSizeSelect.value,this.userChatSettings.showEmoticons=this.showEmoticonsCheckbox.isChecked(),this.userChatSettings.emoticonAutocompleteDelay=this.emoticonAutocompleteDelaySelect.value,this.userChatSettings.highestTokenColor=this.highestTokenColorSelect.value,this.userChatSettings.viewerTipVolume=Math.round(this.tipVolumeSlider.getValue())}},{key:"getFormData",value:function(){var e={color:this.chatColorInput.value};return e.font_family=decodeURIComponent(this.fontFamilySelect.value),e.font_size=this.fontSizeSelect.value,e.show_emoticons="".concat(this.showEmoticonsCheckbox.isChecked()),e.emoticon_autocomplete_delay=this.emoticonAutocompleteDelaySelect.value,e.highest_token_color=this.highestTokenColorSelect.value,e.viewer_tip_volume="".concat(Math.round(this.tipVolumeSlider.getValue())),this.hasModeratorPrivileges()&&(e.enter_notify=this.notifyEntryForSelect.value,e.leave_notify=this.notifyLeaveForSelect.value),e}},{key:"getSaveColorEndpoint",value:function(){return"choose_viewer_chat_color/"}},{key:"getSaveEndpoint",value:function(){return"api/viewerchatsettings/".concat(this.roomName,"/")}},{key:"hasModeratorPrivileges",value:function(){return this.isModerator}},{key:"updateSelectWidth",value:function(e){}},{key:"styleWrapperCustom",value:function(e){}},{key:"styleLabelCustom",value:function(e){}},{key:"styleColorSwatch",value:function(e){(0,c.vP)(this.chatColorSwatch,"colorSwatch"),this.chatColorSwatch.style.width="20px",this.chatColorSwatch.style.height="20px",this.chatColorSwatch.style.border="1px solid ".concat(d.w.defaultColor),this.chatColorSwatch.style.cursor="pointer",this.chatColorSwatch.style.verticalAlign="middle"}},{key:"styleEmoticonsCheckbox",value:function(e){e.style.display="block"}},{key:"styleSlider",value:function(e){this.tipVolumeSlider.element.style.display="inline-block",this.tipVolumeSlider.element.style.border="none",this.tipVolumeSlider.element.style.verticalAlign="top",this.tipVolumeSlider.element.style.height="16px",this.tipVolumeSlider.element.style.width="100%"}},{key:"repositionChildren",value:function(){this.tipVolumeSlider.handleResize()}},{key:"getTipVolumeSlider",value:function(){return this.tipVolumeSlider}},{key:"getStyles",value:function(){return void 0===this.chatSettingsStyles&&(this.chatSettingsStyles=new g.h),this.chatSettingsStyles}},{key:"createUserSettings",value:function(){this.usersSettings.appendChild(this.createHighestTokenColorPicker())}},{key:"createNotificationSettings",value:function(){this.notificationsSettings.appendChild(this.createHeader(E.ag.notificationsSettings)),this.notificationsSettings.appendChild(this.createNotifyEntryPicker()),this.notificationsSettings.appendChild(this.createNotifyLeavePicker())}},{key:"createOtherSettings",value:function(){this.otherSettings.appendChild(this.createTipVolumePicker()),this.otherSettings.appendChild(this.createManageIgnoredUsersPicker())}},{key:"updateChatSettings",value:function(e){this.userChatSettings=e,this.updateChatColor(this.userChatSettings.fontColor),this.fontFamilySelect.value=this.userChatSettings.fontFamily,this.fontSizeSelect.value=this.userChatSettings.fontSize,this.showEmoticonsCheckbox.setCheckedDirectly(this.userChatSettings.showEmoticons),this.emoticonAutocompleteDelaySelect.value=this.userChatSettings.emoticonAutocompleteDelay,this.highestTokenColorSelect.value=this.userChatSettings.highestTokenColor,this.updateSelectWidth(this.fontFamilySelect),this.updateSelectWidth(this.fontSizeSelect),this.updateSelectWidth(this.emoticonAutocompleteDelaySelect),this.updateSelectWidth(this.highestTokenColorSelect),this.tipVolumeSlider.setValue(this.userChatSettings.viewerTipVolume),this.handleSliderMove(this.userChatSettings.viewerTipVolume),(0,k.XI)(this.userChatSettings.viewerTipVolume)}},{key:"isBroadcaster",value:function(){return!1}},{key:"handleRoomLoaded",value:function(e){this.updateChatSettings(e.dossier.userChatSettings),this.roomName=e.dossier.room,this.isModerator=e.dossier.isModerator,this.isSupporter=e.dossier.isSupporter,this.isAnon=e.chatConnection.viewerIsAnonymous(),this.updateNotificationsSettingsVisibility()}},{key:"updateNotificationsSettingsVisibility",value:function(){this.hasModeratorPrivileges()?(this.notificationsSettings.style.display="block",this.notifyEntryForSelect.value=z(this.userChatSettings.roomEntryFor),this.notifyLeaveForSelect.value=z(this.userChatSettings.roomLeaveFor)):this.notificationsSettings.style.display="none"}},{key:"getFontOptions",value:function(){return[{label:"Default",value:"default"},{label:"Arial",value:"Arial, Helvetica"},{label:"Bookman Old Style",value:"Bookman Old Style"},{label:"Comic Sans",value:'"Comic Sans MS", cursive'},{label:"Courier",value:'"Courier New"'},{label:"Lucida",value:"Lucida"},{label:"Palantino",value:"Palantino"},{label:"Tahoma",value:"Tahoma, Geneva"},{label:"Times New Roman",value:'"Times New Roman"'}]}},{key:"getEmoticonAutocompleteDelayOptions",value:function(){return[{label:"Turn Off Autocomplete",value:"-1"},{label:"No Delay - 0s",value:"0"},{label:"Short - 0.5s",value:"500"},{label:"Medium - 1s",value:"1000"},{label:"Long - 1.5s",value:"1500"}]}},{key:"getHighestTokenColorOptions",value:function(){return[{label:"Dark Purple (Tipped 1000 recently)",value:"darkpurple"},{label:"Light Purple (Tipped 250 recently)",value:"lightpurple"},{label:"Dark Blue (Tipped 50 recently)",value:"darkblue"},{label:"Light Blue (Owns or purchased tokens)",value:"lightblue"}]}},{key:"getNotifyEntryLeaveOptions",value:function(){return[{label:"All Registered Users",value:"orga"},{label:"Mods, Fans, and Users With Tokens",value:"orgb"},{label:"Mods and Fans",value:"org"},{label:"No Users",value:"none"}]}}]),R}(w.w);function z(e){switch(e){case 0:return"orga";case 1:return"orgb";case 2:return"org";case 3:return"none";default:return error("Invalid enter/leave setting: ".concat(e)),"orgb"}}},8958:function(e,t,n){"use strict";n.d(t,{h:function(){return s}});var i=n(2951),o=n(1976),r=n(1185),s=function(){function e(){(0,i.Z)(this,e)}return(0,o.Z)(e,[{key:"styleContainer",value:function(e){}},{key:"styleHeader",value:function(e,t){e.innerText=t,e.style.fontWeight="bold",e.style.fontSize="12px",e.style.margin="14px 0 8px",e.style.backgroundColor=""}},{key:"styleRowWrapper",value:function(e){e.style.margin="4px 0 7px 4px"}},{key:"styleLabel",value:function(e,t){e.innerText=t,e.style.fontSize="12px",e.style.display="inline-block",e.style.marginBottom="5px"}},{key:"styleInput",value:function(e){(0,r.vP)(e,"chat-settings-input"),e.style.display="block",e.style.fontSize="12px",e.style.marginTop="0",e.style.borderWidth="1px",e.style.borderStyle="solid",e instanceof HTMLSelectElement&&((0,r.vP)(e,"chat-settings-select"),e.style.height="24px",e.style.width="100%")}}]),e}()},4372:function(e,t,n){"use strict";n.d(t,{l:function(){return a}});var i=n(9888),o=n(1522),r=n(3543),s=n(47);function a(e,t,n,a,l){var c=(0,s.vz)("div",{className:"undo-ban-options-".concat(t.silenced),style:{boxSizing:"border-box",padding:"2px 5px 3px 25px",fontWeight:"bold"}}),u=(0,s.vz)("a",{href:"#",className:"msg-link",onClick:function(e){null==e||e.preventDefault(),h(),(0,i.F)(n,t.isBan?"remove_ban":"remove_silence",a.dossier.room,(function(){l(t.isBan?r.ag.banRemovedMessage:r.ag.silenceRemovedMessage)}),(function(){l(t.isBan?r.ag.banRemoveErrorMessage:r.ag.silenceRemoveErrorMessage)}))}},r.ag.inlineUndoText),d=(0,s.vz)("a",{href:"#",style:{color:"inherit"},onClick:h},"(",r.ag.dismissLower,")");function h(n){var i;null==n||n.preventDefault(),null===(i=c.parentElement)||void 0===i||i.removeChild(c);var o=e.element.getElementsByClassName("undo-ban-options-".concat(t.silenced));Array.from(o).forEach((function(e){var t;null===(t=e.parentElement)||void 0===t||t.removeChild(e)}))}if(c.appendChild(u),u.dataset.testid="undo-button",d.dataset.testid="dismiss-button",!t.isBan&&a.dossier.userName===a.dossier.room){var f=(0,s.vz)("a",{href:"#",style:{color:"red"},onClick:function(e){null==e||e.preventDefault(),(0,o.oB)(r.ag.banUserConfirm(t.silenced),(function(){h(),(0,i.F)(n,"convert_to_ban",a.dossier.room,(function(){}),(function(){l(r.ag.banConvertErrorMessage)}))}))}},r.ag.inlineBanText);f.dataset.testid="ban-button",c.appendChild(document.createTextNode("Â ".repeat(5))),c.appendChild(f)}return c.appendChild(document.createTextNode("Â ".repeat(5))),c.appendChild(d),h(),c}},8157:function(e,t,n){"use strict";n.d(t,{Av:function(){return q},Ow:function(){return J},dV:function(){return z}});var i=n(2951),o=n(1976),r=n(126),s=n(5809);function a(e,t){(function(e){return"string"==typeof e&&-1!==e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!==e.indexOf("%")}(e);return e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function l(e){return Math.min(1,Math.max(0,e))}function c(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function u(e){return e<=1?"".concat(100*e,"%"):e}function d(e){return 1===e.length?"0".concat(e):String(e)}function h(e,t,n){e=a(e,255),t=a(t,255),n=a(n,255);var i=Math.max(e,t,n),o=Math.min(e,t,n),r=0,s=0,l=(i+o)/2;if(i===o)s=0,r=0;else{var c=i-o;switch(s=l>.5?c/(2-i-o):c/(i+o),i){case e:r=(t-n)/c+(t<n?6:0);break;case t:r=(n-e)/c+2;break;case n:r=(e-t)/c+4}r/=6}return{h:r,s:s,l:l}}function f(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*n*(t-e):n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function p(e,t,n){e=a(e,255),t=a(t,255),n=a(n,255);var i=Math.max(e,t,n),o=Math.min(e,t,n),r=0,s=i,l=i-o,c=0===i?0:l/i;if(i===o)r=0;else{switch(i){case e:r=(t-n)/l+(t<n?6:0);break;case t:r=(n-e)/l+2;break;case n:r=(e-t)/l+4}r/=6}return{h:r,s:c,v:s}}function m(e,t,n,i){var o=[d(Math.round(e).toString(16)),d(Math.round(t).toString(16)),d(Math.round(n).toString(16))];return i&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function v(e){return g(e)/255}function g(e){return parseInt(e,16)}var y={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},b=n(3940);var w="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),C="[\\s|\\(]+(".concat(w,")[,|\\s]+(").concat(w,")[,|\\s]+(").concat(w,")\\s*\\)?"),x="[\\s|\\(]+(".concat(w,")[,|\\s]+(").concat(w,")[,|\\s]+(").concat(w,")[,|\\s]+(").concat(w,")\\s*\\)?"),k={CSS_UNIT:new RegExp(w),rgb:new RegExp("rgb".concat(C)),rgba:new RegExp("rgba".concat(x)),hsl:new RegExp("hsl".concat(C)),hsla:new RegExp("hsla".concat(x)),hsv:new RegExp("hsv".concat(C)),hsva:new RegExp("hsva".concat(x)),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function S(e){return Boolean(k.CSS_UNIT.exec(String(e)))}function T(e){return!isNaN(Number(e))}var I=function(){function e(){var t,n=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,i.Z)(this,e),this.lighten=function(e){return n.colorSpace.lighten(e)},this.darken=function(e){return n.colorSpace.darken(e)},this.setLightness=function(e){return n.colorSpace.setLightness(e)},this.matchLightness=function(e){return n.colorSpace.matchLightness(e)},o instanceof e)return o.clone();"number"==typeof o&&(o=function(e){return{r:e>>16,g:(65280&e)>>8,b:255&e}}(o)),this.originalInput=o;var s=function(e){var t,n,i,o,r,s,l,d={r:0,g:0,b:0},h=1,p=null,m=null,w=null,C=!1,x=!1;return"string"==typeof e&&(e=function(e){if(0===(e=e.trim().toLowerCase()).length)return!1;var t=!1;if(y[e])e=y[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var n=k.rgb.exec(e);return null!==n?{r:n[1],g:n[2],b:n[3]}:null!==(n=k.rgba.exec(e))?{r:n[1],g:n[2],b:n[3],a:n[4]}:null!==(n=k.hsl.exec(e))?{h:n[1],s:n[2],l:n[3]}:null!==(n=k.hsla.exec(e))?{h:n[1],s:n[2],l:n[3],a:n[4]}:null!==(n=k.hsv.exec(e))?{h:n[1],s:n[2],v:n[3]}:null!==(n=k.hsva.exec(e))?{h:n[1],s:n[2],v:n[3],a:n[4]}:null!==(n=k.hex8.exec(e))?{r:g(n[1]),g:g(n[2]),b:g(n[3]),a:v(n[4]),format:t?"name":"hex8"}:null!==(n=k.hex6.exec(e))?{r:g(n[1]),g:g(n[2]),b:g(n[3]),format:t?"name":"hex"}:null!==(n=k.hex4.exec(e))?{r:g(n[1]+n[1]),g:g(n[2]+n[2]),b:g(n[3]+n[3]),a:v(n[4]+n[4]),format:t?"name":"hex8"}:null!==(n=k.hex3.exec(e))&&{r:g(n[1]+n[1]),g:g(n[2]+n[2]),b:g(n[3]+n[3]),format:t?"name":"hex"}}(e)),"object"===(0,b.Z)(e)&&(S(e.r)&&S(e.g)&&S(e.b)?(r=e.r,s=e.g,l=e.b,d={r:255*a(r,255),g:255*a(s,255),b:255*a(l,255)},C=!0,x="%"===String(e.r).substr(-1)?"prgb":"rgb"):T(e.y)&&T(e.pb)&&T(e.pr)?(n=e.y,i=e.pb,o=e.pr,d={r:Math.round(n+1.402*o),g:Math.round(n-.344*i-.714*o),b:Math.round(n+1.772*i)},C=!0,x="ypbpr"):S(e.h)&&S(e.s)&&S(e.v)?(p=u(e.s),m=u(e.v),d=function(e,t,n){e=6*a(e,360),t=a(t,100),n=a(n,100);var i=Math.floor(e),o=e-i,r=n*(1-t),s=n*(1-o*t),l=n*(1-(1-o)*t),c=i%6;return{r:255*[n,s,r,r,l,n][c],g:255*[l,n,n,s,r,r][c],b:255*[r,r,l,n,n,s][c]}}(e.h,p,m),C=!0,x="hsv"):S(e.h)&&S(e.s)&&S(e.l)?(p=u(e.s),w=u(e.l),d=function(e,t,n){var i,o,r;if(e=a(e,360),t=a(t,100),n=a(n,100),0===t)o=n,r=n,i=n;else{var s=n<.5?n*(1+t):n+t-n*t,l=2*n-s;i=f(l,s,e+1/3),o=f(l,s,e),r=f(l,s,e-1/3)}return{r:255*i,g:255*o,b:255*r}}(e.h,p,w),C=!0,x="hsl"):T(e.l)&&T(e.a)&&T(e.b)&&(d=function(e,t,n){var i,o,r,s=(e+16)/116,a=t/500+s,l=s-n/200;return o=-.9689*(a=.95047*(a*a*a>.008856?a*a*a:(a-16/116)/7.787))+1.8758*(s=1*(s*s*s>.008856?s*s*s:(s-16/116)/7.787))+.0415*(l=1.08883*(l*l*l>.008856?l*l*l:(l-16/116)/7.787)),r=.0557*a+-.204*s+1.057*l,i=(i=3.2406*a+-1.5372*s+-.4986*l)>.0031308?1.055*Math.pow(i,1/2.4)-.055:12.92*i,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:12.92*o,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,{r:255*Math.max(0,Math.min(1,i)),g:255*Math.max(0,Math.min(1,o)),b:255*Math.max(0,Math.min(1,r))}}(e.l,e.a,e.b),C=!0,x="lab"),Object.prototype.hasOwnProperty.call(e,"a")&&(h=e.a)),h=c(h),{ok:C,format:null!==(t=e.format)&&void 0!==t?t:x,r:Math.min(255,Math.max(d.r,0)),g:Math.min(255,Math.max(d.g,0)),b:Math.min(255,Math.max(d.b,0)),a:h}}(o);this.originalInput=o,this.r=s.r,this.g=s.g,this.b=s.b,this.a=s.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(t=r.format)&&void 0!==t?t:s.format,this.gradientType=r.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=s.ok,this.initHSL(),this.initCIELAB(),this.initYPbPr()}return(0,o.Z)(e,[{key:"colorSpace",get:function(){return 1===e.globalSpace?this.HSL:0===e.globalSpace?this.CIELAB:this.YPbPr}},{key:"lightness",get:function(){return this.colorSpace.lightness}},{key:"matchHue",value:function(t){var n=e.get(t).toHsl().h,i=this.toHsl();return i.h=n,e.get(i)}},{key:"initHSL",value:function(){var t=this;this.HSL={lighten:function(n){var i=t.toHsl();return i.l+=n/100,i.l=l(i.l),e.get(i)},darken:function(e){return t.HSL.lighten(-e)},setLightness:function(n){var i=t.toHsl();return i.l=n,e.get(i)},matchLightness:function(n){var i=e.get(n).HSL.lightness,o=t.toHsl();return o.l=i,e.get(o)},get lightness(){return t.toHsl().l}}}},{key:"initCIELAB",value:function(){var t=this;this.CIELAB={lighten:function(n){var i=t.toCieLab();return i.l+=n/100,i.l=l(i.l),e.get(i)},darken:function(e){return t.CIELAB.lighten(-e)},setLightness:function(n){var i=t.toCieLab();return i.l=n,e.get(i)},matchLightness:function(n){var i=e.get(n).CIELAB.lightness,o=t.toCieLab();return o.l=i,e.get(o)},get lightness(){return t.toCieLab().l}}}},{key:"initYPbPr",value:function(){var t=this;this.YPbPr={lighten:function(n){var i=t.toYPbPr();return i.y+=n/100*255,i.y=l(i.y),e.get(i)},darken:function(e){return t.YPbPr.lighten(-e)},setLightness:function(n){var i=t.toYPbPr();return i.y=n,e.get(i)},matchLightness:function(n){var i=e.get(n).YPbPr.lightness,o=t.toYPbPr();return o.y=i,e.get(o)},get lightness(){return t.toYPbPr().y}}}},{key:"isDark",value:function(){return this.getBrightness()<128}},{key:"isLight",value:function(){return!this.isDark()}},{key:"getBrightness",value:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3}},{key:"getLuminance",value:function(){var e=this.toRgb(),t=e.r/255,n=e.g/255,i=e.b/255;return.2126*R(t)+.7152*R(n)+.0722*R(i)}},{key:"getAlpha",value:function(){return this.a}},{key:"setAlpha",value:function(e){return this.a=c(e),this.roundA=Math.round(100*this.a)/100,this}},{key:"toHsv",value:function(){var e=p(this.r,this.g,this.b);return{h:360*e.h,s:e.s,v:e.v,a:this.a}}},{key:"toCieLab",value:function(){var e,t,n,i,o,r,s=(e=this.r,t=this.g,n=this.b,t/=255,n/=255,o=(.2126*(e=(e/=255)>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)+.7152*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.0722*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92))/1,r=(.0193*e+.1192*t+.9505*n)/1.08883,i=(i=(.4124*e+.3576*t+.1805*n)/.95047)>.008856?Math.pow(i,1/3):7.787*i+16/116,{l:116*(o=o>.008856?Math.pow(o,1/3):7.787*o+16/116)-16,a:500*(i-o),b:200*(o-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))});return{l:s.l,a:s.a,b:s.b}}},{key:"toHsvString",value:function(){var e=p(this.r,this.g,this.b),t=Math.round(360*e.h),n=Math.round(100*e.s),i=Math.round(100*e.v);return 1===this.a?"hsv(".concat(t,", ").concat(n,"%, ").concat(i,"%)"):"hsva(".concat(t,", ").concat(n,"%, ").concat(i,"%, ").concat(this.roundA,")")}},{key:"toHsl",value:function(){var e=h(this.r,this.g,this.b);return{h:360*e.h,s:e.s,l:e.l,a:this.a}}},{key:"toHslString",value:function(){var e=h(this.r,this.g,this.b),t=Math.round(360*e.h),n=Math.round(100*e.s),i=Math.round(100*e.l);return 1===this.a?"hsl(".concat(t,", ").concat(n,"%, ").concat(i,"%)"):"hsla(".concat(t,", ").concat(n,"%, ").concat(i,"%, ").concat(this.roundA,")")}},{key:"toHex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return m(this.r,this.g,this.b,e)}},{key:"toHexString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return"#".concat(this.toHex(e))}},{key:"toHex8",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,t,n,i,o){var r,s=[d(Math.round(e).toString(16)),d(Math.round(t).toString(16)),d(Math.round(n).toString(16)),d((r=i,Math.round(255*parseFloat(r)).toString(16)))];return o&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))&&s[3].startsWith(s[3].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}(this.r,this.g,this.b,this.a,e)}},{key:"toHex8String",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return"#".concat(this.toHex8(e))}},{key:"toRgb",value:function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}}},{key:"toYPbPr",value:function(){return{y:.299*(e=this.r)+.587*(t=this.g)+.114*(n=this.b),pb:-.169*e-.331*t+.5*n,pr:.5*e-.419*t-.081*n};var e,t,n}},{key:"toRgbString",value:function(){var e=Math.round(this.r),t=Math.round(this.g),n=Math.round(this.b);return 1===this.a?"rgb(".concat(e,", ").concat(t,", ").concat(n,")"):"rgba(".concat(e,", ").concat(t,", ").concat(n,", ").concat(this.roundA,")")}},{key:"toPercentageRgb",value:function(){var e=function(e){return"".concat(Math.round(100*a(e,255)),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}}},{key:"toPercentageRgbString",value:function(){var e=function(e){return Math.round(100*a(e,255))};return 1===this.a?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")}},{key:"toName",value:function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var e="#".concat(m(this.r,this.g,this.b,!1)),t=0,n=Object.entries(y);t<n.length;t++){var i=(0,s.Z)(n[t],2),o=i[0];if(e===i[1])return o}return!1}},{key:"toString",value:function(e){var t,n,i=Boolean(e);e=null!==(t=e)&&void 0!==t?t:this.format;var o=!1,r=this.a<1&&this.a>=0;return i||!r||!e.startsWith("hex")&&"name"!==e?("rgb"===e&&(o=this.toRgbString()),"prgb"===e&&(o=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(o=this.toHexString()),"hex3"===e&&(o=this.toHexString(!0)),"hex4"===e&&(o=this.toHex8String(!0)),"hex8"===e&&(o=this.toHex8String()),"name"===e&&(o=this.toName()),"hsl"===e&&(o=this.toHslString()),"hsv"===e&&(o=this.toHsvString()),null!==(n=o)&&void 0!==n?n:this.toHexString()):"name"===e&&0===this.a?this.toName():this.toRgbString()}},{key:"toNumber",value:function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)}},{key:"clone",value:function(){return e.get(this.toString())}},{key:"brighten",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(-t/100*255))),n.g=Math.max(0,Math.min(255,n.g-Math.round(-t/100*255))),n.b=Math.max(0,Math.min(255,n.b-Math.round(-t/100*255))),e.get(n)}},{key:"tint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this.mix("#FFFFFF",e)}},{key:"shade",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this.mix("#000000",e)}},{key:"desaturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,n=this.toHsl();return n.s-=t/100,n.s=l(n.s),e.get(n)}},{key:"saturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,n=this.toHsl();return n.s+=t/100,n.s=l(n.s),e.get(n)}},{key:"greyscale",value:function(){return this.desaturate(100)}},{key:"spin",value:function(t){var n=this.toHsl(),i=(n.h+t)%360;return n.h=i<0?360+i:i,e.get(n)}},{key:"mix",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,i=this.toRgb(),o=e.get(t).toRgb(),r=n/100,s={r:(o.r-i.r)*r+i.r,g:(o.g-i.g)*r+i.g,b:(o.b-i.b)*r+i.b,a:(o.a-i.a)*r+i.a};return e.get(s)}},{key:"analogous",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,i=this.toHsl(),o=360/n,r=[this];for(i.h=(i.h-(o*t>>1)+720)%360;--t;)i.h=(i.h+o)%360,r.push(e.get(i));return r}},{key:"complement",value:function(){var t=this.toHsl();return t.h=(t.h+180)%360,e.get(t)}},{key:"monochromatic",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,n=this.toHsv(),i=n.h,o=n.s,r=n.v,s=[],a=1/t;t-- >0;)s.push(e.get({h:i,s:o,v:r})),r=(r+a)%1;return s}},{key:"splitcomplement",value:function(){var t=this.toHsl(),n=t.h;return[this,e.get({h:(n+72)%360,s:t.s,l:t.l}),e.get({h:(n+216)%360,s:t.s,l:t.l})]}},{key:"onBackground",value:function(t){var n=this.toRgb(),i=e.get(t).toRgb();return e.get({r:i.r+(n.r-i.r)*n.a,g:i.g+(n.g-i.g)*n.a,b:i.b+(n.b-i.b)*n.a})}},{key:"triad",value:function(){return this.polyad(3)}},{key:"tetrad",value:function(){return this.polyad(4)}},{key:"polyad",value:function(t){for(var n=this.toHsl(),i=n.h,o=[this],r=360/t,s=1;s<t;s++)o.push(e.get({h:(i+s*r)%360,s:n.s,l:n.l}));return o}},{key:"equals",value:function(t){return this.toRgbString()===e.get(t).toRgbString()}},{key:"isCurrentModeBg",get:function(){return document.body.classList.contains("darkmode")?this.isDarkModeBg:this.isLightModeBg}},{key:"isCurrentModeFg",get:function(){return document.body.classList.contains("darkmode")?this.isDarkModeFg:this.isLightModeFg}},{key:"isLightModeBg",get:function(){return this.equals(e.lightModeBg)}},{key:"isLightModeFg",get:function(){return this.equals(e.lightModeFg)}},{key:"isDarkModeBg",get:function(){return this.equals(e.darkModeBg)}},{key:"isDarkModeFg",get:function(){return this.equals(e.darkModeFg)}},{key:"toRgbArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.a<1||e?[this.r,this.g,this.b,this.a]:[this.r,this.g,this.b]}},{key:"isBlack",get:function(){return this.equals("#000000")}},{key:"isWhite",get:function(){return this.equals("#FFFFFF")}},{key:"isTransparent",get:function(){return 0===this.getAlpha()}},{key:"isLessLuminousThan",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getLuminance()-P(e);return t?n<=0:n<0}},{key:"isMoreLuminousThan",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getLuminance()-P(e);return t?n>=0:n>0}},{key:"rgbRange",get:function(){var e=this.toRgbArray();return Math.max.apply(Math,(0,r.Z)(e))-Math.min.apply(Math,(0,r.Z)(e))}}],[{key:"setColorSpace",value:function(t){e.globalSpace=t}},{key:"get",value:function(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}},{key:"currentModeBg",get:function(){return document.body.classList.contains("darkmode")?e.darkModeBg:e.lightModeBg}},{key:"currentModeFg",get:function(){return document.body.classList.contains("darkmode")?e.darkModeFg:e.lightModeFg}},{key:"lightModeBg",get:function(){return e.get("#FFFFFF")}},{key:"lightModeFg",get:function(){return e.get("#494949")}},{key:"darkModeBg",get:function(){return e.get("#202C39")}},{key:"darkModeFg",get:function(){return e.get("#FFFFFF")}},{key:"black",get:function(){return e.get("#000000")}},{key:"white",get:function(){return e.get("#FFFFFF")}},{key:"transparent",get:function(){return e.get("transparent")}}]),e}();function R(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function P(e){return"number"==typeof e?e:I.get(e).getLuminance()}I.globalSpace=1;var M=n(3340);function A(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var B=/\s*,\s*/,L=/(?:[+-]?\d*\.?\d+)(?:%|[a-z]+)?/,O=N(["(?:",/#(?:[a-f0-9]{6}|[a-f0-9]{3})/,"|","(?:rgb|hsl)",/\(\s*(?:\d{1,3}\s*,\s*){2}\d{1,3}\s*\)/,"|","(?:rgba|hsla)",/\(\s*(?:\d{1,3}\s*,\s*){2}\d{1,3}\s*,\s*\d*\.?\d+\)/,"|",/[_a-z-][_a-z0-9-]*/,")"],""),D=N([O,"(?:\\s+",L,"(?:\\s+",L,")?)?"],""),U=N(["(?:",D,B,")*",D],""),Z=["(?:(",N(["(?:(",/(?:[+-]?\d*\.?\d+)(?:deg|grad|rad|turn)/,")|",/to\s+((?:(?:left|right|top|bottom)(?:\s+(?:top|bottom|left|right))?))/,")"],""),")",B,")?(",U,")"],F=["\\s*(",O,")","(?:\\s+","(",L,"))?","(?:",B,"\\s*)?"],_=function(){function e(t,n,o){(0,i.Z)(this,e),this.stops=[],this.line=o[1];var r=n.exec(t);if(null!==r){this.angle=r[1];for(var s=N(F,"gi"),a=s.exec(r[4]);null!==a;){var l;this.stops.push({color:I.get(a[1]),position:null!==(l=a[2])&&void 0!==l?l:""}),a=s.exec(r[4])}}}return(0,o.Z)(e,[{key:"isBlack",value:function(){return this.stops.every((function(e){return e.color.equals("black")}))}},{key:"isWhite",value:function(){return this.stops.every((function(e){return e.color.equals("white")}))}},{key:"toString",value:function(){var e=[];void 0!==this.angle&&e.push(this.angle);var t,n=A(this.stops);try{for(n.s();!(t=n.n()).done;){var i=t.value;e.push("".concat(i.color.toRgbString()," ").concat(i.position).trim())}}catch(e){n.e(e)}finally{n.f()}return"linear-gradient(".concat(e.join(", "),")")}},{key:"darkest",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"white",n=I.get(t),i=I.get("white"),o=i.getLuminance(),r=A(this.stops);try{for(r.s();!(e=r.n()).done;){var s=e.value.color.onBackground(n),a=s.getLuminance();a<o&&(o=a,i=s)}}catch(e){r.e(e)}finally{r.f()}return i}},{key:"lightest",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"white",n=I.get(t),i=I.get("white"),o=i.getLuminance(),r=A(this.stops);try{for(r.s();!(e=r.n()).done;){var s=e.value.color.onBackground(n),a=s.getLuminance();a>o&&(o=a,i=s)}}catch(e){r.e(e)}finally{r.f()}return i}}],[{key:"parse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(0!==t.trim().length&&t.trim().toLowerCase().startsWith("linear-gradient")){var n=N(Z,"gi"),i=n.exec(t);if(null!==i)return new e(t,n,i)}}}]),e}();function N(e,t){return new RegExp(e.reduce((function(e,t){return e+("string"==typeof t?t:t.source)}),""),t)}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}M.rb.listen((function(e){var t,n="darkmode"===e,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(document.querySelectorAll(".dm-adjust"));try{for(i.s();!(t=i.n()).done;)z(t.value,n)}catch(e){i.e(e)}finally{i.f()}}));var H="#202C39";function z(e,t){if("photo"!==e.getAttribute("type")){var n=e.firstElementChild;if(null!==n){var i,o,r=n.classList.contains("roomNotice");if(r&&!n.innerText.startsWith("Notice:"))return;var s=t?null!==(i=n.getAttribute("dm-adjust-bg"))&&void 0!==i?i:H:null!==(o=n.getAttribute("dm-init-bg"))&&void 0!==o?o:"white";s.startsWith("linear-gradent")?n.style.backgroundImage=s:n.style.background=s;var a=t?n.getAttribute("dm-adjust-fg"):n.getAttribute("dm-init-fg"),l=r?n:n.querySelector("span.msg-text");null!==a&&null!==l&&(l.style.color=a)}}}I.setColorSpace(2);var W=I.darkModeBg.lightness,V=I.darkModeFg.lightness,q=function(){function e(t){(0,i.Z)(this,e),this.background=t.bg,this.foreground=t.fg,this.calc()}return(0,o.Z)(e,[{key:"calc",value:function(){var e,t=_.parse(this.background),n=I.get(null!==(e=this.foreground)&&void 0!==e?e:I.darkModeFg).setAlpha(1);if(this.fgDark=n.setLightness(V).setAlpha(1).toRgbString(),void 0!==t)t.stops.forEach((function(e){e.color=e.color.onBackground(I.darkModeBg).setLightness(W)})),this.bgDark=t.toString();else{var i=I.get(this.background);if(!i.isValid||i.isWhite||i.isTransparent||i.isBlack)return void(this.bgDark=H);this.bgDark=i.setLightness(W).toRgbString()}}}],[{key:"parseNotice",value:function(t){return new e({fg:t.foreground,bg:t.background})}},{key:"parseMessage",value:function(t){return new e({fg:t.textColor,bg:t.backgroundColor})}}]),e}();function K(e){e.style.textShadow="1px 1px 0 #000, -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000"}function J(e,t,n){var i,o;t=(null!==(i=t)&&void 0!==i?i:"").trim(),n=(null!==(o=n)&&void 0!==o?o:"").trim();var r=e.firstElementChild,s=r,a=e;if(r.classList.contains("roomNotice")){if(a=r,!s.innerText.startsWith("Notice:"))return}else s=e.querySelector(".msg-text");var l=I.get(t);if(l.rgbRange<10?s.style.color="#D3D3D3":s.style.color=l.setLightness(V).setAlpha(1).toRgbString(),n.length>0){var c=_.parse(n);if(void 0!==c)c.stops.forEach((function(e){var t=e.color.getAlpha();e.color.rgbRange<10?e.color=I.transparent:e.color=e.color.setLightness(W).setAlpha(t)})),a.style.background=c.toString();else{var u=I.get(n);if(u.rgbRange<10)a.style.removeProperty("background"),K(s);else{var d=u.getAlpha();u=u.setLightness(W).setAlpha(d),a.style.background=u.toRgbString(),d<1&&K(s)}}}else K(s)}},4411:function(e,t,n){"use strict";n.d(t,{E:function(){return Te}});var i=n(2951),o=n(1976),r=n(5925),s=n(6272),a=n(9784),l=n(2800),c=n(8626),u=n(7600),d=n(8016),h=n(1522),f=n(3753),p=n(391),m=n(695),v=n(4793),g=n(6767),y=n(8069),b=n(1794),w=n(5726),C=n(3705),x=n(3544),k=n(9545),S=n(3543),T=n(1289),I=n(9420),R=n(4649),P=n(8808),M=n(5809),A=n(9034),E=n(457),B=n(728),L=n(3243),O=n(7591),D=n(9492),U=n(7597);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){(0,R.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,U.Z)(e);if(t){var o=(0,U.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,D.Z)(this,n)}}var N=function(e){(0,O.Z)(n,e);var t=_(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"getId",value:function(){return"GlobalPushServiceBackendChangeTopic"}},{key:"parseData",value:function(e){return F(F({},(0,L.Z)((0,U.Z)(n.prototype),"parseData",this).call(this,e)),{},{backends:e.getStringList("backends")})}}]),n}(function(e){(0,O.Z)(n,e);var t=_(n);function n(){return(0,i.Z)(this,n),t.call(this,{})}return(0,o.Z)(n,[{key:"getKey",value:function(){return"".concat(this.getId())}},{key:"initData",value:function(e){}}]),n}(B.Z)),j=n(5011),H=n(7212);function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){(0,R.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,U.Z)(e);if(t){var o=(0,U.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,D.Z)(this,n)}}var q=function(e){(0,O.Z)(n,e);var t=V(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"getId",value:function(){return"RoomModeratorNoticeTopic"}},{key:"parseData",value:function(e){return W(W(W({},(0,L.Z)((0,U.Z)(n.prototype),"parseData",this).call(this,e)),(0,j.Vu)(e)),{},{toGroup:"red",toUser:void 0,ts:Math.floor(1e3*e.getNumber("ts"))})}}]),n}(H.Hu),K=function(e){(0,O.Z)(n,e);var t=V(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"getId",value:function(){return"RoomFanClubTopic"}},{key:"parseData",value:function(e){return W(W(W({},(0,L.Z)((0,U.Z)(n.prototype),"parseData",this).call(this,e)),(0,j.Vu)(e)),{},{toGroup:"green",toUser:void 0,ts:Math.floor(1e3*e.getNumber("ts"))})}}]),n}(H.Hu),J=function(e){(0,O.Z)(n,e);var t=V(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"getId",value:function(){return"RoomLightPurpleTopic"}},{key:"parseData",value:function(e){return W(W(W({},(0,L.Z)((0,U.Z)(n.prototype),"parseData",this).call(this,e)),(0,j.Vu)(e)),{},{toGroup:"lightpurple",toUser:void 0,ts:Math.floor(1e3*e.getNumber("ts"))})}}]),n}(H.Hu),G=function(e){(0,O.Z)(n,e);var t=V(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"getId",value:function(){return"RoomDarkPurpleTopic"}},{key:"parseData",value:function(e){return W(W(W({},(0,L.Z)((0,U.Z)(n.prototype),"parseData",this).call(this,e)),(0,j.Vu)(e)),{},{toGroup:"darkpurple",toUser:void 0,ts:Math.floor(1e3*e.getNumber("ts"))})}}]),n}(H.Hu),Y=function(e){(0,O.Z)(n,e);var t=V(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"getId",value:function(){return"RoomDarkBlueTopic"}},{key:"parseData",value:function(e){return W(W(W({},(0,L.Z)((0,U.Z)(n.prototype),"parseData",this).call(this,e)),(0,j.Vu)(e)),{},{toGroup:"darkblue",toUser:void 0,ts:Math.floor(1e3*e.getNumber("ts"))})}}]),n}(H.Hu),$=function(e){(0,O.Z)(n,e);var t=V(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"getId",value:function(){return"RoomLightBlueTopic"}},{key:"parseData",value:function(e){return W(W(W({},(0,L.Z)((0,U.Z)(n.prototype),"parseData",this).call(this,e)),(0,j.Vu)(e)),{},{toGroup:"lightblue",toUser:void 0,ts:Math.floor(1e3*e.getNumber("ts"))})}}]),n}(H.Hu),Q=n(8666),X=n(4352),ee=n(9617),te=n(1090),ne=["tid"];function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){(0,R.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function re(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?se(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var ae=function(){function e(t){(0,i.Z)(this,e),this.chatConn=t,this.topics=new Map,this.historyLimit=10,this.finished=!1,this.initial=!0,this.listeners=new b.mM,this.historyCallback=[],this.handledMessages=[]}return(0,o.Z)(e,[{key:"setupHistory",value:function(){var e=this;if(u._.isEnabledForVerify()){this.tipHistory(),this.purchaseHistory(),this.messageHistory(),(0,c.vj)()&&this.shortcodeHistory();var t=u._.primaryClientFailure.listen((function(t){if(!e.finished){var n,i=[],o=re(e.topics.values());try{for(o.s();!(n=o.n()).done;){var r=n.value;u._.isListeningFor(r.topicKey)||i.push(r.topicKey)}}catch(e){o.e(e)}finally{o.f()}i.length>0&&(e.finished=!0,t&&warn("History subscription failure.",{topics:i,count:i.length}),e.fetchHistory().then((function(){})).catch((function(){})))}}));this.listeners.add(t),this.fetchHistoryIfReady()}}},{key:"dispose",value:function(){this.listeners.removeAll()}},{key:"push",value:function(e){this.historyCallback.length>this.historyLimit&&this.historyCallback.pop(),this.historyCallback.push(e)}},{key:"fireBuffer",value:function(){this.historyCallback.forEach((function(e){u._.isEnabledForUI()&&e()})),this.historyCallback=[]}},{key:"fetchHistory",value:function(){var e=this,t={};return Array.from(this.topics.entries()).forEach((function(e){var n=(0,M.Z)(e,2),i=n[0],o=n[1];t[i]=o.authData})),(0,f.I5)("push_service/room_history/",{topics:JSON.stringify(t)}).then((function(t){var n=JSON.parse(t.responseText),i=0;n.forEach((function(t){for(var n=0,o=Object.entries(t);n<o.length;n++){var r=(0,M.Z)(o[n],2),s=r[0],a=r[1],l=e.topics.get(s);if(void 0===l||i>=e.historyLimit)return;(0,B.h)(a);var c=new p.j(a),d=e.addHistoryMessage(l.topicKey,c.getString("tid"));if(u._.addExternalMessage(l.topicKey,c.getString("tid"))||d)return;i+=1,l.callback(c)}}))})).catch(k.$x)}},{key:"tipHistory",value:function(){var e=this,t=l.q.getState(),n=t.roomUid,i=t.viewerUid,o=t.privateShowId,r=[];i===n?r.push(new d._G(i)):r.push(new H.jj(n)),""!==o&&r.push(new Q.Vx(n,o)),r.forEach((function(t){var n;e.topics.set(t.getAuthKey(),{callback:(n=t,function(t){var i=n.parseData(t);i.toUsername===e.chatConn.room()&&(0,ee._A)(e.chatConn,i,!0)}),authData:t.getAuthData(),topicKey:t.getKey()});var i=t.onSubscribeChange.listen((function(t){t.subscribed&&e.fetchHistoryIfReady()}));e.listeners.add(i)}))}},{key:"purchaseHistory",value:function(){var e=this,t=l.q.getState().roomUid;[new H.uH(t),new H.AE(t)].forEach((function(t){e.topics.set(t.getAuthKey(),{callback:function(n){var i=t.parseData(n);(0,ee.FO)(e.chatConn,i)},authData:t.getAuthData(),topicKey:t.getKey()});var n=t.onSubscribeChange.listen((function(t){t.subscribed&&e.fetchHistoryIfReady()}));e.listeners.add(n)}))}},{key:"messageHistory",value:function(){var e=this,t=l.q.getState(),n=t.roomUid,i=t.privateShowId,o=[];""!==n&&(o.push(new H.j4(n)),""!==i&&o.push(new Q.k1(n,i))),o.forEach((function(t){e.topics.set(t.getAuthKey(),{callback:function(n){var i=t.parseData(n);(0,ee.AO)(e.chatConn,i)},authData:t.getAuthData(),topicKey:t.getKey()});var n=t.onSubscribeChange.listen((function(t){t.subscribed&&e.fetchHistoryIfReady()}));e.listeners.add(n)}))}},{key:"shortcodeHistory",value:function(){var e=this,t=l.q.getState(),n=t.roomUid,i=t.privateShowId,o=[];""!==n&&(o.push(new H.bj(n)),""!==i&&o.push(new Q.O6(n,i))),o.forEach((function(t){e.topics.set(t.getAuthKey(),{callback:function(n){var i=t.parseData(n);e.chatConn.event.roomShortcode.fire(i)},authData:t.getAuthData(),topicKey:t.getKey()});var n=t.onSubscribeChange.listen((function(t){t.subscribed&&e.fetchHistoryIfReady()}));e.listeners.add(n)}))}},{key:"fetchHistoryIfReady",value:function(){var e=this;if(!this.finished&&u._.isEnabledForUI()){var t,n=re(this.topics.values());try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!u._.isListeningFor(i.topicKey))return}}catch(e){n.e(e)}finally{n.f()}this.finished=!0,this.fetchHistory().then((function(){(0,ee.RR)(e.chatConn,l.q.getState().roomTitle),e.initial&&(e.chatConn.changeStatus(e.chatConn.statusAfterConnected),e.initial=!1)})).catch((function(){}))}}},{key:"addHistoryMessage",value:function(e,t){var n="".concat(e,":").concat(t);return!!this.handledMessages.includes(n)||(this.handledMessages.push(n),!1)}},{key:"reset",value:function(){this.finished=!1}}]),e}(),le=function(){function e(t,n){var o,r,s=this;(0,i.Z)(this,e),this.dossier=t,this.chatConn=n,this.listeners={global:new b.mM,room:new b.mM,user:new b.mM,color:new b.mM,fanclub:new b.mM,privileged:new b.mM,private:new b.mM,enterLeave:new b.mM},this.isInHiddenShow=!1,this.history=new ae(this.chatConn),this.connectionFailedCount=0,this.lastOnlineStatus="notconnected",this.hiddenMessage="";var a=!0,c=(new Date).getTime(),d=0;u._.connectionChange.listen((function(e){if(!["connecting","closing","initialized"].includes(e.current)){"connected"===e.current&&(d+=1);var t={state:e.current,previousState:e.previous,push_connection_type:u._.getConnectionType(),wowza_state:s.chatConn.wowzaHandler.readyState(),connection_id:u._.presenceId,first_connection:a,time_since_start:(new Date).getTime()-c,client:e.client,connectionCount:d};if((0,C.fg)("PushServiceConnection",t),a=!1,!0===e.primary&&u._.isEnabledForUI())switch(e.current){case"closed":case"failed":s.chatConn.event.roomNotice.fire({messages:[[(0,te.vK)("Chat disconnected")]],showInPrivateMessage:!0}),s.history.reset();break;case"suspended":case"disconnected":if(s.connectionFailedCount>6&&!u._.isWowzaDisabled()){u._.close();break}s.connectionFailedCount+=1,s.chatConn.event.roomNotice.fire({messages:[[(0,te.vK)("Trying to reconnect")]],showInPrivateMessage:!0}),s.history.reset();break;default:s.connectionFailedCount=0}}}),!1).addTo(this.listeners.global);var h=null!==(o=this.dossier.viewerUid)&&void 0!==o?o:"",f=null!==(r=this.dossier.roomUid)&&void 0!==r?r:"";this.isBroadcaster=""!==f&&h===f;var p=l.q.getState(),m=p.privateShowId,v=p.isModerator,g=p.isInFanClub,y=p.userColors;this.history.setupHistory(),this.setupBackendSwapListener(),this.joinRoomPresence(f,h),this.setupVideoQualityTopic(f),this.setupUserListeners(h),this.setupRoomListeners(f),this.setupRoomEnterLeaveListener(f,v||this.isBroadcaster),this.setupRoomUserListeners(f,h),this.setupPrivilegedListeners(f,v||this.isBroadcaster),this.setupFanClubListeners(f,g),this.setupColorGroupListeners(f,y),this.setupGameListener(f),""!==m&&this.setupPrivateRoomListeners(f,m),l.q.onUpdate.listen((function(e){var t=l.q.getState();t.privateShowId!==e.privateShowId&&s.setupPrivateRoomListeners(f,t.privateShowId),t.isModerator!==e.isModerator&&(s.setupPrivilegedListeners(f,t.isModerator||s.isBroadcaster),s.setupRoomEnterLeaveListener(f,t.isModerator||s.isBroadcaster)),t.isInFanClub!==e.isInFanClub&&s.setupFanClubListeners(f,t.isInFanClub),s.setupColorGroupListeners(f,t.userColors,e.userColors)}),!1).addTo(this.listeners.global)}return(0,o.Z)(e,[{key:"sendMessage",value:function(e,t){var n=this,i=l.q.getState(),o=i.roomUid,r=i.privateShowId,s=i.userName;if(e!==this.chatConn.room()||""===o)return Promise.reject({error:"room error",sendMessageRoom:e,handlerRoom:this.chatConn.room(),roomUid:o});var a={room:e,message:JSON.stringify({m:t})};return this.chatConn.inPrivateRoom()&&""!==r&&(a.private_show_id=r),""!==s&&(a.username=s),u._.isEnabledForUI()&&this.chatConn.wowzaHandler.ensureConnected(),(0,f.I5)("push_service/publish_chat_message_live/",a).then((function(e){var i,r=null!==(i=e.getResponseHeader("x-banned"))&&void 0!==i?i:e.getResponseHeader("x-denied"),s=new p.j(e.responseText);if(null!==r)r=decodeURIComponent(r),n.shouldHandleMessage()&&n.chatConn.event.roomNotice.fire({messages:[[(0,te.vK)(r)]],showInPrivateMessage:!0});else{var l=s.getObject("message");(0,B.h)(l);var c=void 0===a.private_show_id?new H.j4(o):new Q.k1(o,a.private_show_id),d=c.parseData(new p.j(l));d.isSpam="True"===e.getResponseHeader("x-spam"),u._.isEnabledForUI()&&void 0!==d.tid&&!u._.addExternalMessage(c.getKey(),d.tid)&&(n.history.addHistoryMessage(c.getKey(),d.tid),(0,ee.AO)(n.chatConn,d))}return{m:t,f:"",c:"",tid:s.getString("tid"),sig:s.getString("sig")}}))}},{key:"setupUserListeners",value:function(e){var t=this;this.chatConn.viewerIsAnonymous()||""===e||(new d.a6(e).onMessage.listen((function(e){l.q.setState({userColors:e})})).addTo(this.listeners.user),new d.tL(e).onMessage.listen((function(e){t.shouldHandleMessage()&&(0,ee.Eq)(e.message)})).addTo(this.listeners.user))}},{key:"setupVideoQualityTopic",value:function(e){""!==e&&new H.qm(e).onMessage.listen((function(e){var t,n,i=l.q.getState(),o=(e.tid,(0,P.Z)(e,ne));(0,E.d)(i.quality,o)||(l.q.setState(oe(oe({},i),{},{quality:o})),null!==(t=null===(n=l.q.getState().quality)||void 0===n?void 0:n.stopped)&&void 0!==t&&t&&(0,X.ZV)({eventName:"streamEnd"}))})).addTo(this.listeners.room)}},{key:"setupRoomListeners",value:function(e){var t=this;""!==e&&u._.isEnabledForVerify()&&(this.setupRoomPublicListeners(e),new H.GN(e).onMessage.listen((function(){})).addTo(this.listeners.room),new H.xn(e).onMessage.listen((function(e){t.chatConn.username()===e.username&&l.q.setState({isModerator:!0}),t.shouldHandleMessage()&&(0,ee.nF)(t.chatConn,e)})).addTo(this.listeners.room),new H.Nm(this.dossier.roomUid).onMessage.listen((function(e){t.chatConn.username()===e.username&&l.q.setState({isModerator:!1}),t.shouldHandleMessage()&&(0,ee.O0)(t.chatConn,e)})).addTo(this.listeners.room),new H.ez(e).onMessage.listen((function(e){var n=l.q.getState().roomStatus,i=e.status;if(void 0!==e.password&&""!==e.password&&!t.isBroadcaster&&l.q.getState().roomPassword!==e.password)return t.cleanup(),void(t.shouldHandleMessage()&&(window.location.reload(),(0,ee.x5)(t.chatConn)));if("offline"!==n&&(t.lastOnlineStatus=n),"hidden"===e.status){if(t.isBroadcaster)return;t.isInHiddenShow||(t.hiddenShowStarted=new Date),t.shouldHandleMessage()&&(""!==e.message&&(t.hiddenMessage=e.message),"hiddenwatching"===t.lastOnlineStatus?((0,ee.xH)(t.chatConn,t.lastOnlineStatus,t.hiddenMessage),i=t.lastOnlineStatus):(0,ee.xH)(t.chatConn,e.status,t.hiddenMessage))}else if("privatenotwatching"===e.status){if(t.isBroadcaster&&"offline"!==n||["privaterequesting","privatewatching","privatenotwatching"].includes(n))return;t.shouldHandleMessage()&&("offline"===n?t.isBroadcaster?t.chatConn.changeStatus("privatewatching"):"privatespying"===t.lastOnlineStatus?(t.chatConn.changeStatus(t.lastOnlineStatus),i=t.lastOnlineStatus):(""!==l.q.getState().privateShowId?t.chatConn.changeStatus("privaterequesting"):t.chatConn.changeStatus("public"),(0,ee.kl)(t.chatConn)):(0,ee.kl)(t.chatConn))}else if("away"===e.status&&t.shouldHandleMessage())"privatewatching"===n?(l.q.setState({privateShowId:"",roomStatus:"away"}),(0,ee.yo)(t.chatConn)):"privatenotwatching"===n||"privatespying"===n?(0,ee.yo)(t.chatConn):t.chatConn.changeStatus(e.status);else if("public"===e.status&&t.shouldHandleMessage())"away"===n?(0,ee.Bp)(t.chatConn):"hidden"===n||"hiddenwatching"===n?(0,ee.xH)(t.chatConn,e.status,e.message):t.chatConn.changeStatus(e.status);else{if("passwordprotected"===e.status)return;"offline"===e.status&&t.shouldHandleMessage()?("privaterequesting"===n&&((0,ee.yo)(t.chatConn),t.chatConn.leavePrivateOrSpyShow()),t.chatConn.changeStatus(e.status)):t.shouldHandleMessage()&&t.chatConn.changeStatus(e.status)}l.q.setState({roomStatus:i})})).addTo(this.listeners.room),new H.x7(e).onMessage.listen((function(e){t.shouldHandleMessage()&&(0,ee.RR)(t.chatConn,e.title)})).addTo(this.listeners.room),new H.Dn(e).onMessage.listen((function(e){t.shouldHandleMessage()&&(0,ee.A)(t.chatConn,e)})).addTo(this.listeners.room),new H.nf(e).onMessage.listen((function(e){t.shouldHandleMessage()&&(e.fromUser=t.chatConn.room(),t.chatConn.username()===e.username?(0,ee.K9)(t.chatConn,S.ag.kickedFromRoomMessage):(0,ee.gs)(t.chatConn,e))})).addTo(this.listeners.room),new H.ll(e).onMessage.listen((function(e){if(t.shouldHandleMessage()&&"refresh_panel"===e.target){var n=function(){t.chatConn.event.refreshPanel.fire({appId:e.appId,appSystem:e.appSystem})};l.J.current.throttleTopicPublish?window.setTimeout((function(){n()}),1e3):n()}})).addTo(this.listeners.room),new H.M2(e).onMessage.listen((function(e){l.q.setState({allowPrivateShow:e.allowPrivateShow,privatePrice:e.privatePrice,spyPrice:e.spyPrice,privateMinMinutes:e.privateMinMinutes,allowShowRecordings:e.allowShowRecordings}),!t.chatConn.inPrivateRoom()||t.isBroadcaster?t.shouldHandleMessage()&&(0,ee.Iq)(t.chatConn,e):t.chatConn.event.settingsUpdate.fire(e)})).addTo(this.listeners.room))}},{key:"setupRoomPublicListeners",value:function(e){var t=this;new H.j4(e).onMessage.listen((function(e){if(t.chatConn.inPrivateRoom())return e.ts=void 0,void t.history.push((function(){return(0,ee.AO)(t.chatConn,e)}));var n="RoomMessageTopic:".concat(l.q.getState().roomUid);void 0!==e.tid&&t.history.addHistoryMessage(n,e.tid),t.shouldHandleMessage()&&(0,ee.AO)(t.chatConn,e)})).addTo(this.listeners.room),new H.AE(e).onMessage.listen((function(e){var n=l.q.getState();if(e.fromUser.username===n.userName&&l.q.setState({isInFanClub:!0}),t.chatConn.inPrivateRoom())return e.ts=void 0,void t.history.push((function(){return(0,ee.FO)(t.chatConn,e)}));t.shouldHandleMessage()&&(0,ee.FO)(t.chatConn,e)})).addTo(this.listeners.room),new H.uH(e).onMessage.listen((function(e){if(t.chatConn.inPrivateRoom())return e.ts=void 0,void t.history.push((function(){return(0,ee.FO)(t.chatConn,e)}));t.shouldHandleMessage()&&(0,ee.FO)(t.chatConn,e)})).addTo(this.listeners.room),new H.pp(e).onMessage.listen((function(e){t.chatConn.inPrivateRoom()?e.ts=void 0:t.shouldHandleMessage()&&t.chatConn.event.roomNotice.fire(e)})).addTo(this.listeners.room),this.isBroadcaster||new H.jj(e).onMessage.listen((function(e){if(t.chatConn.inPrivateRoom())return e.ts=void 0,void t.history.push((function(){return(0,ee._A)(t.chatConn,e,!0)}));t.shouldHandleMessage()&&(0,ee._A)(t.chatConn,e)})).addTo(this.listeners.room),(0,c.vj)()&&new H.bj(e).onMessage.listen((function(e){if(t.chatConn.inPrivateRoom())return e.ts=void 0,void t.history.push((function(){return t.chatConn.event.roomShortcode.fire(e)}));t.chatConn.event.roomShortcode.fire(e)})).addTo(this.listeners.room)}},{key:"setupRoomUserListeners",value:function(e,t){var n=this;this.chatConn.viewerIsAnonymous()||""===e||""===t||(new H.gt(e,t).onMessage.listen((function(e){n.chatConn.inPrivateRoom()||n.shouldHandleMessage()&&n.chatConn.event.roomNotice.fire(e)})).addTo(this.listeners.room),(this.isBroadcaster?new d.Pg(e):new H.tS(e,t)).onMessage.listen((function(e){var t;switch(e.status){case"started":if("privatenotwatching".includes(n.chatConn.status))break;["privatewatching","privaterequesting"].includes(n.chatConn.status)?l.q.setState({privateShowId:e.privateShowId,roomStatus:"privatewatching"}):l.q.setState({roomStatus:"privatenotwatching"}),t=ee.kl;break;case"declined":l.q.setState({roomStatus:"public"}),t=ee.yo;break;case"stopped":l.q.setState({roomStatus:"away",privateShowId:""}),t=ee.yo;break;case"error":l.q.setState({roomStatus:"public",privateShowId:""}),t=ee.yo;break;case"spy_leave":l.q.setState({roomStatus:"public",privateShowId:""}),t=function(e){e.changeStatus("privatenotwatching")};break;default:n.isBroadcaster||warn("Invalid private show status on viewer",e,"PUSH_")}n.shouldHandleMessage()&&void 0!==t&&t(n.chatConn)})).addTo(this.listeners.room),new H.qt(e,t).onMessage.listen((function(e){if("approved"===e.status){n.isInHiddenShow=!0;var t=void 0===n.hiddenShowStarted||(new Date).getTime()-n.hiddenShowStarted.getTime()<2e3;n.shouldHandleMessage()&&(0,ee.fd)(n.chatConn,t),window.setTimeout((function(){l.q.setState({roomStatus:"hiddenwatching"})}),t?2e3:0)}else"denied"===e.status&&(n.isInHiddenShow=!1,l.q.setState({roomStatus:"hidden"}),n.shouldHandleMessage()&&n.chatConn.changeStatus("hidden"))})).addTo(this.listeners.room))}},{key:"setupPrivateRoomListeners",value:function(e,t){var n,i=this;if(""!==e){var o,r;if(""===t)return this.listeners.private.removeAll(),null===(o=this.privatePresence)||void 0===o||o.leavePresence(),this.joinRoomPresence(e,null!==(r=this.dossier.viewerUid)&&void 0!==r?r:""),void this.history.fireBuffer();null===(n=this.roomPresence)||void 0===n||n.leavePresence(),this.privatePresence=new Q.XM(e,t),this.privatePresence.enterPresence(),new Q.k1(e,t).onMessage.listen((function(e){i.shouldHandleMessage()&&(0,ee.AO)(i.chatConn,e)})).addTo(this.listeners.private),new Q.M4(e,t).onMessage.listen((function(e){i.shouldHandleMessage()&&(0,ee.o7)(i.chatConn,e),u._.isEnabledForUserList()&&i.chatConn.event.roomCountUpdate.fire(e.viewers),u._.setVerifierRoomCount(e.viewers)})).addTo(this.listeners.private),this.isBroadcaster||new Q.Vx(e,t).onMessage.listen((function(e){i.shouldHandleMessage()&&(0,ee._A)(i.chatConn,e)})).addTo(this.listeners.private),(0,c.vj)()&&new Q.O6(e,t).onMessage.listen((function(e){i.chatConn.event.roomShortcode.fire(e)})).addTo(this.listeners.private)}}},{key:"setupPrivilegedListeners",value:function(e,t){var n=this;""!==e&&(t?(new H.X(e).onMessage.listen((function(){})).addTo(this.listeners.privileged),new H.rc(e).onMessage.listen((function(e){n.chatConn.inPrivateRoom()||(n.shouldHandleMessage()&&(0,ee.o7)(n.chatConn,e),u._.isEnabledForUserList()&&n.chatConn.event.roomCountUpdate.fire(e.viewers),u._.setVerifierRoomCount(e.viewers))})).addTo(this.listeners.privileged),new H.ws(e).onMessage.listen((function(e){n.chatConn.inPrivateRoom()||(n.shouldHandleMessage()&&(0,ee.o7)(n.chatConn,e),u._.isEnabledForUserList()&&n.chatConn.event.roomCountUpdate.fire(e.viewers),u._.setVerifierRoomCount(e.viewers))})).addTo(this.listeners.privileged),this.isBroadcaster?(new H.zf(e).onMessage.listen((function(e){n.shouldHandleMessage()&&(0,ee.AS)(n.chatConn,e)})).addTo(this.listeners.privileged),new d.X_(e).onMessage.listen((function(e){n.shouldHandleMessage()&&"app_tab_refresh"===e.target&&n.chatConn.event.appTabRefresh.fire(void 0)})).addTo(this.listeners.privileged),new d._G(e).onMessage.listen((function(e){if(e.toUsername===n.chatConn.username())return n.chatConn.inPrivateRoom()&&"public"===e.roomType?(e.ts=void 0,void n.history.push((function(){return(0,ee._A)(n.chatConn,e,!0)}))):void(n.shouldHandleMessage()&&(0,ee._A)(n.chatConn,e))})).addTo(this.listeners.privileged),new d.Pg(e).onMessage.listen((function(e){if("requested"===e.status&&(l.q.setState({roomStatus:"privaterequesting"}),n.shouldHandleMessage())){var t={userRequesting:e.requester,tokensPerMinute:l.q.getState().privatePrice};(0,ee.$l)(n.chatConn,t)}}))):new q(e).onMessage.listen((function(e){n.shouldHandleMessage()&&n.chatConn.event.roomNotice.fire(e)})).addTo(this.listeners.privileged)):this.listeners.privileged.removeAll())}},{key:"setupFanClubListeners",value:function(e,t){var n=this;""!==e&&(t?new K(e).onMessage.listen((function(e){n.shouldHandleMessage()&&n.chatConn.event.roomNotice.fire(e)})).addTo(this.listeners.fanclub):this.listeners.fanclub.removeAll())}},{key:"setupColorGroupListeners",value:function(e,t,n){var i=this;if(""!==e&&void 0!==t){var o=function(e){i.chatConn.inPrivateRoom()||i.shouldHandleMessage()&&i.chatConn.event.roomNotice.fire(e)};!t.hasTokens||void 0!==n&&n.hasTokens||new $(e).onMessage.listen(o).addTo(this.listeners.color),!t.tippedRecently||void 0!==n&&n.tippedRecently||new Y(e).onMessage.listen(o).addTo(this.listeners.color),!t.tippedAlotRecently||void 0!==n&&n.tippedAlotRecently||new J(e).onMessage.listen(o).addTo(this.listeners.color),!t.tippedTonsRecently||void 0!==n&&n.tippedTonsRecently||new G(e).onMessage.listen(o).addTo(this.listeners.color)}}},{key:"setupGameListener",value:function(e){""!==e&&new H.yV(e).onMessage.listen((function(e){A.A.selectionChange.fire(e.game)})).addTo(this.listeners.room)}},{key:"setupRoomEnterLeaveListener",value:function(e,t){var n=this;t?this.listeners.enterLeave.removeAll():new H.sP(e).onMessage.listen((function(e){n.chatConn.inPrivateRoom()||(n.shouldHandleMessage()&&(0,ee.o7)(n.chatConn,e),u._.isEnabledForUserList()&&n.chatConn.event.roomCountUpdate.fire(e.viewers),u._.setVerifierRoomCount(e.viewers))})).addTo(this.listeners.enterLeave)}},{key:"joinRoomPresence",value:function(e,t){var n;""!==e&&!0!==(null===(n=l.J.current.loggedInUser)||void 0===n?void 0:n.isStaff)&&(this.chatConn.viewerIsAnonymous()?new H.w8(e).onSubscribeChange.listen((function(){})).addTo(this.listeners.room):""!==t&&(void 0===this.roomPresence&&(this.roomPresence=new H.bv(e,t)),this.roomPresence.enterPresence()))}},{key:"shouldHandleMessage",value:function(){return u._.isEnabledForUI()}},{key:"setupBackendSwapListener",value:function(){var e=this;(new N).onMessage.listen((function(t){u._.changeChatHandler(t.backends),e.chatConn.wowzaHandler.ensureConnected()})).addTo(this.listeners.global)}},{key:"cleanup",value:function(){var e,t;null===(e=this.roomPresence)||void 0===e||e.leavePresence(),null===(t=this.privatePresence)||void 0===t||t.leavePresence(),Object.values(this.listeners).forEach((function(e){return e.removeAll()})),this.history.dispose()}}]),e}(),ce=n(8759),ue=n(7693),de=n(1282),he=function(){function e(){(0,i.Z)(this,e),this.failures=0}return(0,o.Z)(e,[{key:"millisecondsForRetry",value:function(){return this.failures+=1,Math.min(1e4,1e3*this.failures)}},{key:"reset",value:function(){this.failures=0}}]),e}(),fe=n(928);function pe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?me(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){(0,R.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ye=function(){function e(t,n,o){var r=this;(0,i.Z)(this,e),this.roomDossier=t,this.event=n,this.chatConn=o,this._websocket=void 0,this.shouldReconnect=!0,this.messageHandler=new be(this.chatConn),this.reconnectLimiter=new he,this.remakeWebsocket(),(0,ce.Tt)()&&(this.handlePagehide=function(){r.disconnect()},(0,ue.j9)("pagehide",window,this.handlePagehide))}return(0,o.Z)(e,[{key:"remakeWebsocket",value:function(){var e,t,n=this;u._.isWowzaDisabled()||this.roomDossier.host.length>0&&(e="http"===this.roomDossier.host.substring(0,4)?new SockJS(this.roomDossier.host):new WebSocket(this.roomDossier.host),this._websocket=e,e.onclose=function(e){debug("Connection closed:".concat(JSON.stringify(e))),void 0===t?(u._.isEnabledForUI()||(n.event.roomNotice.fire({messages:[[(0,te.vK)("Chat disconnected")]],showInPrivateMessage:!0}),n.event.connectionLost.fire(void 0)),n.shouldReconnect&&(t=window.setTimeout((function(){n.showReconnectNotice(),n.remakeWebsocket()}),n.reconnectLimiter.millisecondsForRetry()))):n.showReconnectNotice()},e.onerror=function(e){debug("Connection error:".concat(JSON.stringify(e))),void 0===t&&n.shouldReconnect&&(t=window.setTimeout((function(){n.remakeWebsocket()}),n.reconnectLimiter.millisecondsForRetry()))},e.onmessage=function(e){n.messageHandler.receive(e.data)},e.onopen=function(){n.handleOpen()})}},{key:"readyState",value:function(){if(void 0===this._websocket)return"websocket undefined";switch(this._websocket.readyState){case WebSocket.CLOSED:return"closed";case WebSocket.OPEN:return"open";case WebSocket.CLOSING:return"closing";case WebSocket.CONNECTING:return"connecting";default:return"unknown"}}},{key:"ensureConnected",value:function(){var e;void 0!==this._websocket&&this.websocket().readyState===WebSocket.CONNECTING||this.isWebsocketReady()||(debug("restoring websocket"),null===(e=this._websocket)||void 0===e||e.close(),this.remakeWebsocket())}},{key:"websocket",value:function(){return this._websocket}},{key:"isWebsocketReady",value:function(){return void 0!==this._websocket&&this._websocket.readyState===WebSocket.OPEN}},{key:"setConnectedAndAuthed",value:function(){this.reconnectLimiter.reset(),we({method:"onTitleChange",callback:0,args:[]})&&(0,ee.RR)(this.chatConn,this.roomDossier.roomTitle)}},{key:"disconnect",value:function(){this.shouldReconnect=!1,void 0!==this._websocket&&(this._websocket.onclose=function(){},this._websocket.onerror=function(){},this._websocket.close(),this._websocket=void 0),void 0!==this.handlePagehide&&(0,ue.SC)("pagehide",window,this.handlePagehide)}},{key:"handleOpen",value:function(){this.sendMessage("connect",{user:this.roomDossier.chatUserName,password:this.roomDossier.viewerPassword,room:this.roomDossier.room,room_password:this.roomDossier.roomPassword})}},{key:"showReconnectNotice",value:function(){u._.isEnabledForUI()||this.event.roomNotice.fire({messages:[[(0,te.vK)("Trying to reconnect")]],showInPrivateMessage:!0})}},{key:"sendRawMessage",value:function(e){debug(["sending ",e]),this.websocket().send(e)}},{key:"sendMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!u._.isWowzaDisabled())return this.isWebsocketReady()?void this.sendRawMessage(JSON.stringify({method:e,data:t})):(this.ensureConnected(),void this.retryMessage(e,t,0))}},{key:"retryMessage",value:function(e,t,n){var i=this;this.isWebsocketReady()?this.sendRawMessage(JSON.stringify({method:e,data:t})):n<5?window.setTimeout((function(){i.retryMessage(e,t,n+1)}),1e3):(0,C.fg)("WowzaMsgRetryFailed",{method:e,push_active:u._.isEnabledForUI()})}}]),e}(),be=function(){function e(t){(0,i.Z)(this,e),this.conn=t}return(0,o.Z)(e,[{key:"receive",value:function(e){Ce&&debug(e);var t=function(e){var t=JSON.parse(e);return{method:t.method,callback:t.callback,args:t.args}}(e);Object.keys(xe).indexOf(t.method)>=0?we(t)?xe[t.method](this.conn,t):u._.isEnabledForUI()&&"onPersonallyKicked"===t.method&&"rejoined"===t.args[0]&&this.conn.wowzaHandler.disconnect():error("Unknown message method: ".concat(t.method," args: ").concat(e))}}]),e}();function we(e){return-1!==["onAuthResponse","onPrivateMsg"].indexOf(e.method)||("onNotify"===e.method&&"push_backends"===new p.j(e.args[0]).getString("type")||!u._.isEnabledForUI())}var Ce=!1;window.debugAllMessages=function(){Ce=!Ce,debug("debugAllMessages set to: ".concat(Ce))};var xe={onAuthResponse:function(e,t){if(1<=t.args.length&&"1"===t.args[0]){var n;switch(n=e.statusAfterConnected,"notconnected"!==e.status&&(n=e.status),n){case"offline":case"away":case"privaterequesting":case"privatenotwatching":case"privatespying":case"hidden":case"hiddenwatching":case"public":e.joinRoom(),e.changeStatus(n);break;case"privatewatching":"notconnected"===e.status?(e.joinPrivateRoom(),e.changeStatus(n)):(0,fe.ss)(e.room()).then((function(t){"privatenotwatching"===t.roomStatus&&e.isBroadcasting&&(t.roomStatus="privatewatching"),"privatewatching"===t.roomStatus?e.joinPrivateRoom():e.joinRoom(),e.changeStatus(t.roomStatus)})).catch((function(t){error("Error getting room dossier on reconnect: ".concat(t),{room:e.room()})}));break;default:warn("unexpected status: ".concat(n))}e.wowzaHandler.setConnectedAndAuthed()}else{if(t.args.length>0&&"0"===t.args[0])return;error("Error connecting!",{message:t})}},onRoomCountUpdate:function(e,t){t.args.length<1?error("Invalid onRoomCountUpdate args: ".concat(t.args)):""===t.args[0]||u._.isEnabledForUserList()||e.event.roomCountUpdate.fire(parseInt(t.args[0]))},onRoomMsg:function(e,t){if(""!==t.args[0]){var n=new p.j(t.args[1]);!0!==n.getAny("X-Successful")&&error("X-Successful not true?");var i=ge(ge({},(0,j.TU)(t.args[0],n)),{},{isSpam:!0===n.getAny("X-Spam")});(0,ee.AO)(e,i)}else t.args.length>1?"Chat disconnected. The broadcaster has set a new password on this room."===t.args[1]?(0,ee.x5)(e):e.event.roomNotice.fire({messages:[[(0,te.vK)(t.args[1])]],showInPrivateMessage:!0}):error("roomMessage invalid args: ".concat(t.args))},onNotify:function(e,t){var n=new p.j(t.args[0]),i=n.getString("type");n.ignore("send_to"),n.ignore("to_user"),"function"==typeof ke[i]?(0,ke[i])({conn:e,p:n,fromHistory:t.args.length>1&&"true"===t.args[1]}):error("Unhandled onNotify type ".concat(i),{message:t})},onTitleChange:function(e,t,n){t.args.length<1?error("Invalid onTitleChange args: ".concat(t.args)):t.args.length>1&&"0"===t.args[1]||(0,ee.RR)(e,t.args[0],n)},onPrivateMsg:function(e,t){if(!e.pmPushEnabled())if(""!==t.args[0]){var n=(0,j.VR)(t.args);(0,ee.SZ)(n,e.room())}else t.args.length>1?e.event.roomNotice.fire({messages:[[(0,te.vK)(t.args[1])]],showInPrivateMessage:!0}):error("handlePrivateMessage args: ".concat(t.args))},onPromotion:function(e,t){if(2!==t.args.length)error("Invalid onPromotion args: ".concat(t.args));else{var n={username:t.args[0],fromUser:t.args[1]};(0,ee.nF)(e,n)}},onRevoke:function(e,t){if(2!==t.args.length)error("Invalid onRevoke args: ".concat(t.args));else{var n={username:t.args[0],fromUser:t.args[1]};(0,ee.O0)(e,n)}},onPersonallyKicked:function(e,t){if(1!==t.args.length)error("Invalid onPersonallyKicked args: ".concat(t.args));else{var n,i=t.args[0];"rejoined"===i?(n=S.ag.rejoinedRoomKickedMessage,l.q.setState({privateShowId:""})):"kicked"===i?n=S.ag.kickedFromRoomMessage:(warn("createPersonallyKickedMessage called with unknown argument ".concat(i)),n=S.ag.kickedMessage),(0,ee.K9)(e,n)}},onSilence:function(e,t){if(2!==t.args.length)error("Invalid onSilence args: ".concat(t.args));else{var n={username:t.args[0],fromUser:t.args[1]};(0,ee.A)(e,n)}},onKick:function(e,t){if(1!==t.args.length)error("Invalid onKick args: ".concat(t.args));else{var n={username:t.args[0],fromUser:e.room()};(0,ee.gs)(e,n)}},onNotifyPrivateShowRequest:function(e,t){if(t.args.length<2)error("PrivateShowRequest invalid args: ".concat(t.args));else{var n={userRequesting:t.args[0],tokensPerMinute:parseInt(t.args[1])};(0,ee.$l)(e,n)}},onNotifyPrivateShowApprove:function(e,t){1===t.args.length?(0,ee.kl)(e):error("Invalid privateShowApprove args: ".concat(t.args))},onNotifyPrivateShowCancel:function(e,t){0!==t.args.length&&error("Invalid privateShowCancel args: ".concat(t.args)),(0,ee.yo)(e)},onNotifyLeavePrivateRoom:function(e,t){},onNotifyTokenBalanceUpdate:function(e,t){2!==t.args.length?error("Invalid tokenBalanceUpdate args: ".concat(t.args)):e.event.tokenBalanceUpdate.fire({tokens:Number(t.args[1])})},onNotifyAwayModeCancel:function(e,t){0!==t.args.length&&warn("Invalid awayModeCancel args: ".concat(t.args)),(0,ee.Bp)(e)}},ke={tip_alert:function(e){var t=(0,j.FE)(e.p);(0,ee._A)(e.conn,t,e.fromHistory),e.conn.isBroadcasting&&(0,f.Ue)("tipping/get_token_balance/").then((function(t){var n=new p.j(t.responseText);n.getBoolean("success")&&e.conn.event.tokenBalanceUpdate.fire({tokens:n.getNumber("token_balance")})})).catch((function(){}))},log:function(e){if(e.conn.isBroadcasting){var t=e.p.getStringOrUndefined("msg");if(void 0!==t){var n={debugMessage:t,type:e.p.getString("type"),tid:e.p.getString("tid")};(0,ee.AS)(e.conn,n)}else error("handleLog with an empty msg")}},refresh_panel:function(e){e.conn.event.refreshPanel.fire(void 0)},app_tab_refresh:function(e){e.conn.event.appTabRefresh.fire(void 0)},appnotice:function(e){var t,n=e.p.getAny("msg"),i=[];if("string"==typeof n)i.push([(0,te.vK)("Notice: ".concat(n))]);else{if(!(n instanceof Array))return void error("handleAppNotice error: Invalid message type ".concat(void 0===n?"undefined":n.toString()));var o,r=pe(n);try{for(r.s();!(o=r.n()).done;){var s=o.value;i.push([(0,te.vK)("Notice: ".concat(s))])}}catch(e){r.e(e)}finally{r.f()}}var a=function(){var t=document.body.classList.contains("darkmode"),n=(0,de.L)("SendNoticeDarkModeOpts")&&t,i=e.p.getStringOrUndefined("foreground"),o=e.p.getStringOrUndefined("background");if(n){var r=e.p.getStringOrUndefined("darkmode_foreground"),s=e.p.getStringOrUndefined("darkmode_background");void 0!==r&&""!==r&&(i=r),void 0!==s&&""!==s&&(o=s)}return{foreground:i,background:o}}(),l=a.foreground,c=a.background,u=null!==(t=e.p.getList("shortcodes"))&&void 0!==t?t:[],d={messages:i,toGroup:e.p.getStringOrUndefined("to_group"),toUser:e.p.getStringOrUndefined("to_user"),background:c,foreground:l,weight:e.p.getStringOrUndefined("weight",!1),showInPrivateMessage:!1,shortcodes:(0,j.mF)(u),tid:e.p.getString("tid")};e.conn.event.roomNotice.fire(d)},apperrorlog:function(e){if(e.conn.isBroadcasting){var t=e.p.getAny("msg"),n=[];if(n.push([(0,te.vK)("App Error: ")]),"string"==typeof t)n.push([(0,te.vK)(t)]);else{if(!(t instanceof Array))return void error("handleAppErrorLog error: Invalid message type ".concat(void 0===t?"undefined":t.toString()));var i,o=pe(t);try{for(o.s();!(i=o.n()).done;){var r=i.value;n.push([(0,te.vK)(r)])}}catch(e){o.e(e)}finally{o.f()}}var s={errorMessages:n,type:e.p.getString("type"),tid:e.p.getString("tid")};(0,ee.AS)(e.conn,s)}},clear_app:function(e){e.conn.event.refreshPanel.fire(void 0)},room_entry:function(e){e.conn.roomEntry((0,j.PU)(e.p))},room_leave:function(e){e.conn.roomLeave((0,j.PU)(e.p))},spy_room_leave:function(e){"privatespying"===e.conn.status&&e.conn.changeStatus("privatenotwatching")},purchase_notification:function(e){var t=(0,j.PU)(e.p);!0!==e.p.getBoolean("history")&&warn("purchase history is not true?");var n={fromUser:t,message:e.p.getString("message"),tid:e.p.getString("tid")};(0,ee.FO)(e.conn,n),n.fromUser.username===e.conn.username()&&(0,f.Ue)("tipping/get_token_balance/").then((function(t){var n=new p.j(t.responseText);n.getBoolean("success")&&e.conn.event.tokenBalanceUpdate.fire({tokens:n.getNumber("token_balance")})})).catch((function(){}))},settingsupdate:function(e){var t=(0,j.RE)(e.p);(0,ee.Iq)(e.conn,t)},hidden_show_status_change:function(e){if(!e.conn.isBroadcasting){var t=e.p.getBoolean("is_starting")?"hidden":"public",n=e.p.getString("hidden_message");e.p.logUnusedDebugging("handleHiddenShowStatusChange"),(0,ee.xH)(e.conn,t,n)}},hidden_show_approve:function(e){(0,ee.fd)(e.conn,e.p.getBoolean("initial_hide_cam"))},hidden_show_deny:function(e){"public"!==e.conn.status&&"hiddenwatching"!==e.conn.status||e.conn.changeStatus("hidden")},is_restricted_hls_allowed:function(e){},compliance_image_required:function(e){var t="Compliance Image Required!\nPlease visit ".concat(window.location.host,"/verify on your mobile\n     device to verify your identity.\n\nThis is required for broadcasters not showing their face."),n=e.p.getNumberOrUndefined("time");t+=void 0!==n&&n>0?"\n\nYou have ".concat(n," minute").concat(1===n?"":"s"," to complete."):"\n\nYou must complete this to continue broadcasting, failure to do so may result in broadcasting restrictions.",(0,ee.Eq)(t)},game_selection:function(e){A.A.selectionChange.fire(A.A.parseSelection(e.p.getObjectStringOrUndefined("game")))},push_backends:function(e){var t=e.p.getStringList("backends");void 0!==t?(u._.changeChatHandler(t),e.conn.wowzaHandler.ensureConnected()):warn("backend change sent with invalid args",{keys:e.p.keys()},"PUSH_")}};function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Te=function(){function e(t){var n=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,i.Z)(this,e),this.d=t,this.previousStatus="offline",this.status="offline",this.isModerator=!1,this.appDebuggingEnabled=!1,this.privateShowRequestingUser="",this.isBroadcasting=!1,this.isNewConnection=!1,this.exploringHashTag="",this.sourceName="un",this.roomCountPresenceThrottle=new y.d((function(){return n.roomCountPresence()}),{debounceType:2,bounceLimitMS:9e4}),this.event={messageSent:new b.xB("messageSent"),roomMessage:new b.xB("roomMessage"),roomNotice:new b.xB("roomNotice"),roomShortcode:new b.xB("roomShortcode"),statusChange:new b.xB("statusChange",{listenersWarningThreshold:15}),hiddenMessageChange:new b.xB("hiddenMessageChange"),refreshPanel:new b.xB("refreshPanel"),titleChange:new b.xB("titleChange"),clearApp:new b.xB("clearApp"),removeMessages:new b.xB("removeMessages"),settingsUpdate:new b.xB("settingsUpdate"),roomCountUpdate:new b.xB("roomCountUpdate"),modStatusChange:new b.xB("modStatusChange"),tokenBalanceUpdate:s.A3,privateShowRequest:new b.xB("privateShowRequest"),playSound:new b.xB("playSound"),appTabRefresh:new b.xB("appTabRefresh"),appDebugLog:new b.xB("appDebugLog"),tipAlert:new b.xB("tipAlert"),leftRoom:new b.xB("leftRoom"),connectionLost:new b.xB("connectionLost"),onBanSilence:new b.xB("onBanSilence")},this.isNewConnection=!1,this.isBroadcasting=this.username()===this.room(),this.viewerIsAnonymous()||(0,r.Rp)(),this.isModerator=t.isModerator,this.roomEntryFor=t.userChatSettings.roomEntryFor,this.roomLeaveFor=t.userChatSettings.roomLeaveFor,this.isBroadcasting?this.statusAfterConnected="public":this.statusAfterConnected=t.roomStatus,this.privatePrice=t.privatePrice,this.spyPrice=t.spyPrice,this.exploringHashTag=this.d.exploringHashTag,this.sourceName=this.d.sourceName,this.wowzaHandler=new ye(this.d,this.event,this),o&&(this.pushServiceHandler=new le(this.d,this)),this.changeStatus("notconnected"),this.listenForIgnores()}return(0,o.Z)(e,[{key:"appsRunning",value:function(){return this.d.appsRunning}},{key:"pmPushEnabled",value:function(){return u._.isEnabledForPM()}},{key:"disconnect",value:function(){var e;this.wowzaHandler.disconnect(),null===(e=this.pushServiceHandler)||void 0===e||e.cleanup()}},{key:"changeStatus",value:function(e){e!==this.status&&(debug("Status changing from ".concat(this.status," to ").concat(e)),this.previousStatus=this.status,this.status=e,this.isBroadcasting&&"notconnected"===this.previousStatus&&"public"===this.status&&(0,x.RZ)(),this.event.statusChange.fire({previousStatus:this.previousStatus,currentStatus:this.status}))}},{key:"updateEnterLeaveSettings",value:function(e,t){this.roomEntryFor=e,this.roomLeaveFor=t}},{key:"viewerIsAnonymous",value:function(){return"AnonymousUser"===this.username()}},{key:"isAppDebuggingEnabled",value:function(){return this.appDebuggingEnabled}},{key:"toggleAppDebugging",value:function(){this.appDebuggingEnabled=!this.appDebuggingEnabled,I.GZ.fire(this.appDebuggingEnabled)}},{key:"viewerInPrivateChat",value:function(){switch(this.status){case"privatewatching":return!0;case"privaterequesting":case"privatenotwatching":case"passwordprotected":case"public":case"away":case"hidden":case"hiddenwatching":case"offline":case"privatespying":case"notconnected":return!1;default:return warn("unexpected status: ".concat(this.status)),!1}}},{key:"sendShortcode",value:function(e){var t=this;if(e.shortcodes.map((function(e){return e.code.toLowerCase()})).includes("help"))this.event.roomNotice.fire({messages:[[(0,te.vK)((0,c.gi)(this.room(),this.isBroadcasting))]],showInPrivateMessage:!0});else{var n=e.shortcodes.map((function(e){var t={code:e.code};return void 0!==e.msg&&(t.msg=e.msg),void 0!==e.amt&&(t.amt=e.amt),t})),i={room:this.room(),shortcodes:JSON.stringify(n),message:JSON.stringify({m:e.message})},o=l.q.getState().privateShowId;""!==o&&this.inPrivateRoom()&&(i.private_show_id=o),(0,f.I5)("push_service/publish_chat_message_live/",i).then((function(e){var n,i=null!==(n=e.getResponseHeader("x-banned"))&&void 0!==n?n:e.getResponseHeader("x-denied");null!==i&&(i=decodeURIComponent(i),u._.isEnabledForUI()&&t.event.roomNotice.fire({messages:[[(0,te.vK)(i)]],showInPrivateMessage:!0}))})).catch((function(e){t.event.roomNotice.fire({messages:[[(0,te.vK)(S.ag.shortcodeGeneralError)]],showInPrivateMessage:!0})}))}}},{key:"sendRoomMessage",value:function(e){var t=this;this.event.messageSent.fire(void 0),(0,C.fg)("SendRoomMessage");var n=function(e){t.wowzaHandler.sendMessage(t.viewerInPrivateChat()?"messagePrivateRoom":"messageRoom",{room:t.d.room,msg:JSON.stringify({m:e,f:"",c:"",tid:""})})};if(void 0===this.pushServiceHandler)return warn("push service send handler not active",{},"PUSH_"),void n(e);var i=this.viewerInPrivateChat();this.pushServiceHandler.sendMessage(this.d.room,e).then((function(e){t.wowzaHandler.sendMessage(i?"messagePrivateRoom":"messageRoom",{room:t.d.room,msg:JSON.stringify(e)})})).catch((function(t){error("Publishing live message",t,"PUSH_"),n(e)}))}},{key:"updateRoomCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];u._.isEnabledForUserList()||this.wowzaHandler.sendMessage("updateRoomCount",{room_uid:this.d.roomUid,model_name:this.room(),private_room:this.inPrivateRoom()}),e?this.roomCountPresence():this.roomCountPresenceThrottle.callFunc()}},{key:"roomCountPresence",value:function(){var e=this,t=l.q.getState().privateShowId,n={presence_id:u._.presenceId};""!==t&&this.inPrivateRoom()&&(n.private_show_id=t);var i="push_service/room_user_count/".concat(this.room(),"/?").concat((0,T.Ie)(n));return(0,f.Ue)(i).then((function(t){if(u._.isEnabledForUserList()){var n=new p.j(t.responseText).getNumber("count");e.event.roomCountUpdate.fire(n),u._.setVerifierRoomCount(n)}})).catch(k.$x)}},{key:"kickUser",value:function(e){this.wowzaHandler.sendMessage("kickUser",{user:e,room:this.room()})}},{key:"requestPrivateShow",value:function(e,t,n){var i=this;return new Promise((function(o,r){"public"===i.status?(i.wowzaHandler.ensureConnected(),(0,f.I5)("tipping/private_show_request/".concat(i.room(),"/"),{chat_username:i.username(),price:"".concat(e),private_show_minimum_minutes:"".concat(t),recordings_allowed:"".concat(n)}).then((function(e){var t=new p.j(e.responseText),n=t.getString("message",!1);if(!t.getBoolean("success"))return""===n&&(error("unknown cannot start private show reason"),n="Cannot start private show."),void o(n);t.logUnusedDebugging("privateShowRequest"),i.changeStatus("privaterequesting"),l.q.setState({roomStatus:"privaterequesting"}),i.event.roomNotice.fire({messages:[[(0,te.vK)(S.ag.privateShowRequestMessage)]],foreground:"#222",background:"#ff8b45",weight:"bold",showInPrivateMessage:!0}),o("")})).catch((function(e){r(e)}))):r("unexpected status: ".concat(i.status))}))}},{key:"requestSpyShow",value:function(){var e=this;return new Promise((function(t,n){"privatenotwatching"===e.status?(e.wowzaHandler.ensureConnected(),(0,f.I5)("tipping/spy_on_private_show_request/".concat(e.room(),"/"),{chat_username:e.username()}).then((function(n){var i=new p.j(n.responseText),o=i.getBoolean("success"),r=i.getString("message",!1);if(i.logUnusedDebugging("parseRequestResult"),!o)return""===r&&(r="Error joining spy show"),void t(r);e.changeStatus("privatespying"),l.q.setState({roomStatus:"privatespying"}),e.event.roomNotice.fire({messages:[[(0,te.vK)("You are spying on the private show")]],foreground:"#222",background:"#ff8b45",weight:"bold",showInPrivateMessage:!0}),t("")})).catch((function(e){n(e)}))):n("unexpected status: ".concat(e.status))}))}},{key:"leavePrivateOrSpyShow",value:function(){var e=this;return new Promise((function(t,n){var i="tipping/private_show_cancel/".concat(e.room(),"/"),o=e.status;(0,f.I5)(i,{}).then((function(n){var i=new p.j(n.responseText),r=i.getBoolean("success"),s=i.getNumber("remaining_seconds"),a=i.getStringWithNumbers("private_show_minimum_minutes");switch(i.logUnusedDebugging("parseCancelResult"),o){case"privatewatching":if(!r){if(0===s)t(S.ag.privateShowRequestCancelErrorMessage);else{var c=Math.floor(s/60),u=s%60;t(S.ag.cannotCancelPrivate(a,c,u))}return}t("");break;case"privatespying":if(!r)return void t(S.ag.unableToCancelSpyShow);e.changeStatus("privatenotwatching"),l.q.setState({roomStatus:"privatenotwatching"}),t("");break;case"privaterequesting":if(!r)return void t(S.ag.unableToCancelPrivateRequest);t("");break;default:if(warn("unable to leave private show from status: ".concat(o)),!r)return void t(S.ag.unableToLeavePrivateShow(o));t("")}})).catch(n)}))}},{key:"joinRoom",value:function(){this.wowzaHandler.sendMessage("joinRoom",{room:this.room(),exploringHashTag:this.exploringHashTag,source_name:this.sourceName}),this.exploringHashTag="",this.sourceName="df"}},{key:"leaveRoom",value:function(){this.wowzaHandler.sendMessage("leaveRoom",{room:this.room()})}},{key:"joinPrivateRoom",value:function(){var e=this;window.setTimeout((function(){e.wowzaHandler.sendMessage("joinPrivateRoom",{room:e.room()})}),500)}},{key:"leavePrivateRoom",value:function(){this.wowzaHandler.sendMessage("leavePrivateRoom",{room:this.room()})}},{key:"inPrivateRoom",value:function(){return"privatewatching"===this.status}},{key:"setPrivateShowRequestingUser",value:function(e){this.privateShowRequestingUser=e}},{key:"getPrivateShowUser",value:function(){return this.inPrivateRoom()?this.privateShowRequestingUser:""}},{key:"room",value:function(){return this.d.room}},{key:"age",value:function(){return this.d.age}},{key:"username",value:function(){return this.d.userName}},{key:"ignore",value:function(e){var t=this;if((0,m.TF)())return this.event.roomNotice.fire({messages:[[(0,te.vK)(S.ag.loginToUseFeature)]],showInPrivateMessage:!0}),new Promise((function(){return!1}));if(this.d.room===this.username())return error("Error: cannot ignore users in this room"),new Promise((function(){return!1}));var n="".concat(this.username(),"-hitMaxIgnore"),i=(0,r.ey)().size>=r.nS;return new Promise((function(o){var s=function(){i&&(0,g.C)(n,"1",30);var s=(0,r.ey)();(0,r.qn)(e).then((function(n){if(n){var i,a=(0,r.ey)(),l=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Se(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(s);try{for(l.s();!(i=l.n()).done;){var c=i.value;a.has(c)||t.event.roomNotice.fire({messages:[[(0,te.vK)(S.ag.removedOldestIgnore(c))]],showInPrivateMessage:!0})}}catch(e){l.e(e)}finally{l.f()}}else t.event.roomNotice.fire({messages:[[(0,te.vK)(S.ag.errorIgnoringUser(e))]],showInPrivateMessage:!0});o(n)})).catch(void 0)};void 0===(0,g.sv)(n)&&i?(0,h.oB)(S.ag.reachedMaxIgnore,s):s()}))}},{key:"unignore",value:function(e){var t=this;return(0,r.jr)(e).then((function(n){return n||t.event.roomNotice.fire({messages:[[(0,te.vK)(S.ag.errorUnignoringUser(e))]],showInPrivateMessage:!0}),n}))}},{key:"isIgnored",value:function(e){return(0,r.WU)(e)}},{key:"listenForIgnores",value:function(){var e,t=this,n=null===(e=l.J.current.loggedInUser)||void 0===e?void 0:e.userUid;if(void 0!==n){var i=new d.zw(n).onMessage.listen((function(e){if(e.isIgnored){var n=S.ag.ignoringUser(e.username);t.event.roomNotice.fire({messages:[[(0,te.vK)(n)]],showInPrivateMessage:!0})}else{var i=S.ag.noLongerIgnoring(e.username);t.event.roomNotice.fire({messages:[[(0,te.vK)(i)]],showInPrivateMessage:!0})}}));v.QN.once((function(){return i.removeListener()}),!1)}}},{key:"roomEntry",value:function(t){if(e.updateUserInfoFromHashtag(t),this.shouldShowJoinLeaveMessage(this.roomEntryFor,t)){var n=this.isBroadcasting?t.exploringHashTag:"",i=[(0,te.vK)((0,w.Ng)(this.room(),t)),(0,te.iL)(t),(0,te.vK)(" ".concat(S.ag.roomJoinedMessage))];""!==n?(i.push((0,te.vK)(" (from ")),i.push((0,te.aB)(n,[n])),i.push((0,te.vK)(")"))):this.isBroadcasting&&"pr"===t.sourceName?i.push((0,te.vK)(" via promotion")):this.isBroadcasting&&"fn"===t.sourceName&&i.push((0,te.vK)(" via online announcement")),i.push((0,te.vK)(".")),this.event.roomNotice.fire({messages:[i],showInPrivateMessage:t.username===this.username(),dataNick:t.username})}}},{key:"roomLeave",value:function(t){if(this.shouldShowJoinLeaveMessage(this.roomLeaveFor,t)){var n=" ".concat(S.ag.roomLeftMessage);t.isBroadcaster&&!e.noFollowMessageInStatus.has(this.status)&&(n+=" ".concat(S.ag.roomFollowToGetNotified)),this.event.roomNotice.fire({messages:[[(0,te.vK)((0,w.Ng)(this.room(),t)),(0,te.iL)(t),(0,te.vK)(n)]],showInPrivateMessage:t.username===this.username(),dataNick:t.username})}}},{key:"shouldShowJoinLeaveMessage",value:function(e,t){if(t.username===this.username())return!1;if(t.username===(0,a.RH)())return!0;if((0,r.WU)(t.username))return!1;switch(e){case 3:return!1;case 2:if(t.username===this.room()||t.isMod||t.inFanclub)return!0;break;case 1:if(t.username===this.room()||t.isMod||t.inFanclub||t.hasTokens&&(this.isBroadcasting||this.isModerator))return!0;break;case 0:if(t.username===this.room()||t.isMod||t.inFanclub||this.isBroadcasting||this.isModerator)return!0;break;default:return error("Invalid EnterLeaveSetting"),!1}return!1}}],[{key:"updateUserInfoFromHashtag",value:function(e){switch(e.exploringHashTag){case"promotion":e.exploringHashTag="",e.sourceName="pr";break;case"onlineannouncement":e.exploringHashTag="",e.sourceName="fn"}}}]),e}();Te.privateViewStatuses=["privatewatching","privatenotwatching","privatespying"],Te.noFollowMessageInStatus=new Set(Te.privateViewStatuses)},5011:function(e,t,n){"use strict";n.d(t,{FE:function(){return w},PU:function(){return p},QY:function(){return v},RE:function(){return C},TU:function(){return m},VR:function(){return b},Vi:function(){return y},Vu:function(){return x},fE:function(){return S},lt:function(){return k},mF:function(){return T},p0:function(){return g},yp:function(){return f}});var i=n(4649),o=n(2800),r=n(6698),s=n(391),a=n(1282),l=n(1090);function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e){return h(h({},p(e)),{},{gender:e.getStringOrUndefined("gender",!1)})}function p(e){var t=e.getStrings(["from_username","user","username"]);1!==t.size&&error('getStrings(["from_username", "user", "username"]): '.concat(t," length is not 1 in ").concat(e.stringMessage));var n=t.values().next().value;return{username:n,isBroadcaster:n===o.q.getState().room,inFanclub:e.getBoolean("in_fanclub"),isFollowing:e.getBooleanOrUndefined("is_following"),hasTokens:e.getBoolean("has_tokens"),isMod:e.getBoolean("is_mod"),tippedRecently:e.getBoolean("tipped_recently"),tippedALotRecently:e.getBoolean("tipped_alot_recently"),tippedTonsRecently:e.getBoolean("tipped_tons_recently"),exploringHashTag:e.getString("exploringHashTag",!1),sourceName:(0,r.AY)(e.getString("source_name",!1)),gender:e.getStringOrUndefined("gender")}}function m(e,t){!0!==t.getAny("X-Successful")&&error("X-Successful not true?");var n={fromUser:f(t),message:t.getString("m"),font:t.getStringOrUndefined("f",!1),textColor:t.getStringOrUndefined("c",!1),messageID:t.getString("i",!1),backgroundColor:t.getStringOrUndefined("background",!1),tid:t.getString("tid",!1)};return n.fromUser.username!==e&&error("Parsing username match failed"),n}function v(e){return{fromUser:f(e.getParsedSubMap("from_user")),message:e.getString("message"),font:e.getStringOrUndefined("font_family",!1),textColor:e.getStringOrUndefined("font_color",!1),messageID:e.getString("id",!1),backgroundColor:e.getStringOrUndefined("background",!1),tid:e.getString("tid",!1)}}function g(e){return{fromUser:f(e.getParsedSubMap("from_user")),message:e.getString("m"),textColor:e.getStringOrUndefined("c",!1),messageID:e.getString("i",!1),otherUsername:e.getString("other_user"),font:e.getString("f"),mediaList:y(e.getObjectOrUndefined("media")),tid:e.getString("tid",!1),createdAt:new Date(1e3*e.getNumber("created_at")),isPrivate:!0}}function y(e){var t=[];if(void 0===e)return t;var n,i=c(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;t.push({mediaId:o.media_id,thumbnailUrl:o.media_thumbnail_url,url:o.media_url,opened:o.opened,fromUserUID:o.user_uid})}}catch(e){i.e(e)}finally{i.f()}return t}function b(e){var t=new s.j(e[1]);!0!==t.getAny("X-Successful")&&error("X-Successful not true?");var n=h(h({},m(e[0],t)),{},{otherUsername:""!==e[2]?e[2]:e[0],mediaList:y(t.getObjectOrUndefined("media")),isPrivate:!0});return t.logUnusedDebugging("parsePrivateMessageArgs"),n}function w(e){return{fromUser:f(e),message:e.getString("message"),amount:e.getNumber("amount"),isAnonymousTip:e.getBoolean("is_anonymous_tip"),toUsername:e.getStringOrUndefined("to_username"),tid:e.getString("tid")}}function C(e){var t={allowPrivateShow:e.getBoolean("allow_privates"),privatePrice:e.getNumber("private_price"),spyPrice:e.getNumber("spy_price"),privateMinMinutes:e.getNumber("private_min_minutes"),allowShowRecordings:e.getBoolean("allow_show_recordings"),tid:e.getString("tid")};return e.logUnusedDebugging("parseSettingsUpdate"),t}function x(e){var t,n=e.getAny("messages"),i=[];if("string"==typeof n)i.push([(0,l.vK)("Notice: ".concat(n))]);else if(n instanceof Array){var o,r=c(n);try{for(r.s();!(o=r.n()).done;){var s=o.value;i.push([(0,l.vK)("Notice: ".concat(s))])}}catch(e){r.e(e)}finally{r.f()}}else error("handleAppNotice error: Invalid message type ".concat(void 0===n?"undefined":n.toString()));var u=function(){var t=document.body.classList.contains("darkmode"),n=(0,a.L)("SendNoticeDarkModeOpts")&&t,i=e.getStringOrUndefined("foreground"),o=e.getStringOrUndefined("background");if(n){var r=e.getStringOrUndefined("darkmode_foreground"),s=e.getStringOrUndefined("darkmode_background");void 0!==r&&""!==r&&(i=r),void 0!==s&&""!==s&&(o=s)}return{foreground:i,background:o}}(),d=u.foreground,h=u.background,f=e.getStringOrUndefined("weight"),p=null!==(t=e.getList("shortcodes"))&&void 0!==t?t:[];return{foreground:d,background:h,weight:""===f?void 0:f,messages:i,showInPrivateMessage:e.getBoolean("showInPrivateMessage",!1,!1),shortcodes:T(p),tid:e.getString("tid")}}function k(e){var t,n,i=e.getString("type");if("log"===i)n=e.getString("message");else if("apperrorlog"===i){var o=e.getAny("message");if((t=[]).push([(0,l.vK)("App Error: ")]),"string"==typeof o)t.push([(0,l.vK)(o)]);else if(o instanceof Array){var r,s=c(o);try{for(s.s();!(r=s.n()).done;){var a=r.value;t.push([(0,l.vK)(a)])}}catch(e){s.e(e)}finally{s.f()}}else error("parseAppLog error: Invalid message type ".concat(void 0===o?"undefined":o.toString()))}else error("parseAppLog error: Unknown app log type: ".concat(i));return{type:i,errorMessages:t,debugMessage:n,tid:e.getString("tid")}}function S(e){return{text:e.getString("text"),notificationType:e.getString("notification_type"),url:e.getString("url"),timestamp:e.getNumber("timestamp"),timeSince:e.getString("time_since"),seen:e.getBoolean("seen",!1,!1)}}function T(e){var t,n=[],i=c(e);try{for(i.s();!(t=i.n()).done;){var o,r,s,a=t.value;n.push({code:a.getString("code"),msg:null!==(o=a.getStringOrUndefined("msg"))&&void 0!==o?o:"",amt:null!==(r=a.getNumberOrUndefined("amt"))&&void 0!==r?r:0,signupLink:null!==(s=a.getStringOrUndefined("signup_link"))&&void 0!==s?s:""})}}catch(e){i.e(e)}finally{i.f()}return n}},9617:function(e,t,n){"use strict";n.d(t,{AS:function(){return D},Bp:function(){return L},fd:function(){return _},xH:function(){return F},gs:function(){return M},x5:function(){return R},K9:function(){return I},SZ:function(){return x},kl:function(){return E},yo:function(){return B},$l:function(){return A},nF:function(){return S},FO:function(){return U},O0:function(){return T},o7:function(){return k},AO:function(){return C},Iq:function(){return Z},A:function(){return P},_A:function(){return O},RR:function(){return w},Eq:function(){return j}});var i=n(4649),o=n(5925),r=n(2951),s=n(1976),a=function(){function e(){(0,r.Z)(this,e)}return(0,s.Z)(e,null,[{key:"get",value:function(e){return void 0===window.ReactAPIRegistry?(error("ReactAPIRegistry is undefined - React code is likely not loaded",{argument:e}),function(){return Promise.reject()}):void 0===window.ReactAPIRegistry[e]?(error("ReactAPIRegistry does not contain API function ".concat(e," - React code may not be up to date"),{argument:e}),function(){return Promise.reject()}):window.ReactAPIRegistry[e]}}]),e}(),l=n(8015),c=n(2800),u=n(1522);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var h=(0,s.Z)((function e(t){(0,r.Z)(this,e),this.stringParts=[],this.hashtagParts=[];var n=t.match(/#[a-z0-9\-_]{2,50}/g);if(null!==n){var i,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(n);try{for(o.s();!(i=o.n()).done;){var s=i.value;this.hashtagParts.push(s.substr(1))}}catch(e){o.e(e)}finally{o.f()}}this.stringParts=t.split(/#[a-z0-9\-_]{2,50}/g)})),f=n(3543),p=n(9420),m=n(1090);function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e){return""===e.fromUser.username?(0,m.vK)(f.ag.aUser):(0,m.iL)(e.fromUser)}function w(e,t,n){if(""!==t){var i,o,r=[],s=f.ag.subjectChangeMessage(t),l=new h(s),u=function(n){for(var i=0;i<l.stringParts.length;i+=1){var o=(0,m.vK)(l.stringParts[i]);o.parseEmoticon=!1,r.push(o),i<l.hashtagParts.length&&r.push((0,m.aB)(l.hashtagParts[i],n))}e.event.roomNotice.fire({messages:[r],colorClass:"titleChange",foreground:"#DC5500",weight:"bold",showInPrivateMessage:!1}),e.event.titleChange.fire(t)};void 0===n?(i=t,o=c.J.current.languageCode,a.get("getApprovedTagsFromTitle")(i,o)).then(u).catch((function(){u([])})):u(n)}}function C(e,t){(0,o.WU)(t.fromUser.username)||e.event.roomMessage.fire(t)}function x(e,t,n){if(!(0,o.WU)(e.fromUser.username)){var i=void 0===n?t:n;""!==t&&i===t?l.Cb.fire(e):""===i&&l.Kd.fire(y(y({},e),{},{room:i}))}}function k(e,t){"enter"!==t.action||void 0!==t.connections&&1!==t.connections?"leave"!==t.action||void 0!==t.connections&&0!==t.connections||e.roomLeave(t.user):e.roomEntry(t.user)}function S(e,t){t.username===e.username()&&(e.event.modStatusChange.fire(!0),e.isModerator=!0);var n=(0,m.vK)(f.ag.moderatorPromoteMessage(t.fromUser,t.username));e.event.roomNotice.fire({messages:[[n]],showInPrivateMessage:[t.fromUser,t.username].includes(e.username())}),p.CD.fire({isMod:!0,username:t.username})}function T(e,t){t.username===e.username()&&(e.event.modStatusChange.fire(!1),e.isModerator=!1);var n=(0,m.vK)(f.ag.moderatorRevokeMessage(t.fromUser,t.username));e.event.roomNotice.fire({messages:[[n]],showInPrivateMessage:[t.fromUser,t.username].includes(e.username())}),p.CD.fire({isMod:!1,username:t.username})}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.ag.kickedFromRoomMessage;e.event.roomNotice.fire({messages:[[(0,m.vK)(t)]],showInPrivateMessage:!0}),e.changeStatus("notconnected")}function R(e){e.changeStatus("passwordprotected"),e.event.roomNotice.fire({messages:[[(0,m.vK)(f.ag.chatDisconnectedMessage)]],showInPrivateMessage:!0})}function P(e,t){e.event.removeMessages.fire({username:t.username}),(e.username()===t.fromUser||e.username()===t.username||e.username()===e.room()||e.isModerator)&&e.event.roomNotice.fire({messages:[[(0,m.vK)(f.ag.silenceMessage(t.username,t.fromUser))]],showInPrivateMessage:[t.fromUser,t.username].includes(e.username())}),e.event.onBanSilence.fire({silenced:t.username,silencer:t.fromUser,isBan:!1})}function M(e,t){e.event.removeMessages.fire({username:t.username}),"privatenotwatching"===e.status||"privatespying"===e.status||e.username()!==t.fromUser&&!e.isModerator||e.event.roomNotice.fire({messages:[[(0,m.vK)(f.ag.userKickedAndMessagesRemovedMessage(t.username))]],showInPrivateMessage:t.username===e.username()}),e.event.onBanSilence.fire({silenced:t.username,silencer:t.fromUser,isBan:!0})}function A(e,t){if(e.setPrivateShowRequestingUser(t.userRequesting),e.event.privateShowRequest.fire(t),e.isBroadcasting){switch(e.status){case"public":case"away":break;default:warn("unexpected status: ".concat(e.status))}e.changeStatus("privaterequesting"),e.isBroadcasting&&e.event.playSound.fire("PrivateShow")}}function E(e){switch(e.status){case"public":e.changeStatus("privatenotwatching");break;case"privaterequesting":e.leaveRoom(),e.joinPrivateRoom(),e.changeStatus("privatewatching");break;default:warn("private show approve unexpected status: ".concat(e.status))}var t=(0,m.vK)(f.ag.privateShowStartedMessage);"privatewatching"===e.status?(e.event.roomNotice.fire({messages:[[t]],foreground:"#222",background:"#ff8b45",weight:"bold",showInPrivateMessage:!0}),e.isBroadcasting&&!c.J.current.isMobile&&e.event.roomNotice.fire({messages:[[(0,m.vK)(f.ag.privateShowC2cTip)]],showInPrivateMessage:!0})):e.event.roomNotice.fire({messages:[[t,(0,m.vK)(" ("),{partType:3},(0,m.vK)(")")]],foreground:"#222",background:"#ff8b45",weight:"bold",showInPrivateMessage:!0})}function B(e){var t=function(){e.changeStatus("away"),e.event.roomNotice.fire({messages:[[(0,m.vK)(f.ag.privateShowFinishedMessage)]],foreground:"#222",background:"#ff8b45",weight:"bold",showInPrivateMessage:!0})};switch(e.status){case"privaterequesting":e.changeStatus("public"),e.event.roomNotice.fire({messages:[[(0,m.vK)(f.ag.privateShowDeclinedMessage)]],foreground:"#222",background:"#ff8b45",weight:"bold",showInPrivateMessage:!0});break;case"away":case"hidden":case"public":case"offline":case"hiddenwatching":break;case"privatewatching":e.leavePrivateRoom(),e.joinRoom(),t();break;case"privatespying":case"privatenotwatching":t();break;default:warn("privateShowCancel wrong room status: ".concat(e.status))}}function L(e){switch(e.status){case"away":case"public":case"privaterequesting":e.event.roomNotice.fire({messages:[[(0,m.vK)(f.ag.returnFromAwayModeMessage)]],foreground:"#222",background:"#ff8b45",weight:"bold",showInPrivateMessage:!0}),e.changeStatus("public");break;default:error("unexpected state: ".concat(e.status))}}function O(e,t){var n;arguments.length>2&&void 0!==arguments[2]&&arguments[2]||e.event.playSound.fire((n=t.amount)>=1e3?"HugeTip":n>=500?"LargeTip":n>=100?"MediumTip":n>=15?"SmallTip":"TinyTip"),e.event.tipAlert.fire(t);var i=[b(t),(0,m.vK)(" tipped ".concat(t.amount," ").concat(t.amount>1?"tokens":"token"))];t.isAnonymousTip&&i.push((0,m.vK)(" anonymously")),e.isBroadcasting&&""!==t.message&&i.push((0,m.vK)(" -- ".concat(t.message))),e.event.roomNotice.fire({messages:[i],background:"#ff3",foreground:"#000",weight:"bold",showInPrivateMessage:t.fromUser.username===e.username()||e.isBroadcasting,dataNick:t.fromUser.username,ts:t.ts})}function D(e,t){if("log"===t.type&&void 0!==t.debugMessage)e.event.appDebugLog.fire(t.debugMessage);else if("apperrorlog"===t.type&&void 0!==t.errorMessages){var n={messages:t.errorMessages,showInPrivateMessage:!1};e.event.roomNotice.fire(n)}else error("handleAppDebugError invalid type",t)}function U(e,t){var n,i=[],o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(t.message.split(new RegExp("\\b".concat(t.fromUser.username,"\\b"),"gi")));try{for(o.s();!(n=o.n()).done;){var r=n.value;""===r||i.push((0,m.vK)(r)),i.push((0,m.iL)(t.fromUser))}}catch(e){o.e(e)}finally{o.f()}i.pop(),e.event.roomNotice.fire({messages:[i],background:"#33ff33",foreground:"#000",weight:"bold",showInPrivateMessage:t.fromUser.username===e.username(),ts:t.ts})}function Z(e,t){if(e.event.settingsUpdate.fire(t),t.allowPrivateShow){if(e.privatePrice!==t.privatePrice){e.privatePrice=t.privatePrice;var n=(0,m.vK)(f.ag.privateShowPriceChangeMessage(e.room(),t.privatePrice));e.event.roomNotice.fire({messages:[[n]],showInPrivateMessage:!0})}if(e.spyPrice!==t.spyPrice&&0!==t.spyPrice){e.spyPrice=t.spyPrice;var i=(0,m.vK)(f.ag.spyShowPriceChangeMessage(e.room(),t.spyPrice));e.event.roomNotice.fire({messages:[[i]],showInPrivateMessage:!0})}}}function F(e,t,n){if(!e.isBroadcasting){switch(e.event.hiddenMessageChange.fire(n),e.status){case"privaterequesting":e.leavePrivateOrSpyShow();break;case"public":case"hidden":case"hiddenwatching":case"offline":break;default:error("handleHiddenShowStatusChange unexpected status: ".concat(e.status))}"public"===t?window.setTimeout((function(){e.changeStatus("public")}),3e3):e.changeStatus(t)}}function _(e,t){t?window.setTimeout((function(){e.changeStatus("hiddenwatching")}),2e3):e.changeStatus("hiddenwatching")}var N=!1;function j(e){N||(N=!0,(0,u.Cj)(e,(function(){N=!1})))}},1090:function(e,t,n){"use strict";function i(e){return{partType:1,message:e}}function o(e){return{partType:0,user:e}}function r(e,t){return-1!==t.indexOf(e)?{partType:2,message:e}:i("#".concat(e))}n.d(t,{aB:function(){return r},iL:function(){return o},vK:function(){return i}})},5042:function(e,t,n){"use strict";n.d(t,{Bi:function(){return s},_c:function(){return o},qm:function(){return a},rr:function(){return l},vq:function(){return r}});var i={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"};function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{red:200,green:200,blue:200},n=e.toLowerCase();if(n=function(e){if(/^[a-z]+$/.test(e)){var t=i[e];if(void 0!==t)return t}return e}(n),r(n))return function(e){4===e.length&&(e="#".concat(e[1]).concat(e[1]).concat(e[2]).concat(e[2]).concat(e[3]).concat(e[3]));var t=Number("0x".concat(e.substring(1)));return{red:t>>16&255,green:t>>8&255,blue:255&t}}(n);if(0===n.indexOf("rgb")){var o=e.match(/\d+(\.\d+)?%?/g);if(null===o||o.length<3||o.length>4)return t;o=[o[0],o[1],o[2]];for(var s=[],a=0;a<3;a+=1)-1!==o[a].indexOf("%")?s[a]=Math.round(2.55*parseFloat(o[a])):s[a]=Number(o[a]),s[a]<0?s[a]=0:s[a]>255&&(s[a]=255);return{red:s[0],green:s[1],blue:s[2]}}return debug('Cannot parse color: "'.concat(e,'"')),t}function r(e){return/^#([a-fA-F0-9]{3}){1,2}$/.test(e)}function s(e,t,n){var i=n*t,o=i*(1-Math.abs(e/60%2-1)),r=n-i,s=Math.round(255*(i+r)),a=Math.round(255*(o+r)),l=Math.round(255*r);return e<=60?{red:s,green:a,blue:l}:e<=120?{red:a,green:s,blue:l}:e<=180?{red:l,green:s,blue:a}:e<240?{red:l,green:a,blue:s}:e<=300?{red:a,green:l,blue:s}:{red:s,green:l,blue:a}}function a(e){var t,n,i=o(e),r=i.red/255,s=i.green/255,a=i.blue/255,l=Math.max(r,s,a),c=l-Math.min(r,s,a);return(t=0===c?0:l===r?(s-a)/c*60:l===s?60*((a-r)/c+2):60*((r-s)/c+4))<0&&(t+=360),n=0===l?0:c/l,{hue:Math.round(t),saturation:Number(n.toFixed(3)),value:Number(l.toFixed(3))}}function l(e){return(e.red>255||e.green>255||e.blue>255||e.red<0||e.green<0||e.blue<0)&&error("Invalid rgb color value: r: ".concat(e.red,", g: ").concat(e.green,", b: ").concat(e.blue)),"000000".concat((e.red<<16|e.green<<8|e.blue).toString(16)).slice(-6)}},4793:function(e,t,n){"use strict";n.d(t,{OT:function(){return u},QN:function(){return r},Sb:function(){return l},Z2:function(){return s},jr:function(){return c},kN:function(){return o},q:function(){return a}});var i=n(1794),o=new i.xB("roomLoaded",{listenersWarningThreshold:function(){return 100+3*i.q6},maxHistorySize:1}),r=new i.xB("roomCleanup",{listenersWarningThreshold:25}),s=new i.xB("userViewedPm"),a=new i.xB("tipSent"),l=new i.xB("externalChatMessage"),c=new i.xB("context"),u=new i.xB("context")},6767:function(e,t,n){"use strict";function i(e){var t=e.length+1;return document.cookie.split(";").map((function(e){return e.trim()})).filter((function(n){return n.substring(0,t)==="".concat(e,"=")})).map((function(e){return decodeURIComponent(e.substring(t))}))[0]}function o(e){var t;return null!==(t=i(e))&&void 0!==t?t:""}function r(e,t,n){s(e,t,86400*n)}function s(e,t,n){var i=new Date;i.setTime(i.getTime()+1e3*n),document.cookie="".concat(e,"=").concat(t,"; expires=").concat(i.toUTCString(),"; path=/")}function a(e,t){document.cookie="".concat(e,"=").concat(t,"; path=/")}function l(e){var t=i(e);if(void 0===t)return t;var n=parseInt(t);return isNaN(n)?void 0:n}function c(e){var t=i(e);return"true"===t||"false"!==t&&void 0}n.d(t,{C:function(){return r},RD:function(){return l},Uj:function(){return a},YM:function(){return s},ld:function(){return c},sv:function(){return i},ve:function(){return o}})},7988:function(e,t,n){"use strict";n.d(t,{F3:function(){return c},Fi:function(){return u},Sn:function(){return s},cQ:function(){return a},jV:function(){return d},xg:function(){return l}});var i=n(4649);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){t.style.left="".concat(e.left,"px"),t.style.top="".concat(e.top,"px"),t.style.width="".concat(e.width,"px"),t.style.height="".concat(e.height,"px")}function a(e){return{left:e.offsetLeft,top:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight}}function l(e,t,n){var i=r({},e);return i.top=e.top+t,i.height=e.height-t,i.top<0?(i.height+=i.top,i.top=0):i.height<n&&(i.top-=n-i.height,i.height=n),i}function c(e,t,n,i){var o=r({},e);return o.height=e.height+t,o.top+o.height>i?o.height=i-o.top:o.height<n&&(o.height=n),o}function u(e,t,n){var i=r({},e);return i.left=e.left+t,i.width=e.width-t,i.left<0?(i.width+=i.left,i.left=0):i.width<n&&(i.left-=n-i.width,i.width=n),i}function d(e,t,n,i){var o=r({},e);return o.width=e.width+t,o.left+o.width>i?o.width=i-o.left:o.width<n&&(o.width=n),o}},2694:function(e,t,n){"use strict";n.d(t,{fl:function(){return k},t7:function(){return S},t9:function(){return T}});var i=n(126),o=n(2951),r=n(1976),s=n(7591),a=n(9492),l=n(7597),c=n(8759),u=n(1185),d=n(7693),h=n(8069),f=n(9),p=n(8263),m=n(2600),v=n(1794),g=n(9846),y=n(3705),b=n(2239);function w(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var k=new v.xB("focusingInputFromKeypress",{listenersWarningThreshold:function(){return 10+v.q6}}),S=function(e){(0,s.Z)(n,e);var t=x(n);function n(e,i){var r;(0,o.Z)(this,n),(r=t.call(this)).submitInput=e,r.maxLength=i,r.savedCaret={nodeIdx:-1,nodeOffset:-1},r.recordUndoTimeout=-1,r.undoStack=[{inputContent:"",inputNodes:[],savedCaret:r.savedCaret}],r.undoPointer=0,r.ctrlMetaKeydownsIE=new Set,r.disableRequestUndo=!1,r.restoringBrowserUndo=!1,r.elementIsFocused=!1,r.listeners=new v.mM,r.maxLength=i,r.element.classList.add("customInput"),r.element.classList.add("noScrollbar"),r.element.style.position="relative",r.element.style.outline="none",r.element.style.border="none",r.element.style.boxSizing="border-box",r.element.style.fontSize="12px",r.element.style.whiteSpace="nowrap",r.element.style.overflowY="hidden",r.element.style.overflowX="scroll",r.element.contentEditable="true",(0,b.ql)(r.element,"text");var s=new h.d((function(){r.doUndo(!0)}),{bounceLimitMS:10,debounceType:0}),a=new h.d((function(){r.doRedo(!0)}),{bounceLimitMS:10,debounceType:0}),l=new h.d((function(){r.onPossibleEmoji()}),{bounceLimitMS:10,debounceType:1}),u=!1,f=!1;return(0,d.j9)("input",r.element,(function(e){var t,n="\n"===(null===(t=e.data)||void 0===t?void 0:t.charAt(e.data.length-1));if(!f&&n)return e.preventDefault(),void r.submit();u||r.restoringBrowserUndo||(u=!0,"historyUndo"===e.inputType?s.callFunc():"historyRedo"===e.inputType?a.callFunc():((0,c.IF)()||l.callFunc(),r.requestRecordUndo(!0)),r.updatePlaceholderVisibility(),r.saveCaretPos(),u=!1)})),(0,c.w1)()&&window.setInterval((function(){document.activeElement===r.element&&r.onPossibleEmoji()}),200),(0,d.j9)("paste",r.element,(function(e){var t;e.preventDefault(),null!==e.clipboardData&&(t=null!==window.clipboardData&&void 0!==window.clipboardData?window.clipboardData.getData("Text"):e.clipboardData.getData("text/plain"),r.insertText(t))})),(0,d.j9)("click",r.element,(function(e){if(null!==e.target&&e.target!==r.element){var t=window.getSelection();if(null!==t){var n=document.createRange(),i=e.target;e.offsetX<i.offsetWidth/2?n.setStartBefore(i):n.setStartAfter(i),n.collapse(!0),t.removeAllRanges(),t.addRange(n)}}r.saveCaretPos()})),(0,d.j9)("keydown",r.element,(function(e){f="Unidentified"!==e.key,"Enter"===e.key?(e.preventDefault(),r.submit()):r.willKeyEventViolateMaxLength(e)?e.preventDefault():(e.ctrlKey||e.metaKey)&&(-1!==["u","b","i"].indexOf(e.key)?e.preventDefault():"z"!==e.key||e.shiftKey?("z"===e.key&&e.shiftKey||"y"===e.key)&&(r.doRedo(),e.preventDefault()):(r.doUndo(),e.preventDefault()),r.ctrlMetaKeydownsIE.add(e.key)),r.updatePlaceholderVisibility()})),(0,d.j9)("keyup",r.element,(function(e){(0,c.w1)()&&(0,g.r)(e.which)&&(!r.ctrlMetaKeydownsIE.has(e.key)||e.repeat)?r.onInputChanged():-1===["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].indexOf(e.key)&&-1===["MetaLeft","MetaRight"].indexOf(e.code)||r.saveCaretPos(),r.ctrlMetaKeydownsIE.delete(e.key)})),(0,d.j9)("focus",r.element,(function(){var e;r.elementIsFocused=!0,void 0!==r.placeholder&&(null===(e=r.placeholder.parentElement)||void 0===e||e.removeChild(r.placeholder))})),(0,d.j9)("blur",r.element,(function(){r.elementIsFocused=!1,void 0!==r.placeholder&&""===r.getText()&&r.element.appendChild(r.placeholder),r.updatePlaceholderVisibility(),r.ctrlMetaKeydownsIE.clear()})),k.listen((function(e){r.willKeyEventViolateMaxLength(e)&&e.preventDefault()})).addTo(r.listeners),r}return(0,r.Z)(n,[{key:"setText",value:function(e){this.disableRequestUndo=!0,this.clearText(),this.insertText(e),this.element.scrollLeft=this.element.scrollWidth,this.disableRequestUndo=!1}},{key:"insertText",value:function(e){if(""!==e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&this.setCaretToEnd(),this.focus(!0),this.forceRequestedRecordUndo(),this.areAnyContentsSelected()){var t=window.getSelection();null!==t&&t.rangeCount>0&&t.getRangeAt(0).deleteContents()}if(e=(e=e.replace(/\r?\n|\r/g," ")).replace(/ /g,"Â "),""!==(e=n.truncateString(e,this.getAvailableLength()))){var o=this.createDivForText(e),r=window.getSelection();if(null!==r&&r.rangeCount>0){var s,a=r.getRangeAt(0),l=(0,i.Z)(o.childNodes).reverse(),c=l[0],u=w(l);try{for(u.s();!(s=u.n()).done;){var d=s.value;a.insertNode(d)}}catch(e){u.e(e)}finally{u.f()}a.setStartAfter(c),a.collapse(!0),r.removeAllRanges(),r.addRange(a)}this.onInputChanged(),this.updatePlaceholderVisibility(),this.scrollToSavedCaret()}}}},{key:"createDivForText",value:function(e){var t=document.createElement("div");if(t.textContent=e,!(0,c.IF)()){var n={unselectable:"on"};twemoji.parse(t,{attributes:function(e){return n}})}return t}},{key:"appendText",value:function(e){this.insertText(e,!0)}},{key:"clearText",value:function(){if(""!==this.getText()){this.forceRequestedRecordUndo();var e=window.getSelection();if(null!==e){var t=document.createRange();t.selectNodeContents(this.element),e.removeAllRanges(),e.addRange(t),t.deleteContents(),t.collapse(!0)}this.onInputChanged()}}},{key:"getText",value:function(){var e,t="",n=!1,i=w(this.element.childNodes);try{for(i.s();!(e=i.n()).done;){var o=e.value;if(o instanceof HTMLImageElement)t+=o.alt,n=!0;else{if(o===this.placeholder)continue;null!==o.textContent&&(!n||":"!==o.textContent[0]&&"@"!==o.textContent[0]||(t+=" "),t+=o.textContent,n=!1)}}}catch(e){i.e(e)}finally{i.f()}return t.replace(/\s/g," ")}},{key:"getAvailableLength",value:function(){return this.maxLength-this.getText().length}},{key:"setCaretToEnd",value:function(){var e=window.getSelection();if(null!==e){var t=document.createRange();t.selectNodeContents(this.element),t.collapse(!1),e.removeAllRanges(),e.addRange(t),this.saveCaretPos()}}},{key:"setCaretToEndOfSelection",value:function(){var e=window.getSelection();if(null!==e){var t=e.getRangeAt(e.rangeCount-1);t.selectNodeContents(this.element),t.collapse(!1),e.removeAllRanges(),e.addRange(t)}}},{key:"setCurrentNodeText",value:function(e){document.activeElement!==this.element&&this.restoreCaretPos();var t=this.getNodeAtCaret(),n=window.getSelection();if(null!==n){t.textContent=e;var i=document.createRange();i.selectNodeContents(t),i.collapse(!1),n.removeAllRanges(),n.addRange(i)}}},{key:"getCurrentNodeText",value:function(){var e=this.getNodeAtCaret();return null!==e.textContent?e.textContent.replace(/\s/g," "):""}},{key:"selectCurrentNodeTail",value:function(e){var t=this.getNodeAtCaret(),n=window.getSelection();if(null!==n&&n.rangeCount>0){var i=document.createRange();i.selectNodeContents(t),i.setStart(t,e),this.scrollToSavedCaret(),n.removeAllRanges(),n.addRange(i)}}},{key:"deleteSelection",value:function(){var e=window.getSelection();if(null!==e&&e.rangeCount>0){var t=e.getRangeAt(0);t.startContainer!==this.element&&this.element.contains(t.startContainer)&&(this.requestRecordUndo(!1),t.deleteContents(),this.onInputChanged())}}},{key:"focus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];document.activeElement!==this.element&&document.body.contains(this.element)&&(t&&!(0,p.PZ)(this.element)&&(this.element.scrollIntoView(!1),window.scrollBy(0,12)),this.element.focus(),e?this.restoreCaretPos():this.setCaretToEnd(),this.scrollToSavedCaret())}},{key:"blur",value:function(){this.element.blur()}},{key:"disable",value:function(){this.blur(),this.element.contentEditable="false"}},{key:"enable",value:function(){this.element.contentEditable="true"}},{key:"setPlaceholder",value:function(e,t){void 0===this.placeholder?(this.placeholder=document.createElement("span"),this.placeholder.textContent=e,this.placeholder.style.pointerEvents="none",this.placeholder.contentEditable="false",void 0!==t&&(0,u.vP)(this.placeholder,t),this.element.appendChild(this.placeholder)):this.placeholder.textContent=e}},{key:"submit",value:function(){if(this.submitInput()){if(!(0,c.IF)())for(var e=this.element.innerHTML,t=/<img[^>]+alt="?([^"\s]+)"?\s*/g,n=t.exec(e);null!==n;)(0,y.fg)("emojiSent",{value:n[1]}),n=t.exec(e);this.clearText(),this.blur()}}},{key:"onPossibleEmoji",value:function(){var e=window.getSelection();if(null!==e&&e.rangeCount>0){var t=this.getNodeAtCaret();if(null!==t.textContent&&twemoji.test(t.textContent)){var n=t.textContent,i=document.createRange();i.selectNodeContents(t),e.removeAllRanges(),e.addRange(i),i.deleteContents(),this.insertText(n);var o=this.getNodeAtCaret();""!==o.textContent&&(i.setStartBefore(o),i.collapse(!0),e.removeAllRanges(),e.addRange(i),this.saveCaretPos())}}}},{key:"areAnyContentsSelected",value:function(){var e=window.getSelection();if(null!==e&&e.rangeCount>0&&document.activeElement===this.element){var t=e.getRangeAt(0);if(t.startContainer!==t.endContainer||t.startOffset!==t.endOffset)return!0}return!1}},{key:"willKeyEventViolateMaxLength",value:function(e){return!(this.getAvailableLength()>0)&&!e.ctrlKey&&!e.metaKey&&(0,g.r)(e.which)&&-1===["Backspace","Delete"].indexOf(e.key)&&!this.areAnyContentsSelected()}},{key:"onInputChanged",value:function(){this.saveCaretPos(),this.requestRecordUndo(!0)}},{key:"requestRecordUndo",value:function(e){var t=this;window.clearTimeout(this.recordUndoTimeout),this.recordUndoTimeout=-1,this.disableRequestUndo||(e?this.recordUndoTimeout=window.setTimeout((function(){t.recordUndo(),t.recordUndoTimeout=-1}),300):this.recordUndo())}},{key:"forceRequestedRecordUndo",value:function(){-1!==this.recordUndoTimeout&&(window.clearTimeout(this.recordUndoTimeout),this.recordUndoTimeout=-1,this.recordUndo())}},{key:"recordUndo",value:function(){this.saveCaretPos();var e=this.getText();this.undoStack.splice(this.undoPointer+1,this.undoStack.length),this.undoStack[this.undoStack.length-1].inputContent===e&&this.undoStack.pop();var t=(0,i.Z)(this.element.childNodes).map((function(e){return e.cloneNode(!0)}));this.undoStack.push({inputContent:e,inputNodes:t,savedCaret:this.savedCaret}),this.undoStack.length>20&&this.undoStack.shift(),this.undoPointer=this.undoStack.length-1,this.keepBrowserUndoAvailable(!1)}},{key:"doUndo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(0,y.fg)(e?"BrowserTriggeredUndo":"HotkeyTriggeredUndo"),this.undoPointer!==this.undoStack.length-1||e||this.requestRecordUndo(!1),this.undoPointer>0&&(this.undoPointer-=1,this.applyUndoData(this.undoStack[this.undoPointer]),this.keepBrowserUndoAvailable(!0))}},{key:"doRedo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(0,y.fg)(e?"BrowserTriggeredRedo":"HotkeyTriggeredRedo"),this.undoPointer<this.undoStack.length-1&&(this.undoPointer+=1,this.applyUndoData(this.undoStack[this.undoPointer]),this.keepBrowserUndoAvailable(this.undoPointer<this.undoStack.length-1))}},{key:"applyUndoData",value:function(e){var t=this;this.element.innerHTML="",e.inputNodes.forEach((function(e){t.element.appendChild(e.cloneNode())})),this.savedCaret=e.savedCaret,this.restoreCaretPos(),this.scrollToSavedCaret()}},{key:"keepBrowserUndoAvailable",value:function(e){if(this.elementIsFocused&&!document.queryCommandSupported("insertText")){this.restoringBrowserUndo=!0;var t=function(){document.execCommand("insertText",!1,"~"),document.execCommand("delete",!1)},n=window.getSelection();if(null!==n&&n.rangeCount>0){var i=n.getRangeAt(0);n.removeAllRanges(),t(),n.addRange(i)}else t();this.restoringBrowserUndo=!1}}},{key:"getNodeAtCaret",value:function(){return this.saveCaretPos(),0===this.element.childNodes.length?this.element:-1===this.savedCaret.nodeIdx?this.element.childNodes[0]:this.element.childNodes[this.savedCaret.nodeIdx]}},{key:"caretLeftOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.getCaretRange(e).getBoundingClientRect().left}},{key:"caretXPos",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.caretLeftOffset(e)-this.element.getBoundingClientRect().left}},{key:"caretAtEndOfInput",value:function(){var e=this.getCurrentNodeText().length;return!(e>0&&this.savedCaret.nodeOffset!==e)&&!(0,i.Z)(this.element.childNodes).slice(this.savedCaret.nodeIdx+1).some((function(e){var t,n;return"IMG"===e.nodeName||(null!==(t=null===(n=e.textContent)||void 0===n?void 0:n.length)&&void 0!==t?t:0)>0}))}},{key:"getCaretWordStartRange",value:function(e){var t,n,i=e.startContainer;if(0===(null!==(t=null==i||null===(n=i.textContent)||void 0===n?void 0:n.length)&&void 0!==t?t:0))return e;if(null!==window.getSelection()){for(;e.startOffset>0;){var o=e.toString();if(/^\s/.test(o)){e.setStart(i,e.startOffset+1);break}e.setStart(i,e.startOffset-1)}return e}return document.createRange()}},{key:"getCaretRange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=document.createRange();if(0===this.element.childNodes.length)return t.setStart(this.element,0),t;var n=this.element.childNodes[this.savedCaret.nodeIdx];return-1===this.savedCaret.nodeIdx?t.setStartBefore(this.element.childNodes[0]):""===n.textContent?t.setStartAfter(n):t.setStart(n,this.savedCaret.nodeOffset),e?this.getCaretWordStartRange(t):t}},{key:"saveCaretPos",value:function(){var e=window.getSelection();if(null!==e&&e.rangeCount>0&&document.activeElement===this.element){var t,n=e.getRangeAt(0).cloneRange();if(n.collapse(!1),-1===(t=n.startContainer===this.element?n.startOffset-1:Array.from(this.element.childNodes).indexOf(n.startContainer)))this.savedCaret={nodeIdx:-1,nodeOffset:-1};else if(""===this.element.childNodes[t].textContent)this.savedCaret={nodeIdx:t,nodeOffset:-1};else{var i=this.element.childNodes[t].textContent,o=n.startContainer===this.element?i.length:n.startOffset;this.savedCaret={nodeIdx:t,nodeOffset:o}}}}},{key:"restoreCaretPos",value:function(){if(!(0===this.element.childNodes.length||this.savedCaret.nodeIdx>=this.element.childNodes.length)){var e=window.getSelection();if(null!==e){var t=this.getCaretRange();t.collapse(!0),e.removeAllRanges(),e.addRange(t)}}}},{key:"scrollToSavedCaret",value:function(){var e=0;if(-1!==this.savedCaret.nodeIdx){var t=this.element.childNodes[this.savedCaret.nodeIdx],n=document.createRange();n.setStart(this.element,0),n.setEndAfter(t),e=n.getBoundingClientRect().width}e+=3,this.element.scrollLeft=Math.max(this.element.scrollLeft,e-this.element.offsetWidth)}},{key:"updatePlaceholderVisibility",value:function(){""!==this.getText()?this.element.classList.remove("inputFieldChatPlaceholder"):this.element.classList.add("inputFieldChatPlaceholder")}},{key:"dispose",value:function(){this.listeners.removeAll()}}],[{key:"truncateString",value:function(e,t){if(e.length<=t)return e;var n,i=-1,o=0,r=w(e);try{for(r.s();!(n=r.n()).done;){var s=n.value;if(o+s.length>t)break;twemoji.test(s)&&(i=o),o+=s.length}}catch(e){r.e(e)}finally{r.f()}if(-1!==i){var a=(0,m.xJ)(e.substr(i,e.length));if(void 0!==a&&i+a.emojiChars.length>t)return e.substr(0,i)}return e.substr(0,o)}}]),n}(f.w),T=function(e){(0,s.Z)(n,e);var t=x(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this)).inputElement=e,i.element=e,i}return(0,r.Z)(n,[{key:"caretLeftOffset",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.inputElement.value.substring(0,null!==(e=this.inputElement.selectionStart)&&void 0!==e?e:0);if(t){for(;n.length>0&&!/^\s/.test(n);)n=n.slice(0,-1);n=this.inputElement.value.substring(0,n.length+1)}return(0,p.mY)(n,this.inputElement)}},{key:"caretXPos",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.caretLeftOffset(e)+this.element.getBoundingClientRect().left}},{key:"caretAtEndOfInput",value:function(){return this.inputElement.selectionStart===this.inputElement.value.length}},{key:"getAvailableLength",value:function(){return this.inputElement.maxLength-this.inputElement.value.length}},{key:"setCurrentNodeText",value:function(e){this.inputElement.value=e}},{key:"appendText",value:function(e){this.inputElement.value="".concat(this.inputElement.value).concat(e)}},{key:"setCaretToEnd",value:function(){var e=window.getSelection();if(null!==e){var t=document.createRange();t.selectNodeContents(this.element),t.collapse(!1),e.removeAllRanges(),e.addRange(t)}}},{key:"setCaretToEndOfSelection",value:function(){var e=window.getSelection();if(null!==e){var t=e.getRangeAt(e.rangeCount-1);t.selectNodeContents(this.element),t.collapse(!1),e.removeAllRanges(),e.addRange(t)}}},{key:"getCurrentNodeText",value:function(){return this.inputElement.value.replace(/\s/g," ")}},{key:"selectCurrentNodeTail",value:function(e){this.inputElement.setSelectionRange(e,this.inputElement.value.length)}},{key:"deleteSelection",value:function(){if(null!==this.inputElement.selectionStart){var e=this.inputElement.value.substring(0,this.inputElement.selectionStart);this.inputElement.value=e}}},{key:"focus",value:function(){this.inputElement.focus()}},{key:"blur",value:function(){this.inputElement.blur()}}]),n}(f.w)},9493:function(e,t,n){"use strict";n.d(t,{b1:function(){return s},ek:function(){return r},wk:function(){return o}});var i=n(3543);function o(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e<=0)return"";var n=Math.floor(e/3600);e%=3600;var i=Math.floor(e/60);e%=60;var o="",r="";(n>1||1===n)&&(o="".concat(n,"h")),i>1||1===i?r="".concat(i,"m"):0===n&&(r=t?"":"<1m");var s="";return t&&(s=" ".concat(e,"s")),"".concat(o).concat(r).concat(s)}function r(e){var t=(Date.now()-e.getTime())/1e3;return t<60?i.ag.now:t<=120?i.ag.oneMinuteAgo:t<3600?i.ag.minutesAgo(Math.floor(t/60)):t<=7200?i.ag.anHourAgo:t<86400?i.ag.hoursAgo(Math.floor(t/3600)):t<=172800?i.ag.aDayAgo:t<604800?i.ag.daysAgo(Math.floor(t/86400)):e.toLocaleDateString()}function s(e,t){return(e.getTime()-t.getTime())/1e3}},8069:function(e,t,n){"use strict";n.d(t,{d:function(){return c},l:function(){return u}});var i=n(3243),o=n(7591),r=n(9492),s=n(7597),a=n(2951),l=n(1976);var c=function(){function e(t,n){(0,a.Z)(this,e),this.func=t,this.config=n,this.recentlyLetPassthrough=!1,this.callImmediate=!1}return(0,l.Z)(e,[{key:"callFunc",value:function(){var e=this;if(1===this.config.debounceType)return clearTimeout(this.debounceTimeout),void(this.debounceTimeout=window.setTimeout(this.func,this.config.bounceLimitMS));this.recentlyLetPassthrough?this.callImmediate=!0:(this.recentlyLetPassthrough=!0,this.func(),window.setTimeout((function t(){e.callImmediate&&2===e.config.debounceType?(e.callImmediate=!1,e.func(),window.setTimeout(t,e.config.bounceLimitMS)):e.recentlyLetPassthrough=!1}),this.config.bounceLimitMS))}}]),e}(),u=function(e){(0,o.Z)(u,e);var t,n,c=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,s.Z)(t);if(n){var o=(0,s.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,r.Z)(this,e)});function u(e){var t;return(0,a.Z)(this,u),(t=c.call(this,(function(){t.isStart=!0,e(!1)}),{bounceLimitMS:300,debounceType:1})).fn=e,t.isStart=!0,t}return(0,l.Z)(u,[{key:"callFunc",value:function(){this.isStart&&(this.isStart=!1,this.fn(!0)),(0,i.Z)((0,s.Z)(u.prototype),"callFunc",this).call(this)}}]),u}(c)},3593:function(e,t,n){"use strict";n.r(t),n.d(t,{debug:function(){return a},error:function(){return o},info:function(){return s},warn:function(){return r}});var i=n(1896),o=i.vU,r=i.ZK,s=i.um,a=i.fF;window.onerror=function(e,t,n,i,r){var s;try{s=JSON.stringify(r)}catch(e){s="".concat(r)}var a=['"Message: " '.concat(e),'"URL: "  '.concat(t),'"Line: " '.concat(n),'"Column: " '.concat(i),'"Error object: " '.concat(s)].join("\n");return o(a,{},"UNCAUGHT_"),!1}},5343:function(e,t,n){"use strict";n.d(t,{O:function(){return s}});var i=n(2951),o=n(1976),r=n(4695),s=function(){function e(){(0,i.Z)(this,e),this.drawPile=new r.h,this.discardPile=new r.h}return(0,o.Z)(e,[{key:"addToTop",value:function(e){this.currentElem!==e&&(this.discardPile.remove(e),this.drawPile.addToTop(e))}},{key:"nextElem",value:function(){var e=this.drawPile.popFromTop();return void 0!==this.currentElem&&this.discardPile.addToTop(this.currentElem),this.currentElem=e,e}},{key:"prevElem",value:function(){var e=this.discardPile.popFromTop();return void 0!==this.currentElem&&this.drawPile.addToTop(this.currentElem),this.currentElem=e,e}},{key:"refillFromDiscard",value:function(){for(;;){var e=this.discardPile.popFromBottom();if(void 0===e)break;this.drawPile.addToBottom(e)}void 0!==this.currentElem&&(this.drawPile.addToBottom(this.currentElem),this.currentElem=void 0)}},{key:"emptyDrawIntoDiscard",value:function(){for(;;){var e=this.drawPile.popFromBottom();if(void 0===e)break;this.discardPile.addToBottom(e)}void 0!==this.currentElem&&(this.discardPile.addToBottom(this.currentElem),this.currentElem=void 0)}},{key:"remove",value:function(e){this.discardPile.remove(e),this.drawPile.remove(e),this.currentElem===e&&(this.currentElem=void 0)}},{key:"makeCurrent",value:function(e){this.currentElem!==e&&(this.addToTop(e),this.nextElem())}}]),e}()},9:function(e,t,n){"use strict";n.d(t,{w:function(){return l}});var i=n(2951),o=n(1976),r=n(1794);function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw r}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",n=arguments.length>1?arguments[1]:void 0;(0,i.Z)(this,e),this._children=[],this.hasInitUI=!1,this.didRepositionEvent=new r.xB("didReposition",{reportIfNoListeners:!1}),this.element="string"==typeof t?this.createBaseElement(t,n):t,this.initData(n),this.initUI(n),this.element.setAttribute("ts","".concat(this.constructor.name))}return(0,o.Z)(e,[{key:"createBaseElement",value:function(e,t){var n=document.createElement(e);return n.style.height="100%",n.style.width="100%",n.style.position="absolute",n.style.overflow="hidden",n.style["-webkit-tap-highlight-color"]="transparent",n}},{key:"initData",value:function(e){}},{key:"initUI",value:function(e){}},{key:"lazyInitUI",value:function(){this.hasInitUI=!0}},{key:"repositionChildren",value:function(){}},{key:"repositionChildrenRecursive",value:function(){this.repositionChildren();var e,t=s(this.children());try{for(t.s();!(e=t.n()).done;)e.value.repositionChildrenRecursive()}catch(e){t.e(e)}finally{t.f()}this.didRepositionEvent.fire(void 0)}},{key:"afterDOMConstructed",value:function(){}},{key:"afterDOMConstructedIncludingChildren",value:function(){this.afterDOMConstructed();var e,t=s(this.children());try{for(t.s();!(e=t.n()).done;)e.value.afterDOMConstructedIncludingChildren()}catch(e){t.e(e)}finally{t.f()}}},{key:"addChild",value:function(e,t){return this.attachChild(e),void 0===t&&(t=this.element),e.hasInitUI||e.lazyInitUI(),t.appendChild(e.element),e}},{key:"prependChild",value:function(e,t){return this.attachChild(e,0),void 0===t&&(t=this.element),t.insertBefore(e.element,this.element.firstChild),e}},{key:"addChildBeforeIndex",value:function(e,t,n){if(t>this._children.length||t<0)return error("tried to add item before an index that does not exist"),e;if(void 0===n&&(n=this.element),e.hasInitUI||e.lazyInitUI(),t===this._children.length)this.attachChild(e),n.appendChild(e.element);else{var i=this._children[t].element;this.attachChild(e,t),n.insertBefore(e.element,i)}return e}},{key:"attachChild",value:function(e,t){void 0!==e.parent&&e.parent!==this&&e.parent.removeChild(e),void 0===t?this._children.push(e):this._children.splice(t,0,e),e.parent=this}},{key:"addChildBefore",value:function(e,t){void 0!==e.parent&&e.parent!==this&&e.parent.removeChild(e);var n=void 0===t?-1:this._children.indexOf(t);return n<0?this.element.appendChild(e.element):this.element.insertBefore(e.element,this._children[n].element),this._children.splice(n,0,e),e.parent=this,e}},{key:"removeChild",value:function(e){var t=this._children.indexOf(e);if(-1!==t){this._children.splice(t,1),e.parent===this&&(e.parent=void 0),this.cleanupChildDOM(e);var n,i=s(e.children());try{for(i.s();!(n=i.n()).done;)n.value.afterRemovedFromParent()}catch(e){i.e(e)}finally{i.f()}e.afterRemovedFromParent()}else error("tried removing component that doesn't exist")}},{key:"cleanupChildDOM",value:function(e){var t=e.element.parentNode;null!==t?t.removeChild(e.element):error("couldn't find parent element to use for node removal")}},{key:"removeAllChildren",value:function(){var e,t=s(this.children());try{for(t.s();!(e=t.n()).done;){var n=e.value;n.parent===this&&(n.parent=void 0),this.cleanupChildDOM(n),n.afterRemovedFromParent()}}catch(e){t.e(e)}finally{t.f()}this._children=[]}},{key:"removeAllDOMChildren",value:function(){for(;null!==this.element.firstChild;)this.element.removeChild(this.element.firstChild)}},{key:"children",value:function(){return this._children}},{key:"siblings",value:function(){var e=this;return void 0===this.parent?[]:this.parent._children.filter((function(t){return t!==e}))}},{key:"afterRemovedFromParent",value:function(){}},{key:"showElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"block";this.element.style.display=void 0===this.originalDisplayStyle?e:this.originalDisplayStyle}},{key:"hideElement",value:function(){"none"!==this.element.style.display&&(""!==this.element.style.display&&(this.originalDisplayStyle=this.element.style.display),this.element.style.display="none")}},{key:"isShown",value:function(){return"none"!==this.element.style.display}},{key:"toggleShowHide",value:function(){this.isShown()?this.hideElement():this.showElement()}},{key:"previousSibling",value:function(){if(void 0!==this.parent)return this.findPreviousSibling(this.parent.children())}},{key:"nextSibling",value:function(){if(void 0!==this.parent)return this.findPreviousSibling(this.parent.children().slice().reverse())}},{key:"lastChild",value:function(){return this.children().length>0?this.children()[this.children().length-1]:void 0}},{key:"findPreviousSibling",value:function(e){var t,n,i=s(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o===this)break;t=o}}catch(e){i.e(e)}finally{i.f()}return t}}]),e}()},7585:function(e,t,n){"use strict";n.d(t,{I:function(){return u}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(47);var u=function(e){(0,s.Z)(d,e);var t,n,u=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function d(e){return(0,i.Z)(this,d),u.call(this,void 0,e)}return(0,o.Z)(d,[{key:"initData",value:function(e){(0,r.Z)((0,l.Z)(d.prototype),"initData",this).call(this,e)}},{key:"createBaseElement",value:function(e,t){return this.state=this.initState(t),this.createElement(t)}},{key:"createElement",value:function(e){return(0,r.Z)((0,l.Z)(d.prototype),"createBaseElement",this).call(this,"div",e)}},{key:"render",value:function(){return this.element}},{key:"setState",value:function(e){for(var t in e)e.hasOwnProperty(t)&&(this.state[t]=e[t]);this.updateState()}},{key:"updateState",value:function(){var e=this;(0,c.rP)(this.element).forEach((function(t){t instanceof Function?t():t!==e&&t.updateState()}))}},{key:"initState",value:function(e){return{}}}]),d}(n(9).w)},3149:function(e,t,n){"use strict";n.d(t,{G3:function(){return r},fR:function(){return o},sz:function(){return a},vV:function(){return s}});var i=n(1185);function o(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,r=document.createElement("div");r.style.position="absolute",r.style.height="0",r.style.width="0",r.style.top="-8px",r.style.left=n;var s=document.createElement("div");(0,i.vP)(s,"divotBorder"),s.style.borderLeft="8px solid transparent",s.style.borderRight="8px solid transparent",s.style.borderBottomWidth="8px",s.style.borderBottomStyle="solid",""!==e&&(s.style.borderBottomColor="".concat(e)),r.appendChild(s);var a=8-o,l=document.createElement("div");return(0,i.vP)(l,"divotBackground"),l.style.position="absolute",l.style.top="".concat(o,"px"),l.style.left="".concat(o,"px"),l.style.borderLeft="".concat(a,"px solid transparent"),l.style.borderRight="".concat(a,"px solid transparent"),l.style.borderBottomWidth="".concat(a,"px"),l.style.borderBottomStyle="solid",""!==t&&(l.style.borderBottomColor="".concat(t)),s.appendChild(l),r}function r(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,r=document.createElement("div");r.style.position="absolute",r.style.height="0",r.style.width="0",r.style.bottom="0",r.style.left=n;var s=document.createElement("div");(0,i.vP)(s,"divotBorder"),s.style.borderLeft="8px solid transparent",s.style.borderRight="8px solid transparent",s.style.borderTopWidth="8px",s.style.borderTopStyle="solid",""!==e&&(s.style.borderTopColor="".concat(e)),r.appendChild(s);var a=8-o,l=document.createElement("div");return(0,i.vP)(l,"divotBackground"),l.style.position="absolute",l.style.top="0",l.style.left="".concat(o,"px"),l.style.borderLeft="".concat(a,"px solid transparent"),l.style.borderRight="".concat(a,"px solid transparent"),l.style.borderTopWidth="".concat(a,"px"),l.style.borderTopStyle="solid",""!==t&&(l.style.borderTopColor="".concat(t)),s.appendChild(l),r}function s(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,r=document.createElement("div");r.style.position="absolute",r.style.height="0",r.style.width="0",r.style.left="-8px",r.style.top=n;var s=document.createElement("div");(0,i.vP)(s,"divotBorder"),s.style.borderTop="8px solid transparent",s.style.borderBottom="8px solid transparent",s.style.borderRightWidth="8px",s.style.borderRightStyle="solid",""!==e&&(s.style.borderRightColor="".concat(e)),r.appendChild(s);var a=8-o,l=document.createElement("div");return(0,i.vP)(l,"divotBackground"),l.style.position="absolute",l.style.top="".concat(o,"px"),l.style.left="".concat(o,"px"),l.style.borderTop="".concat(a,"px solid transparent"),l.style.borderBottom="".concat(a,"px solid transparent"),l.style.borderRightWidth="".concat(a,"px"),l.style.borderRightStyle="solid",""!==t&&(l.style.borderRightColor="".concat(t)),s.appendChild(l),r}function a(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,r=document.createElement("div");r.style.position="absolute",r.style.height="0",r.style.width="0",r.style.right="0",r.style.top=n;var s=document.createElement("div");(0,i.vP)(s,"divotBorder"),s.style.borderTop="8px solid transparent",s.style.borderBottom="8px solid transparent",s.style.borderLeftWidth="8px",s.style.borderLeftStyle="solid",""!==e&&(s.style.borderLeftColor="".concat(e)),r.appendChild(s);var a=8-o,l=document.createElement("div");return(0,i.vP)(l,"divotBackground"),l.style.position="absolute",l.style.top="".concat(o,"px"),l.style.right="-".concat(a,"px"),l.style.borderTop="".concat(a,"px solid transparent"),l.style.borderBottom="".concat(a,"px solid transparent"),l.style.borderLeftWidth="".concat(a,"px"),l.style.borderLeftStyle="solid",""!==t&&(l.style.borderLeftColor="".concat(t)),s.appendChild(l),r}},191:function(e,t,n){"use strict";n.d(t,{T:function(){return u}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(7397),c=n(4793);var u=function(e){(0,r.Z)(d,e);var t,n,u=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function d(){return(0,i.Z)(this,d),u.call(this)}return(0,o.Z)(d,[{key:"initListeners",value:function(){var e=this;l.Ql.listen((function(t){t.isOpen&&e.dontNotify.add(t.username)})),c.QN.listen((function(){e.dontNotify.clear()}))}}]),d}(n(2648).f)},5392:function(e,t,n){"use strict";n.d(t,{T:function(){return s},w:function(){return r}});var i=n(8759),o=n(7693),r={enabled:!1,move:function(e,t){},end:function(){}};function s(e,t){a(e,t,(function(e){var t=e;return{valid:!0,x:t.clientX,y:t.clientY}}),"mousedown","mousemove","mouseup"),a(e,t,(function(e){var t=e;if(1===t.touches.length){var n=t.touches.item(0);if(null!==n)return{valid:!0,x:n.clientX,y:n.clientY}}return{valid:!1,x:0,y:0}}),"touchstart","touchmove","touchend")}function a(e,t,n,r,s,a){(0,o.j9)(r,e,(function(e){var r=n(e);if(r.valid){var l=t(e,r.x,r.y);if(l.enabled){l.move(r.x,r.y),e.preventDefault();var c=function(e){var t=n(e);t.valid&&l.move(t.x,t.y)},u=function(e){e.preventDefault(),void 0!==e.buttons&&function(e){return(0,i.NP)()?0===e.buttons:1===e.buttons}(e)||void 0!==e.touches&&1===e.touches.length?c(e):d(e,!1)};(0,o.j9)(s,document,u,!0);var d=function e(t){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&c(t),(0,o.SC)(s,document,u,!0),(0,o.SC)(a,document,e,!0),l.end()};(0,o.j9)(a,document,d,!0)}}}))}},7191:function(e,t,n){"use strict";n.d(t,{Ku:function(){return p},cJ:function(){return g}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(8759),u=n(7693),d=n(7585),h=n(1794);var f,p=function(e){(0,s.Z)(d,e);var t,n,c=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function d(e,t){var n,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(0,i.Z)(this,d),(n=c.call(this,e)).toggleElement=t,n.toggleEvent=new h.xB("dropDownToggled",{reportIfNoListeners:!1}),void 0!==t&&((0,u.j9)("click",t,(function(e){e.metaKey||e.ctrlKey||n.toggleOverlay(e)}),!1),(0,u.j9)("keydown",t,(function(e){32!==e.keyCode&&"Space"!==e.code||(e.preventDefault(),n.toggleOverlay(e))})),t.classList.add("dropdown-anchor")),n.autoHide(o),n}return(0,o.Z)(d,[{key:"initUI",value:function(e){(0,r.Z)((0,l.Z)(d.prototype),"initUI",this).call(this,e),this.element.style.overflow="visible",this.element.style.position="absolute",this.element.style.top="0",this.element.style.left="0",this.element.style.right="auto",this.element.style.bottom="auto",this.element.style.width="",this.element.style.height="",this.element.style.display="none",this.element.style.zIndex="4",this.element.classList.add("dropdown")}},{key:"showElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"block",t=arguments.length>1?arguments[1]:void 0;return!this.isShown()&&(this.element.style.display=e,this.toggleEvent.fire(new g(!0,t)),this.isShown())}},{key:"hideElement",value:function(e){var t=this;return!(void 0!==e&&e.composedPath().some((function(e){return e instanceof Element&&t.element.contains(e)&&e.matches(".dropdown-anchor")}))||!this.isShown()||(this.element.style.display="none",this.toggleEvent.fire(new g(!1,e)),this.isShown()))}},{key:"toggleOverlay",value:function(e){return this.isShown()?!this.hideElement(e):this.showElement(void 0,e)}},{key:"autoHide",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.documentClickListener=m.listen((function(n){!(e.isShown()&&n.target instanceof Element)||t&&e.element.contains(n.target)||void 0!==e.toggleElement&&e.toggleElement.contains(n.target)||e.hideElement(n)}))}},{key:"dispose",value:function(){this.documentClickListener.removeListener()}}]),d}(d.I),m=new h.xB("documentClick"),v=!1;(0,u.j9)("touchmove",document,(function(){v=!0})),(0,u.j9)("touchstart",document,(function(){v=!1})),(0,u.j9)("click",document,(function(e){m.fire(e),void 0!==f&&(clearTimeout(f),f=void 0)})),((0,c._1)()||(0,c.sg)())&&(0,u.j9)("touchend",document,(function(e){v||(f=window.setTimeout((function(){f=void 0,m.fire(e)}),200))}),!1);var g=(0,o.Z)((function e(t,n){(0,i.Z)(this,e),this.isShowing=t,this.event=n}))},2600:function(e,t,n){"use strict";n.d(t,{Ar:function(){return m},H4:function(){return p},IA:function(){return y},L0:function(){return h},wT:function(){return g},wl:function(){return v},xJ:function(){return f}});var i,o=n(5809),r=n(3753),s=n(391);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var l=[],c=18,u="emojiRecents",d="|";function h(e){var t=e.match(/[^\uD800-\uDFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDFFF]/g);return null!==t?t:[]}function f(e){if(twemoji.test(e)){var t,n=-1,i="",o="",r=0,s=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw r}}}}(h(e));try{for(s.s();!(t=s.n()).done;){var l=t.value;-1===n&&twemoji.test(l)?(n=r,i=l,o=l):-1!==n&&(o="".concat(o).concat(l),twemoji.test(l)&&p(twemoji.parse(o))&&(i=o)),r+=l.length}}catch(e){s.e(e)}finally{s.f()}return-1!==n?{emojiStart:n,emojiChars:i}:void 0}}function p(e){var t=e.match(/<img/g);return null!==t&&1===t.length}function m(e){for(var t=0;t<l.length;t+=1)l[t].name===e.name&&l.splice(t,1);l.length===c&&l.pop(),l.unshift(e);var n=l.map((function(e){return JSON.stringify({value:e.value,name:e.name})})).join(d);return window.localStorage.setItem(u,n),l}function v(){var e=new Promise((function(e){var t=window.localStorage.getItem(u);e(null!==t?t.split(d).map((function(e){var t=JSON.parse(e);return{value:t.value,name:t.name}})):[])})),t=(0,r.Ue)("api/ts/emoticons/search_emojis/");i=Promise.all([e,t]).then((function(e){var t=(0,o.Z)(e,2),n=t[0],i=t[1];return[l=n,new s.j(i.responseText)]}))}function g(e){return void 0===i&&v(),void 0!==i?i.then((function(t){var n=(0,o.Z)(t,2),i=n[0],r=n[1];if("recent"===e)return i;if("smileys-people"===e){var s=r.getAny("smileys-emotion"),a=r.getAny("people-body");return b(s.concat(a))}return b(r.getAny(e))})):Promise.reject()}function y(e){return(0,r.Ue)("api/ts/emoticons/search_emojis/?keywords=".concat(encodeURIComponent(e))).then((function(e){for(var t=new s.j(e.responseText),n=[],i=0,o=[t.getAny("smileys-emotion"),t.getAny("people-body"),t.getAny("animals-nature"),t.getAny("food-drink"),t.getAny("activities"),t.getAny("travel-places"),t.getAny("objects"),t.getAny("symbols"),t.getAny("flags")];i<o.length;i++){var r=o[i];void 0!==r&&n.push(b(r))}return n.reduce((function(e,t){return e.concat(t)}))})).catch((function(){return[]}))}function b(e){return e.map((function(e){return{value:e.character,name:e.name}}))}},1910:function(e,t,n){"use strict";n.d(t,{A:function(){return S},i:function(){return T}});var i,o=n(2951),r=n(1976),s=n(3243),a=n(7591),l=n(9492),c=n(7597),u=n(8759),d=n(1185),h=n(7693),f=n(391),p=n(3423),m=n(4793),v=n(9447),g=n(1794),y=n(5406),b=n(2923),w=n(2974);function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var k=new g.xB("hideEmoticons",{listenersWarningThreshold:function(){return 10+g.q6}});w.S.changeVideoMode.listen((function(){k.fire(void 0)}));var S=function(e){(0,a.Z)(n,e);var t=x(n);function n(){var e;return(0,o.Z)(this,n),(e=t.apply(this,arguments)).maxOptionLength=36,e}return(0,r.Z)(n,[{key:"initData",value:function(){(0,s.Z)((0,c.Z)(n.prototype),"initData",this).call(this),this.previewWrapper=document.createElement("div"),this.previewImage=document.createElement("img"),this.viewReportLink=document.createElement("div"),this.regex=/(^|.*\s):([\w-]+)$/}},{key:"initUI",value:function(){var e=this;(0,d.vP)(this.previewWrapper,"previewWrapper"),this.previewWrapper.style.display="none",this.previewWrapper.style.width="260px",this.previewWrapper.style.height="110px",this.previewWrapper.style.lineHeight="110px",this.previewWrapper.style.borderBottomWidth="1px",this.previewWrapper.style.borderBottomStyle="solid",this.previewWrapper.style.textAlign="center",this.previewWrapper.onclick=function(){void 0!==e.selectedIndex&&e.showPreview(e.items[e.selectedIndex])},this.element.appendChild(this.previewWrapper),(0,s.Z)((0,c.Z)(n.prototype),"initUI",this).call(this),this.previewImage.src="".concat(STATIC_URL,"loading.png"),this.previewImage.style.maxWidth="240px",this.previewImage.style.maxHeight="80px",this.previewImage.style.verticalAlign="middle",this.previewImage.style.padding="10px 10px 16px 10px",this.previewWrapper.appendChild(this.previewImage),(0,d.vP)(this.viewReportLink,d.ql.hrefColor),this.viewReportLink.innerText="VIEW / REPORT EMOTICON",this.viewReportLink.style.fontSize="10px",this.viewReportLink.style.position="relative",this.viewReportLink.style.bottom="8px",this.viewReportLink.style.lineHeight="0",this.viewReportLink.onmouseenter=function(){e.viewReportLink.style.textDecoration="underline"},this.viewReportLink.onmouseleave=function(){e.viewReportLink.style.textDecoration="none"},this.previewWrapper.appendChild(this.viewReportLink),m.kN.listen((function(e){i=e.dossier.ignoredEmoticons})).addTo(this.listenerGroup),k.listen((function(){void 0!==e.overlay&&e.hide()})).addTo(this.listenerGroup)}},{key:"handleKeyup",value:function(e){this.handleInputChange(e),this.repositionChildren()}},{key:"getDataEndpoint",value:function(){return"https://emote.highwebmedia.com/autocomplete?slug=".concat(this.prefix,"&_=").concat(Date.now())}},{key:"clearList",value:function(){(0,s.Z)((0,c.Z)(n.prototype),"clearList",this).call(this),this.previewWrapper.style.display="none"}},{key:"highlightSelectedIndex",value:function(e){(0,s.Z)((0,c.Z)(n.prototype),"highlightSelectedIndex",this).call(this,e),void 0!==this.selectedIndex&&(this.previewImage.src="".concat(STATIC_URL,"loading.png"),this.previewImage.src=this.items[this.selectedIndex].url,this.previewWrapper.style.display="block")}},{key:"parseResponse",value:function(e){var t,n=this,i=new f.j(e),o=[],r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}((i.getString("slug"),i.getObject("emoticons")));try{for(r.s();!(t=r.n()).done;){var s=t.value;o.push({slug:s.slug,url:s.url,element:I,score:s.score})}}catch(e){r.e(e)}finally{r.f()}return o=(o=o.map((function(e){var t=void 0===e.score?0:e.score;return e.slug===n.prefix?e.score=t+1e5:0===e.slug.indexOf(n.prefix)&&(e.score=t+9e3),e}))).sort((function(e,t){return(void 0===e.score?0:e.score)-(void 0===t.score?0:t.score)})),i.logUnusedDebugging("parseEmoticonAutocompleteResponse"),o}},{key:"shouldIgnoreItem",value:function(e){return i.indexOf(e.slug)>=0}},{key:"showPreview",value:function(e){v.gi.fire(e)}}]),n}(p.e),T=function(e){(0,a.Z)(n,e);var t=x(n);function n(e){var i;return(0,o.Z)(this,n),(i=t.call(this,{inputElement:e,leftOffset:0,rightOffset:0})).scrolling=!1,i.savedValue="",(0,h.j9)("touchstart",i.element,(function(){i.scrolling=!1,i.config.inputElement.setCurrentNodeText(i.config.inputElement.getCurrentNodeText())})),(0,u.Tt)()||((0,h.j9)("keydown",i.config.inputElement.element,(function(e){i.visible&&(i.savedValue=i.config.inputElement.getCurrentNodeText())})),(0,h.j9)("keyup",i.config.inputElement.element,(function(e){var t=i.config.inputElement.getCurrentNodeText();""!==i.savedValue&&" "===t[t.length-1]&&(i.config.inputElement.setCurrentNodeText("".concat(i.savedValue," ")),i.hide()),i.savedValue=""}),!0)),i.overlayClick.listen((function(){i.config.inputElement.focus(),i.config.inputElement.setCaretToEnd()})),y.w.listen((function(e){i.hide(),v.Gm.fire(void 0)})).addTo(i.listenerGroup),i}return(0,r.Z)(n,[{key:"initUI",value:function(){var e=this;(0,s.Z)((0,c.Z)(n.prototype),"initUI",this).call(this),this.element.style.border="",this.element.style.fontSize="14px",this.element.style.lineHeight="26px",this.element.style.boxShadow="0px 0px 8px rgba(0, 0, 0, 0.32)",this.element.style.marginLeft="7px",this.element.style.boxSizing="content-box",this.previewWrapper.style.width="",this.list.style.width="",(0,b.q)(this.list,!0),this.list.onscroll=function(){e.scrolling=!0}}},{key:"repositionChildren",value:function(){}},{key:"showPreview",value:function(e){var t=this;(0,s.Z)((0,c.Z)(n.prototype),"showPreview",this).call(this,e),this.config.inputElement.blur(),v.$N.once((function(){t.isVisible()&&(t.config.inputElement.focus(),t.previewImage.src=t.previewImage.src)}),!1)}},{key:"appendItem",value:function(e,t){var i=this,o=(0,s.Z)((0,c.Z)(n.prototype),"appendItem",this).call(this,e,t);return o.ontouchend=function(e){i.scrolling||(i.pickItem(t,!1),e.preventDefault())},o}},{key:"isSpecialFunctionKey",value:function(e){var t=this.config.inputElement.getCurrentNodeText();return(0,s.Z)((0,c.Z)(n.prototype),"isSpecialFunctionKey",this).call(this,e)||this.visible&&" "===t[t.length-1]}},{key:"show",value:function(){this.element.style.width="".concat(this.config.inputElement.element.offsetWidth,"px"),(0,s.Z)((0,c.Z)(n.prototype),"show",this).call(this)}}]),n}(S),I=document.createElement("div")},9447:function(e,t,n){"use strict";n.d(t,{$N:function(){return w},Gm:function(){return b},cv:function(){return C},gi:function(){return y},nz:function(){return x}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(1185),u=n(7693),d=n(3753),h=n(4793),f=n(1794),p=n(9874);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var g=[];h.kN.listen((function(e){g=e.dossier.ignoredEmoticons}));var y=new f.xB("openEmoticonPreview"),b=new f.xB("closeEmoticonPreview"),w=new f.xB("emoticonPreviewClosed"),C=function(e){(0,s.Z)(n,e);var t=v(n);function n(){var e;(0,i.Z)(this,n),e=t.call(this),(0,c.vP)(e.element,"emoticonPreviewModal"),e.element.style.position="fixed",e.element.style.width="auto",e.element.style.height="auto",e.element.style.left="50%",e.element.style.top="50%",e.element.style.transform="translate(-50%, -50%)",e.element.style.borderRadius="6px",e.element.style.padding="10px",e.element.style.fontSize="12px",e.element.style.fontFamily="UbuntuRegular, Helvetica, Arial, sans-serif",e.element.style.zIndex="1003",e.element.style.textAlign="center",e.element.style.boxShadow="0 0 18px rgba(0, 0, 0, 0.4)",e.overlay.style.backgroundColor="#000000",e.overlay.style.opacity="0.4",e.overlay.style.zIndex="1003";var o=document.createElement("div");(0,c.vP)(o,"closeButton"),o.style.display="inline-block",o.style.position="absolute",o.style.width="10px",o.style.height="10px",o.style.top="9px",o.style.right="9px",o.style.cursor="pointer",o.style.opacity="1",o.onclick=function(){e.hide()},o.onmouseenter=function(){o.style.opacity="1"},o.onmouseleave=function(){o.style.opacity="0.5"},e.element.appendChild(o),e.previewImage=document.createElement("img"),e.previewImage.style.verticalAlign="middle",e.previewImage.style.padding="10px",e.previewImage.style.maxHeight="75vh",e.previewImage.style.maxWidth="75vw",(0,u.j9)("load",e.previewImage,(function(){e.previewImage.style.visibility="visible",e.repositionChildren()})),e.element.appendChild(e.previewImage),e.reportLink=document.createElement("div"),(0,c.vP)(e.reportLink,c.ql.hrefColor),e.reportLink.innerText="REPORT EMOTICON",e.reportLink.style.cursor="pointer",e.reportLink.onclick=function(){e.reportLink.style.display="none",e.reportWrapper.style.display="block",e.repositionChildren()},e.reportLink.onmouseenter=function(){e.reportLink.style.textDecoration="underline"},e.reportLink.onmouseleave=function(){e.reportLink.style.textDecoration="none"},e.element.appendChild(e.reportLink),e.reportWrapper=document.createElement("div"),e.reportWrapper.style.display="none",e.element.appendChild(e.reportWrapper);var r=document.createElement("span");r.innerText="Choose a category:",r.style.marginRight="6px",e.reportWrapper.appendChild(r);var s=document.createElement("select");(0,c.vP)(s,"categorySelect"),s.style.borderRadius="4px",s.style.marginBottom="2px";var a,l=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(k);try{for(l.s();!(a=l.n()).done;){var h=a.value,f=document.createElement("option");f.innerText=h.label,f.value=h.value,s.appendChild(f)}}catch(e){l.e(e)}finally{l.f()}e.reportWrapper.appendChild(s);var p=document.createElement("span");p.style.display="inline-block";var v=document.createElement("span");(0,c.vP)(v,"cancelButton"),v.innerText="CANCEL",v.style.fontFamily="UbuntuMedium, Helvetica, Arial, sans-serif",v.style.fontSize="12px",v.style.padding="2px 6px",v.style.borderRadius="4px",v.style.boxSizing="border-box",v.style.cursor="pointer",v.style.display="inline-block",v.style.marginLeft="6px",v.onclick=function(){e.reportLink.style.display="block",e.reportWrapper.style.display="none",e.repositionChildren()},p.appendChild(v);var y=document.createElement("span");(0,c.vP)(y,"reportButton"),y.innerText="REPORT",y.style.fontFamily="UbuntuMedium, Helvetica, Arial, sans-serif",y.style.fontSize="12px",y.style.padding="2px 6px",y.style.borderRadius="4px",y.style.boxSizing="border-box",y.style.cursor="pointer",y.style.display="inline-block",y.style.marginLeft="6px",y.onclick=function(){var t="emoticon_report_abuse/".concat(e.emoticon.slug,"/");(0,d.I5)(t,{category:s.value}).then((function(t){g.push(e.emoticon.slug),e.reportWrapper.style.display="none",e.undoWrapper.style.display="block",e.repositionChildren()})).catch((function(e){error("Error reporting emoticon",e)}))},p.appendChild(y),e.reportWrapper.appendChild(p),e.undoWrapper=document.createElement("div"),e.undoWrapper.style.display="none",e.element.appendChild(e.undoWrapper);var w=document.createElement("span");w.innerText="EMOTICON REPORTED - ",e.undoWrapper.appendChild(w);var C=document.createElement("span");return(0,c.vP)(C,c.ql.hrefColor),C.innerText="UNDO",C.style.cursor="pointer",C.onclick=function(){var t="emoticon_report_abuse/".concat(e.emoticon.slug,"/");(0,d.I5)(t,{category:s.value}).then((function(t){var n=g.indexOf(e.emoticon.slug,0);n>=0&&g.splice(n,1),e.undoWrapper.style.display="none",e.reportLink.style.display="block",e.repositionChildren()})).catch((function(e){error("Error reporting emoticon",e)}))},C.onmouseenter=function(){C.style.textDecoration="underline"},C.onmouseleave=function(){C.style.textDecoration="none"},e.undoWrapper.appendChild(C),e.overlayClick.listen((function(){e.hide()})),b.listen((function(){e.hide()})),e}return(0,o.Z)(n,[{key:"initAndShow",value:function(e){this.emoticon=e,this.previewImage.style.visibility="hidden",this.previewImage.src=this.emoticon.url,this.reportLink.style.display="none",this.reportWrapper.style.display="none",this.undoWrapper.style.display="none",g.indexOf(e.slug)>=0?this.undoWrapper.style.display="block":this.reportLink.style.display="block",(0,r.Z)((0,l.Z)(n.prototype),"show",this).call(this),this.removeDocumentFocus(),this.repositionChildren()}},{key:"hide",value:function(){(0,r.Z)((0,l.Z)(n.prototype),"hide",this).call(this),w.fire(void 0)}},{key:"show",value:function(){(0,r.Z)((0,l.Z)(n.prototype),"show",this).call(this),this.element.style.visibility="",this.repositionChildren()}},{key:"removeDocumentFocus",value:function(){null!==document.activeElement&&document.activeElement.blur()}}]),n}(p.z),x=function(e){(0,s.Z)(n,e);var t=v(n);function n(){var e;return(0,i.Z)(this,n),(e=t.call(this)).previewImage.style.maxWidth="calc(100vw - 64px)",e.reportWrapper.style.width="300px",e.reportWrapper.style.margin="auto",e}return(0,o.Z)(n)}(C),k=[{label:"Just ignore this emoticon",value:"ignore"},{label:"Offensive",value:"offensive"},{label:"Disgusting",value:"disgusting"},{label:"Fake Tip",value:"fake_tip"},{label:"Advertising",value:"advertising"}]},1794:function(e,t,n){"use strict";n.d(t,{G7:function(){return h},de:function(){return d},mM:function(){return m},q6:function(){return u},xB:function(){return p}});var i=n(126),o=n(1976),r=n(2951),s=n(9);function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var c=(0,o.Z)((function e(){(0,r.Z)(this,e),this.reportIfNoListeners=!0,this.maxHistorySize=10,this.listenersWarningThreshold=50})),u=0;function d(){u+=1}function h(){u-=1}var f=function(){function e(t,n){(0,r.Z)(this,e),this.router=t,this.listener=n}return(0,o.Z)(e,[{key:"removeListener",value:function(){this.router.removeListener(this.listener)}},{key:"addTo",value:function(e){e.add(this)}}]),e}(),p=function(){function e(t,n){(0,r.Z)(this,e),this.eventName=t,this.listeners=[],this.history=[],this.counter=0,this.listenersMap=new Map,this.options=Object.assign(new c,n),this.idFieldName="_eventRouter".concat(this.eventName,"Id")}return(0,o.Z)(e,[{key:"listen",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.listeners.push(e),t){var i,o=a(this.history);try{for(o.s();!(i=o.n()).done;)e(i.value)}catch(e){o.e(e)}finally{o.f()}}else n&&this.history.length>0&&e(this.history[this.history.length-1]);return this.warnTooManyListeners(),void 0!==this.options.onListenerAdded&&this.options.onListenerAdded(this.listeners.length),new f(this,e)}},{key:"warnTooManyListeners",value:function(){var e=this.getListenersWarningThreshold();-1!==e&&this.size()>e&&warn("EventRouter has too many listeners",{event:this.eventName,listeners:this.size(),"max-listeners":e})}},{key:"addListener",value:function(t,n){var i=this;if(!n.hasOwnProperty(this.idFieldName)){this.counter+=1;var o=this.counter;Object.defineProperty(n,this.idFieldName,{get:function(){return o}})}var r=n[this.idFieldName];this.listenersMap.set(r,[n,t]),window.setTimeout((function(){if(!e.isElementConnected(n)){var t=(n instanceof s.w?n.element:n).outerHTML;warn('addListener for EventRouter "'.concat(i.eventName,'" is called on a listeningSource which is not attached to the DOM.\n                    This can result in the listener not being registered. Make sure the element is attached in the same thread as calling addListener.'),{listeningSource:t})}})),void 0!==this.listenersCleanUpTimeout&&window.clearTimeout(this.listenersCleanUpTimeout),this.listenersCleanUpTimeout=window.setTimeout((function(){i.cleanUpRemovedElements(),i.warnTooManyListeners()}),100)}},{key:"cleanUpRemovedElements",value:function(){var t=Math.max(1,Math.floor(this.getListenersWarningThreshold()/2));if(this.listenersMap.size>t){var n,i=a(this.listenersMap.values());try{for(i.s();!(n=i.n()).done;){var o=n.value;e.isElementConnected(o[0])||this.listenersMap.delete(o[0][this.idFieldName])}}catch(e){i.e(e)}finally{i.f()}}}},{key:"once",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.listen((function n(i){e(i),t.removeListener(n)}),!1,n)}},{key:"fire",value:function(t){var n=this;this.history.push(t)>this.options.maxHistorySize&&this.history.shift(),0===this.listeners.length&&0===this.listenersMap.size&&this.options.reportIfNoListeners&&debug("No listeners for event: ".concat(this.eventName));for(var o=0,r=(0,i.Z)(this.listeners);o<r.length;o++){var s=r[o];this.callListener(s,t)}var l,c=a(this.listenersMap.values());try{var u=function(){var i=l.value,o=i[0],r=i[1];e.isElementConnected(o)?n.callListener(r,t):window.setTimeout((function(){e.isElementConnected(o)?n.callListener(r,t):n.listenersMap.delete(o[n.idFieldName])}))};for(c.s();!(l=c.n()).done;)u()}catch(e){c.e(e)}finally{c.f()}}},{key:"callListener",value:function(e,t){try{e(t)}catch(t){error("Event listener error",{reason:t.toString(),event_name:this.eventName,event_listeners:this.size(),listener:e,error_stack:t.stack})}}},{key:"size",value:function(){return this.listeners.length+this.listenersMap.size}},{key:"removeListener",value:function(e){var t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1),void 0!==this.options.onListenerRemoved&&this.options.onListenerRemoved(this.listeners.length)}},{key:"listenerCount",value:function(){return this.listeners.length}},{key:"getListenersWarningThreshold",value:function(){return"number"==typeof this.options.listenersWarningThreshold?this.options.listenersWarningThreshold:this.options.listenersWarningThreshold()}}],[{key:"isElementConnected",value:function(e){return e instanceof HTMLElement&&e.isConnected||e instanceof s.w&&e.element.isConnected}}]),e}(),m=function(){function e(){(0,r.Z)(this,e),this.boundListeners=[]}return(0,o.Z)(e,[{key:"add",value:function(e){this.boundListeners.push(e)}},{key:"removeAll",value:function(){var e,t=a(this.boundListeners);try{for(t.s();!(e=t.n()).done;)e.value.removeListener()}catch(e){t.e(e)}finally{t.f()}this.boundListeners=[]}}]),e}()},6921:function(e,t,n){"use strict";n.d(t,{HK:function(){return c},aZ:function(){return r},hc:function(){return a},r$:function(){return s},si:function(){return o}});var i=n(7693);function o(e){return"ArrowUp"===e.key||38===e.keyCode}function r(e){return"ArrowDown"===e.key||40===e.keyCode}function s(e){return"Enter"===e.key||13===e.keyCode}function a(e){return void 0===e.which||"number"==typeof e.which&&e.which>0&&!e.ctrlKey&&!e.metaKey&&!e.altKey}function l(e){null==e||e.preventDefault(),null==e||e.stopImmediatePropagation()}function c(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3,o=!1,r=function r(){o||((0,i.SC)("click",e,l,!0),(0,i.SC)("pageshow",window,r),c(e,t,n),o=!0)};return(0,i.w$)("click",e,(function(o){t&&(o.ctrlKey||o.metaKey||o.shiftKey)?c(e,t,n):((0,i.j9)("click",e,l,!0),n>0&&window.setTimeout(r,n),(0,i.j9)("pageshow",window,r))})),e}},4801:function(e,t,n){"use strict";n.d(t,{BJ:function(){return d},KS:function(){return c},NZ:function(){return f}});var i=n(2951),o=n(1976),r=n(3705);function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw r}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var l={},c=function(){function e(t){(0,i.Z)(this,e),this.active=!1,this.eligible=!1,this.name=t;var n=window.experiments;if(void 0!==n){var o=new RegExp("\\b".concat(t,"\\b")),r=n.active;this.active=void 0!==r&&o.test(r);var s=n.eligible;this.eligible=void 0!==s&&o.test(s)}}return(0,o.Z)(e,[{key:"record",value:function(){if(this.eligible&&!l[this.name]){var e={experimentName:this.name,experimentGroup:this.active?"active":"inactive",experimentTreatment:this.active?this.name:"control"};(0,r.fg)("ExperimentEntered",e,!0),l[this.name]=!0}}}]),e}(),u={},d=function(){function e(t,n){(0,i.Z)(this,e),this.namespace=n,this.active=!1,this.eligible=!1;var o=window.experiments;if(void 0!==o){var r=o.active,a=o.eligible;if(void 0!==a){var l,c=s(t);try{for(c.s();!(l=c.n()).done;){var u=l.value;if(new RegExp("\\b".concat(u,"\\b")).test(a)){this.eligible=!0;break}}}catch(e){c.e(e)}finally{c.f()}if(this.eligible&&void 0!==r){var d,h=s(t);try{for(h.s();!(d=h.n()).done;){var f=d.value;if(new RegExp("\\b".concat(f,"\\b")).test(r)){this.active=!0,this.activeSide=f;break}}}catch(e){h.e(e)}finally{h.f()}}}}}return(0,o.Z)(e,[{key:"isControlGroup",value:function(){return this.eligible&&!this.active}},{key:"record",value:function(){if(this.eligible&&!u[this.namespace]){var e={experimentName:this.namespace,experimentGroup:this.active?"active":"inactive",experimentTreatment:this.active?this.activeSide:"control"};(0,r.fg)("ExperimentEntered",e,!0),u[this.namespace]=!0}}}]),e}(),h={};function f(e){return void 0===h[e]&&(h[e]=new c(e).active),h[e]}},1282:function(e,t,n){"use strict";function i(e){return new RegExp("\\b".concat(e,"\\b")).test(window.active_feature_flags)}n.d(t,{L:function(){return i}})},8821:function(e,t,n){"use strict";n.d(t,{$:function(){return o},D:function(){return r}});var i=n(1282),o=function(){return(0,i.L)("MobileEmphasizedInput")},r=function(){return(0,i.L)("TpMnuTb")}},27:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var i,o=n(3753),r=n(391);function s(e){var t=void 0===i||""===i?e:i;return new Promise((function(n,i){(0,o.Ue)("api/ts/accounts/usermenu/".concat(e,"/").concat(t,"/")).then((function(e){n(function(e){var t=new r.j(e),n=t.getBoolean("online"),i=t.getString("username"),o=t.getNumber("display_age",!1),s=t.getString("gender"),a=t.getString("image_url"),l=t.getBoolean("can_silence"),c=t.getNumberOrUndefined("silence_id"),u=t.getBoolean("can_access"),d=t.getBoolean("needs_supporter_to_pm");return t.logUnusedDebugging("fetchUserMenuData.parseMenuDataRes"),{username:i,displayAge:o,gender:s,imageUrl:a,online:n,canSilence:l,canAccess:u,needsSupporterToPm:d,silenceId:c}}(e.responseText))})).catch((function(e){i(e)}))}))}n(4793).kN.listen((function(e){i=e.chatConnection.room()}))},5108:function(e,t,n){"use strict";n.d(t,{$:function(){return c},S:function(){return l}});var i=n(7591),o=n(9492),r=n(7597),s=n(2951),a=n(1976);var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;(0,s.Z)(this,e),this.filterAfterSize=t,this.cacheTTL=n,this.cache=new Map}return(0,a.Z)(e,[{key:"getShortenedPrefix",value:function(e){return void 0===this.filterAfterSize||e.length>this.filterAfterSize?e.substring(0,this.filterAfterSize):e}},{key:"get",value:function(e){var t=this.getShortenedPrefix(e),n=this.cache.get(t);return t===e?n:null==n?void 0:n.filter((function(t){return t.slug.startsWith(e)}))}},{key:"set",value:function(e,t){var n=this;(void 0===this.filterAfterSize||e.length<=this.filterAfterSize)&&(this.cache.set(e,t),-1!==this.cacheTTL&&window.setTimeout((function(){return n.cache.delete(e)}),this.cacheTTL))}}]),e}(),c=function(e){(0,i.Z)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,r.Z)(t);if(n){var s=(0,r.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,o.Z)(this,e)});function c(){return(0,s.Z)(this,c),l.apply(this,arguments)}return(0,a.Z)(c,[{key:"get",value:function(e){var t=this.getShortenedPrefix(e),n=this.cache.get(t);return t===e?n:null==n?void 0:n.filter((function(t){return t.slug.toLowerCase().startsWith(e)}))}}]),c}(l)},9598:function(e,t,n){"use strict";n.d(t,{IT:function(){return d},Wl:function(){return u},c5:function(){return g},kr:function(){return v},og:function(){return m},tU:function(){return h},w5:function(){return y},wk:function(){return c}});var i=n(3753),o=n(391),r=n(695),s=n(1794),a=n(928),l=n(3543),c=new s.xB("followingEvent"),u=["follow_new","follow_text","follow_photo"];function d(e,t,n){return(0,i.I5)("api/ts/follow/notifications/".concat(e),{notification_frequency:t}).then((function(){return n.fire({roomName:e,following:!0,followNotificationFrequency:t}),!0})).catch((function(t){return error("Unable to update follow notification settings",{room:e,reason:t.toString()}),!1}))}function h(){return(0,i.Ue)("api/ts/follow/email_notifications/").then((function(e){var t=new o.j(e.responseText);return{activated:t.getBoolean("activated"),email:void 0!==t.getStringOrUndefined("email")?t.getStringOrUndefined("email"):"",validated:t.getBoolean("validated")}})).catch((function(e){return error("Error checking if follow email notifications are turned on",e),!1}))}var f="email_field";function p(e,t,n){var r=void 0!==n?n.email:void 0,s=void 0!==n?n.validated:void 0;return new Promise((function(n,a){var c={activate:"".concat(e)};return void 0!==t&&""!==t&&(c[f]=t),(0,i.I5)("api/ts/follow/email_notifications/",c).then((function(){n("".concat(!(void 0!==t&&""!==t&&r===t&&void 0!==s&&s)&&void 0!==t))})).catch((function(e){a(function(e){var t=new o.j(e.xhr.responseText).getString("error");if(t.indexOf(f)>-1){var n=new o.j(t).getList(f);if(void 0!==n&&n.length>0)return n[0].getString("message")}return l.ag.emailSubmitErrorMessage}(e))}))}))}function m(e,t){return void 0!==t&&""!==t?h().then((function(n){return t===n.email&&e===n.activated?new Promise((function(e,o){if(!n.validated)return(0,i.I5)("emailvalidation/resend/",{}).then((function(){e("true")})).catch((function(){o("Error resending verification email to ".concat(t))}));e("false")})):p(e,t,n)})).catch((function(){return p(e,t)})):p(e)}function v(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"FollowStar";if(void 0!==n&&!n||!(0,r.Cg)(l.ag.loginToFollow,void 0,void 0,!0))return(0,i.I5)("follow/follow/".concat(e,"/"),{location:s}).then((function(n){var i=new o.j(n.responseText);return t.fire({roomName:e,following:!0,followNotificationFrequency:(0,a.cT)(i.getString("notification_frequency")),onlineCount:i.getNumberOrUndefined("online_count"),totalCount:i.getNumberOrUndefined("total_count")}),void 0!==window._followedTabUpdate&&window._followedTabUpdate(e),!0})).catch((function(t){return error("Unable to follow",{roomName:e,reason:t.toString()}),!1}))}function g(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"FollowStar";if(void 0!==n&&!n||!(0,r.Cg)(l.ag.loginToFollow,void 0,void 0,!0))return(0,i.I5)("follow/unfollow/".concat(e,"/"),{location:s}).then((function(n){var i=new o.j(n.responseText);return t.fire({roomName:e,following:!1,followNotificationFrequency:"none",onlineCount:i.getNumberOrUndefined("online_count"),totalCount:i.getNumberOrUndefined("total_count")}),void 0!==window._followedTabUpdate&&window._followedTabUpdate(e),!0})).catch((function(t){return error("Unable to unfollow",{roomName:e,reason:t.toString()}),!1}))}function y(e){return(0,i.Ue)("follow/follow_allowed/".concat(e,"/")).then((function(e){return new o.j(e.responseText).getBoolean("can_follow")})).catch((function(e){return error("Error checking if user following is allowed",e),!1}))}},4842:function(e,t,n){"use strict";n.d(t,{R:function(){return m}});var i=n(2951),o=n(1976),r=n(2800),s=n(7212),a=n(8016),l=n(1006),c=n(6402),u=n(407),d=n(4406),h=n(4793),f=n(8263),p=n(3543),m=function(){function e(){var t=this;if((0,i.Z)(this,e),this.followers=new Set,r.J.current.isBroadcast){var n,o,c=null!==(n=null===(o=r.J.current.loggedInUser)||void 0===o?void 0:o.userUid)&&void 0!==n?n:"";new a.OC(c).onMessage.listen((function(e){var n;e.followerUsername!==(null===(n=r.J.current.loggedInUser)||void 0===n?void 0:n.username)&&(e.isFollowing?t.addFollower(e.followerUsername):t.removeFollower(e.followerUsername))})),h.kN.listen((function(e){window.setTimeout((function(){l._B.getInstance().fetchRoomUsers().then((function(e){e.roomUsers.forEach((function(e){!0===e.isFollowing&&t.addFollower(e.username)}))})).catch(void 0)}),5e3),e.chatConnection.event.roomMessage.listen((function(e){!0===e.fromUser.isFollowing&&t.addFollower(e.fromUser.username)})),e.chatConnection.event.tipAlert.listen((function(e){!0===e.fromUser.isFollowing&&t.addFollower(e.fromUser.username)})),new s.rc(e.dossier.roomUid).onMessage.listen((function(e){!0===e.user.isFollowing&&t.addFollower(e.user.username)}))})),d.x.registerGenerator("followerBadge",(function(e){return t.createChatBadge(e)}))}}return(0,o.Z)(e,[{key:"hasFollower",value:function(e){return this.followers.has(e)}},{key:"addFollower",value:function(e){this.followers.has(e)||(this.followers.add(e),this.updateChatBadges(e))}},{key:"removeFollower",value:function(e){this.followers.delete(e),this.updateChatBadges(e)}},{key:"shouldShowBadge",value:function(e){return this.followers.has(e)&&e!==r.q.getState().room}},{key:"createChatBadge",value:function(e){var t=document.createElement("span");(0,f.Zs)(t,{position:"relative",display:this.shouldShowBadge(e)?"":"none",marginRight:".1em"});var n=(0,c.R)(),i=(0,u.T)({content:p.ag.followsYou,hasHTML:!1,divotPosition:1,divotLeftOrTop:"8px"});return i.style.padding="6px",i.style.fontFamily="UbuntuLight, Helvetica, Arial, sans-serif",i.style.lineHeight="normal",i.style.position="fixed",i.style.display="block",(0,f.nH)(n).listen((function(e){var t;e?document.body.appendChild(i):null===(t=i.parentElement)||void 0===t||t.removeChild(i);var o=n.getBoundingClientRect(),r=(0,f.i6)();i.style.top="".concat(-r.top+o.top-i.offsetHeight-o.height/5-5,"px"),i.style.left="".concat(-r.left+o.left+o.width/2-18,"px")})),t.appendChild(n),t}},{key:"updateChatBadges",value:function(e){var t=this.shouldShowBadge(e);d.x.getBadgeElements("followerBadge",e).forEach((function(e){e.style.display=t?"":"none"}))}}],[{key:"getOrCreateInstance",value:function(){return void 0===e.singletonInstance&&(e.singletonInstance=new e),e.singletonInstance}}]),e}()},2673:function(e,t,n){"use strict";n.d(t,{T:function(){return p}});var i=n(2951),o=n(1976),r=n(6853),s=n(2800),a=n(6698),l=n(6265),c=n(9598),u=n(1522),d=n(3543);function h(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var p=function(){function e(t,n,o){(0,i.Z)(this,e),this.isAnonymous=t,this.roomListContainerID=n,this.isMobile=o,this.initEvents()}return(0,o.Z)(e,[{key:"initEvents",value:function(){var e=this;this.bindFollowingIcons(),a.Bb.getInstance().addOnLoadHandler((function(){e.bindFollowingIcons()})),r.yY.listen((function(t){if(void 0!==s.J.current.loggedInUser&&!window.location.pathname.startsWith("/followed-cams/")){var n=new Set(t.onlineFollowedList.roomList.map((function(e){return e.room})));e.updateAllFollowIcons(n)}}))}},{key:"bindFollowingIcons",value:function(){var e,t=this,n=h(document.querySelectorAll("#".concat(this.roomListContainerID)));try{for(n.s();!(e=n.n()).done;){var i,o=h(e.value.querySelectorAll("div.follow_star"));try{var r=function(){var e=i.value;e.onclick=function(){t.setFollowUnfollowStar(e)}};for(o.s();!(i=o.n()).done;)r()}catch(e){o.e(e)}finally{o.f()}}}catch(e){n.e(e)}finally{n.f()}}},{key:"onFollowClickSuccess",value:function(e){e.classList.remove("icon_update_following"),e.classList.add("icon_following","no_hover"),window.setTimeout((function(){e.classList.remove("no_hover")}),3e3),e.title=d.ag.unfollowText}},{key:"updateAllFollowIcons",value:function(e){var t,n=h(document.querySelectorAll("#".concat(this.roomListContainerID)));try{for(n.s();!(t=n.n()).done;){var i,o=h(t.value.querySelectorAll("div.follow_star:not([ts])"));try{for(o.s();!(i=o.n()).done;){var r,s=i.value,a=null!==(r=s.dataset.slug)&&void 0!==r?r:"";this.updateFollowIcon(s,e.has(a))}}catch(e){o.e(e)}finally{o.f()}}}catch(e){n.e(e)}finally{n.f()}}},{key:"updateFollowIcon",value:function(e,t){e.classList.remove("icon_update_following","icon_following","icon_not_following","no_hover"),t?(e.classList.add("icon_following"),e.title=d.ag.unfollowText):(e.classList.add("icon_not_following"),e.title=d.ag.followText)}},{key:"defineFollowClick",value:function(e){var t=this;e.classList.remove("icon_not_following"),e.classList.add("icon_update_following");var n=e.getAttribute("data-slug");if(null!==n){var i=(0,c.kr)(n,c.wk,this.isAnonymous);void 0!==i&&i.then((function(n){n?t.onFollowClickSuccess(e):t.defineUnFollowClick(e)})).catch((function(){}))}}},{key:"onUnFollowRoomDefined",value:function(e){e.classList.remove("icon_update_following"),e.classList.add("icon_not_following","no_hover"),window.setTimeout((function(){e.classList.remove("no_hover")}),3e3),e.title=d.ag.followText}},{key:"onUnFollowRoomUnDefined",value:function(e){e.classList.remove("icon_update_following"),e.classList.add("icon_following")}},{key:"defineUnFollowClick",value:function(e){e.classList.remove("icon_following"),e.classList.add("icon_update_following");var t=e.getAttribute("data-slug");null!==t&&(void 0!==(0,c.c5)(t,c.wk,this.isAnonymous)?this.onUnFollowRoomDefined(e):this.onUnFollowRoomUnDefined(e))}},{key:"setFollowUnfollowStar",value:function(e){e.classList.contains("icon_following")?this.defineUnFollowClick(e):e.classList.contains("icon_not_following")&&(this.isAnonymous?this.isMobile?(0,u.oB)("To follow this broadcaster, please create an account or login now.",(function(){(0,l.iW)({fromFeature:!0})})):(0,l.iW)({fromFeature:!0}):this.defineFollowClick(e))}}]),e}()},1371:function(e,t,n){"use strict";n.d(t,{e:function(){return p},R:function(){return v}});var i=n(126),o=n(2951),r=n(1976),s=n(7693),a=n(3753),l=n(8069);function c(e){e.row.style.display="none"}function u(e,t,n,i){if(void 0!==e)if(t)!function(e,t,n){(0,a.Ue)(t.concat("?username=".concat(encodeURIComponent(n)))).then((function(t){var n=JSON.parse(t.responseText);!0===n.success?function(e,t){e.availableButton.innerText=t.usernames[0],e.availableButton.style.display="inline-block",function(e){e.available.appendChild(e.availableButton),e.available.style.display="block"}(e),e.row.style.display="table-row"}(e,n):c(e)})).catch((function(){}))}(e,n,i);else{if(function(e){return"none"===e.row.style.display}(e))return;c(e)}}var d=n(3705);function h(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var p=function(){function e(t){var n=this;(0,o.Z)(this,e),this.form=t,this.checkpoints=[],this.submitting=!1,v(t,!1).hasValidationErrors()||this.saveCheckpoint(),(0,s.j9)("submit",t,(function(){n.submitting=!0}))}return(0,r.Z)(e,[{key:"saveCheckpoint",value:function(){this.checkpoints.push(this.serializeForm())}},{key:"isDirty",value:function(){return 0===this.checkpoints.length||this.serializeForm()!==this.checkpoints[this.checkpoints.length-1]}},{key:"isSubmit",value:function(){return this.submitting}},{key:"warnOnClosingDirty",value:function(e){var t=this;(0,s.j9)("beforeunload",window,(function(n){if(t.isDirty()&&!t.isSubmit())return n.preventDefault(),n.returnValue=!1,e}))}},{key:"serializeForm",value:function(){return v(this.form,!1).serialize()}}]),e}();function m(e){var t={name:"",errorName:"",elementType:"",isMultiSelect:!1,isCheckbox:!1,isHidden:!1,isDisabled:!1,grace:!0,isDateWidget:!1,isRecaptcha:!1,dateWidgetLabel:"",isRecaptchaSet:!1,htmlElement:e,init:function(){t.elementType=String(e.tagName.toLowerCase());var n=t.getName();t.name=null!==n?n:"",t.errorName=t.name,"captcha"===e.getAttribute("data-type")?(t.isRecaptcha=!0,function(e,t){var n=String(t.getAttribute("data-callback"));"null"!==n&&(window[n]=function(){e.isRecaptchaSet=!0,e.clearError()})}(t,e)):function(e){var t=String(e.getAttribute("id")).split("_"),n=t[t.length-1],i=["day","month","year"],o=!1;if(i.indexOf(n)>-1){t.pop();var r=t.join("_");o=!0;var s,a=h(i);try{for(a.s();!(s=a.n()).done;){var l=s.value,c="".concat(r,"_").concat(l);null===document.querySelector("#".concat(c))&&(o=!1)}}catch(e){a.e(e)}finally{a.f()}}return o}(e)&&(t.isDateWidget=!0,t.errorName=function(e){var t=String(e.getAttribute("id")).split("_");return t.shift(),t.pop(),t.join("_")}(e));var i=String(e.getAttribute("type"));"checkbox"===i?t.isCheckbox=!0:"hidden"===i?t.isHidden=!0:"select"===t.elementType&&"select-multiple"===e.type&&(t.isMultiSelect=!0),t.isDisabled=null!==e.getAttribute("disabled"),t.hasError()&&(t.grace=!1)},getName:function(){return"captcha"===e.getAttribute("data-type")?function(e){var t=String(e.getAttribute("id")).split("_");return t.shift(),t.join("_")}(e):e.getAttribute("name")},showSpinner:function(){if(!t.isHidden&&!t.isRecaptcha){var e=document.querySelector("#".concat(t.errorName,"_spinner"));null!==e&&e.classList.remove("formvalidate_hidden")}},hideSpinner:function(){var e=document.querySelector("#".concat(t.errorName,"_spinner"));null!==e&&e.classList.add("formvalidate_hidden")},getId:function(){return String(e.getAttribute("id"))},getSubmitValue:function(){var n=e;return t.isCheckbox?n.checked?null!==n.getAttribute("value")?n.getAttribute("value"):"on":"":n.value},change:function(){t.grace=!1},hasError:function(){if(t.isHidden)return!1;var e=document.querySelector(".".concat(t.errorName,"_error"));return null!==e&&"none"!==e.style.display},showError:function(e,n){if(!t.isHidden&&(n&&(t.grace=!1),!t.grace)){document.querySelector(".".concat(t.errorName,"_error .error_msg")).appendChild(document.createTextNode(e));var i=document.querySelector(".".concat(t.errorName,"_error"));"tr"===String(i.tagName.toLowerCase())?i.style.display="table-row":i.style.display="block"}},clearError:function(){if(!t.isHidden){for(var e=document.querySelector(".".concat(t.errorName,"_error .error_msg"));null!==e.firstChild;)e.removeChild(e.firstChild);document.querySelector(".".concat(t.errorName,"_error")).style.display="none";var n=document.querySelector(".".concat(t.errorName,"_label"));null!==n&&n.classList.remove("formvalidate_error")}}};return t.init(),t}function v(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="1"===e.getAttribute("data-formvalidate-disable-on-submit")?(0,i.Z)(e.querySelectorAll("button:not([type=button]),input[type=submit]")):[],o={fields:[],formElement:e,usernameAssist:{fields:void 0},isValid:!0,isSubmitting:!1,isValidating:!1,validateUrl:"",usernameAssistUrl:"",fieldsIndex:{},lastAllData:{},queueValidation:!1,isPreSubmitValidationComplete:!1,preSubmitValidationHandlers:[],template:"",errored_inputs:[],init:function(){var i;if(o.validateUrl=String(e.getAttribute("data-formvalidate")).substring(1),o.usernameAssistUrl=String(e.getAttribute("data-usernameAssist")).substring(1),o.template=null!==(i=e.getAttribute("data-template"))&&void 0!==i?i:"",t){(0,s.j9)("submit",e,(function(e){o.isSubmitting?e.preventDefault():(o.isSubmitting=!0,o.isValid&&!o.isValidating?o.preSubmitValidation(e):(o.isPreSubmitValidationComplete=!1,n.map((function(e){return e.disabled=!0})),o.validate(!0).then((function(){o.isValid?o.preSubmitValidation(e):(o.isSubmitting=!1,n.map((function(e){return e.disabled=!1})))})).catch((function(){o.isSubmitting=!1,n.map((function(e){return e.disabled=!1}))})),e.preventDefault()))}));var r,a=Boolean(e.getAttribute("data-formvalidate-eagerness"))?Number(e.getAttribute("data-formvalidate-eagerness")):2;"1"===e.getAttribute("data-formvalidate-debounce")&&(r=new l.d((function(){o.validate()}),{bounceLimitMS:1e3,debounceType:2}));var c,u=h(e.querySelectorAll("input[type=text], input[type=checkbox], input[type=password], input[type=email], select"));try{for(u.s();!(c=u.n()).done;){var f=c.value,p=Boolean(f.getAttribute("data-formvalidate-eagerness"))?Number(f.getAttribute("data-formvalidate-eagerness")):a;p>=1&&(0,s.j9)("change",f,(function(e){var t=e.target;o.fields[o.fieldsIndex[String(t.getAttribute("id"))]].change(),o.validate()})),p>=2&&(0,s.j9)("input",f,(function(e){var t=e.target;o.fields[o.fieldsIndex[String(t.getAttribute("id"))]].change(),void 0!==r?r.callFunc():o.validate()}))}}catch(e){u.e(e)}finally{u.f()}!function(){if(o.template.indexOf("register")>-1){var t,n=h(e.querySelectorAll("input[type=submit], button[type=submit]"));try{for(n.s();!(t=n.n()).done;){var i=t.value;(0,s.j9)("click",i,(function(e){!o.isValid&&o.errored_inputs.length>0&&o.template.indexOf("register")>-1&&(0,d.fg)("SignupFailed",{template:o.template,inputs:o.errored_inputs.toString()})}))}}catch(e){n.e(e)}finally{n.f()}}}()}var v,g=0,y=h(e.querySelectorAll("input[type=text], input[type=checkbox], input[type=hidden], input[type=password], input[type=email], select, .g-recaptcha"));try{for(y.s();!(v=y.n()).done;){var b=m(v.value);o.fields.push(b),o.fieldsIndex[b.getId()]=g,g+=1,o.lastAllData[b.name]=b.getSubmitValue()}}catch(e){y.e(e)}finally{y.f()}!function(e){if(void 0!==e.usernameAssistUrl){var t,n=e.fields.find((function(e){return"username"===e.name})),i=document.getElementById("username_assist_row"),o=document.getElementById("username_assist_available");n&&i&&o&&(e.usernameAssist.fields={usernameField:n,row:i,available:o,availableButton:document.createElement("button")},(t=e.usernameAssist.fields.availableButton).style.display="none",t.style.cursor="pointer",t.style.background="transparent",t.style.border="none",t.style.padding="2px",t.style.color="#0a5a83",e.usernameAssist.fields.availableButton.type="button",e.usernameAssist.fields.availableButton.addEventListener("click",(function(t){var n;t.preventDefault(),void 0!==e.usernameAssist.fields&&(n=e.usernameAssist.fields.availableButton,void 0!==e.usernameAssist.fields&&(e.usernameAssist.fields.usernameField.htmlElement.value=n.innerText,e.validate(!1)))})))}}(o)},serialize:function(){return o.fields.map((function(e){if(""!==e.name&&!e.isDisabled){if(e.isMultiSelect)return Array.from(e.htmlElement.options).filter((function(e){return e.selected})).map((function(t){return"".concat(encodeURIComponent(e.name),"=").concat(encodeURIComponent(t.value))})).join("&");if(!e.isCheckbox&&"radio"!==e.elementType||e.htmlElement.checked){var t=e.getSubmitValue();return"".concat(encodeURIComponent(e.name),"=").concat(encodeURIComponent(t))}}})).filter((function(e){return void 0!==e})).join("&").replace(/%20/g,"+")},validate:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(o.isValidating&&!e)return o.queueValidation=!0,Promise.resolve();o.isValidating=!0;var t,n={},i={},r=!1,s=!1,l=h(o.fields);try{for(l.s();!(t=l.n()).done;){var c=t.value;i[c.name]=c.getSubmitValue(),c.isCheckbox&&""===c.getSubmitValue()||(n[c.name]=c.getSubmitValue()),(i[c.name]!==o.lastAllData[c.name]||e)&&("username"===c.name&&(s=!0),c.showSpinner(),r=!0)}}catch(e){l.e(e)}finally{l.f()}return r?(o.lastAllData=Object.assign({},i),(0,a.I5)(o.validateUrl,n).then((function(t){var n=JSON.parse(t.responseText);o.isValid=n.valid,o.errored_inputs=[];var r,a=h(o.fields);try{for(a.s();!(r=a.n()).done;){var l=r.value;l.isRecaptcha&&!l.isRecaptchaSet?(l.clearError(),l.showError("Captcha has to be completed",e)):void 0!==n.errors[l.errorName]?(l.clearError(),l.showError(n.errors[l.errorName],e),o.errored_inputs.includes(l.errorName)||o.errored_inputs.push(l.errorName),"username"===l.name&&(""===i[l.name].trim()?u(o.usernameAssist.fields,!1,o.usernameAssistUrl,i[l.name]):s&&!1===l.grace&&u(o.usernameAssist.fields,!0,o.usernameAssistUrl,i[l.name]))):(l.clearError(),"username"===l.name&&u(o.usernameAssist.fields,!1,o.usernameAssistUrl,i[l.name])),l.hideSpinner()}}catch(e){a.e(e)}finally{a.f()}if(o.clearGlobalErrors(),void 0!==n.errors.__all__){var c,d=h(n.errors.__all__);try{for(d.s();!(c=d.n()).done;){var f=c.value;o.addGlobalError(f)}}catch(e){d.e(e)}finally{d.f()}o.showGlobalErrors()}o.isValidating=!1,o.queueValidation&&(o.queueValidation=!1,o.validate())})).catch((function(e){if(info("error: ".concat(e)),o.isValidating=!1,!o.queueValidation)throw e;o.queueValidation=!1,o.validate()}))):(o.isValidating=!1,o.queueValidation&&(o.queueValidation=!1,o.validate()),Promise.resolve())},preSubmitValidation:function(t){return n.map((function(e){return e.disabled=!0})),o.isPreSubmitValidationComplete||0===o.preSubmitValidationHandlers.length?(window.setTimeout((function(){n.map((function(e){return e.disabled=!1}))}),700),Promise.resolve()):(t.preventDefault(),Promise.all(o.preSubmitValidationHandlers.map((function(e){return e()}))).then((function(t){var i;o.isSubmitting=!1,window.setTimeout((function(){n.map((function(e){return e.disabled=!1}))}),10),t.reduce((function(e,t){return e&&t}),!0)&&(o.isPreSubmitValidationComplete=!0,(i=document.createElement("button")).style.display="none",e.appendChild(i),window.setTimeout((function(){i.click(),e.removeChild(i)}),0))})).catch((function(t){throw error("Can't complete preSubmitValidation in form ".concat(e.action),t),o.isSubmitting=!1,n.map((function(e){return e.disabled=!1})),t})))},addGlobalError:function(e){var t=document.querySelector("#error_notice > .errorlist"),n=document.createElement("li");n.appendChild(document.createTextNode(e)),t.appendChild(n)},clearGlobalErrors:function(){var e=document.querySelector("#error_notice");if(null!==e){e.classList.add("formvalidate_hidden");var t=document.querySelector("#error_notice > .errorlist");if(null!==t)for(;null!==t.firstChild;)t.removeChild(t.firstChild)}},showGlobalErrors:function(){var e=document.querySelector("#error_notice");null!==e&&e.classList.remove("formvalidate_hidden")},hasValidationErrors:function(){var t,n=!1,i=h(o.fields);try{for(i.s();!(t=i.n()).done;){var r=t.value;n=n||r.hasError()}}catch(e){i.e(e)}finally{i.f()}var s=0!==Array.from(e.getElementsByClassName("errorlist")).filter((function(e){return""!==e.innerHTML.trim()})).length;return n||s},addPreSubmitValidator:function(e){o.preSubmitValidationHandlers.push(e);var t=!1;return function(){t||(o.preSubmitValidationHandlers.splice(o.preSubmitValidationHandlers.indexOf(e),1),t=!0)}}};return o.init(),o}},3256:function(e,t,n){"use strict";n.d(t,{j:function(){return s}});var i=n(1371),o=n(8970);function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function s(){var e,t=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw s}}}}(document.querySelectorAll("form[data-formvalidate]"));try{for(t.s();!(e=t.n()).done;){var n=e.value,s=(0,i.R)(n),a=n.querySelector("[name='prove_you_are_human']");null!==a&&(0,o.d)(a,s)}}catch(e){t.e(e)}finally{t.f()}}},8970:function(e,t,n){"use strict";n.d(t,{d:function(){return y},l:function(){return g}});var i=n(3940),o=n(1976),r=n(2951),s=n(7591),a=n(9492),l=n(7597),c=n(434),u=n(3753),d=n(3705),h=n(1289);function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var p=void 0!==window.performance&&void 0!==performance.now,m=function(e){(0,s.Z)(n,e);var t=f(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).isValidationError=!0,e}return(0,o.Z)(n)}((0,c.Z)(Error)),v=function(e){(0,s.Z)(n,e);var t=f(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).isFormInvalidError=!0,e}return(0,o.Z)(n)}((0,c.Z)(Error)),g=function(e,t,n){var o=function(){if("function"!=typeof window.injectReCaptchaV3Token)return error("window.injectReCaptchaV3Token is not a function: ",(0,i.Z)(window.injectReCaptchaV3Token)),Promise.resolve(!0);var o=p?performance.now():0;return window.injectReCaptchaV3Token(e).then((function(e){if(void 0!==n&&!n.isValid)throw new v;return w(e,t)})).then((function(e){if(""===e){var n=document.createElement("input");n.type="hidden",n.name="sign_recaptcha_failed",n.value="1",t.appendChild(n)}else{var i=document.createElement("input");i.type="hidden",i.name="signed_recaptcha",i.value=e,t.appendChild(i)}return(0,d.fg)("ReCAPTCHA3_frontend",{result:"success",timing_milliseconds:p?performance.now()-o:void 0}),!0})).catch((function(n){return!n.isFormInvalidError&&((0,d.fg)("ReCAPTCHA3_frontend",{result:n,timing_milliseconds:p?performance.now()-o:void 0}),b(e,t).then((function(e){return!e||(r(),!1)})))}))},r=n?n.addPreSubmitValidator(o):function(){};return o},y=function(e,t){var n=t.formElement;g(e,n,t)},b=function(e,t){return"function"!=typeof window.bindNoReCaptchaField?(error("window.bindNoReCaptchaField is not a function: ",(0,i.Z)(window.bindNoReCaptchaField)),Promise.resolve(!1)):null===e.parentNode?(error("replaceWithNoReCaptcha: captcha element hasn't a parent"),Promise.resolve(!1)):(0,u.Ue)("accounts/ajax_norecaptcha_html/").then((function(n){var i=document.createElement("div");if(null===e.parentNode||"function"!=typeof window.bindNoReCaptchaField)return!1;e.parentNode.insertBefore(i,e),i.outerHTML=n.responseText;var o=t.querySelector(".g-recaptcha");if(null===o)return error("replaceWithNoReCaptcha: html doesn't contain norecaptcha"),!1;window.bindNoReCaptchaField(o);var r=document.createElement("a");r.href=(0,u.BN)(t.action);var s=(0,h.dD)(r.search);s["force-nocaptcha"]="1";var a="/"===r.pathname[0]?"":"/";return t.action=(0,u.BN)("".concat(a).concat(r.pathname,"?").concat((0,h.Ie)(s))),!0}))},w=function(e,t){var n=t.querySelector("[data-formvalidate-sign-url]");if(null===n)return Promise.resolve("");var i=n.getAttribute("data-formvalidate-sign-url"),o=t.querySelector("[name=csrfmiddlewaretoken]");return"string"!=typeof i||null===o?Promise.resolve(""):(0,u.I5)(i,{recaptcha3:e,field_to_sign:n.value,csrfmiddlewaretoken:o.value}).then((function(e){var t=JSON.parse(e.responseText);if(!0!==t.valid)throw new m(t.errors);return t.signed_value})).catch((function(e){if(e.isValidationError)throw e;return error("Can't sign recaptcha: ",e),""}))}},1625:function(e,t,n){"use strict";n.d(t,{Gd:function(){return p},KE:function(){return f},Qg:function(){return h},Vc:function(){return u},Yu:function(){return b},Zx:function(){return d},dY:function(){return v},gH:function(){return y},rm:function(){return g}});var i,o=n(7693),r=n(1794),s={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5},a=["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror"],l=["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror"],c=["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError"];"fullscreenEnabled"in document?i=Object.keys(s):a[0]in document?i=a:l[0]in document?i=l:c[0]in document&&(i=c);var u=500;function d(e){void 0!==i?e[i[s.requestFullscreen]]():"webkitEnterFullScreen"in e&&e.webkitEnterFullScreen()}function h(){void 0!==i&&document[i[s.exitFullscreen]].bind(document)()}function f(){return void 0!==i&&Boolean(document[i[s.fullscreenEnabled]])}function p(){if(void 0!==i)return document[i[s.fullscreenElement]]}function m(){return void 0===i?"":i[s.fullscreenchange]}function v(){return void 0===i?"":"on".concat(i[s.fullscreenerror]).toLowerCase()}function g(){return Boolean(p())}var y=new r.xB("fullscreenChange",{listenersWarningThreshold:function(){return 50+r.q6},maxHistorySize:0});function b(){""!==m()&&(0,o.j9)(m(),document,(function(){return y.fire()}))}},4880:function(e,t,n){"use strict";n.d(t,{Ko:function(){return O},$q:function(){return D},XT:function(){return L}});var i=n(2951),o=n(1976),r=n(7169),s=n(7591),a=n(9492),l=n(7597),c=n(1185),u=n(7693),d=n(9),h=n(7988),f=n(8069),p=n(5392);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var v=function(e){(0,s.Z)(n,e);var t=m(n);function n(e){var o;return(0,i.Z)(this,n),(o=t.call(this)).element.style.height="0",o.element.style.width="0",o.element.style.overflow="visible",o.element.style.position="fixed",o.element.style.top="0",o.element.style.left="0",o.componentToOverlay=e.componentToOverlay,o.listener=function(){o.repositionChildrenRecursive()},o.componentToOverlay.didRepositionEvent.listen(o.listener),o.addChild(new y((0,r.Z)(o),e)),o.addChild(new b((0,r.Z)(o),e)),o.addChild(new w((0,r.Z)(o),e)),o.addChild(new C((0,r.Z)(o),e)),o.addChild(new x((0,r.Z)(o),e)),o.addChild(new k((0,r.Z)(o),e)),o.addChild(new S((0,r.Z)(o),e)),o.addChild(new T((0,r.Z)(o),e)),o}return(0,o.Z)(n,[{key:"repositionChildren",value:function(){}},{key:"prepareToRemove",value:function(){this.componentToOverlay.didRepositionEvent.removeListener(this.listener)}}]),n}(d.w),g=function(e){(0,s.Z)(n,e);var t=m(n);function n(e,o,r){var s;return(0,i.Z)(this,n),(s=t.call(this)).holder=e,s.options=o,s.cursor=r,s.thickness=8,s.element.style.height="".concat(s.thickness,"px"),s.element.style.width="".concat(s.thickness,"px"),s.element.style.cursor=s.cursor,(0,p.T)(s.element,(function(e,t,n){e.stopPropagation(),void 0!==o.onStart&&o.onStart();var i=t,r=n,a=Object.freeze((0,h.cQ)(o.componentToOverlay.element)),l=new f.d((function(){o.componentToOverlay.repositionChildrenRecursive()}),{bounceLimitMS:10});return{enabled:!0,move:function(e,t){(0,h.Sn)(s.moveEdges(a,{x:e-i,y:t-r}),o.componentToOverlay.element),l.callFunc()},end:function(){void 0!==o.onStop&&o.onStop()}}})),s}return(0,o.Z)(n)}(d.w),y=function(e){(0,s.Z)(n,e);var t=m(n);function n(e,o){return(0,i.Z)(this,n),t.call(this,e,o,"ns-resize")}return(0,o.Z)(n,[{key:"repositionChildren",value:function(){var e=this.options.componentToOverlay.element.getBoundingClientRect();this.element.style.top="".concat(e.top-this.thickness/2,"px"),this.element.style.left="".concat(e.left,"px"),this.element.style.width="".concat(e.right-e.left,"px")}},{key:"moveEdges",value:function(e,t){return(0,h.xg)(e,t.y,this.options.minHeight)}}]),n}(g),b=function(e){(0,s.Z)(n,e);var t=m(n);function n(e,o){return(0,i.Z)(this,n),t.call(this,e,o,"ns-resize")}return(0,o.Z)(n,[{key:"repositionChildren",value:function(){var e=this.options.componentToOverlay.element.getBoundingClientRect();this.element.style.top="".concat(e.top+e.height-this.thickness/2,"px"),this.element.style.left="".concat(e.left,"px"),this.element.style.width="".concat(e.width,"px")}},{key:"moveEdges",value:function(e,t){return(0,h.F3)(e,t.y,this.options.minHeight,this.options.maxHeight())}}]),n}(g),w=function(e){(0,s.Z)(n,e);var t=m(n);function n(e,o){return(0,i.Z)(this,n),t.call(this,e,o,"ew-resize")}return(0,o.Z)(n,[{key:"repositionChildren",value:function(){var e=this.options.componentToOverlay.element.getBoundingClientRect();this.element.style.top="".concat(e.top,"px"),this.element.style.left="".concat(e.left-this.thickness/2,"px"),this.element.style.height="".concat(e.bottom-e.top,"px")}},{key:"moveEdges",value:function(e,t){return(0,h.Fi)(e,t.x,this.options.minWidth)}}]),n}(g),C=function(e){(0,s.Z)(n,e);var t=m(n);function n(e,o){return(0,i.Z)(this,n),t.call(this,e,o,"ew-resize")}return(0,o.Z)(n,[{key:"repositionChildren",value:function(){var e=this.options.componentToOverlay.element.getBoundingClientRect();this.element.style.top="".concat(e.top,"px"),this.element.style.left="".concat(e.right-this.thickness/2,"px"),this.element.style.height="".concat(e.bottom-e.top,"px")}},{key:"moveEdges",value:function(e,t){return(0,h.jV)(e,t.x,this.options.minWidth,this.options.maxWidth())}}]),n}(g),x=function(e){(0,s.Z)(n,e);var t=m(n);function n(e,o){return(0,i.Z)(this,n),t.call(this,e,o,"nwse-resize")}return(0,o.Z)(n,[{key:"repositionChildren",value:function(){var e=this.options.componentToOverlay.element.getBoundingClientRect();this.element.style.top="".concat(e.top-this.thickness+this.thickness/2,"px"),this.element.style.left="".concat(e.left-this.thickness+this.thickness/2,"px")}},{key:"moveEdges",value:function(e,t){var n=(0,h.xg)(e,t.y,this.options.minHeight),i=(0,h.Fi)(e,t.x,this.options.minWidth);return{top:n.top,height:n.height,left:i.left,width:i.width}}}]),n}(g),k=function(e){(0,s.Z)(n,e);var t=m(n);function n(e,o){return(0,i.Z)(this,n),t.call(this,e,o,"nesw-resize")}return(0,o.Z)(n,[{key:"repositionChildren",value:function(){var e=this.options.componentToOverlay.element.getBoundingClientRect();this.element.style.top="".concat(e.top-this.thickness+this.thickness/2,"px"),this.element.style.left="".concat(e.right-this.thickness/2,"px")}},{key:"moveEdges",value:function(e,t){var n=(0,h.xg)(e,t.y,this.options.minHeight),i=(0,h.jV)(e,t.x,this.options.minWidth,this.options.maxWidth());return{top:n.top,height:n.height,left:i.left,width:i.width}}}]),n}(g),S=function(e){(0,s.Z)(n,e);var t=m(n);function n(e,o){return(0,i.Z)(this,n),t.call(this,e,o,"nesw-resize")}return(0,o.Z)(n,[{key:"repositionChildren",value:function(){var e=this.options.componentToOverlay.element.getBoundingClientRect();this.element.style.top="".concat(e.bottom-this.thickness/2,"px"),this.element.style.left="".concat(e.left-this.thickness+this.thickness/2,"px")}},{key:"moveEdges",value:function(e,t){var n=(0,h.F3)(e,t.y,this.options.minHeight,this.options.maxHeight()),i=(0,h.Fi)(e,t.x,this.options.minWidth);return{top:n.top,height:n.height,left:i.left,width:i.width}}}]),n}(g),T=function(e){(0,s.Z)(n,e);var t=m(n);function n(e,o){return(0,i.Z)(this,n),t.call(this,e,o,"nwse-resize")}return(0,o.Z)(n,[{key:"repositionChildren",value:function(){var e=this.options.componentToOverlay.element.getBoundingClientRect();this.element.style.top="".concat(e.bottom-this.thickness/2,"px"),this.element.style.left="".concat(e.right-this.thickness/2,"px")}},{key:"moveEdges",value:function(e,t){var n=(0,h.F3)(e,t.y,this.options.minHeight,this.options.maxHeight()),i=(0,h.jV)(e,t.x,this.options.minWidth,this.options.maxWidth());return{top:n.top,height:n.height,left:i.left,width:i.width}}}]),n}(g),I=n(1794),R=n(3705),P=n(8759),M=n(8263),A=n(3607),E=function(){function e(t,n,o){(0,i.Z)(this,e),this.draggableCanvasWindow=t,this.config=o,this.bounds={leftBound:NaN,topBound:NaN,bottomBound:NaN,rightBound:NaN,width:NaN,height:NaN},this.localStorageKey="window__".concat(n),this.bounds=this.getBoundsFromStorage(),isNaN(this.bounds.width)&&(this.bounds.width=this.config.defaultWidth),isNaN(this.bounds.height)&&(this.bounds.height=this.config.defaultHeight),this.setDefaultHorizontalBounds(),this.setDefaultVerticalBounds()}return(0,o.Z)(e,[{key:"setDefaultVerticalBounds",value:function(){isNaN(this.bounds.topBound)&&isNaN(this.bounds.bottomBound)&&(this.config.defaultAnchors.indexOf(3)>=0?this.bounds.bottomBound=(0,M.np)():this.config.defaultAnchors.indexOf(4)>=0?this.bounds.topBound=Math.max(0,window.innerHeight/2-this.config.defaultHeight/2):this.bounds.topBound=0)}},{key:"setDefaultHorizontalBounds",value:function(){isNaN(this.bounds.leftBound)&&isNaN(this.bounds.rightBound)&&(this.config.defaultAnchors.indexOf(1)>=0?this.bounds.rightBound=(0,M.np)():this.config.defaultAnchors.indexOf(4)>=0?this.bounds.leftBound=Math.max(0,(0,A._U)()/2-this.config.defaultWidth/2):this.bounds.leftBound=0)}},{key:"getBoundsFromStorage",value:function(){var e={leftBound:NaN,topBound:NaN,bottomBound:NaN,rightBound:NaN,width:NaN,height:NaN};if((0,P.IU)()){var t=window.localStorage.getItem(this.localStorageKey);if(null!==t){for(var n in e=JSON.parse(t))null===e[n]&&(e[n]=NaN);isNaN(e.width)&&(e.width=this.config.defaultWidth),isNaN(e.height)&&(e.height=this.config.defaultHeight)}}return e}},{key:"save",value:function(){this.detect(),(0,P.IU)()&&window.localStorage.setItem(this.localStorageKey,JSON.stringify(this.bounds))}},{key:"detect",value:function(){var e=this.draggableCanvasWindow.element.parentElement;if(null!==e){var t=this.draggableCanvasWindow.element.offsetLeft,n=this.draggableCanvasWindow.element.offsetTop,i=e.clientHeight-(this.draggableCanvasWindow.element.offsetHeight+n),o=e.clientWidth-(this.draggableCanvasWindow.element.offsetWidth+t);this.bounds.height=this.draggableCanvasWindow.element.offsetHeight,this.bounds.width=this.draggableCanvasWindow.element.offsetWidth,t<=o?(this.bounds.leftBound=t,this.bounds.rightBound=NaN):(this.bounds.leftBound=NaN,this.bounds.rightBound=o),n<=i?(this.bounds.topBound=n,this.bounds.bottomBound=NaN):(this.bounds.topBound=NaN,this.bounds.bottomBound=i)}else error("no parent element")}},{key:"apply",value:function(){var e=this,t=this.draggableCanvasWindow.element.parentElement;null!==t?0!==t.clientHeight&&(void 0!==this.config.autoSize&&this.config.autoSize?(this.draggableCanvasWindow.innerDiv.style.position="relative",this.draggableCanvasWindow.element.style.width="auto",this.draggableCanvasWindow.element.style.height="auto",this.bounds.height=this.draggableCanvasWindow.element.offsetHeight,this.bounds.width=this.draggableCanvasWindow.element.offsetWidth):this.config.resizeable?(e.bounds.width=Math.min(e.bounds.width,t.clientWidth),e.bounds.height=Math.min(e.bounds.height,t.clientHeight),e.bounds.width=Math.max(e.bounds.width,e.config.minWidth),e.bounds.height=Math.max(e.bounds.height,e.config.minHeight),this.draggableCanvasWindow.element.style.width="".concat(this.bounds.width,"px"),this.draggableCanvasWindow.element.style.height="".concat(this.bounds.height,"px")):(this.bounds.width=this.config.defaultWidth,this.bounds.height=this.config.defaultHeight+this.draggableCanvasWindow.getTitleBarHeight(),this.draggableCanvasWindow.element.style.width="".concat(this.bounds.width,"px"),this.draggableCanvasWindow.element.style.height="".concat(this.bounds.height,"px")),this.sanityCheckBounds()?info("unexpected bounds: top:".concat(this.bounds.topBound," bottom:").concat(this.bounds.bottomBound," left:").concat(this.bounds.leftBound," right: ").concat(this.bounds.rightBound)):(this.setVerticalPosition(t.clientHeight),this.setHorizontalPosition(t.clientWidth))):error("no parent element")}},{key:"sanityCheckBounds",value:function(){var e=!isNaN(this.bounds.topBound)&&!isNaN(this.bounds.bottomBound)||isNaN(this.bounds.topBound)&&isNaN(this.bounds.bottomBound),t=!isNaN(this.bounds.leftBound)&&!isNaN(this.bounds.rightBound)||isNaN(this.bounds.leftBound)&&isNaN(this.bounds.rightBound);return e||t}},{key:"setVerticalPosition",value:function(e){isNaN(this.bounds.topBound)?isNaN(this.bounds.bottomBound)||((this.bounds.bottomBound+this.bounds.height>e||this.bounds.bottomBound<0)&&(info("set bottomBound to container height - bounds height to make fit"),this.bounds.bottomBound=Math.max(0,e-this.bounds.height)),this.draggableCanvasWindow.element.style.top="".concat(e-this.bounds.height-this.bounds.bottomBound,"px")):((this.bounds.topBound+this.bounds.height>e||this.bounds.topBound<0)&&(info("set topBound to container height - bounds height to make fit"),this.bounds.topBound=Math.max(0,e-this.bounds.height)),this.draggableCanvasWindow.element.style.top="".concat(this.bounds.topBound,"px"))}},{key:"setHorizontalPosition",value:function(e){isNaN(this.bounds.leftBound)?isNaN(this.bounds.rightBound)||((this.bounds.rightBound+this.bounds.width>e||this.bounds.rightBound<0)&&(info("set rightBound to 0 to make fit"),this.bounds.rightBound=0),this.draggableCanvasWindow.element.style.left="".concat(e-this.bounds.width-this.bounds.rightBound,"px")):((this.bounds.leftBound+this.bounds.width>e||this.bounds.leftBound<0)&&(info("set leftBound to 0 to make fit"),this.bounds.leftBound=0),this.draggableCanvasWindow.element.style.left="".concat(this.bounds.leftBound,"px"))}}]),e}();function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var L=2,O=function(e){(0,s.Z)(h,e);var t,n,d=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function h(e,t,n){var o;(0,i.Z)(this,h),(o=d.call(this)).draggableCanvas=e,o.content=t,o.config=n,o.isDraggingOrResizing=!1,o.draggingOrResizingChanged=new I.xB("draggingOrResizingChanged"),o.isOpen=!1,(0,c.vP)(o.element,"draggableCanvasWindow"),o.element.style.overflow="visible",o.innerDiv=document.createElement("div"),(0,c.vP)(o.innerDiv,"innerDiv"),o.innerDiv.style.height="100%",o.innerDiv.style.width="100%",o.innerDiv.style.position="absolute",o.innerDiv.style.overflow="visible",o.innerDiv.style.boxSizing="border-box",o.innerDiv.style.borderWidth="".concat(L,"px"),o.innerDiv.style.borderStyle="solid",o.innerDiv.style.borderRadius="4px",o.closable=void 0!==n.title;var s=o.closeButton=document.createElement("div");return(0,c.vP)(o.closeButton,"closeButton"),o.closeButton.id="".concat(o.config.windowKey,"-close-btn").toLowerCase(),o.closeButton.dataset.paction="TheaterChat",o.closeButton.dataset.pactionName="ChatTab_Close",o.closeButton.style.position="absolute",o.closeButton.style.right="".concat(4,"px"),o.closeButton.style.height="10px",o.closeButton.style.width="10px",o.closeButton.style.cursor="pointer",o.closeButton.style.borderWidth="1px",o.closeButton.style.borderStyle="solid",o.closeButton.style.borderRadius="2px",(0,u.j9)("mouseenter",o.closeButton,(function(){s.style.backgroundImage="url(".concat(STATIC_URL,"grey-close.svg)"),s.style.backgroundSize="10px"})),(0,u.j9)("mouseleave",o.closeButton,(function(){s.style.backgroundImage=""})),void 0!==n.title?(o.titleBarDiv=document.createElement("div"),(0,c.vP)(o.titleBarDiv,"titleBar"),o.titleBarDiv.style.position="relative",o.titleBarDiv.style.fontSize="13px",o.titleBarDiv.style.fontWeight="bold",o.titleBarDiv.style.padding="3px 3px 3px ".concat(5,"px"),o.titleBarDiv.style.borderRadius="4px 4px 0 0",o.titleBarDiv.style.minHeight="10px",o.titleBarDivInner=document.createElement("div"),o.titleBarDivInner.style.height="100%",o.titleBarDivInner.style.whiteSpace="nowrap",o.titleBarDivInner.style.overflow="hidden",o.titleBarDivInner.style.textOverflow="ellipsis",o.titleBarDiv.appendChild(o.titleBarDivInner),o.titleSpan=document.createElement("span"),o.titleSpan.innerText=n.title,o.titleBarDivInner.appendChild(o.titleSpan),o.onClose=n.onClose,o.titleBarDiv.appendChild(o.closeButton),o.innerDiv.appendChild(o.titleBarDiv),(0,u.j9)("click",o.closeButton,(function(e){e.stopPropagation(),o.draggableCanvas.removeChild((0,r.Z)(o))}))):(o.closeButton.style.top="8px",o.closeButton.style.zIndex="1",o.element.appendChild(o.closeButton),(0,u.j9)("click",o.closeButton,(function(e){e.stopPropagation(),o.element.style.display="none",o.isOpen=!1}))),o.addChild(o.content,o.innerDiv),o.positioner=new E((0,r.Z)(o),o.config.windowKey,o.config),o.stopDraggingOrResizing=function(){o.positioner.save(),o.repositionChildrenRecursive()},void 0===n.handles&&(n.handles=void 0!==o.titleBarDivInner?[o.titleBarDivInner]:[o.element]),D(o.element,{dragStart:function(){o.focusThisWindow(),o.setDraggingOrResizing(!0)},dragStop:function(){o.setDraggingOrResizing(!1),o.stopDraggingOrResizing(),(0,R.fg)("MoveDraggableWindow",{window:o.getWindowKey(),left:o.element.offsetLeft,top:o.element.offsetTop,windowWidth:window.innerWidth,windowHeight:window.innerHeight})},canStart:function(){return!o.isDraggingOrResizing}},n.handles),!0===n.resizeable&&o.makeResizeable(),o.element.appendChild(o.innerDiv),o}return(0,o.Z)(h,[{key:"focusThisWindow",value:function(){this.draggableCanvas.setFocusedWindow(this)}},{key:"setTitle",value:function(e){void 0!==this.titleSpan&&(this.titleSpan.innerText=e)}},{key:"makeResizeable",value:function(){var e=this;void 0===this.resizeHandles&&(this.resizeHandles=this.addChild(new v({minWidth:this.config.minWidth,minHeight:this.config.minHeight,maxWidth:function(){return e.draggableCanvas.element.clientWidth},maxHeight:function(){return e.draggableCanvas.element.clientHeight},componentToOverlay:this,onStart:function(){e.focusThisWindow(),e.setDraggingOrResizing(!0)},onStop:function(){e.setDraggingOrResizing(!1),e.stopDraggingOrResizing(),(0,R.fg)("ResizeDraggableWindow",{window:e.getWindowKey(),width:e.element.clientWidth,height:e.element.clientHeight,windowWidth:window.innerWidth,windowHeight:window.innerHeight})}})),this.resizeHandles.repositionChildrenRecursive())}},{key:"resize",value:function(e,t){this.config.defaultHeight=e,this.config.defaultWidth=t,this.repositionChildren()}},{key:"setDraggingOrResizing",value:function(e){this.isDraggingOrResizing=e,this.draggingOrResizingChanged.fire(e)}},{key:"removeResizeable",value:function(){void 0!==this.resizeHandles&&(this.resizeHandles.prepareToRemove(),this.removeChild(this.resizeHandles),this.resizeHandles=void 0)}},{key:"repositionChildren",value:function(){void 0!==this.config.autoSize&&this.config.autoSize?this.content.element.style.height="auto":this.content.element.style.height="".concat(this.element.clientHeight-this.getTitleBarHeight()-2*L,"px"),void 0!==this.titleBarDiv&&(void 0===this.closeButton?error("expected close button to be defined"):void 0===this.titleBarDivInner?error("expected title bar div inner to be defined"):(this.titleBarDivInner.style.maxWidth="".concat(this.titleBarDiv.clientWidth-this.closeButton.offsetWidth-5-8,"px"),this.closeButton.style.top="".concat((this.titleBarDiv.offsetHeight-this.closeButton.offsetHeight)/2,"px")))}},{key:"show",value:function(){this.element.style.opacity="1"}},{key:"hide",value:function(){this.element.style.opacity="0"}},{key:"getWindowKey",value:function(){return this.config.windowKey}},{key:"getTitleBarHeight",value:function(){return void 0===this.titleBarDiv?0:this.titleBarDiv.offsetHeight}},{key:"gainedFocus",value:function(){this.innerDiv.style.opacity="1",void 0!==this.config.onGainedFocus&&this.config.onGainedFocus()}},{key:"lostFocus",value:function(){this.innerDiv.style.opacity=void 0!==this.config.blurOpacity?this.config.blurOpacity:"1",void 0!==this.config.onLostFocus&&this.config.onLostFocus()}},{key:"blur",value:function(){this.draggableCanvas.focusedWindow===this&&this.draggableCanvas.setFocusedWindow(void 0)}},{key:"handleKeyEvent",value:function(e){return void 0!==this.config.onKey&&this.config.onKey(e)}}]),h}(d.w);function D(e,t,n){var i,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(n);try{for(o.s();!(i=o.n()).done;){var r=i.value;r.style.cursor="move",(0,p.T)(r,(function(n,i,o){if(void 0!==t.canStart&&!1===t.canStart())return p.w;var r=e.offsetLeft,s=e.offsetTop,a=e.offsetHeight,l=e.offsetWidth;if(null===e.parentElement)return error("draggable without parent element"),p.w;var c=e.parentElement.clientHeight,u=e.parentElement.clientWidth,d=i,h=o;return void 0!==t.dragStart&&t.dragStart(),{enabled:!0,move:function(t,n){var i,o;(i=s+(n-h))<0?i=0:i+a>c&&(i=c-a),(o=r+(t-d))<0?o=0:o+l>u&&(o=u-l),e.style.top="".concat(i,"px"),e.style.left="".concat(o,"px")},end:function(){void 0!==t.dragStop&&t.dragStop()}}}))}}catch(e){o.e(e)}finally{o.f()}}},9179:function(e,t,n){"use strict";n.d(t,{Ht:function(){return E},J6:function(){return A},KS:function(){return O},Kx:function(){return M},PJ:function(){return _},d$:function(){return P},mp:function(){return D},rL:function(){return F}});var i,o,r=n(8759),s=n(1185),a=n(5712),l=n(2800),c=n(8626),u=n(3753),d=n(8157),h=n(5042),f=n(4793),p=n(9320),m=n(5726),v=n(3705),g=n(3544),y=n(7201),b=n(1392),w=n(3543),C=n(3328),x=n(2359),k=n(3340);function S(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function I(e){var t=(0,h._c)(e),n=new p.I(t.red,t.green,t.blue),i=n.brightness();return n.raiseToMin(255-i/3),"rgb(".concat(n.red,", ").concat(n.green,", ").concat(n.blue,")")}function R(e,t){return new C._(e,t)}function P(e,t){var n=U(e.fromUser.username);n.style.fontSize="";var i=R(e.fromUser,e);i.element.style.paddingRight="4px",n.appendChild(i.element);var o=(0,y.F$)(e.message);return o.style.color=void 0!==e.textColor?e.textColor:"#FFFFFF",void 0!==e.font&&(i.element.style.fontFamily=e.font,o.style.fontFamily=e.font),o.classList.add("msg-text"),o.dataset.testid="chat-message-text",i.element.dataset.paction="TheaterChat",i.element.dataset.pactionName="Username",i.element.dataset.testid="chat-message-username",n.appendChild(o),(0,r.w1)()?window.setTimeout((function(){twemoji.parse(n,{className:"emojiChat"})}),0):(0,r.IF)()||twemoji.parse(n,{className:"emojiChat"}),(0,d.Ow)(n,e.textColor,e.backgroundColor),M(n,t),(0,m.yY)(e,n),n}function M(e,t){var n,i=e.querySelectorAll(".username-mention"),o=[],r=a.n.getInstance(),s=r.users(),l=S(i);try{var c=function(){var e=n.value,i=e.innerText.replace("@","").toLowerCase(),r=s.find((function(e){return e.username===i}));if(void 0!==r){var a,l=R(r).createMentionLabel(r,t===r.username);null===(a=e.parentElement)||void 0===a||a.replaceChild(l,e)}else o.push(i)};for(l.s();!(n=l.n()).done;)c()}catch(e){l.e(e)}finally{l.f()}r.addInvalidUsers(o)}function A(e,t){var n=U();n.style.padding="1px 5px";var a=document.createElement("div");return a.style.display="inline-block",a.dataset.testid="room-notice",void 0!==e.background&&(a.style.background=e.background,a.style.color="#000000",a.style.padding="2px",a.style.textShadow="none"),void 0!==e.foreground&&(a.style.color=e.foreground),"#ff3"===e.background&&(0,s.vP)(a,"isTip"),(0,s.vP)(a,"roomNotice"),void 0!==e.colorClass&&(0,s.vP)(a,e.colorClass),a.style.fontWeight=void 0!==e.weight?e.weight:"normal",n.appendChild(function(e,t,n){var r,a,l,c,d=S(t);try{for(d.s();!(r=d.n()).done;){var h,f=r.value,p=document.createElement("div"),m=S(f);try{for(m.s();!(h=m.n()).done;){var v=h.value;switch(v.partType){case 1:p.appendChild(Z(v,n));break;case 0:p.appendChild(R(v.user,void 0).element);break;case 2:p.appendChild((a=v.message,l=void 0,c=void 0,(c=document.createElement("a")).href=(0,u.BN)("/tag/".concat(a,"/").concat(null!==(l=i)&&void 0!==l?l:"")),(0,s.vP)(c,"msg-link"),c.style.textDecoration="none",c.innerText="#".concat(a),c));break;case 3:p.appendChild(L(w.ag.spyPrivateShowLower,(function(){"privatespying"!==o.status&&(0,g.Cd)(o)})));break;default:error("Unknown roomNotice type for: ".concat(v))}}}catch(e){m.e(e)}finally{m.f()}e.appendChild(p)}}catch(e){d.e(e)}finally{d.f()}return e}(a,e.messages,e.shortcodes)),(0,r.IF)()||twemoji.parse(a,{className:"emojiChat"}),(0,d.Ow)(n,e.foreground,e.background),M(n,t),void 0!==e.ts&&(n.dataset.ts=e.ts.toString()),n}function E(e){var t=U(e.fromUser.username);t.style.fontSize="";var n=R(e.fromUser,e);n.element.style.paddingRight="4px",t.appendChild(n.element);var i=document.createElement("div");i.classList.add("msg-text"),i.style.display="inline-block";var o=(0,y.Mg)(e,B,k.Fx);void 0!==e.font&&(n.element.style.fontFamily=e.font,o.style.fontFamily=e.font),i.appendChild(o);var r=document.createElement("div");return r.style.display="inline-block",r.appendChild(i),t.appendChild(r),(0,d.Ow)(t,e.textColor,e.backgroundColor),(0,m.yY)(e,t),t}function B(e,t,n){var i=L(e,n);return void 0!==t&&""!==t&&(i.href=(0,u.BN)(t),i.target="_blank"),i}function L(e,t){var n=document.createElement("a");return(0,s.vP)(n,"msg-link"),n.style.textDecoration="underline",n.innerText=e,n.onclick=t,n.style.cursor="pointer",n}function O(e){var t=U();return t.innerText=e,x.p.setMessageColorData(t,I("#aaaaaa")),t}function D(e,t){function n(e){var t=document.createElement("span");return t.innerText=e,t}var i=U();x.p.setMessageColorData(i,I("#aaaaaa"));var o=t?w.ag.pmSupporterNoticeAgeVerified:w.ag.pmSupporterNotice;i.appendChild(n(o)),i.appendChild(document.createElement("br")),i.appendChild(n("".concat(w.ag.pmSupporterSignUp," ")));var r=L(w.ag.pmSupporterMembership,(function(){}));return r.href=(0,u.BN)("/supporter/upgrade/?source=".concat(l.J.current.PurchaseEventSources.SUPPORTER_SOURCE_PM_UPSELL)),r.target="_blank",r.dataset.testid="supporter-upsell-link",r.onclick=function(){(0,v.fg)("SupporterPageOpened",{source:"chat"})},i.appendChild(r),i.appendChild(n(" ".concat(w.ag.pmSupporterSendPm(e),"."))),i}function U(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("div");return t.dataset.testid="chat-message",t.style.fontFamily="Tahoma,Arial,Helvetica,sans-serif",t.style.boxSizing="border-box",t.style.paddingTop="3px",t.style.paddingBottom="3px",t.style.paddingLeft="5px",t.style.paddingRight="5px",t.style.overflowWrap="break-word",t.style.wordWrap="break-word",e.length>0&&t.setAttribute("data-nick",e),t}function Z(e,t){var n=document.createElement("span");return(0,c.vj)()&&void 0!==e.message&&t&&b.uF.isShortcodeSyntax(e.message)?n=(0,y.rP)(e,t,B,k.Fx):!1!==e.parseEmoticon?n=(0,y.F$)(e.message):n.innerText=e.message,n.style.color=void 0!==e.foreground?e.foreground:"",n.style.background=void 0!==e.background?e.background:"",n.style.fontWeight=void 0!==e.weight?e.weight:"",n}function F(e){var t=U();return e.renderTo(t)}function _(e,t){var n=U(e);return n.innerText=e,n.appendChild(t),x.p.setMessageColorData(n,I("#aaaaaa")),n.classList.add("roomNotice"),n}f.kN.listen((function(e){i=e.dossier.roomGender,o=e.chatConnection}))},2359:function(e,t,n){"use strict";n.d(t,{p:function(){return p}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(1185),c=n(4793),u=n(9),d=n(758);function h(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var p=function(e){(0,r.Z)(f,e);var t,n,u=(t=f,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function f(e){var t;return(0,i.Z)(this,f),(t=u.call(this)).chatComponentToMirror=e,t.pendingTimeouts=[],t.element.style.position="fixed",t.element.style.height="",t.element.style.textShadow="1px 1px 0 #000, -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000",t.element.style.fontSize="12px",t.innerDiv=document.createElement("div"),t.innerDiv.style.position="absolute",t.innerDiv.style.bottom="0",(0,l.vP)(t.element,"hasDarkBackground"),t.element.style.overflowWrap="break-word",t.element.style.wordWrap="break-word",t.element.appendChild(t.innerDiv),e.addMessageHTMLEvent.listen((function(e){t.addMessage(e.makeByCloning(),e.scrollToItem)})),c.QN.listen((function(){t.clear()})),c.kN.listen((function(e){t.element.style.fontSize=e.dossier.userChatSettings.fontSize,t.setLineHeight()})),d.gO.listen((function(e){t.element.style.fontSize=e.fontSize,t.setLineHeight()})),t}return(0,o.Z)(f,[{key:"scrollToBottom",value:function(){this.element.scrollTop=this.element.scrollHeight-this.element.offsetHeight}},{key:"clear",value:function(){var e,t=h(this.pendingTimeouts);try{for(t.s();!(e=t.n()).done;){var n=e.value;clearTimeout(n)}}catch(e){t.e(e)}finally{t.f()}for(this.pendingTimeouts=[];null!==this.innerDiv.firstChild;)this.innerDiv.removeChild(this.innerDiv.firstChild)}},{key:"setLineHeight",value:function(){this.innerDiv.style.lineHeight="".concat(Number(this.element.style.fontSize.slice(0,-2))+7,"pt")}},{key:"addMessage",value:function(e,t){f.setMessageColor(e),this.innerDiv.appendChild(e),this.addTimeout((function(){e.style.opacity="0"}),2e4),this.repositionChildrenRecursive(),void 0!==t&&!0!==t||this.scrollToBottom()}},{key:"addTimeout",value:function(e,t){var n=this,i=window.setTimeout((function(){var t=n.pendingTimeouts.indexOf(i);t>=0&&n.pendingTimeouts.splice(t,1),e()}),t);this.pendingTimeouts.push(i)}},{key:"afterDOMConstructed",value:function(){var e=this;this.chatComponentToMirror.didRepositionEvent.listen((function(){e.repositionChildrenRecursive()}))}},{key:"repositionChildren",value:function(){var e=this.chatComponentToMirror.messageList,t=this.chatComponentToMirror.messageListWrapper,n=e.getBoundingClientRect();this.element.style.left="".concat(n.left,"px"),this.element.style.width="".concat(e.clientWidth,"px"),this.innerDiv.style.width="".concat(e.clientWidth,"px"),this.element.style.top="".concat(t.getBoundingClientRect().top,"px"),this.element.style.height="".concat(t.clientHeight,"px"),this.innerDiv.style.height="".concat(t.clientHeight,"px")}}],[{key:"setMessageColorData",value:function(e,t){e.setAttribute("data-pureChatColor",t),e.classList.add("pureChatColor")}},{key:"setMessageColor",value:function(e){var t=function(e){var t=e.getAttribute("data-pureChatColor");null!==t&&(e.style.color=t)};if(e.classList.contains("pureChatColor"))t(e);else{var n,i=h(e.getElementsByClassName("pureChatColor"));try{for(i.s();!(n=i.n()).done;){var o=n.value;o instanceof HTMLElement&&t(o)}}catch(e){i.e(e)}finally{i.f()}}}}]),f}(u.w)},3340:function(e,t,n){"use strict";n.d(t,{FJ:function(){return o},F_:function(){return h},Fx:function(){return s},PC:function(){return u},WP:function(){return a},Yw:function(){return c},Zx:function(){return l},jf:function(){return r},rb:function(){return d}});var i=n(1794),o=new i.xB("bioClicked"),r=new i.xB("userListRequest"),s=new i.xB("openTipCalloutRequest"),a=new i.xB("loadRoomRequest"),l=new i.xB("reportAbuseRequest"),c=new i.xB("privateWindowRequest"),u=new i.xB("chatWindowRequest"),d=new i.xB("colorModeChangeRequest"),h=new i.xB("roomChangeColorModeUpdateRequest")},9165:function(e,t,n){"use strict";n.d(t,{$p:function(){return i.$p},BK:function(){return i.BK},Y0:function(){return i.Y0},aI:function(){return i.aI},dW:function(){return i.dW},eN:function(){return r},ej:function(){return i.ej},hP:function(){return o}});var i=n(4918);function o(e){var t=i.BK.get(e);return void 0!==t?t:"followed"===e?"o":(error("Unknown user category ".concat(e)),"")}function r(e){switch(e){case i.Y0.Female:return"female-cams";case i.Y0.Male:return"male-cams";case i.Y0.Couple:return"couple-cams";case i.Y0.Trans:case i.Y0.OldTrans:return"trans-cams";default:return""}}},9846:function(e,t,n){"use strict";n.d(t,{r:function(){return o}});var i={enter:13,esc:27,modifierKeys:{ctrl:17,shift:16,alt:18,leftMeta:91,rightMeta:93,caps:20,tab:9},arrowKeys:{left:37,up:38,right:39,down:40}};function o(e){if(void 0===e||e===i.enter||e===i.esc)return!1;for(var t in i.arrowKeys)if(e===i.arrowKeys[t])return!1;for(var n in i.modifierKeys)if(e===i.modifierKeys[n])return!1;return!0}},534:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var i=n(2951),o=n(1976);function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var s=function(){function e(){(0,i.Z)(this,e),this.handlers=[]}return(0,o.Z)(e,[{key:"addHandler",value:function(e){this.handlers.push(e)}},{key:"execute",value:function(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw s}}}}(this.handlers);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(e.which===i.keyCode&&(!i.requiresCtrlOrMeta||e.ctrlKey||e.metaKey))return i.handle(e),!0}}catch(e){n.e(e)}finally{n.f()}return!1}}]),e}()},9905:function(e,t,n){"use strict";n.d(t,{Y:function(){return a},x:function(){return s}});var i=n(1185),o=n(2425);function r(e,t){var n=document.createElement("div");n.innerText=t,n.style.overflow="hidden",n.style.maxHeight="21px",e.appendChild(n)}function s(e){return void 0===e?a():a({name:e.getString("name",!1),template:e.getString("template",!1),firstRowLabel:e.getStringWithNumbers("row1_label",!1),secondRowLabel:e.getStringWithNumbers("row2_label",!1),thirdRowLabel:e.getStringWithNumbers("row3_label",!1),firstRowValue:e.getStringWithNumbers("row1_value",!1),secondRowValue:e.getStringWithNumbers("row2_value",!1),thirdRowValue:e.getStringWithNumbers("row3_value",!1)})}function a(e){var t=document.createElement("tr"),n=document.createElement("tr"),s=document.createElement("tr");if(void 0!==e){var a=e.template,l=[],c=[];if(""!==e.firstRowLabel){var u=document.createElement("th");u.style.padding="2px",r(u,e.firstRowLabel),l.push(u),t.appendChild(u);var d=document.createElement("td");r(d,e.firstRowValue),t.appendChild(d),c.push(d),d.style.width="50%",d.style.paddingLeft="10px"}else{var h=document.createElement("td");r(h,e.firstRowValue),h.colSpan=2,c.push(h),t.appendChild(h),h.style.textAlign="center"}if(""!==e.secondRowLabel){var f=document.createElement("th");f.style.padding="2px",f.style.fontWeight="bold",r(f,e.secondRowLabel),l.push(f),n.appendChild(f);var p=document.createElement("td");r(p,e.secondRowValue),c.push(p),n.appendChild(p),p.style.width="50%",p.style.paddingLeft="10px"}else{var m=document.createElement("td");r(m,e.secondRowValue),m.colSpan=2,c.push(m),n.appendChild(m),m.style.textAlign="center"}if(""!==e.thirdRowLabel){var v=document.createElement("th");v.style.padding="2px",r(v,e.thirdRowLabel),l.push(v),s.appendChild(v);var g=document.createElement("td");r(g,e.thirdRowValue),c.push(g),s.appendChild(g),g.style.width="50%",g.style.paddingLeft="10px"}else{var y=document.createElement("td");r(y,e.thirdRowValue),y.colSpan=2,c.push(y),s.appendChild(y),y.style.textAlign="center"}for(var b=0,w=l;b<w.length;b++){var C=w[b];C.style.overflow="hidden",C.style.display="block",C.style.cssFloat="right"}"3_rows_of_labels"===a?((0,i.vP)(l[0],"threeRowsOfLabels"),l[0].style.display="block",l[0].style.margin="0px auto",l[0].style.height="16px",l[0].style.fontWeight="bold"):"3_rows_11_21_31"!==a&&"3_rows_11_22_32"!==a||((0,i.vP)(c[0],"threeRows-11-21-31"),c[0].style.fontWeight="bold")}else{var x=document.createElement("td");t.appendChild(x.cloneNode()),n.appendChild(x.cloneNode()),s.appendChild(x.cloneNode())}(0,i.vP)(t,"rowOne"),t.style.height="33.3333%",(0,i.vP)(n,"rowTwo"),n.style.height="33.3333%",(0,i.vP)(s,"rowThree"),s.style.height="33.3333%";var k=document.createElement("table");return k.id="AppPanelTable",k.style.fontSize="11px",k.style.lineHeight="1.7em",k.style.width="".concat(o.Uh,"px"),k.style.height="".concat(o.dD,"px"),k.style.borderCollapse="collapse",k.style.margin="0 auto",k.style.tableLayout="fixed",k.appendChild(t),k.appendChild(n),k.appendChild(s),k}},9320:function(e,t,n){"use strict";n.d(t,{I:function(){return r}});var i=n(2951),o=n(1976),r=function(){function e(t,n,o){(0,i.Z)(this,e),this.red=t,this.green=n,this.blue=o,this.redWeight=10,this.greenWeight=10,this.blueWeight=10}return(0,o.Z)(e,[{key:"raiseToMin",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=.05;for(e=Math.min(255,e);e>this.brightness()&&(!t||255!==this.red&&255!==this.green&&255!==this.blue);)this.red=Math.min(this.red+Math.max(1,n*this.red),255),this.green=Math.min(this.green+Math.max(1,n*this.green),255),this.blue=Math.min(this.blue+Math.max(1,n*this.blue),255);this.red=Math.round(this.red),this.green=Math.round(this.green),this.blue=Math.round(this.blue)}},{key:"totalWeights",value:function(){return this.redWeight+this.greenWeight+this.blueWeight}},{key:"redMultiplier",value:function(){return this.redWeight/this.totalWeights()}},{key:"greenMultiplier",value:function(){return this.greenWeight/this.totalWeights()}},{key:"blueMultiplier",value:function(){return this.blueWeight/this.totalWeights()}},{key:"brightness",value:function(){return Math.round(this.redMultiplier()*this.red+this.greenMultiplier()*this.green+this.blueMultiplier()*this.blue)}}]),e}()},5726:function(e,t,n){"use strict";n.d(t,{Ng:function(){return y},Q0:function(){return b},Yl:function(){return x},ZA:function(){return T},aP:function(){return g},t:function(){return v},yY:function(){return S}});var i=n(7791),o=n(824),r=n.n(o),s=n(2018),a=n(1185),l=n(8542),c=n(3753),u=n(5042),d=n(2359),h=n(9320),f=n(6522),p=n(3543);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function v(e){var t=document.createElement("div");return t.style.width="100%",t.style.display="inline-block",void 0!==e&&(t.style.backgroundColor=e,t.style.textShadow="none"),t.style.padding="2px",t}function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("div");return t.dataset.testid="chat-message",t.style.fontFamily="Tahoma,Arial,Helvetica,sans-serif",t.style.boxSizing="border-box",t.style.width="100%",t.style.paddingTop="3px",t.style.paddingBottom="3px",t.style.paddingLeft="5px",t.style.paddingRight="5px",t.style.overflowX="hidden",e.length>0&&t.setAttribute("data-nick",e),t}function y(e,t){return t.username===e?"".concat(p.ag.broadcaster," "):t.isMod?"".concat(p.ag.moderator," "):t.inFanclub?"".concat(p.ag.fanclubMember," "):"".concat(p.ag.user," ")}function b(e){var t=(0,u._c)(e),n=new h.I(t.red,t.green,t.blue),i=n.brightness();return n.raiseToMin(255-i/3),"rgb(".concat(n.red,", ").concat(n.green,", ").concat(n.blue,")")}function w(){var e=document.createElement("span");return e.innerText=", ",e}function C(e,t){return new Promise((function(n,i){(0,s.HV)(e).then((function(e){var i=document.createElement("span");if(0!==e.items.length){var o=document.createElement("span");i.appendChild(o);var r,s=0,u=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(e.items);try{var d=function(){var n,o=r.value;s+=1,"mobile"===t?((n=document.createElement("div")).style.display="inline",n.style.position="relative",n.innerText=o.name):((n=document.createElement("a")).href=(0,c.BN)("/apps2/".concat(o.slot,"/").concat((0,l.bY)(o),"/")),n.target="_blank",n.innerText=o.name,(0,a.vP)(n,"msg-link"),n.onmouseenter=function(){n.style.textDecoration="underline"},n.onmouseleave=function(){n.style.textDecoration="none"}),i.appendChild(n),s<e.items.length&&i.appendChild(w())};for(u.s();!(r=u.n()).done;)d()}catch(e){u.e(e)}finally{u.f()}n(i)}else n(i)})).catch((function(e){i(e)}))}))}function x(e,t,n,i){return k.apply(this,arguments)}function k(){return(k=(0,i.Z)(r().mark((function e(t,n,i,o){var s,l,u,h,f;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=g(),d.p.setMessageColorData(s,b("#aaaaaa")),(l=document.createElement("span")).innerText=p.ag.appsRunningMessage(t),s.appendChild(l),u=r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"mobile"===o?((t=document.createElement("div")).style.display="inline",t.style.position="relative",t.innerText=i[h].app_name):((t=document.createElement("a")).href=(0,c.BN)(i[h].app_location),t.target="_blank",t.innerText=i[h].app_name,(0,a.vP)(t,"msg-link"),t.onmouseenter=function(){t.style.textDecoration="underline"},t.onmouseleave=function(){t.style.textDecoration="none"}),s.appendChild(t),h<i.length-1&&s.appendChild(w());case 3:case"end":return e.stop()}}),e)})),h=0;case 7:if(!(h<i.length)){e.next=12;break}return e.delegateYield(u(),"t0",9);case 9:h+=1,e.next=7;break;case 12:return e.prev=12,e.next=15,C(n,o);case 15:if(""!==(f=e.sent).innerText||0!==i.length){e.next=18;break}return e.abrupt("return",Promise.resolve(document.createElement("div")));case 18:if(""!==f.innerText){e.next=20;break}return e.abrupt("return",Promise.resolve(s));case 20:i.length>0&&s.appendChild(w()),s.appendChild(f),e.next=27;break;case 24:e.prev=24,e.t1=e.catch(12),0===i.length&&(s=document.createElement("div"));case 27:return e.abrupt("return",Promise.resolve(s));case 28:case"end":return e.stop()}}),e,null,[[12,24]])})))).apply(this,arguments)}function S(e,t){var n=e;void 0!==e.ts?t.dataset.ts=e.ts.toString():void 0!==n.createdAt&&(t.dataset.ts=n.createdAt.getTime().toString())}function T(e,t){var n=e.dataset.ts;if(void 0!==n&&""!==n){for(var i=t.children,o=t.children.length,r=i.length<f.b9?0:i.length-f.b9,s=i.length-1;s>=r;s-=1){var a=i[s].getAttribute("data-ts");if(null!==a&&""!==a){if(Number.parseInt(a)<=Number.parseInt(n))break;o=s}}o>=t.children.length?t.appendChild(e):t.insertBefore(e,i[o])}else t.appendChild(e)}},5078:function(e,t,n){"use strict";n.d(t,{i:function(){return v},u:function(){return g}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(8759),c=n(7693),u=n(9),d=n(1794),h=n(3682),f=n(3543),p=n(1289);var m=window.Accelerometer,v=function(e){(0,r.Z)(d,e);var t,n,u=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function d(){var e;(0,i.Z)(this,d),(e=u.call(this)).element.style.textAlign="center",e.element.style.paddingTop="40px",e.element.style.backgroundColor="rgba(255, 255, 255, 0.5)",e.element.style.width="100%",e.element.style.height="100%";var t=e.element.appendChild(document.createElement("img"));if(t.src="".concat(STATIC_URL_MOBILE,"rotate.svg"),t.style.width="500px",t.style.objectFit="contain",t.style.maxWidth="40%",t.style.maxHeight="40%",t.style.padding="15px",t.style.animationName="spin-default",t.style.animationDuration="2s",t.style.animationIterationCount="infinite",document.head.appendChild(document.createElement("style")).innerText="@keyframes spin-default { 0% { transform: rotate(0deg); } 100% { transform: rotate(180deg); } }",e.text=e.element.appendChild(document.createElement("div")),e.text.style.fontWeight="bold",e.text.style.fontSize="1.5em",e.text.style.padding="15px",(0,c.j9)("fullscreenchange",document,(function(t){e.onFullScreen()})),(0,l.Tt)()||void 0===window.Accelerometer)e.update(),h.bs.listen((function(){e.update()}));else{e.image=t;var n=screen.orientation.type,o=new m({frequency:2});(0,c.j9)("reading",o,(function(){e.updateAndroid(o.x,o.y,o.z,n)})),o.start()}return g.listen((function(){if((0,h.qn)()&&null===document.fullscreenElement)try{void 0!==document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen()}catch(e){warn(e)}})),e}return(0,o.Z)(d,[{key:"onFullScreen",value:function(){if(debug("On Full Screen"),(0,h.qn)()&&void 0!==screen.orientation){debug("Trying to lock landscape");try{screen.orientation.lock("landscape")}catch(e){warn(e)}}this.update()}},{key:"update",value:function(){(0,h.qn)()&&(0,h.P0)()||"true"===(0,p.dD)(window.location.search).ignorerotation||!(0,h.qn)()?this.element.style.display="none":(this.element.style.display="",(0,h.gr)()?this.text.innerText=f.ag.incorrectPortrait:this.text.innerText=f.ag.incorrectLandscape)}},{key:"updateAndroid",value:function(e,t,n,i){null===document.fullscreenElement?(this.image.style.display="none",this.element.style.display="",this.text.innerText=f.ag.missingFullscreen+f.ag.androidBroadcast):("portrait-primary"===i||"portrait-secondary"===i)&&e<4.5&&(t>2||t<-2)||Math.abs(t)>6.5&&n<8.5?(this.image.style.display="",this.element.style.display="",this.text.innerText=f.ag.incorrectPortrait):this.element.style.display="none"}}]),d}(u.w),g=new d.xB("tryFullScreen")},5537:function(e,t,n){"use strict";n.d(t,{Ug:function(){return D},ZF:function(){return B},lC:function(){return L},lr:function(){return U},u5:function(){return O}});var i=n(7169),o=n(2951),r=n(1976),s=n(3243),a=n(7591),l=n(9492),c=n(7597),u=n(4649),d=n(1185),h=n(2800),f=n(1522),p=n(3753),m=n(695),v=n(4793),g=n(9),y=n(8263),b=n(1794),w=n(3705),C=n(3544),x=n(928),k=n(3543),S=n(47),T=n(4043);function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=function(e){var t,n=(0,S.vz)("a",{style:P(P({},{borderWidth:"1px",borderStyle:"solid",borderRadius:"4px",display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"10px",padding:"0 12px",textAlign:"center",minHeight:"48px",boxSizing:"border-box"}),e.style),colorClass:void 0!==e.colorClass?["buttonBase",e.colorClass]:"buttonBase",onClick:e.onClick},null!==(t=e.body)&&void 0!==t?t:"");return void 0!==e.href&&(n.href=(0,p.BN)(e.href)),void 0!==e.target&&(n.target=e.target),n},A=function(e){(0,a.Z)(n,e);var t=I(n);function n(e){return(0,o.Z)(this,n),t.call(this,"a",e)}return(0,r.Z)(n,[{key:"initUI",value:function(e){this.element=(0,S.vz)(M,null)}},{key:"setButtonText",value:function(e){this.element.innerText=e}},{key:"setButtonBody",value:function(e){this.removeAllDOMChildren(),this.element.appendChild((0,S.vz)(S.HY,null,e))}},{key:"setOnClick",value:function(e){this.element.onclick=e}},{key:"showElement",value:function(){(0,s.Z)((0,c.Z)(n.prototype),"showElement",this).call(this,"flex")}}]),n}(g.w),E=new(function(){function e(){var t=this;(0,o.Z)(this,e),this.privateShowButtons=[],this.fanclubButtons=[],this.supporterButtons=[],this.listenerGroup=new b.mM,v.kN.listen((function(e){t.updateContext(e)})),v.QN.listen((function(){t.listenerGroup.removeAll()}))}return(0,r.Z)(e,[{key:"addButton",value:function(e){e instanceof L?this.privateShowButtons.push(e):e instanceof B?this.fanclubButtons.push(e):e instanceof O&&this.supporterButtons.push(e),void 0!==this.context&&this.updateContext(this.context)}},{key:"updateContext",value:function(e){this.context=e,this.fanclubButtons.forEach((function(t){t.updateState(e)})),this.supporterButtons.forEach((function(t){t.updateState(e)})),this.listenForRoomStatusChanges(e),this.updatePrivateButtonsState()}},{key:"listenForRoomStatusChanges",value:function(e){var t=this,n=e.dossier.isAgeVerified;this.privateShowButtons.forEach((function(e){e.hideElement()})),!(0,m.TF)()&&n&&e.dossier.allowPrivateShow&&e.chatConnection.event.statusChange.listen((function(e){t.roomStatusChangeNotification=e,t.updatePrivateButtonsState()})).addTo(this.listenerGroup)}},{key:"updatePrivateButtonsState",value:function(){var e=this;if(void 0!==this.context&&void 0!==this.roomStatusChangeNotification){var t=function(){void 0!==e.context&&e.context.dossier.allowPrivateShow&&e.privateShowButtons.forEach((function(t){void 0!==e.context&&void 0!==e.roomStatusChangeNotification&&t.updateState(e.context.chatConnection,e.roomStatusChangeNotification.currentStatus,e.context.dossier.spyPrice)}))};(0,x.OV)(this.context,this.roomStatusChangeNotification)?t():(0,x.P0)(this.context,this.roomStatusChangeNotification).then(t).catch((function(){}))}}}]),e}()),B=function(e){(0,a.Z)(n,e);var t=I(n);function n(){var e;return(0,o.Z)(this,n),e=t.call(this),E.addButton((0,i.Z)(e)),e}return(0,r.Z)(n,[{key:"initData",value:function(){this.hasFanclub=!1}},{key:"initUI",value:function(){(0,s.Z)((0,c.Z)(n.prototype),"initUI",this).call(this),(0,d.vP)(this.element,"fanclubButton"),(0,y.Zs)(this.element,{flex:1}),this.hideElement()}},{key:"updateState",value:function(e){var t;this.hasFanclub=e.dossier.hasFanClub,this.hasFanclub&&(this.element.href=(0,p.BN)("/fanclub/join/".concat(e.chatConnection.room(),"/?source=").concat(null===(t=h.J.current)||void 0===t?void 0:t.PurchaseEventSources.SUPPORTER_SOURCE_JOIN_FAN_CLUB_BUTTON))),this.hasFanclub?this.showElement():this.hideElement(),e.dossier.isInFanClub?this.setButtonText(k.ag.fanClubMember):this.setButtonText(k.ag.joinFanClub)}},{key:"getHasFanclub",value:function(){return this.hasFanclub}}]),n}(A),L=function(e){(0,a.Z)(n,e);var t=I(n);function n(e){var r;return(0,o.Z)(this,n),r=t.call(this,e),E.addButton((0,i.Z)(r)),r}return(0,r.Z)(n,[{key:"initData",value:function(e){this.hasSetText=!1,this.props=e,this.displayToggled=new b.xB("displayToggled")}},{key:"initUI",value:function(e){(0,s.Z)((0,c.Z)(n.prototype),"initUI",this).call(this),this.hideElement(),(0,d.vP)(this.element,"privateShowButton")}},{key:"setButtonText",value:function(e){(0,s.Z)((0,c.Z)(n.prototype),"setButtonText",this).call(this,e),this.hasSetText||(this.hasSetText=!0,this.didRepositionEvent.fire(void 0))}},{key:"updateState",value:function(e,t,n){var i,o,r,s;this.showElement(),this.displayToggled.fire(!0);var a=function(){(0,w.fg)("LeavePrivateOrSpyShow"),e.leavePrivateOrSpyShow().then((function(e){""!==e&&(0,f.Cj)(e)})).catch((function(){}))},l="";switch(t){case"privaterequesting":l=!0===(null===(i=this.props)||void 0===i?void 0:i.useConciseText)?k.ag.cancelRequest:k.ag.privateShowCancelRequestLabel,this.setButtonText(l),this.setOnClick(a);break;case"privatenotwatching":if(n<=0){this.hideElement(),this.displayToggled.fire(!1);break}l=!0===(null===(o=this.props)||void 0===o?void 0:o.useConciseText)?k.ag.spyOnPrivate:k.ag.privateShowSpyLabel,this.setButtonText(l),this.setOnClick((function(){(0,w.fg)("SpyClicked"),(0,C.Cd)(e)}));break;case"privatewatching":case"privatespying":l=!0===(null===(r=this.props)||void 0===r?void 0:r.useConciseText)?k.ag.leavePrivate:k.ag.privateShowLeaveLabel,this.setButtonText(l),this.setOnClick((function(e){e.preventDefault(),(0,f.oB)(k.ag.privateShowLeaveWarning,a)}));break;case"offline":case"away":case"hidden":case"notconnected":case"hiddenwatching":this.hideElement(),"notconnected"!==t&&this.displayToggled.fire(!1);break;case"public":l=!0===(null===(s=this.props)||void 0===s?void 0:s.useConciseText)?k.ag.requestPrivate:k.ag.privateShowRequestLabel,this.setButtonText(l),this.setOnClick((function(){(0,w.fg)("PrivateClicked"),(0,C.dy)(e)}));break;default:warn("Unexpected status for updatePrivateState: ".concat(t))}}}]),n}(A),O=function(e){(0,a.Z)(n,e);var t=I(n);function n(){var e;return(0,o.Z)(this,n),e=t.call(this),E.addButton((0,i.Z)(e)),e}return(0,r.Z)(n,[{key:"initUI",value:function(){this.element=(0,S.vz)(M,{style:{flex:1},colorClass:"upgradeButton",href:"/supporter/upgrade/?source=".concat(h.J.current.PurchaseEventSources.SUPPORTER_SOURCE_MOBILE_TOKENS_TAB),target:"_blank",body:k.ag.upgradeToSupporterLabel})}},{key:"updateState",value:function(e){e.dossier.isSupporter?this.hideElement():this.showElement()}}]),n}(A),D=function(e){(0,a.Z)(n,e);var t=I(n);function n(e){return(0,o.Z)(this,n),t.call(this,e)}return(0,r.Z)(n,[{key:"initUI",value:function(e){(0,s.Z)((0,c.Z)(n.prototype),"initUI",this).call(this);var t=(0,S.vz)("span",{style:{display:"flex",alignItems:"center"},"data-testid":"send-tip-button"},!0!==e.hideIcon&&(0,S.vz)("span",{style:{display:"inline-block",width:"20px",height:"20px",marginRight:"8px"},colorClass:"tipIcon"}),e.tipButtonText);this.element=(0,S.vz)(M,{style:P(P({},e.style),{},{marginBottom:0}),colorClass:"sendTipButton",body:t,onClick:function(){(0,w.fg)("TipWindowOpened"),(0,m.Cg)(k.ag.loginToTip)||T.Fx.fire({})}})}}]),n}(A),U=function(e){(0,a.Z)(n,e);var t=I(n);function n(e){return(0,o.Z)(this,n),t.call(this,e)}return(0,r.Z)(n,[{key:"initUI",value:function(e){var t=(0,S.vz)("span",{style:{display:"flex",alignItems:"center"}},k.ag.sendAMessage,(0,S.vz)("span",{style:{display:"inline-block",width:"20px",height:"20px",marginLeft:"8px"},colorClass:"sendIcon"}));this.element=(0,S.vz)(M,{style:{marginBottom:0,padding:"12px",minHeight:"",fontSize:"14px",margin:"0 8px 0 0"},colorClass:"sendMessageButton",body:t,onClick:e.onClick})}}]),n}(A)},444:function(e,t,n){"use strict";n.d(t,{Dl:function(){return ie},EM:function(){return oe},Bw:function(){return ee},hf:function(){return X},ZB:function(){return ne}});var i=n(3243),o=n(4649),r=n(2951),s=n(1976),a=n(7169),l=n(7591),c=n(9492),u=n(7597),d=n(1185),h=n(1194),f=n(822),p=n(8210),m=n(7693),v=n(695),g=n(1602),y=n(4793),b=n(2694),w=n(8069),C=n(9),x=n(8263),k=n(1910),S=n(1794),T=n(8821),I=n(1625),R=n(5726),P=n(3705),M=n(2239),A=n(8117),E=n(1392),B=n(5937),L=n(6522),O=n(758),D=n(3543),U=n(47),Z=n(5537);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,u.Z)(e);if(t){var o=(0,u.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,c.Z)(this,n)}}var j=function(e){(0,l.Z)(n,e);var t=N(n);function n(e){return(0,r.Z)(this,n),t.call(this,"div",e)}return(0,s.Z)(n,[{key:"initData",value:function(e){this.sendTipButton=new Z.Ug({tipButtonText:D.ag.sendTipButtonText}),this.privateShowButton=new Z.lC,this.fanclubButton=new Z.ZF}},{key:"initUI",value:function(e){this.containerStyle={backgroundColor:"#FFF",width:"100%",overflowX:"scroll",overflowY:"hidden",display:"flex",padding:"4px",boxSizing:"border-box",whiteSpace:"nowrap",borderBottomWidth:"1px",borderBottomStyle:"solid",direction:"rtl"};var t={padding:"12px",minHeight:"",height:"33px",fontSize:"14px",margin:"0 ".concat(L.xt/2,"px"),direction:"initial"},n={minWidth:"".concat(L.xt/2,"px"),display:"inline-block"};(0,x.Zs)(this.sendTipButton,t),(0,x.Zs)(this.privateShowButton.element,t),(0,x.Zs)(this.fanclubButton,_(_({},t),{},{flex:""})),this.element=(0,U.vz)("div",{id:"action-bar",colorClass:"ActionBar",style:this.containerStyle,className:"noScrollbar"},this.sendTipButton.element,this.privateShowButton.element,this.fanclubButton.element,(0,U.vz)("span",{style:n}))}},{key:"showElement",value:function(){(0,i.Z)((0,u.Z)(n.prototype),"showElement",this).call(this,"flex")}},{key:"setScrollLeft",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this.element.scrollLeft=e}}]),n}(C.w),H=function(e){(0,l.Z)(n,e);var t=N(n);function n(e){return(0,r.Z)(this,n),t.call(this,e)}return(0,s.Z)(n,[{key:"initUI",value:function(e){var t=this;(0,i.Z)((0,u.Z)(n.prototype),"initUI",this).call(this,e),this.hideElement();var o=new Z.lr({onClick:e.onSendMessageClick});this.privateShowButton.didRepositionEvent.listen((function(){t.setScrollLeft()}));var r={direction:"initial",height:"",margin:"0 ".concat(L.xt/2,"px")};(0,x.Zs)(this.element,{padding:"8px",height:"56px",direction:"rtl",borderBottom:""}),(0,x.Zs)(o.element,r),(0,x.Zs)(this.sendTipButton.element,r),(0,x.Zs)(this.privateShowButton.element,r),(0,x.Zs)(this.fanclubButton.element,r),this.element.ontouchstart=function(e){e.stopPropagation()},this.element.prepend(o.element)}}]),n}(j),z=n(202),W=n(6874),V=n(2923),q=n(4043),K=n(3607),J=n(3682);function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,u.Z)(e);if(t){var o=(0,u.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,c.Z)(this,n)}}var X=function(){return 64},ee=1;function te(){var e=document.createElement("div");return e.dataset.testid="buy-box",(0,x.Zs)(e,{display:"flex",alignItems:"center",marginLeft:"6px"}),e}var ne=new S.xB("toggleInputActionBar"),ie=function(e){(0,l.Z)(n,e);var t=Q(n);function n(e){var i,o,s,l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,r.Z)(this,n),(i=t.call(this)).outgoingHandlers=e,i.isPmChatContents=l,i.addMessageHTMLEvent=new S.xB("addMessageHtml",{reportIfNoListeners:!1}),i.removeMessagesForUserEvent=new S.xB("removeMessageHtml",{reportIfNoListeners:!1}),i.scrolledToBottom=new S.xB("scrolledToBottom"),i.messageList=(o=document.createElement("div"),(0,d.vP)(o,"msgList"),(0,M.ql)(o,"text"),o.style.width="100%",o.style.cursor="text",o.style.paddingBottom="4px",o),i.noticeList=function(){var e=document.createElement("div");return(0,d.vP)(e,"noticeList"),(0,M.ql)(e,"text"),e.style.width="100%",e.style.cursor="text",e.style.paddingBottom="4px",e}(),i.messageListWrapper=((s=document.createElement("div")).style.width="100%",s.className="mobile-msg-list-wrapper",s.style.boxSizing="border-box",s.style.overflowX="hidden",(0,V.q)(s,!0),s.style.position="absolute",s),i.inputFieldHasFocus=!1,i.messageCounter=0,i.pmMessageCounter=0,i.listenerGroup=new S.mM,i.autocompleteModalCollection=[],i.toBottom=function(){i.scrollToBottom()},(0,d.vP)(i.element,"ChatContents"),l&&(i.element.style.position="relative",i.element.style.height="calc(100% - 40px)"),(0,J.qn)()&&(i.element.style.width="".concat(Math.min((0,K._U)(),(0,K.mP)()),"px")),i.element.style.wordWrap="break-word",i.element.style.bottom="0px",i.messageListWrapper.appendChild(i.noticeList),i.messageListWrapper.appendChild(i.messageList),i.element.appendChild(i.messageListWrapper),i.initInputUI(),i.initEmoticonModal(),i.initUserMentionModal(),i.initCssClasses(),i.toggleInputActionBarDisplay(),(0,m.j9)("submit",i.inputForm,(function(e){e.preventDefault(),i.customInputField.submit()})),(0,m.j9)("focus",i.customInputField.element,(function(e){i.inputFieldHasFocus=!0,q.U9.fire(void 0),(0,W.m7)()&&(i.inputDiv.style.bottom="50px",void 0!==i.userMentionModal&&(i.userMentionModal.element.style.bottom="".concat(X()+50-3,"px")))})),(0,m.j9)("blur",i.customInputField.element,(function(e){i.autocompleteModalCollection.some((function(e){return e.isVisible()}))&&e.cancelable?e.preventDefault():(i.inputFieldHasFocus=!1,q.Ey.fire(void 0),i.toggleInputActionBarDisplay(),(0,W.m7)()&&(i.inputDiv.style.bottom="0",void 0!==i.userMentionModal&&(i.userMentionModal.element.style.bottom="".concat(X()-3,"px"))))}));var c=!1,u=!1,h=new w.d((function(){c=!1}),{bounceLimitMS:50,debounceType:1});(0,m.j9)("scroll",i.messageListWrapper,(function(e){c||(c=!0,u=i.isScrolledUp()),h.callFunc(),!i.isScrolledUp()&&u&&(i.scrolledToBottom.fire(),u=!1)})),(0,m.j9)("keyup",i.element,(function(e){"Enter"===e.key&&i.customInputField.blur()})),g.y.listen((function(e){i.rulesModal=(0,p.vo)((0,a.Z)(i),e),void 0!==i.rulesModal&&i.addChild(i.rulesModal)})).addTo(i.listenerGroup),y.kN.once((function(e){i.currentRoomContext=e,i.messageListWrapper.style.fontSize=e.dossier.userChatSettings.fontSize,i.setLineHeight(),i.listenerGroup.add(f.it.listen((function(){(0,z.y0)(i.messageList,e.dossier.userName)})))}));var v=function(e){i.messageListWrapper.style.fontSize=e.fontSize,i.setLineHeight()};return O.gO.listen(v).addTo(i.listenerGroup),y.QN.listen((function(){O.gO.removeListener(v),i.autocompleteModalCollection.forEach((function(e){return e.dispose()}))})).addTo(i.listenerGroup),q.YL.listen((function(e){i.inputDiv.style.position=e?"absolute":"fixed",i.inputDiv.style.bottom="0"})).addTo(i.listenerGroup),i}return(0,s.Z)(n,[{key:"initInputUI",value:function(){var e,t,n=this;this.inputForm=(e=document.createElement("form"),(0,x.Zs)(e,{height:"100%",display:"flex",alignItems:"center",boxSizing:"border-box",flex:1,overflow:"hidden",position:"relative"}),e),this.inputDiv=(t=document.createElement("div"),(0,d.vP)(t,"inputDiv"),(0,x.Zs)(t,{height:"".concat(X(),"px"),boxSizing:"border-box",position:"absolute",bottom:"0",cursor:"text",borderTopWidth:"".concat(ee,"px"),borderTopStyle:"solid",zIndex:1,display:"flex",alignItems:"center",padding:"8px"}),t);var i,o=this.isPmChatContents?L.jH:L.eq;this.customInputField=function(e,t){var i=new b.t7((function(){return n.sendMessageFromInput()}),t);return i.element.dataset.testid="chat-input",(0,x.Zs)(i,{boxSizing:"border-box",lineHeight:"".concat(24,"px"),minHeight:"".concat(24,"px"),fontSize:"16px",fontFamily:"Tahoma, Arial, Helvetica, sans-serif",WebkitUserSelect:"text",height:""}),i}(0,o),this.inputPlaceholder=(i=document.createElement("span"),(0,d.vP)(i,"placeholder"),i.innerText=D.ag.sendAMessage,(0,x.Zs)(i,{position:"absolute",top:"50%",transform:"translateY(-50%)",pointerEvents:"none",width:"100%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}),i),this.sendButtonRoot=document.createElement("span");var r=h.d.get("SendButton");this.sendButton=new r({onClick:function(){(0,P.fg)("MobileSendButtonClicked",{input:n.customInputField.getText()}),n.customInputField.submit(),n.customInputField.blur()},isPm:this.isPmChatContents,variant:"MobileSplitMode",hidden:!0,highlight:!1},this.sendButtonRoot),I.gH.listen((function(){n.inputForm.style.display="none",window.setTimeout((function(){return n.showInputForm()}),0)})).addTo(this.listenerGroup),(0,B.ZY)()?this.constructActionBarInputUI():(0,T.$)()?this.constructEmphasizedInputUI():this.constructInputUI()}},{key:"constructInputUI",value:function(){this.inputControlsWrapper=te(),this.inputControlsWrapper.appendChild(this.sendButtonRoot);var e={padding:"0px 6px",fontSize:"13px",minHeight:"40px"};this.actionButtonsContainer=document.createElement("div"),(0,x.Zs)(this.actionButtonsContainer,{display:"flex"}),this.inputControlsWrapper.appendChild(this.actionButtonsContainer);var t=new Z.Ug({tipButtonText:D.ag.sendTipButtonText});(0,x.Zs)(t,$($({},e),{},{marginRight:"5px"})),this.actionButtonsContainer.appendChild(t.element);var n=new Z.ZF;(0,x.Zs)(n,$($({},e),{},{marginBottom:""})),this.actionButtonsContainer.appendChild(n.element);var i=new Z.lC({useConciseText:!0});(0,x.Zs)(i,$($({},e),{},{marginBottom:""})),this.actionButtonsContainer.appendChild(i.element),i.displayToggled.listen((function(e){e?n.hideElement():n.getHasFanclub()&&n.showElement()})),this.inputForm.appendChild(this.inputPlaceholder),this.inputForm.appendChild(this.customInputField.element),this.inputDiv.appendChild(this.inputForm),this.inputDiv.appendChild(this.inputControlsWrapper),this.element.appendChild(this.inputDiv),this.bindInputObserver(),this.sendButton.update({hidden:!0}),this.initToggleActionButtons()}},{key:"constructEmphasizedInputUI",value:function(){(0,d.vP)(this.inputForm,"inputForm"),(0,x.Zs)(this.inputForm,{display:"flex",borderWidth:"1px",borderStyle:"solid",borderRadius:"4px",paddingLeft:"8px"}),this.inputControlsWrapper=te(),(0,x.Zs)(this.inputControlsWrapper,{margin:0}),this.actionButtonsContainer=document.createElement("div"),this.inputControlsWrapper.appendChild(this.actionButtonsContainer);var e=new Z.Ug({style:{padding:"0px 6px",fontSize:"13px",minHeight:"40px",marginRight:0,marginLeft:"8px"},tipButtonText:D.ag.sendTipButtonText});this.actionButtonsContainer.appendChild(e.element),this.inputForm.appendChild(this.inputPlaceholder),this.inputForm.appendChild(this.customInputField.element),this.inputForm.appendChild(this.sendButtonRoot),this.inputDiv.appendChild(this.inputForm),this.inputDiv.appendChild(this.inputControlsWrapper),this.element.appendChild(this.inputDiv),this.bindInputObserver(),this.sendButton.update({hidden:!1}),this.initToggleActionButtons()}},{key:"constructActionBarInputUI",value:function(){var e=this;this.inputControlsWrapper=te(),this.inputControlsWrapper.appendChild(this.sendButtonRoot),this.inputForm.appendChild(this.inputPlaceholder),this.actionBar=new H({onSendMessageClick:function(){e.toggleInputActionBarDisplay(),e.customInputField.focus()}}),this.inputForm.appendChild(this.customInputField.element),this.inputDiv.appendChild(this.inputForm),this.inputDiv.appendChild(this.inputControlsWrapper),this.inputDiv.appendChild(this.actionBar.element),this.element.appendChild(this.inputDiv),this.bindInputObserver(),(0,m.j9)("scroll",this.actionBar.element,(function(){void 0!==e.actionBar&&(n.currScrollLeft=e.actionBar.element.scrollLeft)})),ne.listen((function(){e.toggleInputActionBarDisplay()}))}},{key:"initEmoticonModal",value:function(){this.emoticonAutocompleteModal=new k.i(this.customInputField),this.inputDiv.appendChild(this.emoticonAutocompleteModal.element),this.emoticonAutocompleteModal.afterDOMConstructedIncludingChildren(),this.autocompleteModalCollection.push(this.emoticonAutocompleteModal)}},{key:"initUserMentionModal",value:function(){this.isPmChatContents||(this.userMentionModal=this.addChild(new f.AL({inputElement:this.customInputField,leftOffset:10,rightOffset:167,inputDivHeight:X()})))}},{key:"initCssClasses",value:function(){this.isPmChatContents?(this.element.classList.add("MobileChatDivPm"),this.element.dataset.testid="pm-chat-base",this.customInputField.element.classList.add("mobileInputFieldPm"),this.emoticonAutocompleteModal.element.classList.add("mobileEmoticonAutocompleteModalPm")):(this.element.classList.add("MobileChatDivChat"),this.element.dataset.testid="chat-base",this.customInputField.element.classList.add("mobileInputFieldChat"),this.emoticonAutocompleteModal.element.classList.add("mobileEmoticonAutocompleteModalChat"))}},{key:"toggleActionButtons",value:function(){this.inputFieldHasFocus?((0,T.$)()||this.sendButton.update({hidden:!1}),void 0!==this.actionButtonsContainer&&(this.actionButtonsContainer.style.display="none")):((0,T.$)()||this.sendButton.update({hidden:!0}),void 0!==this.actionButtonsContainer&&(this.actionButtonsContainer.style.display="flex"))}},{key:"initToggleActionButtons",value:function(){var e=this;q.U9.listen((function(){e.toggleActionButtons()})).addTo(this.listenerGroup),q.Ey.listen((function(){window.setTimeout((function(){e.toggleActionButtons()}),200)})).addTo(this.listenerGroup)}},{key:"toggleInputActionBarDisplay",value:function(){var e;if(void 0!==this.inputControlsWrapper&&void 0!==this.actionBar&&(0,B.ZY)()){var t=(this.autocompleteModalCollection.some((function(e){return e.isVisible()}))||!0===(null===(e=this.userMentionModal)||void 0===e?void 0:e.isVisible()))&&""!==this.customInputField.getText(),i=this.actionBar.isShown()||t;this.actionBar.setScrollLeft(),n.currScrollLeft=this.actionBar.element.scrollLeft,i?(this.actionBar.hideElement(),this.showInputForm("block"),this.inputControlsWrapper.style.display="flex"):(this.actionBar.showElement(),this.inputForm.style.display="none",this.inputControlsWrapper.style.display="none")}}},{key:"bindInputObserver",value:function(){var e=this;new MutationObserver((function(t){t.forEach((function(){var t=e.customInputField.getText();t.length>0?e.inputPlaceholder.style.display="none":e.inputPlaceholder.style.display="block",t.trim().length<=0?e.sendButton.update({highlight:!1}):e.sendButton.update({highlight:!0})}))})).observe(this.customInputField.element,{characterData:!0,subtree:!0,childList:!0})}},{key:"showInputForm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"inline-block";this.inputForm.style.display=(0,T.$)()?"flex":e}},{key:"setLineHeight",value:function(){var e=Number(this.messageListWrapper.style.fontSize.slice(0,-2));this.messageListWrapper.style.lineHeight="".concat(e+7,"pt")}},{key:"shouldSendMessageFromInput",value:function(){return!(0,v.Cg)('You must be logged in to send a message. Click "OK" to login.')}},{key:"sendMessageFromInput",value:function(){if(!this.shouldSendMessageFromInput())return!1;this.scrollToBottom();var e=this.customInputField.getText();return""!==e.trim()&&this.processMessage(e),!0}},{key:"processMessage",value:function(e){var t=(0,E.DO)(e);switch(t.messageType){case 2:this.outgoingHandlers.onToggleDebugMode();break;case 1:this.customInputField.clearText();var n=t;this.outgoingHandlers.onTipRequest(n.messageData);break;default:this.outgoingHandlers.onChatMessage(e)}}},{key:"repositionChildren",value:function(){this.inputFieldHasFocus&&!(0,J.gr)()&&this.customInputField.blur(),this.element.style.width="".concat((0,K._U)(),"px"),this.inputDiv.style.width="".concat((0,K._U)(),"px"),this.emoticonAutocompleteModal.element.style.bottom="".concat(this.inputDiv.offsetHeight-8,"px"),this.isScrolledUp()||this.scrollToBottom()}},{key:"isScrolledUp",value:function(){return this.messageListWrapper.scrollTop<=this.messageListWrapper.scrollHeight-(this.messageListWrapper.offsetHeight+20)}},{key:"scrollToBottom",value:function(){this.isScrolledUp()&&this.scrolledToBottom.fire(),this.messageListWrapper.scrollTop=this.messageListWrapper.scrollHeight-this.messageListWrapper.offsetHeight-1}},{key:"cloneClickListeners",value:function(e,t){for(var n=0;n<e.children.length;n+=1)this.cloneClickListeners(e.children[n],t.children[n]);t.onclick=e.onclick}},{key:"appendNoticeDiv",value:function(e){return e.style.fontSize="",this.noticeList.appendChild(e),e}},{key:"appendMessageDiv",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this.isScrolledUp();o||e.querySelectorAll("img").forEach((function(e){var n=e.src;e.src="",e.onload=t.toBottom,e.src=n})),e.style.fontSize="",e.style.lineHeight="",n?this.messageList.prepend(e):(0,R.ZA)(e,this.messageList);for(var r=this.messageList.childElementCount-1e3;r>0;r-=1){var s=this.messageList.firstElementChild;null!==s&&this.messageList.removeChild(s)}return o||this.scrollToBottom(),this.addMessageHTMLEvent.fire({makeByCloning:function(){var n=e.cloneNode(!0);return t.cloneClickListeners(e,n),n}}),i&&(this.pmMessageCounter+=1),this.messageCounter+=1,e}},{key:"removeMessageDiv",value:function(e){this.messageList.removeChild(e)}},{key:"getLastMessageId",value:function(){return this.messageCounter}},{key:"getPmMessageCount",value:function(){return this.pmMessageCounter}},{key:"getEarliestMessageId",value:function(){return this.earliestMessageId}},{key:"getActionBar",value:function(){return this.actionBar}},{key:"setEarliestMessageId",value:function(e){this.earliestMessageId=e}},{key:"messagesSinceId",value:function(e){return this.messageCounter-e}},{key:"handleRemoveMessages",value:function(e){var t,n=[],i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(this.messageList.childNodes);try{for(i.s();!(t=i.n()).done;){var o=t.value;o.getAttribute("data-nick")===e&&n.push(o)}}catch(e){i.e(e)}finally{i.f()}for(var r=0,s=n;r<s.length;r++){var a=s[r];this.messageList.removeChild(a)}this.removeMessagesForUserEvent.fire(e)}},{key:"clear",value:function(){for(this.messageCounter=0;null!==this.messageList.firstChild;)this.messageList.removeChild(this.messageList.firstChild)}},{key:"dispose",value:function(){var e,t;this.emoticonAutocompleteModal.dispose(),this.listenerGroup.removeAll(),this.customInputField.dispose(),null===(e=this.rulesModal)||void 0===e||e.dispose(),null===(t=this.userMentionModal)||void 0===t||t.dispose()}}]),n}(C.w);ie.currScrollLeft=0;var oe=function(e){(0,l.Z)(n,e);var t=Q(n);function n(e){var i,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,r.Z)(this,n),(i=t.call(this,e,o)).outgoingHandlers=e,i.isPmChatContents=o,i.initShortcodeModal(),i}return(0,s.Z)(n,[{key:"initShortcodeModal",value:function(){this.shortcodeAutocompleteModal=new A.B(this.customInputField,this.isPmChatContents),this.inputDiv.appendChild(this.shortcodeAutocompleteModal.element),this.shortcodeAutocompleteModal.afterDOMConstructedIncludingChildren(),this.autocompleteModalCollection.push(this.shortcodeAutocompleteModal)}},{key:"repositionChildren",value:function(){(0,i.Z)((0,u.Z)(n.prototype),"repositionChildren",this).call(this),this.shortcodeAutocompleteModal.element.style.bottom="".concat(this.inputDiv.offsetHeight-8,"px")}},{key:"processMessage",value:function(e){var t=(0,E.DO)(e);switch(t.messageType){case 3:var o=t;if(this.isPmChatContents){this.appendMessageDiv((0,z.KS)(D.ag.shortcodeNotSupportedInPMs));break}if(0===o.shortcodes.length){var r=E.uF.errorBehindShortcode(e);this.appendMessageDiv((0,z.KS)(r,"shortcodeInvalidError"));break}void 0!==this.outgoingHandlers.onShortcode&&this.outgoingHandlers.onShortcode(o);break;default:return(0,i.Z)((0,u.Z)(n.prototype),"processMessage",this).call(this,e)}}},{key:"dispose",value:function(){(0,i.Z)((0,u.Z)(n.prototype),"dispose",this).call(this),this.shortcodeAutocompleteModal.dispose()}}]),n}(ie)},8071:function(e,t,n){"use strict";n.d(t,{e:function(){return k}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(8759),c=n(2800),u=n(1522),d=n(9),h=n(1794),f=n(9598),p=n(9271),m=n(3543),v=n(47),g=n(3243),y=n(1185),b=n(1612),w=n(6132),C=n(7693);var x=function(e){(0,r.Z)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function c(){return(0,i.Z)(this,c),l.apply(this,arguments)}return(0,o.Z)(c,[{key:"lazyInitUI",value:function(){var e=this;(0,y.vP)(this.element,"notificationsModal"),this.element.style.width="",this.element.style.height="",this.overlay.style.opacity="0.5",this.overlay.style.background="#000000";var t=function(){var e=document.createElement("div");return e.style.position="relative",e.style.height="",e.style.width="264px",e.style.backgroundColor="#e0e0e0",e.style.padding="6px 12px",e.style.borderRadius="3px",e.style.marginLeft="0px",e.style.marginTop="11px",e.style.fontSize="12.012px",e.style.color=b.w.defaultColor,e.style.overflow="",e.style.lineHeight="16.8px",e}(),n=(0,w.sP)(),i=(0,w.x5)(),o=(0,w.pw)((function(){e.onConfirmClick(),e.close()})),r=(0,w.fb)((function(){e.onDenyClick(),e.close()}));t.appendChild(n),t.appendChild(i),t.appendChild(o),t.appendChild(r),this.element.appendChild(t);var s=function(){e.resize()};(0,C.j9)("resize",window,s),this.closed.once((function(){try{(0,C.SC)("resize",window,s)}catch(e){debug("NotificationsModal resize listener was already removed")}})),(0,g.Z)((0,a.Z)(c.prototype),"lazyInitUI",this).call(this)}},{key:"afterDOMConstructedIncludingChildren",value:function(){(0,g.Z)((0,a.Z)(c.prototype),"afterDOMConstructedIncludingChildren",this).call(this),this.resize()}},{key:"resize",value:function(){this.element.style.left="".concat(Math.max(0,(window.innerWidth-this.element.offsetWidth)/2),"px"),this.element.style.top="".concat(Math.max(0,(window.innerHeight-this.element.offsetHeight)/2),"px")}}]),c}(w.s6);var k=function(e){(0,r.Z)(g,e);var t,n,d=(t=g,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function g(){return(0,i.Z)(this,g),d.call(this)}return(0,o.Z)(g,[{key:"initData",value:function(){var e=this;this.followStateChanged=new h.xB("followStateChanged"),this.isFollowingUpdate=new p.I(!1,this.setIsFollowing.bind(this),(function(){var t=e.isFollowing?m.ag.errorUnfollowingUser(e.roomName):m.ag.errorFollowingUser(e.roomName);(0,u.Cj)(t)}))}},{key:"initUI",value:function(){var e=this;this.followButton=(0,v.vz)(S,{onClick:function(){e.handleFollowAndUnfollow()}}),this.unfollowButton=(0,v.vz)(T,{onClick:function(){e.onUnfollowClick()}}),this.element=(0,v.vz)("div",{colorClass:"FollowButton",style:{cssFloat:"left"}},this.followButton,this.unfollowButton),f.wk.listen((function(t){t.roomName===e.roomName&&e.updateContext(e.roomName,t.following)}))}},{key:"onUnfollowClick",value:function(){var e=this;(0,u.oB)(m.ag.unfollowInfo,(function(){e.handleFollowAndUnfollow()}),void 0,{title:"".concat(m.ag.unfollowText," ").concat(this.roomName,"?"),acceptText:"".concat(m.ag.yes,", ").concat(m.ag.unfollowLower),declineText:"".concat(m.ag.no,", ").concat(m.ag.cancelLower)})}},{key:"updateFollowButtonDisplay",value:function(e){this.followButton.style.display=this.isFollowing?"none":"flex",this.unfollowButton.style.display=this.isFollowing?"flex":"none",this.followStateChanged.fire({isFollowing:this.isFollowing,isPending:e})}},{key:"updateContext",value:function(e,t){this.roomName=e,this.isFollowing=t,this.updateFollowButtonDisplay()}},{key:"showBrowserNotification",value:function(){var e=this;if(void 0!==c.J.current.loggedInUser){var t=window.isBrowserNotificationSupported,n=window.isSubscribedToBrowserNotifications;if(void 0!==t&&!0===t()&&void 0!==n&&(0,l.IU)()){var i=new x;i.canRequestPermission()&&n(!1,(function(){e.addChild(i,document.body),i.closed.once((function(){e.removeChild(i)}))}))}}}},{key:"handleFollowAndUnfollow",value:function(){var e=void 0===c.J.current.loggedInUser;this.isFollowing||this.showBrowserNotification();var t=(this.isFollowing?f.c5:f.kr)(this.roomName,f.wk,e,"FollowButton");void 0!==t&&this.isFollowingUpdate.dispatch(!this.isFollowing,t)}},{key:"setIsFollowing",value:function(e,t){this.isFollowing=e,this.updateFollowButtonDisplay(t)}}]),g}(d.w),S=function(e){return(0,v.vz)("div",{colorClass:"follow",style:{display:"none",borderWidth:"1px",borderStyle:"solid",boxSizing:"border-box",borderRadius:"4px",marginRight:"4px",padding:"0 8px",justifyContent:"center",alignItems:"center"},onClick:e.onClick},(0,v.vz)("span",{className:"icon_not_following no_hover",style:{position:"relative",padding:"2px 3px 1px 0px",marginLeft:"-6px",height:"29px",width:"29px",backgroundSize:"28px 28px",display:"inline-block",verticalAlign:"middle"}}),(0,v.vz)("span",{style:{display:"inline-block",verticalAlign:"middle"}},m.ag.followText))},T=function(e){return(0,v.vz)("div",{colorClass:"unfollow",style:{display:"none",borderWidth:"1px",borderStyle:"solid",boxSizing:"border-box",borderRadius:"4px",marginRight:"4px",justifyContent:"center",alignItems:"center"},onClick:e.onClick},(0,v.vz)("span",{className:"icon_following no_hover",style:{position:"relative",padding:"2px 4px 1px 4px",height:"29px",width:"29px",backgroundSize:"28px 28px"}}))}},5253:function(e,t,n){"use strict";n.d(t,{N:function(){return d},P:function(){return u}});var i=n(4649),o=n(2951),r=n(1976);function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw r}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u=function(){function e(t){(0,o.Z)(this,e),this.individualConstraints={top:0,bottom:0,left:0,right:0,transitionTime:0},this.boundingConstraints={top:0,bottom:0,left:0,right:0,transitionTime:0},this.onUpdate=function(){},this.onAttach=function(){},this.ID=t}return(0,r.Z)(e,[{key:"top",value:function(){return this.boundingConstraints.top}},{key:"bottom",value:function(){return this.boundingConstraints.bottom}},{key:"left",value:function(){return this.boundingConstraints.left}},{key:"right",value:function(){return this.boundingConstraints.right}},{key:"transitionTime",value:function(){return this.boundingConstraints.transitionTime}},{key:"setConstraints",value:function(e){var t=this;void 0===this.handler?this.onAttach=function(){t.updateConstraints(e)}:this.updateConstraints(e),this.individualConstraints=e}},{key:"updateConstraints",value:function(e){void 0!==this.handler&&this.handler.updateConstraints(c({ID:this.ID},e))}},{key:"setOnUpdate",value:function(e){this.onUpdate=e}},{key:"getIndividualConstraints",value:function(){return this.individualConstraints}},{key:"attach",value:function(e){this.handler=e,this.onAttach()}},{key:"detach",value:function(){this.handler=void 0}},{key:"update",value:function(e){this.boundingConstraints=e,this.onUpdate()}}]),e}(),d=function(){function e(){(0,o.Z)(this,e),this.constraintsMap=new Map,this.listeners=[]}return(0,r.Z)(e,[{key:"addListener",value:function(e){this.listeners.push(e),e.attach(this),this.updateConstraints(c({ID:e.ID},e.getIndividualConstraints()))}},{key:"removeListener",value:function(e){var t=this.listeners.indexOf(e);t>=0&&(this.listeners.splice(t,1),this.constraintsMap.delete(e.ID),e.detach(),this.notifyListeners())}},{key:"updateConstraints",value:function(e){this.constraintsMap.set(e.ID,e),this.notifyListeners()}},{key:"calculateTotalConstraints",value:function(){var e,t={top:0,bottom:0,left:0,right:0,transitionTime:0},n=s(this.constraintsMap.values());try{for(n.s();!(e=n.n()).done;)for(var i=e.value,o=0,r=Object.keys(t);o<r.length;o++){var a=r[o];t[a]+=i[a]}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"notifyListeners",value:function(){var e,t=this.calculateTotalConstraints(),n=s(this.listeners);try{for(n.s();!(e=n.n()).done;){var i=e.value,o=this.constraintsMap.get(i.ID);if(void 0!==o){for(var r=c({},t),a=0,l=Object.keys(r);a<l.length;a++){var u=l[a];r[u]-=o[u]}i.update(r)}else error("A LayoutConstraintHandler's listener does not exist in its constraints map")}}catch(e){n.e(e)}finally{n.f()}}}]),e}()},1177:function(e,t,n){"use strict";n.d(t,{M:function(){return m}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(1194),c=n(9),u=n(8263),d=n(1794),h=n(2239),f=n(3543),p=n(3607);var m=function(e){(0,r.Z)(m,e);var t,n,c=(t=m,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function m(e,t,n,o){var r;if((0,i.Z)(this,m),(r=c.call(this)).width=(0,p.RK)().width,r.transitionMS=300,r.backLabelClicked=new d.xB("backLabelClicked"),(0,u.Zs)(r.element,{backgroundColor:"#ffffff",top:"0",bottom:"0",zIndex:1,visibility:"visible",position:"relative"}),!0===n){(0,u.Zs)(r.element,{position:"absolute",visibility:"hidden",right:"-100%",width:"100%"});var s=document.createElement("div");new(l.d.get("MenuLabel"))({onClick:function(){r.hide(),r.backLabelClicked.fire(void 0)},text:void 0!==o?o:f.ag.backToRoomMenu,showChevron:!0,isBackLabel:!0},s),r.element.appendChild(s)}return(0,h.pS)(r.element,"right ".concat(r.transitionMS,"ms ease-in-out")),void 0!==t&&r.addChild(t),r}return(0,o.Z)(m,[{key:"show",value:function(){this.element.style.visibility="visible",this.element.style.right="0"}},{key:"hide",value:function(){this.element.style.right="-100%"}}]),m}(c.w)},202:function(e,t,n){"use strict";n.d(t,{Ht:function(){return P},J6:function(){return T},KS:function(){return E},PJ:function(){return L},d$:function(){return S},mp:function(){return B},rL:function(){return O},y0:function(){return I}});var i,o,r=n(8759),s=n(1185),a=n(5712),l=n(2800),c=n(8626),u=n(3753),d=n(4793),h=n(2359),f=n(5726),p=n(3705),m=n(3544),v=n(7201),g=n(9482),y=n(1392),b=n(3543),w=n(4043),C=n(3797);function x(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function S(e,t){var n=(0,f.aP)(e.fromUser.username),i=(0,f.t)();i.style.padding="0";var o=(0,C.W)(e.fromUser,e);o.dataset.testid="chat-message-username",o.style.paddingRight="4px",h.p.setMessageColorData(o,(0,g.kD)(e.fromUser)),i.appendChild(o),i.style.marginRight="4px";var s=(0,v.F$)(e.message);s.dataset.testid="chat-message-text";var a=void 0!==e.textColor?e.textColor:"#000000";return s.style.color=a,void 0!==e.font&&(o.style.fontFamily=e.font,s.style.fontFamily=e.font),h.p.setMessageColorData(s,(0,f.Q0)(a)),void 0!==e.backgroundColor&&(i.style.background=e.backgroundColor),i.appendChild(s),I(s,t),n.appendChild(i),(0,r.IF)()||twemoji.parse(n,{className:"emojiChat"}),(0,f.yY)(e,n),n}function T(e,t){var n=(0,f.aP)(),s=document.createElement("div");if(s.style.display="inline-block",s.dataset.testid="room-notice",void 0!==e.background)s.style.background=e.background,s.style.padding="2px",s.style.textShadow="none";else{var a=(0,f.Q0)(void 0!==e.foreground?e.foreground:"#aaaaaa");h.p.setMessageColorData(s,a)}return s.style.color=void 0!==e.foreground?e.foreground:"#000000",s.style.fontWeight=void 0!==e.weight?e.weight:"normal",n.appendChild(function(e,t,n){var r,s,a,l,c=x(t);try{for(c.s();!(r=c.n()).done;){var d,h=r.value,f=document.createElement("div"),p=x(h);try{for(p.s();!(d=p.n()).done;){var v=d.value;switch(v.partType){case 1:f.appendChild(R(v,n));break;case 0:f.appendChild((0,C.W)(v.user));break;case 2:f.appendChild((s=v.message,a=void 0,l=void 0,(l=document.createElement("a")).href=(0,u.BN)("/tag/".concat(s,"/").concat(null!==(a=i)&&void 0!==a?a:"")),l.style.color="#0a5a83",l.style.textDecoration="none",l.innerText="#".concat(s),l));break;case 3:f.appendChild(A("spy private show",(function(){"privatespying"!==o.status&&(0,m.Cd)(o)})));break;default:error("Unknown roomNotice type for: ".concat(v))}}}catch(e){p.e(e)}finally{p.f()}e.appendChild(f)}}catch(e){c.e(e)}finally{c.f()}return e}(s,e.messages,e.shortcodes)),I(n,t),(0,r.IF)()||twemoji.parse(n,{className:"emojiChat"}),void 0!==e.ts&&(n.dataset.ts=e.ts.toString()),n}function I(e,t){var n,i=e.querySelectorAll(".username-mention"),o=[],r=a.n.getInstance(),l=r.users(),c=x(i);try{var u=function(){var e=n.value,i=e.innerText.replace("@","").toLowerCase(),r=l.find((function(e){return e.username===i}));if(void 0!==r){var a,c=(0,C.W)(r,void 0,!1,!0);t===r.username&&(c.style.padding="2px",(0,s.vP)(c,"mentionHl")),null===(a=e.parentElement)||void 0===a||a.replaceChild(c,e),c.insertAdjacentText("afterend"," ")}else o.push(i)};for(c.s();!(n=c.n()).done;)u()}catch(e){c.e(e)}finally{c.f()}r.addInvalidUsers(o)}function R(e,t){if((0,c.vj)()&&void 0!==e.message&&t&&y.uF.isShortcodeSyntax(e.message))return(0,v.rP)(e,t,M,w.Fx);if(!1!==e.parseEmoticon)return(0,v.F$)(e.message);var n=document.createElement("span");return n.innerText=e.message,n}function P(e){var t=(0,f.aP)(e.fromUser.username),n=(0,f.t)();n.style.padding="0";var i=(0,C.W)(e.fromUser,e);i.style.paddingRight="4px",h.p.setMessageColorData(i,(0,g.kD)(e.fromUser)),n.appendChild(i),n.style.marginRight="4px",void 0!==e.backgroundColor&&(n.style.background=e.backgroundColor);var o=(0,v.Mg)(e,M,w.Fx);return void 0!==e.font&&(i.style.fontFamily=e.font,o.style.fontFamily=e.font),o.style.textShadow="rgb(51, 51, 51) 0.2px 0.2px 0px",n.appendChild(o),t.appendChild(n),(0,f.yY)(e,t),t}function M(e,t,n){var i=A(e,n);return i.dataset.messagetype="shortcode",void 0!==t&&""!==t&&(i.href=(0,u.BN)(t),i.target="_blank"),i}function A(e,t){var n=document.createElement("a");return n.style.color="#0a5a83",n.style.textDecoration="underline",n.innerText=e,n.onclick=t,n}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=(0,f.aP)();return t&&(n.dataset.testid=t),n.innerText=e,n.style.color="#000000",h.p.setMessageColorData(n,(0,f.Q0)("#aaaaaa")),n}function B(e,t){function n(e){var t=document.createElement("span");return t.innerText=e,t}var i=(0,f.aP)(),o=t?b.ag.pmSupporterNoticeAgeVerified:b.ag.pmSupporterNotice;i.appendChild(n(o)),i.appendChild(document.createElement("br")),i.appendChild(n("".concat(b.ag.pmSupporterSignUp," ")));var r=A(b.ag.pmSupporterMembership,(function(){}));return r.href=(0,u.BN)("/supporter/upgrade/?source=".concat(l.J.current.PurchaseEventSources.SUPPORTER_SOURCE_PM_UPSELL)),r.target="_blank",r.onclick=function(){(0,p.fg)("SupporterPageOpened",{source:"chat"})},i.appendChild(r),i.appendChild(n(" ".concat(b.ag.pmSupporterSendPm(e),"."))),i}function L(e,t){var n=(0,f.aP)(e);return n.innerText=e,n.appendChild(t),n.style.color="#000000",h.p.setMessageColorData(n,(0,f.Q0)("#aaaaaa")),n}function O(e){var t=(0,f.aP)();return e.renderTo(t)}d.kN.listen((function(e){i=e.dossier.roomGender,o=e.chatConnection}))},3112:function(e,t,n){"use strict";n.d(t,{Ap:function(){return a},H4:function(){return r},ct:function(){return s},h4:function(){return o},pF:function(){return l},uh:function(){return d},vz:function(){return c},zy:function(){return u}});var i=n(1794),o=new i.xB("MobileVideoControls:tap"),r=new i.xB("MobilePureChat:tap"),s=new i.xB("MobilePureChat:drag"),a=new i.xB("MobilePureChat:dragEnd"),l=new i.xB("MobileFullscreenSendChat"),c=new i.xB("MobilePlayer:Resize"),u=new i.xB("MobilePlayer:changeSize"),d=new i.xB("mobilePMChatLinkFullscreenToggle")},7122:function(e,t,n){"use strict";n.d(t,{i:function(){return E}});var i=n(4649),o=n(2951),r=n(1976),s=n(3243),a=n(7591),l=n(9492),c=n(7597),u=n(6474),d=n(6832),h=n(2800),f=n(1612),p=n(7693),m=n(695),v=n(4793),g=n(9493),y=n(9),b=n(8263),w=n(3705),C=n(6479),x=n(9482),k=n(3543),S=n(47),T=n(9420),I=n(2923);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var E=function(e){(0,a.Z)(n,e);var t=A(n);function n(e){return(0,o.Z)(this,n),t.call(this,"div",e)}return(0,r.Z)(n,[{key:"initData",value:function(e){this.openConversationEvent=e.openConversationEvent,this.room="",this.startedTimeUpdates=!1,this.onItemRemoved=e.onItemRemoved,this.isDropdown=e.isDropdown,this.searchBar=e.searchBar,(0,m.TF)()||(this.conversationListData=d.zS.getInstance())}},{key:"initUI",value:function(e){var t=this;(0,b.Zs)(this.element,{position:"relative",overflowX:"hidden",overflowY:"scroll"}),this.isDropdown?(this.emptyListMessage=(0,S.vz)(D,null),this.element.appendChild(this.emptyListMessage)):T.sC.listen((function(e){var n,i=null===(n=t.conversationListData)||void 0===n?void 0:n.getConversation(e.username);void 0!==i&&t.updateList(i)})),v.kN.once((function(){(0,I.q)(t.element)})),v.kN.listen((function(e){var n;t.room=e.chatConnection.room(),t.isDropdown?t.updateUserColors():(t.clearItems(),(null===(n=h.J.current.loggedInUser)||void 0===n?void 0:n.username)!==t.room&&t.addBroadcasterToTop())})),d.zS.conversationDataChanged.listen((function(){(0,m.TF)()||void 0!==t.conversationListData||(t.conversationListData=d.zS.getInstance())})),d.zS.conversationItemAdded.listen((function(e){t.isDropdown&&""!==e.room||!t.isDropdown&&""===e.room||t.updateList(e)})),d.zS.conversationRead.listen((function(e){var n=e.username;e.isDm===t.isDropdown&&t.markItemRead(n)})),this.startTimeContainerUpdates(),void 0!==this.searchBar&&this.initSearchBarListeners(this.searchBar)}},{key:"initSearchBarListeners",value:function(e){var t=this;(0,p.j9)("touchstart",window,(function(t){var n=e.getInput();document.activeElement===n&&t.target!==n&&n.blur()})),this.openConversationEvent.listen((function(){t.filterConversations("")})),e.events.inputChange.listen((function(e){e.isValid?t.filterConversations(e.prefix):t.clearItems()}))}},{key:"filterConversations",value:function(e){var t=this;void 0!==this.conversationListData&&(this.clearItems(),(this.isDropdown?this.conversationListData.getDms():this.conversationListData.getPms()).filter((function(t){return 0===e.length||t.otherUser.username.startsWith(e)})).reverse().forEach((function(e){t.updateList(e)})))}},{key:"updateList",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];void 0!==this.emptyListMessage&&this.element.contains(this.emptyListMessage)&&this.element.removeChild(this.emptyListMessage);var i=this.findItem(e.otherUser.username);void 0!==i?(i.updateItem(e),d.wV.isHiding(e.otherUser.username)&&this.addChild(i)):(i=new B({conversationListItem:e,onClick:function(){t.openConversationEvent.fire(e.otherUser.username)},onCloseButtonClick:function(){t.removeItem(e.otherUser.username)},isDropdown:this.isDropdown}),this.addChild(i),(0,w.fg)("PmListItemAdded",{rendered_pm_count:this.getAllItems().length,other_user:e.otherUser.username})),d.wV.remove(e.otherUser.username),n&&this.moveToTop(i)}},{key:"updateUserColors",value:function(){var e,t=this;this.isDropdown&&(null===(e=this.conversationListData)||void 0===e||e.getDms().forEach((function(e){var n=t.findItem(e.otherUser.username);void 0!==n&&n.updateColors(e.otherUser)})))}},{key:"moveToTop",value:function(e){this.isDropdown?null!==this.element.firstChild?this.element.insertBefore(e.element,this.element.firstChild):this.element.appendChild(e.element):null!==this.element.firstChild&&null!==this.element.firstChild.nextSibling?this.element.insertBefore(e.element,this.element.firstChild.nextSibling):this.element.appendChild(e.element)}},{key:"findItem",value:function(e){return this.getAllItems().find((function(t){return t.getItemInfo().otherUser.username===e}))}},{key:"markItemRead",value:function(e){var t=this.findItem(e);void 0!==t&&t.setReadStyle()}},{key:"addBroadcasterToTop",value:function(){var e,t,n=this,i=null!==(e=null===(t=this.conversationListData)||void 0===t?void 0:t.getConversation(this.room))&&void 0!==e?e:(0,u.rw)(this.room),o=this.findItem(this.room);void 0===o&&(o=new B({conversationListItem:i,onClick:function(){n.openConversationEvent.fire(n.room)},onCloseButtonClick:function(){n.removeItem(i.otherUser.username)},isDropdown:this.isDropdown})),this.getAllItems().length>0?this.addChildBefore(o,this.getAllItems()[0]):this.addChild(o)}},{key:"getAllItems",value:function(){return(0,s.Z)((0,c.Z)(n.prototype),"children",this).call(this)}},{key:"getNumUnread",value:function(){return this.getAllItems().filter((function(e){return e.getItemInfo().numUnread>0})).length}},{key:"removeItem",value:function(e){var t=this.findItem(e);void 0!==t&&this.element.contains(t.element)&&(this.removeChild(t),d.wV.hide(e),this.onItemRemoved(t.getItemInfo().otherUser.username),(0,w.fg)("PmListItemRemoved",{rendered_pm_count:this.getAllItems().length,other_user:e}))}},{key:"clearItems",value:function(){this.removeAllChildren()}},{key:"startTimeContainerUpdates",value:function(){var e=this;this.startedTimeUpdates||(this.startedTimeUpdates=!0,window.setInterval((function(){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(e.getAllItems());try{for(n.s();!(t=n.n()).done;)t.value.setTimestamp()}catch(e){n.e(e)}finally{n.f()}}),1e4))}}]),n}(y.w),B=function(e){(0,a.Z)(n,e);var t=A(n);function n(e){return(0,o.Z)(this,n),t.call(this,"div",e)}return(0,r.Z)(n,[{key:"initData",value:function(e){this.conversationListItem=e.conversationListItem}},{key:"initUI",value:function(e){var t=this;this.replyIcon=(0,S.vz)(L,null),this.closeButton=(0,S.vz)("img",{src:"".concat(STATIC_URL_MOBILE,"close.svg"),style:{width:"18px",height:"18px",display:"inline-block"},onClick:e.onCloseButtonClick}),this.avatarBubble=(0,S.vz)(O,{name:e.conversationListItem.otherUser.username,userColorClass:(0,x.c9)(e.conversationListItem.otherUser)}),this.element=(0,S.vz)("div",{style:{width:"100%",height:"90px",boxSizing:"border-box",borderBottom:"1px solid #EFEFEF",padding:"20px",fontSize:"12px",display:"flex",alignItems:"center",fontFamily:"Tahoma, Arial, Helvetica, sans-serif"},ref:function(e){return t.containerElement=e}},(0,S.vz)("div",{style:{display:"flex",flex:1,alignItems:"center"},onClick:e.onClick},this.avatarBubble,(0,S.vz)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",width:"100%",height:"100%"}},(0,S.vz)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"}},(0,S.vz)("span",{style:{display:"block",fontWeight:"bold",marginBottom:"5px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",flex:1,width:0,marginRight:"10px"},colorClass:(0,x.c9)(e.conversationListItem.otherUser),ref:function(e){t.usernameLabel=e}},e.conversationListItem.otherUser.username),(0,S.vz)("span",{style:{color:"#6C6C78"},ref:function(e){t.timestampElement=e}})),(0,S.vz)("span",{style:{display:"flex"}},this.replyIcon,(0,S.vz)("span",{style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",flex:"1",width:"0px"},ref:function(e){t.msgElement=e}})))),!e.isDropdown&&(0,S.vz)("div",{style:{width:"18px",height:"18px",marginLeft:"20px"}},!e.conversationListItem.otherUser.isBroadcaster&&this.closeButton)),this.updateItem(e.conversationListItem)}},{key:"updateItem",value:function(e){this.conversationListItem=e,this.setReplyIcon(),this.setMessage(),this.setTimestamp(),this.conversationListItem.numUnread>0?this.setUnreadStyle():this.setReadStyle()}},{key:"updateColors",value:function(e){var t=(0,x.c9)(e);this.usernameLabel.className=t,this.avatarBubble.firstChild instanceof HTMLElement&&(this.avatarBubble.firstChild.className=t)}},{key:"getItemInfo",value:function(){return this.conversationListItem}},{key:"setReplyIcon",value:function(){var e=this.isReply()&&!this.isEmptyMessage();this.replyIcon.style.display=e?"block":"none"}},{key:"setMessage",value:function(){null!==this.msgElement.firstChild&&this.msgElement.removeChild(this.msgElement.firstChild),""!==this.conversationListItem.message?this.msgElement.appendChild(this.renderConversationEmoticons(this.conversationListItem.message)):this.conversationListItem.hasMedia&&this.msgElement.appendChild((0,S.vz)("span",null,k.ag.imageAttached))}},{key:"setTimestamp",value:function(){if(!this.isEmptyMessage()){var e=this.conversationListItem.time,t=void 0===e?"":(0,g.ek)(new Date(e));this.timestampElement.innerText="".concat(t)}}},{key:"renderConversationEmoticons",value:function(e){var t=new C.w(e),n=(0,S.vz)("span",null),i=t.stringParts()[0];n.innerText=i.split("\n")[0];for(var o=1;o<t.stringParts().length;o+=1){var r=(0,S.vz)("span",null);if(r.innerText=":".concat(t.emoticons()[o-1].name),n.appendChild(r),""!==t.stringParts()[o]){var s=(0,S.vz)("span",null);s.innerText=t.stringParts()[o],n.appendChild(s)}}return n}},{key:"isReply",value:function(){return this.conversationListItem.otherUser.username!==this.conversationListItem.fromUsername}},{key:"isEmptyMessage",value:function(){return""===this.conversationListItem.message&&!this.conversationListItem.hasMedia}},{key:"setReadStyle",value:function(){this.containerElement.style.backgroundColor="#FFF"}},{key:"setUnreadStyle",value:function(){this.containerElement.style.backgroundColor="#FCEADC"}}]),n}(y.w),L=function(){return(0,S.vz)("img",{src:"".concat(STATIC_URL_MOBILE,"reply-icon.svg")})},O=function(e){return(0,S.vz)("div",{colorClass:"avatarBubble",style:P(P({},{position:"relative"}),e.style)},(0,S.vz)("div",{colorClass:e.userColorClass,style:{width:"45px",height:"45px",borderRadius:"50%",textAlign:"center",color:"#FFF",display:"flex",justifyContent:"center",alignItems:"center",fontFamily:"UbuntuLight, Tahoma, Arial, Helvetica, sans-serif",fontSize:"20px",margin:"auto 10px auto auto",verticalAlign:"middle"}},e.name.charAt(0).toLocaleUpperCase()))},D=function(){return(0,S.vz)("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",lineHeight:"20px",padding:"50px",boxSizing:"border-box",fontSize:"12px",fontFamily:"UbuntuRegular, Helvetica, Arial, sans-serif"}},(0,S.vz)("img",{src:"".concat(STATIC_URL_MOBILE,"empty-chat-state.svg"),style:{margin:"13px",width:"30px"},alt:"empty-chat-state"}),(0,S.vz)("span",{style:{fontFamily:"UbuntuBold, Arial, Helvetica, sans-serif",fontSize:"14px"}},k.ag.sendDirectMessage),(0,S.vz)("span",null,k.ag.conversationCautionMessage(f.w.siteName)))}},5406:function(e,t,n){"use strict";n.d(t,{H:function(){return T},w:function(){return S}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(8626),c=n(7693),u=n(8069),d=n(1794),h=n(1625),f=n(2359),p=n(5726),m=n(2239),v=n(5253),g=n(3112),y=n(2923),b=n(3607),w=n(3682);function C(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var k=21,S=new d.xB("mobilePureChatChange"),T=function(e){(0,r.Z)(x,e);var t,n,d=(t=x,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function x(e){var t;(0,i.Z)(this,x),(t=d.call(this,e)).isVisible=!1,t.desiredPortraitHeight=t.deviceLength()/4,t.desiredLandscapeWidth=t.deviceLength()/4,t.portraitHeight=t.deviceLength()/4,t.landscapeWidth=t.deviceLength()/4,t.isIndicatorVisible=!1,t.backgroundDelay=0,t.heightDuration=0,t.widthDuration=0,t.layoutConstraints=new v.P(t.constructor.name),t.inputFocusOffset=0,t.element.style.position="absolute",t.element.style.fontSize="10px",t.element.style.textShadow="1px 0 1px #000, -1px 0 1px #000, 0 -1px 1px #000, 0 1px 1px #000",t.element.style.bottom="".concat(56,"px"),t.element.style.overflow="visible",t.innerDiv.style.position="",(0,y.q)(t.innerDiv,!0),t.innerDiv.style["-webkit-text-size-adjust"]="none",t.innerDiv.style.overflowX="hidden",t.innerDiv.style.height="100%",t.createResizeDragDiv(),t.element.appendChild(t.resizeDragDiv),e.removeMessagesForUserEvent.listen((function(e){t.handleRemoveMessages(e)}));var n,o,r,s=new u.d((function(){t.showMessages()}),{bounceLimitMS:7500,debounceType:2});return t.element.ontouchstart=function(e){s.callFunc()},t.innerDiv.ontouchstart=function(){s.callFunc()},t.innerDiv.ontouchmove=function(){s.callFunc()},t.innerDiv.onclick=function(e){t.toggleResizeIndicatorVisibility(),(0,l.vj)()&&"shortcode"===e.target.dataset.messagetype||g.H4.fire(t.isIndicatorVisible)},t.resizeDragDiv.ontouchstart=function(e){1!==e.touches.length&&e.preventDefault(),r=t.isIndicatorVisible,n=e.touches[0].clientX,o=e.touches[0].clientY,(0,w.gr)()?(t.heightDuration=0,t.updateTransitions()):(t.widthDuration=0,t.updateTransitions())},t.resizeDragDiv.ontouchmove=function(e){if(e.preventDefault(),!(e.touches.length<1||e.touches.length>2)){var i=e.touches[0].clientX,r=e.touches[0].clientY;(0,w.gr)()?t.setPortraitHeight(t.portraitHeight+(o-r)):t.setLandscapeWidth(t.landscapeWidth+(n-i)),n=i,o=r,s.callFunc(),t.showResizeIndicator(),g.ct.fire(void 0)}},t.resizeDragDiv.ontouchend=function(e){e.touches.length>0||(r||t.hideResizeIndicator(160),g.Ap.fire(void 0))},t.resizeDragDiv.onclick=function(){t.toggleResizeIndicatorVisibility(),g.H4.fire(t.isIndicatorVisible)},g.h4.listen((function(){t.isIndicatorVisible&&t.toggleResizeIndicatorVisibility()})),g.pF.listen((function(){t.isChatHidden()&&t.unhideChat(),t.scrollToBottom()})),t.layoutConstraints.setOnUpdate((function(){t.repositionChildren()})),w.bs.listen((function(){t.backgroundDelay=0,t.heightDuration=0,t.widthDuration=0,t.updateTransitions()})),t.element.style.display="none",t.repositionChildren(),t}return(0,o.Z)(x,[{key:"showBackground",value:function(){this.backgroundDelay=0,this.updateTransitions(),this.element.style.background="rgba(255, 255, 255, 0.25)"}},{key:"hideBackground",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.backgroundDelay=e,this.updateTransitions(),this.element.style.background="transparent"}},{key:"addMessage",value:function(e){var t=this;f.p.setMessageColor(e);var n=e.querySelector("a");null!==n&&"pmChatLink"===n.className&&(0,c.j9)("click",n,(function(){g.uh.fire(void 0)})),e.style.fontSize="",e.style.lineHeight="",e.style.display="inline-block",e.style.verticalAlign="bottom",e.style.overflowWrap="break-word";var i=!this.isScrolledUp();(0,p.ZA)(e,this.innerDiv),this.addTimeout((function(){t.hideMessage(e)}),15e3),i&&this.scrollToBottom()}},{key:"isScrolledUp",value:function(){return this.innerDiv.scrollTop<=this.innerDiv.scrollHeight-(this.innerDiv.offsetHeight+20)}},{key:"scrollToBottom",value:function(){this.innerDiv.scrollTop=this.innerDiv.scrollHeight-this.innerDiv.offsetHeight-1}},{key:"showMessages",value:function(){var e,t=this,n=C(this.pendingTimeouts);try{for(n.s();!(e=n.n()).done;){var i=e.value;clearTimeout(i)}}catch(e){n.e(e)}finally{n.f()}var o,r=C(this.innerDiv.children);try{var s=function(){var e=o.value;(0,m.pS)(e,"opacity ".concat(400,"ms")),e.style.opacity="1",t.addTimeout((function(){t.hideMessage(e)}),15e3)};for(r.s();!(o=r.n()).done;)s()}catch(e){r.e(e)}finally{r.f()}}},{key:"hideMessage",value:function(e){var t=this;this.isScrolledUp()?this.addTimeout((function(){t.hideMessage(e)}),15e3):((0,m.pS)(e,"opacity ".concat(1e3,"ms")),e.style.opacity="0")}},{key:"setVisible",value:function(e){var t=this;if(this.isVisible!==e){this.isVisible=e,this.heightDuration=0,this.widthDuration=0,this.updateTransitions(),window.setTimeout((function(){t.scrollToBottom()}),Math.max(this.heightDuration,this.widthDuration)+100);var n={top:0,bottom:0,left:0,right:0,transitionTime:0};this.isVisible&&(this.showResizeIndicator(),this.showBackground(),this.showMessages(),n.bottom=this.calculateTotalChatHeight(),n.right=this.calculateTotalChatWidth()),this.layoutConstraints.setConstraints(n),S.fire(e)}}},{key:"calculateTotalChatHeight",value:function(){return Math.round(this.portraitHeight+56+30+4)}},{key:"calculateTotalChatWidth",value:function(){return Math.round(this.landscapeWidth+20)}},{key:"deviceLength",value:function(){return(0,w.gr)()?(0,b.mP)():(0,b._U)()}},{key:"setPortraitHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.desiredPortraitHeight=e;var n=!this.isScrolledUp(),i=this.portraitHeight,o=this.deviceLength()-56-30-4-Math.max(30,this.layoutConstraints.top());e=Math.min(e,o),e=Math.max(e,0),e=Math.round(e),this.portraitHeight=e,(0,h.rm)()?this.element.style.height="min(calc(var(--vh, 1vh) * 100 - ".concat(136,"px), ").concat(this.portraitHeight,"px)"):this.element.style.height="".concat(this.portraitHeight,"px"),0===e?this.hideCloseChatDiv():this.showCloseChatDiv(),e!==i&&(n||0===i?this.scrollToBottom():this.innerDiv.scrollTop+=i-e,this.layoutConstraints.setConstraints({top:0,bottom:this.isVisible?this.calculateTotalChatHeight():0,left:0,right:this.isVisible?this.calculateTotalChatWidth():0,transitionTime:t}))}},{key:"setLandscapeWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.desiredLandscapeWidth=e;var n=!this.isScrolledUp(),i=this.landscapeWidth,o=this.deviceLength()-30-20-Math.max(50,this.layoutConstraints.left());e=Math.min(e,o),e=Math.max(e,0),e=Math.round(e),this.landscapeWidth=e,this.element.style.width="".concat(this.landscapeWidth,"px"),0===e?this.hideCloseChatDiv():window.innerHeight<150?(this.hideCloseChatDiv(),window.innerHeight<75&&this.hideResizeIndicator()):this.showCloseChatDiv(),e!==i&&((n||0===i)&&this.scrollToBottom(),this.layoutConstraints.setConstraints({top:0,bottom:this.isVisible?this.calculateTotalChatHeight():0,left:0,right:this.isVisible?this.calculateTotalChatWidth():0,transitionTime:t}))}},{key:"hideCloseChatDiv",value:function(){this.closeChatContainer.style.display="none",(0,w.gr)()?(this.resizeIndicatorDiv.style.height="".concat(k,"px"),this.resizeIndicatorDiv.style.width="".concat((0,b._U)()-2,"px")):(this.resizeIndicatorDiv.style.height="100%",this.resizeIndicatorDiv.style.width="".concat(k,"px"))}},{key:"showCloseChatDiv",value:function(){if((0,w.gr)())this.resizeIndicatorDiv.style.height="".concat(k,"px"),this.resizeIndicatorDiv.style.width="".concat((0,b._U)()-k-4,"px");else{var e=this.resizeDragDiv.getBoundingClientRect();this.resizeIndicatorDiv.style.height="".concat(e.height-k-2,"px"),this.resizeIndicatorDiv.style.width="".concat(k,"px")}this.closeChatContainer.style.display="inline-block"}},{key:"createResizeDragDiv",value:function(){var e=this;if(this.resizeDragDiv=document.createElement("div"),this.controlsContainerDiv=document.createElement("div"),this.resizeIndicatorDiv=document.createElement("div"),this.resizeIndicatorImg=document.createElement("img"),this.closeChatContainer=document.createElement("div"),this.closeChatDiv=document.createElement("div"),this.closeChatImg=document.createElement("img"),this.resizeDragDiv.appendChild(this.controlsContainerDiv),this.controlsContainerDiv.appendChild(this.resizeIndicatorDiv),this.controlsContainerDiv.appendChild(this.closeChatContainer),this.closeChatContainer.appendChild(this.closeChatDiv),this.resizeIndicatorDiv.appendChild(this.resizeIndicatorImg),this.closeChatDiv.appendChild(this.closeChatImg),this.resizeDragDiv.style.position="absolute",this.resizeDragDiv.style.bottom="0",this.controlsContainerDiv.style.verticalAlign="middle",this.controlsContainerDiv.style.width="100%",this.controlsContainerDiv.style.position="absolute",this.resizeIndicatorDiv.style.display="inline-block",this.resizeIndicatorDiv.style.position="absolute",this.resizeIndicatorDiv.style.left="0",this.resizeIndicatorDiv.style.padding="".concat(4,"px"),this.resizeIndicatorDiv.style.borderRadius="4px",this.resizeIndicatorDiv.style.opacity="1",this.resizeIndicatorDiv.style.boxSizing="border-box",this.resizeIndicatorDiv.style.background="rgba(0, 0, 0, 0.3)",this.resizeIndicatorDiv.classList.add("resizeIndicatorDiv"),this.closeChatContainer.style.padding="".concat(30,"px"),this.closeChatContainer.style.display="inline-block",this.closeChatContainer.style.position="absolute",this.closeChatContainer.style.margin="0",this.closeChatContainer.style.boxSizing="border-box",this.closeChatContainer.style.fontSize="9pt",this.closeChatContainer.style.lineHeight="14px",this.closeChatContainer.style.top="".concat(-19.5,"px"),this.closeChatContainer.style.right="".concat(-18.5,"px"),this.closeChatDiv.style.display="inline-block",this.closeChatDiv.style.position="absolute",this.closeChatDiv.style.margin="0",this.closeChatDiv.style.height="".concat(k,"px"),this.closeChatDiv.style.width="".concat(k,"px"),this.closeChatDiv.style.padding="".concat(4,"px"),this.closeChatDiv.style.borderRadius="4px",this.closeChatDiv.style.boxSizing="border-box",this.closeChatDiv.style.textAlign="center",this.closeChatDiv.style.top="".concat(19.5,"px"),this.closeChatDiv.style.left="".concat(19.5,"px"),this.closeChatDiv.style.background="rgba(0, 0, 0, 0.3)",this.resizeIndicatorImg.src="".concat(STATIC_URL_MOBILE,"3-bar.svg"),this.resizeIndicatorImg.style.position="absolute",this.resizeIndicatorImg.style.height="".concat(13,"px"),this.resizeIndicatorImg.style.width="".concat(7,"px"),this.closeChatImg.src="".concat(STATIC_URL_MOBILE,"close-button.svg"),this.closeChatImg.style.height="9px",this.closeChatImg.style.width="9px",this.closeChatImg.style.padding="0",this.closeChatImg.style.margin="0",this.closeChatImg.classList.add("closeChatFullscreen"),(0,w.gr)())this.resizeIndicatorDiv.style.width="".concat((0,b._U)()-k-4,"px"),this.resizeIndicatorDiv.style.height="".concat(k,"px"),this.stylePortrait();else{this.resizeIndicatorDiv.style.width="".concat(k,"px");var t=this.resizeDragDiv.getBoundingClientRect();this.resizeIndicatorDiv.style.height="".concat(t.height-k,"px"),this.styleLandscape()}this.closeChatContainer.onclick=function(t){if(e.isIndicatorVisible){if(t.stopPropagation(),(0,w.gr)()){var n=Math.max(180,1.15*e.portraitHeight);n=Math.min(380,n),e.heightDuration=n,e.updateTransitions(),e.setPortraitHeight(0,n)}else{var i=Math.max(200,1.5*e.landscapeWidth);i=Math.min(450,i),e.widthDuration=i,e.updateTransitions(),e.setLandscapeWidth(0,i)}e.showResizeIndicator(),g.ct.fire(void 0)}},this.resizeIndicatorDiv.onclick=function(t){e.isIndicatorVisible&&e.isChatHidden()&&(t.stopPropagation(),e.unhideChat())}}},{key:"unhideChat",value:function(){var e=180;(0,w.gr)()?(this.heightDuration=e,this.updateTransitions(),this.setPortraitHeight(150,e)):(this.widthDuration=e,this.updateTransitions(),this.setLandscapeWidth(150,e))}},{key:"isChatHidden",value:function(){return(0,w.gr)()&&this.portraitHeight<5||!(0,w.gr)()&&this.landscapeWidth<5}},{key:"stylePortrait",value:function(){this.element.style.width="100%",this.element.style.top="",this.element.style.bottom="".concat(56+this.layoutConstraints.bottom()+this.inputFocusOffset,"px"),this.element.style.right="",this.resizeDragDiv.style.height="".concat(50,"px"),this.resizeDragDiv.style.width="100%",this.resizeDragDiv.style.left="0",this.resizeDragDiv.style.top="".concat(-30,"px"),this.controlsContainerDiv.style.height="".concat(k,"px"),this.controlsContainerDiv.style.width="100%",this.controlsContainerDiv.style.top="4px",this.controlsContainerDiv.style.left="0",this.resizeIndicatorDiv.style.marginLeft="".concat(1,"px"),this.resizeIndicatorImg.style.left="".concat(((0,b._U)()-7-2)/2,"px"),this.resizeIndicatorImg.style.bottom="".concat(4,"px"),this.resizeIndicatorImg.style.transform="rotate(90deg)",this.closeChatDiv.style.right="0",this.closeChatDiv.style.marginRight="".concat(1,"px"),this.closeChatContainer.style.right="".concat(-18.5,"px")}},{key:"styleLandscape",value:function(){var e;this.element.style.height="",this.element.style.top="".concat(30,"px"),this.element.style.bottom="".concat(56+this.layoutConstraints.bottom(),"px"),this.element.style.right="10px",this.resizeDragDiv.style.width="".concat(50,"px"),this.resizeDragDiv.style.height="",this.resizeDragDiv.style.left="".concat(-30,"px"),this.resizeDragDiv.style.top="0",this.controlsContainerDiv.style.height="100%",this.controlsContainerDiv.style.width="".concat(k,"px"),this.controlsContainerDiv.style.top="0",this.controlsContainerDiv.style.left="4px",e=window.innerHeight>200?this.element.getBoundingClientRect().height:this.resizeIndicatorDiv.getBoundingClientRect().height,this.resizeIndicatorDiv.style.bottom="0",this.resizeIndicatorDiv.style.marginLeft="0",this.resizeIndicatorImg.style.left="".concat(7,"px"),this.resizeIndicatorImg.style.bottom="".concat((e-13)/2,"px"),this.resizeIndicatorImg.style.transform="rotate(0deg)",this.closeChatDiv.style.right="",this.closeChatDiv.style.marginRight="0",this.closeChatContainer.style.right="".concat(-19.5,"px")}},{key:"handleRemoveMessages",value:function(e){var t,n=[],i=C(this.innerDiv.childNodes);try{for(i.s();!(t=i.n()).done;){var o=t.value;o.getAttribute("data-nick")===e&&n.push(o)}}catch(e){i.e(e)}finally{i.f()}for(var r=0,s=n;r<s.length;r++){var a=s[r];this.innerDiv.removeChild(a)}}},{key:"toggleResizeIndicatorVisibility",value:function(){this.isIndicatorVisible?this.hideResizeIndicator():this.showResizeIndicator()}},{key:"showResizeIndicator",value:function(){var e=this;(0,m.pS)(this.resizeDragDiv,"opacity ".concat(175,"ms")),this.resizeDragDiv.style.opacity="0.9",this.isIndicatorVisible=!0,this.showBackground(),clearTimeout(this.opacityTimer),this.opacityTimer=window.setTimeout((function(){e.isIndicatorVisible=!1,e.resizeDragDiv.style.opacity="0",e.hideBackground()}),3500)}},{key:"hideResizeIndicator",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,m.pS)(this.resizeDragDiv,"opacity ".concat(175,"ms ").concat(e,"ms")),this.isIndicatorVisible=!1,this.resizeDragDiv.style.opacity="0",this.hideBackground(e),clearTimeout(this.opacityTimer)}},{key:"updateTransitions",value:function(){var e="background-color ".concat(175,"ms ").concat(this.backgroundDelay,"ms"),t="height ".concat(this.heightDuration,"ms"),n="width ".concat(this.widthDuration,"ms");(0,m.pS)(this.element,[e,t,n].join(","))}},{key:"repositionChildren",value:function(){this.element.style.display=this.isVisible?"block":"none",(0,w.gr)()?(this.setPortraitHeight(this.desiredPortraitHeight),this.stylePortrait()):(this.setLandscapeWidth(this.desiredLandscapeWidth),this.styleLandscape())}},{key:"afterDOMConstructed",value:function(){}}]),x}(f.p)},6874:function(e,t,n){"use strict";n.d(t,{Yq:function(){return Yn},GD:function(){return Jn},m7:function(){return Kn}});var i=n(2951),o=n(1976),r=n(7169),s=n(3243),a=n(7591),l=n(9492),c=n(7597),u=n(8759),d=n(6272),h=n(6079),f=n(2800),p=n(8626),m=n(7693),v=n(1522),g=n(3753),y=n(391),b=n(8138),w=n(695),C=n(4411),x=n(1602),k=n(1234),S=n(4793),T=n(8069),I=n(9),R=n(1794),P=n(1282),M=n(3705),A=n(6893),E=n(928),B=n(2239),L=n(8978),O=n(758),D=n(3543),U=n(1289),Z=n(2750),F=n(444),_=n(4649),N=n(47),j=n(9598);var H=function(e){(0,a.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function s(){return(0,i.Z)(this,s),r.call(this)}return(0,o.Z)(s,[{key:"initUI",value:function(){var e=this;this.followButton=(0,N.vz)(z,{onClick:function(){e.handleFollowAndUnfollow()}}),this.unfollowButton=(0,N.vz)(W,{onClick:function(){e.onUnfollowClick()}}),this.element=(0,N.vz)("div",{style:{display:"flex",alignItems:"center"}},this.followButton,this.unfollowButton),this.updateFollowButtonDisplay(),j.wk.listen((function(t){t.roomName===e.roomName&&e.updateContext(e.roomName,t.following)}))}}]),s}(n(8071).e),z=function(e){return(0,N.vz)("div",{style:{display:"none",backgroundColor:"#E0E0E0",color:"#ffffff",boxSizing:"border-box",borderRadius:"4px",padding:0,height:"32px",justifyContent:"center",alignItems:"center"},onClick:e.onClick},(0,N.vz)("span",{className:"icon_not_following no_hover",style:{position:"static",padding:"0 3px 0",height:"29px",width:"29px",backgroundSize:"28px 28px",display:"inline-block"}}),(0,N.vz)("span",{style:{display:"inline-block",fontSize:"14px",color:"#222222",paddingRight:"8px"}},D.ag.followText))},W=function(e){return(0,N.vz)("div",{style:{display:"none",backgroundColor:"#17202A",color:"#ffffff",boxSizing:"border-box",borderRadius:"4px",justifyContent:"center",alignItems:"center"},onClick:e.onClick},(0,N.vz)("span",{className:"icon_following_new no_hover",style:{position:"relative",height:"20px",width:"20px",backgroundSize:"20px 20px"}}))},V=n(3764);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){(0,_.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J=function(e){(0,a.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function s(){return(0,i.Z)(this,s),r.call(this)}return(0,o.Z)(s,[{key:"initUI",value:function(){var e=this,t={whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"right",overflow:"hidden",width:"100%"},n=K({fontFamily:"'UbuntuBold', Arial, Helvetica, sans-serif",color:"#FFF",fontWeight:700,fontSize:"14px",display:"block"},t),i=K({fontSize:"12px",color:"#A7A7A7",display:"inline-block"},t);this.followButton=new H,this.element=(0,N.vz)("div",{style:{margin:"0 10px",display:"flex",boxSizing:"border-box",minWidth:"inherit"}},(0,N.vz)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",marginRight:"8px",flex:1,minWidth:"inherit",textAlign:"right"}},(0,N.vz)("span",{style:n,ref:function(t){return e.roomNameElement=t}}),(0,N.vz)("span",{style:i},(0,N.vz)("span",{ref:function(t){return e.roomStatusElement=t}}),(0,N.vz)("span",{ref:function(t){return e.numViewersElement=t}}))),this.followButton.element),V.A.listen((function(t){e.updateViewerCount(t)}))}},{key:"updateContext",value:function(e,t,n){this.roomName=e,this.roomStatus=n,this.followButton.updateContext(this.roomName,t),this.updateText()}},{key:"updateViewerCount",value:function(e){this.numViewers=e,this.updateText()}},{key:"updateRoomNameText",value:function(){this.roomNameElement.innerText=this.roomName}},{key:"updateRoomStatusText",value:function(){var e="offline"===this.roomStatus||"notconnected"===this.roomStatus||"unknown"===this.roomStatus,t="".concat(D.ag.live," â€¢ ");this.roomStatusElement.innerText="".concat(e?D.ag.offline:t),this.numViewersElement.innerText=e?"":"".concat(D.ag.numViewerOrViewers(this.numViewers))}},{key:"updateText",value:function(){this.updateRoomNameText(),this.updateRoomStatusText()}}]),s}(I.w),G=n(1185),Y=n(8263),$=n(9491);function Q(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return X(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?X(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var ee=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(){var e;return(0,i.Z)(this,u),(e=r.call(this)).rerendered=new R.xB("dismissibleMessagesRerendered"),(0,G.vP)(e.element,"MobileDismissibleMessages"),(0,Y.Zs)(e.element,{height:"",position:"fixed",top:"40px"}),e}return(0,o.Z)(u,[{key:"render",value:function(e){var t=this,n=(0,N.vz)(ne,{onCloseButtonClick:function(){return t.dismissMessage(n,e)},message:e});this.element.appendChild(n),this.rerendered.fire()}},{key:"dismissMessage",value:function(e,t){(0,s.Z)((0,c.Z)(u.prototype),"dismissMessage",this).call(this,e,t),this.rerendered.fire()}}]),u}(n(9187).h),te=function(e){var t=(0,$.bo)("12px");return(0,G.vP)(t,"closeButton"),(0,Y.Zs)(t,{marginRight:"15px"}),t.onclick=e.onClick,t},ne=function(e){return(0,N.vz)("div",{colorClass:"messageContainer",style:{alignItems:"center",padding:"8px 15px",fontFamily:"UbuntuMedium, Helvetica, Arial, sans-serif",fontSize:"14px",lineHeight:"16px"}},(0,N.vz)(te,{onClick:e.onCloseButtonClick}),(0,N.vz)(ie,{message:e.message}))},ie=function(e){var t,n=(0,N.vz)("div",{colorClass:"message",style:{flex:1,maxHeight:"15vh",overflowY:"scroll"},dangerouslySetInnerHTML:{__html:e.message.messageHtml}}),i=Q(n.getElementsByTagName("a"));try{for(i.s();!(t=i.n()).done;){var o=t.value;(0,G.vP)(o,"link"),o.target="_blank",o.rel="noopener noreferrer"}}catch(e){i.e(e)}finally{i.f()}var r,s=Q(n.getElementsByTagName("img"));try{for(s.s();!(r=s.n()).done;)r.value.style.maxWidth="100%"}catch(e){s.e(e)}finally{s.f()}return n},oe=n(5809),re=n(3940),se=n(1625),ae=n(710),le=n(9169),ce=n(1250),ue=n(2833),de=n(1432),he=n(3112),fe=n(9584),pe=n(5253),me=n(3607),ve=n(3682);var ge=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(e){var t;return(0,i.Z)(this,u),(t=r.call(this)).mobileDismissibleMessages=e,t.layoutConstraints=new pe.P(t.constructor.name),t.element.style["-webkit-text-size-adjust"]="none",he.vz.listen((function(e){t.playerHeight=e,(0,B.pS)(t.element,"none")})),t.layoutConstraints.setConstraints({top:t.element.offsetHeight+8,bottom:0,left:200,right:0,transitionTime:0}),t.layoutConstraints.setOnUpdate((function(){var e=t.layoutConstraints.transitionTime();(0,B.pS)(t.element,"top ".concat(e,"ms, width ").concat(e,"ms")),t.repositionChildren()})),t.siteHeaderMenu=document.querySelector("#static-header"),t}return(0,o.Z)(u,[{key:"repositionChildren",value:function(){var e,t,n,i;if((0,s.Z)((0,c.Z)(u.prototype),"repositionChildren",this).call(this),void 0!==this.parent){var o=this.parent.element.getBoundingClientRect(),r=void 0!==this.playerHeight?this.playerHeight:o.height,a=.5*this.element.offsetHeight+.5*r,l=Math.max(0,a-(0,me.mP)()+this.layoutConstraints.bottom());o.width<=(0,me._U)()?this.positionFixed&&(this.element.style.left="".concat(o.left+window.pageXOffset,"px")):this.element.style.left="0";var d=(null!==(e=null===(t=this.siteHeaderMenu)||void 0===t?void 0:t.offsetHeight)&&void 0!==e?e:0)+(null!==(n=null===(i=this.mobileDismissibleMessages)||void 0===i?void 0:i.element.offsetHeight)&&void 0!==n?n:0);if((0,ve.gr)()){var h=.5*r-.5*this.element.offsetHeight-l;h<8&&(h=8),this.element.style.top="".concat(h+d,"px")}else{var f=o.width-this.layoutConstraints.right();this.element.style.width="".concat(f,"px");var p=.5*o.height-.5*this.element.offsetHeight;this.element.style.top="".concat(p+d,"px")}var m=Math.min(50,(o.width-(0,me._U)()+100)/2);m=Math.max(0,m),this.element.style.padding="0 ".concat(m,"px")}}},{key:"handleStatusChange",value:function(e,t){(0,s.Z)((0,c.Z)(u.prototype),"handleStatusChange",this).call(this,e,t);var n={top:0,bottom:0,left:0,right:0,transitionTime:0};"none"!==this.element.style.display&&(n.top=this.element.offsetHeight+8,n.left=200),this.layoutConstraints.setConstraints(n)}},{key:"hideConnectingStatus",value:function(){(0,s.Z)((0,c.Z)(u.prototype),"hideConnectingStatus",this).call(this),"none"===this.element.style.display&&this.layoutConstraints.setConstraints({top:0,bottom:0,left:0,right:0,transitionTime:0})}}]),u}(fe.w),ye=n(6959);var be=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(e){return(0,i.Z)(this,u),r.call(this,e)}return(0,o.Z)(u,[{key:"createPlayerOption",value:function(){var e=(0,s.Z)((0,c.Z)(u.prototype),"createPlayerOption",this).call(this);return e.techOrder=["chromecast","html5"],e.chromecast={requestTitleFn:function(e){return document.title},requestSubtitleFn:function(e){return""}},e.plugins={chromecast:{receiverAppID:"96BDEA07"}},e}}]),u}(de.n),we=n(6958);var Ce=function(e){(0,a.Z)(h,e);var t,n,d=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function h(e,t,n){var o;return(0,i.Z)(this,h),(o=d.call(this,e,new ge(n),{noHook:!0})).mobileDismissibleMessages=n,o.toggleFullscreen=new R.xB("MobilePlayer:toggleFullscreen"),o.sendMessageInputFieldHasFocus=!1,o.minPortraitLeft=0,o.isVideoHidden=!1,o.isFullscreen=!1,o.usingAirPlay=!1,o.usingChromecast=!1,o.element.style.position="absolute",o.element.style.top="0",o.element.style.width="auto",o.element.style.height="auto",o.element.style.overflow="hidden",o.element.style.setProperty("scrollBehavior","auto"),(0,P.L)("HideAddressBar")&&(0,u.Tt)()&&(o.element.style.touchAction="none"),o.playerComponent.element.style.overflowX="hidden",o.headerMenu=document.querySelector("#static-header"),o.roomStatusNotifier.header.style.fontSize="20px",o.roomStatusNotifier.body.style.fontSize="12px",o.videoControls=new ye.Q((0,r.Z)(o),t,n),o.bindControlsEvents(),o.afterPlayerCreated(),o.addChild(o.videoControls),o.element.removeChild(o.watermark),o.addChild(o.roomStatusNotifier),o.toggleFullscreen.listen((function(e){o.repositionChildrenRecursive()})),void 0!==navigator.mediaSession&&(navigator.mediaSession.setActionHandler("play",null),navigator.mediaSession.setActionHandler("pause",null),navigator.mediaSession.setActionHandler("previoustrack",null),navigator.mediaSession.setActionHandler("nexttrack",null)),o.setupAirPlayControls(),o.setupChromecast(),debug("Player type: ".concat((0,re.Z)(o.playerComponent))),o}return(0,o.Z)(h,[{key:"stylePortraitFullscreen",value:function(){var e,t;this.roomStatusNotifier.setShowMoreRoomsLink(!0),void 0===this.playerScaled?e=(t=(0,me.mP)())/(this.isWidescreen?ue.fo:ue.$V):(t=this.playerScaled.height,e=this.playerScaled.width),this.playerComponent.element.style.height="".concat(t,"px"),this.playerComponent.element.style.width="".concat(e,"px"),this.applyPlayerHeight(t),this.element.style.width="".concat((0,me._U)(),"px"),this.toggleMenuBar(!0)}},{key:"styleLandscape",value:function(){if(this.roomStatusNotifier.setShowMoreRoomsLink(!1),this.applyPlayerHeight((0,me.mP)()),this.element.style.height="100%",this.element.style.width="100%",this.playerComponent.element.style.width="100%",(0,u.Tt)())this.playerComponent.element.style.height="100%";else{var e=document.activeElement.tagName.toLowerCase();"input"!==e&&"textarea"!==e&&(this.playerComponent.element.style.height="".concat(this.element.getBoundingClientRect().height,"px"))}this.toggleMenuBar(!0)}},{key:"stylePortraitNonFullscreen",value:function(){this.roomStatusNotifier.setShowMoreRoomsLink(!0);var e=this.getNoneFullscreenSize(),t=(0,oe.Z)(e,2),n=t[0],i=t[1];this.playerComponent.element.style.height="100%",this.playerComponent.element.style.position="static",this.applyPlayerHeight(i),n>(0,me._U)()||this.usingAirPlay||this.usingChromecast?(this.element.style.width="100%",this.element.style.left="0"):(this.element.style.width="".concat(n,"px"),this.element.style.left="".concat(.5*(0,me._U)()-.5*n,"px")),this.usingAirPlay||this.usingChromecast?(this.element.style.height="100px",this.playerComponent.element.style.height="100px",this.playerComponent.element.style.width="100%"):this.playerComponent.element.style.width="".concat(n,"px"),this.toggleMenuBar(!1)}},{key:"repositionChildren",value:function(){(0,ve.gr)()&&this.isFullscreen?this.stylePortraitFullscreen():(0,ve.gr)()&&!this.isFullscreen?(void 0!==this.desiredPortraitHeight&&this.setPortraitHeight(this.desiredPortraitHeight),this.stylePortraitNonFullscreen()):this.styleLandscape(),(0,ve.gr)()&&!this.isFullscreen||(this.isVideoHidden&&this.centerPlayer(),this.element.style.left="0")}},{key:"applyPlayerHeight",value:function(e){this.element.style.height="".concat(e,"px"),he.vz.fire(e)}},{key:"centerPlayer",value:function(){var e=(this.isFullscreen||void 0===this.portraitHeight?void 0===this.fullscreenHeight?(0,me.mP)():this.fullscreenHeight:this.portraitHeight)/(this.isWidescreen?ue.fo:ue.$V);this.element.scrollLeft=e/2-(0,me._U)()/2}},{key:"getNoneFullscreenSize",value:function(){var e,t,n=(0,me._U)(),i=(0,me.mP)();if(this.sendMessageInputFieldHasFocus&&(0,me.F7)()>0){var o=this.getDimensionsWithinBounds(n,i-(0,F.hf)()),r=(0,oe.Z)(o,2);e=r[0],t=r[1]}else if((0,ve.gr)())void 0!==this.portraitHeight?e=(t=Math.min(i-this.minPortraitLeft,this.portraitHeight))/(this.isWidescreen?ue.fo:ue.$V):t=(e=Math.min(n,(i-120)/(this.isWidescreen?ue.fo:ue.$V)))*(this.isWidescreen?ue.fo:ue.$V);else{var s=this.getDimensionsWithinBounds(n,i),a=(0,oe.Z)(s,2);e=a[0],t=a[1]}return[Math.round(e),Math.round(t)]}},{key:"getDimensionsWithinBounds",value:function(e,t){var n=t/(this.isWidescreen?ue.fo:ue.$V),i=t;return n>e&&(i=(n=e)*(this.isWidescreen?ue.fo:ue.$V)),[n,i]}},{key:"setupAirPlayControls",value:function(){var e=this;void 0!==window.WebKitPlaybackTargetAvailabilityEvent?(this.videoControls.showAirPlay(),(0,m.j9)("click",this.videoControls.airPlayImg,(function(){var t=e.playerComponent.getVideoElement();void 0===t?e.videoControls.forceHLS():t.webkitShowPlaybackTargetPicker()})),(0,m.j9)("webkitplaybacktargetavailabilitychanged",this.playerComponent.element,(function(t){if(e.videoControls.forceHLS(),void 0!==t.availability)switch(t.availability){case"available":e.videoControls.showAirPlay();break;case"not-available":e.videoControls.hideAirPlay()}}))):this.videoControls.hideAirPlay()}},{key:"setupChromecastControls",value:function(){var e=this;if(this.playerComponent instanceof de.n){var t=this.playerComponent.getVideoJs();if(void 0!==t&&void 0!==t.chromecastSessionManager){var n=t.chromecastSessionManager.getCastContext();(0,m.j9)("click",this.videoControls.chromecastImg,(function(){void 0===e.playerComponent.getVideoElement()?e.videoControls.forceHLS():t.chromecastSessionManager.openCastMenu()})),n.addEventListener("caststatechanged",(function(t){if(void 0!==t.castState)switch(t.castState){case"NOT_CONNECTED":e.videoControls.showChromecast();break;case"NO_DEVICES_AVAILABLE":e.videoControls.hideChromecast()}})),"CONNECTED"===n.getCastState()||"CONNECTING"===n.getCastState()?(this.videoControls.showChromecast(),n.getCurrentSession().endSession(!0)):"NOT_CONNECTED"===n.getCastState()?this.videoControls.showChromecast():"NO_DEVICES_AVAILABLE"===n.getCastState()&&this.videoControls.hideChromecast()}else this.videoControls.hideChromecast()}}},{key:"setupChromecast",value:function(){var e=this,t=0,n=window.setInterval((function(){if(t>=10&&clearInterval(n),e.playerComponent instanceof de.n){var i=e.playerComponent.getVideoJs();if(void 0!==i&&void 0!==i.chromecastSessionManager){e.setupChromecastControls();var o=e.playerComponent.getVideoElement();void 0!==o&&e.bindChromecastEventsToVideo(o),clearInterval(n)}}t+=1}),1e3)}},{key:"createVideoJsPlayer",value:function(){return new be(this.roomStatusNotifier)}},{key:"afterPlayerCreated",value:function(){(0,s.Z)((0,c.Z)(h.prototype),"afterPlayerCreated",this).call(this);var e=this.playerComponent.getVideoElement();void 0!==e&&this.bindAirPlayEventsToVideo(e),this.videoControls.notifyPlayerIsJPEG(this.playerComponent instanceof ce.z)}},{key:"setUsingAirPlay",value:function(e){this.usingAirPlay=e,this.videoControls.notifyUsingAirPlayChange(e)}},{key:"bindAirPlayEventsToVideo",value:function(e){var t=this;void 0!==window.WebKitPlaybackTargetAvailabilityEvent&&(0,m.j9)("webkitcurrentplaybacktargetiswirelesschanged",e,(function(){e.webkitCurrentPlaybackTargetIsWireless?((0,M.fg)("Video_CastStart",{CastType:"airplay"}),t.setUsingAirPlay(!0)):((0,M.fg)("Video_CastStop",{CastType:"airplay"}),t.setUsingAirPlay(!1)),le.y.fire(t.usingAirPlay),t.videoControls.updateCastingStyling(t.usingAirPlay?"AirPlay":""),t.repositionChildrenRecursive(),t.centerPlayer()}))}},{key:"setUsingChromecast",value:function(e){this.usingChromecast=e,this.videoControls.notifyUsingChromecastChange(e)}},{key:"bindChromecastEventsToVideo",value:function(e){var t=this;if(this.playerComponent instanceof de.n){var n=this.playerComponent.getVideoJs();void 0!==n&&void 0!==n.chromecastSessionManager&&n.chromecastSessionManager.getCastContext().addEventListener("sessionstatechanged",(function(e){if(void 0!==e.sessionState)switch(e.sessionState){case"SESSION_STARTED":case"SESSION_RESUMED":(0,M.fg)("Video_CastStart",{CastType:"chromecast"}),t.setUsingChromecast(!0);break;case"SESSION_ENDED":(0,M.fg)("Video_CastStop",{CastType:"chromecast"}),t.setUsingChromecast(!1)}t.videoControls.updateCastingStyling(t.usingChromecast?"Chromecast":""),t.repositionChildrenRecursive(),t.centerPlayer()}))}}},{key:"bindControlsEvents",value:function(){var e=this;this.videoControls.setPlayerVisibilityEvent.listen((function(t){e.setHidden(t)})),this.videoControls.centerPlayerEvent.listen((function(){e.centerPlayer()})),this.videoControls.requestFullscreenEvent.listen((function(){(0,se.Zx)(e.element)})),this.videoControls.setPlayerComponentVolumeMutedEvents.listen((function(t){e.playerComponent.setVolumeMuted(t.volume,t.isMuted)})),this.videoControls.forceHlsPlayerEvent.listen((function(t){var n=t.roomContext,i=t.unmute;e.forceHlsPlayer(n,null==i||i)})),this.videoControls.touchControls.scalePlayerEvent.listen((function(t){var n=t.factor,i=t.pointX;e.canUpdateMobilePlayer()&&(0,ve.gr)()&&e.isFullscreen&&e.scalePlayer(n,i)})),this.videoControls.touchControls.changeVideoHeightEvent.listen((function(t){if(e.canUpdateMobilePlayer()&&(0,ve.gr)())if(e.isFullscreen){var n=1+t.distance.y/(0,me.mP)()*we.J,i=(0,me._U)()/2;e.scalePlayer(n,i)}else e.setDesiredPortraitHeight(t.distance.y)})),this.videoControls.touchControls.scrollPlayerEvent.listen((function(t){e.canUpdateMobilePlayer()&&!e.isVideoHidden&&(void 0!==e.element.scrollBy?e.element.scrollBy(t,0):e.element.scrollLeft+=t)})),this.videoControls.touchControls.swipePlayerEvent.listen((function(t){var n=t.totalDistance>0;switch(t.state){case 4:debug("Swipe Reset");break;case 2:debug("Handle Completed Swipe",{direction:n?"Left":"Right",totalDistance:t.totalDistance});break;default:n?e.handleLeftSwipe(t):e.handleRightSwipe(t)}})),this.videoControls.playerComponentReadjustForceHlsOverlayOrderEvent.listen((function(t){e.playerComponent.element.insertBefore(t,e.playerComponent.element.firstChild),e.playerComponent.element.insertBefore(t,e.playerComponent.element.firstChild)})),this.videoControls.showJpegPlayerComponentImage.listen((function(){e.playerComponent instanceof ce.z&&e.playerComponent.showPlayerImage()})),this.videoControls.toggleFullscreen.listen((function(t){e.isFullscreen=t,e.toggleFullscreen.fire(t)})),this.videoControls.requestHlsPlayerPlayIfPaused.listen((function(){e.playerComponent instanceof A._O&&e.playerComponent.videoElement.paused&&e.playerComponent.play()}))}},{key:"bindVideoEvents",value:function(){var e,t,n=this;(0,s.Z)((0,c.Z)(h.prototype),"bindVideoEvents",this).call(this),this.playerComponent.requestControlVisibility.listen((function(e){e?n.videoControls.show():n.videoControls.hide()})),null===(e=this.playerComponent.setControlVolume)||void 0===e||e.listen((function(e){var t=e.volume;e.save?n.videoControls.updateAndSaveVolume(t):n.videoControls.updateVolume(t)})),null===(t=this.playerComponent.setControlIsMuted)||void 0===t||t.listen((function(e){var t=e.isMuted;e.save?n.videoControls.updateAndSaveIsMuted(t):n.videoControls.updateIsMuted(t)}))}},{key:"toggleMenuBar",value:function(e){this.headerMenu.style.display=e?"none":""}},{key:"setIsWidescreen",value:function(e){this.isWidescreen=e}},{key:"setPortraitHeight",value:function(e){var t=this.portraitHeight,n=Math.min((0,me.mP)()-this.getOtherComponentsCombinedHeights(),Math.max(100,e));n=Math.round(n),this.portraitHeight=n,(t=void 0!==t?t:this.portraitHeight)!==n&&(this.repositionChildrenRecursive(),this.element.scrollLeft+=n-t)}},{key:"getOtherComponentsCombinedHeights",value:function(){var e,t,n,i,o,r,s=null!==(e=null===(t=document.getElementById("static-header"))||void 0===t?void 0:t.offsetHeight)&&void 0!==e?e:40,a=null!==(n=null===(i=document.getElementById("tab-room-header"))||void 0===i?void 0:i.offsetHeight)&&void 0!==n?n:42,l=null!==(o=null===(r=this.mobileDismissibleMessages)||void 0===r?void 0:r.element.offsetHeight)&&void 0!==o?o:0;return s+a+(0,F.hf)()+l}},{key:"setDesiredPortraitHeight",value:function(e){var t=this.element.offsetHeight+e;this.desiredPortraitHeight!==t&&(this.desiredPortraitHeight=t,this.repositionChildren())}},{key:"scalePlayer",value:function(e,t){var n=this.playerComponent.element.offsetWidth,i=e*n,o=(0,me.mP)()/(this.isWidescreen?ue.fo:ue.$V),r=(0,me._U)();i=Math.max(i,r),i=Math.min(i,o),i=Math.round(i);var s=this.element.scrollLeft,a=Math.round(i*(this.isWidescreen?ue.fo:ue.$V));this.element.style.width="".concat(i,"px"),this.fullscreenHeight=a,this.applyPlayerHeight(a),this.playerComponent.element.style.width="".concat(i,"px"),this.playerScaled={width:i,height:a},this.repositionChildrenRecursive();var l=i/n-1,c=(t+this.element.scrollLeft)*l;this.element.scrollLeft=s+c}},{key:"limitPortraitHeight",value:function(e){this.minPortraitLeft=e,this.repositionChildrenRecursive()}},{key:"setMessageInputFieldHasFocus",value:function(e){this.sendMessageInputFieldHasFocus=e,e&&this.videoControls.hideControls()}},{key:"setHidden",value:function(e){this.isVideoHidden=e,this.repositionChildren()}},{key:"canUpdateMobilePlayer",value:function(){return!this.usingAirPlay&&!this.usingChromecast&&!this.videoControls.isAnyInputFocused()}},{key:"handleLeftSwipe",value:function(e){debug("Handle Left Swipe In Progress")}},{key:"handleRightSwipe",value:function(e){debug("Handle Right Swipe In Progress")}}]),h}(ae.r),xe=n(5406),ke=n(9420),Se=n(2923),Te=n(6847),Ie=n(4043);var Re=function(e){(0,a.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function s(e){return(0,i.Z)(this,s),r.call(this,"div",e)}return(0,o.Z)(s,[{key:"initData",value:function(e){this.tabList=e.tabList,this.isTouching=!1,this.isSwipingTabs=!1,this.isScrollingVertically=!1,this.isPinching=!1,this.prevTranslate=0,this.currTranslate=0,this.startX=0,this.startY=0,this.tabWidth=(0,me.RK)().width,this.currIndex=0,s.currentTab="chat"}},{key:"initUI",value:function(){var e=this;this.element=(0,N.vz)("div",{style:{width:"100%",height:"100%",backgroundColor:"#FFFFFF",display:"flex",position:"absolute"}}),this.tabList.getList().forEach((function(t){e.addChild(t)})),this.initSwipeListeners(),Ie.qF.listen((function(t){e.setActiveTab(t)})),ke.wy.listen((function(){Ie.qF.fire("moreRooms")}))}},{key:"initSwipeListeners",value:function(){var e=this;this.tabList.getList().forEach((function(t){(0,m.j9)("touchstart",t.element,(function(t){e.handleTouchStart(t)})),(0,m.j9)("touchmove",t.element,(function(t){e.handleTouchMove(t)})),(0,m.j9)("touchend",t.element,(function(t){e.handleTouchEnd(t)}))}))}},{key:"handleTouchStart",value:function(e){var t=e.touches[0].pageX<20||e.touches[0].pageX>this.tabWidth-20;this.isPinching=e.touches.length>=2,t||(0,Se.V)()||this.isPinching||((0,B.pS)(this.element,"left 0.1s ease-out"),this.isTouching=!0,this.startX=e.touches[0].pageX,this.startY=e.touches[0].pageY)}},{key:"handleTouchMove",value:function(e){var t=e.touches[0].pageX-this.startX,n=t<0,i=0===this.currIndex,o=this.currIndex===this.tabList.length()-1,r=i&&!n||o&&n;if(this.isTouching&&!r&&!this.isPinching){var s=e.touches[0].pageX,a=e.touches[0].pageY;(0,Te.fQ)(this.startX,this.startY,s,a)&&!this.isSwipingTabs&&(this.isScrollingVertically=!0),this.isScrollingVertically||(e.preventDefault(),this.isSwipingTabs=!0,this.currTranslate=this.prevTranslate+t,this.element.style.left="".concat(this.currTranslate,"px"))}}},{key:"handleTouchEnd",value:function(e){var t=this;if(this.isTouching){window.setTimeout((function(){(0,B.QU)(t.element)}),100),this.isTouching=!1,this.isSwipingTabs=!1,this.isScrollingVertically=!1,this.isPinching=!1;var n=this.currTranslate-this.prevTranslate,i=this.tabWidth/4,o=n<=-i,r=n>=i,a=this.currIndex+1<this.tabList.length(),l=this.currIndex>0;if(o&&a){var c,u=null===(c=this.tabList.getTabByIndex(this.currIndex+1))||void 0===c?void 0:c.getTabName();Ie.qF.fire(null!=u?u:s.currentTab)}else if(r&&l){var d,h=null===(d=this.tabList.getTabByIndex(this.currIndex-1))||void 0===d?void 0:d.getTabName();Ie.qF.fire(null!=h?h:s.currentTab)}else this.currTranslate-=n,this.element.style.left="".concat(this.currTranslate,"px"),this.prevTranslate=this.currTranslate}}},{key:"setActiveTab",value:function(e){var t=this.tabList.getIndexByTabName(e);if(void 0!==t){var n;s.currentTab=e,this.currIndex=t;var i=null===(n=this.tabList.getTabByIndex(t))||void 0===n?void 0:n.getPageActionName();void 0!==i&&(0,M.fg)(i)}this.repositionTabs()}},{key:"repositionTabs",value:function(){this.tabWidth=(0,me._U)(),this.currTranslate=this.currIndex*-this.tabWidth,this.element.style.left="".concat(this.currTranslate,"px"),this.prevTranslate=this.currTranslate}},{key:"repositionChildren",value:function(){this.repositionTabs()}}]),s}(I.w);var Pe=function(e){(0,a.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function s(e){return(0,i.Z)(this,s),r.call(this,"ul",e)}return(0,o.Z)(s,[{key:"initData",value:function(e){this.activeTab="chat"}},{key:"initUI",value:function(e){var t=this,n={fontSize:"10px",fontFamily:"UbuntuBold, Arial, Helvetica, sans-serif"};this.numChatUnreadContainer=(0,N.vz)("span",{colorClass:"numUnread",style:n}),this.numPmsUnreadContainer=(0,N.vz)("span",{colorClass:"numUnread",style:n}),this.chatUnreadBubble=(0,N.vz)(Ae,{unreadContainer:this.numChatUnreadContainer}),this.pmUnreadBubble=(0,N.vz)(Ae,{unreadContainer:this.numPmsUnreadContainer}),this.headerTabs=e.tabList.getList().map((function(e){return{tabName:e.getTabName(),element:(0,N.vz)(Me,{tab:e,onClick:function(){Ie.qF.fire(e.getTabName())},chatUnreadBubble:t.chatUnreadBubble,pmUnreadBubble:t.pmUnreadBubble})}})),this.element=(0,N.vz)("ul",{id:"tab-room-header",style:{borderBottomWidth:"1px",borderBottomStyle:"solid",boxSizing:"border-box",width:"100%",height:"43px",margin:0,padding:0,overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",display:"flex"},colorClass:"Header",className:"noScrollbar"},this.headerTabs.map((function(e){return e.element}))),e.tabList.getChatTab().getChatWindow().numUnreadChanged.listen((function(e){t.setChatUnreadBubble(e)})),e.tabList.getPmTab().getPmWindow().numUnreadChanged.listen((function(e){t.setPmsUnreadBubble(e)})),this.setActiveTabStyles(this.activeTab),Ie.qF.listen((function(e){var n=t.headerTabs.find((function(t){return t.tabName===e}));if(void 0!==n){var i=n.element.offsetLeft<t.element.offsetWidth/2;t.element.scrollLeft=i?0:n.element.offsetLeft,t.setActiveTab(e)}else t.setActiveTab(Re.currentTab)}))}},{key:"setChatUnreadBubble",value:function(e){e>0?(this.chatUnreadBubble.style.display="flex",e>=99?(this.numChatUnreadContainer.style.fontSize="9px",this.numChatUnreadContainer.innerText="99+"):(this.numChatUnreadContainer.style.fontSize="10px",this.numChatUnreadContainer.innerText="".concat(e))):this.chatUnreadBubble.style.display="none"}},{key:"setPmsUnreadBubble",value:function(e){e>0?(this.pmUnreadBubble.style.display="flex",e>=99?(this.numPmsUnreadContainer.style.fontSize="9px",this.numPmsUnreadContainer.innerText="99+"):(this.numPmsUnreadContainer.style.fontSize="10px",this.numPmsUnreadContainer.innerText="".concat(e))):this.pmUnreadBubble.style.display="none"}},{key:"setActiveTab",value:function(e){this.setInactiveTabStyles(this.activeTab),this.activeTab=e,this.setActiveTabStyles(this.activeTab)}},{key:"setActiveTabStyles",value:function(e){var t=this.headerTabs.find((function(t){return t.tabName===e}));void 0!==t&&((0,G.FU)(t.element,"inactiveTab"),(0,G.vP)(t.element,"activeTab"),(0,Y.Zs)(t.element,{borderBottomStyle:"solid",borderBottomWidth:"3px"}))}},{key:"setInactiveTabStyles",value:function(e){var t=this.headerTabs.find((function(t){return t.tabName===e}));if(void 0!==t){var n="roomMenu"===e;(0,G.FU)(t.element,"activeTab"),(0,G.vP)(t.element,"inactiveTab"),n&&(0,G.vP)(t.element,"roomMenu"),(0,Y.Zs)(t.element,{borderBottom:"none"})}}}]),s}(I.w),Me=function(e){var t,n="chat"===e.tab.getTabName(),i="tokens"===e.tab.getTabName(),o="roomMenu"===e.tab.getTabName(),r="pm"===e.tab.getTabName(),s={listStyleType:"none",display:"inline-block",height:"100%",lineHeight:"42px",fontFamily:"'UbuntuBold', Arial, Helvetica, sans-serif",fontSize:"14px",boxSizing:"border-box",textAlign:"center",padding:"0 10px",position:"relative",flex:1,letterSpacing:o?"1px":""},a={position:"relative",display:"flex",alignItems:"center",justifyContent:"center"};return t=n?(0,N.vz)("span",{style:a,"data-testid":"chat-tab-default"},e.tab.getTabLabel(),e.chatUnreadBubble):i?(0,N.vz)("span",null,(0,N.vz)("span",{style:{display:"inline-block",width:"16px",height:"16px",marginRight:"4px",position:"relative",top:"4px"},colorClass:"tipIcon"}),e.tab.getTabLabel()):o?(0,N.vz)("span",{style:{transform:"rotate(90deg)",display:"inline-block"}},e.tab.getTabLabel()):r?(0,N.vz)("span",{style:a,"data-testid":"pm-tab-default"},e.tab.getTabLabel(),e.pmUnreadBubble):(0,N.vz)("span",null,e.tab.getTabLabel()),(0,N.vz)("li",{style:s,colorClass:["inactiveTab"].concat([o?"roomMenu":""]),onClick:e.onClick},t)},Ae=function(e){return(0,N.vz)("span",{style:{width:"8px",height:"8px",borderRadius:"50%",display:"none",justifyContent:"center",alignItems:"center",padding:"6px",marginLeft:"4px"},colorClass:"bubble"},e.unreadContainer)};var Ee=function(e){(0,a.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function s(e){return(0,i.Z)(this,s),r.call(this,"div",e)}return(0,o.Z)(s,[{key:"initData",value:function(e){this.tabName=e.tabName,this.tabLabel=e.tabLabel,this.pageActionName=e.pageActionName}},{key:"initUI",value:function(e){this.element=(0,N.vz)("div",{style:{width:"100%",height:"100%",flex:"none",backgroundColor:"#FFF",boxSizing:"border-box"}})}},{key:"getTabName",value:function(){return this.tabName}},{key:"getTabLabel",value:function(){return this.tabLabel}},{key:"getPageActionName",value:function(){return this.pageActionName}}]),s}(I.w),Be=n(7397),Le=n(6265),Oe=n(8824);function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var Ue=function(e){(0,a.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function s(){var e;return(0,i.Z)(this,s),(e=r.call(this)).offline=!1,S.kN.listen((function(t){e.username=t.dossier.room,"bio"===Re.currentTab&&e.load(),e.offline="offline"===t.dossier.roomStatus})),Ie.qF.listen((function(t){"bio"===t&&e.load()})),S.QN.listen((function(){e.removeAllDOMChildren(),e.loadingState=0})),e}return(0,o.Z)(s,[{key:"initUI",value:function(){(0,Y.Zs)(this.element,{padding:"19px",boxSizing:"border-box"}),(0,Se.q)(this.element)}},{key:"load",value:function(){var e=this;if(!this.isLoadingOrLoaded()){this.removeAllDOMChildren();var t=(0,N.vz)(Ze,null);this.element.appendChild(t),this.loadingState=1,(0,Oe.lr)(this.username).then((function(t){e.element.appendChild((0,N.vz)(Ne,{content:t,offline:e.offline})),e.loadingState=2})).catch((function(t){error("Bio Content error",t),e.element.appendChild((0,N.vz)(Fe,null)),e.loadingState=0})).finally((function(){e.element.removeChild(t)}))}}},{key:"isLoadingOrLoaded",value:function(){return 1===this.loadingState||2===this.loadingState}}]),s}(I.w),Ze=function(){return(0,N.vz)("div",null,"".concat(D.ag.loadingText,"..."))},Fe=function(){return(0,N.vz)("div",null,D.ag.bioUnavailableText)},_e=function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){(0,_.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({fontFamily:"'UbuntuBold', Arial, Helvetica, sans-serif",display:"inline-block",color:"#49494F",fontWeight:"bold"},e.style);return(0,N.vz)("span",{style:t},e.text)},Ne=function(e){var t,n=e.content,i=n.gameSelection,o=n.infoSection,r=n.socialMedias,s=n.photoSets,a=n.aboutMe,l=n.wishList,c=o.username,u=e.offline&&c!==(null===(t=f.J.current.loggedInUser)||void 0===t?void 0:t.username);return(0,N.vz)("div",{style:{fontSize:"14px"}},(0,N.vz)("h2",{style:{fontFamily:"'UbuntuBold', Arial, Helvetica, sans-serif",margin:0,color:"#222",fontSize:"16px",marginBottom:"12px"}},"".concat(c,"'s ").concat(D.ag.bioAndFreeWebCamText)),u&&(0,N.vz)(je,{username:c}),null!=i&&(0,N.vz)(He,{gameSelection:i,username:c}),(0,N.vz)(ze,{info:o}),r.length>0&&(0,N.vz)(Ve,{socialMedias:r,username:c}),s.length>0&&(0,N.vz)(Ke,{photosets:s,username:c}),""!==a&&(0,N.vz)(Ge,{htmlString:a,sectionTitle:D.ag.aboutMeText}),""!==l&&(0,N.vz)(Ge,{htmlString:l,sectionTitle:D.ag.wishListText}))},je=function(e){return(0,N.vz)("button",{style:{width:"100%",fontFamily:"UbuntuMedium, Arial, Helvetica, sans-serif",fontSize:"16px",padding:"12px",color:"#FFF",border:"1px solid #CD5D26",backgroundColor:"#F47321",textAlign:"center",borderRadius:"4px",boxSizing:"border-box",margin:"0px 0 16px 0",display:"inline-block"},onClick:function(){(0,w.Cg)(D.ag.loggedInToDm)||(Ie.ah.fire(!0),Be.nh.fire(e.username))}},D.ag.dmMenuTitle)},He=function(e){var t;return(0,N.vz)("div",{style:{border:"1px solid #eee",borderRadius:"3px",boxShadow:"0 3px 6px 0 rgba(90, 90, 90, 0.2), 0 6px 20px 0 rgba(90, 90, 90, 0.19)",margin:"4px 0 12px 0",padding:"4px",position:"relative"}},(0,N.vz)("div",{style:{display:"inline-block",paddingRight:"4px"}},(0,N.vz)("img",{style:{width:"42px",height:"42px",borderRadius:"5px",objectFit:"cover",overflow:"hidden"},src:e.gameSelection.image})),(0,N.vz)("div",{style:{borderLeft:"2px solid #eee",bottom:0,display:"inline-block",height:"100%",overflow:"ellipsis",paddingLeft:"4px",position:"absolute",top:0}},(0,N.vz)("div",{style:{display:"inline-block",marginTop:"-0.5em",position:"relative",top:"50%",transform:"translateY(-50%)",verticalAlign:"middle"}},"".concat(null!==(t=e.username)&&void 0!==t?t:"User"," is playing "),(0,N.vz)("a",{href:e.gameSelection.gameUrl,target:"_blank",rel:"noopener"},e.gameSelection.name))))},ze=function(e){var t=e.info,n=t.realName,i=t.followersCount,o=t.displayBirthday,r=t.displayAge,s=t.bodyType,a=t.bodyDecorations,l=t.sex,c=t.subgender,u=t.interestedIn,d=t.location,h=t.lastBroadcast,f=t.languages,p=t.smokeDrink,m=t.hasFanClub,v=t.isInFanClub,g=t.fanClubJoinUrl,y=""!==u?JSON.parse(u).join(", "):"",b={width:"100%",fontFamily:"UbuntuMedium, Arial, Helvetica, sans-serif",fontSize:"16px",padding:"12px",color:"#FFF",border:"1px solid #006800",backgroundColor:"#009900",textAlign:"center",borderRadius:"4px",boxSizing:"border-box",margin:"12px 0 16px 0",display:"inline-block"};return(0,N.vz)("ul",{style:{listStyleType:"none",padding:0,margin:0}},(0,N.vz)(We,{title:D.ag.realNameText,info:n}),!isNaN(i)&&(0,N.vz)(We,{title:D.ag.followersText,info:i}),(0,N.vz)((function(){return""===l?l:"A Couple"===l?(0,N.vz)(We,{title:D.ag.sexTextCouple,info:l}):"Trans"===l&&""!==c?(0,N.vz)(We,{title:D.ag.sexText,info:"".concat(l," (").concat(c,")")}):(0,N.vz)(We,{title:D.ag.sexText,info:l})}),null),(0,N.vz)(We,{title:D.ag.birthdayText,info:o}),!isNaN(r)&&(0,N.vz)(We,{title:D.ag.ageText,info:r}),(0,N.vz)(We,{title:D.ag.bodyTypeText,info:s}),(0,N.vz)(We,{title:D.ag.bodyDecorationsText,info:a}),(0,N.vz)(We,{title:D.ag.interstedInText,info:y}),(0,N.vz)(We,{title:D.ag.locationText,info:d}),(0,N.vz)(We,{title:D.ag.lastBroadcastText,info:h}),(0,N.vz)(We,{title:D.ag.languagesText,info:f}),(0,N.vz)(We,{title:D.ag.smokeDrinkText,info:p}),m&&!v&&(0,N.vz)("a",{style:b,href:g,rel:"noopener"},D.ag.joinFanClub),m&&v&&(0,N.vz)("a",{style:b,href:g,rel:"noopener"},D.ag.inFanClub))},We=function(e){return""===e.info||void 0===e.info?"":(0,N.vz)("li",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"}},(0,N.vz)(_e,{text:"".concat(e.title,":"),style:{width:"50%"}}),(0,N.vz)("span",{style:{textAlign:"right",width:"50%",overflowWrap:"break-word",wordWrap:"break-word",hyphens:"auto"}},e.info))},Ve=function(e){return(0,N.vz)("div",{style:{position:"relative",paddingTop:"5px",paddingBottom:"25px"}},(0,N.vz)(_e,{text:"".concat(D.ag.socialMediaText,":")}),(0,N.vz)("div",{style:{textAlign:"center"}},e.socialMedias.slice(0,8).map((function(t){return(0,N.vz)(qe,{socialMedia:t,username:e.username})})),e.socialMedias.length>8&&(0,N.vz)("a",{style:{display:"block",paddingTop:"10px",color:"#156b95",textDecoration:"none"},href:"/socials/social_media/list_popup/".concat(e.username,"/"),target:"".concat(e.username," social media")},D.ag.showMoreText)))},qe=function(e){var t=(0,me._U)()/2-40,n={textDecoration:"none",marginLeft:"5px",marginRight:"5px",marginTop:"10px",position:"relative",display:"inline-block",height:"100px",border:"1px solid #ACACAC",borderRadius:"3%",maxWidth:"150px",width:"".concat(t,"px")},i={backgroundColor:e.socialMedia.labelColor,color:"#ffffff",position:"absolute",top:"80px",right:"8px",fontSize:"9px",borderRadius:"2px",padding:"1px 3px",lineHeight:"12px"},o=(0,N.vz)("div",{style:{color:"#156b95",maxWidth:"145px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}},e.socialMedia.titleName);return(0,N.vz)("a",{style:n,href:(0,g.BN)("/socials/social_media/".concat(e.username,"/").concat(e.socialMedia.id)),target:"_self",className:"userUpload",title:e.socialMedia.titleName,onMouseEnter:function(){return o.style.textDecoration="underline"},onMouseLeave:function(){return o.style.textDecoration="none"}},(0,N.vz)("img",{style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"3%"},src:e.socialMedia.imageUrl}),(0,N.vz)("span",{style:i},e.socialMedia.labelText),o)},Ke=function(e){return(0,N.vz)("div",{style:{position:"relative",paddingTop:"5px",paddingBottom:"25px"}},(0,N.vz)(_e,{text:"".concat(D.ag.photosAndVideosText,":"),style:{padding:"5px 10px 5px 0"}}),(0,N.vz)("div",{style:{textAlign:"center"}},e.photosets.slice(0,8).map((function(t){return(0,N.vz)(Je,{photoset:t,username:e.username})})),e.photosets.length>8&&(0,N.vz)("a",{style:{display:"block",paddingTop:"10px",color:"#156b95",textDecoration:"none"},href:"/photo_videos/photoset/list_popup/".concat(e.username,"/"),target:"".concat(e.username,"_photosets")},D.ag.showMoreText)))},Je=function(e){var t=void 0===f.J.current.loggedInUser,n=(0,me._U)()/2-40,i={textDecoration:"none",margin:"10px 5px 10px 5px",position:"relative",display:"inline-block",height:"100px",maxWidth:"150px",width:"".concat(n,"px")},o={width:"".concat(n,"px"),maxWidth:"150px",height:"100px",padding:"1px",borderRadius:"3%",position:"absolute",left:"0px",top:"0px",backgroundColor:"rgba(0, 0, 0, .55)"},r={marginLeft:"".concat(-9,"px"),marginTop:"".concat(-9,"px"),position:"absolute",left:"50%",top:"40%",padding:"4px",border:"none"},s={backgroundColor:e.photoset.labelColor,color:"#fff",position:"absolute",top:"80px",right:"8px",fontSize:"9px",padding:"1px 3px",lineHeight:"12px",borderRadius:"2px"},a=(0,N.vz)("div",{style:{color:"#156b95",maxWidth:"145px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}},e.photoset.name),l=(0,N.vz)(N.HY,null,(0,N.vz)("div",{style:o}),(0,N.vz)("img",{style:r,src:"".concat(STATIC_URL,"lock.svg")}),""!==e.photoset.labelText&&(0,N.vz)("span",{style:s,colorClass:"tokenText"},e.photoset.labelText)),c=(0,N.vz)("span",{style:{backgroundColor:"#6d85b5",color:"#fff",position:"absolute",top:"80px",right:"8px",padding:"1px 3px",lineHeight:"12px",borderRadius:"2px",fontSize:"9px"},colorClass:"purchasedBadge"},D.ag.purchasedCAPS),u=(0,N.vz)("img",{style:{height:"18px",position:"absolute",top:"8px",right:"32px"},src:"".concat(STATIC_URL,"no-audio.svg")}),d=(0,N.vz)("img",{style:{height:"18px",position:"absolute",top:"8px",right:"8px"},src:"".concat(STATIC_URL,"video.svg")});return(0,N.vz)("a",{style:i,href:(0,g.BN)("/photo_videos/photoset/detail/".concat(e.username,"/").concat(e.photoset.id)),target:"".concat(e.username,"_photoset"),className:"userUpload",title:e.photoset.name,onMouseEnter:function(){return a.style.textDecoration="underline"},onMouseLeave:function(){return a.style.textDecoration="none"},onClick:function(n){(0,Oe.Z7)(e.photoset,"BioTab"),t&&(n.preventDefault(),(0,Le.iW)({fromFeature:!0}))}},(0,N.vz)("img",{style:{width:"100%",height:"100%",objectFit:"cover",borderWidth:"1px",borderStyle:"solid",borderRadius:"3%",borderColor:"#ACACAC",display:"block"},src:e.photoset.coverUrl}),!e.photoset.userCanAccess&&l,e.photoset.userCanAccess&&e.photoset.userHasPurchased&&c,e.photoset.isVideo&&!e.photoset.videoHasSound&&!e.photoset.pendingApproval&&u,e.photoset.isVideo&&d,a)},Ge=function(e){var t=(0,N.vz)("div",null);return t.innerHTML=e.htmlString,(0,Oe.uc)(t,t,!0,!0),(0,N.vz)("div",null,(0,N.vz)(_e,{text:"".concat(e.sectionTitle,":")}),(0,N.vz)("div",{style:{width:"100%",overflow:"scroll"},onTouchStart:function(e){var t=function(t){var n=t;n.scrollWidth>n.clientWidth&&e.stopPropagation()};null!==e.target&&t(e.target),null!==e.currentTarget&&t(e.currentTarget)}},(0,N.vz)("div",{style:{maxWidth:"800px",display:"inline-block"}},t)))};var Ye=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(){return(0,i.Z)(this,u),r.call(this,{tabName:"bio",tabLabel:D.ag.bioText,pageActionName:"BioOpened"})}return(0,o.Z)(u,[{key:"initUI",value:function(){(0,s.Z)((0,c.Z)(u.prototype),"initUI",this).call(this),this.bioContent=new Ue,this.addChild(this.bioContent)}}]),u}(Ee),$e=n(7791),Qe=n(824),Xe=n.n(Qe),et=n(9888),tt=n(6474),nt=n(8015),it=n(5712),ot=n(6297),rt=n(4372),st=n(191),at=n(5726),lt=n(2648),ct=n(202),ut=n(6832),dt=n(4463),ht=n(8642),ft=n(1612),pt=n(5343),mt=n(10);function vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var gt=new R.xB("otherUserInitiatedPm"),yt=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(e){var t;return(0,i.Z)(this,u),(t=r.call(this,"div",e)).sendPrivateMessageFailCallback=function(e){var n=t.orderedPMSessionKeys.currentElem,i=t.pmSessions.get(n);(0,tt.Fh)()&&e.showDmLink?i.chatContents.appendMessageDiv((0,mt.x9)(e.errorMessage,e.username)):i.chatContents.appendMessageDiv((0,ct.KS)(e.errorMessage))},t}return(0,o.Z)(u,[{key:"initData",value:function(e){this.newPMSessionEvent=new R.xB("newPMSession"),this.closePMSessionEvent=new R.xB("closePMSession"),this.numUnreadChanged=new R.xB("numUnreadChanged"),this.pmSessions=new Map,this.orderedPMSessionKeys=new pt.O,this.numUnread=0,this.leavePmWindow=e.leavePmWindow}},{key:"initUI",value:function(e){var t=this;(0,Y.Zs)(this.element,{position:"static"}),this.backButtonContainer=this.createBackButton({onBackClick:this.leavePmWindow,onSendDmClick:function(){var e;if(!(0,w.Cg)(D.ag.loggedInToDm)){var n=null===(e=t.currentlyDisplayedPmSession())||void 0===e?void 0:e.user;void 0!==n&&(Ie.ah.fire(!0),Be.nh.fire(n))}}}),this.element.appendChild(this.backButtonContainer),S.kN.listen((function(e){t.chatConnection=e.chatConnection,e.dossier.userName!==e.dossier.room&&ke.sC.fire({username:e.dossier.room,focus:!1,showSupporterAlert:e.dossier.needsSupporterToPm}),e.chatConnection.event.roomNotice.listen((function(e){e.showInPrivateMessage&&t.possiblyAppendMessageDiv((0,ct.J6)(e))})),e.chatConnection.event.removeMessages.listen((function(e){t.closePMSession(e.username,!0)})),t.adjustBackButtonSize(e.dossier.userChatSettings.fontSize)})),O.gO.listen((function(e){t.adjustBackButtonSize(e.fontSize)})),ke.sC.listen((function(e){t.hideCurrentPMSession(),void 0===t.pmSessions.get(e.username)&&t.initializePmSession(e.username,!1,e.showSupporterAlert),e.focus&&(Ie.qF.fire("pm"),t.definePMLinkOnClick(e.username))})),S.Sb.listen((function(e){e.showInPrivateMessage&&t.possiblyAppendMessageDiv((0,ct.rL)(e))})),nt.Cb.listen((function(e){t.newPrivateMessage(e);var n=t.currentlyDisplayedPmSession();void 0!==n&&(t.addPageActions(n,e),e.otherUsername===n.user&&!n.chatContents.isScrolledUp()&&n.isActive()&&nt.vz.fire(n.user))})),ut.zS.conversationRead.listen((function(e){var n=e.username;if(!e.isDm){var i=t.pmSessions.get(n);void 0!==i&&t.markSessionRead(i)}})),S.QN.listen((function(){t.clear(),t.resetNumUnread()}))}},{key:"addPageActions",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(null===(n=f.J.current.loggedInUser)||void 0===n?void 0:n.username)===t.fromUser.username,r=e.user===t.fromUser.username;e.isActive()&&!i&&!o&&r&&(0,M.fg)("PMReceivedOpen",{message_id:t.messageID})}},{key:"loadHistoryMessages",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.isAllHistoryLoaded&&!e.isLoadingHistory){var i=e.chatContents.messageList.clientHeight,o=n?"0":e.chatContents.getEarliestMessageId();this.setIsLoadingHistory(e,!0),(0,tt.yW)(e.user,this.chatConnection.room(),o).then((function(n){var o=n.messages;o.length<tt.kG&&(e.isAllHistoryLoaded=!0),o.forEach((function(e){t.newPrivateMessage(e,!0)})),o.length>0&&e.chatContents.setEarliestMessageId(o[0].messageID);var r=e.chatContents.messageList.clientHeight;e.chatContents.messageListWrapper.scrollTop=r-i,t.setIsLoadingHistory(e,!1)})).catch((function(n){error(n),t.setIsLoadingHistory(e,!1)}))}}},{key:"setIsLoadingHistory",value:function(e,t){e.isLoadingHistory=t,t?e.loadHistoryMessagesDOM.showLoading():e.loadHistoryMessagesDOM.hideLoading()}},{key:"repositionChildren",value:function(){(0,s.Z)((0,c.Z)(u.prototype),"repositionChildren",this).call(this);var e=this.currentlyDisplayedPmSession();if(void 0!==e){var t=this.element.offsetHeight-(0,F.hf)()-this.backButtonContainer.offsetHeight;e.chatContents.messageListWrapper.style.height="".concat(t,"px")}}},{key:"initializePmSession",value:function(e,t,n){var i=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.pmSessions.get(e);if(void 0===r){(0,R.de)();var s=new F.Dl({onTipRequest:function(e){Ie.Fx.fire(e)},onToggleDebugMode:function(){i.chatConnection.toggleAppDebugging()},onChatMessage:function(t){i.orderedPMSessionKeys.addToTop(e),(0,tt.pc)({message:t,username:e,source:"mobilePM",roomName:i.chatConnection.room()}).catch((function(e){i.sendPrivateMessageFailCallback(e)})),nt.vz.fire(e)}},!0);if(r={chatContents:s,numUnread:0,user:e,loadHistoryMessagesDOM:new ht.OF,isInitialHistoryLoaded:!1,isNewSessionNotified:!1,isAllHistoryLoaded:!1,isLoadingHistory:!1,isActive:function(){return"none"!==s.element.style.display}},s.scrolledToBottom.listen((function(){i.currentlyDisplayedPmSession()===r&&nt.vz.fire(e)})),this.newPMSessionEvent.fire(r),this.pmSessions.set(e,r),r.chatContents.appendNoticeDiv((0,ct.KS)(D.ag.privateConversationWithText(e))),r.chatContents.appendNoticeDiv((0,ct.KS)(D.ag.conversationCautionMessage(ft.w.siteName))),!t&&n){var a,l,c=null!==(a=null===(l=f.J.current.loggedInUser)||void 0===l?void 0:l.isAgeVerified)&&void 0!==a&&a;r.chatContents.appendMessageDiv((0,ct.mp)(e,c))}else r.chatContents.appendNoticeDiv(r.loadHistoryMessagesDOM.getElement());r.chatContents.element.style.display="none",this.addChild(r.chatContents)}return o||!0!==t||r.isNewSessionNotified||(r.isNewSessionNotified=!0,gt.fire({username:e,PMChatLink:new dt.E({onClick:function(){ke.sC.fire({username:e,focus:!0,showSupporterAlert:!1})}})})),this.repositionChildren(),r}},{key:"definePMLinkOnClick",value:function(e){this.hideCurrentPMSession(),this.orderedPMSessionKeys.makeCurrent(e),this.showCurrentPMSession()}},{key:"newPrivateMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.appendMessageDiv((0,ct.d$)(e),e.fromUser.username,e.otherUsername,t);var n=(0,mt.hk)(e);void 0!==n&&this.appendMessageDiv(n,e.fromUser.username,e.otherUsername,t),this.maybeIncrementUnreadForPm(e,t)}},{key:"maybeIncrementUnreadForPm",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.fromUser.username!==(null===(t=f.J.current.loggedInUser)||void 0===t?void 0:t.username)&&!n){var i=this.pmSessions.get(e.otherUsername);!i||this.orderedPMSessionKeys.currentElem===e.otherUsername&&i.isActive()||(i.numUnread+=1,this.incrementUnread())}}},{key:"incrementUnread",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;e<=0||(this.numUnread+=e,this.numUnreadChanged.fire(this.numUnread))}},{key:"decrementUnread",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;e<=0||(this.numUnread-=e,this.numUnreadChanged.fire(this.numUnread))}},{key:"resetNumUnread",value:function(){this.numUnread=0,this.numUnreadChanged.fire(this.numUnread)}},{key:"markSessionRead",value:function(e){e.numUnread>0&&(this.decrementUnread(e.numUnread),e.numUnread=0),S.Z2.fire(e.user),nt.vz.fire(e.user)}},{key:"afterListItemRemoved",value:function(e){var t=this.pmSessions.get(e);void 0!==t&&(this.decrementUnread(t.numUnread),t.numUnread=0)}},{key:"appendMessageDiv",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.orderedPMSessionKeys.addToTop(n);var o=this.initializePmSession(n,t!==this.chatConnection.username(),!1,i);i&&!1===o.isInitialHistoryLoaded&&(o.isInitialHistoryLoaded=!0),o.isInitialHistoryLoaded&&o.chatContents.appendMessageDiv(e,void 0,!0)}},{key:"possiblyAppendMessageDiv",value:function(e){var t=this.currentlyDisplayedPmSession();void 0!==t&&t.isActive()&&t.chatContents.appendMessageDiv(e)}},{key:"getNumSessions",value:function(){return this.pmSessions.size}},{key:"currentlyDisplayedPmSession",value:function(){if(void 0!==this.orderedPMSessionKeys.currentElem)return this.pmSessions.get(this.orderedPMSessionKeys.currentElem)}},{key:"showNextPMSession",value:function(){return this.hideCurrentPMSession(),void 0!==this.orderedPMSessionKeys.nextElem()&&(this.showCurrentPMSession(),!0)}},{key:"closePMSession",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.pmSessions.get(e);if(void 0!==n){this.closePMSessionEvent.fire(n);var i=this.orderedPMSessionKeys.currentElem===e;this.orderedPMSessionKeys.remove(e),this.removeChild(n.chatContents),n.chatContents.dispose(),this.pmSessions.delete(e),i&&t&&(this.showNextPMSession()||this.leavePmWindow()),this.decrementUnread(n.numUnread),(0,R.G7)()}}},{key:"showCurrentPMSession",value:function(){if(void 0!==this.orderedPMSessionKeys.currentElem){var e=this.orderedPMSessionKeys.currentElem,t=this.pmSessions.get(e);if(void 0!==t){t.isInitialHistoryLoaded||(this.loadHistoryMessages(t,!0),t.isInitialHistoryLoaded=!0),t.chatContents.element.style.display="block";var n=t.chatContents.getActionBar();void 0!==n&&n.setScrollLeft(F.Dl.currScrollLeft),this.sendDmButton.textContent=D.ag.sendDmToUser(t.user),t.chatContents.repositionChildrenRecursive(),t.chatContents.scrollToBottom(),this.markSessionRead(t)}else error("PmWindow.showCurrentPMSession - no pm session")}else error("no currentpmsession")}},{key:"hideCurrentPMSession",value:function(){var e=this.currentlyDisplayedPmSession();void 0!==e&&(e.chatContents.element.style.display="none")}},{key:"clear",value:function(){var e,t=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return vt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(this.pmSessions.keys());try{for(t.s();!(e=t.n()).done;){var n=e.value;this.closePMSession(n)}}catch(e){t.e(e)}finally{t.f()}}},{key:"adjustBackButtonSize",value:function(e){this.backButtonContainer.style.fontSize=e}},{key:"createBackButton",value:function(e){var t=document.createElement("div");(0,Y.Zs)(t,{borderBottom:"1px solid #EFEFEF",padding:"12px",fontSize:"9pt",fontFamily:"Tahoma, Arial, Helvetica, sans-serif",boxSizing:"border-box",display:"flex",gap:"16px"});var n=document.createElement("span");return(0,Y.Zs)(n,{display:"inline-block",color:"#0471a1",flex:1}),n.onclick=e.onBackClick,n.innerText=D.ag.back,t.appendChild(n),this.sendDmButton=document.createElement("span"),(0,Y.Zs)(this.sendDmButton,{display:"inline-block",color:"#DC5500",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),this.sendDmButton.onclick=e.onSendDmClick,t.appendChild(this.sendDmButton),t}}]),u}(I.w);function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(n),!0).forEach((function(t){(0,_.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ct(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var xt=function(e){(0,a.Z)(r,e);var t,n=Ct(r);function r(){return(0,i.Z)(this,r),n.call(this)}return(0,o.Z)(r,[{key:"initData",value:function(){var e=this;this.numUnreadChanged=new R.xB("numUnreadChanged"),this.numUnread=0;var t={onTipRequest:function(e){Ie.Fx.fire(e)},onToggleDebugMode:function(){e.chatConnection.toggleAppDebugging()},onChatMessage:function(t){e.chatConnection.sendRoomMessage(t)}};this.chatContents=this.addChild((0,p.vj)()?new F.EM(wt({onShortcode:function(t){e.chatConnection.sendShortcode(t)}},t)):new F.Dl(wt({},t))),S.kN.listen((function(t){e.chatConnection=t.chatConnection,e.chatContents.appendMessageDiv((0,ct.KS)(D.ag.viewerWelcomeWarning)),e.chatContents.appendMessageDiv((0,ct.KS)(D.ag.mobileWelcomeMessage)),(0,at.Yl)(t.dossier.room,t.dossier.roomUid,t.dossier.appsRunning,"mobile").then((function(t){e.chatContents.appendMessageDiv(t)})).catch((function(){})),(0,p.vj)()&&t.chatConnection.event.roomShortcode.listen((function(t){var n=(0,ct.Ht)(t);e.chatContents.appendMessageDiv(n)})),t.chatConnection.event.roomMessage.listen((function(n){it.n.getInstance().addRecentUser(n.fromUser),e.chatContents.appendMessageDiv((0,ct.d$)(n,t.dossier.userName)),e.incrementUnread()})),t.chatConnection.event.roomNotice.listen((function(n){e.chatContents.appendMessageDiv((0,ct.J6)(n,t.dossier.userName))})),t.chatConnection.event.removeMessages.listen((function(t){e.chatContents.handleRemoveMessages(t.username)})),t.chatConnection.event.appDebugLog.listen((function(n){t.chatConnection.isAppDebuggingEnabled()&&e.chatContents.appendMessageDiv((0,ct.KS)("DEBUG: ".concat(n)))})),t.chatConnection.event.onBanSilence.listen((function(n){e.handleBanSilence(n,t)}))})),new ot.h({appendMessageDiv:function(t){return e.chatContents.appendMessageDiv(t)},removeMessageDiv:function(t){e.chatContents.removeMessageDiv(t)},getLastMessageId:function(){return e.chatContents.getLastMessageId()},messagesSinceId:function(t){return e.chatContents.messagesSinceId(t)},getMessagesScrollTop:function(){return e.chatContents.messageListWrapper.scrollTop},getMessagesOffsetHeight:function(){return e.chatContents.element.offsetHeight}}),ke.qS.listen((function(t){e.chatContents.toggleInputActionBarDisplay(),e.chatContents.customInputField.appendText(" @".concat(t," ")),"chat"!==Re.currentTab&&Ie.qF.fire("chat")})),ke.GZ.listen((function(t){t?e.chatContents.appendMessageDiv((0,ct.KS)("Debug mode enabled. Type /debug again to disable.")):e.chatContents.appendMessageDiv((0,ct.KS)("Debug mode disabled."))})),S.Sb.listen((function(t){e.chatContents.appendMessageDiv((0,ct.rL)(t))}));var n=new st.T;(0,tt.Fh)()&&nt.Kd.listen((function(t){if(n.shouldNotify(t.fromUser.username)){var i=D.ag.newDirectMessageNotice(t.otherUsername),o=new kt({onClick:function(){Ie.ah.fire(!0),Be.nh.fire(t.otherUsername)}}),r=(0,ct.PJ)(i,o.openConversationElement);e.chatContents.appendMessageDiv(r),n.preventNotifications(t.otherUsername)}}));var i=new lt.f;gt.listen((function(t){if(i.shouldNotify(t.username)){var n=D.ag.mobileNewPrivateMessageNotice(t.username),o=(0,ct.PJ)(n,t.PMChatLink.openConversationElement);e.chatContents.appendMessageDiv(o),i.preventNotifications(t.username)}})),Ie.qF.listen((function(t){if("chat"===t){e.resetNumUnread();var n=e.chatContents.getActionBar();void 0!==n&&n.setScrollLeft(F.Dl.currScrollLeft)}})),xe.w.listen((function(t){t&&e.resetNumUnread()})),S.QN.listen((function(){e.chatContents.clear(),e.resetNumUnread()}))}},{key:"incrementUnread",value:function(){"chat"!==Re.currentTab&&(this.numUnread+=1,this.numUnreadChanged.fire(this.numUnread))}},{key:"resetNumUnread",value:function(){this.numUnread=0,this.numUnreadChanged.fire(this.numUnread)}},{key:"handleBanSilence",value:(t=(0,$e.Z)(Xe().mark((function e(t,n){var i,o,r,s=this;return Xe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.dossier.userName!==n.dossier.room&&t.silencer!==n.dossier.userName){e.next=8;break}return e.next=4,(0,et.y)({bannedUser:t.silenced,createdBy:t.silencer,isSilence:!t.isBan,roomUser:n.dossier.room});case 4:i=e.sent,o=function(e){s.showLogMsg(e)},r=(0,rt.l)(this.chatContents,t,i,n,o),this.chatContents.appendMessageDiv(r);case 8:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"showLogMsg",value:function(e){this.chatContents.appendMessageDiv((0,ct.KS)(e))}},{key:"repositionChildren",value:function(){var e=this.element.offsetHeight-(0,F.hf)();this.chatContents.messageListWrapper.style.height="".concat(e,"px")}}]),r}(I.w),kt=function(e){(0,a.Z)(n,e);var t=Ct(n);function n(e){var o;return(0,i.Z)(this,n),(o=t.call(this)).config=e,o.openConversationElement=document.createElement("a"),o.openConversationElement.style.textDecoration="none",o.openConversationElement.innerText=" (".concat(D.ag.openConversationLower,")"),o.openConversationElement.style.cursor="pointer",(0,G.vP)(o.openConversationElement,"msg-link"),(0,G.vP)(o.openConversationElement,"underline-link"),o.openConversationElement.onclick=function(e){e.stopPropagation(),o.config.onClick()},o}return(0,o.Z)(n,[{key:"forceClick",value:function(){this.config.onClick()}}]),n}(I.w);var St=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(){return(0,i.Z)(this,u),r.call(this,{tabName:"chat",tabLabel:D.ag.chatCapitalized,pageActionName:"ChatOpened"})}return(0,o.Z)(u,[{key:"initUI",value:function(){(0,s.Z)((0,c.Z)(u.prototype),"initUI",this).call(this),this.chatWindow=new xt,this.addChild(this.chatWindow)}},{key:"getChatContents",value:function(){return this.chatWindow.chatContents}},{key:"getChatWindow",value:function(){return this.chatWindow}}]),u}(Ee),Tt=n(7585),It=n(6227),Rt=n(6698),Pt=n(4266);function Mt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return At(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?At(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Et=function(e){(0,a.Z)(d,e);var t,n,r=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function d(e){var t;return(0,i.Z)(this,d),(t=r.call(this,e)).roomIterator=new It.Y(10),t.visible=!1,t.disableRemovalOnScroll=e.disableRemovalOnScroll,t.loadingDiv=t.createLoadingDiv(),Pt.CU&&(0,m.j9)("pageshow",window,(function(e){e.persisted&&Rt.Bb.getInstance().safariReloadAllImages()})),t}return(0,o.Z)(d,[{key:"initData",value:function(e){if((0,s.Z)((0,c.Z)(d.prototype),"initData",this).call(this,e),this.selectedGenders=[],(0,u.IU)()){var t=window.localStorage.getItem(d.localStorageGenderKey);null!==t&&(this.selectedGenders=JSON.parse(t))}this.genderCheckboxes=[],this.isLoadingRooms=!1}},{key:"createElement",value:function(e){return(0,N.vz)("div",{style:{fontSize:"12px",overflowY:"scroll"}})}},{key:"appendRoomsToDiv",value:function(e){this.handleLoadingDivRemoval(),this.moreRoomsList.appendRooms(e)}},{key:"handleLoadingDivRemoval",value:function(){this.moreRoomsList.element.contains(this.loadingDiv)&&this.moreRoomsList.element.removeChild(this.loadingDiv)}},{key:"appendLoadingDiv",value:function(){this.isLoadingRooms=!0,this.moreRoomsList.element.appendChild(this.loadingDiv)}},{key:"handleGenderChange",value:function(){this.updateSelectedGendersFromCheckboxes(),(0,M.fg)("ChangeRoomListGender",{selectedGenders:this.selectedGenders}),(0,u.IU)()&&(0===this.selectedGenders.length?window.localStorage.removeItem(d.localStorageGenderKey):window.localStorage.setItem(d.localStorageGenderKey,JSON.stringify(this.selectedGenders))),this.resetAndLoad()}},{key:"children",value:function(){return this.moreRoomsList.rooms}},{key:"resetAndLoad",value:function(){var e,t=Mt(this.children());try{for(t.s();!(e=t.n()).done;)e.value.stopStreaming()}catch(e){t.e(e)}finally{t.f()}this.appendLoadingDiv(),this.repositionChildren(),this.loadFromNewIterator()}},{key:"loadFromNewIterator",value:function(){var e=this;this.roomIterator.setGenders(this.selectedGenders),this.appendLoadingDiv(),this.moreRoomsList.setState({roomInfoList:[]}),this.roomIterator.next().then((function(t){e.moreRoomsList.setState({roomInfoList:t}),e.repositionChildrenRecursive(),e.handleLoadingDivRemoval(),e.isLoadingRooms=!1})).catch((function(t){e.isLoadingRooms=!1,error("getNewIterator",t)}))}},{key:"loadFromCurrentIterator",value:function(){var e=this;this.isLoadingRooms||(this.appendLoadingDiv(),this.roomIterator.next().then((function(t){e.insertLoadedRooms(t)})).catch((function(t){e.isLoadingRooms=!1,error("loadMoreRooms",t)})))}},{key:"insertLoadedRooms",value:function(e){e.length>0?(this.finishInsertLoadedRooms(e),this.isLoadingRooms=!1,this.repositionChildrenRecursive(),this.loadMoreRoomsIfNearBottom(),this.latestEmptyFetch=void 0):(this.isLoadingRooms=!1,this.handleLoadingDivRemoval(),this.latestEmptyFetch=performance.now())}},{key:"finishInsertLoadedRooms",value:function(e){this.removeRoomsScrolledPastTop(),this.appendRoomsToDiv(e)}},{key:"removeRoomsScrolledPastTop",value:function(){if(void 0!==this.getScrolledElement()&&!this.disableRemovalOnScroll){var e=[];if(this.getScrolledElement().scrollTop>this.calculateScrollRemovalThreshold(15)){var t,n=Mt(this.moreRoomsList.rooms);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!(i.element.offsetTop<this.calculateScrollRemovalThreshold(10)))break;e.push(i.getRoomName())}}catch(e){n.e(e)}finally{n.f()}}var o=this.moreRoomsList.getRoomInfoList().filter((function(t){return!e.includes(t.username)})),r=this.moreRoomsList.getRoomInfoList().length-o.length;if(r>0){var s=this.moreRoomsList.element.scrollTop;this.moreRoomsList.spliceRooms(0,r),this.moreRoomsList.element.scrollTop=s-this.calculateScrollRemovalThreshold(r,!1),this.visible&&this.loadMoreRoomsIfNearBottom()}}}},{key:"loadMoreRoomsIfNearBottom",value:function(){if(void 0!==this.latestEmptyFetch){if(performance.now()-this.latestEmptyFetch<3e3)return;this.latestEmptyFetch=void 0}this.getScrolledElement().scrollTop+this.getScrolledElement().offsetHeight+this.calculateScrollRemovalThreshold(5)>=this.getScrolledElement().scrollHeight&&this.loadFromCurrentIterator()}}]),d}(Tt.I);Et.genderOptions=[["Female",D.ag.womenText],["Male",D.ag.menText],["Couple",D.ag.couplesText],["Trans",D.ag.transText]],Et.localStorageGenderKey="genders";var Bt=n(126);function Lt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ot(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ot(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function Ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Dt=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(){var e;return(0,i.Z)(this,u),(e=r.call(this,{roomListSource:"mr",animate:!0,showLocation:!0,rooms:function(){return e.state.roomInfoList}})).roomIndex=0,e}return(0,o.Z)(u,[{key:"createElement",value:function(){return(0,N.vz)("ul",{className:"list",style:u.ulStyle})}},{key:"updateState",value:function(){(0,s.Z)((0,c.Z)(u.prototype),"updateState",this).call(this),this.roomIndex=this.rooms.length}},{key:"getRoomInfoList",value:function(){return this.state.roomInfoList}},{key:"appendRooms",value:function(e){var t;(t=this.state.roomInfoList).push.apply(t,(0,Bt.Z)(e));var n,i=Lt(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;(0,s.Z)((0,c.Z)(u.prototype),"appendRoomCard",this).call(this,this.roomIndex+=1,o)}}catch(e){i.e(e)}finally{i.f()}}},{key:"spliceRooms",value:function(e,t){this.state.roomInfoList.splice(e,t);var n,i=Lt(this.rooms.splice(e,t));try{for(i.s();!(n=i.n()).done;){var o=n.value;this.removeChild(o)}}catch(e){i.e(e)}finally{i.f()}}}]),u}(n(9808).P);Dt.ulStyle={overflowY:"visible",fontSize:"12px",height:"auto",listStyle:"none",margin:0,padding:0};var Ut=n(9165),Zt=n(9482),Ft=n(8945),_t=n(322);var Nt=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(e){return(0,i.Z)(this,u),r.call(this,e)}return(0,o.Z)(u,[{key:"initData",value:function(e){(0,s.Z)((0,c.Z)(u.prototype),"initData",this).call(this,e),this.roomName=e.roomInfo.room}},{key:"afterRemovedFromParent",value:function(){this.stopStreaming(),(0,s.Z)((0,c.Z)(u.prototype),"afterRemovedFromParent",this).call(this)}},{key:"stopStreaming",value:function(){(0,Rt.E9)(this.roomName,!0)}},{key:"startStreaming",value:function(){(0,Rt._M)(this.roomName,this.img,!0,!0)}}]),u}(n(4189).jD);var jt=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(){return(0,i.Z)(this,u),r.apply(this,arguments)}return(0,o.Z)(u,[{key:"initData",value:function(e){(0,s.Z)((0,c.Z)(u.prototype),"initData",this).call(this,e),this.roomInfo=e.roomInfo,this.roomIndex=e.roomIndex}},{key:"createElement",value:function(e){var t=this,n={position:"relative",width:"auto",height:"auto",overflow:"hidden",display:"block",marginBottom:"".concat(4,"px"),borderRadius:"8px",borderWidth:"1px",borderStyle:"solid"};return this.img=(0,N.vz)(zt,{showLocation:void 0!==e.roomInfo.location,imgUrl:e.roomInfo.img}),(0,N.vz)("li",{style:n,colorClass:"MobileMoreRoomsCard",onClick:function(e){return t.fireRoomClick(e)}})}},{key:"initUI",value:function(e){(0,s.Z)((0,c.Z)(u.prototype),"initUI",this).call(this,e),this.followStar=new Ft.X({slug:e.roomInfo.room,isFollowing:e.roomInfo.isFollowing}),(0,Y.Zs)(this.followStar.element,{width:"",height:""}),this.element.appendChild((0,N.vz)(Ht,{roomInfo:this.roomInfo,roomIndex:this.roomIndex,roomImage:this.img,followStar:this.followStar}))}},{key:"setImageStreamer",value:function(){}},{key:"stopStreaming",value:function(){(0,Rt.E9)(this.roomName,!1)}},{key:"startStreaming",value:function(){(0,Rt._M)(this.roomName,this.img,!0,!1)}},{key:"getLocation",value:function(){return this.roomInfo.location}}]),u}(Nt),Ht=function(e){var t=e.roomInfo,n=t.room,i=t.label,o=t.sourceInfo,r=(0,_t._i)(o),s=r?(0,_t.yE)(o,i):i,a=(0,N.vz)(qt,{roomLabel:s});return(0,N.vz)("a",{href:(0,g.BN)("/".concat(n,"/")),"data-room-nav":"true",onClick:function(e){return e.preventDefault()}},e.roomImage,(0,N.vz)(Vt,{roomInfo:e.roomInfo}),e.followStar.element,r&&a)},zt=function(e){var t={width:"100%",height:"calc(100% - ".concat(33,"px)"),cursor:"pointer",display:"block",objectFit:"fill"};return(0,N.vz)("img",{src:e.imgUrl,colorClass:"roomImage",className:"moreRooms",style:t,"data-room-nav":"true"})},Wt=function(e){return(0,N.vz)("div",{style:void 0!==e.style?e.style:{position:"absolute",width:"100%",textAlign:"center",bottom:"12px",fontSize:"15px"}},e.roomName)},Vt=function(e){var t=e.roomInfo,n=t.room,i=t.displayAge,o=t.gender,r={display:"flex",justifyContent:"space-between",padding:"7px 8px",position:"absolute",bottom:0,boxSizing:"border-box",width:"100%",fontSize:"16px",fontFamily:"'UbuntuBold', Arial, Helvetica, sans-serif",maxHeight:"".concat(33,"px")},s={display:"flex",alignItems:"center",justifyContent:void 0!==i?"space-between":"flex-end",width:"38px"};return(0,N.vz)("div",{style:r,colorClass:"roomInfo"},(0,N.vz)(Wt,{style:{maxWidth:"calc(100% - 45px)",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},roomName:n}),(0,N.vz)("div",{style:s},void 0!==i&&(0,N.vz)("span",{colorClass:"age"},i),(0,N.vz)("img",{style:{verticalAlign:"middle",cursor:"pointer",width:"16px",height:"16px"},src:(0,Zt.Fg)(o)})))},qt=function(e){return(0,N.vz)("div",{style:{position:"absolute",width:"100%",textAlign:"center",top:"12px",color:"#FFF",fontSize:"12px",textShadow:"1px 1px 1px #000, -1px -1px 1px #000, 1px -1px 1px #000, -1px 1px 1px #000"},className:"thumbnail_label_recommender"},(0,_t.tS)(e.roomLabel))};function Kt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Jt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function Jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Gt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var Yt=function(e){(0,a.Z)(n,e);var t=Gt(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"createRoomCard",value:function(e){return new jt(e)}},{key:"createElement",value:function(){return(0,N.vz)("ul",{className:"MobileMoreRoomsList"})}}]),n}(Dt),$t=function(e){(0,a.Z)(n,e);var t=Gt(n);function n(e){var o;return(0,i.Z)(this,n),(o=t.call(this,e)).streamVisibleRoomsDebouncer=new T.d((function(){o.streamVisibleRooms()}),{bounceLimitMS:200}),o.hasInitialLoaded=!1,j.wk.listen((function(e){var t=o.children().find((function(t){return t.getRoomName()===e.roomName}));void 0!==t&&t.updateFollowStar(e.following)})),o}return(0,o.Z)(n,[{key:"updateSelectedGendersFromCheckboxes",value:function(){this.selectedGenders=[];var e,t=Kt(this.genderCheckboxes);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.checked&&this.selectedGenders.push((0,Ut.hP)(n.name))}}catch(e){t.e(e)}finally{t.f()}}},{key:"initUI",value:function(){(0,s.Z)((0,c.Z)(n.prototype),"initUI",this).call(this),this.element.appendChild(this.moreRoomsList.element),(0,Se.q)(this.moreRoomsList.element)}},{key:"initData",value:function(e){(0,s.Z)((0,c.Z)(n.prototype),"initData",this).call(this,e),this.moreRoomsList=new Yt}},{key:"createElement",value:function(e){return(0,N.vz)("div",{style:{height:"100%",overflow:"hidden"}})}},{key:"getScrolledElement",value:function(){return this.moreRoomsList.element}},{key:"createLoadingDiv",value:function(){return(0,N.vz)(Qt,null)}},{key:"roomWidth",value:function(){return((0,me._U)()-4-12)/2}},{key:"roomHeight",value:function(){return this.roomWidth()*(111/180)+33}},{key:"repositionChildren",value:function(){(0,s.Z)((0,c.Z)(n.prototype),"repositionChildren",this).call(this);var e,t=this.roomWidth(),i=Kt(this.children());try{for(i.s();!(e=i.n()).done;){var o=e.value;o.element.style.width="".concat(t,"px"),o.element.style.height="".concat(this.roomHeight(),"px")}}catch(e){i.e(e)}finally{i.f()}this.visible&&this.loadMoreRoomsIfNearBottom()}},{key:"handleScroll",value:function(){this.removeRoomsScrolledPastTop(),this.loadMoreRoomsIfNearBottom(),this.streamVisibleRoomsDebouncer.callFunc()}},{key:"listVisible",value:function(){this.visible=!0,this.hasInitialLoaded||(this.resetAndLoad(),this.hasInitialLoaded=!0)}},{key:"listHidden",value:function(){this.visible=!1;var e,t=Kt(this.children());try{for(t.s();!(e=t.n()).done;)e.value.stopStreaming()}catch(e){t.e(e)}finally{t.f()}}},{key:"streamVisibleRooms",value:function(){if(this.visible){this.repositionChildren();var e,t=Kt(this.children());try{for(t.s();!(e=t.n()).done;){var n=e.value,i=n.element.offsetTop-this.moreRoomsList.element.scrollTop,o=Math.min(0,i),r=this.moreRoomsList.element.scrollTop+this.moreRoomsList.element.offsetHeight-(n.element.offsetTop+n.element.offsetHeight),s=Math.min(0,r),a=Math.max(0,n.element.offsetHeight+s+o)/n.element.offsetHeight;n.stopStreaming(),a>=.6&&n.startStreaming()}}catch(e){t.e(e)}finally{t.f()}}}},{key:"buildGenderCheckbox",value:function(e){var t=this,n=function(){i.blur()},i=(0,N.vz)("input",{type:"checkbox",style:{height:"34px",verticalAlign:"middle"},name:e.toLowerCase(),onMouseUp:n,onTouchEnd:n,onChange:function(){t.handleGenderChange()}});i.checked=this.selectedGenders.indexOf((0,Ut.hP)(e.toLowerCase()))>-1;var o=(0,N.vz)("span",{style:{display:"inline-block",width:"44px",height:"37px",margin:"0 16px 0 8px",textAlign:"center"}},i,(0,N.vz)("img",{src:(0,Zt.Fg)(e),style:{verticalAlign:"middle",cursor:"pointer",width:"16px",height:"16px"},onClick:function(){i.checked=!i.checked,t.handleGenderChange()}}));return this.genderCheckboxes.push(i),o}},{key:"calculateScrollRemovalThreshold",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e*(this.roomHeight()+4+2)+(t?2:0)}}]),n}(Et),Qt=function(){var e={background:'url("'.concat(STATIC_URL_ROOT,'images/loading_spinner.svg")'),backgroundSize:"cover",width:"30px",height:"31px",animationName:"spin",animationDuration:"2s",animationTimingFunction:"linear",animationIterationCount:"infinite",animationDelay:"0.01s"};return(0,N.vz)("div",{style:{display:"flex",flex:1,width:"100%",justifyContent:"center",alignItems:"center"}},(0,N.vz)("div",{style:e}))},Xt=n(1177);var en=function(e){(0,a.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function s(e){var t;(0,i.Z)(this,s),(t=r.call(this,270,void 0)).player=e,t.scrollTopReference=0,t.roomList=new $t({disableRemovalOnScroll:!0}),t.genderSelection=document.createElement("div"),t.genderSelection.className="genderSelectionDiv",t.roomList.getScrolledElement().appendChild(t.genderSelection);for(var n=0,o=["Female","Male","Couple","Trans"];n<o.length;n++){var a=o[n];t.genderSelection.appendChild(t.roomList.buildGenderCheckbox(a))}return t.addChild(t.roomList),t.roomList.getScrolledElement().onscroll=function(){t.roomList.handleScroll(),t.lastScrollTop=t.roomList.getScrolledElement().scrollTop,t.showHideGenderSelection()},Ie.WP.listen((function(){t.lastScrollTop=t.roomList.getScrolledElement().scrollTop})),t}return(0,o.Z)(s,[{key:"show",value:function(){this.roomList.listVisible()}},{key:"hide",value:function(){this.roomList.listHidden()}},{key:"repositionChildren",value:function(){this.lastScrollTop===this.roomList.getScrolledElement().scrollTop&&(this.roomList.getScrolledElement().scrollTop=this.roomList.getScrolledElement().scrollTop-this.lastTopPanelHeight+this.roomList.getScrolledElement().offsetTop),this.lastPlayerHeight<this.player.element.offsetHeight?this.roomList.getScrolledElement().scrollTop+=this.player.element.offsetHeight-this.lastPlayerHeight:this.lastPlayerHeight>this.player.element.offsetHeight&&(this.roomList.getScrolledElement().scrollTop-=this.lastPlayerHeight-this.player.element.offsetHeight),this.lastPlayerHeight=this.player.element.offsetHeight,this.lastTopPanelHeight=this.roomList.getScrolledElement().offsetTop;var e=0,t=document.getElementById("tab-room-header");null!==t&&(e=t.offsetHeight);var n=document.getElementById("static-header"),i=null!==n?n.offsetHeight:0;this.roomList.element.style.height="".concat((0,me.mP)()-this.player.element.offsetHeight-e-i,"px")}},{key:"showHideGenderSelection",value:function(){this.lastScrollTop<=120?this.showGenderSelection():this.lastScrollTop-this.scrollTopReference>=120?(this.scrollTopReference=this.lastScrollTop,this.hideGenderSelection()):this.scrollTopReference-this.lastScrollTop>=120&&(this.scrollTopReference=this.lastScrollTop,this.showGenderSelection())}},{key:"showGenderSelection",value:function(){this.genderSelection.classList.remove("collapsed")}},{key:"hideGenderSelection",value:function(){this.genderSelection.classList.add("collapsed")}}]),s}(Xt.M);var tn=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(e){(0,i.Z)(this,u);var t={tabName:"moreRooms",tabLabel:D.ag.moreRoomsText,pageActionName:"MoreRoomsOpened",player:e};return r.call(this,t)}return(0,o.Z)(u,[{key:"initData",value:function(e){(0,s.Z)((0,c.Z)(u.prototype),"initData",this).call(this,e),this.player=e.player}},{key:"initUI",value:function(){var e=this;(0,s.Z)((0,c.Z)(u.prototype),"initUI",this).call(this),this.moreRooms=new en(this.player),this.addChild(this.moreRooms),Ie.qF.listen((function(t){t===e.getTabName()?e.moreRooms.show():e.moreRooms.hide()}))}}]),u}(Ee),nn=n(7122);var on=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(){return(0,i.Z)(this,u),r.call(this,{tabName:"pm",tabLabel:"PM",pageActionName:"PMOpened"})}return(0,o.Z)(u,[{key:"initData",value:function(e){var t=this;(0,s.Z)((0,c.Z)(u.prototype),"initData",this).call(this,e),S.kN.listen((function(e){t.roomName=e.chatConnection.room(),t.showPmList()}))}},{key:"initUI",value:function(){var e=this;(0,s.Z)((0,c.Z)(u.prototype),"initUI",this).call(this),this.element.classList.add("data-hj-suppress"),this.pmWindow=new yt({leavePmWindow:function(){e.showPmList()}}),this.pmList=new nn.i({onItemRemoved:function(t){e.pmWindow.afterListItemRemoved(t)},isDropdown:!1,openConversationEvent:nt.gd}),this.addChild(this.pmList),this.addChild(this.pmWindow),nt.gd.listen((function(t){e.showPmWindow(),e.pmWindow.definePMLinkOnClick(t)})),this.showPmList(),ke.sC.listen((function(t){t.focus&&e.showPmWindow()})),Ie.qF.listen((function(t){var n,i=!((null===(n=f.J.current.loggedInUser)||void 0===n?void 0:n.username)===e.roomName)&&1===e.pmList.getAllItems().length;t===e.getTabName()&&i?(e.showPmWindow(),e.pmWindow.definePMLinkOnClick(e.roomName)):e.showPmList()}))}},{key:"showPmList",value:function(){this.pmList.showElement(),this.pmWindow.hideCurrentPMSession(),this.pmWindow.element.style.visibility="hidden"}},{key:"showPmWindow",value:function(){this.pmList.hideElement(),this.pmWindow.element.style.visibility="visible"}},{key:"getPmWindow",value:function(){return this.pmWindow}}]),u}(Ee),rn=n(1194),sn=n(8958);var an=16,ln="rgb(239, 239, 239)",cn="rgb(255, 255, 255)",un=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(){return(0,i.Z)(this,u),r.apply(this,arguments)}return(0,o.Z)(u,[{key:"styleContainer",value:function(e){e.style.fontSize="".concat(an,"px")}},{key:"styleHeader",value:function(e,t){(0,s.Z)((0,c.Z)(u.prototype),"styleHeader",this).call(this,e,t),e.style.fontSize="".concat(an,"px"),e.style.padding="".concat(12,"px"),e.style.margin="0",e.style.borderBottom="".concat(1,"px solid ").concat(ln),e.style.backgroundColor="".concat("rgb(250, 250, 250)"),e.style.boxSizing="border-box"}},{key:"styleRowWrapper",value:function(e){(0,s.Z)((0,c.Z)(u.prototype),"styleRowWrapper",this).call(this,e),e.style.fontSize="".concat(an,"px"),e.style.backgroundColor="".concat(cn),e.style.padding="".concat(12,"px ").concat(18,"px"),e.style.margin="0",e.style.borderBottom="".concat(1,"px solid ").concat(ln),e.style.overflow="hidden",e.style.boxSizing="border-box"}},{key:"styleLabel",value:function(e,t){(0,s.Z)((0,c.Z)(u.prototype),"styleLabel",this).call(this,e,t),e.style.color="rgb(51, 51, 51)",e.style.fontSize="".concat(an,"px"),e.style.padding="".concat(12,"px ").concat(18,"px"),e.style.padding="0",e.style.margin="0"}},{key:"styleInput",value:function(e){(0,s.Z)((0,c.Z)(u.prototype),"styleInput",this).call(this,e),e.style.color="rgb(115, 115, 115)",e.style.fontSize="".concat(an,"px"),e.style.display="in-block",e.style.cssFloat="right",e.style.webkitAppearance="none",e.style.border="none",e.style.maxWidth="45%",e.style.padding="0",e.style.margin="0",e instanceof HTMLSelectElement&&(e.style.fontSize="".concat(an,"px"),e.style.height="",e.style.backgroundColor="".concat(cn),e.style.backgroundImage="url(".concat(STATIC_URL_MOBILE,"chevron_right_light.svg)"),e.style.backgroundRepeat="no-repeat",e.style.backgroundPosition="right bottom",e.style.backgroundSize="".concat(18,"px ").concat(18,"px"),e.style.padding="0 ".concat(20,"px 0 0"),e.style.textAlign="right",e.style.textAlignLast="right")}}]),u}(sn.h),dn=n(5042);var hn=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(e,t,n){var o;return(0,i.Z)(this,u),(o=r.call(this,e,t,n)).hue=180,o.saturation=1,o.value=1,o.parentHasTouchScrolling=!1,o.element.style.position="fixed",o.element.style.top="15%",o.element.style.boxShadow="0 20px 30px -3px rgba(0, 0, 0, 0.4), 0 8px 12px -2px rgba(0, 0, 0, 0.2)",o.element.style.backgroundColor="white",o.element.style.padding="12px",o.element.style.borderRadius="8px",o.element.style.left="10%",o.element.style.right="10%",o.hexInput.style.fontSize="16px",o.hexInput.style.backgroundColor="#f1f3f4",o.hexInput.style.color="rgb(88, 91, 94)",o.hexInput.style.padding="6px 4px",o.hexInput.style.border="none",o.hexInput.style.width="calc(100% - 33px)",o.hexInput.style.boxSizing="border-box",(0,m.j9)("input",o.hexInput,(function(){var e=o.hexInput.value;(0,dn.vq)(e)&&o.updateColorSelectors(e,!1)})),o.createSaveAndCancel(),o}return(0,o.Z)(u,[{key:"createColorCanvas",value:function(){var e=this;this.palette=document.createElement("div"),this.paletteSelector=document.createElement("div");var t=document.createElement("div");this.bar=document.createElement("div"),this.barSelector=document.createElement("div"),this.preview=document.createElement("div"),this.element.appendChild(this.palette),this.palette.appendChild(this.paletteSelector),this.element.appendChild(t),t.appendChild(this.bar),this.element.appendChild(this.preview),this.bar.appendChild(this.barSelector),this.preview.style.height="25px",this.preview.style.width="25px",this.preview.style.borderRadius="100%",this.preview.style.border="1px solid black",this.preview.style.cssFloat="left",this.preview.style.marginRight="6px",this.palette.style.width="100%",this.palette.style.height="200px",this.palette.style.position="relative",this.bar.style.background="linear-gradient(90deg,red,#ff0,#0f0,#0ff,#00f,#f0f,red)",t.style.padding="2px 0",this.bar.style.position="relative",this.bar.style.width="100%",this.bar.style.height="".concat(16,"px"),this.bar.style.borderRadius="6px",this.bar.style.margin="24px 0",this.bar.style.padding="0 4px",this.bar.style.boxSizing="border-box",this.styleSelector(this.paletteSelector),this.styleSelector(this.barSelector),this.barSelector.style.boxShadow="0 0 4px rgba(0, 0, 0, 0.8)";var n=function(t){t.stopPropagation(),t.preventDefault();var n=t.touches[0].clientX-e.bar.getBoundingClientRect().left;e.setBarSelectorPosition(n)};t.ontouchstart=function(e){n(e)},t.ontouchmove=function(e){n(e)};var i=function(t){t.stopPropagation(),t.preventDefault();var n=t.touches[0].clientX-e.palette.getBoundingClientRect().left,i=t.touches[0].clientY-e.palette.getBoundingClientRect().top;e.setPaletteSelectorPosition(n,i)};this.palette.ontouchstart=function(e){i(e)},this.palette.ontouchmove=function(e){i(e)}}},{key:"styleSelector",value:function(e){e.style.position="absolute",e.style.height="".concat(16,"px"),e.style.width="".concat(16,"px"),e.style.border="".concat(2,"px solid #fff"),e.style.borderRadius="100%",e.style["-webkit-user-select"]="none",e.style.top="".concat(-2,"px")}},{key:"setBarSelectorPosition",value:function(e){var t=Math.min(e,this.bar.offsetWidth);t=Math.max(0,t),this.hue=t/this.bar.offsetWidth*360,this.barSelector.style.left="".concat(t-this.barSelector.offsetWidth/2,"px"),this.updateColors(!0)}},{key:"setBarSelectorPercentage",value:function(e){var t=Math.min(1,e);t=Math.max(0,t),this.barSelector.style.left="".concat(t*this.bar.offsetWidth-this.barSelector.offsetWidth/2,"px")}},{key:"setPaletteSelectorPosition",value:function(e,t){var n=Math.min(e,this.palette.offsetWidth);n=Math.max(0,n),this.saturation=n/this.palette.offsetWidth;var i=Math.min(t,this.palette.offsetHeight);i=Math.max(0,i),this.value=1-i/this.palette.offsetHeight,this.paletteSelector.style.left="".concat(n-this.paletteSelector.offsetWidth/2,"px"),this.paletteSelector.style.top="".concat(i-this.paletteSelector.offsetWidth/2,"px"),this.updateColors(!0)}},{key:"setPaletteSelectorPercentage",value:function(e,t){this.paletteSelector.style.left="".concat(e*this.palette.offsetWidth-this.paletteSelector.offsetWidth/2,"px"),this.paletteSelector.style.top="".concat(t*this.palette.offsetHeight-this.paletteSelector.offsetHeight/2,"px")}},{key:"repositionChildren",value:function(){this.palette.style.height="".concat((0,me.mP)()/3,"px"),this.setPaletteSelectorPercentage(this.saturation,1-this.value),(0,ve.gr)()||this.hide()}},{key:"colorPicked",value:function(e){(0,s.Z)((0,c.Z)(u.prototype),"colorPicked",this).call(this,e),this.preview.style.backgroundColor="".concat(e)}},{key:"createSaveAndCancel",value:function(){var e=this,t=this.createButton(D.ag.saveCAPS),n=this.createButton(D.ag.cancelCAPS);t.style.backgroundColor="rgb(255, 112, 2)",n.style.backgroundColor="transparent",n.style.color="#1C6B92",n.style.marginRight="4px",t.onclick=function(){e.colorPicked(e.hexInput.value),e.hide()},n.onclick=function(){e.hide()},this.element.appendChild(t),this.element.appendChild(n)}},{key:"updateColors",value:function(e){var t=(0,dn.Bi)(this.hue,1,1);this.palette.style.background="linear-gradient(to top, rgb(0, 0, 0), transparent), linear-gradient(to left, rgb(".concat(t.red,", ").concat(t.green,", ").concat(t.blue,"), rgb(255, 255, 255))"),this.barSelector.style.backgroundColor="rgb(".concat(t.red,", ").concat(t.green,", ").concat(t.blue,")");var n=(0,dn.Bi)(this.hue,this.saturation,this.value);this.preview.style.backgroundColor="rgb(".concat(n.red,", ").concat(n.green,", ").concat(n.blue,")"),this.paletteSelector.style.backgroundColor="rgb(".concat(n.red,", ").concat(n.green,", ").concat(n.blue,")"),e&&(this.hexInput.value="#".concat((0,dn.rr)(n).toLocaleUpperCase()))}},{key:"createButton",value:function(e){var t=document.createElement("button");return t.textContent=e,t.style.borderRadius="4px",t.style.fontSize="16px",t.style.color="white",t.style.textAlign="center",t.style.cursor="pointer",t.style.border="none",t.style.padding="6px 16px",t.style.margin="12px 0 4px 0",t.style.display="inline-block",t.style.cssFloat="right",t}},{key:"updateColorSelectors",value:function(e,t){var n=(0,dn.qm)(e);this.hue=n.hue,this.saturation=n.saturation,this.value=n.value,this.setBarSelectorPercentage(this.hue/360),this.setPaletteSelectorPercentage(this.saturation,1-this.value),this.updateColors(t)}},{key:"show",value:function(e){this.initialColor=e,this.styleForShow(),this.updateColorSelectors(e,!0),void 0!==this.parent&&"touch"===this.parent.element.style["-webkit-overflow-scrolling"]&&(this.parent.element.style["-webkit-overflow-scrolling"]="",this.parentHasTouchScrolling=!0)}},{key:"hide",value:function(){(0,s.Z)((0,c.Z)(u.prototype),"hide",this).call(this),void 0!==this.parent&&this.parentHasTouchScrolling&&(this.parent.element.style["-webkit-overflow-scrolling"]="touch",this.parentHasTouchScrolling=!1)}}]),u}(n(7184).l);var fn=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(){return(0,i.Z)(this,u),r.apply(this,arguments)}return(0,o.Z)(u,[{key:"initData",value:function(){(0,s.Z)((0,c.Z)(u.prototype),"initData",this).call(this),this.showManageIgnoredUsers=new R.xB("ShowManageIgnoredUsers"),this.isAgeVerified=!1}},{key:"initUI",value:function(){var e,t=this;(0,s.Z)((0,c.Z)(u.prototype),"initUI",this).call(this),this.element.style.padding="0px",this.element.style.margin="0px",this.element.style.fontSize="".concat(16,"px"),null===(e=this.chatSettingsStyles)||void 0===e||e.styleLabel(this.manageIgnoredUsersLink,D.ag.viewEditIgnoredUsers),(0,Y.Zs)(this.form,{maxWidth:"100%"}),this.manageIgnoredUsersLink.onclick=function(){(0,w.Cg)('You must be logged in to edit ignored users. Click "OK" to login.')||t.showManageIgnoredUsers.fire(void 0)}}},{key:"handleRoomLoaded",value:function(e){(0,s.Z)((0,c.Z)(u.prototype),"handleRoomLoaded",this).call(this,e),this.isAgeVerified=e.dossier.isAgeVerified}},{key:"getStyles",value:function(){return void 0===this.chatSettingsStyles&&(this.chatSettingsStyles=new un),this.chatSettingsStyles}},{key:"getEmoticonAutocompleteDelayOptions",value:function(){return[{label:"Turn Off",value:"-1"},{label:"0s",value:"0"},{label:"0.5s",value:"500"},{label:"1s",value:"1000"},{label:"1.5s",value:"1500"}]}},{key:"getHighestTokenColorOptions",value:function(){return[{label:"Dark Purple",value:"darkpurple"},{label:"Light Purple",value:"lightpurple"},{label:"Dark Blue",value:"darkblue"},{label:"Light Blue",value:"lightblue"}]}},{key:"getSaveEndpoint",value:function(){return this.isBroadcaster()?"api/broadcasterchatsettings/":(0,s.Z)((0,c.Z)(u.prototype),"getSaveEndpoint",this).call(this)}},{key:"getSaveColorEndpoint",value:function(){return this.isBroadcaster()?"choose_broadcaster_chat_color/":(0,s.Z)((0,c.Z)(u.prototype),"getSaveColorEndpoint",this).call(this)}},{key:"getFormData",value:function(){var e=(0,s.Z)((0,c.Z)(u.prototype),"getFormData",this).call(this);return this.isBroadcaster()?(e.broadcaster_tip_volume=e.viewer_tip_volume,e):e}},{key:"isBroadcaster",value:function(){var e;return(null===(e=f.J.current.loggedInUser)||void 0===e?void 0:e.username)===this.roomName&&this.isAgeVerified}},{key:"styleWrapperCustom",value:function(e){(0,s.Z)((0,c.Z)(u.prototype),"styleWrapperCustom",this).call(this,e),e.style.padding="0"}},{key:"styleLabelCustom",value:function(e){(0,s.Z)((0,c.Z)(u.prototype),"styleLabelCustom",this).call(this,e),e.style.padding="".concat(12,"px ").concat(18,"px")}},{key:"styleEmoticonsCheckbox",value:function(e){(0,s.Z)((0,c.Z)(u.prototype),"styleEmoticonsCheckbox",this).call(this,e),e.style.margin="6px ".concat(18,"px 6px 0"),e.style.cssFloat="right"}},{key:"styleSlider",value:function(e){(0,s.Z)((0,c.Z)(u.prototype),"styleSlider",this).call(this,e),e.element.style.marginTop="2px"}},{key:"styleColorSwatch",value:function(e){(0,s.Z)((0,c.Z)(u.prototype),"styleColorSwatch",this).call(this,e),e.style.margin="11px ".concat(21,"px 11px 0px")}},{key:"createColorPickerModal",value:function(){return new hn(this.chatColorSwatch,this.onColorPicked.bind(this),this.onColorHovered.bind(this))}},{key:"updateSelectWidth",value:function(e){var t=document.createElement("span");t.style.fontSize="".concat(16),t.style.padding="0",t.style.margin="0",t.style.cssFloat="left",t.style.whiteSpace="nowrap",t.style.fontFamily=getComputedStyle(e).getPropertyValue("font-family"),t.innerText=e.options[e.selectedIndex].text,document.body.appendChild(t);var n=t.getBoundingClientRect().width;document.body.removeChild(t),e.style.width="".concat(n+18+2,"px")}}]),u}(k.l);var pn=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(){var e;(0,i.Z)(this,u),(e=r.call(this,Math.min((0,me._U)()-50,400),void 0,!0)).chatSettings=new fn,(0,Y.Zs)(e.chatSettings.element,{height:"calc(100% - 45px)"}),(0,Se.q)(e.chatSettings.element),e.addChild(e.chatSettings),e.element.style.backgroundColor="rgb(250, 250, 250)";var t,n=document.createElement("div");return n.innerText=D.ag.chatSettingsSavedText,n.style.position="absolute",n.style.top="2px",n.style.right="2px",n.style.fontFamily="UbuntuRegular, Helvetica, Arial, sans-serif",n.style.color="#000000",n.style.backgroundColor="#d8deea",n.style.border="1px solid #acacac",n.style.borderRadius="4px",n.style.padding="4px 6px",n.style.visibility="hidden",e.element.appendChild(n),e.chatSettings.chatSettingsSavedRequest.listen((function(){clearTimeout(t),(0,B.pS)(n,"250ms"),n.style.visibility="visible",t=window.setTimeout((function(){(0,B.pS)(n,"1000ms"),n.style.visibility="hidden"}),2500)})),e}return(0,o.Z)(u,[{key:"show",value:function(){(0,s.Z)((0,c.Z)(u.prototype),"show",this).call(this),this.chatSettings.getTipVolumeSlider().handleResize()}},{key:"repositionChildren",value:function(){this.width=Math.min((0,me._U)()-50,400)}}]),u}(Xt.M),mn=n(5925),vn=n(9271);function gn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var yn=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(){var e;return(0,i.Z)(this,u),(e=r.call(this,Math.min((0,me._U)()-50,400),void 0,!0,D.ag.backToChatSettings)).styles=new un,e.ignoredUsersContainer=document.createElement("div"),e.ignoredUsersList=document.createElement("div"),e.element.appendChild(e.ignoredUsersContainer),e.ignoredUsersContainer.appendChild(e.ignoredUsersList),(0,Y.Zs)(e.ignoredUsersContainer,{height:"calc(100% - 45px)"}),(0,Se.q)(e.ignoredUsersContainer),e.styles.styleContainer(e.ignoredUsersContainer),S.kN.listen((function(t){e.chatConnection=t.chatConnection,e.createIgnoredUsersList()})),e}return(0,o.Z)(u,[{key:"show",value:function(){(0,s.Z)((0,c.Z)(u.prototype),"show",this).call(this),this.createIgnoredUsersList()}},{key:"createIgnoredUsersList",value:function(){if(this.clearIgnoredUsersList(),void 0!==f.J.current.loggedInUser)if(void 0===this.chatConnection)this.ignoredUsersList.appendChild(this.createSpecialMessage(D.ag.loadingText));else{var e=(0,mn.ey)(!0);if(0===e.size)this.ignoredUsersList.appendChild(this.createSpecialMessage(D.ag.noOneIgnored));else{var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return gn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.createIgnoredUserRow(i)}}catch(e){n.e(e)}finally{n.f()}}}}},{key:"createSpecialMessage",value:function(e){var t=document.createElement("div");return this.styles.styleRowWrapper(t),t.innerText=e,t.style.borderBottom="none",t}},{key:"clearIgnoredUsersList",value:function(){for(;null!==this.ignoredUsersList.firstChild;)this.ignoredUsersList.removeChild(this.ignoredUsersList.firstChild)}},{key:"createIgnoredUserRow",value:function(e){var t=this,n=document.createElement("div"),i=document.createElement("label"),o=document.createElement("img");this.ignoredUsersList.appendChild(n),n.appendChild(i),n.appendChild(o),this.styles.styleRowWrapper(n),this.styles.styleLabel(i,e),this.styles.styleInput(o),o.src="".concat(STATIC_URL_MOBILE,"remove.svg"),o.style.height="".concat(18,"px");var r=!1,s=new vn.I(!1,(function(e,i){i?n.style.opacity="0.4":e&&((0,B.pS)(n,"opacity ".concat(100,"ms")),n.style.opacity="0",window.setTimeout((function(){t.ignoredUsersList.removeChild(n)}),100))}),(function(){n.style.opacity="1.0",r=!1}));o.onclick=function(){void 0!==t.chatConnection&&(r||(r=!0,s.dispatch(!0,t.chatConnection.unignore(e))))}}}]),u}(Xt.M);var bn={underage:D.ag.reportAbuseCatUnderage,advertising:D.ag.reportAbuseCatAdvertising,abusive:D.ag.reportAbuseCatAbusive,intoxicated:D.ag.reportAbuseCatIntoxicated,"large toy":D.ag.reportAbuseCatLarge,"offline payments":D.ag.reportAbuseCatOffline,"public broadcast":D.ag.reportAbuseCatPublic,"service uniform":D.ag.reportAbuseCatUniform,sleeping:D.ag.reportAbuseCatSleeping,gender:D.ag.reportAbuseCatGender,other:D.ag.reportAbuseCatOther},wn=function(e){(0,a.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function s(){var e;(0,i.Z)(this,s),(e=r.call(this)).closeEvent=new R.xB("reset"),e.formContainer=document.createElement("div"),e.blankOption=document.createElement("option"),e.submittedMsg=document.createElement("div"),e.categoryRequiredMsg=document.createElement("div"),e.commentsRequiredMsg=document.createElement("div"),e.categorySelect=document.createElement("select"),e.textBox=document.createElement("textarea"),e.reportAbuseForm=document.createElement("form"),e.hideTimeout=0,(0,Y.Zs)(e.element,{display:"block",color:"#6C6C78",fontSize:"14px",height:"calc(100% - 45px)",boxSizing:"border-box",position:"absolute",padding:"19px"}),(0,Se.q)(e.element,!0),e.element.appendChild(e.formContainer),e.reportAbuseForm.method="post",e.formContainer.appendChild(e.reportAbuseForm);var t=document.createElement("div");for(var n in t.style.paddingBottom="10px",t.style.width="100%",t.style.display="inline-block",t.style.maxWidth="100%",e.reportAbuseForm.appendChild(t),e.categorySelect.style.border="1px solid #A4A4A4",e.categorySelect.style.fontSize="16px",e.categorySelect.style.width="99%",e.categorySelect.style.fontFamily="UbuntuRegular, Arial, Helvetica, sans-serif",t.appendChild(e.categorySelect),e.blankOption.value="",e.blankOption.disabled=!0,e.blankOption.selected=!0,e.blankOption.textContent=D.ag.chooseCategoryText,e.categorySelect.appendChild(e.blankOption),bn){var o=document.createElement("option");o.value=n,o.innerText=bn[n],e.categorySelect.appendChild(o)}e.categoryRequiredMsg.style.display="none",e.categoryRequiredMsg.style.color="#EA3323";var a=document.createElement("span");a.textContent=D.ag.reportAbuseCategoryRequired,a.style.fontSize="14px",e.categoryRequiredMsg.appendChild(a),t.appendChild(e.categoryRequiredMsg);var l=document.createElement("p");l.style.fontWeight="bold",l.style.margin="0.5em 0px 0.2em",l.innerText=D.ag.reportAbuseAdditionalComments,t.appendChild(l),e.textBox.draggable=!1,e.textBox.maxLength=2048,e.textBox.style.boxSizing="border-box",e.textBox.style.width="100%",e.textBox.style.fontSize="16px",e.textBox.style.padding="3px",e.textBox.style.border="1px solid #A4A4A4",e.textBox.style.height="55px",e.textBox.style.fontFamily="UbuntuRegular, Arial, Helvetica, sans-serif",(0,Se.q)(e.textBox,!0),t.appendChild(e.textBox),e.commentsRequiredMsg.style.color="#EA3323",e.commentsRequiredMsg.style.display="none";var c=document.createElement("span");c.textContent=D.ag.reportAbuseDescriptionRequired,c.style.fontSize="14px",e.commentsRequiredMsg.appendChild(c),t.appendChild(e.commentsRequiredMsg);var u=document.createElement("div");u.style.paddingTop="10px";var d=document.createElement("a");d.textContent=D.ag.reportCAPS,d.style.cssFloat="right",d.style.display="block",d.style.width="auto",d.style.padding="6px 16px",d.style.fontSize="16px",d.style.color="#FFF",d.style.backgroundColor="#EA3323",u.appendChild(d),d.onclick=function(t){e.sendReport()};var h=document.createElement("a");h.textContent=D.ag.cancelText,h.style.cssFloat="right",h.style.display="block",h.style.width="auto",h.style.padding="6px 16px",h.style.fontSize="16px",h.style.color="#1C6B92",h.style.marginRight="8px",u.appendChild(h),h.onclick=function(t){e.closeEvent.fire(!0)},t.appendChild(u);var f=document.createElement("div");f.style.clear="both",t.appendChild(f);var p=document.createElement("div");p.style.fontSize="12px",p.style.marginTop="20px",p.innerText="".concat(D.ag.reportAbuseTextTerms," ");var m=document.createElement("a");return m.href=(0,g.BN)("/terms/#room-reports"),m.innerText="Terms",p.appendChild(m),t.appendChild(p),e.submittedMsg.style.display="none",e.submittedMsg.style.height="80px",e.submittedMsg.style.lineHeight="80px",e.submittedMsg.style.textAlign="center",e.submittedMsg.style.fontWeight="bold",e.submittedMsg.innerText=D.ag.commentSubmittedMessage,e.element.appendChild(e.submittedMsg),S.kN.listen((function(t){e.room=t.dossier.room})),e.categorySelect.onchange=function(){e.categoryRequiredMsg.style.display="none",e.commentsRequiredMsg.style.display="none"},e.textBox.onchange=function(){""!==e.textBox.value&&(e.commentsRequiredMsg.style.display="none")},e.element.onclick=function(e){e.stopPropagation()},e}return(0,o.Z)(s,[{key:"sendReport",value:function(){var e=this;""!==this.categorySelect.value?"other"!==this.categorySelect.value||!1!==/[a-z]{2}/i.test(this.textBox.value)?(0,g.I5)("abuse/report/".concat(this.room,"/"),{category:this.categorySelect.value,additional_comments:this.textBox.value}).then((function(t){e.formContainer.style.display="none",e.commentsRequiredMsg.style.display="none",e.showSubmitted(D.ag.commentSubmittedMessage),e.reportAbuseForm.reset(),e.delayClose(1e4)})).catch((function(t){e.formContainer.style.display="none",e.showSubmitted(t.xhr.responseText),e.delayClose(1e4)})):this.commentsRequiredMsg.style.display="block":this.categoryRequiredMsg.style.display="block"}},{key:"reset",value:function(){this.formContainer.style.display="block",this.commentsRequiredMsg.style.display="none",this.submittedMsg.style.display="none",this.categorySelect.value="",this.blankOption.setAttribute("selected","selected"),this.reportAbuseForm.reset()}},{key:"showSubmitted",value:function(e){this.submittedMsg.innerText=e,this.submittedMsg.style.display="block"}},{key:"delayClose",value:function(e){var t=this;clearTimeout(this.hideTimeout),this.hideTimeout=window.setTimeout((function(){clearTimeout(t.hideTimeout),t.closeEvent.fire(!0)}),e)}}]),s}(I.w),Cn=n(9760),xn=n(6608);function kn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var Sn=function(e){(0,a.Z)(n,e);var t=kn(n);function n(){var e;return(0,i.Z)(this,n),(e=t.call(this)).enabled=!1,e.commentTriggerEvent=new R.xB("satisfactionCommentShow"),e.hideCommentEvent=new R.xB("satisfactionCommentHide"),e.label=document.createElement("span"),e.satisfiedText=D.ag.satisfiedText,e.hideSatisfiedText=!1,e.element.style.height="",e.element.style.width="",e.element.style.position="static",e.element.style.display="block",e.element.style.cursor="pointer",e.innerDiv.style.backgroundColor="",e.innerDiv.style.textShadow="",e.innerDiv.style.color="#6C6C78",e.innerDiv.style.textDecoration="none",e.element.onclick=function(){e.divClicked()},e.percent.style.fontWeight="bold",(0,G.vP)(e.label,"satisfactionLabel"),e.label.textContent=e.satisfiedText,e.label.style.margin="0",e.label.style.verticalAlign="top",e.label.style.display="none",e.innerDiv.prepend(e.label),(0,Cn.os)(620).listen((function(t){e.hideSatisfiedText=t,e.label.textContent=e.getSatisfiedLabelText()})),e.thumbsUp.style.marginRight="20px",e.thumbsUpActive.style.marginRight="20px",e.thumbsDown.style.marginLeft="20px",e.thumbsDownActive.style.marginLeft="20px",e.disableVoting(),e}return(0,o.Z)(n,[{key:"onVoteError",value:function(){(0,s.Z)((0,c.Z)(n.prototype),"onVoteError",this).call(this),this.hideCommentEvent.fire(void 0),(0,v.Cj)(D.ag.errorVotingForUser(this.roomName))}},{key:"styleThumb",value:function(e,t){(0,s.Z)((0,c.Z)(n.prototype),"styleThumb",this).call(this,e,t),e.height=18,e.width=18,e.style.height="18px",e.style.width="18px"}},{key:"enableVoteMsg",value:function(){return D.ag.afterTipVoteSatMobileText(this.roomName,xn.Y)}},{key:"triggerComment",value:function(e){this.commentTriggerEvent.fire(e)}},{key:"stopProp",value:function(e){this.enabled&&e.stopPropagation()}},{key:"enableVoting",value:function(){this.element.style.color="#333333",this.label.style.color="#0471A1",this.enabled=!0,(0,s.Z)((0,c.Z)(n.prototype),"enableVoting",this).call(this)}},{key:"disableVoting",value:function(){this.element.style.color="#6C6C78",this.label.style.color="",this.enabled=!1,(0,s.Z)((0,c.Z)(n.prototype),"disableVoting",this).call(this)}},{key:"divClicked",value:function(){this.enabled||(0,v.Cj)(D.ag.allowToVoteMessage(this.roomName,xn.Y))}},{key:"setVoteState",value:function(e,t){(0,s.Z)((0,c.Z)(n.prototype),"setVoteState",this).call(this,e,t),t?(this.element.style.pointerEvents="none",this.element.style.opacity="0.7"):(this.element.style.pointerEvents="",this.element.style.opacity="1")}},{key:"getSatisfiedLabelText",value:function(e){return void 0!==e&&e.dossier.hideSatisfactionScore&&void 0!==e.dossier.staffInfo?this.hideSatisfiedText?"":D.ag.hiddenStaffOnlyTextCAPS:this.hideSatisfiedText?"":D.ag.satisfiedText}}]),n}(xn.v),Tn=function(e){(0,a.Z)(n,e);var t=kn(n);function n(){var e;(0,i.Z)(this,n),(e=t.call(this)).hideEvent=new R.xB("satisfactionCommentHide"),e.message=document.createElement("div"),e.commentSection=document.createElement("div"),e.label=document.createElement("p"),e.textBox=document.createElement("textarea"),e.textLimit=document.createElement("span"),e.buttonBar=document.createElement("div"),e.submittedMsg=document.createElement("p"),e.roomName="",e.submitted=!1,(0,Y.Zs)(e.element,{display:"none",position:"static",color:"#6C6C78",fontSize:"14px",height:"calc(100% - 45px)",padding:"19px",boxSizing:"border-box"}),e.element.onclick=function(e){e.stopPropagation()},(0,Se.q)(e.element),e.message.style.fontSize="14px",e.element.appendChild(e.message),e.label.style.fontWeight="bold",e.label.style.margin="0.5em 0px 0.2em",e.label.style.display="none",e.label.innerText=D.ag.optionalCommentNote,e.textBox.maxLength=155,e.textBox.style.boxSizing="border-box",e.textBox.style.width="100%",e.textBox.style.fontSize="16px",e.textBox.style.padding="3px",e.textBox.style.border="1px solid #A4A4A4",e.textBox.style.height="55px",e.textBox.style.display="none",e.textBox.style.fontFamily="UbuntuRegular, Arial, Helvetica, sans-serif",e.textBox.value="",e.textLimit.style.display="none",e.textLimit.style.float="right",e.updateTextLimit(),e.textBox.oninput=function(){e.updateTextLimit()},e.buttonBar.style.paddingTop="25px",e.buttonBar.style.display="none";var o=document.createElement("a");o.textContent=D.ag.submitCAPS,o.style.cssFloat="right",o.style.display="block",o.style.width="auto",o.style.padding="6px 16px",o.style.fontSize="16px",o.style.color="#FFF",o.style.backgroundColor="#FF7002",o.onclick=function(){e.submitComment(e.textBox.value)},e.buttonBar.appendChild(o);var r=document.createElement("a");return r.textContent=D.ag.cancelText,r.style.cssFloat="right",r.style.display="block",r.style.width="auto",r.style.padding="6px 12px",r.style.fontSize="16px",r.style.color="#1C6B92",r.style.marginRight="8px",r.onclick=function(){e.reset(),e.hide()},e.buttonBar.appendChild(r),e.submittedMsg.textContent=D.ag.commentSubmittedMessage,e.submittedMsg.style.display="none",e.submittedMsg.style.height="80px",e.submittedMsg.style.lineHeight="80px",e.submittedMsg.style.textAlign="center",e.submittedMsg.style.fontWeight="bold",e.commentSection.appendChild(e.label),e.commentSection.appendChild(e.textBox),e.commentSection.appendChild(e.textLimit),e.commentSection.appendChild(e.buttonBar),e.commentSection.appendChild(e.submittedMsg),e.element.appendChild(e.commentSection),S.kN.listen((function(t){e.setRoom(t.dossier.room)})),e}return(0,o.Z)(n,[{key:"setRoom",value:function(e){this.roomName=e,this.message.innerText=D.ag.confidentalVoteMessage(e)}},{key:"show",value:function(){this.element.style.display="block",null!==this.textBox.parentNode&&this.textBox.focus(),this.submitted&&this.delayHide(5e3)}},{key:"reset",value:function(){this.submitted=!1,this.textBox.value="",this.updateTextLimit(),this.submittedMsg.style.display="none",this.label.style.display="block",this.textBox.style.display="block",this.textLimit.style.display="block",this.buttonBar.style.display="block"}},{key:"updateTextLimit",value:function(){this.textLimit.innerText="".concat(this.textBox.value.length,"/").concat(this.textBox.maxLength)}},{key:"submitComment",value:function(e){var t=this;this.label.style.display="none",this.textBox.style.display="none",this.textLimit.style.display="none",this.buttonBar.style.display="none",this.submittedMsg.textContent=D.ag.submittingText,this.submittedMsg.style.display="block",this.submitted=!0,(0,g.I5)("tipping/add_comment/".concat(this.roomName,"/"),{comment:e}).then((function(){t.submittedMsg.textContent=D.ag.commentSubmittedMessage,t.delayHide(5e3)})).catch((function(e){error("Error rating model",e),t.submittedMsg.textContent=D.ag.errorSubmitting,t.delayHide(5e3)}))}},{key:"delayHide",value:function(e){var t=this;clearTimeout(this.hideTimeout),this.hideTimeout=window.setTimeout((function(){t.hide()}),e)}},{key:"hide",value:function(){clearTimeout(this.hideTimeout),this.element.style.display="none",this.hideEvent.fire(void 0),this.reset()}}]),n}(I.w);function In(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var Rn=function(e){(0,a.Z)(n,e);var t=In(n);function n(e){(0,i.Z)(this,n);var o={tabName:"roomMenu",tabLabel:"â€¢â€¢â€¢",pageActionName:"RoomTabOpened",player:e};return t.call(this,o)}return(0,o.Z)(n,[{key:"initUI",value:function(e){(0,s.Z)((0,c.Z)(n.prototype),"initUI",this).call(this,e),(0,Y.Zs)(this.element,{position:"relative"}),this.roomMenu=this.addChild(new Pn({player:e.player}))}},{key:"getRoomMenu",value:function(){return this.roomMenu}}]),n}(Ee),Pn=function(e){(0,a.Z)(n,e);var t=In(n);function n(e){return(0,i.Z)(this,n),t.call(this,"div",e)}return(0,o.Z)(n,[{key:"initData",value:function(e){this.room="",this.userList=new V.Z,this.satisfactionComment=new Tn,this.satisfactionCommentMenuComponent=new Xt.M((0,me._U)(),this.satisfactionComment,!0),this.reportAbuse=new wn,this.reportAbuseMenuComponent=new Xt.M((0,me._U)(),this.reportAbuse,!0),this.chatSettingsComponent=new pn,this.manageIgnoredUsers=new yn}},{key:"initUI",value:function(){var e=this;this.element=(0,N.vz)("div",{style:{width:"100%",height:"100%"}},this.createSendDmMenuItem(),this.createUserListMenuItem(),this.createSatisfactionScoreMenuItem(),this.createReportAbuseMenuItem(),this.createChatSettingsMenuItem(),this.createManageIgnoredUsersMenuItem()),(0,Se.q)(this.element),this.element.style["-webkit-overflow-scrolling"]="",this.chatSettingsComponent.chatSettings.showManageIgnoredUsers.listen((function(){e.manageIgnoredUsers.show()})),S.kN.listen((function(t){e.room=t.dossier.room,e.sendDmLabel.update({text:D.ag.sendDmToUser(e.room)})})),S.QN.listen((function(){var t;null===(t=e.activeMenuComponent)||void 0===t||t.hide(),e.satisfactionComment.hideElement(),e.satisfactionComment.reset(),e.reportAbuse.reset()})),Ie.qF.listen((function(t){"roomMenu"!==t&&e.closeActiveComponent()}))}},{key:"getUserList",value:function(){return this.userList}},{key:"getReportAbuseForm",value:function(){return this.reportAbuse}},{key:"getReportAbuse",value:function(){return this.reportAbuseMenuComponent}},{key:"getChatSettings",value:function(){return this.chatSettingsComponent}},{key:"openMenuComponent",value:function(e){this.closeActiveComponent(),this.activeMenuComponent=e,e.show()}},{key:"openMenuComponentByName",value:function(e){0===e?this.openMenuComponent(this.userList):3===e?this.openMenuComponent(this.chatSettingsComponent):2===e?this.openMenuComponent(this.reportAbuseMenuComponent):1===e&&this.openMenuComponent(this.satisfactionCommentMenuComponent)}},{key:"closeMenuComponent",value:function(e){e===this.chatSettingsComponent&&this.manageIgnoredUsers.hide(),this.activeMenuComponent=void 0,e.hide()}},{key:"closeActiveComponent",value:function(){void 0!==this.activeMenuComponent&&this.closeMenuComponent(this.activeMenuComponent)}},{key:"createSendDmMenuItem",value:function(){var e=this,t=document.createElement("div"),n=rn.d.get("MenuLabel");return this.sendDmLabel=new n({text:D.ag.sendDmToUser(this.room),style:{whiteSpace:"nowrap"},onClick:function(){(0,w.Cg)(D.ag.loggedInToDm)||(Ie.ah.fire(!0),Be.nh.fire(e.room))}},t),t}},{key:"createUserListMenuItem",value:function(){var e=this,t=document.createElement("div"),n=new(rn.d.get("MenuLabel"))({text:D.ag.usersText,onClick:function(){(0,M.fg)("UserlistOpened"),e.openMenuComponent(e.userList)},showChevron:!0},t);return V.A.listen((function(e){n.update({text:"".concat(D.ag.usersText," (").concat(e,")")})})),(0,N.vz)("div",null,t,this.userList.element)}},{key:"createSatisfactionScoreMenuItem",value:function(){var e=this,t=document.createElement("div");(0,G.vP)(t,"MenuLabel-container");var n=document.createElement("div");new(rn.d.get("MenuLabel"))({text:D.ag.satisfiedText,style:{borderBottom:"none",paddingLeft:"0"}},n);var i=new Sn;return i.commentTriggerEvent.listen((function(t){t&&e.satisfactionComment.reset(),e.satisfactionComment.showElement(),e.openMenuComponent(e.satisfactionCommentMenuComponent)})),i.hideCommentEvent.listen((function(){e.closeMenuComponent(e.satisfactionCommentMenuComponent)})),this.satisfactionComment.hideEvent.listen((function(){e.closeMenuComponent(e.satisfactionCommentMenuComponent)})),t.appendChild(n),t.appendChild(i.element),(0,N.vz)("div",null,t,this.satisfactionCommentMenuComponent.element)}},{key:"createReportAbuseMenuItem",value:function(){var e=this,t=document.createElement("div");return new(rn.d.get("MenuLabel"))({text:D.ag.reportAbuseText,style:{color:"#C41721"},onClick:function(){e.openMenuComponent(e.reportAbuseMenuComponent)},showChevron:!0},t),this.reportAbuse.closeEvent.listen((function(t){t&&e.reportAbuse.reset(),e.closeMenuComponent(e.reportAbuseMenuComponent)})),(0,N.vz)("div",null,t,this.reportAbuseMenuComponent.element)}},{key:"createChatSettingsMenuItem",value:function(){var e=this,t=document.createElement("div");return new(rn.d.get("MenuLabel"))({text:D.ag.chatSettings,onClick:function(){(0,M.fg)("SettingsOpened"),e.openMenuComponent(e.chatSettingsComponent)},showChevron:!0},t),(0,N.vz)("div",null,t,this.chatSettingsComponent.element)}},{key:"createManageIgnoredUsersMenuItem",value:function(){return(0,N.vz)("div",null,this.manageIgnoredUsers.element)}}]),n}(I.w),Mn=n(795),An=n(2425),En=n(5937),Bn=n(5537);var Ln=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(){return(0,i.Z)(this,u),r.call(this,{tabName:"tokens",tabLabel:(0,En.bA)()?D.ag.tippingLabel:D.ag.tokensCC,pageActionName:"TipTabOpened"})}return(0,o.Z)(u,[{key:"initUI",value:function(){var e=this;(0,s.Z)((0,c.Z)(u.prototype),"initUI",this).call(this),(0,G.vP)(this.element,"TokensTab"),(0,Y.Zs)(this.element,{position:"relative",display:"flex",flexDirection:"column"}),this.appPanel=new An.C5,this.privateShowButton=new Bn.lC,this.fanclubButton=new Bn.ZF,this.supporterButton=new Bn.u5,this.tokenBalanceText=(0,N.vz)("span",{colorClass:"tokenBalance"}),this.tipButtonText=(0,N.vz)("span",null,D.ag.tipUser("")),this.element.appendChild((0,N.vz)(N.HY,null,(0,N.vz)(On,{appPanel:this.appPanel,privateShowButton:this.privateShowButton,fanclubButton:this.fanclubButton,supporterButton:this.supporterButton}),(0,N.vz)(Un,{tokenBalanceText:this.tokenBalanceText,tipButtonText:this.tipButtonText}))),S.kN.listen((function(t){e.updateTokenBalance(t.dossier.tokenBalance),e.tipButtonText.innerText=D.ag.tipUser(t.dossier.room),t.chatConnection.event.statusChange.listen((function(t){var n=f.J.current.PurchaseEventSources.TOKEN_SOURCE_MOBILE_TOKENS_TAB_TOKEN_BAR,i=e.element.querySelector("#tokenPurchaseLink");"privatewatching"===t.currentStatus?i.onclick=function(){return(0,Mn.Hi)({source:n,roomType:"private"})}:i.onclick=function(){return(0,Mn.Hi)({source:n,roomType:"public"})}})),e.repositionChildren()})),this.appPanel.panelUpdated.listen((function(){e.appPanel.hasContent?e.appPanel.showElement():e.appPanel.hideElement()})),d.A3.listen((function(t){e.updateTokenBalance(t.tokens)}))}},{key:"updateTokenBalance",value:function(e){this.tokenBalanceText.innerText="".concat(e.toLocaleString()," ").concat(D.ag.tokenOrTokensText(e,!1))}},{key:"repositionChildren",value:function(){(0,Y.Zs)(this.fanclubButton.element,{marginRight:this.supporterButton.isShown()?"10px":""})}}]),u}(Ee),On=function(e){(0,Y.Zs)(e.appPanel.element,{padding:"16px 0 0"});var t=(0,N.vz)("div",{style:{flex:1,overflowY:"scroll"}},(0,N.vz)("div",{style:{width:"100%",display:"flex",justifyContent:"center",position:"relative"}},e.appPanel.element),(0,N.vz)(Dn,{privateShowButton:e.privateShowButton,fanclubButton:e.fanclubButton,supporterButton:e.supporterButton}));return(0,Se.q)(t),t},Dn=function(e){return(0,N.vz)("div",{style:{padding:"16px",fontSize:"14px",width:"100%",boxSizing:"border-box"}},e.privateShowButton.element,(0,N.vz)("div",{style:{display:"flex"}},e.fanclubButton.element,e.supporterButton.element))},Un=function(e){var t=f.J.current.PurchaseEventSources.TOKEN_SOURCE_MOBILE_TOKENS_TAB_TOKEN_BAR;return(0,N.vz)("div",{style:{width:"100%",borderTop:"1px solid #EFEFEF",padding:"16px 18px 12px 18px",display:"flex",flexDirection:"column",boxSizing:"border-box",fontSize:"14px"}},(0,N.vz)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"12px"}},(0,N.vz)("div",{style:{fontFamily:"UbuntuBold, Helvetica, Arial, sans-serif"}},(0,N.vz)("span",{colorClass:"youHave"},"".concat(D.ag.tokensLabel," ")),e.tokenBalanceText),(0,N.vz)("a",{id:"tokenPurchaseLink",onClick:function(){return function(){return(0,Mn.Hi)({source:t,roomType:"public"})}}},D.ag.buyMoreTokens)),new Bn.Ug({tipButtonText:e.tipButtonText}).element)},Zn=function(){function e(t){(0,i.Z)(this,e),this.player=t,this.chatTab=new St,this.pmTab=new on,this.tokensTab=new Ln,this.bioTab=new Ye,this.moreRoomsTab=new tn(this.player),this.roomMenuTab=new Rn(this.player),this.tabList=[this.chatTab,this.pmTab,this.tokensTab,this.bioTab,this.moreRoomsTab,this.roomMenuTab]}return(0,o.Z)(e,[{key:"getList",value:function(){return this.tabList}},{key:"length",value:function(){return this.tabList.length}},{key:"getTabByIndex",value:function(e){if(!(e<0||e>=this.length()))return this.tabList[e]}},{key:"getIndexByTabName",value:function(e){var t=this.tabList.findIndex((function(t){return t.getTabName()===e}));return t>-1?t:void 0}},{key:"getChatTab",value:function(){return this.chatTab}},{key:"getPmTab",value:function(){return this.pmTab}},{key:"getTokensTab",value:function(){return this.tokensTab}},{key:"getBioTab",value:function(){return this.bioTab}},{key:"getMoreRoomsTab",value:function(){return this.moreRoomsTab}},{key:"getRoomMenuTab",value:function(){return this.roomMenuTab}}]),e}(),Fn=n(5004);var _n=function(e){(0,a.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function s(e){return(0,i.Z)(this,s),r.call(this,"div",e)}return(0,o.Z)(s,[{key:"initData",value:function(e){this.player=e.player,this.mobileDismissibleMessages=e.mobileDismissibleMessages,this.tabList=new Zn(this.player),this.userPanel=new Fn.i}},{key:"initUI",value:function(){var e=this,t={width:"100%",height:"100%",top:"".concat((0,me._U)()*ue.$V,"px"),position:"absolute",boxSizing:"border-box"};this.element=(0,N.vz)("div",{style:t}),this.header=new Pe({tabList:this.tabList}),this.addChild(this.header),this.roomTabs=new Re({tabList:this.tabList}),this.addChild(this.roomTabs),this.player.didRepositionEvent.listen((function(){e.repositionChildrenRecursive()})),this.initListenersForUserPanel()}},{key:"initListenersForUserPanel",value:function(){var e=this;Ie.tB.listen((function(t){e.closeUserPanel(),e.openUserPanel(t)})),this.userPanel.overlayClick.listen((function(){e.closeUserPanel()})),Ie.U9.listen((function(){e.closeUserPanel()})),Ie.qF.listen((function(){e.closeUserPanel()}))}},{key:"openUserPanel",value:function(e){this.userPanel.updateContents(e.username,e.message);var t=e.attachTo;null!==t.parentElement?(t.parentElement.insertBefore(this.userPanel.overlay,t.nextSibling),t.parentElement.insertBefore(this.userPanel.element,t.nextSibling)):error("Error inserting userPanel.overlay or userPanel.div: panelRequest.attachTo.parentElement is null"),this.scrollMessageList(e),this.userPanel.showOverlay()}},{key:"closeUserPanel",value:function(){this.userPanel.hideOverlay(),null!==this.userPanel.element.parentElement&&this.userPanel.element.parentElement.removeChild(this.userPanel.element)}},{key:"scrollMessageList",value:function(e){var t,n=this.tabList.getChatTab().getChatWindow().chatContents.messageListWrapper,i=null===(t=this.tabList.getPmTab().getPmWindow().currentlyDisplayedPmSession())||void 0===t?void 0:t.chatContents.messageListWrapper,o="chat"===Re.currentTab?n:i,r=e.attachTo.parentElement;if(null!==r&&void 0!==o){var s=r.offsetTop+r.offsetHeight-(o.offsetHeight+o.scrollTop);s>0&&(o.scrollTop+=s)}}},{key:"getChatContents",value:function(){return this.tabList.getChatTab().getChatContents()}},{key:"repositionChildren",value:function(){var e;!(0,ve.gr)()||this.player.isFullscreen?this.hideElement():(this.player.isFullscreen||(this.showElement(),null===(e=this.player.videoControls.mobilePureChat)||void 0===e||e.setVisible(!1)),this.repositionContainer(),this.repositionRoomTabs())}},{key:"repositionContainer",value:function(){var e,t,n,i,o=null!==(e=null===(t=document.getElementById("static-header"))||void 0===t?void 0:t.offsetHeight)&&void 0!==e?e:40,r=this.player.element.offsetHeight,s=null!==(n=null===(i=this.mobileDismissibleMessages)||void 0===i?void 0:i.element.offsetHeight)&&void 0!==n?n:0,a=(0,me.RK)().height-o-r-s;this.element.style.height="".concat(a,"px"),this.element.style.top="".concat(r,"px")}},{key:"repositionRoomTabs",value:function(){var e=this.header.element.offsetHeight;this.roomTabs.element.style.height="calc(100% - ".concat(e,"px)")}}]),s}(I.w);function Nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function jn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nn(Object(n),!0).forEach((function(t){(0,_.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Hn=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(){var e;return(0,i.Z)(this,u),(e=r.call(this)).chatResizeCount=0,e.videoResize={videoResizeCount:0,videoRepositionCount:0},e.actionName="SessionMetricsMobile",e.onChatResize=function(){e.chatResizeCount+=1,e.saveToStorage()},e.onPlayerResize=function(t){var n=t.changeType;"landscapeFullscreen"!==e.currentMode&&(0===n?(e.videoResize.videoResizeCount+=1,e.recordResize()):1===n&&(e.videoResize.videoRepositionCount+=1),e.saveToStorage())},e.loadFromStorage(),e.currentMode=e.getMode(),he.Ap.listen(e.onChatResize),he.zy.listen(e.onPlayerResize),e}return(0,o.Z)(u,[{key:"setupModeChangeListener",value:function(){var e;ve.bs.listen(this.onModeChange),null===(e=this.player)||void 0===e||e.toggleFullscreen.listen(this.onModeChange)}},{key:"bindPlayer",value:function(e){this.player=e}},{key:"playerDimensions",value:function(){void 0!==this.player&&(this.playerHeight=this.player.element.offsetHeight,this.playerWidth=this.player.element.offsetWidth,this.oldChat=screen.availHeight-this.playerHeight)}},{key:"getCurrentMode",value:function(){return this.currentMode}},{key:"resetMetrics",value:function(){(0,s.Z)((0,c.Z)(u.prototype),"resetMetrics",this).call(this),this.chatResizeCount=0,this.videoResize={videoResizeCount:0,videoRepositionCount:0},Boolean(window.sessionStorage)&&window.sessionStorage.removeItem(this.actionName)}},{key:"getPageActionAttributes",value:function(){return jn(jn({},(0,s.Z)((0,c.Z)(u.prototype),"getPageActionAttributes",this).call(this)),{},{videoResizeCount:this.videoResize.videoResizeCount,videoRepositionCount:this.videoResize.videoRepositionCount,chatResizeCount:this.chatResizeCount})}},{key:"getMode",value:function(){return(0,ve.gr)()?void 0!==this.player?this.player.isFullscreen?"portraitFullscreen":"portraitClassic":(0,se.rm)()?"portraitFullscreen":"portraitClassic":"landscapeFullscreen"}},{key:"loadFromStorage",value:function(){if(Boolean(window.sessionStorage)){var e=window.sessionStorage.getItem(this.actionName);if(null!==e){var t=JSON.parse(e);this.videoResize.videoResizeCount=t.videoResizeCount,this.videoResize.videoRepositionCount=t.videoRepositionCount,this.chatResizeCount=t.chatResizeCount}}}},{key:"saveToStorage",value:function(){Boolean(window.sessionStorage)&&window.sessionStorage.setItem(this.actionName,JSON.stringify({videoResizeCount:this.videoResize.videoResizeCount,videoRepositionCount:this.videoResize.videoRepositionCount,chatResizeCount:this.chatResizeCount}))}},{key:"recordResize",value:function(){if(void 0!==this.player){var e=screen.availHeight-this.player.element.offsetHeight;(0,M.fg)("VideoResized",{video_height_old:this.playerHeight,video_height_new:this.player.element.offsetHeight,video_width_old:this.playerWidth,video_width_new:this.player.element.offsetWidth,chat_height_old:this.oldChat,chat_height_new:e,chat_width_old:screen.availWidth,chat_width_new:screen.availWidth}),this.playerHeight=this.player.element.offsetHeight,this.playerWidth=this.player.element.offsetWidth,this.oldChat=e}}}]),u}(n(8747).d);var zn=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(){return(0,i.Z)(this,u),r.apply(this,arguments)}return(0,o.Z)(u,[{key:"styleButtonMenuItem",value:function(e){e.dt.style.fontWeight="bold"}},{key:"createCommonButton",value:function(){var e=(0,s.Z)((0,c.Z)(u.prototype),"createCommonButton",this).call(this);return(0,G.vP)(e,"mobile"),e.style.fontFamily="UbuntuRegular, Arial, Helvetica, sans-serif",e.style.verticalAlign="text-top",e}}]),u}(Mn.IK);function Wn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Vn=function(e){(0,a.Z)(h,e);var t,n,r=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function h(e,t){var n;(0,i.Z)(this,h),(n=r.call(this)).tipSource=e,n.player=t,n.isHighTipAmountWarningActive=!1,n.inputFieldHasFocus=!1,n.roomType="public",n.useDifferentKeyboard=(0,En.JR)(),n.tipSent=S.q,n.closed=new R.xB("tipClosed"),n.isSamsungBrowser=navigator.userAgent.indexOf("SamsungBrowser")>-1,n.element.style.display="none",n.element.style.overflow="visible",n.element.style.zIndex="1003",n.element.style.backgroundColor="rgba(0, 0, 0, 0.7)",n.element.style.height=n.isSamsungBrowser?"100%":"calc(100% - ".concat(n.player.element.offsetHeight,"px)"),n.element.style.bottom="0",n.element.style.alignItems="center",n.element.style.justifyContent="center",n.element.dataset.testid="send-tip-callout",n.overlay=document.createElement("div"),n.overlay.style.position="fixed",n.overlay.style.top="0",n.overlay.style.left="0",n.overlay.style.right="0",n.overlay.style.bottom="0",n.overlay.onclick=function(){n.tipSent.fire({})},n.element.appendChild(n.overlay);var o=document.createElement("div");n.element.appendChild(o),n.closeWindowDiv=document.createElement("div"),n.closeWindowDiv.innerText="".concat(D.ag.closeWindow," (").concat(D.ag.cancelLower,")"),n.closeWindowDiv.style.color="#ffffff",n.closeWindowDiv.style.fontSize="14px",n.closeWindowDiv.style.fontWeight="bold",n.closeWindowDiv.style.textDecoration="underline",n.closeWindowDiv.style.position="relative",n.closeWindowDiv.style.paddingBottom="6px",n.closeWindowDiv.style.cursor="pointer",n.closeWindowDiv.style.width="100%",n.closeWindowDiv.style.textAlign="right",n.closeWindowDiv.style.cursor="pointer",n.closeWindowDiv.dataset.testid="close-tip",n.closeWindowDiv.onclick=function(){n.tipSent.fire({})},o.appendChild(n.closeWindowDiv),n.content=document.createElement("div"),n.content.style.position="relative",n.content.style.overflow="visible",n.content.style.backgroundColor="#ffffff",n.content.style.height="auto",n.content.style.borderRadius="6px",n.content.style.border="1px solid #000000",(0,m.j9)("click",n.content,(function(e){e.stopPropagation()}));var s=document.createElement("div"),a=document.createElement("span");a.innerText=D.ag.currentBalanceText,a.style.display="inline-block",a.style.fontSize="13px",a.style.padding="6px",s.appendChild(a),n.tokenBalanceSpan=document.createElement("span"),n.tokenBalanceSpan.style.display="inline-block",n.tokenBalanceSpan.style.color="#53843a",n.tokenBalanceSpan.style.fontSize="13px",n.tokenBalanceSpan.style.padding="6px 6px 6px 0",n.tokenBalanceSpan.dataset.testid="token-balance",s.appendChild(n.tokenBalanceSpan);var l=document.createElement("a");l.innerText=D.ag.purchaseTokensText,l.style.display="inline-block",l.style.color="#f47321",l.style.fontSize="13px",l.style.marginLeft="12px",l.style.padding="6px",l.dataset.testid="purchase-tokens",l.onclick=function(){var e=f.J.current.PurchaseEventSources.TOKEN_SOURCE_TIP_CALLOUT;(0,Mn.Hi)({source:e,roomType:n.roomType}),n.tipSent.fire({})},s.appendChild(l),n.content.appendChild(s),n.lowScoreWarning=document.createElement("div"),n.lowScoreWarning.style.display="none",n.lowScoreWarning.style.color="#ff0000",n.lowScoreWarning.style.fontSize="13px",n.lowScoreWarning.style.fontWeight="bold",n.lowScoreWarning.style.padding="6px",n.lowScoreWarning.style.textAlign="center";var c=document.createElement("div");c.innerText=D.ag.satisfactionWarningText,n.lowScoreWarning.appendChild(c);var u=document.createElement("div");u.innerText=D.ag.tipWarningText,n.lowScoreWarning.appendChild(u),n.content.appendChild(n.lowScoreWarning),n.sendTipForm=document.createElement("form");var p=document.createElement("div");(0,Y.Zs)(p,{display:"flex",alignItems:"center",marginTop:"12px",marginBottom:"6px"});var v=document.createElement("span");v.innerText=D.ag.tipAmountText,v.style.display="inline-block",v.style.fontSize="13px",v.style.padding="6px",p.appendChild(v),n.tipAmountInput=document.createElement("input"),n.tipAmountInput.type=n.useDifferentKeyboard?"number":"tel",n.tipAmountInput.autocomplete="off",n.tipAmountInput.value="25",n.useDifferentKeyboard||(n.tipAmountInput.min="1"),n.tipAmountInput.style.width="0",n.tipAmountInput.style.flex="1",n.tipAmountInput.style.maxWidth="6em",n.tipAmountInput.style.minWidth="2em",n.tipAmountInput.style.display="inline-block",n.tipAmountInput.style.fontSize="16px",n.tipAmountInput.style.padding="4px",n.tipAmountInput.style.border="1px solid #4b4c4b",n.tipAmountInput.style.borderRadius="4px",n.tipAmountInput.style.fontFamily="UbuntuRegular, Helvetica, Arial, sans-serif",n.tipAmountInput.classList.add("tipAmountInput"),n.tipAmountInput.dataset.testid="tip-amount-input",n.tipAmountInput.onclick=function(){n.tipAmountInput.setSelectionRange(0,n.tipAmountInput.value.length)},n.tipAmountInput.onmouseup=function(e){e.preventDefault()},n.tipAmountInput.onfocus=function(){n.inputFieldHasFocus=!0,n.useDifferentKeyboard?n.tipAmountInput.select():n.tipAmountInput.setSelectionRange(0,n.tipAmountInput.value.length)},n.tipAmountInput.onblur=function(){n.inputFieldHasFocus=!1,""===n.tipAmountInput.value&&(n.tipAmountInput.value="0")},n.tipAmountInput.oninput=function(){n.cleanTipAmountValue(),n.tipAmountChange()},n.tipAmountInput.onkeydown=function(e){e.metaKey||"Unidentified"===e.key||"Backspace"===e.key||"Enter"===e.key||"0123456789".includes(e.key)||e.preventDefault()},n.tipAmountInput.onpaste=function(){window.setTimeout((function(){n.cleanTipAmountValue()}),0)},p.appendChild(n.tipAmountInput),n.invalidTipAmountSpan=document.createElement("span"),n.invalidTipAmountSpan.innerText=D.ag.tipAmountInvalid,n.invalidTipAmountSpan.style.fontSize="12px",n.invalidTipAmountSpan.style.color="#ff0000",n.invalidTipAmountSpan.style.display="none",n.invalidTipAmountSpan.style.marginLeft="5px",n.invalidTipAmountSpan.style.marginRight="5px",n.invalidTipAmountSpan.dataset.testid="invalid-tip",p.appendChild(n.invalidTipAmountSpan),n.sendTipForm.appendChild(p),n.tipMessageLabel=document.createElement("div"),n.tipMessageLabel.innerText=D.ag.defaultTipMessageLabel,n.tipMessageLabel.style.fontSize="13px",n.tipMessageLabel.style.padding="6px 6px 0 6px",n.sendTipForm.appendChild(n.tipMessageLabel),n.tipMessageDiv=document.createElement("div"),n.tipMessageTextarea=document.createElement("textarea"),n.tipMessageTextarea.maxLength=255,n.tipMessageTextarea.style.width="100%",n.tipMessageTextarea.style.resize="none",n.tipMessageTextarea.style.fontSize="1em",n.tipMessageTextarea.style.fontFamily="UbuntuRegular, Helvetica, Arial, sans-serif",n.tipMessageTextarea.style.margin="".concat(d.Co,"px"),n.tipMessageTextarea.style.padding="4px",n.tipMessageTextarea.style.border="1px solid #4b4c4b",n.tipMessageTextarea.style.borderRadius="4px",n.tipMessageTextarea.style.boxSizing="border-box",n.tipMessageTextarea.classList.add("tipMessageTextarea"),n.tipMessageTextarea.dataset.testid="tip-message-textarea",n.tipMessageTextarea.onfocus=function(){n.inputFieldHasFocus=!0},n.tipMessageTextarea.onblur=function(){n.inputFieldHasFocus=!1},n.tipMessageDiv.appendChild(n.tipMessageTextarea),n.sendTipForm.appendChild(n.tipMessageDiv);var g=document.createElement("div");return g.style.textAlign="right",g.style.position="relative",n.sendTipButton=new zn,n.sendTipButton.element.style.cssFloat="",n.addChild(n.sendTipButton,g),n.sendTipForm.appendChild(g),n.content.appendChild(n.sendTipForm),o.appendChild(n.content),n.closed.listen((function(){n.sendTipButton.hideMenu()})),S.kN.listen((function(e){n.hasLowSatisfactionScore=e.dossier.hasLowSatisfactionScore,n.roomName=e.chatConnection.room(),e.chatConnection.event.statusChange.listen((function(e){"privatewatching"===e.currentStatus?(n.roomType="private",l.onclick=function(){var e=f.J.current.PurchaseEventSources.TOKEN_SOURCE_TIP_CALLOUT;(0,Mn.Hi)({source:e,roomType:"private"}),n.tipSent.fire({})}):(n.roomType="public",l.onclick=function(){var e=f.J.current.PurchaseEventSources.TOKEN_SOURCE_TIP_CALLOUT;(0,Mn.Hi)({source:e,roomType:"public"}),n.tipSent.fire({})})}))})),n.repositionChildren(),(0,m.j9)("submit",n.sendTipForm,(function(e){e.preventDefault();var t=parseInt(n.tipAmountInput.value);if(!isNaN(t)&&n.sendTipButton.isEnabled()){if(n.useDifferentKeyboard&&n.tipAmountInput.blur(),(0,M.fg)("SendTipClicked",{amount:t}),t>100&&!n.isHighTipAmountWarningActive)return n.sendTipButton.promptUser(D.ag.tipConfirmationMessage(t)),n.isHighTipAmountWarningActive=!0,void n.repositionChildren();var i=n.tipMessageTextarea.value;void 0!==n.tipOptionsSelect&&(i=""===n.tipMessageTextarea.value?n.tipOptionsSelect.value:"".concat(n.tipOptionsSelect.value," | ").concat(n.tipMessageTextarea.value)),(0,d.d1)({roomName:n.roomName,tipAmount:n.tipAmountInput.value,message:i,source:n.tipSource,tipRoomType:n.roomType,tipType:n.sendTipButton.getTipType(),videoMode:"mobile"}).then((function(e){e.success?(0,M.fg)("SendTipSuccess",{amount:t}):void 0!==e.error?(0,Mn.dg)("".concat(e.error),!1,f.J.current.PurchaseEventSources.TOKEN_SOURCE_LOW_TOKEN_BALANCE,n.roomType):error("unknown send tip error"),n.removeHighTipAmountWarning(),n.tipMessageTextarea.value="",void 0!==e.tipsInPast24Hours&&d.H2.fire({tokens:e.tipsInPast24Hours,roomName:n.roomName}),n.tipSent.fire({amount:t,success:e.success})})).catch((function(e){n.tipSent.fire({amount:t,success:!1}),error("Error sending tip (".concat(e,")"))})),n.hide()}})),n}return(0,o.Z)(h,[{key:"cleanTipAmountValue",value:function(){var e=this.tipAmountInput.value.replace(/[^0-9]+/g,"");this.tipAmountInput.value="",this.tipAmountInput.value=e}},{key:"repositionChildren",value:function(){(0,ve.gr)()?(!(0,u.Tt)()&&this.inputFieldHasFocus||this.isSamsungBrowser?this.element.style.height="100%":this.element.style.height="calc(100% - ".concat(this.player.element.offsetHeight,"px)"),this.content.style.width="".concat(Math.min(.9*(0,me._U)(),500),"px"),this.tipMessageDiv.style.width="".concat(this.content.clientWidth-2*d.Co,"px")):this.hide()}},{key:"removeHighTipAmountWarning",value:function(){this.sendTipButton.cancelPrompt(),this.isHighTipAmountWarningActive=!1}},{key:"tipAmountChange",value:function(){/^[1-9]\d*$/.test(this.tipAmountInput.value)?(this.sendTipButton.enable(),this.invalidTipAmountSpan.style.display="none"):(this.sendTipButton.disable(),this.invalidTipAmountSpan.style.display="inline-block"),this.isHighTipAmountWarningActive&&this.removeHighTipAmountWarning()}},{key:"show",value:function(e){var t=this;void 0!==e.amount&&(this.tipAmountInput.value=e.amount.toString(),this.tipAmountChange()),void 0!==e.message?this.tipMessageTextarea.value=e.message:this.tipMessageTextarea.value="",this.hasLowSatisfactionScore?this.lowScoreWarning.style.display="block":this.lowScoreWarning.style.display="none",this.tokenBalanceSpan.innerText="".concat(D.ag.loadingTextLower,"..."),this.showElement(),this.tipAmountInput.focus(),(0,Mn.rv)(this.tipSource,this.sendTipButton),(0,d.yX)(this.roomName).then((function(e){if(t.updateTokenBalance(e.tokenBalance),t.useDifferentKeyboard||(t.tipAmountInput.max=e.tokenBalance.toString()),void 0!==e.tipOptions){t.tipMessageLabel.innerText=e.tipOptions.label,void 0!==t.tipOptionsSelect&&t.tipMessageDiv.removeChild(t.tipOptionsSelect),t.tipOptionsSelect=document.createElement("select"),t.tipOptionsSelect.style.width="100%",t.tipOptionsSelect.style.fontSize="1em",t.tipOptionsSelect.style.margin="".concat(d.Co,"px"),t.tipOptionsSelect.style.border="1px solid #4b4c4b",t.tipOptionsSelect.style.boxSizing="border-box",t.tipMessageDiv.insertBefore(t.tipOptionsSelect,t.tipMessageTextarea);var n=document.createElement("option");n.innerText="-- ".concat(D.ag.selectOneLabel," --"),t.tipOptionsSelect.appendChild(n);var i,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Wn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(e.tipOptions.options);try{for(o.s();!(i=o.n()).done;){var r=i.value;(n=document.createElement("option")).innerText=r.label,n.value=r.label,t.tipOptionsSelect.appendChild(n)}}catch(e){o.e(e)}finally{o.f()}}else void 0!==t.tipOptionsSelect&&(t.tipMessageLabel.innerText=D.ag.defaultTipMessageLabel,t.tipMessageTextarea.value="",t.tipMessageDiv.removeChild(t.tipOptionsSelect),t.tipOptionsSelect=void 0);t.repositionChildren()})).catch((function(e){error("Error getting token balance (".concat(e,")")),t.tokenBalanceSpan.innerText=D.ag.unknownText}))}},{key:"showElement",value:function(){(0,s.Z)((0,c.Z)(h.prototype),"showElement",this).call(this,"flex")}},{key:"hide",value:function(){this.element.style.display="none",this.closed.fire(void 0)}},{key:"updateTokenBalance",value:function(e){this.tokenBalanceSpan.innerText="".concat(e," ").concat(D.ag.tokenOrTokensText(e,!1))}}]),h}(I.w);function qn(e,t){document.title="".concat(e," at Chaturbate: ").concat(t)}function Kn(){var e=(0,u.sQ)();return 15===(null==e?void 0:e.major)&&0===e.minor&&(0,u.G6)()}function Jn(){var e=document.querySelector(".push-overlay");return null!==e&&"none"!==e.style.display&&""!==e.style.display}var Gn=!1,Yn=function(e){(0,a.Z)(_,e);var t,n,I=(t=_,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function _(e,t){var n;(0,i.Z)(this,_),(n=I.call(this)).audioHolder=new b.n,n.sessionMetrics=new Hn,n.listenerGroup=new R.mM,n.siteHeaderHeight=0,n.isFullscreen=!1,n.loading=Date.now(),n.currentRoom=e,document.body.style.overflow="hidden",n.mainContainer=document.getElementById("main"),n.initDismissibleMessages(),n.mainContainer.appendChild(n.element),(0,P.L)("HideAddressBar")&&(0,u.Tt)()&&(n.hideAddressBarInLandscape(1),document.body.style.overflow="auto"),(0,M.zB)(n.sessionMetrics.getCurrentMode()),n.siteHeader=document.querySelector("#static-header");var o=document.querySelector("#static-header .right-nav");n.pushMenuOverlay=document.querySelector(".push-overlay"),n.pushMenu=document.querySelector(".pushmenu"),n.siteHeaderHeight=n.siteHeader.offsetHeight,n.headerRoomInfo=new J,o.appendChild(n.headerRoomInfo.element),n.pushMenuContainer=document.querySelector("#pushmenu-container"),Ie.YL.listen((function(e){e&&(0,M.fg)("SiteMenuOpened")})),d.A3.listen((function(e){var t=document.getElementById("token-balance");null!=t&&(t.innerText="".concat(e.tokens," Tokens"))})),n.element.style.height="100%",n.element.style.width="100%",n.element.style.minHeight="100%",n.element.style.minWidth="100%",n.element.style.position="fixed",(0,B.ql)(n.element,"none"),(0,M.N$)(e),n.player=new Ce(t,(0,r.Z)(n),n.mobileDismissibleMessages),n.player.playerComponent instanceof A._O&&n.player.playerComponent.setPageLoaded(n.loading),n.prependChild(n.player),n.sessionMetrics.bindPlayer(n.player),n.portraitContents=n.addChild(new _n({player:n.player,mobileDismissibleMessages:n.mobileDismissibleMessages})),n.player.videoControls.executeInitialFullscreenState(),n.player.videoControls.setPureChat(new xe.H(n.portraitContents.getChatContents())),n.player.toggleFullscreen.listen((function(e){n.isFullscreen=e,n.repositionChildrenRecursive(),n.sessionMetrics.recordResize()}));var s=n.addChild(new Vn("mobile",n.player));Ie.Fx.listen((function(e){(0,p.vj)()&&(n.player.isFullscreen||(0,ve.P0)())?n.player.videoControls.showTipForm(e):(n.player.limitPortraitHeight(280),s.show(e),n.repositionChildrenRecursive())})),s.tipSent.listen((function(e){s.hide(),!0===e.success&&"tokens"===Re.currentTab&&Ie.qF.fire("chat")})),s.closed.listen((function(){n.player.limitPortraitHeight(0)})),n.sessionMetrics.bindTipCallout(s),n.loadRoom(e,!0),n.repositionChildrenRecursive(),n.afterDOMConstructedIncludingChildren();var a=new T.d((function(){n.repositionChildrenRecursive()}),{bounceLimitMS:20,debounceType:2});ve.bs.listen((function(){(0,P.L)("HideAddressBar")&&(0,u.Tt)()&&((0,ve.gr)()&&n.hideAddressBarInLandscape(1.1),window.scrollTo(0,n.mainContainer.scrollHeight)),a.callFunc(),n.player.centerPlayer(),window.setTimeout((function(){a.callFunc()}),500)}));var l=window.innerWidth;window.onresize=function(){document.documentElement.scrollTop<0&&(document.documentElement.scrollTop=0),a.callFunc();var e=window.innerWidth!==l;!e&&(0,u.Tt)()&&!e||(l=window.innerWidth,n.player.centerPlayer())};var c=function(){if(n.player.sendMessageInputFieldHasFocus&&(0,me.F7)()>0){var e=(0,F.hf)()-F.Bw,t=Kn(),i=t?e+50:e,o=t?-50:0;n.player.element.style.position="fixed",n.player.element.style.top="",n.player.element.style.bottom="".concat(i,"px"),n.player.element.style.zIndex="1",n.player.videoControls.hideElement(),n.portraitContents.element.style.top="".concat(o,"px"),n.portraitContents.element.style.height="".concat(n.element.offsetHeight,"px")}};if(window.onscroll=c,Ie.U9.listen((function(){n.player.setMessageInputFieldHasFocus(!0),c()})),Ie.Ey.listen((function(){n.player.setMessageInputFieldHasFocus(!1),n.player.element.style.position="absolute",n.player.element.style.top="0",n.player.element.style.bottom="",n.player.element.style.zIndex="",n.portraitContents.element.style.top="",n.player.videoControls.showElement(),n.portraitContents.repositionChildrenRecursive()})),document.documentElement.clientHeight>=window.outerHeight){var h=function e(){var t=document.createElement("input");t.style.fontSize="16px",document.body.appendChild(t),t.focus(),t.blur(),document.body.removeChild(t),(0,m.SC)("mousedown",n.element,e),(0,m.SC)("touchmove",n.element,e)};(0,m.j9)("mousedown",n.element,h),(0,m.j9)("touchmove",n.element,h)}return n.preventCertainTouchActions(),(0,m.j9)("popstate",window,(function(e){void 0!==e.state&&null!==e.state?n.loadRoom(e.state,!1):Gn&&!(0,u.v8)()&&history.back()})),(0,m.j9)("pageshow",window,(function(e){e.persisted&&n.currentChatConnection.room()!==n.currentRoom&&n.loadRoom(n.currentRoom,!1)})),Ie.WP.listen((function(e){n.loadRoom(e,!0)})),S.kN.listen((function(e){qn(e.dossier.room,e.dossier.roomTitle),n.repositionChildrenRecursive(),Gn||(Gn=!0),n.headerRoomInfo.updateContext(e.dossier.room,e.dossier.following,e.dossier.roomStatus),n.headerRoomInfo.updateViewerCount(e.dossier.numViewers),"offline"===e.dossier.roomStatus?Ie.qF.fire("bio"):Ie.qF.fire("chat"),n.sessionMetrics.playerDimensions()})),n.player.playerComponent.showControls(),k.C.fire("mobile"),n}return(0,o.Z)(_,[{key:"initDismissibleMessages",value:function(){var e=this;(0,P.L)("MobileDismissibleMessages")&&(this.mobileDismissibleMessages=new ee,this.mainContainer.appendChild(this.mobileDismissibleMessages.element),this.mobileDismissibleMessages.rerendered.listen((function(){e.repositionChildrenRecursive()})))}},{key:"hideAddressBarInLandscape",value:function(e){var t,n,i=e*(null!==(t=null===(n=window.visualViewport)||void 0===n?void 0:n.height)&&void 0!==t?t:window.innerHeight);this.mainContainer.style.height="".concat(i,"px")}},{key:"passwordPrompt",value:function(e){var t=this;if(!(0,w.Cg)(D.ag.loginForPasswordPrompt((0,L.t)(e)),!1,(function(){window.location.href=(0,g.BN)("/")}))){var n=prompt(D.ag.passwordRequiredForRoom(e));null!==n?(0,g.I5)("roomlogin/".concat(e,"/"),{password:n}).then((function(n){"success"===new y.j(n.responseText).getStringOrUndefined("result")?t.loadRoom(e,!1):(0,v.Cj)(D.ag.incorrectPassword,(function(){t.passwordPrompt(e)}))})).catch((function(t){error("Unable to login to room",{room:e,error:t}),window.location.reload()})):window.location.reload()}}},{key:"loadRoom",value:function(e,t){var n=this;(Gn||!0===f.J.current.isLoadedFromCache?(0,E.ss)(e):(0,E.vZ)(e,window.initialRoomDossier)).then((function(i){var o,r;x.y.fire(i),void 0!==n.cleanupLastRoomCallback&&n.cleanupLastRoomCallback(),(0,M.N$)(e),f.q.setState(i),n.currentChatConnection=new C.E(i,!0),n.sessionMetrics.bindChatConnection(n.currentChatConnection),qn(i.room,i.roomTitle),n.listenerGroup.add(n.currentChatConnection.event.titleChange.listen((function(e){qn(i.room,e)}))),n.listenerGroup.add(O.gO.listen((function(e){n.currentChatConnection.updateEnterLeaveSettings(e.roomEntryFor,e.roomLeaveFor)}))),n.audioHolder.loadTipSounds(),n.listenerGroup.add(n.currentChatConnection.event.playSound.listen((function(e){if((0,Z.oc)()){var t=n.player.playerComponent.getVolume();n.player.playerComponent instanceof A._O&&(t=n.player.playerComponent.getMuted()?0:n.player.playerComponent.getVolume()),isNaN(t)?error("playerComponent.getVolume() is NaN.",{},"VIDEO_"):n.audioHolder.playSound(e,i.userChatSettings.viewerTipVolume*t/100)}}))),n.player.setIsWidescreen(i.isWidescreen),n.cleanupLastRoomCallback=function(){clearInterval(o),window.clearTimeout(r),n.currentChatConnection.disconnect(),n.player.playerComponent.stop(),n.listenerGroup.removeAll(),S.QN.fire(void 0)};var s={dossier:i,chatConnection:n.currentChatConnection};n.player.playerComponent.handleRoomLoaded(s),n.listenerGroup.add(n.player.playerComponent.playbackStart.listen((function(){(0,h.D)(i,n.player.playerComponent)}))),t&&function(e){if((0,u.nv)())if("mobile"===window.location.pathname.replace(/\//g,"")){var t=(0,U.dD)(window.location.search);t.b=e.room;var n=(0,U.Ie)(t);window.history.pushState(e.room,e.roomTitle,(0,g.BN)("./?".concat(n)))}else{var i=(0,U.dD)(window.location.search),o=(0,U.Ie)(i),r="";""!==o&&(r="?".concat(o)),window.history.pushState(e.room,e.roomTitle,(0,g.BN)("/".concat(e.room,"/").concat(r)))}}(i),S.kN.fire(s),n.currentChatConnection.event.statusChange.listen((function(e){var t="offline"===e.currentStatus,i=["privatewatching","privatespying"],s=i.includes(e.currentStatus),a=i.includes(e.previousStatus);switch(t||"notconnected"!==e.previousStatus&&!s&&!a||(clearInterval(o),o=window.setInterval((function(){n.currentChatConnection.updateRoomCount(s)}),1e3*(s?5:90)),r=window.setTimeout((function(){n.currentChatConnection.updateRoomCount(s||a)}),2e3)),e.currentStatus){case"passwordprotected":n.passwordPrompt(n.currentChatConnection.room()),n.player.playerComponent.stop();break;case"offline":n.player.playerComponent.stop()}}))})).catch((function(t){var i="",o="",r="";if("string"==typeof t){var s=t.match(/(?:[^\s,":{}]+|"[^"]*")+/g);if(null!==s){var a=s.map((function(e){return e.replace(/"/g,"")})),l=a.indexOf("code");-1!==l&&(i=a[l+1]),-1!==(l=a.indexOf("detail"))&&(o=a[l+1])}r=t}else if(void 0!==t.xhr&&void 0!==t.xhr.responseText&&""!==t.xhr.responseText){if("application/json"!==t.xhr.getResponseHeader("Content-Type"))return void error("Error reading room dossier error",{room:e,error:t.xhr.responseText});var c=new y.j(t.xhr.responseText);i=c.getStringOrUndefined("code",!1),o=c.getString("detail",!1),r=t.xhr.responseText}else t instanceof TypeError&&(i="access-denied");switch(i){case"access-denied":(0,v.Cj)("Access Denied for room: ".concat(e,"\n\n").concat(o),(function(){Gn||(window.location.href=(0,g.BN)("/"))}));break;case"unauthorized":window.location.href=(0,g.BN)("/auth/login/?next=".concat(window.location.pathname).concat(window.location.search));break;case"password-required":n.passwordPrompt(e);break;default:error("Error parsing room dossier error",{room:e,error:r})}}))}},{key:"preventCertainTouchActions",value:function(){var e,t=function(){var e=document.getElementById("entrance_terms");return null!==e&&"none"!==e.style.display},n=!1;(0,m.j9)("touchstart",window,(function(i){if(!t()){var o=i.touches.length>1;o&&!n&&((0,M.fg)("PinchZoomStarted"),n=!0),o&&(0,Se.V)()&&i.cancelable&&i.preventDefault(),e=i}})),(0,m.j9)("touchmove",window,(function(n){var i,o;if(!t()&&!Jn()){var r=n.touches[0].pageY;r!==(null!==(i=null===(o=e)||void 0===o?void 0:o.touches[0].pageY)&&void 0!==i?i:r)&&(0,Se.V)()&&n.cancelable&&n.preventDefault()}})),(0,m.j9)("touchend",window,(function(i){t()||(e=void 0,n=!1)}))}},{key:"adjustDimensions",value:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!(0,ve.gr)()){var e;this.element.style.top="0px",this.element.style.height="100%",this.element.style.minHeight="100%",this.hidePushMenu(),null===(e=this.mobileDismissibleMessages)||void 0===e||e.hideElement()}else{var t,n,i;null===(t=this.mobileDismissibleMessages)||void 0===t||t.showElement();var o=null!==(n=null===(i=this.mobileDismissibleMessages)||void 0===i?void 0:i.element.offsetHeight)&&void 0!==n?n:0,r=this.siteHeaderHeight+o;this.element.style.top="".concat(r,"px"),this.element.style.height="calc(100% - ".concat(r,"px)"),this.element.style.minHeight="calc(100% - ".concat(r,"px)")}}},{key:"repositionChildren",value:function(){(0,s.Z)((0,c.Z)(_.prototype),"repositionChildren",this).call(this),this.adjustDimensions(this.isFullscreen)}},{key:"hidePushMenu",value:function(){Ie.YL.fire(!1),this.pushMenuOverlay.style.display="none",this.pushMenu.classList.remove("pushmenu-animate"),this.siteHeader.classList.remove("push-page-content"),this.pushMenuContainer.style.display="none"}}]),_}(I.w)},6959:function(e,t,n){"use strict";n.d(t,{Q:function(){return ee}});var i=n(4649),o=n(2951),r=n(1976),s=n(7169),a=n(3243),l=n(7591),c=n(9492),u=n(7597),d=n(8759),h=n(6272),f=n(1185),p=n(8210),m=n(2800),v=n(8626),g=n(795),y=n(7693),b=n(1522),w=n(695),C=n(1602),x=n(4793),k=n(2694),S=n(9),T=n(8263),I=n(1794),R=n(1625),P=n(3705),M=n(1250),A=n(2833),E=n(3544),B=n(9992),L=n(2239),O=n(1392),D=n(5937),U=n(6522),Z=n(3543),F=n(1289),_=n(9420),N=n(5253),j=n(3112),H=n(6874);function z(){if((0,d.Tt)())return!1;if(/UCBrowser|Firefox|SamsungBrowser/.test(navigator.userAgent))return!1;if(/Chrome\//.test(navigator.userAgent)){var e=navigator.userAgent.split("Chrome/")[1].split(".")[0];if(parseInt(e)<72)return!1}return!0}var W=n(4043),V=n(6958),q=n(3607),K=n(3682);function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var G=42,Y=Z.ag.mobileTipMessageLabelLandscape,$=Z.ag.mobileTipMessageLabelPortrait,Q=250,X="videoControls",ee=function(e){(0,l.Z)(ee,e);var t,n,S=(t=ee,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var o=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,c.Z)(this,e)});function ee(e,t,n){var i;(0,o.Z)(this,ee),(i=S.call(this)).mobileDismissibleMessages=n,i.setPlayerVisibilityEvent=new I.xB("setPlayerVisibilityEvent"),i.centerPlayerEvent=new I.xB("centerPlayerEvent"),i.requestFullscreenEvent=new I.xB("requestFullscreenEvent"),i.setPlayerComponentVolumeMutedEvents=new I.xB("setPlayerComponentVolumeMutedEvents"),i.forceHlsPlayerEvent=new I.xB("forceHlsPlayerEvent"),i.playerComponentReadjustForceHlsOverlayOrderEvent=new I.xB("playerComponentReadjustForceHlsOverlayOrderEvent"),i.showJpegPlayerComponentImage=new I.xB("showJpegPlayerComponentImage"),i.toggleFullscreen=new I.xB("toggleFullscreen"),i.requestHlsPlayerPlayIfPaused=new I.xB("requestHlsPlayerPlayIfPaused"),i.state={volume:100,isMuted:!0},i.showingRules=!1,i.isVisible=!0,i.isTipFormActive=!1,i.isClickingAButton=!1,i.roomType="public",i.layoutHandler=new N.N,i.layoutConstraints=new N.P(i.constructor.name),i.airPlayIconConstraint=0,i.autofillAccessoryConstraint=0,i.forceHlsTriggered=!1,i.forceHlsPlayButtonCreated=!1,i.hlsWaitingForInteraction=!1,i.userUnmuted=!1,i.wasInPortrait=(0,K.gr)(),i.headerHeight=0,i.initialFullscreen=!1,i.useDifferentKeyboard=(0,D.JR)(),i.mobileRoot=t,i.playerIsFullscreen=e.isFullscreen,i.playerUsingAirPlay=e.usingAirPlay,i.playerUsingChromecast=e.usingChromecast,e.playerComponent instanceof M.z?(i.playerIsJPEG=!0,i.playerIsHlsPlaceholder=e.playerComponent.getIsHlsPlaceholder()):(i.playerIsJPEG=!1,i.playerIsHlsPlaceholder=!1),i.playerElement=e.element;var r=(0,F.dD)(window.location.search).disable_sound;(void 0!==r&&"true"===r.toLowerCase()||"1"===r)&&(i.state.isMuted=!0);var a=document.querySelector("#static-header");null!==a&&(i.headerHeight=a.offsetHeight),(0,f.vP)(i.element,"MobileVideoControls"),i.element.style.position="fixed",i.element.style.width="inherit",i.element.style.top="0px",i.element.style.display="flex",i.element.style.flexDirection="column",i.element.style.alignItems="center",i.element.style.justifyContent="space-between",i.playerOverlay=document.createElement("div"),i.playerOverlay.style.position="absolute",i.playerOverlay.style.width="100%",i.playerOverlay.style.height="100%",i.element.appendChild(i.playerOverlay),i.initControls(),i.constructUI(),i.touchControls=new V.I(i.playerOverlay,i.playerElement),i.bindTouchControlsEvent(),C.y.listen((function(e){i.rulesModal=(0,p.vo)((0,s.Z)(i),e),void 0!==i.rulesModal&&(i.addChild(i.rulesModal),i.rulesModal.visibilityChanged.listen((function(e){i.showingRules=e})))})),x.kN.listen((function(e){i.currentRoomContext=e,i.chatConnection=e.chatConnection,i.roomName=e.chatConnection.room(),e.chatConnection.event.statusChange.listen((function(e){i.updatePlayerHiddenStatus(e.currentStatus),i.showHideHlsPlayButton(e.currentStatus),"privatewatching"===e.currentStatus?(i.roomType="private",i.tokenBalanceLink.onclick=function(){var e=m.J.current.PurchaseEventSources.TOKEN_SOURCE_TIP_CALLOUT;(0,g.Hi)({source:e,roomType:"private"})}):(i.roomType="public",i.tokenBalanceLink.onclick=function(){var e=m.J.current.PurchaseEventSources.TOKEN_SOURCE_TIP_CALLOUT;(0,g.Hi)({source:e,roomType:"public"})})})),i.playerIsJPEG&&i.playerIsHlsPlaceholder&&!i.forceHlsPlayButtonCreated&&(i.forceHlsPlayButtonCreated=!0,i.createForceHlsPlayButton(),i.showHideHlsPlayButton(e.dossier.roomStatus)),i.updatePlayerHiddenStatus(e.dossier.roomStatus),i.userUnmuted||i.state.isMuted||(i.userUnmuted=!0),i.updateVolumeImage(),i.playerIsJPEG||i.updatePlayerVolume(),i.updateTokenBalance(isNaN(e.dossier.tokenBalance)?0:e.dossier.tokenBalance)})),_.wy.listen((function(){i.setFullscreen(!1)})),_.SB.listen((function(){i.mute()})),h.A3.listen((function(e){isNaN(e.tokens)||i.updateTokenBalance(e.tokens)})),j.H4.listen((function(e){if(i.isAnyInputFocused())i.closeActiveInput(),i.showControls(),i.isTipFormActive&&i.hideTipForm();else{if(e===i.isVisible)return void i.showControls();i.isVisible?i.isTipFormActive?i.hideTipForm():i.hideControls():i.showControls()}})),j.ct.listen((function(){i.isVisible&&i.showControls()})),j.uh.listen((function(){i.setFullscreen(!1),(0,K.gr)()||(0,b.Bp)("Rotate device to view PMs")})),E.Sv.listen((function(){i.forceHlsOverlayFunc()}),!1),W.YL.listen((function(e){e?i.hideControls():i.repositionChildren()})),(0,y.j9)("scroll",window,(function(){i.updateTokenBalancePosition()})),K.bs.listen((function(){i.wasInPortrait===(0,K.gr)()?window.setTimeout((function(){i.onOrientationChange()}),0):i.onOrientationChange()})),(0,y.j9)("resize",window,(function(){void 0!==i.mobilePureChat&&i.mobilePureChat.scrollToBottom()})),R.gH.listen((function(){(0,R.rm)()!==i.playerIsFullscreen&&(i.setFullscreen(i.playerIsFullscreen,!0),(i.playerUsingAirPlay||i.playerUsingChromecast)&&i.canResizePlayerInFullscreen()&&void 0!==i.mobilePureChat&&i.mobilePureChat.setPortraitHeight((0,q.mP)()-100))})),i.showControls(),i.repositionChildren();var l=document.createElement("style");if(l.innerHTML="\n            .mobileFullscreenInput::-webkit-input-placeholder {\n                color: black;\n                opacity: 0.65;\n            }\n            .mobileFullscreenInput:-ms-input-placeholder {\n                color: black;\n                opacity: 0.65;\n            }\n            .mobileFullscreenInput:-moz-placeholder {\n                color: black;\n                opacity: 0.65;\n            }\n            .mobileFullscreenInput::-moz-placeholder {\n                color: black;\n                opacity: 0.65;\n            }\n        ",document.head.appendChild(l),i.layoutHandler.addListener(e.roomStatusNotifier.layoutConstraints),i.layoutHandler.addListener(i.layoutConstraints),(0,d.IU)()){var c=window.localStorage.getItem(X);if(null!==c){var u=JSON.parse(c);i.state.isMuted=!e.playerComponent.supportsAutoplayWithAudio||u.isMuted,i.initialFullscreen=u.isFullscreen}else i.state.isMuted=!e.playerComponent.supportsAutoplayWithAudio}return i}return(0,r.Z)(ee,[{key:"initControls",value:function(){this.createVolumeImg(),this.createCenterControlsDiv(),this.createChatForm(),this.createTipForm(),this.createSendButton(),this.createTokenBalance(),this.createFullscreenImg(),this.createResizeDragLabel(),this.airPlayImg=this.createCastingImage("airplay.svg"),this.chromecastImg=this.createCastingImage("chromecast.svg"),this.createTopBar(),this.createBottomBar()}},{key:"constructUI",value:function(){this.element.appendChild(this.topBar),this.element.appendChild(this.bottomBar),this.centerControlsDiv.appendChild(this.chatForm),this.centerControlsDiv.appendChild(this.tipForm),this.centerControlsDiv.appendChild(this.sendButton)}},{key:"createTopBar",value:function(){this.topBar=document.createElement("div"),this.topBar.style.width="100%",this.topBar.style.display="flex",this.topBar.style.alignItems="center",this.topBar.style.padding="6px",this.topBar.style.boxSizing="border-box",this.topBar.appendChild(this.airPlayImg),this.topBar.appendChild(this.chromecastImg),this.topBar.appendChild(this.tokenBalanceWrapper)}},{key:"createBottomBar",value:function(){this.bottomBar=document.createElement("div"),this.bottomBar.classList.add("bottomBar"),this.bottomBar.style.width="100%",this.bottomBar.style.display="flex",this.bottomBar.style.alignItems="center",this.bottomBar.style.justifyContent="center",this.bottomBar.style.boxSizing="border-box",this.bottomBar.appendChild(this.volumeImg),this.bottomBar.appendChild(this.resizeDragLabel),this.bottomBar.appendChild(this.centerControlsDiv),this.bottomBar.appendChild(this.fullscreenImg)}},{key:"onOrientationChange",value:function(){this.show(),(0,K.gr)()?this.setPlaceholder(this.tipMessageInput,$):this.setPlaceholder(this.tipMessageInput,Y),!this.playerIsFullscreen&&this.isTipFormActive&&this.hideTipForm(),void 0!==this.rulesModal&&this.showingRules&&((0,K.gr)()?this.playerIsFullscreen||this.rulesModal.hide(!0):this.rulesModal.show(!0)),this.closeActiveInput(),void 0!==this.mobilePureChat&&(this.mobilePureChat.setVisible(this.playerIsFullscreen||!(0,K.gr)()),this.mobilePureChat.scrollToBottom()),this.wasInPortrait=(0,K.gr)()}},{key:"updatePlayerHiddenStatus",value:function(e){switch(e){case"offline":case"notconnected":case"away":case"privatenotwatching":case"hidden":case"passwordprotected":this.setPlayerVisibilityEvent.fire(!0);break;default:this.setPlayerVisibilityEvent.fire(!1)}}},{key:"createVolumeImg",value:function(){var e=this;this.volumeImg=document.createElement("img"),this.volumeImg.classList.add("volumeImg"),this.volumeImg.style.height="".concat(G,"px"),this.volumeImg.style.width="".concat(G,"px"),this.volumeImg.style.boxSizing="border-box",this.volumeImg.style.padding="0",this.volumeImg.style.cursor="pointer",this.volumeImg.style.border="none",this.volumeImg.style.background="none",this.volumeImg.style.zIndex="1",this.volumeImg.style.marginRight="".concat(10,"px"),this.volumeImg.onclick=function(){e.isVisible?(e.showControls(),e.playerIsJPEG?e.hlsWaitingForInteraction?e.forceHlsOverlayFunc(!0):e.forceHLS():((0,P.fg)("ToggleMute",{newState:!e.state.isMuted}),e.state.isMuted?e.unmute():e.mute())):e.showControls()}}},{key:"createCenterControlsDiv",value:function(){this.centerControlsDiv=document.createElement("div"),this.centerControlsDiv.style.opacity="0",this.centerControlsDiv.style.display="none",this.centerControlsDiv.style.zIndex="1",this.centerControlsDiv.style.height="".concat(G,"px"),this.centerControlsDiv.style.gridTemplateColumns="1fr auto",this.centerControlsDiv.style.columnGap="10px",this.centerControlsDiv.style.flex="1",(0,L.pS)(this.centerControlsDiv,"opacity ".concat(Q,"ms"))}},{key:"createChatForm",value:function(){var e=this;this.chatForm=document.createElement("form"),this.chatInput=new k.t7((function(){return e.safeSubmit()}),U.eq),this.chatExitButton=document.createElement("button"),this.chatExitImg=document.createElement("img"),this.chatExitButton.appendChild(this.chatExitImg),this.styleForm(this.chatForm),this.chatInput.element.classList.add("mobileFullscreenInput"),this.chatInput.element.style.textOverflow="",this.chatInput.element.style.verticalAlign="bottom",this.chatInput.element.style.webkitUserSelect="text",this.chatInput.setPlaceholder(Z.ag.mobileChatLabel,"placeholder"),this.chatInput.element.dataset.testid="chat-input",this.styleInput(this.chatForm),this.chatForm.style.overflow="hidden",this.chatForm.style.display="flex",this.chatForm.style.alignItems="center",this.chatInput.element.style.flex="1",this.chatInput.element.style.height="",this.chatInput.element.style.textOverflow="ellipsis",this.chatInput.element.style.overflow="hidden",this.chatInput.element.style.lineHeight="".concat(26,"px"),this.chatInput.element.style.fontSize="".concat(16,"px"),this.chatInput.element.style.fontWeight="bold",this.chatInput.element.style.fontFamily="UbuntuRegular, Arial, Helvetica, sans-serif",this.chatForm.appendChild(this.chatInput.element),this.chatForm.appendChild(this.chatExitButton),this.chatExitButton.type="button",this.chatExitButton.style.width="".concat(36,"px"),this.chatExitButton.style.height="".concat(36,"px"),this.chatExitButton.style.padding="0",this.chatExitButton.style.margin="0",this.chatExitButton.style.border="none",this.chatExitButton.style.borderRadius="".concat(18,"px"),this.chatExitButton.style.outline="none",this.chatExitButton.style.backgroundColor="transparent",this.chatExitButton.style.opacity="1",this.chatExitButton.style.display="none",this.chatExitImg.src="".concat(STATIC_URL_MOBILE,"exit-chat.svg"),this.chatExitImg.style.width="50%",this.chatExitImg.style.height="".concat(200/7,"%"),this.chatExitImg.style.opacity="1",this.chatExitImg.style.display="none",this.chatExitButton.onmousedown=function(t){t.preventDefault(),e.isClickingAButton=!0},this.chatExitButton.onmouseup=function(t){t.preventDefault(),e.isClickingAButton=!1},this.chatExitButton.onclick=function(t){t.preventDefault(),e.chatInput.blur(),e.hlsWaitingForInteraction&&e.forceHlsOverlayFunc(!1)},(0,y.j9)("mousedown",this.chatInput.element,(function(){e.isVisible&&((0,L.pS)(e.centerControlsDiv,"none"),e.centerControlsDiv.style.opacity="1")})),(0,y.j9)("focus",this.chatInput.element,(function(){e.showControls(),e.repositionChildren(),e.inputScrollIntoViewFix(),e.inputFix(!0)})),(0,y.j9)("blur",this.chatInput.element,(function(){(0,L.pS)(e.centerControlsDiv,"opacity ".concat(Q,"ms")),e.isClickingAButton||(e.showControls(),e.repositionChildren(),e.closeKeyboardFix(),e.inputFix(!1))})),this.chatForm.onsubmit=function(t){t.preventDefault(),e.chatInput.submit()}}},{key:"inputFix",value:function(e){(0,H.m7)()&&(0,K.gr)()&&(e?((0,T.Zs)(this.centerControlsDiv,{bottom:"50px"}),void 0!==this.mobilePureChat&&(this.mobilePureChat.inputFocusOffset=50,(0,T.Zs)(this.mobilePureChat.element,{bottom:"".concat(65+this.centerControlsDiv.offsetHeight,"px")}))):((0,T.Zs)(this.centerControlsDiv,{bottom:"0"}),void 0!==this.mobilePureChat&&(this.mobilePureChat.inputFocusOffset=0),this.repositionChildrenRecursive()))}},{key:"inputScrollIntoViewFix",value:function(){(0,d.Tt)()&&!(0,K.gr)()&&(document.documentElement.scrollTop=(0,q.mP)()),te()&&(this.autofillAccessoryConstraint=50,this.updateConstraints())}},{key:"closeKeyboardFix",value:function(){te()&&(this.autofillAccessoryConstraint=0,this.updateConstraints())}},{key:"safeSubmit",value:function(){return!(0,w.Cg)('You must be logged in to send a message. Click "OK" to login.')&&this.cleanAndSendMessage(this.chatInput.getText())}},{key:"cleanAndSendMessage",value:function(e){if(""===e.trim())return!1;var t=(0,O.DO)(e);switch(t.messageType){case 1:this.chatInput.clearText();var n=t;this.showTipForm(n.messageData);break;case 2:if(void 0===this.chatConnection)return(0,b.Cj)("Unable to enable debug mode"),!1;this.chatConnection.toggleAppDebugging();break;case 3:if(void 0===this.chatConnection)return(0,b.Cj)("Unable to send shortcode"),!1;if(!(0,v.vj)())break;var i=t;this.chatConnection.sendShortcode(i);break;default:if(void 0===this.chatConnection)return(0,b.Cj)("Unable to send message"),!1;this.chatConnection.sendRoomMessage(e),j.pF.fire(void 0)}return!0}},{key:"createSendButton",value:function(){var e=this;this.sendButton=document.createElement("button"),this.sendButton.classList.add("sendButton"),this.sendButton.innerText=Z.ag.sendTipButtonCAPS,this.sendButton.style.outline="none",this.sendButton.style.border="none",this.sendButton.style.height="".concat(G,"px"),this.sendButton.style.fontSize="".concat(16,"px"),this.sendButton.style.fontFamily="UbuntuBold, Arial, Helvetica, sans-serif",this.sendButton.style.color="rgb(240,240,240)",this.sendButton.style.background="rgba(21, 107, 149, 0.75)",this.sendButton.style.padding="5px 8px",this.sendButton.style.borderRadius="6px",this.sendButton.style.boxSizing="border-box",this.sendButton.style.cursor="pointer",this.sendButton.style.display="inline-block",this.sendButton.style.textAlign="center",this.sendButton.onmousedown=function(t){t.preventDefault(),e.isClickingAButton=!0},this.sendButton.onmouseup=function(t){t.preventDefault(),e.isClickingAButton=!1},this.sendButton.onclick=function(){var t=e.isChatInputFocused()?"message":"tip";(0,w.Cg)("You must be logged in to send a ".concat(t,'. Click "OK" to login.'))?e.closeActiveInput():(e.isTipFormActive?e.submitTipForm():e.isChatInputFocused()?e.chatInput.submit():e.showTipForm(),e.hlsWaitingForInteraction&&e.forceHlsOverlayFunc(!1))}}},{key:"createTipForm",value:function(){var e=this;this.tipForm=document.createElement("form"),this.tipMessageInput=document.createElement("input"),this.tipAmountContainer=document.createElement("div");var t=document.createElement("label"),n=document.createElement("div");this.tipAmountInput=document.createElement("input");var i=document.createElement("button");this.tipForm.appendChild(this.tipMessageInput),this.tipForm.appendChild(this.tipAmountContainer),this.tipForm.appendChild(i),this.tipAmountContainer.appendChild(t),this.tipAmountContainer.appendChild(n),n.appendChild(this.tipAmountInput),this.styleForm(this.tipForm),this.styleInput(this.tipMessageInput),this.styleInput(this.tipAmountContainer),this.styleInput(this.tipAmountInput),(0,K.gr)()?this.setPlaceholder(this.tipMessageInput,$):this.setPlaceholder(this.tipMessageInput,Y),this.tipForm.classList.add("tipForm"),this.tipForm.style.columnGap="10px",this.tipForm.style.display="none",this.tipMessageInput.classList.add("mobileFullscreenInput"),this.tipAmountContainer.style.display="flex",this.tipAmountContainer.style.padding="".concat(4,"px ").concat(5,"px"),t.innerText="".concat(Z.ag.amountText,"Â "),t.style.opacity="0.7",t.style.lineHeight="".concat(34,"px"),n.style.overflow="hidden",n.style.padding="0",n.style.flex="1",this.tipAmountInput.type=(0,d.Tt)()&&!this.useDifferentKeyboard?"tel":"number",this.tipAmountInput.value="25",this.tipAmountInput.style.background="white",this.tipAmountInput.style.height="".concat(34,"px"),this.tipAmountInput.style.lineHeight="".concat(34,"px"),this.tipAmountInput.style.textAlign="center",this.tipAmountInput.style.margin="0",this.tipAmountInput.style.padding="0 6px",this.tipAmountInput.style.opacity="0.9",this.tipAmountInput.style.width="100%",this.tipAmountInput.style.color="black",(0,y.j9)("input",this.tipAmountInput,(function(){e.cleanTipAmountValue(),e.hlsWaitingForInteraction&&e.forceHlsOverlayFunc(!1)})),i.style.visibility="hidden",i.style.width="0",i.style.height="0",i.style.position="absolute",i.type="submit",this.tipMessageInput.onfocus=function(){e.inputScrollIntoViewFix(),e.inputFix(!0)},this.tipAmountInput.onfocus=function(){e.inputScrollIntoViewFix(),e.inputFix(!0),(0,d.Tt)()&&!e.useDifferentKeyboard?(0,H.m7)()?window.setTimeout((function(){e.tipAmountInput.setSelectionRange(0,e.tipAmountInput.value.length)}),0):e.tipAmountInput.setSelectionRange(0,e.tipAmountInput.value.length):e.tipAmountInput.select()},this.tipAmountInput.onblur=function(){""===e.tipAmountInput.value&&(e.tipAmountInput.value="0"),e.closeKeyboardFix(),e.inputFix(!1)},this.tipAmountInput.onkeydown=function(e){e.metaKey||"Unidentified"===e.key||"Backspace"===e.key||"Enter"===e.key||"0123456789".includes(e.key)||e.preventDefault()},this.tipMessageInput.onblur=function(){e.closeKeyboardFix(),e.inputFix(!1)},this.tipForm.onsubmit=function(t){t.preventDefault(),e.submitTipForm()}}},{key:"cleanTipAmountValue",value:function(){var e=this.tipAmountInput.value.replace(/[^0-9]+/g,"");this.tipAmountInput.value="",this.tipAmountInput.value=e}},{key:"notifyPlayerChangeSize",value:function(){var e=Math.abs(this.playerScroll-this.playerElement.scrollLeft),t=Math.abs(this.playerHeight-this.playerElement.offsetHeight);if(!(e<10&&t<10)){var n=A.$V;void 0!==this.currentRoomContext&&!0===this.currentRoomContext.dossier.isWidescreen&&(n=A.fo),e*n>t?j.zy.fire({changeType:1}):j.zy.fire({changeType:0})}}},{key:"submitTipForm",value:function(){this.closeActiveInput();var e=parseInt(this.tipAmountInput.value);isNaN(e)?(0,b.Cj)(Z.ag.tipAmountInvalid):((0,P.fg)("SendTipClicked",{amount:e,source:"mobile_fullscreen"}),e>100?(0,b.oB)(Z.ag.tipConfirmationMessage(e),this.mySendTip.bind(this,e),(function(){})):this.mySendTip(e))}},{key:"mySendTip",value:function(e){var t=this;this.sendButton.disabled=!0,(0,h.d1)({roomName:this.roomName,tipAmount:this.tipAmountInput.value,message:"".concat(this.tipMessageInput.value),source:"mobile",tipRoomType:this.roomType,tipType:"public",videoMode:"mobile"}).then((function(n){t.sendButton.disabled=!1,n.success?(0,P.fg)("SendTipSuccess",{amount:e,source:"mobile_fullscreen"}):void 0!==n.error?(0,b.Cj)(n.error):error("unknown send tip error"),t.tipMessageInput.value="",t.hideTipForm(),x.q.fire({amount:e,success:n.success}),void 0!==n.tipsInPast24Hours&&h.H2.fire({tokens:n.tipsInPast24Hours,roomName:t.roomName})})).catch((function(n){x.q.fire({amount:e,success:!1}),t.sendButton.disabled=!1,(0,b.Cj)("Unable to send tip"),error("Error sending tip (".concat(n,")"))}))}},{key:"styleForm",value:function(e){e.style.height="100%",e.style.boxSizing="border-box"}},{key:"styleInput",value:function(e){e.style.textOverflow="ellipsis",e.style.whiteSpace="nowrap",e.style.overflow="hidden",e.style.height="".concat(G,"px"),e.style.lineHeight="".concat(26,"px"),e.style.fontSize="".concat(16,"px"),e.style.fontWeight="bold",e.style.fontFamily="UbuntuRegular, Arial, Helvetica, sans-serif",e.style.border="none",e.style.outline="none",e instanceof HTMLInputElement&&(e.autocomplete="off"),e.style.color="rgb(15,15,15)",e.style.background="rgba(255, 255, 255, 0.5)",e.style.padding="".concat(8,"px ").concat(10,"px"),e.style.borderRadius="6px",e.style.boxSizing="border-box",e.style.cursor="pointer",e.style.display="inline-block",e.style.textAlign="left"}},{key:"createTokenBalance",value:function(){var e=this;this.tokenBalanceWrapper=document.createElement("div"),this.tokenBalanceLink=document.createElement("a");var t=document.createElement("span");this.tokenBalanceAmount=document.createElement("span"),this.tokenBalanceWrapper.appendChild(this.tokenBalanceLink),this.tokenBalanceLink.appendChild(t),this.tokenBalanceLink.appendChild(this.tokenBalanceAmount),this.tokenBalanceWrapper.style.zIndex="2",this.tokenBalanceLink.target="_blank",this.tokenBalanceLink.style.display="none",this.tokenBalanceLink.style.textDecoration="none",this.tokenBalanceLink.style.fontWeight="bold",this.tokenBalanceLink.style.borderRadius="8px",this.tokenBalanceLink.style.padding="6px 12px",this.tokenBalanceLink.style.background="rgba(255, 255, 255, 0.6)",this.tokenBalanceLink.onclick=function(){var t=m.J.current.PurchaseEventSources.TOKEN_SOURCE_MOBILE_VIDEO_CONTROLS;(0,g.Hi)({source:t,roomType:e.roomType})},t.textContent="".concat(Z.ag.balanceText," "),t.style.color="rgb(50, 50, 50)",this.tokenBalanceAmount.textContent="0 Tokens",this.tokenBalanceAmount.style.color="rgb(15, 15, 15)"}},{key:"createFullscreenImg",value:function(){var e=this;this.fullscreenImg=document.createElement("img"),this.fullscreenImg.src="".concat(STATIC_URL_MOBILE,"expand-1.svg"),this.fullscreenImg.style.height="".concat(G,"px"),this.fullscreenImg.style.width="".concat(G,"px"),this.fullscreenImg.style.boxSizing="border-box",this.fullscreenImg.style.padding="0",this.fullscreenImg.style.cursor="pointer",this.fullscreenImg.style.border="none",this.fullscreenImg.style.background="none",this.fullscreenImg.style.zIndex="1",this.fullscreenImg.style.borderRadius="".concat(21,"px"),this.fullscreenImg.style.marginLeft="".concat(10,"px"),this.fullscreenImg.onclick=function(){e.hlsWaitingForInteraction&&e.forceHlsOverlayFunc(!1),e.isVisible?(e.showControls(),e.setFullscreen(!e.playerIsFullscreen)):e.showControls()}}},{key:"createResizeDragLabel",value:function(){this.resizeDragLabel=document.createElement("div"),this.resizeDragLabel.innerText=Z.ag.dragToResize,this.resizeDragLabel.style.backgroundColor="rgba(0,0,0,0.3)",this.resizeDragLabel.style.color="rgba(255,255,255,0.6)",this.resizeDragLabel.style.borderRadius="6px",this.resizeDragLabel.style.padding="5px",this.resizeDragLabel.style.textAlign="center",this.resizeDragLabel.style.pointerEvents="none",this.resizeDragLabel.style.textOverflow="ellipsis",this.resizeDragLabel.style.whiteSpace="nowrap",this.resizeDragLabel.style.overflow="hidden",this.resizeDragLabel.style.flex="1"}},{key:"repositionChildren",value:function(){!(0,K.gr)()||this.playerIsFullscreen||this.playerUsingAirPlay||this.playerUsingChromecast?this.resizeDragLabel.style.display="none":this.resizeDragLabel.style.display="",this.updateIcons(),this.updateCenterControls(),this.updateSendButton(),this.updateChatExitButton(),this.updateChatInput(),this.updateTokenBalancePosition(),this.adjustDimensions()}},{key:"adjustDimensions",value:function(){var e=this.playerElement.getBoundingClientRect();if(this.isFullVideo())(0,R.rm)()?this.element.style.height="calc(var(--vh, 1vh) * 100)":this.element.style.height="100%",this.element.style.top="0";else{var t,n;this.element.style.height="".concat(e.height,"px");var i=null!==(t=null===(n=this.mobileDismissibleMessages)||void 0===n?void 0:n.element.offsetHeight)&&void 0!==t?t:0;this.element.style.top="".concat(this.headerHeight+i,"px")}}},{key:"updateIcons",value:function(){this.shouldHideIcons()?(this.fullscreenImg.style.display="none",this.volumeImg.style.display="none"):(this.fullscreenImg.style.display="inline",this.volumeImg.style.display="inline"),z()||(0,K.gr)()||(this.fullscreenImg.style.display="none")}},{key:"updateCenterControls",value:function(){this.isFullVideo()?this.showCenterControls():this.hideCenterControls()}},{key:"showCenterControls",value:function(){this.isVisible&&(this.centerControlsDiv.style.opacity="1",this.centerControlsDiv.style.pointerEvents="auto",this.centerControlsDiv.style.display="grid")}},{key:"hideCenterControls",value:function(){this.centerControlsDiv.style.opacity="0",this.centerControlsDiv.style.pointerEvents="none",this.isFullVideo()||(this.centerControlsDiv.style.display="none")}},{key:"updateChatExitButton",value:function(){this.isChatInputFocused()?(this.chatExitImg.style.display="inline-block",this.chatExitButton.style.display="block"):(this.chatExitImg.style.display="none",this.chatExitButton.style.display="none")}},{key:"updateChatInput",value:function(){var e=this;this.isChatInputFocused()?(this.chatInput.element.style.textOverflow="",window.setTimeout((function(){e.chatInput.element.scrollLeft=e.chatInput.element.scrollWidth,e.chatInput.setCaretToEnd()}),0)):(this.chatInput.element.style.textOverflow="ellipsis",this.chatInput.element.scrollLeft=0)}},{key:"isAnyInputFocused",value:function(){return this.isChatInputFocused()||this.isTipInputFocused()}},{key:"closeActiveInput",value:function(){this.chatInput.element===document.activeElement?this.chatInput.blur():this.tipAmountInput===document.activeElement?this.tipAmountInput.blur():this.tipMessageInput===document.activeElement&&this.tipMessageInput.blur()}},{key:"isChatInputFocused",value:function(){return this.chatInput.element===document.activeElement}},{key:"isTipInputFocused",value:function(){return this.tipAmountInput===document.activeElement||this.tipMessageInput===document.activeElement}},{key:"shouldHideIcons",value:function(){return this.isChatInputFocused()||this.isTipFormActive}},{key:"showTipForm",value:function(e){(0,v.vj)()&&!this.isVisible&&this.showControls(),this.isTipFormActive=!0,this.tokenBalanceLink.style.display="block",this.chatForm.style.display="none",this.tipForm.style.display="grid",void 0!==e&&(void 0!==e.amount&&(this.tipAmountInput.value=e.amount.toString(),this.cleanTipAmountValue()),void 0!==e.message&&(this.tipMessageInput.value=e.message)),this.tipAmountInput.focus(),this.repositionChildren()}},{key:"hideTipForm",value:function(){this.isTipFormActive=!1,this.tokenBalanceLink.style.display="none",this.chatForm.style.display="inline-block",this.tipForm.style.display="none",this.repositionChildren()}},{key:"setFullscreen",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.playerIsFullscreen!==e&&(this.playerIsFullscreen=e,this.toggleFullscreen.fire(e),e?this.fullscreenImg.src="".concat(STATIC_URL_MOBILE,"contract-1.svg"):(this.fullscreenImg.src="".concat(STATIC_URL_MOBILE,"expand-1.svg"),this.isTipFormActive&&this.hideTipForm()),void 0!==this.rulesModal&&this.showingRules&&(e?this.rulesModal.show(!0):this.rulesModal.hide(!0)),void 0!==this.mobilePureChat&&((0,K.gr)()?this.mobilePureChat.setVisible(e):this.mobilePureChat.setVisible(!0)),this.centerPlayerEvent.fire(void 0),this.updateCenterControls(),this.repositionChildren(),this.saveSettings(),t||this.maybeUseFullscreenAPI(e))}},{key:"maybeUseFullscreenAPI",value:function(e){z()&&(e?this.requestFullscreenEvent.fire(void 0):(0,R.Qg)())}},{key:"updateSendButton",value:function(){this.isChatInputFocused()?this.sendButton.innerText=Z.ag.sendCAPS:this.sendButton.innerText=Z.ag.sendTipButtonCAPS}},{key:"updateVolumeImage",value:function(){this.state.isMuted||0===this.state.volume?this.volumeImg.src="".concat(STATIC_URL_MOBILE,"muted.svg"):this.volumeImg.src="".concat(STATIC_URL_MOBILE,"unmuted.svg"),(0,P.iL)(100,this.state.isMuted)}},{key:"updatePlayerVolume",value:function(){this.userUnmuted||this.state.isMuted||(this.userUnmuted=!0,(0,P.fg)("UserUnmuted",{chatMode:"mobile"})),this.setPlayerComponentVolumeMutedEvents.fire(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.state))}},{key:"saveSettings",value:function(){if((0,d.IU)()){var e={isMuted:this.state.isMuted,isFullscreen:this.playerIsFullscreen,volume:this.state.volume};window.localStorage.setItem(X,JSON.stringify(e))}}},{key:"update",value:function(){this.updatePlayerVolume()}},{key:"mute",value:function(){this.updateIsMuted(!0),this.update()}},{key:"unmute",value:function(){this.updateIsMuted(!1),this.update()}},{key:"updateTokenBalance",value:function(e){this.tokenBalanceAmount.innerText="".concat(e," Tokens")}},{key:"updateTokenBalancePosition",value:function(){var e=(0,T.PZ)(this.airPlayImg)||(0,T.PZ)(this.chromecastImg),t=this.airPlayImg.offsetWidth||this.chromecastImg.offsetWidth,n=t&&e?t:0;this.tokenBalanceWrapper.style.left="".concat(15+n,"px"),this.isTipInputFocused()?(this.tokenBalanceWrapper.style.position="absolute",this.updateTokenBalanceTopProperty()):this.tokenBalanceWrapper.style.position="static"}},{key:"updateTokenBalanceTopProperty",value:function(){var e=this.centerControlsDiv.offsetHeight,t=this.tokenBalanceLink.offsetHeight,n=(0,q.mP)()-e-t-15;this.tokenBalanceWrapper.style.top="".concat(Math.min((0,q.F7)()+15,n),"px")}},{key:"setPlaceholder",value:function(e,t){e.setAttribute("placeholder",t)}},{key:"isFullVideo",value:function(){return this.playerIsFullscreen||!(0,K.gr)()}},{key:"updateCastingStyling",value:function(e){"AirPlay"===e?this.airPlayImg.src="".concat(STATIC_URL_MOBILE,"airplay-active.svg"):"Chromecast"===e?this.chromecastImg.src="".concat(STATIC_URL_MOBILE,"chromecast-active.svg"):(this.airPlayImg.src="".concat(STATIC_URL_MOBILE,"airplay.svg"),this.chromecastImg.src="".concat(STATIC_URL_MOBILE,"chromecast.svg")),this.showControls()}},{key:"createCastingImage",value:function(e){var t=this,n=document.createElement("img");return n.style.display="none",n.src="".concat(STATIC_URL_MOBILE+e),n.style.height="".concat(G,"px"),n.style.width="".concat(G,"px"),n.style.cursor="pointer",n.style.marginRight="".concat(6,"px"),n.style.zIndex="1",(0,y.j9)("click",n,(function(){t.showControls()})),n}},{key:"showAirPlay",value:function(){this.airPlayImg.style.display="",this.airPlayIconConstraint=48,this.updateConstraints()}},{key:"hideAirPlay",value:function(){this.airPlayImg.style.display="none",this.airPlayIconConstraint=0,this.updateConstraints()}},{key:"showChromecast",value:function(){this.chromecastImg.style.display="",this.airPlayIconConstraint=48,this.updateConstraints()}},{key:"hideChromecast",value:function(){this.chromecastImg.style.display="none",this.airPlayIconConstraint=0,this.updateConstraints()}},{key:"updateConstraints",value:function(){this.layoutConstraints.setConstraints({top:this.airPlayIconConstraint,bottom:this.autofillAccessoryConstraint,left:this.airPlayIconConstraint,right:0,transitionTime:0})}},{key:"showElement",value:function(){(0,a.Z)((0,u.Z)(ee.prototype),"showElement",this).call(this,"flex")}},{key:"show",value:function(){this.showElement(),this.showControls()}},{key:"hide",value:function(){this.hideElement()}},{key:"showControls",value:function(){var e=this;this.isVisible||(this.isFullVideo()||this.playerUsingAirPlay||this.playerUsingChromecast?this.resizeDragLabel.style.display="none":this.resizeDragLabel.style.display="",(0,L.pS)(this.airPlayImg,"opacity none"),(0,L.pS)(this.chromecastImg,"opacity none"),(0,L.pS)(this.volumeImg,"opacity none"),(0,L.pS)(this.fullscreenImg,"opacity none"),(0,L.pS)(this.resizeDragLabel,"opacity none"),this.airPlayImg.style.opacity="1",this.chromecastImg.style.opacity="1",this.volumeImg.style.opacity="1",this.fullscreenImg.style.opacity="1",this.resizeDragLabel.style.opacity="1",this.isVisible=!0),this.updateCenterControls(),clearTimeout(this.opacityTimer),this.opacityTimer=window.setTimeout((function(){e.hideControls()}),3500)}},{key:"hideControls",value:function(){!this.isVisible||this.isChatInputFocused()||this.isTipFormActive||this.playerUsingAirPlay||this.playerUsingChromecast||((0,L.pS)(this.airPlayImg,"opacity ".concat(Q,"ms")),(0,L.pS)(this.chromecastImg,"opacity ".concat(Q,"ms")),(0,L.pS)(this.volumeImg,"opacity ".concat(Q,"ms")),(0,L.pS)(this.fullscreenImg,"opacity ".concat(Q,"ms")),(0,L.pS)(this.resizeDragLabel,"opacity ".concat(Q,"ms")),this.airPlayImg.style.opacity="0",this.chromecastImg.style.opacity="0",this.volumeImg.style.opacity="0",this.fullscreenImg.style.opacity="0",this.resizeDragLabel.style.opacity="0",this.hideCenterControls(),this.isVisible=!1)}},{key:"updateVolume",value:function(e){this.state.volume=e,this.updateVolumeImage()}},{key:"updateIsMuted",value:function(e){this.state.isMuted=e,this.updateVolumeImage()}},{key:"updateAndSaveVolume",value:function(e){this.updateVolume(e),this.saveSettings()}},{key:"updateAndSaveIsMuted",value:function(e){this.updateIsMuted(e),this.saveSettings()}},{key:"getControlBarHeight",value:function(){return 0}},{key:"setPureChat",value:function(e){this.mobilePureChat=e,this.addChild(this.mobilePureChat),this.mobilePureChat.setVisible(this.playerIsFullscreen||!(0,K.gr)()),this.layoutHandler.addListener(this.mobilePureChat.layoutConstraints)}},{key:"forceHLS",value:function(){void 0!==this.currentRoomContext?((0,P.fg)("ForceHLS"),this.forceHlsPlayerEvent.fire({roomContext:this.currentRoomContext}),this.unmute(),W.Gf.fire(void 0)):error("unexpected switch to hls",{},"VIDEO_")}},{key:"showHideHlsPlayButton",value:function(e){void 0!==this.playButtonContainer&&void 0!==this.forceHlsOverlay&&((0,B.Zd)(e)?(this.playButtonContainer.style.display="flex",this.forceHlsOverlay.style.display=""):(this.playButtonContainer.style.display="none",this.forceHlsOverlay.style.display="none"))}},{key:"forceHlsOverlayFunc",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.hlsWaitingForInteraction&&void 0!==this.currentRoomContext&&!this.forceHlsTriggered&&(void 0!==this.forceHlsOverlay&&null!==this.forceHlsOverlay.parentElement&&(this.forceHlsOverlay.parentElement.removeChild(this.forceHlsOverlay),this.forceHlsOverlay=void 0),void 0!==this.playButtonContainer&&null!==this.playButtonContainer.parentElement&&(this.playButtonContainer.parentElement.removeChild(this.playButtonContainer),this.playButtonContainer=void 0),this.forceHlsTriggered=!0,this.hlsWaitingForInteraction=!1,(0,P.fg)("ForceHLS"),this.forceHlsPlayerEvent.fire({roomContext:this.currentRoomContext,unmute:e}),this.element.style.zIndex="")}},{key:"createHlsPlayOverlay",value:function(){var e=this;this.forceHlsOverlay=document.createElement("div"),this.element.style.zIndex="100",this.forceHlsOverlay.style.width="100%",this.forceHlsOverlay.style.height="100%",this.forceHlsOverlay.style.position="absolute",this.forceHlsOverlay.style.top="0",this.forceHlsOverlay.style.left="0",this.forceHlsOverlay.style.zIndex="99",(0,y.j9)("click",this.forceHlsOverlay,(function(){e.forceHlsOverlayFunc()})),(0,y.j9)("click",this.element,(function(){e.forceHlsOverlayFunc()})),this.playerComponentReadjustForceHlsOverlayOrderEvent.fire(this.forceHlsOverlay)}},{key:"createForceHlsPlayButton",value:function(){if(this.playerIsJPEG){this.hlsWaitingForInteraction=!0,this.playButtonContainer=document.createElement("div");var e=document.createElement("img");e.src="".concat(STATIC_URL,"play-inactive.svg"),e.style.width="30px",e.style.height="30px",e.style.cursor="pointer",this.playButtonContainer.style.cursor="pointer",this.playButtonContainer.style.width="70px",this.playButtonContainer.style.height="70px",this.playButtonContainer.style.borderRadius="50%",this.playButtonContainer.style.backgroundColor="rgba(0,0,0,0.25)",this.playButtonContainer.style.display="flex",this.playButtonContainer.style.alignItems="center",this.playButtonContainer.style.justifyContent="center",this.playButtonContainer.appendChild(e),this.element.insertBefore(this.playButtonContainer,this.bottomBar),this.showJpegPlayerComponentImage.fire(void 0),this.createHlsPlayOverlay(),this.repositionChildren()}}},{key:"notifyPlayerIsJPEG",value:function(e){this.playerIsJPEG=e}},{key:"notifyPlayerIsHlsPlaceholder",value:function(e){this.playerIsHlsPlaceholder=e}},{key:"notifyUsingAirPlayChange",value:function(e){this.playerUsingAirPlay=e}},{key:"notifyUsingChromecastChange",value:function(e){this.playerUsingChromecast=e}},{key:"canResizePlayerInFullscreen",value:function(){return!this.isAnyInputFocused()&&(0,K.gr)()&&this.isFullVideo()}},{key:"bindTouchControlsEvent",value:function(){var e=this;this.touchControls.touchMoveEvent.listen((function(t){switch(t.state){case 0:e.playerScroll=e.playerElement.scrollLeft,e.playerHeight=e.playerElement.offsetHeight;break;case 1:e.showControls();break;case 3:var n=e.isVisible;n||t.event.preventDefault(),n?e.isTipFormActive?e.hideTipForm():e.hideControls():e.showControls(),j.h4.fire(void 0),e.closeActiveInput(),e.requestHlsPlayerPlayIfPaused.fire(void 0);break;case 2:e.notifyPlayerChangeSize()}}))}},{key:"executeInitialFullscreenState",value:function(){this.initialFullscreen&&this.setFullscreen(!0,!0)}},{key:"getMobileRoot",value:function(){return this.mobileRoot}}]),ee}(S.w),te=function(){if((0,d._1)()&&/CriOS\//.test(navigator.userAgent)){var e=navigator.userAgent.split("CriOS/")[1].split(".")[0];if(parseInt(e)>=75)return!0}return!1}},2923:function(e,t,n){"use strict";n.d(t,{V:function(){return o},q:function(){return r}});var i=n(7693);function o(){return document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement||document.activeElement instanceof HTMLElement&&"true"===document.activeElement.contentEditable}var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.style.overflowY="scroll",t&&((0,i.j9)("touchstart",e,(function(t){0===e.scrollTop&&(e.scrollTop=1)})),(0,i.j9)("touchmove",e,(function(t){o()&&(t.stopPropagation(),!(e.scrollHeight>e.clientHeight)&&t.cancelable&&t.preventDefault())})),(0,i.j9)("scroll",e,(function(){if(0===e.scrollTop)e.scrollTop=1;else if(e.scrollTop===e.scrollHeight-e.offsetHeight){var t=e.scrollHeight-e.offsetHeight-1;e.scrollTop=Math.max(t,1)}})))}},6847:function(e,t,n){"use strict";n.d(t,{$z:function(){return f},GJ:function(){return p},fQ:function(){return h}});var i=n(1976),o=n(2951),r=n(7591),s=n(9492),a=n(7597),l=n(7693),c=n(1794),u=n(3607);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,s.Z)(this,n)}}var h=function(e,t,n,i){var o=Math.abs(e-n);return Math.abs(t-i)>o},f=function(e){(0,r.Z)(n,e);var t=d(n);function n(e,i){var r;(0,o.Z)(this,n),(r=t.call(this,"TouchEvent",i)).element=e;var s,a,c,u,d,h,f={x:0,y:0},p={x:0,y:0},m={x:0,y:0};return(0,l.j9)("touchstart",r.element,(function(e){f.x=e.touches[0].clientX,f.y=e.touches[0].clientY,m.x=e.touches[0].clientX,m.y=e.touches[0].clientY,s=Date.now(),c=0,u=1!==e.touches.length,d=!0,h=!1})),(0,l.j9)("touchmove",r.element,(function(e){if(1===e.touches.length&&!u){p.x=e.touches[0].clientX,p.y=e.touches[0].clientY;var t=f.x-p.x,n=p.y-f.y,i=1;o=c+=Math.abs(t)+Math.abs(n),l=Math.abs(p.y-m.y),a=l>=.7*o||l>110?1:0,(d=c<=10)||(h||(h=!0,i=0),r.fire({direction:a,distance:{x:t,y:n},state:i,elapsedTime:Date.now()-s,totalDistance:{x:m.x-p.x,y:p.y-m.y},startingPoint:m,event:e})),f.x=p.x,f.y=p.y}var o,l})),(0,l.j9)("touchend",r.element,(function(e){if(1===e.changedTouches.length&&!u){p.x=e.changedTouches[0].clientX,p.y=e.changedTouches[0].clientY;var t=d?3:2;r.fire({direction:a,distance:{x:f.x-p.x,y:p.y-f.y},state:t,elapsedTime:Date.now()-s,totalDistance:{x:m.x-p.x,y:p.y-m.y},startingPoint:m,event:e})}})),r}return(0,i.Z)(n)}(c.xB),p=function(e){(0,r.Z)(n,e);var t=d(n);function n(e,i){var r,s;(0,o.Z)(this,n),(r=t.call(this,"PinchEvent",i)).element=e;var a,c=0,d={x:0,y:0},h=function(e,t,n,i){var o=Math.sqrt((e-n)*(e-n)+(t-i)*(t-i));a=d,d.x=(e+n)/2,d.y=(t+i)/2;var r=0;return 0!==s&&(r=(o-s)/(0,u._U)()),s=o,r};return(0,l.j9)("touchstart",r.element,(function(e){s=0,c=0,2===e.touches.length&&(d.x=(e.touches[0].clientX+e.touches[1].clientX)/2,d.y=(e.touches[0].clientY+e.touches[1].clientY)/2,r.fire({state:0,previousCenterPoint:d,centerPoint:d,zoomPercentage:c}))})),(0,l.j9)("touchmove",r.element,(function(e){if(2===e.touches.length){var t=e.touches[0].clientX,n=e.touches[0].clientY,i=e.touches[1].clientX,o=e.touches[1].clientY;c=h(t,n,i,o),r.fire({state:1,previousCenterPoint:a,centerPoint:d,zoomPercentage:c})}})),(0,l.j9)("touchend",r.element,(function(e){if(2===e.changedTouches.length){var t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY,i=e.changedTouches[1].clientX,o=e.changedTouches[1].clientY;c=h(t,n,i,o),r.fire({state:2,previousCenterPoint:a,centerPoint:d,zoomPercentage:c})}})),r}return(0,i.Z)(n)}(c.xB)},4043:function(e,t,n){"use strict";n.d(t,{Ey:function(){return c},Fx:function(){return r},Gf:function(){return o},U9:function(){return l},WP:function(){return s},YL:function(){return u},ah:function(){return h},qF:function(){return d},tB:function(){return a}});var i=n(1794),o=new i.xB("switchedToHLS"),r=new i.xB("openTipCalloutRequest"),s=new i.xB("loadRoomRequest"),a=new i.xB("userPanelRequest"),l=new i.xB("sendMessageInputFocus"),c=new i.xB("sendMessageInputBlur"),u=new i.xB("siteHeaderMenuOpened"),d=new i.xB("userSwitchedTab"),h=new i.xB("toggleDms")},3764:function(e,t,n){"use strict";n.d(t,{A:function(){return b},Z:function(){return w}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(1006),u=n(4793),d=n(8263),h=n(1794),f=n(3543),p=n(1177),m=n(2923),v=n(3797),g=n(3607);function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var b=new h.xB("userCountUpdate"),w=function(e){(0,s.Z)(p,e);var t,n,h=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function p(){var e;return(0,i.Z)(this,p),(e=h.call(this,(0,g._U)()-50,void 0,!0)).userCount=0,e.isUserListOpen=!1,e.userList=[],e.wrapper=e.createBaseElement("div"),e.element.appendChild(e.wrapper),e.createLoadingDiv(),(0,d.Zs)(e.wrapper,{backgroundColor:"#ffffff",padding:"19px",boxSizing:"border-box",fontFamily:"UbuntuRegular, Arial, Helvetica, sans-serif",height:"calc(100% - 45px)",fontSize:"14px"}),(0,m.q)(e.wrapper),u.kN.listen((function(t){e.chatConn=t.chatConnection,e.chatConn.event.statusChange.listen((function(t){var n="privatewatching"===t.previousStatus||"privatewatching"===t.currentStatus;("notconnected"===t.previousStatus||n)&&window.setTimeout((function(){e.refreshUsers()}),2e3)})),e.chatConn.event.roomCountUpdate.listen((function(t){e.userCount=t,b.fire(e.userCount)})),b.listen((function(t){if(e.userCount=t,void 0!==e.header){var n=e.header;e.header=e.createHeadingDiv(),e.wrapper.replaceChild(e.header,n)}}))})),e}return(0,o.Z)(p,[{key:"removeUserListChildren",value:function(){for(this.header=void 0;null!==this.wrapper.firstChild;)this.wrapper.removeChild(this.wrapper.firstChild)}},{key:"createLoadingDiv",value:function(){var e=document.createElement("div");e.innerText="Loading...",e.style.margin="6px",this.wrapper.appendChild(e)}},{key:"createHeadingDiv",value:function(){var e=document.createElement("div"),t=document.createElement("div");return(0,d.Zs)(e,{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"}),(0,d.Zs)(t,{fontSize:"16px"}),e.appendChild(t),e.appendChild(this.createRefreshUsersLink()),t.innerText="".concat(f.ag.usersText," (").concat(this.userCount,")"),e}},{key:"createRefreshUsersLink",value:function(){var e=this,t=document.createElement("div");return t.innerText=f.ag.refreshUserListSentenceCase,(0,d.Zs)(t,{cursor:"pointer",color:"#306A91"}),t.onmouseenter=function(){t.style.color="#000000"},t.onmouseleave=function(){t.style.color="#999999"},t.onclick=function(t){e.removeUserListChildren(),e.createLoadingDiv(),e.refreshUsers()},t}},{key:"refreshUsers",value:function(){var e=this;void 0!==this.chatConn&&c._B.getInstance().fetchRoomUsers().then((function(t){b.fire(t.totalCount),e.userCount=t.totalCount,e.removeUserListChildren(),e.wrapper.appendChild(e.createHeadingDiv()),e.userList=t.roomUsers;var n,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(e.userList);try{for(i.s();!(n=i.n()).done;){var o=n.value,r=document.createElement("div");r.style.margin="0 0 10px",r.style.cursor="pointer",r.style.whiteSpace="nowrap",r.style.overflow="hidden",r.style.maxWidth="100%",r.style.textOverflow="ellipsis",r.appendChild((0,v.W)(o,void 0,!0)),e.wrapper.appendChild(r)}}catch(e){i.e(e)}finally{i.f()}var s=document.createElement("div");s.innerText="+".concat(t.anonCount," anonymous user").concat(1===t.anonCount?"":"s"),(0,d.Zs)(s,{width:"100%",whiteSpace:"nowrap",color:"#A7A7A7",margin:"0 0 10px"}),e.wrapper.appendChild(s),e.repositionChildren()})).catch((function(e){error("Error retrieving mobile user list",e)}))}},{key:"getUserCount",value:function(){return this.userCount}},{key:"isOpen",value:function(){return this.isUserListOpen}},{key:"show",value:function(){(0,r.Z)((0,l.Z)(p.prototype),"show",this).call(this),this.isUserListOpen=!0,this.refreshUsers()}},{key:"hide",value:function(){(0,r.Z)((0,l.Z)(p.prototype),"hide",this).call(this),this.isUserListOpen=!1}},{key:"repositionChildren",value:function(){this.width=(0,g._U)()-50}}]),p}(p.M)},5004:function(e,t,n){"use strict";n.d(t,{w:function(){return F},i:function(){return Z}});var i=n(3243),o=n(2951),r=n(1976),s=n(7169),a=n(7591),l=n(9492),c=n(7597),u=n(5925),d=n(6474),h=n(1185),f=n(7397),p=n(2800),m=n(1522),v=n(3753),g=n(695),y=n(4793),b=n(27),w=n(9874),C=n(3705),x=n(9271),k=n(7108),S=n(9482),T=n(3543),I=n(9420),R=n(2008),P=n(3607),M=n(3682);var A,E,B,L=function(e){(0,a.Z)(u,e);var t,n,s=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function u(e,t,n){var i;return(0,o.Z)(this,u),(i=s.call(this,e,t,n)).element.style.height="auto",i.element.style.width="auto",i.element.style.maxWidth="90%",i.element.style.background="white",i.element.style.borderRadius="4px",i.element.style.margin="auto",i.element.style.position="absolute",i.element.style.boxShadow="0 10px 20px rgba(0, 0, 0, 0.2), 0 6px 6px rgba(0, 0, 0, 0.25)",i.commentInput.style.fontSize="16px",i}return(0,r.Z)(u,[{key:"repositionChildren",value:function(){if((0,i.Z)((0,c.Z)(u.prototype),"repositionChildren",this).call(this),(0,M.gr)()&&(0,P._U)()<768)this.element.style.width="90%";else{var e=Math.min(screen.width,screen.height);this.element.style.width="".concat(.9*e,"px")}this.element.style.top="".concat(((0,P.mP)()-this.element.offsetHeight)/2,"px"),this.element.style.left="".concat(((0,P._U)()-this.element.offsetWidth)/2,"px")}},{key:"onIgnoreUser",value:function(){}}]),u}(R.P),O=n(4043);function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}y.kN.listen((function(e){A=e.dossier.room,E=e.dossier.userName,B=e.chatConnection}));var U="#156b95",Z=function(e){(0,a.Z)(n,e);var t=D(n);function n(){var e,i,r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(0,o.Z)(this,n),(i=t.call(this)).isChatReportShowing=!1,i.reportModal=new w.z({onShow:function(){i.onReportModalShown()},onHide:function(){i.onReportModalHidden()},easyExit:!0}),i.isIgnored=!1,E=null===(e=p.J.current.loggedInUser)||void 0===e?void 0:e.username,i.userPanelContent=document.createElement("div"),i.element.appendChild(i.userPanelContent),i.element.style.position="relative",i.element.style.width="auto",i.element.style.height="auto",i.element.style.minHeight="40px",i.element.style.padding="4px",i.element.style.border="1px solid #cccccc",i.element.style.borderRadius="6px",i.element.style.marginBottom="16px",i.element.style.fontWeight="normal",(0,h.vP)(i.element,"userPanel"),(0,h.vP)(i.element,h.ql.bgColor),i.roomImage=document.createElement("img"),i.roomImage.style.width="47px",i.roomImage.style.height="40px",i.roomImage.style.marginRight="16px",i.roomImage.style.verticalAlign="middle",i.roomImage.style.borderRadius="4px",i.roomImage.style.display="none",i.userPanelContent.appendChild(i.roomImage),i.genderIcon=document.createElement("img"),i.genderIcon.style.position="relative",i.genderIcon.style.top="3px",i.genderIcon.style.height="16px",i.genderIcon.style.padding="6px 16px 0 0",i.genderIcon.style.display="none",i.userPanelContent.appendChild(i.genderIcon),i.displayAge=document.createElement("span"),i.displayAge.innerText="--",i.displayAge.style.verticalAlign="middle",i.displayAge.style.marginRight="16px",i.displayAge.style.display="none",i.userPanelContent.appendChild(i.displayAge),i.profileLink=_("View Profile"),i.profileLink.onclick=function(){O.WP.fire(i.username)},r&&i.userPanelContent.appendChild(i.profileLink),i.sendPMLink=_("Send PM"),i.sendPMLink.onclick=function(){(0,g.Cg)('You must be logged in to send a PM. Click "OK" to login.')||I.sC.fire({username:i.username,focus:!0,showSupporterAlert:i.needsSupporterToPm})},i.userPanelContent.appendChild(i.sendPMLink),(0,d.Fh)()&&(i.sendDMLink=_(T.ag.dmMenuTitle),i.sendDMLink.onclick=function(){(0,g.Cg)(T.ag.loggedInToDm)||(O.ah.fire(!0),f.nh.fire(i.username))},i.userPanelContent.appendChild(i.sendDMLink)),i.mentionLink=_("Mention"),i.mentionLink.style.display="inline-block",i.mentionLink.onclick=function(){I.qS.fire(i.username)},i.userPanelContent.appendChild(i.mentionLink),i.ignoreLink=_("Ignore"),i.ignoreUpdate=new x.I(!1,i.setIsIgnored.bind((0,s.Z)(i)),(function(){var e=i.isIgnored?T.ag.errorUnignoringUser(i.username):T.ag.errorIgnoringUser(i.username);(0,m.Cj)(e)})),i.ignoreLink.onclick=function(){i.onIgnoreUnignoreClick()},i.userPanelContent.appendChild(i.ignoreLink),i.reportModal.element.style.backgroundColor="rgba(0, 0, 0, 0.3)",i.reportModal.element.style.position="fixed",i.reportLink=_("Report"),i.reportLink.onclick=function(){i.isChatReportShowing?i.reportModal.hide():((0,C.fg)("ReportChatUser",{username:i.username}),i.reportModal.show())},i.reportModal.overlayClick.listen((function(){i.reportModal.hide()})),i.userPanelContent.appendChild(i.reportLink),i}return(0,r.Z)(n,[{key:"onIgnoreUnignoreClick",value:function(){var e;(0,g.Cg)("".concat(T.ag.loginForIgnore," ").concat(T.ag.clickOkToLogin))||this.ignoreUpdate.dispatch(!this.isIgnored,(e=this.username,this.isIgnored?B.unignore(e):B.ignore(e)))}},{key:"setIsIgnored",value:function(e,t){this.isIgnored=e,this.ignoreLink.innerText=e?"Unignore":"Ignore",t?(this.ignoreLink.style.pointerEvents="none",this.ignoreLink.style.color="#6c757d"):(this.ignoreLink.style.pointerEvents="",this.ignoreLink.style.color=U),void 0!==this.chatReport&&this.chatReport.updateIgnoreText(this.isIgnored)}},{key:"updateContents",value:function(e,t){var n=this;this.username=e,this.profileLink.style.display=e===A?"none":"inline-block",B.username()===A?this.ignoreLink.style.display="none":this.ignoreLink.style.display="inline-block",E===this.username?(this.ignoreLink.style.display="none",this.sendPMLink.style.display="none",this.reportLink.style.display="none",this.mentionLink.style.display="none",void 0!==this.sendDMLink&&(this.sendDMLink.style.display="none")):(void 0===t?this.reportLink.style.display="none":(this.reportLink.style.display="inline-block",this.createChatReport(t)),this.sendPMLink.style.display="inline-block",this.mentionLink.style.display="inline-block",void 0!==this.sendDMLink&&(this.sendDMLink.style.display="inline-block")),this.roomImage.style.display="none",this.genderIcon.style.display="none",this.displayAge.style.display="none",void 0!==this.silenceLink&&(this.userPanelContent.removeChild(this.silenceLink),this.silenceLink=void 0),(0,b.a)(this.username).then((function(e){n.needsSupporterToPm=e.needsSupporterToPm,e.canAccess&&(n.genderIcon.src=(0,S.Fg)(e.gender),n.displayAge.innerText=isNaN(e.displayAge)?"":"".concat(e.displayAge),n.roomImage.src=e.imageUrl,e.online&&(n.roomImage.style.display="inline"),n.genderIcon.style.display="inline",n.displayAge.style.display="inline"),n.ignoreUpdate.dispatch(B.isIgnored(n.username),Promise.resolve(!0)),n.setSilenceLink(e)})).catch((function(e){error("Could not process user menu request",e)}))}},{key:"createChatReport",value:function(e){var t=this;void 0!==this.chatReport&&this.reportModal.removeChild(this.chatReport),this.chatReport=new L(this.username,e,B),this.reportModal.addChild(this.chatReport),this.chatReport.element.style.display="none",this.chatReport.closeChatReportRequest.listen((function(e){t.reportModal.hide(),e&&(t.overlayClick.fire(void 0),void 0!==t.chatReport&&t.chatReport.tearDown())})),this.chatReport.ignoreReportedUser.listen((function(){t.ignoreUpdate.dispatch(!0,B.ignore(t.username))}))}},{key:"setSilenceLink",value:function(e){var t=this;e.canSilence&&(void 0!==e.silenceId?(this.silenceLink=_(T.ag.removeSilenceMessage),this.silenceLink.onclick=function(){(0,v.I5)("edit_room_ban/",{banid:String(e.silenceId),action:"remove_silence",room_username:A}).catch((function(t){error(t),(0,m.Cj)("Error removing silence from user ".concat(e.username))})),t.closeUserPanel()}):(this.silenceLink=_(T.ag.silenceText),this.silenceLink.onclick=function(){(0,m.oB)("Silence ".concat(e.username,"?"),(function(){(0,C.fg)("SilenceUser",{username:e.username}),(0,v.I5)("roomsilence/".concat(e.username,"/").concat(A,"/"),{}).then((function(){})).catch((function(t){error("Unable to silence user (".concat(t,")"),{room:A,username:e.username}),(0,m.Cj)("Error silencing user ".concat(e.username))}))})),t.closeUserPanel()}),this.silenceLink.style.display="inline-block",this.userPanelContent.appendChild(this.silenceLink))}},{key:"onReportModalShown",value:function(){this.reportLink.style.textDecoration="underline",void 0!==this.chatReport&&(this.chatReport.element.style.display="",this.chatReport.repositionChildren()),this.isChatReportShowing=!0}},{key:"onReportModalHidden",value:function(){this.isChatReportShowing=!1,this.reportLink.style.textDecoration="none",void 0!==this.chatReport&&(this.chatReport.element.style.display="none",this.chatReport.resetForm())}},{key:"closeUserPanel",value:function(){this.hideOverlay(),null!==this.element.parentElement&&this.element.parentElement.removeChild(this.element)}}]),n}(k.B),F=function(e){(0,a.Z)(n,e);var t=D(n);function n(){var e;return(0,o.Z)(this,n),(e=t.call(this,!0)).profileLink.onclick=function(){void 0!==B?O.WP.fire(e.username):window.location.pathname="/".concat(e.username,"/"),O.ah.fire(!1)},e}return(0,r.Z)(n,[{key:"onIgnoreUnignoreClick",value:function(){var e=this;(0,g.Cg)("".concat(T.ag.loginForIgnore," ").concat(T.ag.clickOkToLogin))||this.ignoreUpdate.dispatch(!this.isIgnored,e.isIgnored?(0,u.jr)(e.username).then((function(){return!0})):(0,u.qn)(e.username).then((function(){return!0})))}},{key:"updateContents",value:function(e,t){var n=this;this.username=e,this.element.style.top="",this.profileLink.style.display="inline-block",this.sendPMLink.style.display="none",this.mentionLink.style.display="none",void 0!==this.sendDMLink&&(this.sendDMLink.style.display="none"),E===this.username?(this.ignoreLink.style.display="none",this.sendPMLink.style.display="none",this.reportLink.style.display="none"):(this.ignoreLink.style.display="inline-block",void 0===t?this.reportLink.style.display="none":(this.reportLink.style.display="inline-block",this.createChatReport(t))),this.roomImage.style.display="none",this.genderIcon.style.display="none",this.displayAge.style.display="none",(0,b.a)(this.username).then((function(e){n.needsSupporterToPm=e.needsSupporterToPm,e.canAccess&&(n.genderIcon.src=(0,S.Fg)(e.gender),n.displayAge.innerText=isNaN(e.displayAge)?"":"".concat(e.displayAge),n.roomImage.src=e.imageUrl,e.online&&(n.roomImage.style.display="inline"),n.genderIcon.style.display="inline",n.displayAge.style.display="inline"),n.ignoreUpdate.dispatch((0,u.WU)(n.username),Promise.resolve(!0))})).catch((function(e){error("Could not process user menu request",e)}))}},{key:"createChatReport",value:function(e){var t=this;void 0!==this.chatReport&&this.reportModal.removeChild(this.chatReport),this.chatReport=new L(this.username,e,void 0),this.reportModal.addChild(this.chatReport),this.chatReport.element.style.display="none",this.chatReport.closeChatReportRequest.listen((function(e){t.reportModal.hide(),e&&(t.overlayClick.fire(void 0),void 0!==t.chatReport&&t.chatReport.tearDown())}))}},{key:"onReportModalShown",value:function(){(0,i.Z)((0,c.Z)(n.prototype),"onReportModalShown",this).call(this),this.reportModal.element.style.top="0"}},{key:"onReportModalHidden",value:function(){(0,i.Z)((0,c.Z)(n.prototype),"onReportModalHidden",this).call(this),this.reportModal.element.style.top=""}}]),n}(Z);function _(e){var t=document.createElement("span");return t.innerText=e,t.style.verticalAlign="middle",t.style.textDecoration="none",t.style.cursor="pointer",t.style.color=U,t.style.padding="0 16px 6px 0",t}},3797:function(e,t,n){"use strict";n.d(t,{W:function(){return c}});var i=n(1185),o=n(7693),r=n(8263),s=n(3705),a=n(9482),l=n(4043);function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=document.createElement("span");if((0,i.vP)(u,(0,a.c9)(e)),u.style.fontWeight="bold",u.classList.add("username"),u.innerText=c?"@".concat(e.username):e.username,u.style.maxWidth="100%",u.style.whiteSpace="nowrap",u.style.overflowX="hidden",u.style.textOverflow="ellipsis",n){var d=document.createElement("img");d.src=(0,a.Fg)(e.gender),(0,r.Zs)(d,{height:"16px",verticalAlign:"middle",margin:"0 10px 0 0"}),(0,r.Zs)(u,{fontWeight:"normal"}),u.insertBefore(d,u.firstChild)}return u.onmouseenter=function(){u.style.textDecoration="underline",u.style.cursor="pointer"},u.onmouseleave=function(){u.style.textDecoration="none",u.style.cursor="default"},(0,o.j9)("click",u,(function(n){for(var i=u.parentElement;null!==i&&"DIV"!==i.tagName;)i=i.parentElement;null===i?error("Username span has no parent"):((0,s.fg)("OpenUserPanel",{username:e.username}),l.tB.fire({username:e.username,message:t,attachTo:i}))})),u}},6958:function(e,t,n){"use strict";n.d(t,{I:function(){return c},J:function(){return l}});var i=n(2951),o=n(1976),r=n(1794),s=n(6847),a=n(3607),l=1.6,c=function(){function e(t,n){var o=this;(0,i.Z)(this,e),this.overlayElement=t,this.playerElement=n,this.touchMoveEvent=new s.$z(this.overlayElement),this.pinchEvent=new s.GJ(this.overlayElement),this.scalePlayerEvent=new r.xB("scalePlayerEvent"),this.scrollPlayerEvent=new r.xB("scrollPlayerEvent"),this.swipePlayerEvent=new r.xB("swipePlayerEvent"),this.changeVideoHeightEvent=new r.xB("changeVideoHeightEvent"),this.horizontalSwipeInProgress=!0,this.isSwipingEnabled=!1,this.pinchEvent.listen((function(e){var t=e.previousCenterPoint.x-e.centerPoint.x;o.scalePlayerEvent.fire({factor:1+1.25*e.zoomPercentage,pointX:e.centerPoint.x}),o.scrollPlayerEvent.fire(t)})),this.touchMoveEvent.listen((function(e){if(0===e.state&&(o.initialSwipeCheckDone=!1,o.horizontalSwipeInProgress=!1,o.swipeCheck(e)),o.horizontalSwipeInProgress){var t=2!==e.state||o.isCompletedSwipe(e.totalDistance.x,e.elapsedTime)?e.state:4;o.swipePlayerEvent.fire({state:t,totalDistance:e.totalDistance.x,elapsedTime:e.elapsedTime})}else{var n=e.distance.x;o.handlePlayerResize(e),o.scrollPlayerEvent.fire(n)}}))}return(0,o.Z)(e,[{key:"isSwipeAllowed",value:function(e){var t=this.playerElement.scrollLeft<=0,n=e<=0,i=Math.ceil(this.playerElement.scrollLeft)+this.playerElement.offsetWidth>=this.playerElement.scrollWidth,o=e>=0;return this.isSwipingEnabled&&(t&&n||i&&o)}},{key:"isCompletedSwipe",value:function(e,t){return Math.abs(e)>=.3333333333333333*(0,a._U)()||function(t){return t<=200&&Math.abs(e)>=.2*(0,a._U)()}(t)}},{key:"handlePlayerResize",value:function(e){this.changeVideoHeightEvent.fire({startingPoint:e.startingPoint,distance:e.distance})}},{key:"swipeCheck",value:function(e){this.initialSwipeCheckDone||(this.horizontalSwipeInProgress=this.isSwipeAllowed(e.totalDistance.x)&&0===e.direction,this.initialSwipeCheckDone=!0)}}]),e}()},3607:function(e,t,n){"use strict";n.d(t,{F7:function(){return c},Fd:function(){return d},RK:function(){return l},_U:function(){return a},mP:function(){return s}});var i,o=n(8759),r=n(3682),s=function(){return document.documentElement.clientHeight!==window.outerHeight||(0,o.Tt)()?Math.max(window.innerHeight,document.documentElement.clientHeight):window.innerHeight},a=function(){return document.documentElement.clientWidth},l=function(){return e=(0,r.gr)(),t=a(),n=s(),e?{width:t,height:n}:{width:n,height:t};var e,t,n},c=function(){return window.pageYOffset},u=null===(i=window.visualViewport)||void 0===i?void 0:i.scale,d=function(){return!(0,o.Tt)()&&null!=u&&window.visualViewport?Math.round(10*u)!==Math.round(10*window.visualViewport.scale):document.documentElement.clientWidth!==window.innerWidth}},3682:function(e,t,n){"use strict";n.d(t,{P0:function(){return a},a1:function(){return u},bs:function(){return h},gr:function(){return s},qn:function(){return c},s2:function(){return d}});var i=n(8759),o=n(1794);function r(){var e=void 0!==screen.orientation?screen.orientation.type:void 0;if(void 0!==e){if(e.startsWith("portrait"))return!0;if(e.startsWith("landscape"))return!1}}function s(){if(!c())return!0;var e=r();if(void 0!==e)return e;switch(window.orientation){case 0:case 180:case-180:return!0;case 90:case-90:case 270:return!1}return window.innerWidth===Math.min(screen.width,screen.height)||window.innerWidth<=window.innerHeight}function a(e){if(!c())return!0;if(!(0,i.Tt)()){var t=r();if(void 0!==t)return!t}switch(window.orientation){case 0:case 180:case 270:case-180:return!1;case 90:return void 0!==e&&"user"!==e||!(0,i.Tt)();case-90:return"environment"!==e||!(0,i.Tt)()}return!0}var l=Object.prototype.hasOwnProperty.call(window,"onorientationchange");function c(){return l}function u(){return"orientation"in screen&&"onchange"in screen.orientation}function d(){return c()||u()}var h=new o.xB("screenOrientationChanged")},9874:function(e,t,n){"use strict";n.d(t,{t:function(){return v},z:function(){return g}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(7693),c=n(9),u=n(1794),d=n(1625),h=n(1809);var f=new u.xB("modalReposition");(0,l.j9)("resize",window,(function(){f.fire(void 0)})),(0,l.j9)("orientationchange",window,(function(){f.fire(void 0)}));var p=new u.xB("modalEscape");(0,l.j9)("keydown",document,(function(e){27===e.keyCode&&p.fire(e)}));var m=new u.xB("modalExit");(0,l.j9)("popstate",window,(function(e){m.fire(void 0)})),h.vV.listen((function(){m.fire(void 0)}));var v=new u.xB("modalOpened"),g=function(e){(0,r.Z)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function c(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{easyExit:!0};return(0,i.Z)(this,c),(e=l.call(this)).options=t,e.overlayClick=new u.xB("overlayClick"),e.listenerGroup=new u.mM,e.isListeningForChange=!1,e.hideOverlay=!1,e.overlayClickStayOpen=!1,e.preventChatFocus=!1,e.addHidePageAction=function(){},e.overlay=document.createElement("div"),e.overlay.style.position="fixed",e.overlay.style.display="none",e.overlay.style.left="0",e.overlay.style.top="0",e.overlay.style.right="0",e.overlay.style.bottom="0",e.overlay.style.zIndex="1100",e.overlay.style.background="rgb(0,0,0,0)",e.overlay.onclick=function(t){t.stopPropagation(),e.overlayClick.fire(void 0),e.overlayClickStayOpen||e.hide()},e.element.style.zIndex="1101",e.element.onclick=function(e){e.stopPropagation()},e.repositionCallback=function(){e.isListeningForChange&&e.repositionChildrenRecursive()},e.fullscreenChangeCallback=function(){e.isListeningForChange&&e.show()},e}return(0,o.Z)(c,[{key:"show",value:function(){var e=this,t=(0,d.Gd)();(0,d.rm)()&&void 0!==t?(t.appendChild(this.overlay),t.appendChild(this.element)):(document.body.appendChild(this.overlay),document.body.appendChild(this.element)),this.isListeningForChange||(f.listen(this.repositionCallback,!1).addTo(this.listenerGroup),d.gH.listen(this.fullscreenChangeCallback,!1).addTo(this.listenerGroup),m.listen((function(){e.hide()}),!1).addTo(this.listenerGroup),this.options.easyExit&&p.listen((function(t){t.preventDefault(),e.hide()}),!1).addTo(this.listenerGroup),this.preventChatFocus&&v.fire(!0),void 0!==this.options.onShow&&this.options.onShow(),this.isListeningForChange=!0),this.hideOverlay||(this.overlay.style.display="block")}},{key:"hide",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.overlay.style.display="none",null!==this.element.parentElement&&this.element.parentElement.removeChild(this.element),null!==this.overlay.parentElement&&this.overlay.parentElement.removeChild(this.overlay),this.isListeningForChange&&(this.listenerGroup.removeAll(),this.preventChatFocus&&v.fire(!1),void 0!==this.options.onHide&&this.options.onHide(),this.isListeningForChange=!1,this.addHidePageAction(e))}}]),c}(c.w)},6227:function(e,t,n){"use strict";n.d(t,{Y:function(){return p}});var i=n(7791),o=n(2951),r=n(1976),s=n(824),a=n.n(s),l=n(4189),c=n(3753),u=n(391),d=n(4793),h=n(9165),f=n(9545),p=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;(0,o.Z)(this,e),this.limit=n,this.seenItems=new Set,this.offset=0,this.next=(0,f.mg)((0,i.Z)(a().mark((function e(){var n,i,o,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMoreRooms();case 2:return n=e.sent,i=new u.j(n.responseText),o=JSON.parse(i.getObjectString("rooms")),r=o.map((function(e){return(0,l.vx)(new u.j(e))})),t.offset+=r.length,e.abrupt("return",r.filter((function(e){return!t.seenItems.has(e.room)})).filter((function(e){return t.seenItems.add(e.room),!0})));case 8:case"end":return e.stop()}}),e)}))),[]),this.offset=0,this.listener=d.kN.listen((function(e){t.currentRoomGender=(0,h.hP)(e.dossier.roomGender),t.currentRoomName=e.chatConnection.room(),t.seenItems.add(t.currentRoomName)}),!1,!0)}return(0,r.Z)(e,[{key:"setGenders",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.genders=e,this.offset=0,this.seenItems=new Set}},{key:"getMoreRooms",value:function(){var e=new URLSearchParams(window.location.search);return e.set("genders",this.gendersParam().join(",")),e.set("room",this.currentRoomName),e.set("limit","".concat(this.limit)),e.set("offset","".concat(this.offset)),(0,c.Ue)("api/ts/roomlist/more-rooms/?".concat(e.toString()))}},{key:"gendersParam",value:function(){return this.genders.length>0?this.genders:void 0===this.currentRoomGender?window.default_gender.split(""):[this.currentRoomGender]}},{key:"dispose",value:function(){this.listener.removeListener()}}]),e}()},3705:function(e,t,n){"use strict";n.d(t,{AF:function(){return x},N$:function(){return g},NS:function(){return f},Vn:function(){return y},XI:function(){return k},Zs:function(){return h},fg:function(){return m},iL:function(){return S},qV:function(){return v},rh:function(){return p},zB:function(){return T}});var i=n(8759),o=n(7693),r=n(3753),s=n(1289);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var l,c,u,d=window.newrelic;function h(e,t){var n,o={};for(var r in o["attributes.room_user"]=null!==(n=l)&&void 0!==n?n:"",void 0!==u&&(o["attributes.currentMode"]=u),e)o["attributes.".concat(r)]=e[r];if(void 0!==t&&t&&(0,i.vA)()){var s=window.performance.now();o["attributes.timeSinceLoad"]=s/1e3,o["attributes.timeSinceLoadMS"]=s}return void 0!==c&&(o["attributes.player"]=c),void 0!==window.history.length&&(o.history_length=window.history.length),o}function f(){return void 0!==d}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};-1!==x()&&(e.PlayerVol=x()),-1!==C()&&(e.TipVol=C())}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;try{p(t);var i=h(t,n);if((0,s.dD)(window.location.search).metrics_debug,void 0===d)return void debug("New Relic is disabled, not sending metric: ".concat(e));0===Object.keys(i).length?d.addPageAction(e):d.addPageAction(e,i)}catch(e){error("New Relic Error in addPageAction: ".concat(e))}}function v(e,t){try{if(void 0===d)return;d.setCustomAttribute(e,t)}catch(e){error("New Relic Error in setCustomAttribute: ".concat(e))}}function g(e){l=e}function y(e){c=e}var b=-1,w=-1;function C(){return 0===w?0:b}function x(){return w}function k(e){b=e}function S(e,t){w=t?0:e}function T(e){"videoonly"!==e&&(u=e)}(0,o.j9)("load",window,(function e(){(0,o.SC)("load",window,e);var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw r}}}}(document.getElementsByTagName("script"));try{for(n.s();!(t=n.n()).done;){var i=t.value;null!==i.src.match(/https:\/\/js-agent\.newrelic\.com\/.*/)&&(0,o.j9)("error",i,(function(){error("Ad blocker stopped analytics collection"),(0,r.I5)("api/adblocker/",{})}))}}catch(e){n.e(e)}finally{n.f()}}))},2896:function(e,t,n){"use strict";n.d(t,{$:function(){return f}});var i=n(2951),o=n(1976),r=n(2800),s=n(7693),a=n(3753),l=n(391),c=n(695),u=n(4406),d=n(9491),h=n(3543),f=function(){function e(){var t=this;(0,i.Z)(this,e),this.usersWithNotes=new Set,(0,c.TF)()||r.J.current.isMobile||(this.getUsernames(!1),(0,s.j9)("focus",window,(function(){t.getUsernames()})),u.x.registerGenerator("notesBadge",(function(e){return t.createChatBadge(e)})))}return(0,o.Z)(e,[{key:"getUsernames",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,a.Ue)("api/notes/usernames/").then((function(n){var i=new l.j(n.responseText),o=JSON.parse(i.getObjectString("usernames"));t?(e.usersWithNotes.forEach((function(t){return o.includes(t)||e.removeUser(t)})),o.forEach((function(t){return e.usersWithNotes.has(t)||e.addUser(t)}))):(e.usersWithNotes.clear(),o.forEach((function(t){e.usersWithNotes.add(t)})))})).catch((function(e){error("Could not retrieve list of users for which currentUser has notes on")}))}},{key:"addUser",value:function(e){this.usersWithNotes.add(e),this.updateChatBadges(e)}},{key:"removeUser",value:function(e){this.usersWithNotes.has(e)&&(this.usersWithNotes.delete(e),this.updateChatBadges(e))}},{key:"createChatBadge",value:function(e){var t=document.createElement("span");t.style.display=this.usersWithNotes.has(e)?"":"none",t.style.marginRight=".1em",t.title=h.ag.notes;var n=(0,d.z2)();return t.appendChild(n),t}},{key:"updateChatBadges",value:function(e){var t=this.usersWithNotes.has(e);u.x.getBadgeElements("notesBadge",e).forEach((function(e){e.style.display=t?"inline-block":"none"}))}}],[{key:"getOrCreateInstance",value:function(){return void 0===e.singletonInstance&&(e.singletonInstance=new e),e.singletonInstance}}]),e}()},9271:function(e,t,n){"use strict";n.d(t,{I:function(){return r}});var i=n(2951),o=n(1976),r=function(){function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};(0,i.Z)(this,e),this.ID=0,this.lastValidID=0,this.initialState=t,this.currentState=t,this.lastValidState=t,this.onUpdate=n,this.onRevert=o}return(0,o.Z)(e,[{key:"setInitialState",value:function(e){this.initialState=e,0===this.ID&&(this.currentState=e,this.onUpdate(this.currentState,!1))}},{key:"dispatch",value:function(e,t){var n=this;this.ID+=1,this.currentState=e,this.onUpdate(this.currentState,!0),t.then((function(e){e?n.commit(n.ID):n.revert(n.ID)})).catch((function(){n.revert(n.ID)}))}},{key:"commit",value:function(e){e>this.lastValidID&&(this.lastValidID=e,this.lastValidState=this.currentState,this.onUpdate(this.currentState,e<this.ID))}},{key:"revert",value:function(e){0===this.lastValidID?(this.currentState=this.initialState,this.onUpdate(this.currentState,!1),this.onRevert()):e>this.lastValidID&&(this.currentState=this.lastValidState,this.onUpdate(this.currentState,e<this.ID),this.onRevert())}}]),e}()},4695:function(e,t,n){"use strict";n.d(t,{h:function(){return r}});var i=n(2951),o=n(1976),r=function(){function e(){(0,i.Z)(this,e),this.backingArray=[]}return(0,o.Z)(e,[{key:"addToTop",value:function(e){this.remove(e),this.backingArray.unshift(e)}},{key:"addToBottom",value:function(e){this.remove(e),this.backingArray.push(e)}},{key:"toArray",value:function(){return[].concat(this.backingArray)}},{key:"remove",value:function(e){var t=this.backingArray.indexOf(e);-1!==t&&this.backingArray.splice(t,1)}},{key:"popFromTop",value:function(){return this.backingArray.shift()}},{key:"popFromBottom",value:function(){return this.backingArray.pop()}}]),e}()},7108:function(e,t,n){"use strict";n.d(t,{B:function(){return d}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(9),u=n(1794);var d=function(e){(0,s.Z)(d,e);var t,n,c=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function d(e){var t;return(0,i.Z)(this,d),(t=c.call(this,"div",e)).overlayClick=new u.xB("overlayClick"),t}return(0,o.Z)(d,[{key:"initUI",value:function(e){var t=this;(0,r.Z)((0,l.Z)(d.prototype),"initUI",this).call(this,e),this.overlay=document.createElement("div"),this.overlay.style.position="fixed",this.overlay.style.display="none",this.overlay.style.left="0",this.overlay.style.top="0",this.overlay.style.right="0",this.overlay.style.bottom="0",this.overlay.style.zIndex="1000",this.overlay.style.cursor="auto",this.overlay.onclick=function(e){e.stopPropagation(),t.hideOverlay(),t.overlayClick.fire(void 0)},this.element.style.zIndex="1001",this.element.onclick=function(e){e.stopPropagation()}}},{key:"lazyInitUI",value:function(){var e=this;(0,r.Z)((0,l.Z)(d.prototype),"lazyInitUI",this).call(this),window.setTimeout((function(){e.afterDOMConstructedIncludingChildren()}),0)}},{key:"afterDOMConstructedIncludingChildren",value:function(){(0,r.Z)((0,l.Z)(d.prototype),"afterDOMConstructedIncludingChildren",this).call(this),null!==this.element.parentElement&&this.element.parentElement.insertBefore(this.overlay,this.element)}},{key:"showOverlay",value:function(){this.overlay.style.display="block"}},{key:"hideOverlay",value:function(){this.overlay.style.display="none"}},{key:"afterRemovedFromParent",value:function(){(0,r.Z)((0,l.Z)(d.prototype),"afterRemovedFromParent",this).call(this),null!==this.overlay.parentElement&&this.overlay.parentElement.removeChild(this.overlay)}}]),d}(c.w)},6479:function(e,t,n){"use strict";n.d(t,{w:function(){return s}});var i=n(2951),o=n(1976),r={height:0,name:"",imgUrl:"",width:0,abuseUrl:""},s=function(){function e(t){(0,i.Z)(this,e),this._parseResult=function(e){var t="%%%[emoticon ",n="]%%%",i=[],o=[],s=[];if(e.indexOf(t)<0)return{stringParts:[e],emoticons:[]};for(var l=0;l<e.length;l+=1)if("%"===e[l])if(e.slice(l,l+13)===t){var c=l+e.slice(l,e.length).indexOf(n);if(e.slice(c,c+4)===n){s.push(i.join("")),i=[];var u=a(e.slice(l,c+4));void 0!==u?o.push(u):(error("Cannot parse emoticon: ".concat(u)),o.push(r)),l=c+4-1}}else i.push(e[l]);else i.push(e[l]);return s.push(i.join("")),{stringParts:s,emoticons:o}}(t)}return(0,o.Z)(e,[{key:"stringParts",value:function(){return this._parseResult.stringParts}},{key:"emoticons",value:function(){return this._parseResult.emoticons}}]),e}();function a(e){var t=(e=e.replace("%%%[emoticon ","").replace("]%%%","")).split(/\|/);if(6===t.length){var n={name:t[0],thumbUrl:t[1],width:c(t[2])?Number(t[2]):80,height:c(t[3])?Number(t[3]):80,imgUrl:t[4],abuseUrl:t[5]};return void 0!==n.thumbUrl&&l(n.thumbUrl)?n:void 0}if(5===t.length){var i={name:t[0],imgUrl:t[1],width:c(t[2])?Number(t[2]):80,height:c(t[3])?Number(t[3]):80,abuseUrl:t[4]};return l(i.imgUrl)?i:void 0}}function l(e){return null!==e.match(/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/g)||(error("Invalid emoticon URL"),!1)}function c(e){return!isNaN(parseInt(e,10))||(error("Invalid dimension argument"),!1)}},710:function(e,t,n){"use strict";n.d(t,{G:function(){return I},r:function(){return T}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(8759),c=n(2800),u=n(1612),d=n(7386),h=n(7693),f=n(1522),p=n(9),m=n(8263),v=n(1794),g=n(3705),y=n(1289),b=n(2974),w=n(9169),C=n(1250),x=n(2833),k=n(1432),S=n(4352);var T=function(e){(0,r.Z)(x,e);var t,n,p=(t=x,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function x(e,t,n){var o;(0,i.Z)(this,x),(o=p.call(this)).roomStatusNotifier=t,o.videoOfflineChange=new v.xB("videoOfflineChange");var r=o.choosePlayer(e);return o.createPlayer(r,n),o.watermark=document.createElement("img"),o.watermark.src=(0,d.V)(),o.watermark.className="cbLogo",o.adjustWatermarkStyle({position:"absolute",width:"90px",height:"27px",top:"8px",right:"8px",userSelect:"none",msUserSelect:"none",pointerEvents:"none",visibility:u.w.shouldHideWaterMark?"hidden":"initial"}),o.watermark.setAttribute("draggable","false"),o.element.appendChild(o.watermark),b.S.changeVideoMode.listen((function(e){o.playerComponent.showControls()})),o.qualityMessage=document.createElement("div"),o.qualityMessage.innerText="Broadcaster's stream is experiencing network issues",(0,m.Zs)(o.qualityMessage,{display:"none",color:"#0000ff",position:"absolute",fontSize:"1.0em",fontWeight:"bold",top:"8px",left:"8px",userSelect:"none",pointerEvents:"none",msUserSelect:"none"}),o.qualityMessage.setAttribute("draggable","false"),o.element.appendChild(o.qualityMessage),o}return(0,o.Z)(x,[{key:"bindVideoEvents",value:function(){var e,t,n=this;null===(e=this.playerComponent.requestJPEG)||void 0===e||e.listen((function(e){n.forceJPEGPushPlayer(e)})),this.playerComponent.videoOfflineChange.listen((function(e){n.videoOfflineChange.fire(e),n.roomStatusNotifier.setVideoOffline(e)})),!0===(null===(t=c.J.current.loggedInUser)||void 0===t?void 0:t.isStaff)&&!0===c.J.current.qualityMessage&&c.q.onUpdate.listen((function(){var e=c.q.getState().quality;n.qualityMessage.style.display="okay"===(null==e?void 0:e.quality)||"bad"===(null==e?void 0:e.quality)||"stop"===(null==e?void 0:e.quality)?"":"none",n.qualityMessage.style.color="bad"===(null==e?void 0:e.quality)?"#ff0000":"0000ff",n.qualityMessage.innerText="stop"===(null==e?void 0:e.quality)?"Broadcaster's stream has stopped.":"Broadcaster's stream is experiencing network issues"}))}},{key:"adjustWatermarkStyle",value:function(e){(0,m.Zs)(this.watermark,e)}},{key:"stylePlayerComponent",value:function(){}},{key:"chooseHLSPlayer",value:function(){return(0,l.Tt)()?"hlsnative":"videojs"}},{key:"chooseNoAutoplayHlsSubstitute",value:function(){return"jpegToHls"}},{key:"choosePlayer",value:function(e){var t=(0,y.dD)(window.location.search).player;return void 0!==t?("hls"===t&&(t=this.chooseHLSPlayer()),t):(0,l.fh)()?e?this.chooseHLSPlayer():this.chooseNoAutoplayHlsSubstitute():(S.Mf.jpegFallback(),"jpeg")}},{key:"createVideoJsPlayer",value:function(){return new k.n(this.roomStatusNotifier)}},{key:"createPlayer",value:function(e,t){var n,i;switch(e){case"videojs":i=this.createVideoJsPlayer();break;case"hlsnative":i=new w.W(this.roomStatusNotifier);break;case"jpeg":i=new C.z(this.roomStatusNotifier);break;case"jpegToHls":i=new C.z(this.roomStatusNotifier,!0);break;default:return error("received unexpected player name: ".concat(e)),void(0,f.Cj)("unknown player: ".concat(e))}var o=!(null!==(n=null==t?void 0:t.noHook)&&void 0!==n&&n);this.playerComponent=this.prependChild(i),o&&this.afterPlayerCreated()}},{key:"afterPlayerCreated",value:function(){var e;e=this.playerComponent instanceof k.n?"videojs":this.playerComponent instanceof w.W?"hlsnative":this.playerComponent instanceof C.z?this.playerComponent.isHlsPlaceholder?"jpegToHls":"jpeg":"unknown player type",(0,g.Vn)(e),this.bindVideoEvents(),this.stylePlayerComponent()}},{key:"removePlayer",value:function(){this.playerComponent.stop(),this.playerComponent.onForceRemoved(),this.removeChild(this.playerComponent)}},{key:"forceHlsPlayer",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.removePlayer(),t="hlsnative"===this.chooseHLSPlayer()?new w.W(this.roomStatusNotifier):this.createVideoJsPlayer(),(0,h.j9)("loadeddata",t.videoElement,(function(){t.setMuted(!n)})),t.handleRoomLoaded(e),t.refreshStream(e),n?(t.setVolume(100),t.setMuted(!1)):t.setMuted(!0),this.playerComponent=this.prependChild(t),this.afterPlayerCreated(),this.repositionChildren()}},{key:"forceJPEGPushPlayer",value:function(e){this.removePlayer(),this.createPlayer("jpeg"),this.playerComponent.handleRoomLoaded(e)}}]),x}(p.w);function I(e,t,n){var i=t/(n?x.fo:x.$V),o=t;return i>e&&(o=(i=e)*(n?x.fo:x.$V)),[i,o]}},9169:function(e,t,n){"use strict";n.d(t,{W:function(){return w},y:function(){return b}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(8759),u=n(7693),d=n(1234),h=n(1794),f=n(1625),p=n(3705),m=n(3543),v=n(2974),g=n(2750),y=n(6893);var b=new h.xB("HlsNativePlayer:AirPlayChange"),w=function(e){(0,s.Z)(w,e);var t,n,h=(t=w,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function w(e){var t;(0,i.Z)(this,w),(t=h.call(this,e,"HlsNativePlayer")).lastTimeUpdate=0,t.userUnmuted=!1,t.prevIsMuted=!0,t.usingAirPlay=!1,t.showingNativeControls=!1,t.playableHlsPlayer=t.videoElement,t.element.appendChild(t.videoElement),t.videoMetrics.bindAllHTMLMedia(t.videoElement),b.listen((function(e){t.usingAirPlay=e})),(0,c.s2)()&&g.UG.listen((function(e){t.usingAirPlay||(e?t.refreshStream(t.context):t.videoElement.pause())}),!1),d.C.listen((function(e){t.chatMode=e})),t.videoElement.onclick=function(e){t.play(),debug(["click",e])},t.videoElement.onpause=function(e){debug(["pause",e])},t.videoElement.onplay=function(e){(0,p.fg)("VideoOnloadMuteStatus",{muted:t.videoElement.muted,chatMode:t.chatMode}),t.videoElement.muted?t.prevIsMuted=!0:t.userUnmuted=!0,debug(["play",e])},t.videoElement.oncanplay=function(e){debug(["canplay",e]),t.isStreamReconnecting&&t.removeReconnecting()},t.videoElement.oncanplaythrough=function(e){debug(["canplaythrough",e]);var n=(0,c.jB)();(void 0===n||n<15)&&t.play()},t.videoElement.onseeking=function(e){debug(["seeking",e])},t.videoElement.onerror=function(e){error(e,{},"VIDEO_")},t.videoElement.onvolumechange=function(e){var n=t.videoElement.volume,i=t.videoElement.muted;0===n&&(i=!0),i||t.userUnmuted||0!==(0,p.AF)()||(t.userUnmuted=!0,(0,p.fg)("UserUnmuted",{chatMode:t.chatMode})),t.prevIsMuted!==i&&t.showingNativeControls&&(0,p.fg)("ToggleMute",{newState:i}),t.setControlIsMuted.fire({isMuted:i,save:!0}),t.setControlVolume.fire({volume:100*n,save:!0}),void 0===t.unmuteContainer||i||(t.element.removeChild(t.unmuteContainer),t.unmuteContainer=void 0),t.prevIsMuted=i},t.videoElement.onstalled=function(e){(0,g.oc)()&&!t.isInPictureInPicture&&(t.videoElement.pause(),window.setTimeout((function(){t.play()}),10))},(0,u.j9)("enterpictureinpicture",t.videoElement,(function(){debug("enterpictureinpicture"),y.tb.fire({active:!0})})),(0,u.j9)("leavepictureinpicture",t.videoElement,(function(){debug("leavepictureinpicture"),y.tb.fire({active:!1,videoPaused:t.videoElement.paused})}));var n=t.videoElement.webkitPresentationMode;return(0,u.j9)("webkitpresentationmodechanged",t.videoElement,(function(){var e=t.videoElement.webkitPresentationMode;-1!==["inline","fullscreen"].indexOf(n)&&"picture-in-picture"===e?(debug("enterpictureinpicture"),y.tb.fire({active:!0})):"picture-in-picture"===n&&-1!==["inline","fullscreen"].indexOf(e)&&(debug("leavepictureinpicture"),y.tb.fire({active:!1,videoPaused:t.videoElement.paused})),"fullscreen"===e&&v.S.setFireVideoMode("noninteractive-fullscreen"),"fullscreen"===n&&v.S.setFireVideoMode(v.S.getPreviousNonFullscreenVideoMode()),n=e})),10===(0,c.jB)()&&t.createiOSUnmute(),t}return(0,o.Z)(w,[{key:"loadHlsStream",value:function(e,t){var n=this;this.setTooMuchWaitingTimeout(e),null===this.videoElement.onplaying&&(this.videoElement.onplaying=function(t){n.setTooMuchWaitingTimeout(e)}),null===this.videoElement.ontimeupdate&&(this.videoElement.ontimeupdate=function(t){var i=n.videoElement.currentTime;i-n.lastTimeUpdate>5&&(n.lastTimeUpdate=i,n.setTooMuchWaitingTimeout(e,(function(){n.lastTimeUpdate=0})),n.tryingTimeoutRefresh=!1)}),""!==t?(this.videoElement.src=t,this.roomStatusNotifier.hide()):this.videoElement.removeAttribute("src"),this.videoElement.load(),this.videoElement.style.display="inline";var i=(0,c.jB)();(!("oncanplaythrough"in window)||void 0!==i&&i>=15)&&this.play(),""===t&&(this.stop(),this.stopTooMuchWaitingTimeout())}},{key:"setVolume",value:function(e){this.videoElement.volume=e/100}},{key:"getVolume",value:function(){return this.videoElement.muted||!this.isStreamReconnecting&&this.videoElement.paused?0:100*this.videoElement.volume}},{key:"setMuted",value:function(e){this.videoElement.muted=e,this.setControlIsMuted.fire({isMuted:e,save:!0}),e?this.videoElement.setAttribute("muted",""):this.videoElement.removeAttribute("muted")}},{key:"stop",value:function(){this.lastTimeUpdate=0,this.videoElement.style.display="none",this.videoElement.pause(),this.videoElement.removeAttribute("src"),this.videoElement.load(),(0,r.Z)((0,l.Z)(w.prototype),"stop",this).call(this)}},{key:"showNativeControls",value:function(){(0,r.Z)((0,l.Z)(w.prototype),"showNativeControls",this).call(this),this.showingNativeControls||(this.showingNativeControls=!0,this.videoElement.setAttribute("controls",""),void 0!==this.unmuteContainer&&(this.unmuteContainer.style.display="block"))}},{key:"hideNativeControls",value:function(){this.showingNativeControls&&(this.showingNativeControls=!1,this.videoElement.removeAttribute("controls"),void 0!==this.unmuteContainer&&(this.unmuteContainer.style.display="none"))}},{key:"showCustomControls",value:function(){(0,r.Z)((0,l.Z)(w.prototype),"showCustomControls",this).call(this),this.hideNativeControls()}},{key:"setQualityLevel",value:function(e){}},{key:"setVolumeMuted",value:function(e,t){this.videoElement.volume=e/100,0===e||t?(this.videoElement.muted=!0,this.videoElement.setAttribute("muted","")):(this.videoElement.muted=!1,this.videoElement.removeAttribute("muted"))}},{key:"getControlBarHeight",value:function(){return 0}},{key:"enterFullScreenMode",value:function(){(0,f.Zx)(this.videoElement),this.showNativeControls()}},{key:"toggleFullscreen",value:function(){this.enterFullScreenMode()}},{key:"getVideoElement",value:function(){return this.videoElement}},{key:"createiOSUnmute",value:function(){var e=this;this.unmuteContainer=document.createElement("span"),this.unmuteContainer.style.position="absolute",this.unmuteContainer.style.top="6px",this.unmuteContainer.style.right="6px",this.unmuteContainer.style.opacity="0.8",this.unmuteContainer.style.float="right",this.unmuteContainer.style.backgroundColor="rgba(255, 255, 255, 0.8)",this.unmuteContainer.style.borderRadius="6px",this.unmuteContainer.style.height="36px",this.unmuteContainer.style.padding="3px",this.unmuteContainer.style.cursor="pointer";var t=document.createElement("span");t.textContent=m.ag.tapToUnmute,t.style.color="#0c6a93",t.style.fontSize="14px",t.style.padding="6px",t.style.position="relative",t.style.top="2px",t.style.textShadow="0 0 1px #0c6a93";var n=document.createElement("img");n.src="".concat(STATIC_URL_ROOT,"images/volume-mute.svg"),n.style.width="36px",n.style.height="36px",n.style.display="inline",n.style.verticalAlign="middle",this.unmuteContainer.appendChild(t),this.unmuteContainer.appendChild(n),this.element.appendChild(this.unmuteContainer),this.unmuteContainer.onclick=function(){e.setMuted(!1),void 0!==e.unmuteContainer&&(e.element.removeChild(e.unmuteContainer),e.unmuteContainer=void 0)},window.setTimeout((function(){t.style.display="none"}),5e3)}}]),w}(y._O)},6893:function(e,t,n){"use strict";n.d(t,{_O:function(){return E},g1:function(){return M},tb:function(){return A}});var i=n(7791),o=n(2951),r=n(1976),s=n(7591),a=n(9492),l=n(7597),c=n(824),u=n.n(c),d=n(8759),h=n(2800),f=n(7600),p=n(1612),m=n(2295),v=n(7693),g=n(3753),y=n(9),b=n(1794),w=n(3705),C=n(9992),x=n(5937),k=n(1289),S=n(9420),T=n(2750),I=n(5932),R=n(4352);function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var M=20,A=new b.xB("pictureInPictureChange"),E=function(e){(0,s.Z)(L,e);var t,n,c,y,E,B=(y=L,E=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,l.Z)(y);if(E){var n=(0,l.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,a.Z)(this,e)});function L(e,t){var n;(0,o.Z)(this,L),(n=B.call(this)).roomStatusNotifier=e,n.newRelicName=t,n.requestJPEG=new b.xB("requestJPEG"),n.requestControlVisibility=new b.xB("requestControlVisibility"),n.setControlVolume=new b.xB("setControlVolume"),n.setControlIsMuted=new b.xB("setControlIsMuted"),n.supportsAutoplayWithAudio=!0,n.videoElement=document.createElement("video"),n.isStreamReconnecting=!1,n.connectingOverlay=document.createElement("div"),n.connectingTimeouts=[],n.possibleQualityLevelsChanged=new b.xB("possibleQualityLevelsChanged"),n.videoOfflineChange=new b.xB("videoOfflineChange"),n.playbackStart=new b.xB("playbackStart"),n.showJpeg=!0,n.videoOffline=!1,n.isInPictureInPicture=!1,n.tryingTimeoutRefresh=!1,n.startTime=0,n.loading=0,n.pageLoaded=0,n.metaLoaded=0,n.dataLoaded=0,n.loadStart=0,n.minutesSincePlay=0,n.startTimesSent=!1,n.lastDropped=0,n.lastFrames=0,n.roomCount=0,n.hiddenTotal=0,n.hiddenDropped=0,n.loading=Date.now(),n.element.style.position="static",n.element.style.background="#333333 url(".concat(STATIC_URL,"cam_notice_background.jpg) center center / cover"),n.element.className="videoPlayerDiv",n.element.dataset.testid="video-container",n.videoElement.setAttribute("webkit-playsinline",""),n.videoElement.setAttribute("playsinline",""),n.videoElement.setAttribute("autoplay","autoplay"),n.videoElement.style.margin="0",n.videoElement.style.padding="0",n.videoElement.style.width="100%",n.videoElement.style.height="100%",n.videoElement.style.objectFit=(0,x.j$)()?"cover":"contain",n.videoElement.style.backgroundColor="rgba(0, 0, 0, 0.0)",n.videoElement.dataset.testid="video",n.element.appendChild(n.videoElement),window.videoElement=n.videoElement,n.connectingOverlay.style.backgroundColor="#000000",n.connectingOverlay.style.opacity="0.6",n.connectingOverlay.style.position="absolute",n.connectingOverlay.style.width="inherit",n.connectingOverlay.style.height="inherit",n.videoMetrics=new R.uj(t),n.videoMetrics.bindAll(),A.listen((function(e){n.isInPictureInPicture=e.active})),n.videoElement.onloadstart=function(){0!==n.loading&&(n.loadStart=Date.now()-n.loading)},n.videoElement.onloadeddata=function(){0!==n.loading&&(n.dataLoaded=Date.now()-n.loading)},n.videoElement.onloadedmetadata=function(){0!==n.loading&&(n.metaLoaded=Date.now()-n.loading)},n.videoElement.onplaying=function(e){if(!1===n.startTimesSent){n.roomCount+=1;var t=0,i=0;0!==n.loading&&(t=Date.now()-n.loading),0!==n.pageLoaded&&(i=Date.now()-n.pageLoaded),n.videoMetrics.sendStartTimes(t,i,n.dataLoaded,n.metaLoaded,n.loadStart,n.roomStatus,n.roomCount),n.startQualityTracking(),n.startTimesSent=!0}},(0,v.j9)("visibilitychange",document,(function(){if(document.hidden)n.leaveFrames=n.videoElement.getVideoPlaybackQuality();else if(void 0!==n.leaveFrames){var e=n.videoElement.getVideoPlaybackQuality();n.hiddenTotal+=e.totalVideoFrames-n.leaveFrames.totalVideoFrames,n.hiddenDropped+=e.droppedVideoFrames-n.leaveFrames.droppedVideoFrames}})),m.YO.listen((function(){n.stopQuality()}));var i=function(){n.showControls(),n.play();var e=function(){n.play()};(0,v.j9)("pause",n.videoElement,e),window.setTimeout((function(){(0,v.SC)("pause",n.videoElement,e)}),600)};return(0,v.j9)("webkitendfullscreen",n.videoElement,i),(0,v.j9)("leavepictureinpicture",n.videoElement,i),n}return(0,r.Z)(L,[{key:"getHlsUrlAndRoomStatus",value:(c=(0,i.Z)(u().mark((function e(t){var n,i,o,r,s=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]&&s[1],t.dossier.hlsSource===this.lastSeenHlsUrl||""===t.dossier.hlsSource){e.next=8;break}return this.lastSeenHlsUrl=t.dossier.hlsSource,i=t.chatConnection.status,this.videoOffline&&(i="offline"),e.abrupt("return",{url:this.parseHlsUrl(t.dossier.hlsSource),status:i});case 8:return e.next=10,(0,g.I5)("get_edge_hls_url_ajax/",{room_slug:t.dossier.room,bandwidth:"high",current_edge:"",exclude_edge:n?new URL(this.lastSeenHlsUrl).hostname:""});case 10:if(o=e.sent,!(r=JSON.parse(o.responseText)).success){e.next=17;break}return this.lastSeenHlsUrl=r.url,e.abrupt("return",{url:this.parseHlsUrl(r.url),status:(0,C.gN)(r.room_status)});case 17:throw o.responseText;case 18:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"parseHlsUrl",value:function(e){var t=(0,k.dD)(window.location.search);return void 0!==t.edgemm?e.replace(/(^https:\/\/)(.+?)(\/.+)/,"https://".concat(t.edgemm,".live.mmcdn.com$3")):void 0!==t.edge?e.replace(/(^https:\/\/)(.+?)(\/.+)/,"https://edge".concat(t.edge,".stream.highwebmedia.com$3")):e}},{key:"refreshStream",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.stop(),(0,i.Z)(u().mark((function i(){var o,r,s;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(t.stopQuality(),t.pageLoaded=Date.now(),e.dossier.room===t.room){i.next=5;break}return debug("Trying to refresh old room context"),i.abrupt("return");case 5:return t.lastFrames=0,t.lastDropped=0,t.leaveFrames=void 0,t.hiddenTotal=0,t.hiddenDropped=0,i.prev=10,i.next=13,t.getHlsUrlAndRoomStatus(e,n);case 13:s=i.sent,o=s.url,r=s.status,i.next=22;break;case 18:return i.prev=18,i.t0=i.catch(10),error("Unable to refresh HLS stream",{error:i.t0}),i.abrupt("return");case 22:if("offline"===t.roomStatus&&r!==t.roomStatus&&(t.isStreamReconnecting=!0),t.videoOffline="offline"===r,t.videoOfflineChange.fire(t.videoOffline),"notconnected"===t.roomStatus||"offline"!==r){i.next=28;break}return t.setOfflinePollingTimeout(e),i.abrupt("return");case 28:if("privatenotwatching"!==t.roomStatus||t.roomStatus!==r||!f._.isEnabledForUI()){i.next=30;break}return i.abrupt("return");case 30:t.roomStatus=r,t.loading=Date.now(),t.minutesSincePlay=0,t.startTimesSent=!1,t.loadHlsStream(e,o);case 35:case"end":return i.stop()}}),i,null,[[10,18]])})))().catch((function(){}))}},{key:"refreshStreamOnNewEdge",value:function(e){this.refreshStream(e,!0)}},{key:"tryVideoStart",value:(n=(0,i.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(t=this.playableHlsPlayer.play())){e.next=5;break}return e.abrupt("return",{api:"old",success:!this.videoElement.paused});case 5:return e.prev=5,e.next=8,t;case 8:return e.abrupt("return",{api:"new",success:!0});case 11:return e.prev=11,e.t0=e.catch(5),e.abrupt("return",{api:"new",success:!1,error:e.t0});case 14:case"end":return e.stop()}}),e,this,[[5,11]])}))),function(){return n.apply(this,arguments)})},{key:"playInternal",value:(t=(0,i.Z)(u().mark((function e(){var t,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tryVideoStart();case 2:if(!(t=e.sent).success){e.next=6;break}return this.playbackStart.fire(void 0),e.abrupt("return");case 6:return"old"===t.api&&(0,w.fg)("NoPromiseAutoplayPolicy"),S.SB.fire(void 0),this.setMuted(!0),e.next=11,this.tryVideoStart();case 11:if(!(n=e.sent).success){e.next=15;break}return this.playbackStart.fire(void 0),e.abrupt("return");case 15:"new"===n.api&&(this.isStreamReconnecting||(warn("Unable to play twice in a row",{err:n.error},"VIDEO_"),(0,d.op)()&&(error("Attempting to fallback to JPEG player."),this.stopQuality(),this.requestJPEG.fire(this.context))),this.handleNeverPlayed());case 16:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"play",value:function(){this.playInternal()}},{key:"stop",value:function(){this.roomStatusNotifier.displaysForStatus(this.roomStatus)&&(this.removeReconnecting(),this.clearPlayerTimeouts()),this.isStreamReconnecting&&this.clearPlayerTimeouts(),this.stopTooMuchWaitingTimeout()}},{key:"clearPlayerTimeouts",value:function(){var e,t=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(this.connectingTimeouts);try{for(t.s();!(e=t.n()).done;){var n=e.value;clearTimeout(n)}}catch(e){t.e(e)}finally{t.f()}clearTimeout(this.offlinePollingTimeout),this.offlinePollingTimeout=void 0,clearTimeout(this.onlinePollingTimeout),this.onlinePollingTimeout=void 0}},{key:"setVolume",value:function(e){this.videoElement.volume=e/100}},{key:"getVolume",value:function(){return this.videoElement.muted||!this.isStreamReconnecting&&this.videoElement.paused?0:100*this.videoElement.volume}},{key:"getMuted",value:function(){return this.videoElement.muted}},{key:"showNativeControls",value:function(){this.requestControlVisibility.fire(!1)}},{key:"showCustomControls",value:function(){this.requestControlVisibility.fire(!0)}},{key:"showControls",value:function(){(0,I.A)()?this.showCustomControls():this.showNativeControls()}},{key:"hideControls",value:function(){this.requestControlVisibility.fire(!1),this.hideNativeControls()}},{key:"setVolumeMuted",value:function(e,t){}},{key:"enterFullScreenMode",value:function(){}},{key:"getControlBarHeight",value:function(){return 0}},{key:"handleNeverPlayed",value:function(){this.stopTooMuchWaitingTimeout()}},{key:"handleRoomLoaded",value:function(e){var t=this;this.videoOffline=!1,this.showJpeg=!h.J.current.isTestbed,this.videoElement.poster=this.showJpeg?"".concat(p.w.jpegStreamUrl,"stream?room=").concat(e.dossier.room,"&f=").concat(Math.random()):"",this.context=e,this.room=e.dossier.room,e.chatConnection.event.statusChange.listen((function(n){if(t.roomStatus=n.currentStatus,t.videoMetrics.setStatus(t.roomStatus),t.roomStatusNotifier.displaysForStatus(n.currentStatus)||t.videoOffline)t.stop(),t.stopTooMuchWaitingTimeout(),t.videoOffline?t.setOfflinePollingTimeout(e):t.setOnlinePollingTimeout(e);else switch(clearTimeout(t.onlinePollingTimeout),t.onlinePollingTimeout=void 0,n.previousStatus){case"notconnected":case"privaterequesting":break;default:"notconnected"===n.currentStatus?(t.setReconnecting(e.dossier.room),window.setTimeout((function(){t.refreshStreamOnNewEdge(e)}),0)):(t.connectingTimeouts.push(window.setTimeout((function(){t.setReconnecting(e.dossier.room)}),0)),t.connectingTimeouts.push(window.setTimeout((function(){t.refreshStream(e)}),3e3)))}}))}},{key:"setReconnecting",value:function(e){var t=this.showJpeg?"".concat(p.w.jpegStreamUrl,"stream?room=").concat(e,"&f=").concat(Math.random()):"";this.element.style.background="#333333 url(".concat(t,") center center / cover"),this.roomStatusNotifier.showConnectingStatus(),this.element.insertBefore(this.connectingOverlay,this.element.firstChild),this.isStreamReconnecting=!0}},{key:"removeReconnecting",value:function(){this.isStreamReconnecting=!1,this.roomStatusNotifier.hideConnectingStatus(),this.connectingOverlay.parentElement===this.element&&this.element.removeChild(this.connectingOverlay),this.element.style.background="#333333 url(".concat(STATIC_URL,"cam_notice_background.jpg) center center / cover")}},{key:"setOnlinePollingTimeout",value:function(e){var t=this;void 0===this.onlinePollingTimeout&&(this.onlinePollingTimeout=window.setTimeout((0,i.Z)(u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.getHlsUrlAndRoomStatus(e);case 2:"offline"===n.sent.status?(t.videoOffline=!0,t.onlinePollingTimeout=void 0,t.setOfflinePollingTimeout(e),t.videoOfflineChange.fire(t.videoOffline)):(t.onlinePollingTimeout=void 0,t.setOnlinePollingTimeout(e));case 4:case"end":return n.stop()}}),n)}))),1e4))}},{key:"setOfflinePollingTimeout",value:function(e){var t=this;void 0===this.offlinePollingTimeout&&(this.offlinePollingTimeout=window.setTimeout((function(){t.offlinePollingTimeout=void 0,t.refreshStream(e)}),1e4))}},{key:"setTooMuchWaitingTimeout",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.stopTooMuchWaitingTimeout(),this.tooMuchWaitingTimeout=window.setTimeout((function(){t.tryingTimeoutRefresh?(t.removeReconnecting(),error("Attempting to fallback to JPEG player."),t.stopQuality(),t.requestJPEG.fire(t.context)):!(0,T.oc)()||t.isInPictureInPicture?t.setTooMuchWaitingTimeout(e,n):(info("Video seems to be stuck, refreshing"),t.tryingTimeoutRefresh=!0,t.refreshStreamOnNewEdge(e),n())}),1e3*M/2)}},{key:"stopTooMuchWaitingTimeout",value:function(){void 0!==this.tooMuchWaitingTimeout&&(clearTimeout(this.tooMuchWaitingTimeout),this.tooMuchWaitingTimeout=void 0)}},{key:"getVideoElement",value:function(){return this.videoElement}},{key:"onForceRemoved",value:function(){this.videoMetrics.playerForceRemoved()}},{key:"setPageLoaded",value:function(e){this.pageLoaded=e}},{key:"stopQuality",value:function(){clearInterval(this.updateQuality)}},{key:"startQualityTracking",value:function(){var e=this;this.stopQuality(),window.setTimeout((function(){e.sendQuality(),e.updateQuality=window.setInterval((function(){e.sendQuality()}),6e4)}),5e3)}},{key:"sendQuality",value:function(){if(!document.hidden){var e=0,t=0,n=0,i=0,o=0,r=0;if(!(0,d.Tt)()){var s=this.videoElement.getVideoPlaybackQuality();t=s.droppedVideoFrames-this.hiddenDropped,n=-1,(e=s.totalVideoFrames-this.hiddenTotal)>0&&(n=t/e*100),o=t-this.lastDropped,i=-1,(r=e-this.lastFrames)>0&&(i=o/r*100),this.lastFrames=e,this.lastDropped=t}var a=this.videoElement.videoHeight*this.videoElement.videoWidth;this.videoMetrics.sendQuality(n,i,e,r,a,this.videoElement.videoHeight,this.minutesSincePlay,this.roomStatus)}this.minutesSincePlay+=1}}]),L}(y.w)},1250:function(e,t,n){"use strict";n.d(t,{z:function(){return y}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(8759),c=n(2800),u=n(1612),d=n(3753),h=n(391),f=n(9),p=n(1794),m=n(1625),v=n(9992),g=n(4352);var y=function(e){(0,r.Z)(y,e);var t,n,f=(t=y,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function y(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,i.Z)(this,y),(t=f.call(this)).roomStatusNotifier=e,t.isHlsPlaceholder=n,t.requestControlVisibility=new p.xB("requestControlVisibility"),t.supportsAutoplayWithAudio=!1,t.possibleQualityLevelsChanged=new p.xB("possibleQualityLevelsChanged"),t.videoOfflineChange=new p.xB("videoOfflineChange"),t.playbackStart=new p.xB("playbackStart"),t.lastFrameTime=0,t.loading=!1,t.muted=!0,t.stopped=!0,t.url="",t.lastTime=0,t.listenerGroup=new p.mM,t.videoMetrics=new g.Mf(t.isHlsPlaceholder?"JpegToHlsPlayer":"JpegPushPlayer"),t.videoMetrics.bindAll(),t.element.style.background="#333333 url(".concat(STATIC_URL,"cam_notice_background.jpg) center center / cover"),t.element.className="videoPlayerDiv",t.element.style.position="static",t.element.dataset.testid="video-container",t.playerImage=document.createElement("img"),t.playerImage.style.width="100%",t.playerImage.style.height="100%",t.playerImage.style.objectFit="contain",t.playerImage.style.backgroundColor="black",t.playerImage.dataset.testid="video",t.playerImage.onload=function(){t.playerImage.style.display="inline",t.loading=!1},t.playerImage.onerror=function(){t.playerImage.style.display="none",t.lastTime-=100,t.loading=!1},t.element.appendChild(t.playerImage),(0,l.v8)()||(t.requestAnimationFrame=(0,l.I3)(),t.requestAnimationCallback(0)),t}return(0,o.Z)(y,[{key:"updateAjaxUrl",value:function(){var e=this;this.lastTime=Date.now(),void 0!==this.roomName&&(0,d.I5)("get_edge_hls_url_ajax/",{room_slug:this.roomName,jpeg:"1"}).then((function(t){var n=new h.j(t.responseText),i=n.getBoolean("success");if("offline"===(0,v.wg)(n))return e.videoOfflineChange.fire(!0),void e.stop();e.videoOfflineChange.fire(!1),n.ignore("url"),n.ignore("hidden_message"),i?(e.url=n.getString("cbjpeg_url",!1),n.logUnusedDebugging("parseJpegStream")):error("Unable to refresh JPEG stream",{error:t.responseText},"VIDEO_")})).catch((function(e){error("Unable to refresh JPEG stream",{error:e},"VIDEO_")}))}},{key:"requestAnimationCallback",value:function(e){var t=this;this.isHlsPlaceholder||(Date.now()-this.lastTime>5e3&&this.updateAjaxUrl(),this.stopped||""===this.url||(0,l.v8)()?this.playerImage.style.visibility="hidden":(0===this.lastFrameTime||e-this.lastFrameTime>140)&&!this.loading&&(this.loading=!0,this.lastFrameTime=e,this.playerImage.src="".concat(this.url,"&f=").concat(Math.random()),"visible"!==this.playerImage.style.visibility&&(this.playbackStart.fire(void 0),this.playerImage.style.visibility="visible")),this.requestAnimationFrame.call(window,(function(e){t.requestAnimationCallback(e)})))}},{key:"handleRoomLoaded",value:function(e){var t=this;this.stopped=!1,this.listenerGroup.removeAll(),e.chatConnection.event.statusChange.listen((function(e){t.roomStatusNotifier.displaysForStatus(e.currentStatus)||t.videoOffline?t.stop():(e.currentStatus,t.stopped=!1)})).addTo(this.listenerGroup),this.roomName=e.dossier.room,this.url=c.J.current.isTestbed?"":"".concat(u.w.jpegStreamUrl,"stream?room=").concat(this.roomName),this.requestControlVisibility.fire(!0),this.isHlsPlaceholder&&(this.playerImage.src="".concat(this.url,"&f=").concat(Math.random()),this.showPlayerImage())}},{key:"setVolume",value:function(e){this.volume=e}},{key:"getVolume",value:function(){return this.muted?0:this.volume}},{key:"setMuted",value:function(e){this.muted=e}},{key:"stop",value:function(){this.playerImage.style.visibility="hidden",this.stopped=!0}},{key:"showPlayerImage",value:function(){this.playerImage.style.visibility="visible"}},{key:"setQualityLevel",value:function(){}},{key:"showControls",value:function(){this.requestControlVisibility.fire(!0)}},{key:"hideControls",value:function(){this.requestControlVisibility.fire(!1)}},{key:"getControlBarHeight",value:function(){return 0}},{key:"enterFullScreenMode",value:function(){(0,m.Zx)(this.element)}},{key:"setVolumeMuted",value:function(e,t){}},{key:"afterRemovedFromParent",value:function(){this.stop(),this.listenerGroup.removeAll()}},{key:"getVideoElement",value:function(){}},{key:"getIsHlsPlaceholder",value:function(){return this.isHlsPlaceholder}},{key:"onForceRemoved",value:function(){this.videoMetrics.playerForceRemoved()}}]),y}(f.w)},2833:function(e,t,n){"use strict";n.d(t,{$V:function(){return r},TB:function(){return l},cm:function(){return c},fo:function(){return s}});var i=n(8759);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var r=.75,s=.5625,a="defaultVideoQuality";function l(e,t){if((0,i.IU)()){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw s}}}}(e);try{for(r.s();!(n=r.n()).done;){var s=n.value;s.value===t&&window.localStorage.setItem(a,s.label)}}catch(e){r.e(e)}finally{r.f()}}}function c(){var e="auto";if((0,i.IU)()){var t=window.localStorage.getItem(a);null!==t&&(e=t)}return e}},5932:function(e,t,n){"use strict";n.d(t,{A:function(){return r}});var i=n(2800),o=n(2974);function r(){if(!0===i.J.current.isMobile)return!0;var e=o.S.getVideoMode();return"split"!==e&&"videoonly"!==e&&"noninteractive-fullscreen"!==e}},1432:function(e,t,n){"use strict";n.d(t,{n:function(){return b}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(1522),u=n(1234),d=n(3705),h=n(6893),f=n(2833),p=n(5932);function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var g=window.videojs,y=window.Hls,b=function(e){(0,s.Z)(b,e);var t,n,v=(t=b,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function b(e){var t;(0,i.Z)(this,b),(t=v.call(this,e,"VideoJsPlayer")).lastTimeUpdate=0,t.isMuted=!0,t.neverPlayed=!1,t.userUnmuted=!1,t.chromecastOverlay=document.createElement("div"),t.isCasting=!1,t.videoElement.className="video-js vjs-default-skin",g.log.level("error"),t.chromecastOverlay.style.position="absolute",t.chromecastOverlay.style.backgroundColor="#000000",t.chromecastOverlay.style.width="inherit",t.chromecastOverlay.style.height="inherit";var n=t.createPlayerOption();t.element.onclick=function(){t.neverPlayed&&((0,p.A)()?t.showCustomControls():t.showNativeControls(),t.neverPlayed=!1)};var o=g(t.videoElement,n);if(o.qualityPickerPlugin(),t.videoJs=o,void 0!==o){t.videoMetrics.bindAllHTMLMedia(o),void 0!==g.Html5Hlsjs&&g.Html5Hlsjs.addHook("beforeinitialize",(function(e,n){e===o&&t.videoMetrics.bindAllHlsJs(n),n.on(y.Events.MANIFEST_LOADED,(function(e,t){var i=(0,f.cm)();if(void 0!==t.levels&&"auto"!==i){var o,r=-1,s=m(t.levels);try{for(s.s();!(o=s.n()).done;){var a=o.value;a.height<=parseInt(i,10)&&(r=t.levels.indexOf(a))}}catch(e){s.e(e)}finally{s.f()}n.startLevel=r}})),n.on(y.Events.MANIFEST_LOADED,(function(){n.startLoad()})),n.on(y.Events.LEVEL_SWITCHED,(function(){void 0!==t.setLevels&&t.setLevels[t.setLevels.length-1].toggled&&(0,f.TB)(t.setLevels,n.currentLevel)}))})),t.playableHlsPlayer=o,t.setupChromecastStateChange(),o.on("volumechange",(function(){t.setVolume(t.getVolume(!1))})),o.on("canplay",(function(){t.play(),t.isStreamReconnecting&&t.removeReconnecting()})),o.on("canplaythrough",(function(){t.play()}));var r=t.possibleQualityLevelsChanged;o.on("updateVideoControlQuality",(function(e,n){var i,o=[],s=m(n);try{for(s.s();!(i=s.n()).done;){var a=i.value;o.push({label:a.label,toggled:a.selected,value:a.id})}}catch(e){s.e(e)}finally{s.f()}r.fire(o),t.extractLevelSelectionForMetrics(o)})),o.on("enterpictureinpicture",(function(){debug("enterpictureinpicture"),h.tb.fire({active:!0})})),o.on("leavepictureinpicture",(function(){debug("leavepictureinpicture"),window.setTimeout((function(){h.tb.fire({active:!1,videoPaused:o.paused()})}),0)})),o.on("touchstart",(function(){document.getElementsByClassName("vjs-volume-panel")[0].classList.add("vjs-hover")}))}return(0,p.A)()?t.showCustomControls():t.showNativeControls(),window.videoJsPlayer=o,u.C.listen((function(e){t.chatMode=e})),void 0!==o.controlBar&&o.controlBar.setAttribute("data-paction","VideoJSControls"),t}return(0,o.Z)(b,[{key:"createPlayerOption",value:function(){return{techOrder:["html5"],autoplay:!0,html5:{hlsjsConfig:{debug:!1,liveSyncDuration:3,liveSyncDurationCount:void 0,liveDurationInfinity:1/0,liveMaxLatencyDuration:7,liveMaxLatencyDurationCount:void 0,liveBackBufferLength:30,autoStartLoad:!1}},controlBar:{playToggle:!1,progressControl:!1,remainingTimeDisplay:!1,durationDisplay:!1,currentTimeDisplay:!1,timeDivider:!1,pictureInPictureToggle:!1}}}},{key:"setupChromecastStateChange",value:function(){var e=this,t=0,n=window.setInterval((function(){t>=10&&clearInterval(n),void 0!==e.videoJs&&void 0!==e.videoJs.chromecastSessionManager&&(e.videoJs.chromecastSessionManager.getCastContext().addEventListener("sessionstatechanged",(function(t){if(void 0!==t.sessionState)switch(t.sessionState){case"SESSION_STARTED":case"SESSION_RESUMED":e.removeTech(),e.removeEventListeners(),e.stop(),window.setTimeout((function(){e.isCasting=!0,e.refreshStream(e.context),e.setVolume(e.getVolume(!1)),e.addChromecastMsgListener(),void 0!==e.videoJs&&(e.videoJs.tech_._ui._findTitleEl().style.visibility="hidden")}),1e3),e.roomStatusNotifier.hide(),e.addChromecastOverlay();break;case"SESSION_ENDED":window.setTimeout((function(){if(void 0!==e.videoJs){e.isCasting=!1;var t=e.getVolume(!1);e.videoJs.muted(e.isMuted),e.videoJs.volume(t),e.refreshStream(e.context),e.addTech(),e.addEventListeners()}else debug("Error: videoJs undefined!")}),2500),e.removeChromecastOverlay(),e.roomStatusNotifier.show()}})),clearInterval(n)),t+=1}),1e3)}},{key:"loadHlsStream",value:function(e,t){var n=this;""!==t?(this.roomStatusNotifier.hide(),this.isCasting?(this.addChromecastOverlay(),this.roomStatusNotifier.hide(),this.stopTooMuchWaitingTimeout()):this.setTooMuchWaitingTimeout(e),void 0!==this.videoJs?(this.isCasting?this.videoJs.tech_.setSource({src:t,type:"application/x-mpegURL"}):this.isCasting||(this.videoJs.on("playing",(function(){n.setTooMuchWaitingTimeout(e)})),this.videoJs.on("waiting",(function(){n.setTooMuchWaitingTimeout(e)})),this.videoJs.on("timeupdate",(function(t){if(void 0!==n.videoJs){var i=n.videoJs.currentTime();i-n.lastTimeUpdate>5&&(n.lastTimeUpdate=i,n.setTooMuchWaitingTimeout(e,(function(){n.lastTimeUpdate=0})),n.tryingTimeoutRefresh=!1)}})),this.videoJs.off("error"),this.videoJs.on("error",(function(t){if(void 0!==n.videoJs){var i=n.videoJs.error();null===i||2!==i.code&&4!==i.code||(n.isStreamReconnecting||n.refreshStreamOnNewEdge(e),error(i.message,t,"VIDEO_"))}else error("Videojs error type undefined",t,"VIDEO_")})),this.videoJs.src({src:t,type:"application/x-mpegURL"}),this.videoJs.qualityPickerPlugin(),this.videoJs.show(),this.videoJs.muted(this.isMuted),this.videoElement.style.display="inline"),this.playableHlsPlayer=this.videoJs,this.addTech()):(0,c.Cj)("something went wrong")):this.stop()}},{key:"addChromecastMsgListener",value:function(){var e=this;if(this.isCasting&&void 0!==this.videoJs&&void 0!==this.videoJs.chromecastSessionManager){var t=this.videoJs.chromecastSessionManager.getCastContext().getCurrentSession();if(void 0!==t){var n=0;t.addMessageListener("urn:x-cast:com.highwebmedia.cast.media",(function(t,i){e.isCasting&&i.includes("PAUSED")?(clearTimeout(n),n=window.setTimeout((function(){e.refreshStream(e.context)}),2500)):e.isCasting&&i.includes("BUFFERING")?(clearTimeout(n),n=window.setTimeout((function(){e.refreshStream(e.context)}),7500)):!e.isCasting||i.includes("PLAYING")?clearTimeout(n):e.isCasting&&i.includes("MEDIA_ERROR")&&e.refreshStreamOnNewEdge(e.context)}))}}}},{key:"setVolume",value:function(e){if(void 0!==this.videoJs){var t=this.isMuted;this.isMuted=0===e||this.videoJs.muted(),!t||this.isMuted||this.userUnmuted||(this.userUnmuted=!0,(0,d.fg)("UserUnmuted",{chatMode:this.chatMode})),t!==this.isMuted&&(0,d.fg)("ToggleMute",{newState:this.isMuted}),this.setControlVolume.fire({volume:e,save:!0}),this.setControlIsMuted.fire({isMuted:this.isMuted,save:!0})}}},{key:"setMuted",value:function(e){!this.isMuted||e||this.userUnmuted||(this.userUnmuted=!0,(0,d.fg)("UserUnmuted",{chatMode:this.chatMode})),e!==this.isMuted&&(0,d.fg)("ToggleMute",{newState:e}),this.isMuted=e,this.setControlIsMuted.fire({isMuted:e,save:!0}),void 0!==this.videoJs&&this.videoJs.muted(e)}},{key:"setVolumeMuted",value:function(e,t){this.isMuted=t,void 0!==this.videoJs&&(this.videoJs.volume(e/100),this.videoJs.muted(t))}},{key:"getVolume",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return void 0!==this.videoJs?e&&this.videoJs.muted()?0:100*this.videoJs.volume():0}},{key:"getMuted",value:function(){return void 0===this.videoJs||this.videoJs.muted()}},{key:"stop",value:function(){if(this.lastTimeUpdate=0,this.isCasting||void 0===this.videoJs){if(this.isCasting&&void 0!==this.videoJs)return this.videoJs.pause(),this.videoJs.src(),void this.videoJs.hide()}else this.videoJs.off("timeupdate"),this.videoJs.off("waiting"),this.videoJs.off("playing"),this.videoJs.pause(),this.removeTech(),this.videoJs.src(),this.videoJs.hide(),this.videoJs.muted(this.isMuted);(0,r.Z)((0,l.Z)(b.prototype),"stop",this).call(this)}},{key:"addChromecastOverlay",value:function(){this.chromecastOverlay!==this.element.firstChild&&this.element.insertBefore(this.chromecastOverlay,this.element.firstChild)}},{key:"removeChromecastOverlay",value:function(){this.chromecastOverlay.parentElement===this.element&&this.element.removeChild(this.chromecastOverlay)}},{key:"addTech",value:function(){var e=this;this.isCasting||void 0!==this.tech||void 0===this.videoJs||(this.tech=this.videoJs.tech(),this.tech.on("loadedqualitydataTS",(function(t,n){(0,d.fg)("VideoOnloadMuteStatus",{muted:e.isMuted,chatMode:e.chatMode}),e.isMuted||(e.userUnmuted=!0);var i,o=[],r="auto",s=m(n.qualityData.video);try{for(s.s();!(i=s.n()).done;){var a=i.value;o.push({label:a.label,toggled:a.selected,value:a.id}),!0===a.selected&&(r=a.label)}}catch(e){s.e(e)}finally{s.f()}var l,c=m(document.getElementsByClassName("vjs-menu-item vjs-selected"));try{for(c.s();!(l=c.n()).done;){var u=l.value;u.getElementsByClassName("vjs-menu-item-text")[0].innerHTML!==r&&(u.classList.remove("vjs-selected"),u.ariaChecked="false",u.getElementsByClassName("vjs-control-text")[0].innerHTML="")}}catch(e){c.e(e)}finally{c.f()}e.setLevels=o,e.possibleQualityLevelsChanged.fire(o),e.extractLevelSelectionForMetrics(o),void 0===n.qualitySwitchCallback&&(0,d.fg)("clickMenuLink:QualitySelect-".concat(o.filter((function(e){return e.toggled}))[0].label))})))}},{key:"removeEventListeners",value:function(){this.isCasting||void 0===this.videoJs||(this.videoJs.off("canplay"),this.videoJs.off("canplaythrough"))}},{key:"addEventListeners",value:function(){var e=this;this.isCasting||void 0===this.videoJs||(this.videoJs.on("canplay",(function(){e.play(),e.isStreamReconnecting&&e.removeReconnecting()})),this.videoJs.on("canplaythrough",(function(){e.play()})))}},{key:"removeTech",value:function(){this.isCasting||void 0===this.tech||(this.tech.off("loadedqualitydataTS"),void 0!==this.tech.hlsProvider&&this.tech.hlsProvider.dispose(),this.tech.reset(),this.tech=void 0)}},{key:"setQualityLevel",value:function(e){void 0!==this.videoJs&&this.videoJs.selectQualityButton(e)}},{key:"handleNeverPlayed",value:function(){(0,r.Z)((0,l.Z)(b.prototype),"handleNeverPlayed",this).call(this),this.requestControlVisibility.fire(!0),this.neverPlayed=!0}},{key:"showNativeControls",value:function(){(0,r.Z)((0,l.Z)(b.prototype),"showNativeControls",this).call(this),void 0!==this.videoJs&&this.videoJs.controls(!0)}},{key:"lockShowingControls",value:function(){void 0!==this.videoJs&&(this.showNativeControls(),this.videoJs.controlBar.lockShowing())}},{key:"unlockShowingControls",value:function(){void 0!==this.videoJs&&this.videoJs.controlBar.unlockShowing()}},{key:"showCustomControls",value:function(){(0,r.Z)((0,l.Z)(b.prototype),"showCustomControls",this).call(this),this.hideNativeControls()}},{key:"hideNativeControls",value:function(){void 0!==this.videoJs&&this.videoJs.controls(!1)}},{key:"enterFullScreenMode",value:function(){void 0!==this.videoJs&&(this.videoJs.requestFullscreen(),this.showNativeControls())}},{key:"getControlBarHeight",value:function(){return 0}},{key:"getVideoElement",value:function(){return this.videoElement}},{key:"getVideoJs",value:function(){return this.videoJs}},{key:"extractLevelSelectionForMetrics",value:function(e){var t,n=m(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.toggled&&this.videoMetrics.setQualityLevel(i.label)}}catch(e){n.e(e)}finally{n.f()}}}]),b}(h._O)},4352:function(e,t,n){"use strict";n.d(t,{ub:function(){return E},uj:function(){return L},Mf:function(){return B},ZV:function(){return T}});var i=n(3243),o=n(7591),r=n(9492),s=n(7597),a=n(4649),l=n(2951),c=n(1976),u=n(8759),d=n(2800),h=n(7693),f=n(3753),p=n(391),m=n(4793),v=n(1282),g=n(3705),y=n(928),b=n(1289),w=function(){function e(){(0,l.Z)(this,e),this.pendingMessages=[],this.qualityUpdatesKey="qualityUpdates",this.saveTimeSecondsKey="saveTimeSeconds",this.messagesKey="messages","undefined"!=typeof sessionStorage&&this.loadFromSessionStorage(),this.intervalId=window.setInterval(this.sendMessages.bind(this),5e3)}return(0,c.Z)(e,[{key:"addMessage",value:function(e){this.pendingMessages.push(e)}},{key:"stop",value:function(){clearInterval(this.intervalId),"undefined"==typeof sessionStorage?this.sendMessages():this.saveToSessionStorage()}},{key:"sendMessages",value:function(){if(this.pendingMessages.length>0){var e=(0,a.Z)({},this.qualityUpdatesKey,JSON.stringify(this.pendingMessages));this.pendingMessages=[],(0,f.I5)("api/ts/chat/send-player-quality/",e)}}},{key:"saveToSessionStorage",value:function(){var e;this.pendingMessages.length>0&&(sessionStorage.setItem(this.qualityUpdatesKey,JSON.stringify((e={},(0,a.Z)(e,this.saveTimeSecondsKey,(new Date).getTime()/1e3),(0,a.Z)(e,this.messagesKey,this.pendingMessages),e))),this.pendingMessages=[])}},{key:"loadFromSessionStorage",value:function(){var e=sessionStorage.getItem(this.qualityUpdatesKey);if(sessionStorage.removeItem(this.qualityUpdatesKey),null==e)this.pendingMessages=[];else{var t=JSON.parse(e);(new Date).getTime()/1e3-t[this.saveTimeSecondsKey]<=60&&(this.pendingMessages=t[this.messagesKey])}}}]),e}();function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=window.Hls;function T(){I(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=A.getInstance().browserId;if(void 0!==t){if("a"!==t.charAt(t.length-1)&&!1===d.J.current.sample_metrics_off)return;if(M(e),("playerError"===e.eventName||"playerQuality"===e.eventName)&&!0===e.stopped)return;if(!0===e.badFrames){var n={};for(var i in e)n["attributes.".concat(i)]=e[i];(0,f.I5)("api/ts/chat/send-quality/",n)}else(0,g.fg)("VideoMetric",e,!0)}}function R(){return(new Date).getTime()}function P(){return(0,u.vA)()?window.performance.now():R()}function M(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=d.q.getState().quality;void 0!==t&&(e.fpsquality=t.quality,e.rate=t.rate,e.stopped=t.stopped,e.tabHidden=document.hidden,e.videoSessionID=A.getInstance().value),e.region=d.q.getState().edgeRegion,e.isiPad=(0,u._1)(),delete e.tid}var A=function(){function e(){(0,l.Z)(this,e);var t=window.browserId;if(void 0===t){var n=d.q.getState();""===n.room&&window.initialRoomDossier&&(n=(0,y.As)(new p.j(window.initialRoomDossier))),this.browserId=n.browserId,(0,g.N$)(n.room)}else this.browserId=t}return(0,c.Z)(e,[{key:"value",get:function(){return void 0===this.__value&&(this.__value=this.generate()),this.__value}},{key:"clear",value:function(){this.__value=void 0}},{key:"generate",value:function(){return"".concat(this.browserId,":").concat(R())}}],[{key:"getInstance",value:function(){return void 0===e.instance&&(e.instance=new e),e.instance}}]),e}(),E=function(){function e(){(0,l.Z)(this,e),(0,u.vA)()&&(this.start=P())}return(0,c.Z)(e,[{key:"send",value:function(e,t,n){if((0,u.vA)()&&void 0!==this.start){var i=P()-this.start-t,o=this.start=P(),r={eventName:"autoPlayDuration",autoPlayDuration:o/1e3,autoPlayDurationMS:o,autoPlayDurationNoDelay:i/1e3,autoPlayDurationNoDelayMS:i,autoPlayable:e};0!==t&&(r.autoPlayHiddenDelay=t/1e3,r.autoPlayHiddenDelayMS=t),null!=n&&(r.autoPlayError=n),I(r)}}}]),e}(),B=function(){function e(t){var n=this;(0,l.Z)(this,e),this.windowUnloadSent=!1,this.roomListening=!1,this.roomDuration=0,this.roomsVisited=0,this.sendMetric=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};I(k({playerType:n.playerName,roomDuration:n.roomDuration,roomsVisited:n.roomsVisited,roomStatus:n.roomStatus},e))},this.sendPlayerCreatedMetric=function(){var e={eventName:"playerCreated"},t=(0,b.dD)(window.location.search).player;void 0!==t&&(e.playerOverride=t),n.sendMetric(e),n.createdTime=P()},this.onRoomLoaded=function(e){n.roomLoadedTime=P(),A.getInstance().browserId=e.dossier.browserId,n.roomName=e.dossier.room},this.onRoomUnloaded=function(){n.windowUnloadSent||(n.sendUnloadMetrics(),A.getInstance().clear())},this.onWindowUnloaded=function(){n.windowUnloadSent||(n.sendUnloadMetrics(),void 0!==n.qualityNotifier&&n.qualityNotifier.stop(),n.windowUnloadSent=!0,n.removeListeners())},(0,v.L)("VDPEnblBEQualNR")&&(this.qualityNotifier=new w),this.playerName=t,this.sendPlayerCreatedMetric()}return(0,c.Z)(e,[{key:"bindAll",value:function(){this.removeListeners(),m.kN.listen(this.onRoomLoaded),m.QN.listen(this.onRoomUnloaded),(0,h.j9)("pagehide",window,this.onWindowUnloaded),(0,h.j9)("beforeunload",window,this.onWindowUnloaded),(0,h.j9)("unload",window,this.onWindowUnloaded),this.roomListening=!0}},{key:"addBatchedMetric",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,g.rh)(e),M(e);var t=(0,g.Zs)(e,!0);void 0!==this.qualityNotifier&&this.qualityNotifier.addMessage(t)}},{key:"sendUnloadMetrics",value:function(){if(void 0!==this.roomLoadedTime&&(0,u.vA)()){this.roomUnloadedTime=P();var e=this.roomUnloadedTime-this.roomLoadedTime;return this.sendMetric({room_user:this.roomName,eventName:"viewerDuration",viewerDuration:e/1e3,viewerDurationMS:e}),e}}},{key:"removeListeners",value:function(){this.roomListening&&((0,h.SC)("pagehide",window,this.onWindowUnloaded),(0,h.SC)("beforeunload",window,this.onWindowUnloaded),(0,h.SC)("unload",window,this.onWindowUnloaded),m.kN.removeListener(this.onRoomLoaded),m.QN.removeListener(this.onRoomUnloaded),this.roomListening=!1)}},{key:"playerForceRemoved",value:function(){this.onWindowUnloaded()}}],[{key:"jpegFallback",value:function(){I({eventName:"jpegFallback",hlsNativeSupported:(0,u.iC)(),hlsJsSupported:S.isSupported()})}}]),e}(),L=function(e){(0,o.Z)(d,e);var t,n,a=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,s.Z)(t);if(n){var o=(0,s.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,r.Z)(this,e)});function d(e){var t;return(0,l.Z)(this,d),(t=a.call(this,e)).htmlMediaListening=!1,t.htmlMediaPlayingSent=!1,t.htmlMediaPlayingIsAjax=!1,t.hlsJsListening=!1,t.lastError={},t.sendHTMLMediaPlayingMetric=function(){if(!t.htmlMediaPlayingSent){var e={eventName:"videoPlaying",isAjax:!1,bitrate:t.hlsCurrentBitrate},n=t.currentProgramDateTime();void 0!==n&&t.sendHLSMetric({eventName:"broadcastDelay",broadcastDelayMS:n,broadcastDelay:n/1e3});var i=P();if(void 0===t.htmlMediaLoadStartTime)warn("Playing metric has triggered but htmlMediaLoadStartTime is undefined...skipping");else{var o=i-t.htmlMediaLoadStartTime;e.timeSinceMediaLoadStart=o/1e3,e.timeSinceMediaLoadStartMS=o}if(void 0!==t.hlsMediaAttachingTime){var r=i-t.hlsMediaAttachingTime;e.timeSinceMediaAttaching=r/1e3,e.timeSinceMediaAttachingMS=r}if(t.htmlMediaPlayingIsAjax){if(void 0===t.roomLoadedTime)return void warn("Playing metric is for AJAX reload but roomLoadedTime is undefined...skipping");var s=i-t.roomLoadedTime;e.timeSinceLoadAjax=s/1e3,e.timeSinceLoadAjaxMS=s,e.isAjax=!0,void 0===t.roomUnloadedTime?warn("Playing metric is for AJAX reload but roomUnloadedTime is undefined"):(s=i-t.roomUnloadedTime,e.timeSinceUnloadAjax=s/1e3,e.timeSinceUnloadAjaxMS=s)}else{var a=i-t.createdTime;e.timeSincePlayerCreated=a/1e3,e.timeSincePlayerCreatedMS=a}t.sendHLSMetric(e),t.htmlMediaPlayingSent=!0,t.htmlMediaPlayingIsAjax=!0}},t.sendHTMLMediaErrorMetric=function(){var e;null!=(e=t.playerElement instanceof HTMLMediaElement?t.playerElement.error:t.playerElement.error_)&&t.sendHLSMetric({eventName:"playerError",errorCode:e.code,errorMessage:e.message,errorSource:"HTMLMediaElement",errorReadyState:t.playerElement.readyState,errorNetworkState:t.playerElement.networkState,bitrate:t.hlsCurrentBitrate})},t.onHTMLMediaEvent=function(e){if(t.htmlMediaListening)if("playing"!==e.type)if("loadstart"!==e.type)if("error"!==e.type)if("stalled"!==e.type)warn("Received unknown HTMLMediaElement event: ",e);else{var n=e.target;if(null!=n){var i={eventName:"playerStalled",stalledReadyState:n.readyState,stalledNetworkState:n.networkState,bitrate:t.hlsCurrentBitrate};(0,v.L)("VDPEnblBEQualNR")&&t.addBatchedMetric(i),(0,v.L)("VDPDisblFEQualNR")||t.sendHLSMetric(i)}}else t.sendHTMLMediaErrorMetric();else t.htmlMediaLoadStartTime=P();else t.sendHTMLMediaPlayingMetric()},t.bindAllHlsJs=function(e){t.removeHLSListeners(),t.hls=e,t.hls.on(S.Events.ERROR,t.onHlsJsEvent),t.hls.on(S.Events.FRAG_CHANGED,t.onHlsJsEvent),(0,u.vA)()&&(t.hls.on(S.Events.LEVEL_SWITCHING,t.onHlsJsEvent),t.hls.on(S.Events.LEVEL_SWITCHED,t.onHlsJsEvent),t.hls.on(S.Events.MEDIA_ATTACHING,t.onHlsJsEvent)),t.hlsJsListening=!0},t.addHlsJsLevel=function(e){var n=e.level;if(void 0!==n){for(var i=0,o=["bitrate","height","width"];i<o.length;i++){var r=o[i];if(isNaN(e[r]))return void warn("Level ".concat(r," is not a number: ").concat(e[r],"...skipping"))}t.hlsJsLevels[n]=e,t.hlsJsSwitchingTimes.unshift({level:n,ts:P()})}else warn("Received Hls.Events.LEVEL_SWITCHING without a level: ",e)},t.setMaxHlsLevel=function(e){var n=e.level;if(void 0!==n){var i=t.hlsJsLevels[n];if(void 0!==i){var o,r,s=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(t.hlsJsSwitchingTimes);try{for(s.s();!(o=s.n()).done;){var a=o.value;if(a.level===n){var l=(r=a.ts,P()-r);t.hlsJsSwitchedTimes.push(l);break}}}catch(e){s.e(e)}finally{s.f()}(void 0===t.hlsJsMaxLevel||i.bitrate>t.hlsJsMaxLevel.bitrate)&&(t.hlsJsMaxLevel=i),t.hlsCurrentBitrate=i.bitrate}else warn("Received unknown Hls.Events.LEVEL_SWITCHED level: ",e)}else warn("Received Hls.Events.LEVEL_SWITCHED without a level: ",e)},t.currentProgramDateTime=function(){var e;if(void 0!==t.hlsLastFrag&&void 0!==(e=t.playerElement instanceof HTMLMediaElement?t.playerElement.currentTime:t.playerElement.currentTime())){var n=e-t.hlsLastFrag.start;if(!(n<0)){n*=1e3;var i=R()-t.hlsLastFrag.programDateTime+n;if(!(i<0||i>3e5))return i}}},t.onHlsJsEvent=function(e,n){if(t.hlsJsListening)if(e!==S.Events.LEVEL_SWITCHING)if(e!==S.Events.LEVEL_SWITCHED)if(e!==S.Events.FRAG_CHANGED)if(e!==S.Events.MEDIA_ATTACHING)if(e!==S.Events.ERROR)warn("Received unknown Hls.Event: ",e);else{var i=t.playerElement.tech().el(),o={eventName:"playerError",errorCode:n.type,errorMessage:n.details,errorSource:"hls.js",errorReadyState:i.readyState,errorNetworkState:i.networkState,bitrate:t.hlsCurrentBitrate,quality:t.hlsCurrentQualityLevel};(t.lastError!==o||void 0!==t.lastTime&&Date.now()-t.lastTime>1e3)&&(t.sendHLSMetric(o),t.lastError=o,t.lastTime=Date.now())}else t.hlsMediaAttachingTime=P();else t.hlsLastFrag=n.frag;else t.setMaxHlsLevel(n);else t.addHlsJsLevel(n)},t.removeHLSListeners=function(){t.hlsJsListening&&void 0!==t.hls&&(t.hls.off(S.Events.ERROR,t.onHlsJsEvent),t.hls.off(S.Events.FRAG_CHANGED,t.onHlsJsEvent),(0,u.vA)()&&(t.hls.off(S.Events.LEVEL_SWITCHING,t.onHlsJsEvent),t.hls.off(S.Events.LEVEL_SWITCHED,t.onHlsJsEvent)),t.hlsJsListening=!1)},t.removeHTMLMediaListeners=function(){t.htmlMediaListening&&(t.playerElement instanceof HTMLMediaElement?((0,u.vA)()&&((0,h.SC)("playing",t.playerElement,t.onHTMLMediaEvent),(0,h.SC)("loadstart",t.playerElement,t.onHTMLMediaEvent)),(0,h.SC)("error",t.playerElement,t.onHTMLMediaEvent),(0,h.SC)("stalled",t.playerElement,t.onHTMLMediaEvent)):((0,u.vA)()&&(t.playerElement.off("playing",t.onHTMLMediaEvent),t.playerElement.off("loadstart",t.onHTMLMediaEvent)),t.playerElement.off("error",t.onHTMLMediaEvent),t.playerElement.off("stalled",t.onHTMLMediaEvent)),t.htmlMediaListening=!1)},t.reset=function(){t.htmlMediaPlayingSent=!1,t.hlsJsLevels=new Map,t.hlsCurrentBitrate=void 0,t.hlsJsSwitchingTimes=[],t.hlsJsSwitchedTimes=[],t.hlsJsMaxLevel=void 0,t.hlsLastFrag=void 0,t.htmlMediaLoadStartTime=void 0,t.hlsMediaAttachingTime=void 0,t.roomDuration=0,t.roomsVisited=0},t.sendHLSMetric=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};void 0!==t.hls&&(e=t.hls.latency),t.sendMetric(k({acuteLatency:t.currentProgramDateTime(),averageLatency:t.averageLatency,minLatency:t.minLatency,maxLatency:t.maxLatency,hlsLatency:e},n))},t.reset(),t.listenForChunklist(),t}return(0,c.Z)(d,[{key:"bindAllHTMLMedia",value:function(e){var t;this.removeHTMLMediaListeners(),this.playerElement=e,this.lastTime=Date.now(),t=this.playerElement instanceof HTMLMediaElement?this.playerElement:this.playerElement.tech().el(),(0,u.vA)()&&((0,h.j9)("playing",t,this.onHTMLMediaEvent),(0,h.j9)("loadstart",t,this.onHTMLMediaEvent)),(0,h.j9)("error",t,this.onHTMLMediaEvent),(0,h.j9)("stalled",t,this.onHTMLMediaEvent),this.htmlMediaListening=!0}},{key:"setQualityLevel",value:function(e){this.hlsCurrentQualityLevel=e}},{key:"sendUnloadMetrics",value:function(){var e=(0,i.Z)((0,s.Z)(d.prototype),"sendUnloadMetrics",this).call(this);if(void 0!==e&&e>5e3){void 0!==this.hlsJsMaxLevel&&this.sendHLSMetric({room_user:this.roomName,eventName:"levelMax",levelMaxName:this.hlsJsMaxLevel.name,levelMaxBitrate:this.hlsJsMaxLevel.bitrate,levelMaxAudioCodec:this.hlsJsMaxLevel.audioCodec,levelMaxVideoCodec:this.hlsJsMaxLevel.videoCodec,levelMaxHeight:this.hlsJsMaxLevel.height,levelMaxWidth:this.hlsJsMaxLevel.width,bitrate:this.hlsCurrentBitrate});var t=this.hlsJsSwitchedTimes.reduce((function(e,t){return e+t}),0)/this.hlsJsSwitchedTimes.length;isNaN(t)||this.sendHLSMetric({room_user:this.roomName,eventName:"levelSwitchAvg",levelSwitchAvg:t/1e3,levelSwitchAvgMS:t,levelSwitchCount:this.hlsJsSwitchedTimes.length})}return this.reset(),e}},{key:"removeListeners",value:function(){(0,i.Z)((0,s.Z)(d.prototype),"removeListeners",this).call(this),this.removeHLSListeners(),this.removeHTMLMediaListeners()}},{key:"sendStartTimes",value:function(e,t,n,i,o,r,s){this.roomStatus=r,this.roomsVisited=s,this.roomDuration=0;var a={eventName:"playerTimes",room_user:this.roomName,startTime:e/1e3,pageStartTime:t/1e3,dataLoadTime:n/1e3,metaLoadTime:i/1e3,startLoadTime:o/1e3};(0,v.L)("VDPEnblBEQualNR")&&this.addBatchedMetric(a),(0,v.L)("VDPDisblFEQualNR")||this.sendHLSMetric(a)}},{key:"sendQuality",value:function(e,t,n,i,o,r,s,a){if(this.roomDuration=s,"privatenotwatching"!==a&&"hidden"!==a&&"away"!==a){var l={};l={eventName:"playerQuality",room_user:this.roomName,resolution:o,videoHeight:r},(0,u.Tt)()||(l=k(k({},l),{},{droppedFrames:e,totalFrames:n,segmentDropped:t,segmentFrames:i})),t>30&&(l.badFrames=!0),this.sendHLSMetric(l)}}},{key:"setStatus",value:function(e){this.roomStatus=e}},{key:"listenForChunklist",value:function(){var e=this,t=0,n=0,i=function(i){var o=i.target;if(o.responseURL.includes("chunklist")){var r=o.responseText,s=r.indexOf("#EXT-X-PROGRAM-DATE-TIME:");if(-1!==s){var a=r.substring(s),l=a.indexOf("\n");if(-1!==l){var c=a.substring(0,l).split(":")[3].split("+")[0],u=new Date,d=1e3*u.getSeconds()+u.getMilliseconds()-1e3*parseInt(c);if(d<0&&(d=6e4+d),(void 0===e.minLatency||d<e.minLatency)&&(e.minLatency=d),(void 0===e.maxLatency||d>e.maxLatency)&&(e.maxLatency=d),t<5)n+=d,t+=1;else{var h=n/t;e.averageLatency=h,t=0,n=0}}}}},o=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){this.addEventListener("load",i);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.apply(this,t)}}}]),d}(B)},2648:function(e,t,n){"use strict";n.d(t,{f:function(){return a}});var i=n(2951),o=n(1976),r=n(2800),s=n(4793),a=function(){function e(){(0,i.Z)(this,e),this.dontNotify=new Set,this.initListeners()}return(0,o.Z)(e,[{key:"initListeners",value:function(){var e=this;s.Z2.listen((function(t){e.dontNotify.add(t)})),s.QN.listen((function(){e.dontNotify.clear()}))}},{key:"shouldNotify",value:function(e){var t;return!this.dontNotify.has(e)&&e!==(null===(t=r.J.current.loggedInUser)||void 0===t?void 0:t.username)}},{key:"preventNotifications",value:function(e){this.dontNotify.add(e)}}]),e}()},3544:function(e,t,n){"use strict";n.d(t,{Cd:function(){return p},RZ:function(){return g},Sv:function(){return h},dy:function(){return f},jX:function(){return m},uo:function(){return v},ve:function(){return y}});var i=n(2800),o=n(795),r=n(1522),s=n(3753),a=n(391),l=n(695),c=n(1794),u=n(3705),d=n(3543),h=new c.xB("privateJoinInitiated");function f(e){var t,n;h.fire(void 0),(0,l.Cg)(d.ag.loginForPrivateShow)||((0,u.fg)("RequestPrivateShow"),(t=e.room(),n="tipping/private_show_tokens_per_minute/".concat(t,"/"),new Promise((function(e,t){(0,s.Ue)(n).then((function(t){var n=new a.j(t.responseText);e({minimumMinutes:n.getStringWithNumbers("private_show_minimum_minutes"),price:n.getNumber("price"),recordingsAllowed:n.getBoolean("recordings_allowed"),allowed:n.getBoolean("allowed",!0,!1)}),n.logUnusedDebugging("parseTokensPerMinute")})).catch((function(e){t(e)}))}))).then((function(t){if(t.allowed){var n=d.ag.privateShowConfirmMessage(e.room(),t.price,t.minimumMinutes,t.recordingsAllowed);(0,r.oB)(n,(function(){e.requestPrivateShow(t.price,t.minimumMinutes,t.recordingsAllowed).then((function(e){""!==e&&(0,o.dg)(e,!1,i.J.current.PurchaseEventSources.TOKEN_SOURCE_LOW_TOKEN_BALANCE)})).catch((function(t){"privatewatching"!==e.status&&((0,r.Cj)(d.ag.errorRequestingPrivateShow),error("Error entering private show",t))})),(0,u.fg)("StartPrivateShow")}))}else(0,r.Cj)(d.ag.featureNotEnabled)})).catch((function(){})))}function p(e){if(h.fire(void 0),!(0,l.Cg)(d.ag.loginForPrivateShowSpy)){(0,u.fg)("RequestSpyShow");var t="tipping/spy_on_private_show_tokens_per_minute/".concat(e.room(),"/");(0,s.Ue)(t).then((function(t){var n=Number(t.responseText);isNaN(n)?error("isNaN on ".concat(t.responseText)):0!==n?(0,r.oB)(d.ag.privateShowSpyConfirmMessage(n),(function(){e.requestSpyShow().then((function(e){""!==e&&(0,o.dg)(e,!1,i.J.current.PurchaseEventSources.TOKEN_SOURCE_LOW_TOKEN_BALANCE)})).catch((function(t){"privatespying"!==e.status&&((0,r.Cj)(d.ag.errorRequestingSpyShow),error("Error entering spy show",t))})),(0,u.fg)("StartSpyShow")})):(0,r.Cj)(d.ag.privateShowSpyDisabled)})).catch((function(){}))}}function m(e,t){(0,r.oB)(d.ag.areYouSure,(function(){(0,u.fg)("LeavePrivateOrSpyShow"),e.leavePrivateOrSpyShow().then((function(e){void 0!==t&&t(),""!==e&&(0,r.Cj)(e)})).catch((function(){}))}),(function(){void 0!==t&&t()}))}function v(){(0,s.I5)("tipping/private_show_approve/",{foo:"bar"}).then((function(){debug("Approved private show")})).catch((function(){}))}function g(){(0,s.I5)("tipping/private_show_decline/",{foo:"bar"}).then((function(){debug("Declined private show")})).catch((function(){}))}function y(){(0,s.I5)("tipping/return_from_away/",{foo:"bar"}).then((function(){debug("Return from away")})).catch((function(){}))}},9545:function(e,t,n){"use strict";function i(e){return e.map((function(e){return Promise.resolve(e).then((function(e){return{status:"fulfilled",value:e}})).catch((function(e){return{status:"rejected",reason:e}}))}))}n.d(t,{$x:function(){return o},Gr:function(){return r},mg:function(){return s},uK:function(){return i}});var o=function(){},r=function(e){error(e)};function s(e,t){var n=!1;return function(){return new Promise((function(i,o){if(!n)return n=!0,e().finally((function(){n=!1})).then((function(e){i(e)})).catch((function(e){o(e)}));i(t)}))}}},2578:function(e,t,n){"use strict";n.d(t,{GC:function(){return h},N0:function(){return f},Ng:function(){return c},PU:function(){return u},QZ:function(){return m},nM:function(){return g},rk:function(){return v},yU:function(){return p}});var i=n(7693),o=n(3753),r=n(4793),s=n(1809),a="room",l="next",c="/accounts/register/",u="/auth/login/",d="account-redirect";function h(e){var t=new URLSearchParams(window.location.search),n=t.get(l);if(null!==n)return{nextParam:n};var i=void 0!==e.room?e.room:!0===e.ignoreExistingRoom?void 0:t.get(a);return null!=i?{roomParam:i}:[c,u].includes(window.location.pathname)||CHATURBATE_URL_PREFIX===window.location.pathname&&""===window.location.search?{}:{nextParam:f()}}function f(){return"".concat(window.location.pathname).concat(window.location.search)}function p(e,t){var n=new URL(e,window.location.origin);return n.searchParams.delete(a),n.searchParams.delete(l),void 0!==t.nextParam?n.searchParams.set(l,t.nextParam):void 0!==t.roomParam&&n.searchParams.set(a,t.roomParam),"".concat(n.pathname).concat(n.search)}function m(){var e;r.kN.listen((function(t){e=t.dossier.room})),(0,i.Zf)(["mousedown","touchstart"],window.document,(function(t){var n=(0,s.zw)(t.target);if(void 0!==n&&n.hasAttribute(d)){var i={};new URL(n.href,window.location.origin).pathname===(0,o.BN)(c)&&(i={room:e});var r=h(i);n.href=(0,o.BN)(p(n.href,r))}}))}function v(e){e.setAttribute(d,"")}function g(e,t){void 0===t&&(t="".concat(window.location.pathname).concat(window.location.search));var n=e.querySelector("input[name=".concat(l,"]"));null!==n&&(n.value=t)}},7201:function(e,t,n){"use strict";n.d(t,{BX:function(){return P},F$:function(){return T},Mg:function(){return R},c8:function(){return w},rP:function(){return O}});var i,o=n(1185),r=n(2800),s=n(8626),a=n(1522),l=n(3753),c=n(391),u=n(4793),d=n(9447),h=n(9598),f=n(8071),p=n(3705),m=n(9545),v=n(1392),g=n(758),y=n(3543),b={partType:1,height:0,name:"",imgUrl:"",width:0,abuseUrl:""};function w(){u.kN.listen((function(e){i={showEmoticons:e.dossier.userChatSettings.showEmoticons,ignoredEmoticons:e.dossier.ignoredEmoticons}})),(void 0===r.J.current.loggedInUser?(i={showEmoticons:!0,ignoredEmoticons:[]},Promise.resolve()):new Promise((function(e,t){(0,l.Ue)("api/ts/chat/message-render-options/").then((function(t){var n,o;n=t.responseText,o=new c.j(n),i={showEmoticons:o.getBoolean("show_emoticons"),ignoredEmoticons:o.getStringList("ignored_emoticons")},e()})).catch((function(e){error(e),t(e)}))}))).finally((function(){g.gO.listen((function(e){void 0!==i&&(i.showEmoticons=e.showEmoticons)}))}))}var C="[cb:",x="%%%[",k="]%%%",S=/((^|\s)@\w+)/;function T(e){var t=document.createElement("span");return t.className="emoticonImage",P(e).forEach((function(e){switch(e.partType){case 2:case 0:var n=e.s;""!==n&&t.appendChild(E(n));break;case 1:""!==e.name?t.appendChild(A(e)):t.appendChild(E(""))}})),t}function I(e,t,n){var i=document.createElement("span");return i.className="emoticonImage",P(e.message,e.shortcodes).forEach((function(o){switch(o.partType){case 0:var s=o.s;""!==s&&i.appendChild(E(s));break;case 1:""!==o.name?i.appendChild(A(o)):i.appendChild(E(""));break;case 2:var c=o;void 0!==c.code?i.appendChild(function(e,t,n,i){var o,s,c,u=r.q.getState(),d=u.userName,v=u.room,g=u.hasFanClub;switch(e.code){case"fanclub":o=g?function(){}:function(){(0,a.Cj)(y.ag.noFanClub)},s=y.ag.shortcodeFanclubMessage(v),c=e.signupLink;break;case"supporter":o=function(){},s=y.ag.becomeSupporter,c="/supporter/upgrade/";break;case"follow":o=function(){(0,h.kr)(v,h.wk),(0,l.Ue)("follow/is_following/".concat(v,"/")).then((function(e){var t=JSON.parse(e.responseText).following,n=new f.e;!t&&r.J.current.isMobile&&n.showBrowserNotification()})).catch(m.$x)},s=y.ag.shortcodeFollowMessage(v),c=void 0;break;case"signup":o=function(){},s=y.ag.joinCB,c=e.signupLink;break;case"tip":o=function(){i.fire({message:e.msg,amount:e.amt})},s=void 0!==e.msg&&null!==e.msg?e.msg:"",c=void 0;break;default:return error("Unknown shortcode: ".concat(e.code)),document.createElement("div")}var b=n(s,c,o);b.title=e.s;var w="fromUser"in t&&void 0!==t.fromUser,C={shortcode:e.code,from_user:w?t.fromUser.username:"",room:v,user_clicked:d,tip:void 0!==e.amt&&"tip"===e.code?e.amt:0,message:t.message,from_notice:!w};return b.addEventListener("click",(function(){(0,p.fg)("ShortcodeLinkClicked",C)})),b}(c,e,t,n)):i.appendChild(E(""))}})),i}function R(e,t,n){var i=I(e,t,n);return i.dataset.testid="shortcodeMessage",i}function P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],i=[],o=e.indexOf(x)<0,r=e.indexOf(C)<0;if(o&&r)return[B(e)];for(var a=0;a<e.length;a+=1)if((0,s.vj)()&&a+C.length<e.length&&e.slice(a,a+C.length).toLowerCase()===C){var l=e.slice(a,e.length).match(v.uF.nonGlobalShortcodeRegex);if(null===l||0===l[0].length){n.push(e[a]);continue}var c=a+l[0].length;0!==n.length&&i.push(B(n.join(""))),n=[];var u=e.slice(a,c);i.push(L(u,t)),a+=u.length-1}else if("%"===e[a])if(e.slice(a,a+x.length)===x){var d=a+e.slice(a,e.length).indexOf(k);if(e.slice(d,d+k.length)===k){0!==n.length&&i.push(B(n.join(""))),n=[];var h=M(e.slice(a,d+k.length));i.push(h),a=d+k.length-1}}else n.push(e[a]);else n.push(e[a]);return 0!==n.length&&i.push(B(n.join(""))),i}function M(e){if(e.slice(x.length).startsWith("emoticon")){var t=function(e){var t=(e=e.replace("%%%[emoticon ","").replace("]%%%","")).split(/\|/);if(6===t.length){var n={partType:1,name:t[0],thumbUrl:t[1],width:U(t[2])?Number(t[2]):80,height:U(t[3])?Number(t[3]):80,imgUrl:t[4],abuseUrl:t[5]};return void 0!==n.thumbUrl&&D(n.thumbUrl)?n:void 0}if(5===t.length){var i={partType:1,name:t[0],imgUrl:t[1],width:U(t[2])?Number(t[2]):80,height:U(t[3])?Number(t[3]):80,abuseUrl:t[4]};return D(i.imgUrl)?i:void 0}}(e);return void 0!==t?t:(error("Cannot parse emoticon: ".concat(t)),b)}return B(e)}function A(e){if(function(e){return void 0===i?(error("messageRenderOptions accessed before being set"),!1):i.showEmoticons&&!i.ignoredEmoticons.includes(e.name)}(e)){var t=document.createElement("img");t.dataset.testid="emoticonImg";var n=e.thumbUrl;return t.src=void 0!==n?n:e.imgUrl,t.title=":".concat(e.name),t.style.cursor="pointer",t.onclick=function(){var t={slug:e.name,url:e.imgUrl};d.gi.fire(t)},r.J.current.isMobile&&(e.width=.5*e.width,e.height=.5*e.height),t.height=e.height,t.width=e.width,t.style.verticalAlign="top",t}var s=document.createElement("span");return s.dataset.testid="emoticonText",(0,o.vP)(s,o.ql.hrefColor),s.innerText=":".concat(e.name),s.style.cursor="pointer",s.onclick=function(){var t={slug:e.name,url:e.imgUrl};d.gi.fire(t)},s}function E(e){var t=document.createElement("span");return S.test(e)?e.split(S).forEach((function(e){var n=/^\s/.test(e);if("@"===e.trim().charAt(0)){var i=document.createElement("span");i.innerText=e.trimStart(),i.className="username-mention",n&&t.appendChild(document.createTextNode(" ")),t.appendChild(i)}else e.trim().length>0&&t.appendChild(document.createTextNode(e))})):t.innerText=e,t}function B(e){return{partType:0,s:e}}function L(e,t){var n,i,o,r,s,a,l,c,u,d=e.toLowerCase();if(v.uF.isValidTipShortcodeSyntax(d))u=t.find((function(e){if(void 0!==e.amt&&void 0!==e.msg){var t=e.amt.toString(),n=d.includes(t)||t===v.uF.getAmountWithoutSeparators(d);return"tip"===e.code&&d.includes(e.code)&&n&&d.includes(e.msg.toLowerCase())}return!1}));else{var h=v.uF.getCode(d);u=t.find((function(e){return e.code===h}))}return{partType:2,s:e,code:null!==(n=null===(i=u)||void 0===i?void 0:i.code)&&void 0!==n?n:void 0,amt:null!==(o=null===(r=u)||void 0===r?void 0:r.amt)&&void 0!==o?o:0,msg:null!==(s=null===(a=u)||void 0===a?void 0:a.msg)&&void 0!==s?s:"",signupLink:null!==(l=null===(c=u)||void 0===c?void 0:c.signupLink)&&void 0!==l?l:void 0}}function O(e,t,n,i){return function(e,t,n){var i=I(e,t,n);return i.dataset.testid="shortcodeNotice",i}({message:e.message||"",shortcodes:t},n,i)}function D(e){return null!==e.match(/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/g)||(error("Invalid emoticon URL"),!1)}function U(e){return!isNaN(parseInt(e,10))||(error("Invalid dimension argument"),!1)}},928:function(e,t,n){"use strict";n.d(t,{As:function(){return g},OV:function(){return w},P0:function(){return C},cT:function(){return u},iY:function(){return d},sF:function(){return h},ss:function(){return b},vZ:function(){return y}});var i,o=n(6698),r=n(1522),s=n(3753),a=n(391),l=n(9992);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function u(e){switch(e){case"all":return"all";case"none":return"none";default:return"smart"}}function d(e){switch(e){case"orga":return 0;case"orgb":default:return 1;case"org":return 2;case"none":return 3}}function h(e){var t=e;return["0","300","-1"].includes(t)?t:(error("roomDossier - invalid C2C notification limit"),"300")}function f(e){var t=[],n=e;if(""!==n)try{JSON.parse(n).forEach((function(e){t.push({app_name:e[0],app_location:e[1]})}))}catch(e){error("Error parsing apps ".concat(e.toString()))}return t}function p(e){var t=[];if(""!==e)try{t=JSON.parse(e).map((function(e){return{text:e.text,href:e.href}}))}catch(e){error("Error parsing anchors ".concat(e.toString()))}return t}function m(e){var t,n=[],i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;n.push({idOrName:o.id,messageHtml:o.message_html})}}catch(e){i.e(e)}finally{i.f()}return n}function v(e){if(void 0!==e)return{quality:e.getString("quality"),rate:e.getNumber("rate"),stopped:e.getBoolean("stopped")}}function g(e){var t=e.getMap("chat_settings"),n=e.getMap("satisfaction_score"),i={host:e.getString("wschat_host"),room:e.getString("broadcaster_username"),roomUid:e.getString("room_uid"),viewerUid:e.getStringOrUndefined("viewer_uid"),roomPassword:e.getString("room_pass"),chatRules:e.getString("chat_rules"),roomTitle:e.getString("room_title"),roomStatus:(0,l.wg)(e),isSupporter:e.getBoolean("is_supporter"),needsSupporterToPm:e.getBoolean("needs_supporter_to_pm"),roomGender:e.getString("broadcaster_gender"),userName:e.getString("viewer_username"),chatUserName:e.getString("chat_username"),edgeAuth:encodeURI(e.getString("edge_auth")),viewerPassword:e.getString("chat_password"),viewerGender:e.getString("viewer_gender"),exploringHashTag:e.getString("exploring_hashtag"),sourceName:(0,o.AY)(e.getString("source_name",!1)),hlsSource:e.getString("hls_source"),isWidescreen:e.getBoolean("is_widescreen"),appsRunning:f(e.getString("apps_running")),allowPrivateShow:e.getBoolean("allow_private_shows"),privatePrice:e.getNumber("private_show_price"),privateMinMinutes:e.getNumber("private_min_minutes"),allowShowRecordings:e.getBoolean("allow_show_recordings"),allowAnonymousTipping:e.getBoolean("allow_anonymous_tipping"),spyPrice:e.getNumber("spy_private_show_price"),privateShowId:e.getStringWithNumbers("private_show_id"),hasLowSatisfactionScore:e.getBoolean("low_satisfaction_score"),isAgeVerified:e.getBoolean("is_age_verified"),age:e.getNumberOrUndefined("age"),hiddenMessage:e.getString("hidden_message"),following:e.getBoolean("following"),followNotificationFrequency:e.getString("follow_notification_frequency",!1),isModerator:e.getBoolean("is_moderator"),broadcasterIsOnNewChat:e.getBoolean("broadcaster_on_new_chat"),tokenBalance:e.getNumber("token_balance"),serverName:e.getString("server_name"),numFollowed:e.getNumber("num_followed"),numFollowedOnline:e.getNumber("num_followed_online"),hasStudio:e.getBoolean("has_studio"),isMobile:e.getBoolean("is_mobile"),ignoredEmoticons:e.getObject("ignored_emoticons"),hideSatisfactionScore:e.getBoolean("hide_satisfaction_score"),tipsInPast24Hours:e.getNumber("tips_in_past_24_hours"),lastVoteInPast24Hours:e.getNumberOrUndefined("last_vote_in_past_24_hours"),lastVoteInPast90DaysDown:e.getBoolean("last_vote_in_past_90_days_down"),dismissibleMessages:m(e.getObject("dismissible_messages")),showMobileSiteBannerLink:e.getBoolean("show_mobile_site_banner_link"),numViewers:e.getNumber("num_viewers"),isInFanClub:e.getBoolean("fan_club_is_member"),hasFanClub:e.getBoolean("performer_has_fanclub"),paidTokensFanClub:e.getBoolean("fan_club_paid_with_tokens"),showMyCamWatchingList:[],satisfactionScore:{upVotes:n.getNumber("up_votes",!1),downVotes:n.getNumber("down_votes",!1),percent:n.getNumber("percent",!1)},tfaEnabled:e.getBoolean("tfa_enabled"),userChatSettings:{fontColor:t.getString("font_color"),fontFamily:t.getString("font_family"),fontSize:t.getString("font_size"),showEmoticons:t.getBoolean("show_emoticons"),emoticonAutocompleteDelay:t.getString("emoticon_autocomplete_delay"),highestTokenColor:t.getString("highest_token_color"),sortUsersKey:t.getString("sort_users_key"),modExpiration:t.getNumber("mod_expire"),roomEntryFor:d(t.getString("room_entry_for")),roomLeaveFor:d(t.getString("room_leave_for")),c2cNotificationLimit:h(t.getString("c2c_notify_limit")),silenceBroadcasters:t.getString("silence_broadcasters"),ignoredUsers:t.getString("ignored_users"),allowedChat:t.getString("allowed_chat"),viewerTipVolume:parseInt(t.getString("v_tip_vol")),broadcasterTipVolume:parseInt(t.getString("b_tip_vol"))},aspAuthUrl:e.getString("asp_auth_url"),browserId:e.getString("browser_id"),quality:v(e.getParsedSubMapOrUndefined("quality",!0)),edgeRegion:e.getString("edge_region")},r=e.getStringOrUndefined("staff_links");void 0!==r&&(i.staffInfo={staffLinks:p(r),autoLoadAdminInfo:e.getBoolean("auto_load_admin_info"),previousUsernames:e.getStringOrUndefined("previous_usernames"),deletionAdminNotice:e.getStringOrUndefined("deletion_admin_notice")});var s=e.getParsedSubMapOrUndefined("user_colors",!0);return void 0!==s&&(i.userColors=function(e){if(void 0!==e)return{hasTokens:e.getBoolean("has_tokens"),tippedRecently:e.getBoolean("tipped_recently"),tippedAlotRecently:e.getBoolean("tipped_alot_recently"),tippedTonsRecently:e.getBoolean("tipped_tons_recently")}}(s)),e.logUnusedDebugging("getRoomDossier"),i}function y(e,t){var n=new a.j(t);return new Promise((function(e,i){n.getNumber("status",!1)>=400?i("Bad response from server: ".concat(t)):e(g(n))}))}function b(e){return void 0!==i&&(i.abort(),i=void 0),new Promise((function(t,n){var o=(0,s.q0)("api/chatvideocontext/".concat(e,"/"));i=o[0],o[1].then((function(e){t(y(0,e.responseText))})).catch((function(e){if(404===e.xhr.status)return(0,r.Cj)("HTTP 404 - Page Not Found\n\nIt's probably just a broken link, or perhaps a cancelled broadcaster."),void e.xhr.abort();n(e)}))}))}function w(e,t){var n=!0;return"public"!==t.previousStatus&&"privaterequesting"===e.chatConnection.status&&"privaterequesting"===t.currentStatus&&(n=!1),n}function C(e,t){return b(e.chatConnection.room()).then((function(n){e.dossier=n,e.chatConnection.status=n.roomStatus,t.currentStatus=n.roomStatus}))}},4266:function(e,t,n){"use strict";n.d(t,{CU:function(){return f},hE:function(){return m}});var i=n(4649),o=n(2951),r=n(1976),s=n(8759),a=n(1612),l=n(7693),c=n(1794);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h,f=(0,s.G6)()&&!(0,s.s2)(),p=new c.xB("roomStartStreaming");f&&(h=new c.xB("safariPageShow",{listenersWarningThreshold:800}),(0,l.j9)("pageshow",window,(function(e){e.persisted&&void 0!==h&&h.fire()})));var m=function(){function e(t,n){var i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,o.Z)(this,e),this.roomName=t,this.img=n,this._streaming=!1,this._imgLoaded=!1,this.lastFrameTime=0,this.fadeOutStopTime=0,this.options=d(d({},{startStreaming:!1,loadInitialImage:!0,fadeOutTimeoutMs:2e3,streamingFadeoutTimeoutMs:0,useWideImages:!0}),r),this.STATIC_BASE_URL="".concat(a.w.jpegStreamUrl).concat(this.options.useWideImages?"riw":"ri","/").concat(this.roomName,".jpg"),this.ANIMATING_BASE_URL="".concat(a.w.jpegStreamUrl).concat(this.options.useWideImages?"minifwap":"minifap","/").concat(this.roomName,".jpg"),this.setStreamRate(),this.options.startStreaming?this.startStreaming():this.options.loadInitialImage&&this.loadImage(0).catch((function(e){warn("Error loading image",{imageSrc:e})})),void 0!==h&&h.addListener((function(){i.safariReloadImage()}),this.img)}return(0,r.Z)(e,[{key:"safariReloadImage",value:function(){this._imgLoaded||(this._stopAnimating(),this.loadImage(0).catch((function(e){warn("Error loading image",{imageSrc:e})})))}},{key:"_stopAnimating",value:function(){this.stopStreaming(),this.fadeOutStopTime=0}},{key:"getStreaming",value:function(){return this._streaming}},{key:"getFadingOut",value:function(){return!this._streaming&&(new Date).getTime()<=this.fadeOutStopTime}},{key:"getAnimating",value:function(){return this.getStreaming()||this.getFadingOut()}},{key:"setStreaming",value:function(e){var t=0===this.options.streamingFadeoutTimeoutMs;e?this.fadeOutStopTime=t?0:(new Date).getTime()+this.options.streamingFadeoutTimeoutMs:0===this.fadeOutStopTime&&(this.fadeOutStopTime=(new Date).getTime()+this.options.fadeOutTimeoutMs),this._streaming=t&&e}},{key:"setStreamRate",value:function(){var e=navigator.userAgent.match(/Puffin\/(\d)/);null!==e&&parseInt(e[1])<8?this.streamRate=1500:this.streamRate=140}},{key:"loadImage",value:function(e){var t,n=this;return 0===this.lastFrameTime&&(this.lastFrameTime=e),0===e||e-this.lastFrameTime>this.streamRate?(this.lastFrameTime=e,t=this.getAnimating()?"".concat(this.ANIMATING_BASE_URL,"?f=").concat(Math.random()):"".concat(this.STATIC_BASE_URL,"?").concat(Math.floor((new Date).getTime()/3e4)),new Promise((function(e,i){var o=new Image;o.onload=function(){n.img.onload=function(){n._imgLoaded=!0},n._imgLoaded=!1,n.img.src=o.src,e()},o.onerror=function(){i(t)},o.src=t}))):Promise.resolve()}},{key:"startStreaming",value:function(){var e=this;if(!(0,s.v8)()){p.fire(this.roomName);var t=this.getAnimating();this.setStreaming(!0),t||function t(n){e.getAnimating()&&e.loadImage(n).then((function(){requestAnimationFrame((function(e){t(e)}))})).catch((function(){t(0)}))}(0)}}},{key:"stopStreaming",value:function(){this.setStreaming(!1)}},{key:"stopAnimating",value:function(){this.setStreaming(!1),this.fadeOutStopTime=0}}]),e}()},9992:function(e,t,n){"use strict";function i(e){return o(e.getString("room_status"))}function o(e){switch(e){case"away":return"away";case"private":return"privatenotwatching";case"private_watching":return"privatewatching";case"private_spying":return"privatespying";case"private_requesting":return"privaterequesting";case"public":return"public";case"hidden":return"hidden";case"hidden_watching":return"hiddenwatching";case"offline":return"offline";case"password protected":return"passwordprotected";default:return error("unknown room status -- ".concat(e)),"unknown"}}function r(e){return["public","privaterequesting","privatewatching","privatespying","hiddenwatching"].includes(e)}n.d(t,{Zd:function(){return r},gN:function(){return o},wg:function(){return i}})},9584:function(e,t,n){"use strict";n.d(t,{w:function(){return g}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(4793),c=n(9),u=n(1794),d=n(1625),h=n(4043),f=n(3544),p=n(3543),m=n(9420);function v(e,t){var n=document.createElement("div");return n.innerText=e,n.style.color="#72C0FF",n.style.cursor="pointer",n.style.paddingTop="5px",n.onmouseenter=function(){n.style.textDecoration="underline"},n.onmouseleave=function(){n.style.textDecoration="none"},n.style.pointerEvents="auto",n.onclick=function(e){t(e)},n}var g=function(e){(0,r.Z)(g,e);var t,n,c=(t=g,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function g(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,i.Z)(this,g),(e=c.call(this)).positionFixed=t,e.moreRoomsLink=v(p.ag.moreRoomsText,(function(e){m.wy.fire(void 0),e.stopPropagation()})),e.showTextHandlers=new Map,e.joinShowLink=v("",(function(){})),e.shouldShowMoreRoomsLink=!0,e.hiddenMessage="",e.connectingStatusText=p.ag.connecting,e.isConnecting=!1,e.displayChanged=new u.xB("displayChanged"),e.element.style.display="none",e.element.style.position=e.positionFixed?"fixed":"absolute",e.element.style.height="auto",e.element.style.width="auto",e.element.style.boxSizing="border-box",e.element.style.padding="0 50px",e.element.style.left="0",e.element.style.textAlign="center",e.element.style.pointerEvents="none",e.element.style.zIndex="1",e.header=document.createElement("div"),e.header.style.fontSize="32px",e.header.style.lineHeight="32px",e.header.style.color="#72c0ff",e.header.style.marginBottom="20px",e.element.appendChild(e.header),e.body=document.createElement("div"),e.body.style.fontSize="16px",e.body.style.color="#ffffff",e.text=document.createElement("span"),e.body.appendChild(e.text),e.moreRoomsLink.style.display="none",e.body.appendChild(e.moreRoomsLink),e.joinShowLink.style.display="none",e.body.appendChild(e.joinShowLink),e.spyDisabledText=document.createElement("span"),e.spyDisabledText.innerText=p.ag.privateShowSpyDisabled,e.spyDisabledText.style.display="none",e.spyDisabledText.style.paddingTop="5px",e.body.appendChild(e.spyDisabledText),e.element.appendChild(e.body),e.showTextHandlers.set("away",(function(t){e.header.innerText=p.ag.performerIsAway,e.text.innerText=p.ag.roomAwayMessage,e.joinShowLink.style.display="none",e.spyDisabledText.style.display="none",e.updateMoreRoomsLinkDisplay(!0)})),e.showTextHandlers.set("privatenotwatching",(function(t){e.header.innerText=p.ag.privateShowInProgressText,e.text.innerText=p.ag.roomPrivateNotWatchingMessage,e.joinShowLink.innerText=p.ag.spyOnThisPrivateShowCAPS,e.joinShowLink.style.display=e.isSpyEnabled?"block":"none",e.spyDisabledText.style.display=e.isSpyEnabled?"none":"block",e.joinShowLink.onclick=function(){(0,f.Cd)(t)},e.updateMoreRoomsLinkDisplay(!0)})),e.showTextHandlers.set("hidden",(function(t){e.header.innerText=p.ag.camIsHidden,e.text.innerText=e.hiddenMessage,e.joinShowLink.style.display="none",e.spyDisabledText.style.display="none",e.updateMoreRoomsLinkDisplay(!1)})),e.showTextHandlers.set("offline",(function(t){e.header.innerText=p.ag.offline,e.text.innerText=p.ag.roomOfflineSubheader,e.joinShowLink.style.display="none",e.spyDisabledText.style.display="none",e.updateMoreRoomsLinkDisplay(!0)})),e.showTextHandlers.set("passwordprotected",(function(t){e.header.innerText=p.ag.passwordRequired,e.text.innerText=p.ag.roomPasswordProtectedMessage,e.joinShowLink.style.display="none",e.spyDisabledText.style.display="none",e.updateMoreRoomsLinkDisplay(!0),(0,d.rm)()&&(0,d.Qg)()}));var n=new u.mM;return l.kN.listen((function(t){e.currentChatConnection=t.chatConnection,e.isSpyEnabled=t.dossier.spyPrice>0,t.chatConnection.event.statusChange.listen((function(n){e.handleStatusChange(t.chatConnection,n.currentStatus)})).addTo(n),t.chatConnection.event.hiddenMessageChange.listen((function(t){e.hiddenMessage=t})).addTo(n),t.chatConnection.event.settingsUpdate.listen((function(t){e.isSpyEnabled=t.spyPrice>0&&t.allowPrivateShow,e.joinShowLink.style.display=e.isSpyEnabled?"block":"none",e.spyDisabledText.style.display=e.isSpyEnabled?"none":"block"})).addTo(n),h.Gf.listen((function(){e.handleStatusChange(t.chatConnection,t.dossier.roomStatus)})).addTo(n),e.hiddenMessage=t.dossier.hiddenMessage,e.handleStatusChange(t.chatConnection,t.dossier.roomStatus)})),l.QN.listen((function(){n.removeAll(),e.hiddenMessage="",e.videoOffline=!1})),e}return(0,o.Z)(g,[{key:"hide",value:function(){this.element.style.display="none",this.displayChanged.fire()}},{key:"show",value:function(){this.element.style.display="block",this.displayChanged.fire()}},{key:"setVideoOffline",value:function(e){this.videoOffline=e,void 0!==this.currentChatConnection&&this.handleStatusChange(this.currentChatConnection,this.currentChatConnection.status)}},{key:"displaysForStatus",value:function(e){return void 0!==this.showTextHandlers.get(e)}},{key:"repositionChildren",value:function(){if(void 0!==this.parent){var e=this.parent.element.getBoundingClientRect(),t=document.documentElement.clientWidth,n=document.documentElement.clientHeight;e.width<=t?(this.element.style.width="".concat(e.width,"px"),this.positionFixed&&(this.element.style.left="".concat(e.left,"px"))):(this.element.style.width="".concat(t,"px"),this.element.style.left="0"),e.height<=n?"fixed"===this.parent.element.style.position?this.element.style.top="".concat(e.top+.5*e.height-.5*this.element.offsetHeight,"px"):this.element.style.top="".concat(.5*e.height-.5*this.element.offsetHeight,"px"):this.element.style.top="".concat(.5*n-.5*this.element.offsetHeight,"px"),this.element.style.maxHeight="".concat(e.height,"px")}}},{key:"handleStatusChange",value:function(e,t){this.videoOffline&&(t="offline");var n=this.showTextHandlers.get(t);if(void 0!==n)return n(e),this.show(),void this.repositionChildrenRecursive();switch(this.isConnecting||(this.moreRoomsLink.style.display="none",this.hide()),t){case"public":case"privaterequesting":case"privatewatching":case"privatespying":case"notconnected":case"hiddenwatching":break;default:warn("unexpected status: ".concat(t))}}},{key:"updateMoreRoomsLinkDisplay",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.isConnecting&&!this.videoOffline;e&&!t&&this.shouldShowMoreRoomsLink?this.moreRoomsLink.style.display="block":this.moreRoomsLink.style.display="none"}},{key:"setShowMoreRoomsLink",value:function(e){this.shouldShowMoreRoomsLink=e,this.updateMoreRoomsLinkDisplay()}},{key:"showConnectingStatus",value:function(){this.header.innerText=this.connectingStatusText,this.text.innerText=p.ag.connectingToBroadcastMessage,this.show(),this.joinShowLink.style.display="none",this.spyDisabledText.style.display="none",this.moreRoomsLink.style.display="none",this.isConnecting=!0}},{key:"isConnectingStatusShowing",value:function(){return this.header.innerText===this.connectingStatusText}},{key:"hideConnectingStatus",value:function(){this.isConnecting&&(this.isConnectingStatusShowing()&&(this.header.innerText="",this.text.innerText="",this.hide()),this.isConnecting=!1)}}]),g}(c.w)},9482:function(e,t,n){"use strict";n.d(t,{Fg:function(){return c},Lj:function(){return a},Ow:function(){return l},c9:function(){return r},hY:function(){return u},kD:function(){return s}});var i=n(2800),o=n(3543);function r(e){return e.isBroadcaster?"broadcaster":e.isMod?"mod":e.inFanclub?"inFanclub":e.tippedTonsRecently?"tippedTonsRecently":e.tippedALotRecently?"tippedALotRecently":e.tippedRecently?"tippedRecently":e.hasTokens?"hasTokens":void 0!==e.recentlyEntered&&e.recentlyEntered?"recentlyEntered":"defaultUser"}function s(e){return e.isBroadcaster?"#ff6200":e.isMod?"#DC0000":e.inFanclub?"#00ff00":e.tippedTonsRecently?"#ad62e1":e.tippedALotRecently?"#d4a0ff":e.tippedRecently?"#8a98ff":e.hasTokens?"#84c6dc":void 0!==e.recentlyEntered&&e.recentlyEntered?"#e3e3e3":"#b3b3b3"}function a(e){return e.isBroadcaster?o.ag.isBroadcaster:e.isMod?o.ag.isMod:e.inFanclub?o.ag.inFanClub:e.tippedTonsRecently?o.ag.tippedTonsRecently:e.tippedALotRecently?o.ag.tippedALotRecently:e.tippedRecently?o.ag.tippedRecently:e.hasTokens?o.ag.hasTokens:void 0}function l(e){if(!e.isMod&&!e.isBroadcaster&&!e.inFanclub)return e.tippedTonsRecently?o.ag.tippedTonsRecentlyDef:e.tippedALotRecently?o.ag.tippedALotRecentlyDef:e.tippedRecently?o.ag.tippedRecentlyDef:e.hasTokens?o.ag.hasTokensDef:void 0}function c(e){e=e.toLowerCase();var t="".concat(STATIC_URL,"gendericons/");return["m","male"].indexOf(e)>-1?"".concat(t,"male.svg"):["f","female"].indexOf(e)>-1?"".concat(t,"female.svg"):["t","s","trans"].indexOf(e)>-1?"".concat(t,"trans.svg"):["c","couple"].indexOf(e)>-1?"".concat(t,"couple.svg"):(error("Could not set menu gender icon. Defaulting to male."),"".concat(t,"male.svg"))}function u(){var e;return(null===(e=i.J.current.loggedInUser)||void 0===e?void 0:e.username)===i.q.getState().room}},2239:function(e,t,n){"use strict";function i(e,t){e.style.webkitTransition=t,e.style.transition=t,void 0!==e.style.setProperty&&e.style.setProperty("moz-transition",t)}function o(e){e.style.webkitTransition="",e.style.transition="",void 0!==e.style.removeProperty&&e.style.removeProperty("moz-transition")}function r(e,t){e.style.userSelect=t,e.style.webkitUserSelect=t,e.style.msUserSelect=t,void 0!==e.style.setProperty&&e.style.setProperty("moz-user-select",t)}n.d(t,{QU:function(){return o},pS:function(){return i},ql:function(){return r}})},6608:function(e,t,n){"use strict";n.d(t,{Y:function(){return w},v:function(){return C}});var i=n(2951),o=n(1976),r=n(7169),s=n(7591),a=n(9492),l=n(7597),c=n(6272),u=n(1185),d=n(1522),h=n(3753),f=n(391),p=n(1090),m=n(4793),v=n(9),g=n(3705),y=n(9271),b=n(3543);var w=25,C=function(e){(0,s.Z)(C,e);var t,n,v=(t=C,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function C(){var e;return(0,i.Z)(this,C),(e=v.call(this)).innerDiv=document.createElement("div"),e.votesSection=document.createElement("div"),e.upContainer=document.createElement("div"),e.downContainer=document.createElement("div"),e.upVotes=document.createElement("span"),e.downVotes=document.createElement("span"),e.thumbsUp=document.createElement("img"),e.thumbsDown=document.createElement("img"),e.thumbsUpActive=document.createElement("img"),e.thumbsDownActive=document.createElement("img"),e.percent=document.createElement("span"),e.roomName="",e.tipsInPast24Hours=0,e.voteInLast90DaysDown=!1,e.voteUpdate=new y.I({hasVoted:!1,voteDirection:void 0},e.setVoteState.bind((0,r.Z)(e)),e.onVoteError.bind((0,r.Z)(e))),e.listeningForTipUpdates=!1,e.votesSection.style.display="inline-block",e.votesSection.style.verticalAlign="top",e.upContainer.style.display="inline-block",e.upContainer.style.cursor="pointer",e.upContainer.style.verticalAlign="top",e.upVotes.style.margin="0 3px",e.upVotes.style.verticalAlign="top",e.upContainer.appendChild(e.upVotes),e.createThumbsUp(),e.upContainer.appendChild(e.thumbsUp),e.upContainer.appendChild(e.thumbsUpActive),e.votesSection.appendChild(e.upContainer),e.percent.style.margin="0 3px",e.percent.style.verticalAlign="top",e.percent.onclick=function(){return(0,g.fg)("SatisfiedClicked")},e.votesSection.appendChild(e.percent),e.downContainer.style.display="inline-block",e.downContainer.style.cursor="pointer",e.downContainer.style.verticalAlign="top",e.createThumbsDown(),e.downContainer.appendChild(e.thumbsDown),e.downContainer.appendChild(e.thumbsDownActive),e.downVotes.style.margin="0 3px",e.downVotes.style.verticalAlign="top",e.downContainer.appendChild(e.downVotes),e.votesSection.appendChild(e.downContainer),e.innerDiv.appendChild(e.votesSection),e.element.appendChild(e.innerDiv),e.voteUpdate.setInitialState({hasVoted:!1,voteDirection:void 0}),m.kN.listen((function(t){e.chatConn=t.chatConnection,e.roomName=t.dossier.room,e.tipsInPast24Hours=t.dossier.tipsInPast24Hours,t.dossier.hideSatisfactionScore&&void 0===t.dossier.staffInfo?(e.upVotes.style.display="none",e.percent.style.display="none",e.downVotes.style.display="none"):(e.upVotes.innerText="".concat(t.dossier.satisfactionScore.upVotes),e.percent.innerText="".concat(t.dossier.satisfactionScore.percent,"%"),e.downVotes.innerText="".concat(t.dossier.satisfactionScore.downVotes),e.upVotes.style.display="inline",e.percent.style.display="inline",e.downVotes.style.display="inline",t.dossier.satisfactionScore.percent>85?(0,u.vP)(e.percent,"highPercent"):t.dossier.satisfactionScore.percent>65?(0,u.vP)(e.percent,"mediumPercent"):(0,u.vP)(e.percent,"lowPercent")),0===t.dossier.lastVoteInPast24Hours?e.voteUpdate.dispatch({hasVoted:!0,voteDirection:"down"},Promise.resolve(!0)):10===t.dossier.lastVoteInPast24Hours?e.voteUpdate.dispatch({hasVoted:!0,voteDirection:"up"},Promise.resolve(!0)):e.voteUpdate.dispatch({hasVoted:!1,voteDirection:void 0},Promise.resolve(!0)),e.voteInLast90DaysDown=t.dossier.lastVoteInPast90DaysDown,e.tipsInPast24Hours>=w?e.enableVoting():e.disableVoting(),e.listeningForTipUpdates||e.listenForTipUpdates()})),e}return(0,o.Z)(C,[{key:"onVoteError",value:function(){}},{key:"enableVoteMsg",value:function(){return b.ag.afterTipVoteSatisfactionText(this.roomName,w)}},{key:"styleThumb",value:function(e,t){e.src=t,e.height=15,e.width=15,e.style.height="15px",e.style.width="15px",e.style.verticalAlign="top",e.style.margin="0 3px",e.style.opacity="0.8"}},{key:"createThumbsUp",value:function(){var e=this;this.styleThumb(this.thumbsUp,"".concat(STATIC_URL,"thumbs-up-inactive.svg")),this.styleThumb(this.thumbsUpActive,"".concat(STATIC_URL,"thumbs-up-active.svg")),this.upContainer.onclick=function(t){if((0,g.fg)("SatisfiedClicked"),e.stopProp(t),e.tipsInPast24Hours>=w&&(!1===e.hasVoted||"down"===e.voteDirection)){e.triggerComment(!0);var n=(0,h.I5)("tipping/rate_model/".concat(e.roomName,"/"),{rating:"10"}).then((function(){return e.chatConn.event.roomNotice.fire({messages:[[(0,p.vK)(b.ag.votedUpText(e.roomName))]],showInPrivateMessage:!0}),!0})).catch((function(e){return error("Error rating model",e),!1}));e.voteUpdate.dispatch({hasVoted:!0,voteDirection:"up"},n)}else"up"===e.voteDirection&&e.triggerComment(!1)}}},{key:"createThumbsDown",value:function(){var e=this;this.styleThumb(this.thumbsDown,"".concat(STATIC_URL,"thumbs-down-inactive.svg")),this.styleThumb(this.thumbsDownActive,"".concat(STATIC_URL,"thumbs-down-active.svg")),this.downContainer.onclick=function(t){(0,g.fg)("SatisfiedClicked"),e.stopProp(t),e.tipsInPast24Hours>=w&&(!1===e.hasVoted||"up"===e.voteDirection)?(0,d.oB)(b.ag.sureVoteDownText(e.roomName),(function(){e.triggerComment(!0);var t=(0,h.I5)("tipping/rate_model/".concat(e.roomName,"/"),{rating:"0"}).then((function(){var t=b.ag.votedDownText(e.roomName);return e.voteInLast90DaysDown&&(t=b.ag.votedDownTextRepeat(e.roomName)),e.chatConn.event.roomNotice.fire({messages:[[(0,p.vK)(t)]],showInPrivateMessage:!0}),!0})).catch((function(e){return error("Error rating model",e),!1}));e.voteUpdate.dispatch({hasVoted:!0,voteDirection:"down"},t)})):"down"===e.voteDirection&&e.triggerComment(!1)}}},{key:"stopProp",value:function(e){e.stopPropagation()}},{key:"enableVoting",value:function(){this.thumbsUp.style.opacity="1",this.thumbsDown.style.opacity="1",this.thumbsUp.style.cursor="pointer",this.thumbsDown.style.cursor="pointer"}},{key:"disableVoting",value:function(){this.thumbsUp.style.opacity="0.65",this.thumbsDown.style.opacity="0.65",this.thumbsUp.style.cursor="",this.thumbsDown.style.cursor=""}},{key:"setUpvoted",value:function(){this.hasVoted=!0,this.voteDirection="up",this.thumbsDownActive.style.display="none",this.thumbsDown.style.display="",this.thumbsUpActive.style.display="",this.thumbsUp.style.display="none"}},{key:"setDownvoted",value:function(){this.hasVoted=!0,this.voteDirection="down",this.thumbsDownActive.style.display="",this.thumbsDown.style.display="none",this.thumbsUpActive.style.display="none",this.thumbsUp.style.display=""}},{key:"setNotvoted",value:function(){this.hasVoted=!1,this.voteDirection=void 0,this.thumbsDownActive.style.display="none",this.thumbsDown.style.display="",this.thumbsUpActive.style.display="none",this.thumbsUp.style.display=""}},{key:"setVoteState",value:function(e,t){void 0===e.voteDirection||!1===e.hasVoted?this.setNotvoted():"up"===e.voteDirection?this.setUpvoted():"down"===e.voteDirection&&this.setDownvoted()}},{key:"listenForTipUpdates",value:function(){var e=this;this.listeningForTipUpdates=!0,c.H2.listen((function(t){e.chatConn.room()===t.roomName&&(t.tokens>=w&&(e.enableVoting(),e.tipsInPast24Hours<w&&e.chatConn.event.roomNotice.fire({messages:[[(0,p.vK)(e.enableVoteMsg())]],showInPrivateMessage:!0})),e.tipsInPast24Hours=t.tokens)})),c.A3.listen((function(t){-1!==["privatewatching","privatespying"].indexOf(e.chatConn.status)&&(0,h.Ue)("tipping/tips_in_last_24/".concat(e.roomName,"/")).then((function(t){var n=new f.j(t.responseText).getNumber("tipped_performer_last_24hrs");c.H2.fire({tokens:n,roomName:e.chatConn.room()})})).catch((function(){}))}))}}]),C}(v.w)},5190:function(e,t,n){"use strict";n.d(t,{AF:function(){return M},EH:function(){return O},MP:function(){return R},s6:function(){return L}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(8759),c=n(7906),u=n(1185),d=n(7542),h=n(2765),f=n(7693),p=n(3753),m=n(391),v=n(4793),g=n(9),y=n(3682),b=n(3705),w=n(1809),C=n(3543),x=n(47),k=n(1289);function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,s.Z)(this,n)}}var T="feedback/sentiment/submit/",I="feedback/sentiment/smc/submit/",R="feedback/sentiment/broadcaster/submit/",P=10;function M(e){switch(e){case"0":return"smileyInTrouble";case"1":return"smileyUnhappy";case"2":return"smileyIndifferent";case"3":return"smileySmirk";case"4":return"smileyInLove"}}var A,E=new Map([[0,{forceParam:"force_sentiment",contextParam:"show_sentiment_survey",endpoint:T,delay:3e5}],[1,{forceParam:"force_smcSurvey",contextParam:"show_smc_sentiment_survey",endpoint:I,delay:3e5}],[2,{forceParam:"force_bcastSurvey",contextParam:"show_broadcaster_sentiment_survey",endpoint:R,delay:5e3}]]);function B(e,t,n){var i;switch(t){case 0:i=e?new U(n):new D(n);break;case 1:i=new D(n,!0);break;case 2:var o=E.get(t).endpoint;return(0,p.I5)(o,{}).catch((function(){})),void h.j.show()}document.body.appendChild(i.element),i.show()}function L(e,t){var n,i,o=null!==(n=null===(i=window.location.pathname.match(/\/([^\/]+)\/?$/))||void 0===i?void 0:i[1])&&void 0!==n?n:"",r=E.get(t),s=r.forceParam,a=r.contextParam,l=r.endpoint,c=r.delay,u=(0,k.dD)(window.location.search)[s];if("1"!==u){var d,h=["unknown","offline","notconnected","passwordprotected","hidden"];v.kN.listen((function(e){d=e.chatConnection}));var f=window.setTimeout((function(){if(void 0!==d&&(-1===h.indexOf(d.status)||2===t)){var n=d.room();"2"!==u?(0,p.Ue)(l).then((function(i){new m.j(i.responseText).getBoolean(a)&&B(e,t,n)})).catch((function(){})):B(e,t,n)}}),c);w.vV.once((function(){clearTimeout(f)}))}else B(e,t,o)}function O(){var e=E.get(2).forceParam;"1"===(0,k.dD)(window.location.search)[e]&&L(!1,2),c.c6.listen((function(e){e?A=Date.now():void 0!==A&&(Date.now()-A)/6e4>=P&&L(!1,2)}))}var D=function(e){(0,r.Z)(n,e);var t=S(n);function n(e,o){var r;return(0,i.Z)(this,n),(r=t.call(this)).room=e,r.isSMC=o,r.element=r.createWrapperElement({position:"fixed",width:"288px",bottom:"8px",right:"20px",borderRadius:"4px",overflow:"hidden",zIndex:1004},{borderRadius:"4px",borderStyle:"solid",borderWidth:"4px 1px 1px 1px",paddingLeft:"16px"},{position:"absolute",width:"14px",height:"14px",top:"14px",right:"14px",padding:"2px",cursor:"pointer",zIndex:1},{margin:"-4px -17px"},{position:"relative",width:"288px",height:"4px"}),r.survey=r.createSurvey(),w.vV.once((function(){r.close()})),!0===r.isSMC?(r.closedAction="FeedbackSMCSentimentClosed",r.popupAction="FeedbackSMCSentimentPopup",r.describedAction="FeedbackSMCSentimentDescribed",r.source="smc_sentiment_survey",r.submitEndpoint=I,r.cancelEndpoint="feedback/sentiment/smc/cancel/",r.initialDuration=25,r.confirmationDuration=15):(r.closedAction="FeedbackSentimentClosed",r.popupAction="FeedbackSentimentPopup",r.describedAction="FeedbackSentimentDescribed",r.source="sentiment_survey",r.submitEndpoint=T,r.cancelEndpoint="feedback/sentiment/cancel/",r.initialDuration=15,r.confirmationDuration=7),r}return(0,o.Z)(n,[{key:"createWrapperElement",value:function(e,t,n,i,o){var r=this;return(0,x.vz)("div",{style:e,colorClass:"cornerSurveyWrapper"},(0,x.vz)("div",{style:t,colorClass:"cornerSurveyContainer",ref:function(e){r.contentContainer=e}},(0,x.vz)("img",{style:n,src:"".concat(STATIC_URL,"popup_survey/close.svg"),onClick:function(){r.close(),(0,b.fg)(r.closedAction)}}),(0,x.vz)("div",{style:i,colorClass:"timerContainer",ref:function(e){r.timerParent=e}},(0,x.vz)("div",{style:o,colorClass:"timer",ref:function(e){r.timer=e}}))))}},{key:"show",value:function(){this.contentContainer.appendChild(this.survey),this.setTimer(this.initialDuration,!0),(0,b.fg)(this.popupAction)}},{key:"close",value:function(){this.contentContainer.contains(this.survey)&&(0,p.I5)(this.cancelEndpoint,{}).catch((function(e){})),null!==this.element.parentElement&&this.element.parentElement.removeChild(this.element)}},{key:"submit",value:function(e){this.selectedSentiment=e;var t={rating:e,room_user:this.room,url:window.location.href};(0,p.I5)(this.submitEndpoint,t).catch((function(){})),this.contentContainer.removeChild(this.survey),this.contentContainer.appendChild(this.createConfirmation()),this.setTimer(this.confirmationDuration,!1)}},{key:"createSurvey",value:function(){return this.createSurveyElement({position:"relative",paddingTop:"16px",fontSize:"14px",width:"245px"},{position:"relative",padding:"16px 0px 11px 0px"})}},{key:"createSurveyElement",value:function(e,t){return(0,x.vz)("div",{colorClass:"survey"},!0===this.isSMC?(0,x.vz)("div",{style:e,colorClass:"title"},C.ag.howIsSmcDoingToday):(0,x.vz)("div",{style:e,colorClass:"title"},C.ag.howIsChaturbateDoingToday),(0,x.vz)("div",{style:t},this.createEmoteDiv("0"),this.createEmoteDiv("1"),this.createEmoteDiv("2"),this.createEmoteDiv("3"),this.createEmoteDiv("4")))}},{key:"createEmoteDiv",value:function(e){return this.createEmoteDivElement({position:"relative",display:"inline-block",width:"40px",height:"40px",boxSizing:"border-box",marginRight:"8px",borderRadius:"4px",borderStyle:"solid",borderWidth:"1px",cursor:"pointer"},{position:"relative",width:"24px",height:"24px",top:"7px",left:"7px"},e)}},{key:"createEmoteDivElement",value:function(e,t,n){var i=this;return(0,x.vz)("div",{style:e,colorClass:"emoteContainer",onClick:function(){i.submit(n)}},(0,x.vz)("div",{style:t,colorClass:M(n)}))}},{key:"createConfirmation",value:function(){return this.createConfirmationElement({position:"relative",paddingTop:"16px",fontSize:"12px"},{display:"block",paddingBottom:"12px",fontSize:"12px"})}},{key:"createConfirmationElement",value:function(e,t){var n=this;return(0,x.vz)("div",{colorClass:"confirmation"},(0,x.vz)("div",{style:e,colorClass:"title"},C.ag.yourFeedbackHasBeenSent),(0,x.vz)("a",{href:"#",style:t,colorClass:"feedbackLink",onClick:function(){n.close(),d.F.fire({source:n.source,sentiment:n.selectedSentiment}),(0,b.fg)(n.describedAction)}},C.ag.describeYourIssues))}},{key:"setTimer",value:function(e,t){var n=this;this.timer.classList.remove("timerBar".concat(25,"s")),this.timer.classList.remove("timerBar".concat(15,"s")),this.timer.classList.remove("timerBar".concat(7,"s")),this.timer.classList.add("timerBar".concat(e,"s")),t?this.element.classList.add("pauseOnHover"):this.element.classList.remove("pauseOnHover"),this.timerParent.removeChild(this.timer),this.timer=this.timer.cloneNode(),this.timerParent.appendChild(this.timer),(0,l.w1)()||(0,l.bf)()?window.setTimeout((function(){n.close()}),1e3*e+200):(0,f.j9)("animationend",this.timer,(function(){window.setTimeout((function(){n.close()}),200)}))}}]),n}(g.w),U=function(e){(0,r.Z)(n,e);var t=S(n);function n(e){var o;(0,i.Z)(this,n),o=t.call(this,e);var r={position:"fixed",width:"100%",bottom:"0px",left:"0px",borderRadius:"8px 8px 0 0",overflow:"hidden",zIndex:1004,display:(0,y.gr)()?"block":"none"};return y.bs.listen((function(){(0,y.gr)()?o.showElement():o.hideElement()})),o.element=o.createWrapperElement(r,{borderRadius:"8px 8px 0 0",paddingLeft:"16px"},{position:"absolute",width:"14px",height:"14px",top:"14px",right:"14px",padding:"2px",cursor:"pointer",zIndex:1},{margin:"0 -17px"},{width:"100%",height:"4px"}),(0,u.vP)(o.element,"mobile"),o}return(0,o.Z)(n,[{key:"createSurvey",value:function(){return this.createSurveyElement({position:"relative",paddingTop:"16px",fontSize:"14px",width:"245px"},{position:"relative",padding:"16px 0px 11px 0px",display:"flex"})}},{key:"createEmoteDiv",value:function(e){var t=(Math.min(window.screen.width,window.screen.height)-32-16)/5,n={display:"flex",justifyContent:"center",alignItems:"center",width:"".concat(t,"px"),height:"".concat(t,"px"),boxSizing:"border-box",marginRight:"4px",borderRadius:"4px",borderStyle:"solid",borderWidth:"1px",cursor:"pointer"};return this.createEmoteDivElement(n,{width:"24px",height:"24px"},e)}},{key:"createConfirmation",value:function(){return this.contentContainer.removeChild(this.timerParent),this.createConfirmationElement({paddingTop:"16px",paddingBottom:"14px",fontSize:"12px"})}},{key:"createConfirmationElement",value:function(e){var t=this;return window.setTimeout((function(){t.close()}),7200),(0,x.vz)("div",{colorClass:"confirmation"},(0,x.vz)("div",{style:e,colorClass:"title"},C.ag.yourFeedbackHasBeenSent))}}]),n}(D)},8117:function(e,t,n){"use strict";n.d(t,{B:function(){return x},t:function(){return C}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597),c=n(8759),u=n(2800),d=n(7693),h=n(3753),f=n(391),p=n(3423),m=n(4793),v=n(5108),g=n(5406),y=n(2923);function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var C=function(e){(0,s.Z)(n,e);var t=w(n);function n(e){var o,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,i.Z)(this,n),(o=t.call(this,e)).config=e,o.isPM=r,o.cacheTTL=3e5,o.maxPrefixLength=100,o.filterAfterSize=1,o.maxOptionLength=50,o.element.dataset.testid="shortcodeAutocompleteModal",o.list.dataset.testid="shortcodeAutocompleteList",o.listenerGroup.add(m.kN.listen((function(e){o.room=e.dossier.room}))),o}return(0,o.Z)(n,[{key:"handleKeydown",value:function(e){var t=this;if(this.isPM)e.preventDefault(),e.stopPropagation();else if(this.visible){var n,i;38===e.keyCode&&(e.preventDefault(),this.scrollList(!0)),40===e.keyCode&&(e.preventDefault(),this.scrollList(!1));var o=null!==(n=null===(i=window.getSelection())||void 0===i?void 0:i.toString())&&void 0!==n?n:"",r=32===e.keyCode&&this.items.some((function(e){return e.slug.includes("".concat(t.prefix," "))}));(""===o||r?[39,13,9]:[39,13,32,9]).includes(e.keyCode)&&(e.preventDefault(),e.stopPropagation(),this.hide(),u.J.current.isMobile&&13===e.keyCode||this.config.inputElement.appendText(" ")),27!==e.keyCode&&37!==e.keyCode||(e.preventDefault(),this.hide(),this.deleteHighlightedSuffix()),32===e.keyCode&&o.includes(" ")&&(e.preventDefault(),e.stopPropagation(),this.hide(),this.config.inputElement.appendText(" "))}}},{key:"initData",value:function(){(0,r.Z)((0,l.Z)(n.prototype),"initData",this).call(this),this.regex=new RegExp(/(^|.*\s*)\[cb([:][\w\s\d="]*)$/i)}},{key:"initUI",value:function(){(0,r.Z)((0,l.Z)(n.prototype),"initUI",this).call(this),this.list.style.width=""}},{key:"getData",value:function(){return(0,h.Ue)(this.getDataEndpoint())}},{key:"getDataEndpoint",value:function(){return"chatmessages/shortcode_autocomplete/?slug=".concat(this.prefix)}},{key:"show",value:function(){(0,r.Z)((0,l.Z)(n.prototype),"show",this).call(this)}},{key:"getCache",value:function(){return void 0===this.cache&&(this.cache=new v.$(this.filterAfterSize,this.cacheTTL)),this.cache}},{key:"normalizedPrefix",value:function(){return this.prefix.toLowerCase()}},{key:"parseResponse",value:function(e){var t,n,i=new f.j(e),o=[],r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(null!==(t=i.getList("shortcodes"))&&void 0!==t?t:[]);try{for(r.s();!(n=r.n()).done;){var s,a=n.value.getString("slug");if(""!==a){var l=(null===(s=u.J.current.loggedInUser)||void 0===s?void 0:s.username)===this.room;a.startsWith(":tip ")&&!l||o.push({slug:a,element:k})}}}catch(e){r.e(e)}finally{r.f()}return i.logUnusedDebugging("parseShortcodegAutocompleteResponse"),o}},{key:"updateList",value:function(e){(0,r.Z)((0,l.Z)(n.prototype),"updateList",this).call(this,e),this.repositionChildren()}},{key:"isSpecialFunctionKey",value:function(e){return[40,37,39,38,13,27,9].includes(e.keyCode)}}]),n}(p.e),x=function(e){(0,s.Z)(n,e);var t=w(n);function n(e){var o,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,i.Z)(this,n),(o=t.call(this,{inputElement:e,leftOffset:0,rightOffset:0},r)).scrolling=!1,(0,d.j9)("touchstart",o.element,(function(){o.scrolling=!1,o.config.inputElement.setCurrentNodeText(o.config.inputElement.getCurrentNodeText())})),(0,c.Tt)()||(0,d.j9)("keydown",o.config.inputElement.element,(function(e){o.visible&&o.config.inputElement.setCaretToEndOfSelection()})),o.overlayClick.listen((function(){o.config.inputElement.focus(),o.config.inputElement.setCaretToEnd()})),o.listenerGroup.add(g.w.listen((function(e){o.hide()}))),o}return(0,o.Z)(n,[{key:"initUI",value:function(){var e=this;(0,r.Z)((0,l.Z)(n.prototype),"initUI",this).call(this),this.element.style.border="",this.element.style.fontSize="14px",this.element.style.lineHeight="26px",this.element.style.boxShadow="0px 0px 8px rgba(0, 0, 0, 0.32)",this.element.style.marginLeft="7px",this.element.style.boxSizing="content-box",this.list.style.width="",(0,y.q)(this.list,!0),this.list.onscroll=function(){e.scrolling=!0}}},{key:"repositionChildren",value:function(){}},{key:"appendItem",value:function(e,t){var i=this,o=(0,r.Z)((0,l.Z)(n.prototype),"appendItem",this).call(this,e,t);return o.ontouchend=function(e){i.scrolling||(i.pickItem(t,!1),e.preventDefault())},o}},{key:"show",value:function(){this.element.style.width="".concat(this.config.inputElement.element.offsetWidth,"px"),(0,r.Z)((0,l.Z)(n.prototype),"show",this).call(this)}}]),n}(C),k=document.createElement("div")},2717:function(e,t,n){"use strict";n.d(t,{i:function(){return f}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(1185),c=n(7693),u=n(8069),d=n(9),h=n(1794);var f=function(e){(0,r.Z)(f,e);var t,n,d=(t=f,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function f(e){var t;return(0,i.Z)(this,f),(t=d.call(this)).config=e,t.value=0,t.valueChanged=new h.xB("valueChanged"),t.valueChangeStart=new h.xB("valueChangeStart"),t.valueChangeEnd=new h.xB("valueChangeEnd"),(0,l.vP)(t.element,"slider"),t.element.style.position="relative",t.element.style.overflow="visible",t.element.style.cursor="pointer",void 0!==e.barWidth?t.element.style.width="".concat(e.barWidth+e.handleDiameter,"px"):t.element.style.width="90%",t.element.style.height="".concat(e.handleDiameter,"px"),t.barHeight=void 0!==e.barHeight?e.barHeight:2*Math.round(.25*e.handleDiameter/2),void 0!==e.barImage?(t.emptyBar=document.createElement("img"),t.emptyBar.src=e.barImage,t.emptyBar.style.width="100%",t.emptyBar.style.height="100%",t.element.appendChild(t.emptyBar)):(t.emptyBar=document.createElement("div"),t.emptyBar.style.position="absolute",t.emptyBar.style.boxSizing="border-box",void 0!==e.emptyBarColor?t.emptyBar.style.backgroundColor=e.emptyBarColor:(t.emptyBar.style.backgroundColor="#333333",t.emptyBar.style.backgroundColor="rgba(255, 255, 255, 0.2)"),t.emptyBar.style.top="".concat(.5*(e.handleDiameter-t.barHeight),"px"),t.emptyBar.style.height="".concat(t.barHeight,"px"),t.emptyBar.style.width="100%",t.element.appendChild(t.emptyBar)),void 0!==e.barImage?(t.filledBar=document.createElement("div"),t.filledBar.style.visibility="none"):(t.filledBar=document.createElement("div"),t.filledBar.style.position="absolute",t.filledBar.style.boxSizing="border-box",t.filledBar.style.backgroundColor=void 0!==e.filledBarColor?e.filledBarColor:"#ffffff",t.filledBar.style.top="".concat(.5*(e.handleDiameter-t.barHeight),"px"),t.filledBar.style.height="".concat(t.barHeight,"px"),t.element.appendChild(t.filledBar)),void 0!==e.handleImage?(t.handle=document.createElement("img"),t.handle.style.position="absolute",t.handle.style.top="0",t.handle.src=e.handleImage,t.handle.style.height="".concat(e.handleDiameter,"px"),t.handle.style.width="".concat(e.handleDiameter,"px"),t.handle.style.cursor="grab",t.handle.style.left="0px",t.element.appendChild(t.handle)):(t.handle=document.createElement("div"),t.handle.style.position="absolute",t.handle.style.top="0",t.handle.style.backgroundColor=void 0!==e.handleColor?e.handleColor:"#ffffff",t.handle.style.borderRadius="50%",t.handle.style.height="".concat(e.handleDiameter,"px"),t.handle.style.height="".concat(e.handleDiameter,"px"),t.handle.style.width="".concat(e.handleDiameter,"px"),t.handle.style.cursor="grab",t.element.appendChild(t.handle)),t.valueUpdater=new u.d((function(){t.valueChanged.fire(t.value)}),{bounceLimitMS:100,debounceType:2}),t.setupListeners((function(e){t.handleMoveEvent(e,e.clientX)}),"mousedown","mousemove","mouseup"),t.setupListeners((function(e){if(1===e.touches.length){var n=e.touches.item(0);null!==n&&t.handleMoveEvent(e,n.clientX)}}),"touchstart","touchmove","touchend"),(0,c.j9)("mousedown",t.element,(function(e){t.handleMoveEvent(e,e.clientX),t.handle.dispatchEvent(function(e,t){try{return new MouseEvent(e,t)}catch(i){var n=document.createEvent("MouseEvent");return n.initMouseEvent(e,void 0!==t.bubbles&&t.bubbles,void 0!==t.cancelable&&t.cancelable,window,0,void 0!==t.screenX?t.screenX:0,void 0!==t.screenY?t.screenY:0,void 0!==t.clientX?t.clientX:0,void 0!==t.clientY?t.clientY:0,void 0!==t.ctrlKey&&t.ctrlKey,void 0!==t.altKey&&t.altKey,void 0!==t.shiftKey&&t.shiftKey,void 0!==t.metaKey&&t.metaKey,void 0!==t.button?t.button:0,void 0!==t.relatedTarget?t.relatedTarget:null),n}}(e.type,e))})),t}return(0,o.Z)(f,[{key:"setupListeners",value:function(e,t,n,i){var o=this;(0,c.j9)(t,this.handle,(function(t){o.valueChangeStart.fire(o.value),o.handle.style.cursor="",document.body.style.cursor="grabbing",t.preventDefault(),t.stopPropagation(),(0,c.j9)(n,document,e,!0),(0,c.j9)(i,document,(function t(r){o.valueChangeEnd.fire(o.value),o.handle.style.cursor="grab",document.body.style.cursor="",r.preventDefault(),(0,c.SC)(n,document,e,!0),(0,c.SC)(i,document,t,!0)}),!0)}))}},{key:"handleMoveEvent",value:function(e,t){var n=this.element.getBoundingClientRect().left;if(void 0!==this.config.barWidth){var i=Math.max(.5*this.config.handleDiameter,Math.min(this.config.barWidth+.5*this.config.handleDiameter,t-n));this.setValue((i-.5*this.config.handleDiameter)*(100/this.config.barWidth))}else{var o=Math.max(.5*this.config.handleDiameter,Math.min(this.element.offsetWidth+.5*this.config.handleDiameter,t-n));this.setValue((o-.5*this.config.handleDiameter)*(100/this.element.offsetWidth))}this.valueUpdater.callFunc(),e.stopPropagation()}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(e){void 0!==this.config.barWidth?(this.handle.style.left="".concat(e*this.config.barWidth/100,"px"),this.filledBar.style.width="".concat(e*this.config.barWidth/100,"px")):(this.handle.style.left="calc(".concat(e,"% - ").concat(this.config.handleDiameter*e/100,"px)"),this.filledBar.style.width="".concat(e,"%")),this.value=e}},{key:"hideHandle",value:function(){this.handle.style.display="none"}},{key:"showHandle",value:function(){this.handle.style.display="block"}},{key:"handleResize",value:function(){void 0===this.config.barWidth&&(this.handle.style.left="calc(".concat(this.value,"% - ").concat(this.config.handleDiameter*this.value/100,"px)"),this.filledBar.style.width="".concat(this.value,"%"))}}]),f}(d.w)},1392:function(e,t,n){"use strict";n.d(t,{DO:function(){return v},uF:function(){return y}});var i=n(3940),o=n(7591),r=n(6983),s=n(2951),a=n(1976),l=n(6474),c=n(2800),u=n(8626),d=n(3543);function h(){h=function(e,t){return new n(e,void 0,t)};var e=RegExp.prototype,t=new WeakMap;function n(e,i,o){var s=new RegExp(e,i);return t.set(s,o||t.get(e)),(0,r.Z)(s,n.prototype)}function s(e,n){var i=t.get(n);return Object.keys(i).reduce((function(t,n){var o=i[n];if("number"==typeof o)t[n]=e[o];else{for(var r=0;void 0===e[o[r]]&&r+1<o.length;)r++;t[n]=e[o[r]]}return t}),Object.create(null))}return(0,o.Z)(n,RegExp),n.prototype.exec=function(t){var n=e.exec.call(this,t);if(n){n.groups=s(n,this);var i=n.indices;i&&(i.groups=s(i,this))}return n},n.prototype[Symbol.replace]=function(n,o){if("string"==typeof o){var r=t.get(this);return e[Symbol.replace].call(this,n,o.replace(/\$<([^>]+)>/g,(function(e,t){var n=r[t];return"$"+(Array.isArray(n)?n.join("$"):n)})))}if("function"==typeof o){var a=this;return e[Symbol.replace].call(this,n,(function(){var e=arguments;return"object"!=(0,i.Z)(e[e.length-1])&&(e=[].slice.call(e)).push(s(e,a)),o.apply(this,e)}))}return e[Symbol.replace].call(this,n,o)},h.apply(this,arguments)}function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var m={"/tip":function(e){var t={};if(e.length>0){var n=Number(e[0]);isNaN(n)?t.message=e.join(" "):(e.shift(),t.amount=n,e.length>0&&(t.message=e.join(" ")))}return{messageData:t,messageType:1}},"/debug":function(){return{messageType:2}}};function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("/"===e.trim().charAt(0)){var n=function(e){var t=e.match(/(\S+)/g);if(null!==t){var n=t.shift();if(Boolean(Object.prototype.hasOwnProperty.call(m,n)))return m[n](t)}return{messageType:0}}(e);if(0!==n.messageType)return n}else if((0,u.vj)()&&y.isShortcodeSyntax(e,t))return y.parseShortcodeMessage(e);return{messageType:0,messageData:e}}function g(e){var t=new RegExp(/^(\d{1,4})$/),n=new RegExp(/^(\d{1}[\.,]\d{3})$/),i=new RegExp(/^[\.,]\d{1,2}$/),o=t.test(e)||n.test(e);return!i.test(e)&&o}var y=function(){function e(){(0,s.Z)(this,e)}return(0,a.Z)(e,null,[{key:"getCode",value:function(t){var n=t.match(e.codeRegex);return null!==n?n[1]:""}},{key:"isShortcodeSyntax",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return!l.Ug.includes(t)&&null!==e.match(this.shortcodeRegex)}},{key:"isValidTipShortcodeSyntax",value:function(e){var t=new RegExp(/\[cb:tip amount=([\d,.]*) message=((".+")|(""|â€œâ€�)|(â€œ.+â€�))\]/i),n=new RegExp(/\[cb:tip message=((".+")|(""|â€œâ€�)|(â€œ.+â€�)) amount=([\d,.]*)\]/i);return t.test(e)||n.test(e)}},{key:"pullRoomMetadata",value:function(){var e=c.q.getState(),t=e.hasFanClub,n=e.room;return{hasFanClub:t,isBroadcaster:e.userName===n}}},{key:"isValidShortcodeMessage",value:function(t){var n,i=e.pullRoomMetadata(),o=i.hasFanClub,r=i.isBroadcaster,s=t.match(e.shortcodeRegex);return null!==(n=null==s?void 0:s.every((function(t){return e.isValidShortcode(t,r,o)})))&&void 0!==n&&n}},{key:"isValidShortcode",value:function(t,n,i){if(null===t.match(e.shortcodeStrictRegexA)&&null===t.match(e.shortcodeStrictRegexB))return!1;var o=t.match(e.shortcodeFamilyRegex);if(null===o)return!1;var r=o[0].toLowerCase();switch(r){case"tip":return e.isValidTipShortcode(t,n);case"fanclub":return/(\[cb:fanclub\])/i.test(t)&&i;case"follow":case"supporter":case"signup":case"help":return new RegExp("\\[cb:".concat(r,"\\]"),"i").test(t);default:return!1}}},{key:"isValidTipShortcode",value:function(t,n){var i=e.isValidTipShortcodeSyntax(t),o=t.match(e.amountRegex);if(null!==o&&i&&!g(o[0].split("=")[1]))return!1;var r=t.match(e.messageRegex);return(null===r||!i||!r[0].split("=")[1].match(e.urlRegex))&&(i&&n)}},{key:"getAmountWithoutSeparators",value:function(t){var n=t.match(e.amountRegex);if(null!==n){var i=n[0].split("=")[1];if(g(i))return i.replace(/\./gi,"").replace(/,/gi,"")}return""}},{key:"parseShortcodeMessage",value:function(t){var n=c.q.getState().hasFanClub,i=[];if(!e.isValidShortcodeMessage(t))return{messageType:3,shortcodes:[],message:t};var o=t.match(e.shortcodeRegex);if(null!==o){var r,s=f(o);try{for(s.s();!(r=s.n()).done;){var a=r.value,l=a.match(e.shortcodeFamilyRegex);if(null!==l)if(l[0].match(e.tipRegex)){var u=a.match(e.amountRegex),d=a.match(e.messageRegex),h="";if(d&&d.groups&&(h=d.groups.message),null!==u&&null!==d){var p=u[0].split("=")[1].replace(/\./gi,"").replace(/,/gi,"");i.push({code:l[0],amt:Number(p),msg:h})}}else l[0].match(/(fanclub)/gi)&&!n||i.push({code:l[0]})}}catch(e){s.e(e)}finally{s.f()}}return i.length>5?{messageType:3,shortcodes:[],message:t}:(t=t.replace(this.shortcodeNormalizeRegex,(function(e){return e.toLowerCase()})),{messageType:3,shortcodes:i,message:t.trim()})}},{key:"errorBehindShortcode",value:function(t){var n=e.pullRoomMetadata(),i=n.hasFanClub,o=n.isBroadcaster,r=t.match(e.shortcodeRegex);if(null!==r){var s,a=f(r);try{for(a.s();!(s=a.n()).done;){var l=s.value,c=null!==l.match(e.shortcodeStrictRegexA)||null!==l.match(e.shortcodeStrictRegexB);if(!i&&new RegExp(/\[cb:fanclub\]/i).test(t))return d.ag.noFanclub;if(e.tipRegex.test(l))return e.errorBehindTipShortcode(l,t,o);if(!c)return d.ag.shortcodeEnteredError(t);if(!new RegExp(e.shortcodeNormalizeRegex).test(l))return d.ag.shortcodeEnteredError(t)}}catch(e){a.e(e)}finally{a.f()}if(r.length>5)return d.ag.tooManyShortcodes}return d.ag.shortcodeEnteredError(t)}},{key:"errorBehindTipShortcode",value:function(t,n,i){var o=null!==t.match(e.shortcodeStrictRegexA)||null!==t.match(e.shortcodeStrictRegexB);if(e.isValidTipShortcodeSyntax(t)&&o){var r=t.match(e.amountRegex);if(null!==t.match(e.urlRegex))return d.ag.shortcodeURLNotAllowedInTip;if(null!==r){if(!g(r[0].split("=")[1]))return d.ag.inValidTipAmount;if(!i)return d.ag.tipNotBroadcaster}}else if(e.messageRegexSingleQuote.test(t))return d.ag.tipShortcodeMessageInDoubleQuotes;return d.ag.shortcodeEnteredError(n)}}]),e}();y.shortcodeRegex=/(\[cb:(?:[^\[\]"â€œâ€�]|(?:"|â€œ|'|â€˜|â€™|â€�)(?:[^"â€œâ€�]{0,80})(?:"|â€œ|'|â€˜|â€™|â€�)){0,100}\])/gi,y.nonGlobalShortcodeRegex=/(\[cb:(?:[^\[\]"â€œâ€�]|(?:"|â€œ|'|â€˜|â€™|â€�)(?:[^"â€œâ€�]{0,80})(?:"|â€œ|'|â€˜|â€™|â€�)){0,100}\])/i,y.shortcodeStrictRegexA=/\[cb:([a-z]+)((\s[a-z]+?=[\d,\.]*){0,1})((\s[a-z]+?=("|â€œ)([^â€œâ€�]*?)("|â€�))){0,1}\]/gi,y.shortcodeStrictRegexB=/\[cb:([a-z]+)((\s[a-z]+?=("|â€œ)([^â€œâ€�]*?)("|â€�))){0,1}((\s[a-z]+?=[\d,\.]*){0,1})\]/gi,y.shortcodeFamilyRegex=/(signup|follow|fanclub|supporter|tip|help)/i,y.shortcodeNormalizeRegex=/\[cb:(follow|signup|fanclub|supporter|help)\]/gi,y.tipRegex=/(tip)/i,y.amountRegex=/amount=([,.\d]*)/i,y.codeRegex=/\[cb:(.*?)\]/i,y.urlRegex=/\b(?:https?:\/\/)?(?:www\.)?[^\/\s]+\.[a-zA-Z]{2,}\b/gi,y.messageRegex=h(/(message=)("|\u201C)(.*)("|\u201D)/i,{message:3}),y.messageRegexSingleQuote=/(message=)(?:['|â€˜|â€™](?:.+)['|â€˜|â€™]|['|â€˜|â€™](?:.+)["|â€œ|â€�]|["|â€œ|â€�](?:.+)['|â€˜|â€™])/i},5937:function(e,t,n){"use strict";n.d(t,{JR:function(){return a},ZY:function(){return s},bA:function(){return r},j$:function(){return o}});var i=n(4801),o=function(){return(0,i.NZ)("PixSpace2")},r=function(){return(0,i.NZ)("TpgTb2")},s=function(){return(0,i.NZ)("AcnBrInpt2")},a=function(){return(0,i.NZ)("DfTpKbrd")}},8978:function(e,t,n){"use strict";function i(e){for(var t=e.toLowerCase().split(" "),n=0;n<t.length;n+=1)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1);return t.join(" ")}function o(e){for(var t=e.toLowerCase().split("_"),n=0;n<t.length;n+=1)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1);return t.join("_")}function r(e,t,n,i){return void 0===i&&void 0===n?null==e||""===e?null==t?"":t:e:r(r(r(e,t),r(n,i)),"")}n.d(t,{Qs:function(){return i},gB:function(){return r},t:function(){return o}})},9491:function(e,t,n){"use strict";n.d(t,{AN:function(){return a},WX:function(){return l},bo:function(){return r},pq:function(){return s},z2:function(){return o}});var i=n(47);function o(){return(0,i.vz)("div",{style:{display:"inline-block"},colorClass:["noteIconSvg"]},(0,i.vz)("svg",{style:{height:"1.2em",width:"1.2em"},viewBox:"0 0 12 12",xmlns:"https://www.w3.org/2000/svg"},(0,i.vz)("path",{d:"M5.5 2.00002H2C1.73478 2.00002 1.48043 2.10537 1.29289 2.29291C1.10536 2.48044 1 2.7348 1 3.00002V10C1 10.2652 1.10536 10.5196 1.29289 10.7071C1.48043 10.8947 1.73478 11 2 11H9C9.26522 11 9.51957 10.8947 9.70711 10.7071C9.89464 10.5196 10 10.2652 10 10V6.50002","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),(0,i.vz)("path",{d:"M9.25 1.24985C9.44891 1.05094 9.7187 0.939194 10 0.939194C10.2813 0.939194 10.5511 1.05094 10.75 1.24985C10.9489 1.44877 11.0607 1.71855 11.0607 1.99985C11.0607 2.28116 10.9489 2.55094 10.75 2.74985L6 7.49985L4 7.99985L4.5 5.99985L9.25 1.24985Z","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})))}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"16px";return(0,i.vz)("a",{className:"closeBtnContainer",style:{height:e,borderRadius:"5px",color:"inherit",display:"inline-block",cursor:"pointer"}},(0,i.vz)("svg",{style:{width:e,height:e},width:"12",height:"12",viewBox:"0 0 12 12"},(0,i.vz)("path",{d:"M7.15006 6.08867C7.13842 6.07705 7.12919 6.06326 7.12288 6.04807C7.11658 6.03289 7.11334 6.01661 7.11334 6.00017C7.11334 5.98372 7.11658 5.96744 7.12288 5.95226C7.12919 5.93707 7.13842 5.92328 7.15006 5.91167L11.7816 1.28067C11.9222 1.13984 12.0011 0.94891 12.001 0.749887C12.0008 0.550864 11.9216 0.360048 11.7808 0.219417C11.64 0.0787862 11.4491 -0.000140462 11.25 1.87661e-07C11.051 0.000140838 10.8602 0.0793373 10.7196 0.220167L6.08856 4.84917C6.07695 4.86081 6.06316 4.87004 6.04797 4.87634C6.03278 4.88265 6.0165 4.88589 6.00006 4.88589C5.98362 4.88589 5.96734 4.88265 5.95215 4.87634C5.93697 4.87004 5.92317 4.86081 5.91156 4.84917L1.28056 0.220167C1.21093 0.150501 1.12826 0.0952322 1.03726 0.0575166C0.946271 0.0198009 0.84874 0.000376944 0.75024 0.00035373C0.551311 0.000306846 0.360511 0.0792862 0.219814 0.219917C0.0791162 0.360548 4.6905e-05 0.551311 2.08617e-08 0.75024C-4.68632e-05 0.94917 0.0789325 1.13997 0.219564 1.28067L4.85006 5.91167C4.8617 5.92328 4.87094 5.93707 4.87724 5.95226C4.88354 5.96744 4.88679 5.98372 4.88679 6.00017C4.88679 6.01661 4.88354 6.03289 4.87724 6.04807C4.87094 6.06326 4.8617 6.07705 4.85006 6.08867L0.219564 10.7202C0.14993 10.7898 0.0947003 10.8725 0.0570276 10.9635C0.0193548 11.0546 -2.31938e-05 11.1521 2.08617e-08 11.2506C4.6905e-05 11.4495 0.0791162 11.6403 0.219814 11.7809C0.28948 11.8505 0.372179 11.9058 0.46319 11.9435C0.554201 11.9811 0.651741 12.0005 0.75024 12.0005C0.94917 12.0004 1.13993 11.9214 1.28056 11.7807L5.91156 7.14917C5.92317 7.13753 5.93697 7.12829 5.95215 7.12199C5.96734 7.11569 5.98362 7.11244 6.00006 7.11244C6.0165 7.11244 6.03278 7.11569 6.04797 7.12199C6.06316 7.12829 6.07695 7.13753 6.08856 7.14917L10.7196 11.7807C10.8602 11.9214 11.051 12.0004 11.2499 12.0005C11.4488 12.0005 11.6396 11.9215 11.7803 11.7809C11.921 11.6403 12.0001 11.4495 12.0001 11.2506C12.0002 11.0517 11.9212 10.8609 11.7806 10.7202L7.15006 6.08867Z"})))}function s(){return(0,i.vz)("div",{style:{display:"inline-block"}},(0,i.vz)("svg",{style:{height:"1em"},width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},(0,i.vz)("path",{d:"M3.482 7.91071C3.45013 7.89982 3.4223 7.87953 3.40219 7.85252C3.38208 7.8255 3.37062 7.79303 3.36933 7.75937C3.36827 7.72563 3.37736 7.69233 3.39542 7.66381C3.41349 7.63528 3.4397 7.61284 3.47067 7.59937C3.92472 7.40632 4.29812 7.06231 4.52765 6.62556C4.75718 6.18882 4.82875 5.68617 4.73025 5.20272C4.63174 4.71927 4.3692 4.2847 3.98708 3.97259C3.60495 3.66048 3.12672 3.48999 2.63333 3.48999C2.13995 3.48999 1.66171 3.66048 1.27959 3.97259C0.897467 4.2847 0.63493 4.71927 0.536421 5.20272C0.437912 5.68617 0.509482 6.18882 0.739017 6.62556C0.968551 7.06231 1.34195 7.40632 1.796 7.59937C1.82712 7.61253 1.85351 7.63484 1.87166 7.66334C1.88982 7.69184 1.89888 7.72518 1.89765 7.75895C1.89642 7.79271 1.88496 7.82531 1.86478 7.85241C1.8446 7.87952 1.81666 7.89985 1.78467 7.91071C1.26465 8.08858 0.813146 8.4244 0.4932 8.87127C0.173253 9.31815 0.000829249 9.85377 0 10.4034L0 12.3787C0 12.4661 0.0346975 12.5498 0.0964595 12.6116C0.158221 12.6733 0.241989 12.708 0.329333 12.708H0.916667C0.95808 12.7081 0.997978 12.7236 1.02847 12.7516C1.05896 12.7797 1.07783 12.8181 1.08133 12.8594L1.318 15.6987C1.32486 15.7809 1.36241 15.8576 1.42317 15.9134C1.48394 15.9692 1.56348 16.0002 1.646 16H3.62133C3.70374 16 3.78311 15.969 3.84374 15.9132C3.90436 15.8574 3.94181 15.7808 3.94867 15.6987L4.186 12.8594C4.18935 12.8182 4.20807 12.7797 4.23846 12.7517C4.26884 12.7237 4.30866 12.7081 4.35 12.708H4.938C4.98122 12.708 5.02401 12.6995 5.06393 12.683C5.10385 12.6664 5.14011 12.6421 5.17064 12.6115C5.20117 12.5809 5.22536 12.5446 5.24184 12.5047C5.25832 12.4647 5.26675 12.4219 5.26667 12.3787V10.4034C5.26604 9.85372 5.09369 9.31801 4.77372 8.8711C4.45374 8.42418 4.00213 8.08841 3.482 7.91071Z"}),(0,i.vz)("path",{d:"M14.2154 7.91071C14.1834 7.89985 14.1555 7.87952 14.1353 7.85241C14.1151 7.82531 14.1036 7.79271 14.1024 7.75895C14.1012 7.72518 14.1102 7.69184 14.1284 7.66334C14.1466 7.63484 14.1729 7.61253 14.2041 7.59937C14.6581 7.40632 15.0315 7.06231 15.261 6.62556C15.4906 6.18882 15.5622 5.68617 15.4636 5.20272C15.3651 4.71927 15.1026 4.2847 14.7205 3.97259C14.3384 3.66048 13.8601 3.48999 13.3667 3.48999C12.8733 3.48999 12.3951 3.66048 12.013 3.97259C11.6309 4.2847 11.3683 4.71927 11.2698 5.20272C11.1713 5.68617 11.2429 6.18882 11.4724 6.62556C11.7019 7.06231 12.0753 7.40632 12.5294 7.59937C12.5605 7.61259 12.5868 7.63496 12.6049 7.6635C12.623 7.69204 12.632 7.72541 12.6307 7.75918C12.6294 7.79295 12.6179 7.82553 12.5977 7.85259C12.5774 7.87965 12.5494 7.89992 12.5174 7.91071C11.9974 8.08861 11.546 8.42445 11.2262 8.87134C10.9064 9.31822 10.7341 9.85383 10.7334 10.4034V12.3787C10.7333 12.4219 10.7417 12.4647 10.7582 12.5047C10.7747 12.5446 10.7989 12.5809 10.8294 12.6115C10.86 12.6421 10.8962 12.6664 10.9361 12.683C10.9761 12.6995 11.0188 12.708 11.0621 12.708H11.6501C11.6914 12.7081 11.7312 12.7237 11.7616 12.7517C11.792 12.7797 11.8107 12.8182 11.8141 12.8594L12.0514 15.6987C12.0583 15.7808 12.0957 15.8574 12.1563 15.9132C12.217 15.969 12.2963 16 12.3787 16H14.3541C14.4366 16.0002 14.5161 15.9692 14.5769 15.9134C14.6377 15.8576 14.6752 15.7809 14.6821 15.6987L14.9187 12.8594C14.9222 12.8181 14.9411 12.7797 14.9716 12.7516C15.0021 12.7236 15.042 12.7081 15.0834 12.708H15.6707C15.7581 12.708 15.8418 12.6733 15.9036 12.6116C15.9654 12.5498 16.0001 12.4661 16.0001 12.3787V10.4034C15.9992 9.85377 15.8268 9.31815 15.5069 8.87127C15.1869 8.4244 14.7354 8.08858 14.2154 7.91071Z"}),(0,i.vz)("path",{d:"M8.78198 3.75737C8.75083 3.74636 8.72367 3.7263 8.70399 3.69976C8.68431 3.67323 8.67299 3.64142 8.67148 3.60842C8.66998 3.57541 8.67836 3.54271 8.69555 3.51449C8.71274 3.48628 8.73796 3.46384 8.76798 3.45004C9.14122 3.27559 9.4438 2.97908 9.62578 2.60945C9.80775 2.23983 9.85823 1.8192 9.76889 1.41701C9.67954 1.01482 9.4557 0.655134 9.13434 0.39733C8.81298 0.139525 8.4133 -0.000976562 8.00131 -0.000976562C7.58932 -0.000976562 7.18965 0.139525 6.86828 0.39733C6.54692 0.655134 6.32309 1.01482 6.23374 1.41701C6.14439 1.8192 6.19487 2.23983 6.37685 2.60945C6.55882 2.97908 6.86141 3.27559 7.23465 3.45004C7.26467 3.46384 7.28988 3.48628 7.30707 3.51449C7.32426 3.54271 7.33264 3.57541 7.33114 3.60842C7.32964 3.64142 7.31832 3.67323 7.29863 3.69976C7.27895 3.7263 7.2518 3.74636 7.22065 3.75737C6.7746 3.91826 6.38891 4.21259 6.116 4.60036C5.8431 4.98813 5.69621 5.45053 5.69531 5.9247V6.91337C5.69635 7.00039 5.73138 7.08356 5.79292 7.1451C5.85446 7.20663 5.93762 7.24166 6.02465 7.2427H6.57065C6.61112 7.24247 6.65024 7.25728 6.68042 7.28426C6.7106 7.31123 6.72968 7.34845 6.73398 7.3887L7.01398 9.91337C7.023 9.99387 7.06137 10.0682 7.12176 10.1222C7.18214 10.1762 7.26031 10.206 7.34131 10.206H8.65865C8.73958 10.206 8.81766 10.1762 8.87794 10.1222C8.93821 10.0682 8.97645 9.99381 8.98531 9.91337L9.26598 7.3887C9.27057 7.34846 9.28984 7.31131 9.32009 7.28438C9.35035 7.25744 9.38947 7.24261 9.42998 7.2427H9.97531C10.0627 7.2427 10.1464 7.208 10.2082 7.14624C10.2699 7.08448 10.3046 7.00071 10.3046 6.91337V5.92404C10.304 5.45025 10.1575 4.98815 9.8851 4.60051C9.61268 4.21287 9.22753 3.91849 8.78198 3.75737Z"})))}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return(0,i.vz)("div",{style:{display:"inline-block",paddingTop:"".concat(e,"px"),fill:"currentColor"}},(0,i.vz)("svg",{style:{height:"1.2em"},width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},(0,i.vz)("path",{d:"M14.9474 6.50932L14.1034 6.20998C13.9826 6.16702 13.8721 6.09916 13.7791 6.01078C13.6862 5.92241 13.6128 5.8155 13.5638 5.69697C13.5148 5.57845 13.4912 5.45094 13.4946 5.32272C13.498 5.19451 13.5282 5.06843 13.5834 4.95265L13.9674 4.14398C14.1075 3.84868 14.1528 3.51727 14.0971 3.19521C14.0414 2.87315 13.8874 2.57621 13.6563 2.3451C13.4252 2.11398 13.1283 1.96002 12.8062 1.90432C12.4842 1.84862 12.1528 1.89391 11.8574 2.03398L11.0488 2.41865C10.9329 2.47361 10.8069 2.50365 10.6787 2.50683C10.5505 2.51002 10.4231 2.48628 10.3046 2.43715C10.1862 2.38802 10.0794 2.31458 9.99111 2.2216C9.90283 2.12861 9.83504 2.01814 9.79211 1.89732L9.49211 1.05398C9.38235 0.746123 9.18003 0.479756 8.91292 0.291408C8.6458 0.103059 8.32696 0.00195313 8.00011 0.00195312C7.67327 0.00195312 7.35443 0.103059 7.08731 0.291408C6.82019 0.479756 6.61788 0.746123 6.50811 1.05398L6.20811 1.89798C6.16512 2.01875 6.09728 2.12915 6.00897 2.22206C5.92066 2.31498 5.81384 2.38834 5.69541 2.4374C5.57699 2.48647 5.44959 2.51015 5.32144 2.50692C5.19329 2.50369 5.06725 2.47362 4.95145 2.41865L4.14278 2.03398C3.84747 1.89391 3.51607 1.84862 3.19401 1.90432C2.87195 1.96002 2.575 2.11398 2.34389 2.3451C2.11278 2.57621 1.95882 2.87315 1.90312 3.19521C1.84742 3.51727 1.89271 3.84868 2.03278 4.14398L2.41678 4.95265C2.47188 5.06844 2.50207 5.19451 2.5054 5.3227C2.50873 5.45089 2.48513 5.57835 2.43613 5.69685C2.38712 5.81535 2.31379 5.92224 2.22089 6.01063C2.12799 6.09902 2.01757 6.16693 1.89678 6.20998L1.05278 6.50998C0.744848 6.61958 0.478381 6.8218 0.289952 7.08887C0.101523 7.35595 0.000366211 7.6748 0.000366211 8.00165C0.000366211 8.32851 0.101523 8.64735 0.289952 8.91443C0.478381 9.1815 0.744848 9.38372 1.05278 9.49332L1.89678 9.79332C2.01755 9.83629 2.12795 9.90414 2.22085 9.99246C2.31375 10.0808 2.38708 10.1876 2.43609 10.3061C2.4851 10.4245 2.50871 10.5519 2.50538 10.6801C2.50206 10.8082 2.47187 10.9342 2.41678 11.05L2.03278 11.8587C1.89271 12.154 1.84742 12.4854 1.90312 12.8074C1.95882 13.1295 2.11278 13.4264 2.34389 13.6575C2.575 13.8887 2.87195 14.0426 3.19401 14.0983C3.51607 14.154 3.84747 14.1087 4.14278 13.9687L4.95145 13.5847C5.06722 13.5295 5.19329 13.4992 5.3215 13.4959C5.44971 13.4926 5.57718 13.5162 5.69566 13.5653C5.81415 13.6144 5.92099 13.6878 6.00927 13.7809C6.09755 13.8739 6.1653 13.9844 6.20811 14.1053L6.50811 14.9487C6.61788 15.2565 6.82019 15.5229 7.08731 15.7112C7.35443 15.8996 7.67327 16.0007 8.00011 16.0007C8.32696 16.0007 8.6458 15.8996 8.91292 15.7112C9.18003 15.5229 9.38235 15.2565 9.49211 14.9487L9.79211 14.1047C9.83509 13.9839 9.90293 13.8735 9.99126 13.7806C10.0796 13.6877 10.1864 13.6144 10.3049 13.5653C10.4233 13.5163 10.5507 13.4927 10.6789 13.496C10.807 13.4994 10.933 13.5296 11.0488 13.5847L11.8574 13.9687C12.1528 14.1087 12.4842 14.154 12.8062 14.0983C13.1283 14.0426 13.4252 13.8887 13.6563 13.6575C13.8874 13.4264 14.0414 13.1295 14.0971 12.8074C14.1528 12.4854 14.1075 12.154 13.9674 11.8587L13.5834 11.05C13.5284 10.9342 13.4982 10.8082 13.4948 10.6801C13.4915 10.5519 13.5151 10.4245 13.5641 10.3061C13.6131 10.1876 13.6865 10.0808 13.7794 9.99246C13.8723 9.90414 13.9827 9.83629 14.1034 9.79332L14.9474 9.49265C15.2554 9.38305 15.5218 9.18084 15.7103 8.91376C15.8987 8.64669 15.9999 8.32784 15.9999 8.00098C15.9999 7.67413 15.8987 7.35528 15.7103 7.08821C15.5218 6.82113 15.2554 6.61892 14.9474 6.50932ZM8.00011 11.1907C7.37045 11.1815 6.75667 10.9917 6.2318 10.6437C5.70693 10.2958 5.29306 9.80438 5.03945 9.22798C4.71516 8.44275 4.71553 7.56095 5.04046 6.77598C5.3654 5.99102 5.98838 5.36695 6.77278 5.04065C7.55892 4.72626 8.43681 4.73154 9.21911 5.05537C10.0014 5.3792 10.6262 5.99594 10.9601 6.77398C11.2844 7.55922 11.284 8.44102 10.9591 9.22598C10.6342 10.011 10.0112 10.635 9.22678 10.9613C8.83799 11.1212 8.42042 11.1993 8.00011 11.1907Z"})))}function l(e,t){var n=(0,i.vz)("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,i.vz)("path",{d:"M9.41624 6.5001C8.36101 5.49058 6.91921 5.42139 6.31151 5.44408C6.2877 5.44511 6.26454 5.43559 6.2474 5.41774C6.23026 5.39989 6.22063 5.37525 6.22074 5.34955V4.37708C6.22037 4.2304 6.1414 4.09718 6.01813 4.0353C5.89485 3.97341 5.74953 3.99404 5.64528 4.08821L3.01893 6.49519C2.93812 6.56704 2.89133 6.67411 2.89136 6.78708C2.89077 6.89782 2.93585 7.00312 3.01437 7.07444L5.64739 9.58388C5.75212 9.677 5.89728 9.69652 6.02 9.63396C6.14272 9.57141 6.22092 9.43803 6.22074 9.29161V8.14408C6.22076 8.09924 6.25009 8.06064 6.29083 8.05182C6.95951 7.90058 9.14183 7.61398 10.2721 9.90072C10.3101 9.97676 10.3911 10.0153 10.4688 9.99434C10.5465 9.97338 10.6011 9.89827 10.6015 9.81187C10.6015 8.36716 10.2027 7.25328 9.41624 6.5001Z"}));return(0,i.vz)("div",{colorClass:e,style:t},n)}},6522:function(e,t,n){"use strict";n.d(t,{P_:function(){return ee},ZZ:function(){return Q},b9:function(){return q},co:function(){return $},eq:function(){return J},hf:function(){return V},jH:function(){return G},lt:function(){return Y},nK:function(){return X},xt:function(){return K}});var i=n(2951),o=n(1976),r=n(7169),s=n(3243),a=n(7591),l=n(9492),c=n(7597),u=n(8759),d=n(8213),h=n(1185),f=n(8642),p=n(1194),m=n(5712),v=n(822),g=n(8210),y=n(1962),b=n(7693),w=n(695),C=n(6626),x=n(1602),k=n(4793),S=n(2694),T=n(8069),I=n(9),R=n(8263),P=n(1910),M=n(1794),A=n(4801),E=n(9179),B=n(5726),L=n(3705),O=n(2239),D=n(8117),U=n(1392),Z=n(5937),F=n(3543),_=n(9420),N=n(10),j=n(758);function H(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var o=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var V=28,q=1e3,K=6,J=1024,G=4096;function Y(){var e=document.createElement("form");return(0,h.vP)(e,"chat-input-form"),e.style.display="inline-block",e.style.boxSizing="border-box",e.style.display="flex",e.style.alignItems="center",e}function $(){var e=document.createElement("div");return(0,h.vP)(e,"inputDiv"),e.style.height="".concat(V,"px"),e.style.boxSizing="border-box",e.style.margin="0 5px 5px 5px",e.style.position="relative",e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.fontSize="12px",e.style.display="grid",e.style.gridTemplateColumns="minmax(0, 1fr) auto",e.style.columnGap="".concat(K,"px"),e.style.padding="0 ".concat(K,"px"),(0,Z.j$)()?e.style.borderRadius="4px":e.style.borderRadius="4px 4px 0 0",e}function Q(e,t,n){var i=new S.t7(e,t);return(0,h.vP)(i.element,"chat-input-field"),(0,R.Zs)(i.element,{height:"".concat(V-2*K,"px"),fontFamily:"Helvetica, Arial, sans-serif",lineHeight:"15px"}),i.element.classList.add("inputFieldChatPlaceholder"),i.element.dataset.testid="chat-input",void 0!==n&&i.element.classList.add(n),i.element.setAttribute("data-placeholder",F.ag.sendAMessageDesktop),(0,b.Zf)(["focus","touchstart"],i.element,(function(){return(0,C.Ds)()})),(0,b.j9)("blur",i.element,C.v),i}var X=function(e){(0,a.Z)(n,e);var t=W(n);function n(e,o){var s,a,l;(0,i.Z)(this,n),(s=t.call(this)).outgoingHandlers=e,s.pmOtherUser=o,s.addMessageHTMLEvent=new M.xB("addMessageHtml",{reportIfNoListeners:!1}),s.removeMessagesForUserEvent=new M.xB("removeMessageHtml",{reportIfNoListeners:!1}),s.scrolledToBottom=new M.xB("scrolledToBottom"),s.messageList=((a=document.createElement("div")).className="msg-list-fvm",(0,h.vP)(a,"message-list"),a.style.width="100%",(0,O.ql)(a,"text"),a.style.cursor="text",a.style.paddingBottom="4px",a),s.noticeList=function(){var e=document.createElement("div");return e.style.width="100%",e.className="notice-list-fvm",(0,O.ql)(e,"text"),e.style.cursor="text",e}(),s.messageListWrapper=((l=document.createElement("div")).className="msg-list-wrapper-split",l.style.boxSizing="border-box",l.style.overflow="auto",l.style.margin="0 auto 0",l.style.width="100%",l.style.padding="5px",l.style.flex="1",l),s.messageCounter=0,s.listenerGroup=new M.mM,s.isPmChatContents=void 0!==s.pmOtherUser,s.toBottom=function(){s.scrollToBottom()},s.element.classList.add("ChatTabContents"),s.element.style.position="static",s.element.style.boxSizing="border-box",s.element.style.fontSize="12px",s.element.style.overflow="",s.element.style.display="flex",s.element.style.flexDirection="column",s.element.classList.add(s.isPmChatContents?"TheatermodeChatDivPm":"TheatermodeChatDivChat"),s.messageListWrapper.appendChild(s.noticeList),s.messageListWrapper.appendChild(s.messageList),s.isPmChatContents&&(s.pmControlBar=new f.mq(!1,o),s.element.appendChild(s.pmControlBar.element)),s.element.appendChild(s.messageListWrapper),s.buildChatInput();var c=!1,u=!1,d=new T.d((function(){c=!1}),{bounceLimitMS:50,debounceType:1});return(0,b.j9)("scroll",s.messageListWrapper,(function(){var e=s.messageListWrapper.scrollTop;s.isPmChatContents&&0===e&&s.isScrolledUp()&&_.ae.fire(),c||(c=!0,u=s.isScrolledUp()),d.callFunc(),!s.isScrolledUp()&&u&&(s.scrolledToBottom.fire(),u=!1)})),s.listenerGroup.add(x.y.listen((function(e){s.rulesModal=(0,g.vo)((0,r.Z)(s),e),void 0!==s.rulesModal&&s.addChild(s.rulesModal)}))),s.listenerGroup.add(k.kN.listen((function(e){s.currentRoomContext=e,s.element.style.fontSize=e.dossier.userChatSettings.fontSize,s.setLineHeight(),s.currentUser=e.chatConnection.username()}))),j.gO.listen((function(e){s.element.style.fontSize=e.fontSize,s.setLineHeight()})).addTo(s.listenerGroup),s.emoticonAutocompleteModal=new P.A({inputElement:s.customInputField,leftOffset:8,rightOffset:207}),s.inputDiv.appendChild(s.emoticonAutocompleteModal.element),s.emoticonAutocompleteModal.afterDOMConstructedIncludingChildren(),s.isPmChatContents||(s.userMentionModal=new v.W8({inputElement:s.customInputField,leftOffset:8,rightOffset:207}),s.inputDiv.appendChild(s.userMentionModal.element),s.userMentionModal.afterDOMConstructedIncludingChildren(),v.it.listen((function(){(0,E.Kx)(s.messageList,s.currentUser)})).addTo(s.listenerGroup)),s.emoticonAutocompleteModal.element.classList.add(s.isPmChatContents?"theatermodeEmoticonAutocompleteModalPm":"theatermodeEmoticonAutocompleteModalChat"),s}return(0,o.Z)(n,[{key:"buildChatInput",value:function(){var e=this,t=this.isPmChatContents?G:J;this.inputDiv=$(),this.inputForm=Y(),this.customInputField=Q((function(){return e.sendMessageFromInput()}),t,this.isPmChatContents?"theatermodeInputFieldPm":"theatermodeInputFieldChat"),this.buildButtonHolder(),this.inputForm.appendChild(this.customInputField.element),this.inputDiv.appendChild(this.inputForm),this.inputDiv.appendChild(this.buttonHolder.element),this.element.appendChild(this.inputDiv),this.addInputListeners()}},{key:"buildButtonHolder",value:function(){var e,t,n=this;this.buttonHolder=new y.b({columnGap:"".concat(K,"px")}),this.isPmChatContents&&d.$r&&(this.mediaDockButton=function(e){var t=document.createElement("span");t.style.cursor="pointer",t.style.height="1.2em",t.style.width="1.2em",t.dataset.paction="Chat",t.dataset.pactionName="UploadPhoto",t.dataset.testid="send-image-button",t.onclick=function(){n.onMediaDockButtonClick()};var i=document.createElement("img");return i.src="".concat(STATIC_URL,"mediaDock/uploadBackground.svg"),i.style.width="100%",i.style.height="100%",t.appendChild(i),t}(),this.buttonHolder.addButton(this.mediaDockButton)),this.emojiButton=(e=this.isPmChatContents,(t=document.createElement("span")).textContent="ğŸ˜�",t.style.cursor="pointer",t.style.fontSize="1em",t.style.lineHeight="1em",t.classList.add(e?"theatermodeEmojiButtonPm":"theatermodeEmojiButtonChat"),(0,u.IF)()||(twemoji.parse(t,{className:"emojiButton"}),t.style.fontSize="15px",t.style.lineHeight="15px"),t.dataset.paction="Chat",t.dataset.pactionName="EmojiClick",t.dataset.testid="emoji-button",t),this.buttonHolder.addButton(this.emojiButton);var i=document.createElement("span");new(p.d.get("SendButton"))({onClick:function(){n.customInputField.submit()},isPm:this.isPmChatContents,variant:"SplitMode"},i),this.buttonHolder.addButton(i)}},{key:"onMediaDockButtonClick",value:function(){if((0,L.fg)("PMPhotoButtonClicked"),!(0,w.Cg)()){var e;if(void 0!==this.rulesModal)return void this.rulesModal.show();null===(e=this.libraryMediaDock)||void 0===e||e.toggle(),this.scrollToBottom()}}},{key:"addInputListeners",value:function(){var e=this;(0,b.j9)("mousedown",this.inputDiv,(function(t){t.target!==e.inputDiv&&t.target!==e.inputForm||(e.customInputField.focus(),t.preventDefault())})),(0,b.j9)("click",this.emojiButton,(function(t){e.rulesModal?e.rulesModal.show():((0,C.Ds)(),_.He.fire(e.emojiButton))})),(0,b.j9)("submit",this.inputForm,(function(t){t.preventDefault(),e.customInputField.submit()}))}},{key:"setLineHeight",value:function(){this.messageListWrapper.style.lineHeight="".concat(Number(this.element.style.fontSize.slice(0,-2))+7,"pt")}},{key:"dispose",value:function(){var e,t,n,i;this.listenerGroup.removeAll(),this.emoticonAutocompleteModal.dispose(),null===(e=this.userMentionModal)||void 0===e||e.dispose(),null===(t=this.libraryMediaDock)||void 0===t||t.dispose(),null===(n=this.rulesModal)||void 0===n||n.dispose(),this.customInputField.dispose(),null===(i=this.pmControlBar)||void 0===i||i.dispose()}},{key:"shouldSendMessageFromInput",value:function(){var e,t=this;return(0,A.NZ)("InCntSUpV2")&&!this.isPmChatContents?(j.OI.fire({feature:"message",elem:this.inputDiv,getMessage:function(){return t.customInputField.getText()}}),!1):!((0,w.Cg)('You must be logged in to send a message. Click "OK" to login.')||this.emoticonAutocompleteModal.isVisible()||!0===(null===(e=this.userMentionModal)||void 0===e?void 0:e.isVisible())||this.rulesModal&&(this.rulesModal.show(),1))}},{key:"sendMessageFromInput",value:function(){if(!this.shouldSendMessageFromInput())return!1;var e=this.customInputField.getText(),t=void 0!==this.selectedMediaDock&&!this.selectedMediaDock.isEmpty();return this.scrollToBottom(),(""!==e.trim()||t)&&this.processMessage(e),this.recordUserAction(e),!0}},{key:"processMessage",value:function(e){var t=(0,U.DO)(e);switch(t.messageType){case 2:this.outgoingHandlers.onToggleDebugMode();break;case 1:this.customInputField.clearText();var n=t;this.outgoingHandlers.onTipRequest(n.messageData);break;default:this.outgoingHandlers.onChatMessage(e)}}},{key:"recordUserAction",value:function(e){var t=e.match(/@[a-zA-Z0-9_]+/gm),n=m.n.getInstance();if(null!==t){var i,o=H(t);try{for(o.s();!(i=o.n()).done;){var r=i.value;n.userInList(r.replace("@",""))&&(0,L.fg)("UserMentionMessage")}}catch(e){o.e(e)}finally{o.f()}}this.customInputField.blur()}},{key:"repositionChildren",value:function(){var e,t;null!==(e=null===(t=this.selectedMediaDock)||void 0===t?void 0:t.isShown())&&void 0!==e&&e?this.inputDiv.style.borderRadius="0":this.inputDiv.style.borderRadius=(0,Z.j$)()?"4px":"4px 4px 0 0",this.emoticonAutocompleteModal.element.style.bottom="".concat(this.inputDiv.offsetHeight-2,"px"),void 0!==this.userMentionModal&&(this.userMentionModal.element.style.bottom="".concat(this.inputDiv.offsetHeight-2,"px")),this.isScrolledUp()||this.scrollToBottom()}},{key:"initMediaDocks",value:function(e){this.libraryMediaDock=e,this.selectedMediaDock=e.sibling,this.addMediaDocksToDOM()}},{key:"addMediaDocksToDOM",value:function(){void 0!==this.libraryMediaDock&&this.addChild(this.libraryMediaDock),void 0!==this.selectedMediaDock&&((0,R.Zs)(this.selectedMediaDock,{margin:"0 5px"}),this.element.insertBefore(this.selectedMediaDock.element,this.inputDiv))}},{key:"isScrolledUp",value:function(){return this.messageListWrapper.scrollTop<=this.messageListWrapper.scrollHeight-(this.messageListWrapper.offsetHeight+20)}},{key:"scrollToBottom",value:function(){this.isScrolledUp()&&this.scrolledToBottom.fire(),this.messageListWrapper.scrollTop=this.messageListWrapper.scrollHeight-this.messageListWrapper.offsetHeight}},{key:"appendNoticeDiv",value:function(e){return this.noticeList.appendChild(e),e}},{key:"appendMessageDiv",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this.isScrolledUp();o||e.querySelectorAll("img").forEach((function(e){var n=e.src;e.src="",e.onload=t.toBottom,e.src=n}));var r=this.messageList.childElementCount-q;for(n?this.messageList.prepend(e):(0,B.ZA)(e,this.messageList);r>0;r-=1){var s=this.messageList.firstElementChild;null!==s&&this.messageList.removeChild(s)}return o||this.scrollToBottom(),this.addMessageHTMLEvent.fire({makeByCloning:function(){return e.cloneNode(!0)}}),i&&(this.messageCounter+=1),e}},{key:"showElement",value:function(){(0,s.Z)((0,c.Z)(n.prototype),"showElement",this).call(this,"flex")}},{key:"removeMessageDiv",value:function(e){this.messageList.removeChild(e)}},{key:"getLastMessageId",value:function(){return this.messageCounter}},{key:"messagesSinceId",value:function(e){return this.messageCounter-e}},{key:"getEarliestMessageId",value:function(){return this.earliestMessageId}},{key:"setEarliestMessageId",value:function(e){this.earliestMessageId=e}},{key:"handleRemoveMessages",value:function(e){var t,n=[],i=H(this.messageList.childNodes);try{for(i.s();!(t=i.n()).done;){var o=t.value;o.getAttribute("data-nick")===e&&n.push(o)}}catch(e){i.e(e)}finally{i.f()}for(var r=0,s=n;r<s.length;r++){var a=s[r];this.messageList.removeChild(a)}}},{key:"clear",value:function(){for(this.messageCounter=0;null!==this.messageList.firstChild;)this.messageList.removeChild(this.messageList.firstChild)}},{key:"focusCurrentChatInput",value:function(){this.customInputField.focus()}},{key:"blurCurrentChatInput",value:function(){this.customInputField.blur()}},{key:"removeMessagesForUser",value:function(e){this.removeMessagesForUserEvent.fire(e)}},{key:"isInputFocused",value:function(){return document.activeElement===this.customInputField.element}},{key:"getInputText",value:function(){return this.customInputField.getText()}},{key:"setInputText",value:function(e){this.customInputField.setText(e)}},{key:"appendInputText",value:function(e){this.customInputField.appendText(e)}}]),n}(I.w),ee=function(e){(0,a.Z)(n,e);var t=W(n);function n(e,o){var r;return(0,i.Z)(this,n),(r=t.call(this,e,o)).outgoingHandlers=e,r.pmOtherUser=o,r.shortcodeAutocompleteModal=new D.t({inputElement:r.customInputField,leftOffset:8,rightOffset:207},r.isPmChatContents),r.inputDiv.appendChild(r.shortcodeAutocompleteModal.element),r.shortcodeAutocompleteModal.afterDOMConstructedIncludingChildren(),r}return(0,o.Z)(n,[{key:"dispose",value:function(){this.shortcodeAutocompleteModal.dispose(),(0,s.Z)((0,c.Z)(n.prototype),"dispose",this).call(this)}},{key:"shouldSendMessageFromInput",value:function(){return!this.shortcodeAutocompleteModal.isVisible()&&(0,s.Z)((0,c.Z)(n.prototype),"shouldSendMessageFromInput",this).call(this)}},{key:"processMessage",value:function(e){var t=(0,U.DO)(e);switch(t.messageType){case 3:var i=t;if(this.isPmChatContents){this.appendMessageDiv((0,N.KS)(F.ag.shortcodeNotSupportedInPMs));break}if(0===i.shortcodes.length){var o=U.uF.errorBehindShortcode(e);this.appendMessageDiv((0,N.KS)(o));break}this.outgoingHandlers.onShortcode&&this.outgoingHandlers.onShortcode(i);break;default:return(0,s.Z)((0,c.Z)(n.prototype),"processMessage",this).call(this,e)}}},{key:"repositionChildren",value:function(){this.shortcodeAutocompleteModal.element.style.bottom="".concat(this.inputDiv.offsetHeight-2,"px"),(0,s.Z)((0,c.Z)(n.prototype),"repositionChildren",this).call(this)}}]),n}(X)},7184:function(e,t,n){"use strict";n.d(t,{l:function(){return f}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(7693),c=n(5042),u=n(1794),d=n(7108),h=n(2239);var f=function(e){(0,r.Z)(f,e);var t,n,d=(t=f,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function f(e,t,n){var o;return(0,i.Z)(this,f),(o=d.call(this)).onColorPicked=t,o.onColorHovered=n,o.hexInput=document.createElement("input"),o.pickerImgLoaded=!1,o.pickerImgLoadedEvent=new u.xB("pickerImgLoaded"),o.swatchElement=e,o.element.dataset.testid="color-picker-modal",o.element.style.visibility="hidden",o.element.style.width="auto",o.element.style.height="auto",o.element.style.opacity="0",(0,h.pS)(o.element,"opacity ".concat(250,"ms")),(0,l.j9)("keydown",o.element,(function(e){27===e.keyCode&&o.hide()})),o.overlayClick.listen((function(){o.hide()})),o.createColorCanvas(),o.createHexInput(),o}return(0,o.Z)(f,[{key:"createColorCanvas",value:function(){var e=this,t=document.createElement("canvas");t.style.cursor="crosshair",t.style.border="1px solid #000001",this.element.appendChild(t);var n,i=document.createElement("img");n=i,"".concat(STATIC_URL,"colorPicker.png?v=1").startsWith("/")||n.setAttribute("crossorigin","anonymous"),i.src="".concat(STATIC_URL,"colorPicker.png?v=1"),i.onload=function(){t.width=i.width,t.height=i.height,t.onclick=function(){e.initialColor=e.hexInput.value,e.colorPicked(e.hexInput.value),e.hide()},t.onmousemove=function(n){var i=t.getContext("2d");if(null!==i&&n.offsetX>0&&n.offsetY>0&&n.offsetX<t.clientWidth&&n.offsetY<t.clientHeight){var o=i.getImageData(n.offsetX,n.offsetY,1,1).data,r={red:o[0],green:o[1],blue:o[2]};e.hexInput.value="#".concat((0,c.rr)(r))}else e.hexInput.value=e.initialColor;e.onColorHovered(e.hexInput.value)},t.onmouseleave=function(){e.hexInput.value=e.initialColor,e.onColorHovered(e.hexInput.value)};var n=t.getContext("2d");null!==n&&n.drawImage(i,0,0,i.width,i.height),e.hexInput.style.width="".concat(t.width-8,"px"),e.pickerImgLoaded=!0,e.pickerImgLoadedEvent.fire(void 0)}}},{key:"createHexInput",value:function(){var e=this;this.hexInput.dataset.testid="color-hex-input",this.hexInput.type="text",this.hexInput.style.display="block",this.hexInput.style.border="1px solid #000000",this.hexInput.style.padding="2px 4px",this.hexInput.style.position="relative",this.hexInput.style.top="-3px",this.hexInput.style.fontSize="12px",this.hexInput.oninput=function(){e.onColorHovered(e.hexInput.value)},(0,l.j9)("keydown",this.hexInput,(function(t){13===t.keyCode&&(e.colorPicked(e.hexInput.value),e.hide())})),this.element.appendChild(this.hexInput)}},{key:"colorPicked",value:function(e){this.onColorPicked(e)}},{key:"repositionChildren",value:function(){this.element.style.left="".concat(this.swatchElement.offsetLeft,"px"),this.element.style.top="".concat(this.swatchElement.offsetTop+this.swatchElement.offsetHeight+2,"px")}},{key:"show",value:function(e){this.initialColor=e,this.pickerImgLoaded?this.styleForShow():this.pickerImgLoadedEvent.once(this.styleForShow.bind(this))}},{key:"styleForShow",value:function(){this.hexInput.value=this.initialColor,this.element.style.opacity="1",this.element.style.visibility="",this.showOverlay(),this.repositionChildrenRecursive()}},{key:"hide",value:function(){var e=this;this.hideOverlay(),this.element.style.opacity="0",window.setTimeout((function(){e.element.style.visibility="hidden"}),250)}}]),f}(d.B)},1301:function(e,t,n){"use strict";n.d(t,{VW:function(){return m},Xt:function(){return f},fK:function(){return p},rt:function(){return h}});var i=n(1976),o=n(2951),r=n(7591),s=n(9492),a=n(7597),l=n(1794),c=n(1289),u=n(6422);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var h="discover-join-overlay",f=function(e){(0,r.Z)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function c(){return(0,o.Z)(this,c),l.call(this,{onHide:function(){return m.fire(void 0)}})}return(0,i.Z)(c)}(u.be);function p(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(e.querySelectorAll("a:not(.nooverlay):not([href='#'])"));try{for(n.s();!(t=n.n()).done;){var i=t.value;null!==i.getAttribute("data-room-nav")&&void 0!==(0,c.dD)(window.location.search).join_overlay&&i.setAttribute(h,""),new u.dM(i)}}catch(e){n.e(e)}finally{n.f()}}var m=new l.xB("removeDiscoverJoinOverlayAnchors")},9187:function(e,t,n){"use strict";n.d(t,{h:function(){return g}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(1185),c=n(7693),u=n(4793),d=n(6767),h=n(9),f=n(5937),p=n(3543);function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var g=function(e){(0,r.Z)(v,e);var t,n,h=(t=v,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function v(){var e;return(0,i.Z)(this,v),(e=h.call(this)).messagesDisplaying=[],e.element.style.position="static",e.element.style.overflow="",u.kN.listen((function(t){var n,i=m(t.dossier.dismissibleMessages);try{for(i.s();!(n=i.n()).done;){var o=n.value;e.messagesDisplaying.indexOf(o.idOrName)<0&&"1"!==(0,d.ve)("dism_msg".concat(o.idOrName))&&(e.messagesDisplaying.push(o.idOrName),e.render(o))}}catch(e){i.e(e)}finally{i.f()}})),e}return(0,o.Z)(v,[{key:"render",value:function(e){var t=this,n=document.createElement("div");(0,l.vP)(n,"dismissibleMessage"),(0,l.vP)(n,l.ql.dismissibleMessageColor),n.innerHTML=e.messageHtml,n.style.fontSize="12px",n.style.padding="3px",(0,f.j$)()?(n.style.background="none",n.style.borderWidth="1px",n.style.borderTopStyle="solid",n.style.paddingLeft="15px"):(n.style.margin="5px 0",n.style.borderRadius="2px"),n.style.lineHeight="16px";var i=document.createElement("a");(0,l.vP)(i,l.ql.hrefColor),i.textContent=p.ag.dismissMessage,i.style.cursor="pointer";var o=document.createElement("span");o.textContent=" (";var r=document.createElement("span");r.textContent=")",n.appendChild(o),n.appendChild(i),n.appendChild(r),this.element.appendChild(n);var s,a=m(n.getElementsByTagName("a"));try{var u=function(){var e=s.value;(0,l.vP)(e,l.ql.hrefColor),e.onmouseenter=function(){e.style.textDecoration="underline"},e.onmouseleave=function(){e.style.textDecoration=""}};for(a.s();!(s=a.n()).done;)u()}catch(e){a.e(e)}finally{a.f()}(0,c.j9)("click",i,(function(){t.dismissMessage(n,e)}))}},{key:"dismissMessage",value:function(e,t){this.element.removeChild(e),this.messagesDisplaying.splice(this.messagesDisplaying.indexOf(t.idOrName),1),(0,d.C)("dism_msg".concat(t.idOrName),"1",60)}}]),v}(h.w)},3276:function(e,t,n){"use strict";n.d(t,{ZE:function(){return b},_l:function(){return w},od:function(){return C},pd:function(){return k},tn:function(){return x}});var i,o,r=n(8759),s=n(8210),a=n(6265),l=n(7693),c=n(695),u=n(2694),d=n(4801),h=n(3340),f=n(9846),p=n(534),m=n(9874),v=n(2974),g=n(758),y=!0;function b(e){y=e}function w(){return y}function C(){return void 0!==document.activeElement&&null!==document.activeElement&&["input","textarea"].includes(document.activeElement.tagName.toLowerCase())&&!(0,a.aS)()}function x(e){var t;return"Tab"===e.key&&Boolean(null===(t=e.target)||void 0===t?void 0:t.form)}function k(e,t){v.S.changeVideoMode.listen((function(e){i=void 0}));var n=new p.a,y=function(){return e.chatWindow.chatTabContainer.getCurrentTab().isInputFocused()||t.getCurrentTab().isInputFocused()},b=0;m.t.listen((function(e){e?b+=1:b-=1})),n.addHandler({keyCode:9,requiresCtrlOrMeta:!1,handle:function(n){if(!(!y()&&C()&&e.focusedWindow!==e.tipWindow||(0,a.aS)()||(0,s.oD)()||(0,a.aS)())){e.setFocusedWindow(e.chatWindow);var i=function(e){n.shiftKey?e.cycleToPrevWindow():e.cycleToNextWindow()};"split"===v.S.getVideoMode()?(i(e.chatWindow.chatTabContainer),i(t)):(i(t),i(e.chatWindow.chatTabContainer)),n.preventDefault(),n.stopPropagation()}}}),n.addHandler({keyCode:13,requiresCtrlOrMeta:!1,handle:function(t){if(y())return(0,d.NZ)("InCntSUpV2")||(0,c.Cg)()?void t.preventDefault():void((0,r.jI)().scrollTop===o&&void 0!==i&&((0,r.jI)().scrollTop=i,i=void 0));e.setFocusedWindow(e.chatWindow)}}),n.addHandler({keyCode:27,requiresCtrlOrMeta:!1,handle:function(n){(0,a.aS)()?((0,a.av)(),e.setFocusedWindow(void 0),i=void 0):(n.preventDefault(),void 0!==e.focusedWindow&&e.focusedWindow.closable&&e.removeChild(e.focusedWindow),e.setFocusedWindow(void 0),(0,r.jI)().scrollTop===o&&void 0!==i&&(t.getCurrentTab().blurCurrentChatInput(),(0,r.jI)().scrollTop=i,i=void 0))}}),n.addHandler({keyCode:76,requiresCtrlOrMeta:!0,handle:function(n){"split"!==v.S.getVideoMode()&&e.focusedWindow!==e.chatWindow||("split"!==v.S.getVideoMode()||t.pmTab.tabHasFocus())&&(n.stopPropagation(),n.preventDefault(),e.chatWindow.chatTabContainer.closeCurrentPMSession(),t.closeCurrentPMSession())}}),n.addHandler({keyCode:83,requiresCtrlOrMeta:!0,handle:function(t){t.stopPropagation(),t.preventDefault(),"split"===v.S.getVideoMode()||"hidden"===e.element.style.visibility?g.jE.fire({usedCtrlS:!0}):h.Fx.fire({usedCtrlS:!0})}});var k=[32,34,33];(0,l.j9)("keydown",document,(function(s){(function(e){return!w()||27!==e.keyCode&&!e.ctrlKey&&!e.metaKey&&(!!x(e)||!(!(0,a.aS)()&&-1===k.indexOf(e.keyCode)&&0===b)||!y()&&C())})(s)||void 0!==e.focusedWindow&&e.focusedWindow.handleKeyEvent(s)||n.execute(s)||s.ctrlKey||s.metaKey||!(0,f.r)(s.which)||(i=(0,r.jI)().scrollTop,"split"!==v.S.getVideoMode()&&e.setFocusedWindow(e.chatWindow),u.fl.fire(s),("split"===v.S.getVideoMode()?t:e.chatWindow.chatTabContainer).getCurrentTab().focusCurrentChatInput(),window.setTimeout((function(){o=(0,r.jI)().scrollTop}),0))}),!0)}},6422:function(e,t,n){"use strict";n.d(t,{Wk:function(){return M},be:function(){return k},dM:function(){return P},fd:function(){return A},ly:function(){return S},q2:function(){return T},wJ:function(){return x}});var i=n(4649),o=n(2951),r=n(1976),s=n(3243),a=n(7591),l=n(9492),c=n(7597),u=n(6265),d=n(7693),h=n(3753),f=n(1794),p=n(9874),m=n(3705),v=n(2578),g=n(3543),y=n(1289),b=n(2750);function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var x=new f.xB("showJoinOverlay"),k=function(e){(0,a.Z)(p,e);var t,n,f=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function p(e){var t;(0,o.Z)(this,p),t=f.call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({easyExit:!0},e)),t.element.style.display="none",t.element.style.position="absolute",t.element.style.width="560px",t.element.style.height="auto",t.element.style.backgroundColor="#ffffff",t.element.style.border="2px solid #cccccc",t.element.style.borderRadius="20px",t.element.style.padding="10px",t.element.style.top="45px",t.element.style.fontSize="12px",t.element.style.fontFamily="UbuntuRegular', Arial, Helvetica, sans-serif",t.overlay.style.background="",t.overlay.classList.add("blurred-login-overlay"),t.element.appendChild(t.createLoadingSpinner()),t.iframe=document.createElement("iframe"),t.iframe.id="join_iframe",t.iframe.frameBorder="0",t.iframe.marginWidth="0",t.iframe.scrolling="no",t.iframe.marginHeight="0",t.iframe.style.width="560px",t.iframe.style.height="650px",t.iframe.src="".concat("/accounts/register_iframe/","?next=").concat(encodeURIComponent(window.location.pathname)),t.element.appendChild(t.iframe);var n=document.createElement("hr");n.style.margin="15px 0 10px 0",n.style.border="0",n.style.color="#e4e4e4",n.style.backgroundColor="#e4e4e4",n.style.height="1px",t.element.appendChild(n);var r=document.createElement("span"),s=document.createElement("img");s.src="".concat(STATIC_URL,"arrow_back.gif"),s.style.marginRight="4px",s.style.verticalAlign="bottom",r.appendChild(s),t.registerLaterLink=document.createElement("a"),t.registerLaterLink.innerText=g.ag.registerLaterText,t.registerLaterLink.className="nooverlay",t.registerLaterLink.style.color="#0a5a83",t.registerLaterLink.style.position="relative",t.registerLaterLink.style.top="-1px",t.registerLaterLink.onmouseenter=function(){t.registerLaterLink.style.textDecoration="underline"},t.registerLaterLink.onmouseleave=function(){t.registerLaterLink.style.textDecoration="none"},r.appendChild(t.registerLaterLink),t.element.appendChild(r);var a=document.createElement("span");a.style.cssFloat="right";var l=document.createElement("img");l.src="".concat(STATIC_URL,"key.gif"),l.style.marginRight="4px",l.style.verticalAlign="bottom",a.appendChild(l);var c=document.createElement("span");c.innerText=g.ag.alreadyRegisteredText,c.style.color="#7f7f7f",c.style.position="relative",c.style.top="-1px",c.style.marginRight="2px",a.appendChild(c);var m=document.createElement("a");return m.href=(0,h.BN)(v.PU),m.innerText=g.ag.loginHereText,m.className="nooverlay",m.style.color="#0a5a83",m.style.position="relative",m.style.top="-1px",m.onmouseenter=function(){m.style.textDecoration="underline"},m.onmouseleave=function(){m.style.textDecoration="none"},a.appendChild(m),t.element.appendChild(a),t.overlayClick.listen((function(){t.hide(),document.body.style.overflow="",document.body.classList.remove("blurred-login-overlay-shown")})),u.Co.listen((function(){t.hide(),document.body.style.overflow="",document.body.classList.remove("blurred-login-overlay-shown")})),(0,d.j9)("focus",window,(function(){(0,h.Ue)("accounts/ajax_check_session_authenticated").then((function(e){JSON.parse(e.responseText).authenticated&&(t.hide(),I.fire(void 0))})).catch((function(){}))})),t}return(0,r.Z)(p,[{key:"initAndShow",value:function(e){var t=this;this.registerLaterLink.href=(0,h.BN)(e.initialHref),this.registerLaterLink.onclick=e.initialOnClick,(0,d.j9)("click",this.registerLaterLink,(function(){t.hide(),document.body.style.overflow="",S.fire(void 0)})),(0,s.Z)((0,c.Z)(p.prototype),"show",this).call(this),this.element.style.display="block",this.overlay.style.display="flex",this.overlay.style.alignItems="center",this.overlay.style.justifyContent="center",document.body.style.overflow="hidden",document.body.classList.add("blurred-login-overlay-shown"),this.overlay.appendChild(this.element),this.overlay.style.overflow="auto",this.iframe.onload=function(){var n=t.iframe.contentDocument;if(t.iframe.contentDocument&&(0,d.j9)("keydown",t.iframe.contentDocument.body,(function(e){"Escape"===e.key&&(t.hide(),document.body.style.overflow="")})),null!==n){var i=n.getElementById("husername");null!==i&&i.focus();var o=n.querySelector("a.next");o.href=(0,h.BN)(e.initialHref),o.onclick=e.initialOnClick,n.querySelectorAll("a.medium_popup_link").forEach((function(e){e.onclick=function(t){t.preventDefault(),(0,b.Pv)(e.href,"_blank",b.rq)}}))}},(0,m.fg)("RegisterIframe_Shown")}},{key:"createLoadingSpinner",value:function(){var e=document.createElement("div");return e.style.animationName="spin",e.style.position="absolute",e.style.top="50%",e.style.left="50%",e.style.width="30px",e.style.height="31px",e.style.margin="-15px 0 0 -15px",e.style.background='url("'.concat(STATIC_URL,'images/loading_spinner.svg")'),e.style.backgroundSize="cover",e.style.animationName="spin",e.style.webkitAnimationName="spin",e.style.animationDuration="2s",e.style.webkitAnimationDuration="2s",e.style.animationTimingFunction="linear",e.style.webkitAnimationTimingFunction="linear",e.style.animationIterationCount="infinite",e.style.webkitAnimationIterationCount="infinite",e.style.zIndex="-1",e}}]),p}(p.z),S=new f.xB("registerLaterLinkClicked"),T=new f.xB("commandeerJoinOverlayAnchors",{listenersWarningThreshold:-1,maxHistorySize:1}),I=new f.xB("restoreJoinOverlayAnchors",{listenersWarningThreshold:-1,maxHistorySize:1}),R=!1,P=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.createElement("a");if((0,o.Z)(this,e),this.anchor=n,void 0!==(0,y.dD)(window.location.search).join_overlay){var i=function(){R=!0,t.commandeer()};R?window.setTimeout((function(){t.commandeer()}),0):T.addListener(i,this.anchor),I.addListener((function e(){R=!1,t.restore(),T.removeListener(i),window.setTimeout((function(){I.removeListener(e)}),0)}),this.anchor)}}return(0,r.Z)(e,[{key:"commandeer",value:function(){var e=this;this.initialOnClick=this.anchor.onclick,this.initialHref=(0,h.BN)(this.anchor.href),this.anchor.href=(0,h.BN)(v.Ng),this.anchor.onclick=function(t){t.preventDefault(),x.fire(e),I.fire(void 0)}}},{key:"restore",value:function(){this.anchor.onclick=this.initialOnClick,this.anchor.href=(0,h.BN)(this.initialHref),this.initialOnClick=null}}]),e}();function M(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(e.querySelectorAll("a:not(.nooverlay):not([href='#'])"));try{for(n.s();!(t=n.n()).done;){var i=t.value;new P(i)}}catch(e){n.e(e)}finally{n.f()}}function A(){var e=document.getElementById("header");null!==e&&M(e);var t=document.getElementById("footer-holder");null!==t&&M(t);var n=document.getElementById("room_list");null!==n&&M(n);var i=document.getElementById("hashtag_ticker");null!==i&&M(i);var o=document.getElementsByClassName("sub-nav");0!==o.length&&M(o[0])}},10:function(e,t,n){"use strict";n.d(t,{Ht:function(){return B},J6:function(){return A},KS:function(){return D},PJ:function(){return N},d$:function(){return P},hk:function(){return M},mp:function(){return U},rL:function(){return _},x9:function(){return j}});var i,o=n(8759),r=n(8213),s=n(1185),a=n(7397),l=n(3871),c=n(2800),u=n(8626),d=n(3753),h=n(8157),f=n(4793),p=n(9179),m=n(2359),v=n(5726),g=n(4043),y=n(3705),b=n(3544),w=n(7201),C=n(1392),x=n(3543),k=n(3328),S=n(758);function T(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function R(e,t){return new k._(e,t)}function P(e,t){var n=Z(e.fromUser.username),i=(0,v.t)();i.style.padding="0";var r=R(e.fromUser,e);r.element.dataset.paction="Chat",r.element.dataset.pactionName="Username",r.element.style.paddingRight="4px",r.element.dataset.testid="chat-message-username",i.appendChild(r.element),i.style.marginRight="4px";var a=(0,w.F$)(e.message);return a.dataset.testid="chat-message-text",void 0!==e.textColor&&(a.style.color=e.textColor),void 0!==e.font&&(r.element.style.fontFamily=e.font,a.style.fontFamily=e.font),(0,s.vP)(a,"msg-text"),a.classList.add("split-mode"),void 0!==e.backgroundColor&&(i.style.background=e.backgroundColor),E(n,i,h.Av.parseMessage(e)),i.appendChild(a),n.appendChild(i),(0,o.w1)()?window.setTimeout((function(){twemoji.parse(n,{className:"emojiChat"})}),0):(0,o.IF)()||twemoji.parse(n,{className:"emojiChat"}),(0,p.Kx)(n,t),(0,v.yY)(e,n),n}function M(e){if(r.$r&&0!==e.mediaList.length){var t=new l.s({messageId:e.messageID,outgoing:e.fromUser.username!==e.otherUsername,mediaList:e.mediaList}),n=(0,v.t)(),i=Z(e.fromUser.username);return t.element.style.marginTop="6px",n.style.padding="0",n.style.marginRight="4px",n.appendChild(t.element),i.appendChild(n),i.setAttribute("type","photo"),i.dataset.testid="chat-image",(0,v.yY)(e,i),i}}function A(e,t){var n=Z(e.dataNick),r=document.createElement("div");return r.dataset.testid="room-notice",r.style.display="inline-block",void 0!==e.background&&(r.style.background=e.background,r.style.marginTop="1px",r.style.textShadow="none",r.style.padding="0px 1px",(0,s.vP)(r,"hasBg"),"#ff8b45"===e.background&&(r.style.padding="0px 4px",(0,s.vP)(r,"bright-background"))),"#ff3"===e.background&&(0,s.vP)(r,"isTip"),(0,s.vP)(r,"roomNotice"),void 0!==e.colorClass&&(0,s.vP)(r,e.colorClass),r.style.color=void 0!==e.foreground?e.foreground:"",r.style.fontWeight=void 0!==e.weight?e.weight:"normal",n.appendChild(function(e,t,n){var o,r,a,l,u=T(t);try{for(u.s();!(o=u.n()).done;){var h,f=o.value,p=document.createElement("div"),m=T(f);try{for(m.s();!(h=m.n()).done;){var v=h.value;switch(v.partType){case 1:p.appendChild(F(v,n));break;case 0:p.appendChild(R(v.user).element);break;case 2:p.appendChild((r=v.message,a=void 0,l=void 0,(l=document.createElement("a")).href=(0,d.BN)("/tag/".concat(r,"/").concat(null!==(a=c.q.getState().roomGender)&&void 0!==a?a:"")),(0,s.vP)(l,s.ql.camSubjectTagColor),l.style.textDecoration="none",l.innerText="#".concat(r),l));break;case 3:p.appendChild(O("spy private show",(function(){"privatespying"!==i.status&&(0,b.Cd)(i)})));break;case 4:p.appendChild(O("start private show",(function(){"privaterequesting"===i.status&&(0,b.uo)()})));break;default:error("Unknown roomNotice type for: ".concat(JSON.stringify(v)))}}}catch(e){m.e(e)}finally{m.f()}e.appendChild(p)}}catch(e){u.e(e)}finally{u.f()}return e}(r,e.messages,e.shortcodes)),(0,o.IF)()||twemoji.parse(r,{className:"emojiChat"}),E(n,r,h.Av.parseNotice(e)),(0,p.Kx)(n,t),(0,o.IF)()||twemoji.parse(n),void 0!==e.ts&&(n.dataset.ts=e.ts.toString()),n}function E(e,t,n){var i,o,r=void 0!==n.bgDark,s=void 0!==n.fgDark;return!(!r&&!s)&&(e.classList.add("dm-adjust"),r&&(t.setAttribute("dm-adjust-bg",n.bgDark),t.setAttribute("dm-init-bg",null!==(i=n.background)&&void 0!==i?i:"")),s&&(t.setAttribute("dm-adjust-fg",n.fgDark),t.setAttribute("dm-init-fg",null!==(o=n.foreground)&&void 0!==o?o:"")),!0)}function B(e){var t=Z(),n=(0,v.t)();n.classList.add("msg-text"),n.style.padding="0";var i=R(e.fromUser,e);i.element.dataset.paction="Chat",i.element.dataset.pactionName="Username",i.element.dataset.testid="chat-message-username",i.element.style.paddingRight="4px",n.appendChild(i.element),n.style.marginRight="4px";var o=(0,w.Mg)(e,L,S.jE);return o.dataset.testid="chat-message-text",void 0!==e.font&&(i.element.style.fontFamily=e.font,o.style.fontFamily=e.font),void 0!==e.backgroundColor&&(n.style.background=e.backgroundColor),E(t,n,h.Av.parseMessage(e)),n.appendChild(o),t.appendChild(n),(0,h.dV)(t,document.body.classList.contains("darkmode")),(0,v.yY)(e,t),t}function L(e,t,n){var i=O(e,n);return i.dataset.testid="shortcode-link",void 0!==t&&""!==t&&(i.href=(0,d.BN)(t),i.target="_blank"),i}function O(e,t){var n=document.createElement("a");return(0,s.vP)(n,"msg-link"),n.style.textDecoration="underline",n.innerText=e,n.onclick=t,n.style.cursor="pointer",n}function D(e){var t=Z();return t.innerText=e,t}function U(e,t){function n(e){var t=document.createElement("span");return t.innerText=e,t}var i=Z(),o=t?x.ag.pmSupporterNoticeAgeVerified:x.ag.pmSupporterNotice;i.appendChild(n(o)),i.appendChild(document.createElement("br")),i.appendChild(n("".concat(x.ag.pmSupporterSignUp," ")));var r=O(x.ag.pmSupporterMembership,(function(){}));return r.href=(0,d.BN)("/supporter/upgrade/?source=".concat(c.J.current.PurchaseEventSources.SUPPORTER_SOURCE_PM_UPSELL)),r.target="_blank",r.dataset.testid="supporter-upsell-link",(0,s.vP)(r,"msg-link"),r.onclick=function(){(0,y.fg)("SupporterPageOpened",{source:"chat"})},i.appendChild(r),i.appendChild(n(" ".concat(x.ag.pmSupporterSendPm(e),"."))),i}function Z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("div");return t.dataset.testid="chat-message",t.classList.add("msg-text"),t.style.fontFamily="Tahoma,Arial,Helvetica,sans-serif",t.style.boxSizing="border-box",t.style.paddingTop="2px",t.style.paddingBottom="3px",t.style.paddingLeft="5px",t.style.paddingRight="5px",t.style.overflowWrap="break-word",t.style.wordWrap="break-word",t.style.wordBreak="break-word",e.length>0&&t.setAttribute("data-nick",e),t}function F(e,t){return(0,u.vj)()&&void 0!==e.message&&t&&C.uF.isShortcodeSyntax(e.message)?(0,w.rP)(e,t,L,S.jE):function(e){var t=document.createElement("span");return!1!==e.parseEmoticon?t=(0,w.F$)(e.message):t.innerText=e.message,t.style.color=void 0!==e.foreground?e.foreground:"",t.style.backgroundColor=void 0!==e.background?e.background:"",t.style.fontWeight=void 0!==e.weight?e.weight:"",t}(e)}function _(e){var t=Z();return e.renderTo(t)}function N(e,t){var n=Z();return n.innerText=e,n.appendChild(t),m.p.setMessageColorData(n,(0,v.Q0)("#aaaaaa")),n.classList.add("roomNotice"),n}function j(e,t){var n=Z(t);n.textContent="".concat(e," ");var i=document.createElement("span");return(0,s.vP)(i,s.ql.hrefColor),i.textContent=x.ag.sendDirectMessageNew,i.style.cursor="pointer",i.onclick=function(){g.ah.fire(!0),a.nh.fire(t)},n.appendChild(i),n}f.kN.listen((function(e){i=e.chatConnection}))},1809:function(e,t,n){"use strict";n.d(t,{U_:function(){return f},cr:function(){return d},hp:function(){return m},nv:function(){return u},pU:function(){return h},vV:function(){return a},zw:function(){return p}});var i=n(8759),o=n(7693),r=n(1794),s=n(3340),a=new r.xB("navigationRequest"),l=[],c=!0;function u(e){c=e}function d(e){Promise.all(l.map((function(e){return e()}))).then((function(){a.fire(e)})).catch((function(){}))}function h(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,o.j9)("click",e,(function(e){if(!f(e)){var n=p(e.target);if(void 0!==n){if(n.hasAttribute("data-floatingnav")&&c)return e.preventDefault(),void d(n.href);if(n.hasAttribute("data-room"))return e.preventDefault(),void Promise.all(l.map((function(e){return e()}))).then((function(){s.WP.fire(n.getAttribute("data-room"))})).catch((function(){}));t&&(n.target="_top")}}}))}function f(e){return e.metaKey||e.ctrlKey||e.shiftKey||e.defaultPrevented||(0,i.w1)()||(0,i.bf)()}function p(e){for(var t=e;null!==t&&"a"!==t.tagName.toLowerCase();)t=t.parentElement;if(null!==t){var n=t,i=n.getAttribute("href");if("#"!==i&&""!==i)return n}}function m(e){l.push(e)}},9429:function(e,t,n){"use strict";n.d(t,{G9:function(){return k},Ox:function(){return T},ur:function(){return S}});var i=n(5809),o=n(2951),r=n(1976),s=n(7591),a=n(9492),l=n(7597),c=n(8759),u=n(1185),d=n(7693),h=n(2425),f=n(9),p=n(1794),m=n(4801),v=n(1282),g=n(3607),y=n(3705),b=n(2833),w=n(5937),C=n(2974);var x="defaultVideoWidth",k=h.vA?548:502,S=300,T=function(e){(0,s.Z)(p,e);var t,n,f=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function p(e){var t;return(0,o.Z)(this,p),(t=f.call(this)).roomContents=e,t.state={videoWidth:k,videoHeight:S,chatWidth:t.minChatWidth()},t.isDragging=!1,t.smallerWidthChosen=!1,t.resizeHistory=[],t.lastChosenVideoWidth=k,t.element.style.position="",t.element.style.display="inline-block",t.element.style.width="".concat(8,"px"),(0,w.j$)()&&(t.element.style.height="100%",t.element.style.background="transparent",t.element.style.zIndex="1",t.element.style.marginLeft="-4px",t.element.style.marginRight="-4px"),t.element.style.boxSizing="border-box",(0,d.j9)("mousedown",t.element,(function(n){n.preventDefault(),t.roomContents.element.onmousemove=function(n){var i=n.pageX-e.videoPanel.element.getBoundingClientRect().left-t.element.offsetWidth/2;t.handleResize(i),t.lastChosenVideoWidth=i,t.roomContents.repositionChildrenRecursive()},t.roomContents.element.onmouseup=function(){t.handleResizeFinished()},t.roomContents.element.onmouseleave=function(){t.handleResizeFinished()},t.isDragging=!0})),(0,d.j9)("touchmove",t.element,(function(n){n.preventDefault(),1===n.targetTouches.length&&(t.roomContents.element.ontouchmove=function(){var i=n.targetTouches.item(0);if(null!==i){var o=i.pageX-e.videoPanel.element.getBoundingClientRect().left-t.element.offsetWidth/2;t.handleResize(o),t.lastChosenVideoWidth=o,t.roomContents.repositionChildrenRecursive()}},t.roomContents.element.ontouchend=function(){t.handleResizeFinished()},t.isDragging=!0)})),window.setTimeout((function(){t.element.style.cursor=t.getCursor(),(0,u.vP)(t.element,"resizeHandle"),t.loadSettings(),t.handleResize(),t.handleResizeFinished()}),0),C.S.changeVideoMode.listen((function(){"split"===C.S.getVideoMode()&&(t.loadSettings(),t.handleResize())})),t}return(0,r.Z)(p,[{key:"setDefaultVideoSize",value:function(){var e=this.roomContents.element.getBoundingClientRect().top+this.roomContents.videoPanel.nonVideoElementHeight()+120,t=(0,g.mP)()-e;this.state={videoWidth:this.getWidthFromHeight(t),videoHeight:t,chatWidth:this.getChatWidthFromVideoWidth(this.getWidthFromHeight(t))}}},{key:"getChatWidthFromVideoWidth",value:function(e){return this.roomContents.element.clientWidth-e-((0,w.j$)()?0:2*this.roomContents.roomContentsPadding+8)}},{key:"handleResizeSplitModeBasedOnChat",value:function(e){0!==this.element.offsetWidth&&(e=Math.min(e,this.getChatWidthFromVideoWidth(k)),e=Math.max(e,this.minChatWidth()),this.isDragging||this.smallerWidthChosen||(e=Math.max(e,this.roomContents.element.clientWidth/4)),e<this.roomContents.element.clientWidth/4?this.smallerWidthChosen=!0:this.smallerWidthChosen=!1,this.roomContents.element.style.setProperty("--chat-width","".concat(e,"px")),e>this.minChatWidth()?this.roomContents.videoPanel.element.style.minWidth="".concat(k,"px"):this.roomContents.videoPanel.element.style.minWidth="270px",this.roomContents.chatTabContainer.element.style.minWidth="".concat(this.minChatWidth(),"px"),h.vA||this.roomContents.videoPanel.updateAppPanel(),p.splitModeDragResize.fire(),this.state.chatWidth=e)}},{key:"handleResizeSplitMode",value:function(e){0!==this.element.offsetWidth&&(this.roomContents.videoPanel.element.style.width="".concat(e,"px"),h.vA||this.roomContents.videoPanel.updateAppPanel(),p.splitModeDragResize.fire())}},{key:"handleResize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.lastChosenVideoWidth,t=Math.max(e,k+2);t=Math.min(this.getMaxVideoWidth(),t);var n=C.S.getVideoMode();switch(n){case"split":(0,v.L)("GrowVideoResize")?e===this.lastChosenVideoWidth?(this.handleResizeSplitModeBasedOnChat(this.state.chatWidth),t=this.roomContents.videoPanel.element.offsetWidth):this.handleResizeSplitModeBasedOnChat(this.getChatWidthFromVideoWidth(t)):this.handleResizeSplitMode(t);break;case"theater":this.roomContents.videoPanel.element.style.width="".concat(this.roomContents.element.clientWidth-2*this.roomContents.roomContentsPadding,"px");break;case"fullscreen":this.roomContents.videoPanel.element.style.width="".concat(window.innerWidth,"px");break;case"videoonly":case"noninteractive-fullscreen":break;default:error("Unexpected VideoMode: ".concat(n))}if(this.state.videoWidth=t,"split"===n){var i=this.getCursor();this.element.style.cursor=i,this.roomContents.element.style.cursor=i}}},{key:"recordResizeHistory",value:function(){var e=parseInt(this.roomContents.chatTabContainer.element.style.width),t=parseInt(this.roomContents.chatTabContainer.element.style.height),n=this.resizeHistory[this.resizeHistory.length-1],i={videoMode:C.S.getVideoMode(),videoWidth:this.state.videoWidth,videoHeight:this.state.videoHeight,chatWidth:e,chatHeight:t};(void 0===n||n.videoWidth!==i.videoWidth||n.videoHeight!==i.videoHeight||n.videoMode!==i.videoMode)&&this.resizeHistory.push(i)}},{key:"handleResizeFinished",value:function(){if(this.recordResizeHistory(),2===this.resizeHistory.length){var e=(0,i.Z)(this.resizeHistory,2),t=e[0],n=e[1],o={video_width_old:t.videoWidth,video_height_old:t.videoHeight,video_width_new:n.videoWidth,video_height_new:n.videoHeight,chat_width_old:t.chatWidth,chat_height_old:t.chatHeight,chat_width_new:n.chatWidth,chat_height_new:n.chatHeight};(0,y.fg)("VideoResized",o),this.resizeHistory=this.resizeHistory.slice(1)}if("split"===C.S.getVideoMode()){if(0===this.element.offsetWidth)return;this.saveSettings(),this.roomContents.element.onmousemove=function(){},this.roomContents.element.onmouseup=function(){},this.roomContents.element.onmouseleave=function(){},this.roomContents.element.ontouchend=function(){},this.roomContents.element.ontouchmove=function(){},this.roomContents.element.style.cursor="",this.isDragging=!1}}},{key:"getMaxVideoWidth",value:function(){return"split"===C.S.getVideoMode()?this.roomContents.element.clientWidth-this.minChatWidth():this.roomContents.element.clientWidth-2*this.roomContents.roomContentsPadding}},{key:"getMaxVideoHeight",value:function(){return window.innerHeight-166}},{key:"getCursor",value:function(){var e=this.roomContents.videoPanel.element.offsetWidth;return e<=k?"e-resize":e>=this.getMaxVideoWidth()?"w-resize":"ew-resize"}},{key:"loadSettings",value:function(){if((0,c.IU)()){var e=window.localStorage.getItem(x);if(null!==e){var t,n,i=JSON.parse(e);return this.state={videoWidth:i.videoWidth,videoHeight:i.videoHeight,chatWidth:null!==(t=i.chatWidth)&&void 0!==t?t:this.getChatWidthFromVideoWidth(i.videoWidth)},void(this.lastChosenVideoWidth=null!==(n=i.lastChosenVideoWidth)&&void 0!==n?n:this.state.videoWidth)}}"split"===C.S.getVideoMode()&&0!==this.element.offsetWidth&&((0,m.NZ)("SmDfCm")?this.setDefaultVideoSize():this.setResolutionToMax({maximizeWidth:!0}),this.lastChosenVideoWidth=this.state.videoWidth)}},{key:"saveSettings",value:function(){(0,c.IU)()&&window.localStorage.setItem(x,JSON.stringify({videoWidth:this.state.videoWidth,videoHeight:this.state.videoHeight,chatWidth:this.state.chatWidth,lastChosenVideoWidth:this.lastChosenVideoWidth}))}},{key:"repositionChildren",value:function(){this.handleResize(),this.isDragging||this.handleResizeFinished()}},{key:"setResolutionToMax",value:function(){var e,t,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{maximizeWidth:!1}).maximizeWidth,i=(0,g._U)();if(this.getMaxVideoWidth()-95>i/2){if(n){var o=(0,g.mP)();if(o/i>this.getVideoAspectRatio())t=this.getMaxVideoWidth()-95;else{var r=o-200;t=this.getWidthFromHeight(r)}}else t=i/2;e=this.getHeightFromWidth(t)}else e=this.getMaxVideoHeight(),t=this.getWidthFromHeight(e);n||e>this.getMaxVideoHeight()&&(e=this.getMaxVideoHeight(),t=this.getWidthFromHeight(e)),t<k&&(t=k),this.state.videoWidth=t,this.state.chatWidth=this.getChatWidthFromVideoWidth(t)}},{key:"getVideoAspectRatio",value:function(){return this.roomContents.videoPanel.player.getIsWidescreen()?b.fo:b.$V}},{key:"getHeightFromWidth",value:function(e){return e*this.getVideoAspectRatio()}},{key:"getWidthFromHeight",value:function(e){return e/this.getVideoAspectRatio()}},{key:"minChatWidth",value:function(){return 155}}]),p}(f.w);T.splitModeDragResize=new p.xB("splitModeDragResize")},9980:function(e,t,n){"use strict";n.d(t,{U:function(){return c}});var i=n(2951),o=n(1976),r=n(3243),s=n(7591),a=n(9492),l=n(7597);var c=function(e){(0,s.Z)(u,e);var t,n,c=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,a.Z)(this,e)});function u(){return(0,i.Z)(this,u),c.apply(this,arguments)}return(0,o.Z)(u,[{key:"createCommonButton",value:function(){var e=(0,r.Z)((0,l.Z)(u.prototype),"createCommonButton",this).call(this);return e.dataset.testid="send-tip-button",e.style.fontFamily="UbuntuMedium, Helvetica, Arial, sans-serif",e}}]),u}(n(795).IK)},8747:function(e,t,n){"use strict";n.d(t,{d:function(){return d}});var i=n(2951),o=n(1976),r=n(8015),s=n(7693),a=n(4793),l=n(8069),c=n(3705),u=n(2974),d=function(){function e(){var t=this;(0,i.Z)(this,e),this.messageCount=0,this.messageSuccessCount=0,this.tipSuccessCount=0,this.tipSuccessTotal=0,this.tipFailCount=0,this.tipFailTotal=0,this.chatConnection=void 0,this.tipCallout=void 0,this.actionName="SessionMetrics",this.sendMetrics=function(){t.careAboutMetrics()&&((0,c.fg)(t.actionName,t.getPageActionAttributes()),t.resetMetrics())},this.onModeChange=function(){(0,c.zB)(t.getMode()),(0,c.fg)("ChangeVideoMode",{videoMode:t.getMode()}),t.careAboutMetrics()&&t.modeChangeDebounce.callFunc()},this.onTipSent=function(e){void 0!==e.amount&&(!0===e.success?(t.tipSuccessCount+=1,t.tipSuccessTotal+=e.amount):(t.tipFailCount+=1,e.amount>0&&(t.tipFailTotal+=e.amount)))},this.onMessageSent=function(){t.messageCount+=1},this.onMessageReceived=function(e){void 0!==t.chatConnection&&e.fromUser.username===t.chatConnection.username()&&t.messageSuccessCount<t.messageCount&&(t.messageSuccessCount+=1)},this.saveRefreshMeta=function(){if(void 0!==window.sessionStorage&&t.careAboutMetrics()){var e={href:window.location.href,unloadTimestamp:(new Date).getTime()};window.sessionStorage.setItem("refreshMeta",JSON.stringify(e))}},this.resetMetrics(),this.loadTimestamp=(new Date).getTime(),this.pageRefreshed=this.wasRefresh(),this.currentMode=u.S.getVideoMode(),(0,c.zB)(this.currentMode),this.modeChangeDebounce=new l.d((function(){var e=t.getMode();t.currentMode!==e&&(t.newMode=e,t.sendMetrics(),t.currentMode=e)}),{bounceLimitMS:100,debounceType:1}),a.kN.once((function(){t.setupModeChangeListener()})),a.QN.listen(this.sendMetrics),(0,s.j9)("beforeunload",window,this.sendMetrics),(0,s.j9)("beforeunload",window,this.saveRefreshMeta)}return(0,o.Z)(e,[{key:"setupModeChangeListener",value:function(){u.S.changeVideoMode.listen(this.onModeChange)}},{key:"bindChatConnection",value:function(e){e!==this.chatConnection&&(void 0!==this.chatConnection&&(this.chatConnection.event.messageSent.removeListener(this.onMessageSent),this.chatConnection.event.roomMessage.removeListener(this.onMessageReceived),r.Cb.removeListener(this.onMessageReceived)),this.chatConnection=e,this.chatConnection.event.messageSent.listen(this.onMessageSent),this.chatConnection.event.roomMessage.listen(this.onMessageReceived),r.Cb.listen(this.onMessageReceived))}},{key:"bindTipCallout",value:function(e){return e!==this.tipCallout&&(void 0!==this.tipCallout&&this.tipCallout.tipSent.removeListener(this.onTipSent),this.tipCallout=e,this.tipCallout.tipSent.listen(this.onTipSent,!1),!0)}},{key:"careAboutMetrics",value:function(){return void 0!==this.chatConnection&&!this.chatConnection.viewerIsAnonymous()}},{key:"resetMetrics",value:function(){this.messageCount=0,this.messageSuccessCount=0,this.tipSuccessCount=0,this.tipSuccessTotal=0,this.tipFailCount=0,this.tipFailTotal=0,this.newMode=void 0,this.pageRefreshed=!1}},{key:"getPageActionAttributes",value:function(){return{messageSuccessCount:this.messageSuccessCount,messageFailCount:this.messageCount-this.messageSuccessCount,tipSuccessCount:this.tipSuccessCount,tipSuccessTotal:this.tipSuccessTotal,tipFailCount:this.tipFailCount,tipFailTotal:this.tipFailTotal,refreshCount:void 0===this.pageRefreshed?void 0:Number(this.pageRefreshed),modeChange:Boolean(this.newMode),newMode:this.newMode,currentMode:this.currentMode}}},{key:"getMode",value:function(){return u.S.getVideoMode()}},{key:"getNavigationType",value:function(){if(void 0!==window.performance){var e=[];if(void 0!==window.performance.getEntriesByType&&(e=window.performance.getEntriesByType("navigation")),!(e.length>0))return window.performance.navigation.type;switch(e[0].type){case"navigate":return 0;case"reload":return 1;case"back_forward":return 2;case"prerender":return 3;default:return 255}}}},{key:"wasRefresh",value:function(){var e=this.getNavigationType();if(1===e)return!0;if(0===e||void 0===e){var t,n=null===(t=window.sessionStorage)||void 0===t?void 0:t.getItem("refreshMeta");if(null==n)return;var i=JSON.parse(n);return i.href===window.location.href&&i.unloadTimestamp>this.loadTimestamp-1e4}return!1}}]),e}()},758:function(e,t,n){"use strict";n.d(t,{FJ:function(){return s},Gf:function(){return o},OI:function(){return a},gO:function(){return l},jE:function(){return r},jS:function(){return c}});var i=n(1794),o=new i.xB("switchedToHLS"),r=new i.xB("openDefaultTipCalloutRequest"),s=new i.xB("loginOverlayRequest"),a=new i.xB("anonSendMessageClick"),l=new i.xB("userChatSettingsUpdate",{listenersWarningThreshold:function(){return 50+2*i.q6}}),c=new i.xB("openPhotoVideoTabRequest")},3543:function(e,t,n){"use strict";n.d(t,{ag:function(){return c},ih:function(){return s}});var i=n(3753),o=n(9165),r=n(8978),s=window.gettext;void 0===s&&(warn("gettext is undefined."),s=function(e){return e});var a=window.ngettext;void 0===a&&(warn("ngettext is undefined."),a=function(e,t,n){return n>1?t:e});var l=window.interpolate;void 0===l&&(warn("interpolate is undefined."),l=function(e,t,n){return n?e.replace(/%\(\w+\)s/g,(function(e){return String(t[e.slice(2,-2)])})):e.replace(/%s/g,(function(e){return String(t.shift())}))});var c={documentTitle:function(e){return l(s("Chat with %(username)s in a Live Adult Video Chat Room Now"),{username:(0,r.t)(e)},!0)},tokenOrTokensText:function(e,t){return t?a("Token","Tokens",e):a("token","tokens",e)},tokenOrTokensTextCAPS:function(e){return a("TOKEN","TOKENS",e)},tipConfirmationMessage:function(e){return l(s("Confirm tip of %(tokens)s tokens"),{tokens:e.toLocaleString()},!0)},subjectChangeMessage:function(e){return l(s('room subject changed to "%(subject)s"'),{subject:e},!0)},roomTitleMessage:function(e){return l(s("%(username_title)s's Cam"),{username_title:(0,r.t)(e)},!0)},moderatorPromoteMessage:function(e,t){return l(s("%(from)s has granted moderator privileges to %(to)s."),{from:e,to:t},!0)},moderatorRevokeMessage:function(e,t){return l(s("%(from)s has revoked moderator privileges from %(to)s."),{from:e,to:t},!0)},joinFanClubText:function(e){return l(s("Join %(modelname)s's Fan Club"),{modelname:(0,r.Qs)(e)},!0)},joinFanClubWithTokensText:function(e,t,n){var i=c.joinFanClubText(e),o=l(s("with %(tokens)s tokens for %(months)s months"),{tokens:t,months:n},!0);return i.concat(" ").concat(o)},joinFanClubTextCAPS:function(e){return l(s("JOIN %(modelname)s's FAN CLUB"),{modelname:e},!0)},joinFanClubPage:function(e){return l(s('You will be taken to Join Fanclub Page for %(modelname)s.  Click "OK" to proceed.'),{modelname:(0,r.Qs)(e)},!0)},loggedInToJoinFanClubText:function(e){return l(s('You must be logged in to join %(modelname)s\'s fan club.  Click "OK" to login.'),{modelname:(0,r.Qs)(e)},!0)},roomPicsVideoText:function(e){return l(s("%(modelname)s's Pics & Videos"),{modelname:(0,r.Qs)(e)},!0)},roomPicsText:function(e){return l(s("%(modelname)s's Pics"),{modelname:(0,r.Qs)(e)},!0)},roomVidsText:function(e){return l(s("%(modelname)s's Videos"),{modelname:(0,r.Qs)(e)},!0)},purchaseVideoText:function(e){return l(a("You are about to purchase this video for %(tokens)s token","You are about to purchase this video for %(tokens)s tokens",e),{tokens:e},!0)},purchasePhotosText:function(e,t){return l(s("You are about to purchase this photo set (%(numphotos)s %(imagestext)s) for %(tokens)s %(tokenstext)s"),{numphotos:e,imagestext:a("image","images",e),tokens:t,tokenstext:a("token","tokens",t)},!0)},unlockPhotosText:function(e){return l(a("Unlock this photo set (%(numphotos)s image)","Unlock this photo set (%(numphotos)s images)",e),{numphotos:e},!0)},unlockVideoText:function(e){return l(s("Unlock this video (%(duration)s)"),{duration:e},!0)},fanClubDisabledText:function(e){return l(s("%(modelname)s has disabled their fan club."),{modelname:(0,r.Qs)(e)},!0)},silenceMessage:function(e,t){return l(s("User %(username)s was silenced by %(silencer)s and their messages have been removed"),{username:e,silencer:t},!0)},userKickedAndMessagesRemovedMessage:function(e){return l(s("User %(username)s was kicked out of the room and their messages have been removed"),{username:e},!0)},privateShowPriceChangeMessage:function(e,t){return l(s("%(username)s changed Private Show price to %(price)s tokens per minute"),{username:e,price:t},!0)},spyShowPriceChangeMessage:function(e,t){return l(s("%(username)s changed Spy on Private Show price to %(price)s tokens per minute"),{username:e,price:t},!0)},priceTokensPerMinuteMessage:function(e){return l(s("%(price)s tokens per minute"),{price:e},!0)},privateShowMinimumMinuteMessage:function(e){return l(s("(minimum %(minMinutes)s minutes)"),{minMinutes:e},!0)},privateShowConfirmMessage:function(e,t,n,i){return l(s("Enter private chat with %(username)s?\n%(price)s tokens per minute, minimum %(minMinutes)s minute(s)\n\n"),{username:e,price:t,minMinutes:n},!0)+s(i?"This broadcaster allows private show recordings, so you will receive a recorded video of this show in your collection.":"This broadcaster does not allow private show recordings, so you will not receive a recorded video of this show in your collection.")},privateShowSpyConfirmMessage:function(e){return l(s("Spy on private show for (%(price)s tokens per minute)"),{price:e},!0)},appsRunningMessage:function(e){return l(s("Broadcaster %(username)s is running these apps: "),{username:e},!0)},usersRunningAppMessage:function(e){return l(s("Showing users running %(appName)s"),{appName:e},!0)},devportalMessage:function(e){return l(s('Create or update v2 Apps in the new <a href="%(link)s" target="_blank" rel="noopener noreferrer" data-test="dev-portal-link">Developer Portal</a>.'),{link:(0,i.BN)(e)},!0)},integerMinError:function(e){return l(s("This field is less than the minimum of %(minimum)s"),{minimum:e},!0)},integerMaxError:function(e){return l(s("This field is greater than the maximum of %(maximum)s"),{maximum:e},!0)},allowToVoteMessage:function(e,t){return l(s("After tipping %(min_tokens_to_vote)s tokens in a day, you'll be able to vote regarding your satisfaction with %(room)s."),{min_tokens_to_vote:t,room:(0,r.Qs)(e)},!0)},confidentalVoteMessage:function(e){return l(s("Your confidential vote regarding %(room)s has been recorded. You may change your vote at any time today. Thank you for your feedback."),{room:(0,r.Qs)(e)},!0)},shareCamText:function(e){return l(s("Share %(username)s's Cam"),{username:e},!0)},embedCamText:function(e){return l(s("Embed %(username)s's Cam on Your Webpage"),{username:e},!0)},conversationCautionMessage:function(e){return l(s("Caution: The %(siteName)s Team will NEVER contact you via chat or ask for your password."),{siteName:e},!0)},afterTipVoteSatisfactionText:function(e,t){return l(s("Note: For tipping at least %(tokens)s tokens today, you can now vote what you think about %(room)s. Your vote is confidential. See below for the satisfaction feedback controls."),{tokens:t,room:(0,r.Qs)(e)},!0)},afterTipVoteSatMobileText:function(e,t){return l(s("Note: For tipping at least %(tokens)s tokens today, you can now vote what you think about %(room)s. Your vote is confidential. Open the menu for the satisfaction feedback controls."),{tokens:t,room:(0,r.Qs)(e)},!0)},votedUpText:function(e){return l(s("Note: Your confidential vote of thumbs up for %(room)s has been recorded. You may change your vote at any time today. Thank you for your feedback."),{room:(0,r.Qs)(e)},!0)},votedDownText:function(e){return l(s("Note: Your confidential vote of thumbs down for %(room)s has been recorded. You may vote once every 90 days, and you may change your vote at any time today.  Thank you for your feedback."),{room:(0,r.Qs)(e)},!0)},votedDownTextRepeat:function(e){return l(s("Note: Your confidential vote of thumbs down for %(room)s has been refreshed and will expire in 90 days. You may change your vote at any time today. Thank you for your feedback."),{room:(0,r.Qs)(e)},!0)},sureVoteDownText:function(e){return l(s("Are you sure you want to rate %(room)s thumbs down?"),{room:(0,r.Qs)(e)},!0)},noSimilarRooms:function(e){return l(s("Sorry, we don't have any rooms similar to %(room)s yet."),{room:e},!0)},pmSupporterSendPm:function(e){return l(s("to send a pm to %(pmUser)s"),{pmUser:e},!0)},userPromotionCurrentPriceText:function(e){var t=c.userPromotionCurrentPriceLabel,n=c.tokenOrTokensText(e,!1);return"".concat(t).concat(": ").concat(String(e)).concat(" ").concat(n)},userIsIgnored:function(e){return l(s("%(username)s is ignored"),{username:e},!0)},ignoreUser:function(e){return l(s("Ignore %(username)s"),{username:e},!0)},ignoringUser:function(e){return l(s("Ignoring %(username)s"),{username:e},!0)},noLongerIgnoring:function(e){return l(s("No longer ignoring %(username)s"),{username:e},!0)},removedOldestIgnore:function(e){return l(s("Ignore limit reached. Removed oldest user from list: %(username)s"),{username:e},!0)},userHasBeenReported:function(e){return l(s("%(username)s has been reported"),{username:e},!0)},errorIgnoringUser:function(e){return l(s("Error ignoring user %(username)s. Please try again in a few seconds."),{username:e},!0)},errorUnignoringUser:function(e){return l(s("Error unignoring user %(username)s. Please try again in a few seconds."),{username:e},!0)},errorFollowingUser:function(e){return l(s("Error following user %(username)s. Please try again."),{username:e},!0)},errorUnfollowingUser:function(e){return l(s("Error unfollowing user %(username)s. Please try again."),{username:e},!0)},errorVotingForUser:function(e){return l(s("Error voting for user %(username)s. Please try again."),{username:e},!0)},transferTokensToCashWithValue:function(e){return l(s("Transfer tokens to %(cashAmount)s cash."),{cashAmount:e},!0)},transferTokensToAdvertisingWithValue:function(e){return l(s("Transfer tokens to %(cashAmount)s advertising credit."),{cashAmount:e},!0)},overSpendingLimit:function(e){return l(s("Attempted to purchase %(tokens)s tokens but spending limit exceeded."),{tokens:e},!0)},emailToResolve:function(e){return l(s("Email %(emailAddress)s ASAP to resolve."),{emailAddress:e},!0)},purchasePhotoSet:function(e,t){return l(s("Purchase Photo/Video (%(setName)s) from %(username)s"),{setName:e,username:t},!0)},sellPhotoSet:function(e,t){return l(s("Sell Photo/Video (%(setName)s) to %(username)s"),{setName:e,username:t},!0)},purchaseSocialMediaFrom:function(e,t){return l(s("Purchase social media (%(name)s) from %(username)s"),{name:e,username:t},!0)},sellSocialMediaTo:function(e,t){return l(s("Sell Social media (%(name)s) to %(username)s"),{name:e,username:t},!0)},broadcasterWelcomeMessage:function(e){return l(s("Your cam is visible to %(listVisibleTo)s. Edit this in settings & privacy."),{listVisibleTo:e},!0)},privateShowRequestAppPanel:function(e){return l(s('%(username)s  wants to start a "Private" show.'),{username:e},!0)},privateShowRequestChatMessage:function(e){return l(s("%(username)s  wants to start a private show."),{username:e},!0)},privateShowEarningsMessage:function(e){return l(s("This private show will earn you %(tokens)s tokens per minute, based on your settings."),{tokens:e},!0)},tokensPerMinute:function(e){return l(s("%(tokens)s Per Minute"),{tokens:e},!0)},banUserConfirm:function(e){return l(s("Ban %(username)s?"),{username:e},!0)},banUserError:function(e){return l(s("Error banning user %(username)s"),{username:e},!0)},banUserSuccess:function(e){return l(s("User %(username)s banned from your room"),{username:e},!0)},userHasTippedMe:function(e){return l(s("%(username)s has tipped me"),{username:e},!0)},tokensInPastHour:function(e){return l(s("%(tokens)s in the past hour"),{tokens:e},!0)},tokensInPastDay:function(e){return l(s("%(tokens)s in the past day"),{tokens:e},!0)},tokensInPastTwoWeeks:function(e){return l(s("%(tokens)s in the past 2 weeks"),{tokens:e},!0)},activeMembershipsMessage:function(e){return l(a("You have %(numMemberships)s Active Membership","You have %(numMemberships)s Active Memberships",e),{numMemberships:e},!0)},monthlyCost:function(e){return l(s("$%(cost)s monthly"),{cost:e},!0)},automaticallySilencedUsersMessage:function(e){return l(a("We have automatically silenced %(numSilenced)s user possibly linked to a user you have previously silenced;","We have automatically silenced %(numSilenced)s users possibly linked to a user you have previously silenced;",e),{numSilenced:e},!0)},automaticallyBannedUsersMessage:function(e){return l(a("We have automatically banned %(numSilenced)s user possibly linked to a user you have previously banned;","We have automatically banned %(numSilenced)s users possibly linked to a user you have previously banned;",e),{numSilenced:e},!0)},currentFanClubMembersTitle:function(e){return l(a("%(numMembers)s Current Fan Club Member","%(numMembers)s Current Fan Club Members",e),{numMembers:e},!0)},broadcastNotificationTopBarFollowerTextPluralOld:function(e){return l(s("You have %(numFollowers)s followers"),{numFollowers:e},!0)},userPromotionToolbarInProgressText:function(e){return l(s("Promoted for %(relativeTime)s"),{relativeTime:e},!0)},idAboutToExpire:function(e){return l(s("An ID on your account is set to expire on %(expire)s. Please submit new ID for verification in order to continue earning tokens on uploaded content or while broadcasting with minimal disruption."),{expire:e},!0)},guestIdAboutToExpire:function(e){return l(s("Your Guest %(username)s has an ID expiring soon on their account. Please let your Guest know they'll need to submit an updated ID on their personal account to keep the ability to be a Guest on your account."),{username:e},!0)},paxumTempNotice:function(){return l(s('Due to new requirements necessary for Paxum payouts, we need some additional information for you to continue to receive payments. <a href="%(link)s">Please visit this page to update your info</a>.'),{link:(0,i.BN)("/affiliates/payoutinfo_paxum_temp/")},!0)},userPromotionReportText:function(e){return l(s("Your promotion is complete - %(viewCount)s people saw your room on the homepage and Discover page."),{viewCount:e},!0)},showMyCamStart:function(e){return l(s("Start Cam To Cam with %(username)s"),{username:e},!0)},showMyCamPreviewInfo1:function(e){return l(s("Your cam will only be visible to %(username)s."),{username:e},!0)},showMyCamCurrentlySharing:function(e){return l(s("You are currently showing your cam to %(room)s. If your cam has ended, please wait up to 1 minute to be able to broadcast again."),{room:e},!0)},showMyCamCooldownAlert:function(e){return l(s("Please allow up to %(sec)s seconds before sharing your cam again."),{sec:e},!0)},privateConversationWithText:function(e){return l(s("Private conversation with %(username)s"),{username:e},!0)},fanclubCancelConfirmMessage:function(e){return l(s("Are you sure you wish to leave %(username)s's Fan Club? You will remain a member until your currently paid month expires."),{username:e},!0)},loginForPasswordPrompt:function(e){return l(s("%(room)s's room now requires a password. Please log in for a password prompt."),{room:e},!0)},passwordRequiredForRoom:function(e){return l(s("Password required for room %(room)s"),{room:e},!0)},authSectionInfo:function(e){return l(s("Use the <a class='hrefColor' target='_blank' rel='noopener' href='%(eventsUrl)s'>Events API JSON feed</a> to see your room's chat messages and events.  For more information, see the <a class='hrefColor' target='_blank' rel='noopener' style='font-size: 12px;' href='%(documentationUrl)s'>documentation</a>."),{eventsUrl:(0,i.BN)(e),documentationUrl:(0,i.BN)("/apps/api/docs/index.html")},!0)},gamesText:function(e,t){return l(s("Approved games can now be live streamed on %(siteName)s. Let us know which approved game you are playing below. If a game you would like to broadcast on %(siteName)s is not on the approved list, encourage the game developer to submit their game to the <a href='%(gamesUrl)s' target='_blank'>Multimedia Games site</a>."),{siteName:e,gamesUrl:(0,i.BN)(t)},!0)},usedByText:function(e){return l(s("Currently used by: %(app)s"),{app:e},!0)},replaceAppConfirm:function(e){return l(s("This slot is currently used by %(app)s.\nDo you want to replace it?"),{app:e},!0)},noSearchResults:function(e){return l(s("No search results for '%(text)s'"),{text:e},!0)},noSearchResultsMatch:function(e){return l(s("No search results for '%(keyword)s' match your preferences, please update your search/filter options."),{keyword:e},!0)},searchResultsFor:function(e){return l(s('Search results for "%(keyword)s"'),{keyword:e},!0)},feedbackSentimentLabel:function(e){return l(s("Overall, how was your %(siteName)s experience today?"),{siteName:e},!0)},feedbackSmcLabel:function(e){return l(s("How was your %(siteName)s Cam To Cam experience today?"),{siteName:e},!0)},feedbackBroadcasterLabel:function(e){return l(s("How was your %(siteName)s broadcast experience today?"),{siteName:e},!0)},howSmootherExperience:function(e){return l(s("Can we do anything to make your %(siteName)s experience smoother?"),{siteName:e},!0)},upgradeToSupporter:function(e){return l(s('<a class="hrefColor" href="%(link)s">Upgrade to supporter</a> for no ads, private messaging, and more!'),{link:(0,i.BN)(e)},!0)},supporterToUseFeature:function(e){return l(s('<a href="%(link)s">Upgrade</a> to supporter to use this feature.'),{link:(0,i.BN)("/supporter/upgrade/?source=".concat(e))},!0)},sorryToSeeYouGo:function(e){return l(s("We're sorry to see you go. Your subscription has been canceled successfully. You will keep all of your supporter features until %(expireAt)s, after which your membership will expire. You will not be charged after this date."),{expireAt:e},!0)},startDateNotice:function(e){return l(s("Your new subscription will begin %(startAt)s."),{startAt:e},!0)},obsBroadcastWarning:function(e){return l(s("WARNING: Your broadcast is live on %(siteName)s when you are streaming from RTMP/OBS, regardless of if you are in your room."),{siteName:e},!0)},selectGameSectionText:function(e,t){return l(s('If a game you would like to broadcast on %(siteName)s is not on the approved list, encourage the game developer to submit their game to the <a href="%(gamesUrl)s" target="_new">Multimedia Games Site </a>.'),{siteName:e,gamesUrl:(0,i.BN)(t)},!0)},downloadOBSSectionText:function(e){return l(s('You can use <a href="%(obsLink)s" target="_blank">Open Broadcaster Software</a> (OBS) to stream games and overlay with it your webcam feed. You\'ll need your <a class="streamKeyLink" href="%(obsLink)s" target="_blank">%(siteName)s stream key</a> to connect OBS to your stream. See a quick <a href="%(supportLink)s" target="_blank">tutorial</a> if you need help.'),{siteName:e,obsLink:(0,i.BN)("https://obsproject.com/"),supportLink:(0,i.BN)("https://support.chaturbate.com/hc/en-us/articles/360037971952-How-do-I-set-up-OBS-/")},!0)},authorizeGameSectionText:function(e){return l(s('After you go live, click <a class="closePopoutLink" href="#" target="_blank">here</a> to add the gaming tag to your stream. This step is required to stream licensed games on %(siteName)s.'),{siteName:e},!0)},mobileNewPrivateMessageNotice:function(e){return l(s("New private message from %(username)s"),{username:e},!0)},newPrivateMessageNotice:function(e){return l(s("New private message from %(username)s"),{username:e},!0)},newDirectMessageNotice:function(e){return l(s("New direct message from %(username)s"),{username:e},!0)},sendDmToUser:function(e){return l(s("Send DM to %(username)s"),{username:e},!0)},tipUser:function(e){return l(s("Tip %(user)s"),{user:e},!0)},sendTipToUser:function(e){return l(s("Send Tip to %(user)s"),{user:(0,r.t)(e)},!0)},numViewerOrViewers:function(e){return l(a("%(viewerCount)s viewer","%(viewerCount)s viewers",e),{viewerCount:e},!0)},shortenedNumViewerOrViewers:function(e,t){return l(a("%(shortenedViewCount)s viewer","%(shortenedViewCount)s viewers",e),{shortenedViewCount:t},!0)},obsStreamClass:function(e){return l(s("Your stream is classed as %(resolutionTitle)s"),{resolutionTitle:e},!0)},obsConnectionDescription:function(e,t,n){return l(s("Connected to %(host)s in region %(region)s - Using %(streamType)s"),{host:e,region:t,streamType:n},!0)},obsFPS:function(e){return l(s("%(fps)s fps"),{fps:e},!0)},obsBitrate:function(e){return l(s("%(bitrate)s bitrate"),{bitrate:e},!0)},obsAlternativeStreamType:function(e){return l(s("Currently broadcasting with %(streamType)s from another browser."),{streamType:e},!0)},obsSupport:function(e,t,n){return l(s("Visit %(linkStart)s our support page %(linkEnd)s to get started with OBS on %(siteName)s"),{linkStart:e,linkEnd:t,siteName:n},!0)},otherEncoderSupport:function(e,t){return l(s("See our support page for %(linkStart)s technical info%(linkEnd)s."),{linkStart:e,linkEnd:t},!0)},signInWithSocialAuth:function(e){return l(s("Sign In with %(name)s"),{name:e},!0)},signUpWithSocialAuthInContent_InCntntSUp:function(e){return l(s("Sign Up with %(name)s and Send Message Now"),{name:e},!0)},createdAt:function(e){return l(s("Created at %(date)s"),{date:e},!0)},expiresOn:function(e){return l(s("Expires on %(date)s"),{date:e},!0)},followingUser:function(e){return l(s("Following %(username)s"),{username:e},!0)},followCountLong:function(e,t){return l(s("%(online)s Online / %(total)s Following"),{online:e,total:t},!0)},cannotCancelPrivate:function(e,t,n){var i;return i=s(t>0?"You have started a private show with a %(minimumMinutes)s minute minimum. You cannot cancel your private show yet. It still has %(minutesRemaining)s minutes and %(secondsRemaining)s seconds remaining.":"You have started a private show with a %(minimumMinutes)s minute minimum. You cannot cancel your private show yet. It still has %(secondsRemaining)s seconds remaining."),l(i,{minimumMinutes:e,minutesRemaining:t,secondsRemaining:n},!0)},unableToLeavePrivateShow:function(e){return l(s("Unable to leave private show from status: %(prevStatus)s"),{prevStatus:e},!0)},pmFloatingWindowOverflowMenuToolTipMessage:function(e){return l(a("There is %(num)s more open conversation","There are %(num)s more open conversations",e),{num:e},!0)},sentTipDmNotice:function(e){return l(a("You tipped %(num)s token.","You tipped %(num)s tokens.",e),{num:e},!0)},receivedTipDmNotice:function(e,t){return l(a("%(otherUser)s tipped you %(num)s token.","%(otherUser)s tipped you %(num)s tokens.",t),{otherUser:e,num:t},!0)},receivedTipDmNoticeWithMessage:function(e,t,n){return l(a("%(otherUser)s tipped you %(num)s token. -- %(message)s","%(otherUser)s tipped you %(num)s tokens. -- %(message)s",t),{otherUser:e,num:t,message:n},!0)},termsLabel_InCntntSUp:function(e){return l(s('I have read and agree to the <a href="%(link)s" target="_blank" rel="noopener noreferrer">terms and conditions.</a>'),{link:(0,i.BN)(e)},!0)},privacyLabel_InCntntSUp:function(e){return l(s('I have read and agree to the <a href="%(link)s" target="_blank" rel="noopener noreferrer">privacy policy.</a>'),{link:(0,i.BN)(e)},!0)},anonUsersCount:function(e){return l(a("+%(anonCount)s anonymous user","+%(anonCount)s anonymous users",e),{anonCount:e},!0)},directMessagesPageTitle:function(e,t){return l(s("Direct Messages (%(currentUsername)s) - %(otherUsername)s"),{currentUsername:e,otherUsername:t},!0)},todayAtTime:function(e){return l(s("Today at %(time)s"),{time:e},!0)},yesterdayAtTime:function(e){return l(s("Yesterday at %(time)s"),{time:e},!0)},shortcodeEnteredError:function(e){return l(s("Invalid shortcode message entered: %(message)s"),{message:e},!0)},shortcodeFollowMessage:function(e){return l(s("Follow %(username)s"),{username:e},!0)},shortcodeFanclubMessage:function(e){return l(s("Join %(username)s's Fanclub"),{username:e},!0)},shortcodeHelpSignup:function(){return l(s("Generates a clickable link with the text \"%(signupMsg)s\". Upon clicking the link, it opens the signup page using the broadcaster user's affiliate tracking tags. The shortcode is designed to always return the signup link with the broadcaster's campaign/affiliate code, regardless of who in the broadcaster's room types in that shortcode."),{signupMsg:c.joinCB},!0)},shortcodeHelpSupporter:function(){return l(s('Generates a clickable link with the text "%(supporterMsg)s". Upon clicking this link, the user is directed to the supporter page to upgrade their membership.'),{supporterMsg:c.becomeSupporter},!0)},shortcodeHelpFanclub:function(e){return l(s("Generates a clickable link with the text \"%(fanclubMsg)s\". When the link is clicked, it opens the broadcaster's Fanclub page. If the user doesn't have a Fanclub set up, an error dialog will be displayed to explain this."),{fanclubMsg:c.shortcodeFanclubMessage(e)},!0)},shortcodeHelpFollow:function(e){return l(s('Generates a clickable link with the text "%(followMsg)s". When a user clicks on this link, it triggers the user to follow the room. If the user is already following the room, the shortcode is designed to do nothing.'),{followMsg:c.shortcodeFollowMessage(e)},!0)},shortcodeHelpTip:function(){return l(s('Generates a clickable link with the text representing the specified amount, such as "50 tokens." Upon clicking the link, it opens a tipping dialog with the given amount and message (in this case, "%(tipExample)s") prepopulated in the dialog. This shortcode is allowed only for broadcasters and apps.'),{tipExample:c.shortcodeHelpTipExample},!0)},roomlistPageTitleHashtag:function(e,t){return l(s("%(tagName)s Cams @ %(siteName)s -  Free Adult Webcams & Live Sex"),{tagName:e,siteName:t},!0)},roomlistPageTitleFemale:function(e){return l(s("Free Chat with Girls - Live Cam Girls, Free Webcam Girls at %(siteName)s"),{siteName:e},!0)},roomlistPageTitleMale:function(e){return l(s("Free Chat with Men - Live Gay Cams, Free Gay Webcams at %(siteName)s"),{siteName:e},!0)},roomlistPageTitleCouple:function(e){return l(s("Free Chat with Couples - Live Cam Couples, Free Webcam Couples at %(siteName)s"),{siteName:e},!0)},roomlistPageTitleTrans:function(e){return l(s("Free Chat with Trans - Live Cam Trans, Free Webcam Trans at %(siteName)s"),{siteName:e},!0)},roomlistPageTitleDefault:function(e){return l(s("%(siteName)s - Free Adult Webcams, Live Sex, Free Sex Chat, Exhibitionist & Pornstar Free Cams"),{siteName:e},!0)},roomlistPageTitlePremium:function(e){return l(s("%(siteName)s - Private Cams, Spy Cams"),{siteName:e},!0)},metaTitlePremium:function(e){return l(s("Premium Private Cam Shows at %(siteName)s"),{siteName:e},!0)},metaTitleFemale:function(e){return l(s("Free Chat with Cam Girls at %(siteName)s!"),{siteName:e},!0)},metaTitleMale:function(e){return l(s("Free Chat with Cam Guys at %(siteName)s!"),{siteName:e},!0)},metaTitleCouples:function(e){return l(s("Free Chat with Cam Couples at %(siteName)s!"),{siteName:e},!0)},metaTitleTrans:function(e){return l(s("Free Trans Cams and Chat at %(siteName)s!"),{siteName:e},!0)},metaTitleHashtag:function(e,t){return l(s("%(siteName)s - %(hashtag)s Live Webcams"),{siteName:e,hashtag:t},!0)},metaTitleDefault:function(e){return l(s("%(siteName)s - Free Adult Live Webcams!"),{siteName:e},!0)},metaContentCardDescriptionHashtag:function(e){return l(s("Enjoy free %(hashtag)s webcams and live chat broadcasts from amateurs. No registration required!"),{hashtag:e},!0)},metaDescriptionFemale:function(e){return l(s("Chat with live cams girls on %(domain)s! NSFW - Uncensored chat & adult webcams"),{domain:e},!0)},metaDescriptionMale:function(e){return l(s("Talk with gay guys and men instantly on %(domain)s! NSFW - Uncensored chat & gay webcams"),{domain:e},!0)},metaDescriptionCouples:function(e){return l(s("Watch live couples chatting on %(domain)s! NSFW - Uncensored chat & adult webcams"),{domain:e},!0)},metaDescriptionTrans:function(e){return l(s("Enjoy wild live trans webcams on %(domain)s! NSFW - Uncensored chat & trans webcams"),{domain:e},!0)},metaKeywordsHashtag:function(e){return l(s("%(hashtag)s cams, %(hashtag)s sex, %(hashtag)s xxx, %(hashtag)s porn, %(hashtag)s webcams"),{hashtag:e},!0)},rssLinkTitle:function(e,t){return l(s("%(camCategory)s Cams RSS Feed for %(siteName)s"),{camCategory:e,siteName:t},!0)},genderSymbolToIconTitle:function(e){var t,n=new Map([[o.Y0.All,""],[o.Y0.Male,c.maleText],[o.Y0.Female,c.femaleText],[o.Y0.Couple,c.coupleText],[o.Y0.Trans,c.transText],[o.Y0.OldTrans,c.transText]]),i=(0,o.$p)(e);return null!==(t=n.get(i))&&void 0!==t?t:""},errorLoadingDms:function(e){return l(s("Error loading DM conversation with %(username)s"),{username:e},!0)},v1AppsAndBotsFooterText:function(){return l(s("Create or update v1 Apps & Bots on the <a href='%(link)s' target='_blank' rel='noopener noreferrer'>v1 Apps & Bots page</a>."),{link:(0,i.BN)("/apps/")},!0)},ieSupportNotification:function(){return l(s('We noticed you\'re using a web browser that we don\'t support. Upgrade to a recent version of <br> <a href="%(chromeLink)s">Chrome</a>, <a href="%(firefoxLink)s">Firefox</a>, or <a href="%(safariLink)s">Safari</a>'),{chromeLink:(0,i.BN)("https://www.google.com/chrome/"),firefoxLink:(0,i.BN)("https://www.mozilla.org/firefox/"),safariLink:(0,i.BN)("https://support.apple.com/downloads/safari/")},!0)},addTFANotification:function(){return l(s('Add an extra layer of protection to your account by setting up 2-Step Verification at the <a href="%(link)s">Security Center</a>'),{link:(0,i.BN)("/security/")},!0)},camAndMicPermissionSupportInfo:function(){return l(s("Visit our <a class='hrefColor' id='camAndMicInfoLink' target='_blank' href='%(link)s'>support page</a> for help enabling your devices."),{link:(0,i.BN)("https://support.chaturbate.com/hc/en-us/articles/360040862791/")},!0)},floatingPlayerMenuBubbleText:function(){return l(s('<p style="margin: 0px; display: inline">To disable, go to </p><a href="%(link)s">Options</a><p style="margin: 0px; display: inline"> on the homepage and uncheck "Enable floating player".</p>'),{link:(0,i.BN)("/?advanced_options=1")},!0)},signUpToUseFeature:function(){return l(s('<a href="%(link)s">Sign up</a> to use this feature.'),{link:(0,i.BN)("/accounts/register/")},!0)},enableAgeVerificationToReceiveTokens:function(){return l(s('You must <a class="hrefColor" target="_blank" href="%(link)s"> submit age verification </a> to enable the ability to receive tokens while broadcasting.'),{link:(0,i.BN)("/accounts/age_verification/")},!0)},mustBeAgeVerifiedToAddSocialMedia:function(){return l(s('You must be <a href="%(link)s">age verified</a> to add new social media'),{link:(0,i.BN)("/accounts/age_verification/")},!0)},mustBeAgeVerifiedToUploadContent:function(){return l(s('You must purchase tokens or be <a href="%(link)s">age verified</a> to add new photos and videos'),{link:(0,i.BN)("/accounts/age_verification/")},!0)},inactiveGuestNotice:function(){return l(s('One of your linked Guests has become inactive. <a href="%(link)s">Review your Guests</a> now.'),{link:(0,i.BN)("/accounts/age_verification/")},!0)},visitMobileSiteOrFeedback:function(){return l(s('Visit the <a href="%(link)s" style="color: #0a5a83;">mobile site</a>  again, or give us some <a style="color: #0a5a83;">feedback</a> on why you left'),{link:(0,i.BN)("https://m.chaturbate.com/mobile/")},!0)},ageVerifiedBody2:function(){return l(s('To age verify another person on your account, submit their ID at the <a href="%(link)s" target="_blank" style="white-space: nowrap;">Independent Broadcaster Verification</a> page'),{link:(0,i.BN)("/identity/")},!0)},roomFilteredByHashtag:function(e){return l(s("Rooms filtered by #%(hashtag)s "),{hashtag:e},!0)},categoryDescriptionPrivate:function(e){return l(s("Spy on private shows to experience the most exclusive shows on %(siteName)s. You won't get to interact, but it's much cheaper than buying a private show yourself."),{siteName:e},!0)},seconds:function(e){return l(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?s("%(seconds)s sec"):a("%(seconds)s second","%(seconds)s seconds",e),{seconds:e},!0)},secondsAgo:function(e){return l(a("%(seconds)s second ago","%(seconds)s seconds ago",e),{seconds:e},!0)},secondsFromNow:function(e){return l(a("%(seconds)s second from now","%(seconds)s seconds from now",e),{seconds:e},!0)},minutes:function(e){return l(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?a("%(minutes)s min","%(minutes)s mins",e):a("%(minutes)s minute","%(minutes)s minutes",e),{minutes:e},!0)},minutesAgo:function(e){return l(a("%(minutes)s minute ago","%(minutes)s minutes ago",e),{minutes:e},!0)},minutesFromNow:function(e){return l(a("%(minutes)s minute from now","%(minutes)s minutes from now",e),{minutes:e},!0)},hours:function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){var t=e.toFixed(1);return l(a("%(hours)s hr","%(hours)s hrs",t),{hours:t},!0)}return l(a("%(hours)s hour ago","%(hours)s hours ago",e),{hours:e},!0)},hoursAgo:function(e){return l(a("%(hours)s hour ago","%(hours)s hours ago",e),{hours:e},!0)},hoursFromNow:function(e){return l(a("%(hours)s hour from now","%(hours)s hours from now",e),{hours:e},!0)},days:function(e){return l(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?a("%(days)s d","%(days)s d",e):a("%(days)s day","%(days)s days",e),{days:e},!0)},daysAgo:function(e){return l(a("%(days)s day ago","%(days)s days ago",e),{days:e},!0)},daysFromNow:function(e){return l(a("%(days)s day from now","%(days)s days from now",e),{days:e},!0)},weeks:function(e){return l(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?a("%(weeks)s wk","%(weeks)s wks",e):a("%(weeks)s week","%(weeks)s weeks",e),{weeks:e},!0)},weeksAgo:function(e){return l(a("%(weeks)s week ago","%(weeks)s weeks ago",e),{weeks:e},!0)},weeksFromNow:function(e){return l(a("%(weeks)s week from now","%(weeks)s weeks from now",e),{weeks:e},!0)},months:function(e){return l(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?a("%(months)s mo","%(months)s mos",e):a("%(months)s month","%(months)s months",e),{months:e},!0)},monthsAgo:function(e){return l(a("%(months)s month ago","%(months)s months ago",e),{months:e},!0)},monthsFromNow:function(e){return l(a("%(months)s month from now","%(months)s months from now",e),{months:e},!0)},years:function(e){return l(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?a("%(years)s yr","%(years)s yrs",e):a("%(years)s year","%(years)s years",e),{years:e},!0)},yearsAgo:function(e){return l(a("%(years)s year ago","%(years)s years ago",e),{years:e},!0)},yearsFromNow:function(e){return l(a("%(years)s year from now","%(years)s years from now",e),{years:e},!0)},sendPmCAPS:s("SEND PM"),sendDmCAPS:s("SEND DM"),pmMenuTitle:s("Send PM"),dmMenuTitle:s("Send DM"),pmSupporterNotice:s("You must be a supporter, fan club member, or moderator to send this private message."),pmSupporterNoticeAgeVerified:s("You must be a supporter, fan club member, moderator, or have received a tip today from this user to send this private message."),dmSupporterNotice:s("You must be a supporter, fan club member, or moderator to send this direct message."),dmSupporterNoticeAgeVerified:s("You must be a supporter, fan club member, moderator, or have received a tip in the past week from this user to send this direct message."),pmSupporterSignUp:s("Sign up for a"),pmSupporterMembership:s("Supporter Membership"),newPrivateMessageClickPrompt:s(" (<a class='msg-link underline-link' style='cursor:pointer'>open conversation</a> or press TAB to cycle through)"),openConversationLower:s("open conversation"),joinChaturbateCommunity:s("Join Chaturbate's community."),roomSignupPopupText:s("Chat live, follow broadcasters, access private shows, or earn money!"),roomSignupPopupSignupText:s("Sign Up Free"),chatColor:s("Chat Color"),fontFamily:s("Font Family"),fontSize:s("Font Size"),showEmoticons:s("Show Emoticons"),emoticonAutoCompleteDelay:s("Autocomplete Delay"),sortUsers:s("Sort Users"),highestTokenColor:s("Highest Token Color"),chatAllowedBy:s("Chat Allowed By"),moderatorsExpireAfter:s("Moderators Expire After"),silenceOtherBroadcasters:s("Silence Other Age-Verified Broadcasters"),yesAlways:s("Yes, Always"),preventC2CRedisplay:s("Cam to Cam Notification Rate Limit"),noLimit:s("No Limit"),fiveMinutes:s("Once per User Every 5 Minutes"),forever:s("Once per User Until You View Their Cam"),tipVolume:s("Tip Volume"),viewEditIgnoredUsers:s("View/Edit Ignored Users"),tagLine:s("THE ACT OF MASTURBATING WHILE CHATTING ONLINE"),chatRoomsCAPS:s("CHAT ROOMS"),broadcastYourselfCAPS:"BROADCAST YOURSELF",betaCAPS:s("BETA"),tagsCAPS:s("TAGS"),myCollectionCAPS:s("MY COLLECTION"),myCollectionText:s("My Collection"),loginVerbText:s("Log in"),loginVerbCapitalized:s("Log In"),signUpText:s("Sign Up"),signUpInContentText_InCntntSUp:s("Sign up and send message now"),signUpToSendMessageText_InCntntSUp:s("Send Your Message Now by Creating a Free Account"),mustBe18Text_InCntntSUp:s("You must be over 18 years old to register."),completeYourProfile_InCntntSUp:s("Complete Your Profile"),backToCBRegister_InCntntSUp:s("Back to Chaturbate Register"),emailDisclosure_InCntntSUp:s("Email addresses, when provided, are only used for friend notifications, broadcast and payout reminders, newsletter, and account verification. Your email address is never sold or shared."),signUpLower:s("Sign up"),defaultTipMessageLabel:s("Include an optional message:"),TipOptionalMessageLabel:s("Optional message:"),sendTipButtonText:s("Send Tip"),sendTipButtonCAPS:s("SEND TIP"),sendTipText:s("Send a tip"),sendTipToBroadcasterText:s("Send tip to broadcaster"),publicTippingText:s("Public Tipping"),publicTippingDesc:s("Username is visible to all users."),anonTippingText:s("Anonymous Tipping"),anonTippingDesc:s("Username only visible to broadcaster."),anonButtonText:s("Send Anonymous Tip"),sending:s("Sending..."),anonTipDisabledModalCont:s("Click OK to continue to supporter signup."),mobileTipMessageLabelLandscape:s("Include optional message"),mobileTipMessageLabelPortrait:s("Tip note..."),mobileChatLabel:s("Tap to chat..."),broadcasterDoesNotAcceptTips:s("This broadcaster doesn't accept tips."),purchaseTokensText:s("Purchase Tokens"),myProfileTextLc:s("My Profile"),liveChatSupportTextLc:s("Live Chat Support"),logOutTextLc:s("Log Out"),logoutModalText:s("Are you sure you want to log out?"),sendFeedbackTextLc:s("Send Feedback"),statusText:s("Status"),tokensLabel:s("You have:"),getMoreTokensLabel:s("Get more tokens"),getMoreTokensTitled:s("Get More Tokens"),chatDisconnectedMessage:s("Chat disconnected. The broadcaster has set a new password on this room."),privateText:s("Private"),privateShowStartLabel:s("Start Private Show"),privateShowSpyLabel:s("Spy on Private Show"),privateShowStartedMessage:s("Private show has started."),privateShowFinishedMessage:s("Private show has finished."),privateShowDeclinedMessage:s("Private show has been declined."),privateShowRequestLabel:s("Request Private Show"),privateShowCancelRequestLabel:s("Cancel Private Show Request"),privateShowRequestCancelMessage:s("Cancel Private Request"),privateShowRequestCancelErrorMessage:s("Cannot cancel private show. Please try again in a few seconds."),privateShowLeaveLabel:s("Leave Private Show"),privateShowLeaveWarning:s("Are you sure you want to leave the private show?"),privateShowRequestMessage:s("Private show request has been sent. Waiting on broadcaster to approve."),requestPrivate:s("Request Private"),cancelRequest:s("Cancel Request"),leavePrivate:s("Leave Private"),spyOnPrivate:s("Spy on Private"),returnFromAwayModeMessage:s("Broadcaster has returned from away mode."),rejoinedRoomKickedMessage:s("You were disconnected because you have joined this room again."),kickedFromRoomMessage:s("The broadcaster has kicked you from the room."),kickedMessage:s("You were kicked from the room."),signUpToChatText:s("signup to chat"),aboutMeText:s("About Me"),wishListText:s("Wish List"),purchasedCAPS:s("PURCHASED"),orCAPS:s("OR"),photosAndVideosText:s("Photos and Videos"),realNameText:s("Real Name"),followersText:s("Followers"),sexText:s("I am"),sexTextCouple:s("We are"),birthdayText:s("Birthday"),birthdateText:s("Birth Date"),ageText:s("Age"),dateText:s("Date"),actionText:s("Action"),bodyTypeText:s("Body Type"),bodyDecorationsText:s("Body Decorations"),interstedInText:s("Interested In"),locationText:s("Location"),languagesText:s("Language(s)"),lastBroadcastText:s("Last Broadcast"),langaugesSpokenText:s("Languages"),smokeDrinkText:s("Smoke Drink"),smokeOrDrinkText:s("Smoke / Drink"),bioUnavailableText:s("User has no available BIO"),bioAndFreeWebCamText:s("Bio and Free Webcam"),errorSubmitting:s("Unable to submit"),submittingText:s("Submitting..."),loadingText:s("Loading"),loadingTextLower:s("loading"),chatSettings:s("Chat Settings"),chatSettingsTabHandleText:s("SETTINGS"),chatSettingsTabHandleTextCapitalized:s("Settings"),chatSettingsSavedText:s("Chat settings saved"),chatCAPS:s("CHAT"),sendCAPS:s("SEND"),sendText:s("Send"),tipCAPS:s("TIP"),tipText:s("Tip"),usersText:s("Users"),usersCAPS:s("USERS"),aUser:s("a user"),reportAbuseText:s("Report Room"),reportAbuseCAPS:s("REPORT ROOM"),reportAbuseTextTerms:s("Your room report will be reviewed as soon as practicable."),roomText:s("Room"),moreRoomsText:s("More Rooms"),spyPrivateShowLower:s("spy private show"),unfollowText:s("Unfollow"),unfollowLower:s("unfollow"),followText:s("Follow"),notifyMe:s("Notify me"),notifyOptionAlways:s("Always"),notifyOptionAuto:s("Auto"),never:s("Never"),refreshRoomsText:s("Refresh Rooms"),womenText:s("Women"),womenCAPS:s("WOMEN"),womenLower:s("women"),femaleText:s("Female"),menText:s("Men"),menCAPS:s("MEN"),menLower:s("men"),maleText:s("Male"),transText:s("Trans"),transCAPS:s("TRANS"),couplesText:s("Couples"),couplesCAPS:s("COUPLES"),couplesLower:s("couples"),coupleText:s("Couple"),saveCAPS:s("SAVE"),saveText:s("Save"),recentlyUsedEmojis:s("Recently used"),smileysPeopleEmojis:s("Smileys & People"),animalsNatureEmojis:s("Animals & Nature"),foodDrinkEmojis:s("Food & Drink"),activitiesEmojis:s("Activities"),travelPlacesEmojis:s("Travel & Places"),objectsEmojis:s("Objects"),symbolsEmojis:s("Symbols"),flagsEmojis:s("Flags"),uploadEmoticonsText:s("Upload"),tone:s("Tone"),currentBalanceText:s("Your current balance:"),balanceText:s("Balance:"),tokenBalanceText:s("Token Balance"),currentHaveText:s("You currently have: "),satisfactionWarningText:s("WARNING: This room has a low satisfaction rating."),tipWarningText:s("TIP AT YOUR OWN RISK!"),tipAmountText:s("Enter tip amount:"),tipAmountInvalid:s("Invalid tip amount!"),amountText:s("Amount:"),toggleWindowMessage:s("Toggle this window with Ctrl+S"),leaveOpenCheckBoxLabel:s("Leave open after tipping"),selectOneLabel:s("Select One"),selectReason:s("Please select a reason"),loadingUserListText:s("Loading user list"),refreshUserListText:s("refresh userlist"),refreshUserListSentenceCase:s("Refresh userlist"),errorRefreshingUserList:s("Error refreshing user list. Please try again later."),sendAMessage:s("Send a message"),sendAMessageDesktop:s("Send a message..."),sendPrivateMessageText:s("Send private message"),sendDirectMessageText:s("Send direct message"),loggedInToPm:s('You must be logged in to send a private message. Click "OK" to login.'),loggedInToDm:s('You must be logged in to send a direct message. Click "OK" to login.'),mentionUserText:s("Mention this user"),hideAdsText:s("HIDE ALL ADS NOW"),exoticAdsText:s("Powered by ExoticAds<br>Buy/Sell Traffic"),showMoreText:s("Show More"),picsAndVideosText:s("Pics & Videos"),picsText:s("Pictures"),vidsText:s("Videos"),socialMediaText:s("Social Media"),appsAndBots:s("Apps & Bots"),appsTabDescription:s("Add features like <strong>Tip Menus</strong>, <strong>Ticket Shows</strong>, and <strong>Top Tippers</strong> to your room with apps!"),v2AppsDescription:s("v2 Apps can keep track of your top visitors and tippers across multiple broadcasts."),aspText:s("New in v2 Apps: support for permanent storage, high traffic rooms and more to come soon."),newCapitalized:s("New"),apps:s("Apps"),games:s("Games"),dismissMessage:s("dismiss this message"),hashtagWarning:s("Only 5 #hashtags will be applied"),dismissLower:s("dismiss"),registerLaterText:s("Register later"),alreadyRegisteredText:s("Already have an account?"),loginHereText:s("Login here"),signInText:s("Please sign in using the form below"),usernameText:s("Username"),passwordText:s("Password"),captchaText:s("Prove you are human"),keepLoggedInText:s("Keep me logged in"),forgotPassword:s("Forgot password?"),incorrectPassword:s("Incorrect password"),incorrectCaptcha:s("Incorrect captcha"),createFreeAccount:s("Create Free Account"),improvedMobileSite:s("We've improved Chaturbate's mobile site by adding these feature(s):"),satisfactionVoting:s("Satisfaction Voting"),orText:s("Or "),orLower:s("or"),theMobileSiteText:s("the mobile site"),followerBrowserNotifications:s("Follower browser notifications"),allowBrowserNotificationsMessage:s("Would you like to receive browser notifications when a broadcaster you follow comes online?"),followSubscribeFailedMessage:s("Subscription failure. Please try again from the Settings & Privacy page on your profile."),yesText:s("Yes"),notNowText:s("Not now"),roomRequiresPasswordText:s("This room requires a password."),loginToRoom:s("Login to room"),moderators:s("Moderators"),removeModerators:s("Remove Moderators"),nonModerators:s("Non-Moderators"),removeIgnoredUsers:s("Remove Ignored Users"),unignoreThisUserText:s("Unignore this user"),unignoredUsers:s("Unignored Users"),ignore:s("Ignore"),ignoreThisUserText:s("Ignore this user"),reportThisMessageText:s("Report this message"),ignoredUsers:s("Ignored Users"),clickToUnignoreText:s("Click on a user to unignore them."),clickToUnignoreMobileText:s("Select a user from the list to unignore them."),clickToUnmodText:s("Click on a user to revoke their moderator status."),clickOkToLogin:s('Click "OK" to login.'),loginForIgnore:s("You must be logged in to ignore a user"),reachedMaxIgnore:s("You have reached the maximum number of ignored users. Ignoring a new user when at the limit will remove your oldest ignore. Click OK to continue"),roomOfflineMessage:s("Room is currently offline"),instantNotificationMessage:s("Follow broadcasters to receive instant notifications when they come online."),unfollow:s("UNFOLLOW"),follow:s("FOLLOW"),followed:s("FOLLOWED"),shareText:s("Share"),bioText:s("Bio"),contestStatsText:s("Contest Stats"),settingsAndPrivacy:s("Settings & Privacy"),settingsSaved:s("Settings saved"),tokenStats:s("Token Stats"),broadcasterStats:s("Broadcaster Stats"),memberships:s("Memberships"),submitYourFeedbackText:s("Submit feedback to broadcaster"),optionalCommentNote:s("Optional comment for broadcaster:"),commentSubmittedMessage:s("Submitted"),satisfiedTextCAPS:s("SATISFIED?"),satisfiedText:s("Satisfied?"),scanCamsText:s("SCAN CAMS"),nextCamText:s("NEXT CAM"),scanNextText:s("SCAN / NEXT"),scanText:s("SCAN"),skipCamText:s("SKIP CAM"),exitScanningText:s("EXIT SCANNING"),tokenLinkCodesText:s("Token Linkcodes"),earnTokensForRegisteredUsers:s("Earn up to 10 tokens for every registered user and 500 tokens for users who broadcast (broadcasters must earn $20.00 before they qualify)."),linkCodeMessage:s("Please send to chaturbate using one of the link codes below."),embedCBTopCamText:s("Embed Chaturbate's Top Cam on Your Webpage"),affiliateProgramStatsText:s("the affiliate program stats"),affiliateStatsDetails:s("See details about tokens earned in "),silenceText:s("Silence"),silenceDurationMessage:s("Silence for 6 hours"),removeSilenceMessage:s("Remove Silence"),theaterModeLabel:s("Theater Mode"),fullScreenLabel:s("Full Screen"),exitFullScreenLabel:s("Exit Full Screen"),splitModeLabel:s("Split Mode"),unknownText:s("unknown"),showAllText:s("Show All"),anonFollowMore:s(" to follow your favorite broadcasters and see when they are live."),userFollowMore:s("Follow your favorite broadcasters to see when they are live."),userPromotionToolbarOpenBodyButton:s("Promote your room"),userPromotionNotEnoughTokensText:s("Not enough tokens."),userPromotionPurchaseTokensText:s("Purchase more tokens"),userPromotionIneligibleText:s("You are no longer eligible to promote your room."),userPromotionBadSettingsText:s("User promotion currently unavailable - please check your settings."),userPromotionMustBeLoggedInAlert:s("You must be logged in to promote your room."),userPromotionMustBeOnlineAlert:s("You must be broadcasting to promote your room."),userPromotionBodyHeadline:s("Get More Viewers"),userPromotionBodyDescription:s("Add your room to a rotating promoted spot on the homepage for 5 minutes."),userPromotionDetails:s("details"),userPromotionSubmit:s("Promote now"),userPromotionSubmitInProgress:s("In Progress"),userPromotionTokensLink:s("Get more tokens"),userPromotionCurrentPriceLabel:s("Current price"),userPromotionSettingUp:s("Setting up user promotion..."),userPromotionEnding:s("Promotion ending..."),userPromotionPriceUnknownException:s("Unknown error occurred while retrieving promotion purchase price. Please try again."),userPromotionSubmitUnknownException:s("Unknown error occurred while purchasing user promotion. Please try again."),userPromotionLoadingNewPriceText:s("Loading new pricing..."),broadcastNotificationTopBarOpenBodyButton:s("Announce you're online"),broadcastNotificationTopBarCooldownText:s("Announce again in "),broadcastNotificationTopBarFollowerTextSingularOld:s("You have 1 follower"),broadcastNotificationImageContainerHeadline:s("Send email and browser notifications to your followers."),broadcastNotificationUploadLink:s("Add a photo"),broadcastNotificationUploadLinkReplace:s("Update photo"),broadcastNotificationImageHint1:s("Must be non-nude"),broadcastNotificationImageHint2:s("Recommended size: 1280 x 720 px"),broadcastNotificationImageHint3:s("Shown in notification and featured emails"),broadcastNotificationButtonSendNotification:s("Send notifications"),broadcastNotificationButtonSendNotificationInProgress:s("In Progress"),broadcastNotificationTooltip:s("New photos must be approved. If not approved in 15 minutes, email notifications will be sent without a photo."),broadcastNotificationTopBarOpenBodyLinkTooltip:s("You have no followers to notify."),broadcastNotificationConfirmSendWithoutImage:s("Are you sure you want to notify your followers without an image?"),broadcastNotificationUseApprovedFormat:s("Please use a jpeg, gif, or png image."),broadcastNotificationImageTooLarge:s("Image must not be larger than 10 megabytes."),broadcastNotificationAlreadySent:s("A notification has already been sent."),broadcastNotificationErrorProcessing:s("Something went wrong processing your image. Please try again."),broadcastNotificationErrorAfterSubmit:s("Something went wrong after submit. Please try again."),broadcastNotificationErrorDuringSubmit:s("Something went wrong during submit. Please try again."),broadcastNotificationTooSmallDimensions:s("Image must be at least 200px wide and 200px tall."),broadcastNotificationTooWide:s("Image is too wide."),broadcastNotificationTooTall:s("Image is too tall."),broadcastNotificationRemoveWhileInProgress:s("Please wait until all pending notifications have been sent."),broadcastNotificationRemoveApprovedPhoto:s("Remove approved photo?"),broadcastNotificationBadBrowserNotice:s("Sorry, this feature is not supported in your browser. Please upgrade to a modern browser like Chrome or Firefox."),close:s("Close"),closeWindow:s("Close Window"),cancelText:s("Cancel"),cancelLower:s("cancel"),cancelCAPS:s("CANCEL"),submitCAPS:s("SUBMIT"),submitText:s("Submit"),warnOnClosingDirty:s("You have unsaved changes, are you sure you want to leave this page?"),chooseCategoryText:s("Choose a category"),reportAbuse:s("Report Room"),reportAbuseCatUnderage:s("Broadcaster is underage"),reportAbuseCatAdvertising:s("Broadcaster is advertising"),reportAbuseCatAbusive:s("Broadcaster is abusive"),reportAbuseCatIntoxicated:s("Broadcaster is intoxicated"),reportAbuseCatLarge:s("Using a toy that is too large"),reportAbuseCatOffline:s("Asking for offline payments"),reportAbuseCatPublic:s("Broadcasting in public"),reportAbuseCatUniform:s("Broadcasting in service uniform"),reportAbuseCatSleeping:s("Broadcaster is sleeping"),reportAbuseCatGender:s("Broadcaster is wrong gender"),reportAbuseCatOther:s("Other"),reportAbuseCategoryRequired:s("Please choose a category"),reportAbuseAdditionalComments:s("Additional comments:"),reportAbuseDescriptionRequired:s("Please add a description"),reportMessageInappropriate:s("Message is inappropriate"),reportMessageRudeToBcaster:s("Message is rude towards the broadcaster"),reportMessageRude:s("Message is rude"),reportMessageSpam:s("Message is spam"),reportMessageOffensiveMedia:s("Media is offensive"),reportMessageOther:s("Other (please describe):"),report:s("Report"),reportCAPS:s("REPORT"),unableToReport:s("Unable to send report."),tooManyReports:s("Too many reports sent. Try slowing down."),errorRequestingPrivateShow:s("There was an error requesting your private show. Please try again."),errorRequestingSpyShow:s("There was an error requesting your spy show. Please try again."),unableToCancelSpyShow:s("Unable to cancel spy show"),unableToCancelPrivateRequest:s("Unable to cancel private request"),privateShows:s("Private Shows"),areYouSure:s("Are you sure?"),broadcasterAllowsRecordingsText:s("This broadcaster allows private show recordings, so you will receive a recorded video of this show in your collection."),broadcasterAwayDescription:s("You may continue chatting while you wait for the broadcaster to return."),performerIsAwayText:s("Performer Is Away"),groupShowText:s("Group Show"),privateShowLeaveLabelCAPS:s("LEAVE PRIVATE SHOW"),privateShowRequestCancelMessageCAPS:s("CANCEL PRIVATE REQUEST"),privateShowStartLabelCAPS:s("START PRIVATE SHOW"),privateShowSpyLabelCAPS:s("SPY PRIVATE SHOW"),privateShowSpyLeaveLabelCaps:s("LEAVE SPY SHOW"),privateShowText:s("Private Show"),privateShowsCAPS:s("PRIVATE SHOWS"),privateShowInProgressText:s("Private Show in Progress"),featureNotEnabled:s("This feature is not currently enabled on your device."),loginForPrivateShow:s('You must be logged in to enter a private show. Click "OK" to login.'),loginForPrivateShowSpy:s('You must be logged in to spy on a private show. Click "OK" to login.'),privateShowSpyDisabled:s("Spy has been disabled by the broadcaster."),moreRoomsLikeThisText:s("More Rooms Like This"),trendingRoomsInstead:s("Here are some trending rooms instead:"),promotedCAPS:s("PROMOTED"),recommendedCAPS:s("RECOMMENDED"),recommendedPopularCAPS:s("RECOMMENDED POPULAR"),offlineCAPS:s("OFFLINE"),exhibitionistCAPS:s("EXHIBITIONIST"),newCAPS:s("NEW"),hdCAPS:s("HD"),hdPlusCAPS:s("HD+"),inPrivateCAPS:s("IN PRIVATE"),gamingCAPS:s("GAMING"),chaturbatingCAPS:s("CHATURBATING"),broadcastingCAPS:s("BROADCASTING"),hiddenStaffOnlyTextCAPS:s("HIDDEN - STAFF ONLY"),viewOnTwitterText:s("View on Twitter"),showTipsAndMessages:s("Show tips and messages"),viewPhotosVideos:s("View Pics and Videos"),seeMore:s("See more"),howCanWeImproveText:s("How Can We Improve?"),updatesText:s("Updates"),photoVideoUpdatesText:s("Pics & Vids"),noPicsVideos:s("This user has not added any photos or videos yet."),noPics:s("This user has not added any photos yet."),noVideos:s("This user has not added any videos yet."),morePics:s("More Pics"),moreVideos:s("More Videos"),morePicsVideos:s("More Pics & Videos"),fanTextCAPS:s("FAN"),clubTextCAPS:s("CLUB"),tokensCC:s("Tokens"),uploadedText:s("Uploaded"),purchasedPhotoSet:s("If you already purchased this photo set, try reloading the page to view it."),purchasedVideo:s("If you already purchased this video, try reloading the page to view it."),orSimple:s("or"),hiResImage:s("View Hi-Res Image"),loggedInToPurchasePhoto:s('You must be logged in to purchase this photo set.  Click "OK" to login.'),loggedInToViewHiRes:s('You must be logged in to view hi-res images.  Click "OK" to login.'),loggedInToPurchaseVideo:s('You must be logged in to purchase this video.  Click "OK" to login.'),okToGetTokens:s('Click "OK" to get more tokens.'),pressPurchaseTokens:s('Press "Purchase Tokens" to get more.'),uploadMorePhotosText:s("Upload more Photos"),reOrderItemsText:s("Re-Order Items"),changeVideoThumbnailText:s("Change video thumbnail image"),editDetailsText:s("Edit Details"),complianceText:s("Compliance"),deactivateText:s("Deactivate"),staffCAPS:s("STAFF"),audioDisabledText:s("Audio is disabled."),audioRemovedText:s("Audio muted to remove music"),failedCAPS:s("FAILED"),pendingCAPS:s("PENDING"),approvalCAPS:s("APPROVAL"),videoCAPS:s("VIDEO"),processingCAPS:s("PROCESSING"),errorCAPS:s("ERROR"),failedApprovalText:s("Failed Approval"),removeOffendingItemsText:s("Please delete or edit offending items."),openInNewWindowText:s("Open in new window"),ipadFailedToSetup:s("iPad has failed to setup the broadcast. Please try again."),poorBroadcast:s("Please check your internet connection or close other applications"),noCameraFound:s("No camera found."),camAndMicPermissionPrompt:s('We need permission to use your camera and microphone in order to proceed. When prompted by the browser, please click "Allow."'),camAndMicPermissionPromptFF:s('We need permission to use your camera and microphone in order to proceed. When prompted by the browser, please check "Remember this decision" and click "Allow."'),camAndMicPermissionDenied:s("Permissions to use your camera and microphone are currently denied."),needCamAndMicPermission:s("We need permission to use your camera and microphone in order to proceed."),permanentPermsMessage:s('We need permanent permission to use your camera and microphone. Remember to check "Remember this decision" when granting permission.'),requestDevicePermissions:s("Request Device Permissions"),resolutionNotSupported:s("The resolution is not supported by your device."),minResolutionNotSupported:s("Your device does not support the minimum resolution."),unknownDeviceError:s("Your device does not support the minimum resolution."),supportPage:s("support page"),noOtherTabsOpen:s("Make sure there are no other broadcast tabs open."),lowFPS:s("Low FPS"),wantToLeaveConfirmation:s("Are you sure you want to leave?"),wentToAway:s('This private show has ended. To give you\ntime to prepare, you are now shown as "Away" to\nthose in your room. To return and be visible on\ncam, click "Exit Away Mode" below.'),exitAwayMode:s("Exit Away Mode"),couldNotGetDevices:s("Could not get devices"),turnDevice180:s("Turn your device 180 degrees."),turnDeviceLandscape:s("Turn your device into landscape mode."),cameraLabel:s("Camera"),resolutionLabel:s("Resolution"),microphoneLabel:s("Microphone"),inputLevelLabel:s("Input Level"),muteLabel:s("Mute"),noMicrophone:s("None (Silent)"),startBroadcasting:s("Start Broadcasting"),stopBroadcasting:s("Stop Broadcasting"),youAreAway:s("You Are Away"),highQualityStream:s("For high quality streams we strongly recommend"),useOBS:s("Use external software (OBS)"),pleaseWaitConnecting:s("Please wait. Connecting in"),couldNotStartBroadcast:s("Could not start broadcast"),welcomeBack:s("Welcome back"),couldNotSetupPreview:s("Could not setup preview. Please make any possible adjustments and reload the page"),couldNotSetupBroadcast:s("Could not setup broadcast"),showMyCamPreviewTitle:s("My Cam Preview"),showMyCamShow:s("Cam To Cam"),showMyCamStop:s("Stop Cam To Cam"),showMyCamAlreadyBroadcasting:s("Unable to share cam: You are already broadcasting from another window or tab"),showMyCamPreviewInfo2:s("The cam icon will turn orange when the broadcaster is viewing you."),showMyCamBroadcastError:s("Error sharing cam"),showMyCamBroadcastTimeoutError:s("Error sharing cam: Timed out trying to connect"),showMyCamCouldNotView:s("Error viewing cam"),showMyCamMustBeConnected:s("Unable to share cam: Make sure you are connected to chat and the broadcast is playing"),showMyCamMayNotShareIsPrivate:s("Unable to share cam: Broadcaster is in a private show"),showMyCamMayNotShare:s("You are not allowed to share your cam with this user"),showMyCamMayNotShareUpsell:s("Sharing your cam is only available to users who have purchased tokens. Click OK to purchase tokens now."),showMyCamWillRemovePassword:s("Sharing your cam will remove your room password"),showMyCamSharingPrefix:s("Viewer "),showMyCamStartedSharing:s(" started sharing their cam"),showMyCamStoppedSharing:s(" stopped sharing their cam"),showMyCamStartedViewing:s(" started viewing your cam"),showMyCamStoppedViewing:s(" stopped viewing your cam"),showMyCamIsViewing:s("is currently viewing your cam"),showMyCamNotViewing:s("is not currently viewing your cam"),showMyCamMuted:s("Muted"),showMyCamCloseCam:s("Close Cam"),showMyCamBlockCam:s("Block Cam"),showMyCamPopoutCam:s("Pop Out Cam"),showMyCamReportCam:s("Report Cam"),showMyCamReportPublic:s("User is broadcasting in public"),showMyCamReportRude:s("User is rude/abusive"),showMyCamReportIntoxicated:s("User is intoxicated"),showMyCamReportSleeping:s("User is sleeping"),showMyCamReportSpamming:s("User is spamming"),showMyCamReportUnderage:s("User is underage"),showMyCamMyCam:s("My Cam"),showMyCamView:s("View Cam"),showMyCamStopView:s("Stop Viewing Cam"),showMyCamTooManyCams:s("Unable to view cam: A maximum of five cams can be viewed at once"),showMyCamCamOffline:s("Unable to view cam: This viewer is no longer sharing their cam"),showMyCamNavigationPrompt:s("Leaving this page will end your cam. Click OK to proceed."),showMyCamConnectionClosed:s("(connection closed)"),broadcaster:s("Broadcaster"),moderator:s("Moderator"),fanclubMember:s("Fan club member"),user:s("User"),roomJoinedMessage:s("has joined the room"),roomLeftMessage:s("has left the room."),roomFollowToGetNotified:s("Follow to be notified when online."),feedbackCommentsLabel:s("Describe your issue or share your ideas:"),feedbackNotice:s("Some account and system information may be sent to %SITE_NAME%. We will use the information you give us to help address technical issues to improve our services, subject to our Privacy Policy and Terms of Service."),feedbackSubmit:s("Send feedback"),feedbackAddScreenshot:s("Add screenshot"),feedbackAddScreenshotInfoScrollDown:s("Scroll down to capture lower on the page"),feedbackAddScreenshotInfoScrollUp:s("Scroll up to capture higher on the page"),feedbackCanvasToggle:s("Click to highlight or hide info"),feedbackHighlightInfo:s("Highlight issues with orange or hide sensitive info with black. Hit the ESC key to finish."),feedbackHighlightControl:s("Highlight issue"),feedbackHideControl:s("Hide sensitive info"),feedbackPermissionDenied:s("Permission to capture screen not granted"),feedbackUnknownCaptureError:s("Could not capture screen"),feedbackResize:s("Please take screenshot again after resizing"),feedbackSubmitted:s("Your feedback has been sent! Thank you for your feedback."),feedbackUnknownError:s("Something went wrong. Please try again later."),feedbackRateLimitError:s("Please wait before submitting more feedback."),feedbackBannedUser:s("Unable to submit feedback. Please contact support."),doneText:s("Done"),watchingText:s("Watching"),denyPrivate:s("Deny Private"),acceptPrivate:s("Accept Private"),returnToChat:s("Return to Chat"),returnToPublicChat:s("Return to Public Chat"),privateShowEnded:s("Your private show has ended."),cameraRemainHidden:s("Your camera will remain hidden until you re-enter public chat."),aboutToStopGroupShow:s("You're about to stop the group show. Do you want to continue?"),aboutToStopPrivateShow:s("You're about to stop the private show. Do you want to continue?"),errorBroadcasting:s("Error broadcasting"),fontSettings:s("Font Settings"),emoticonsSettings:s("Emoticons Settings"),usersSettings:s("Users Settings"),notificationsSettings:s("Notifications Settings"),otherSettings:s("Other Settings"),noOneIgnored:s("You have no users ignored."),backToSettings:s("Back to Settings"),backToChatSettings:s("Back to Chat Settings"),notifyEntryFor:s("Notify on Entry For"),notifyLeaveFor:s("Notify on Leave For"),noNewUpdates:s("No new updates"),videoBeingProcessed:s("The video is currently being processed.  It may take several minutes depending on the size of the video."),videoProcessingError:s("The video is damaged or its format is not supported."),videoReupload:s("Please delete this video and reupload again."),mustBeSupporterFeature:s("You must be a supporter to use this feature."),loginToFollow:s('You must be logged in to Follow. Click "OK" to login.'),loginToUseFeature:s("Log in or sign up to use this feature"),loginToTip:s('You must be logged in to send a tip. Click "OK" to login.'),loginToContinue:s("Log in to continue"),dontHaveAccount:s("Don't have an account?"),dontHaveAccountYet:s("Don't have an account yet?"),tippedTonsRecently:s("Tipped Tons"),tippedTonsRecentlyDef:s("1000+ tokens in the past 2 weeks"),tippedALotRecently:s("Tipped Lots"),tippedALotRecentlyDef:s("250+ tokens in the past 2 weeks"),tippedRecently:s("Tipped Recently"),tippedRecentlyDef:s("50+ tokens in the past 2 weeks"),tippingLabel:s("Tipping"),hasTokens:s("Purchased Tokens"),hasTokensDef:s("Has bought tokens"),inFanClub:s("Fan Club Member"),isMod:s("Moderator"),isBroadcaster:s("Broadcaster"),upgradeToSupporterLabel:s("Upgrade to Supporter"),outboundTip:s("Outbound Tip"),tipFrom:s("Tip From"),transferTokensToCash:s("Transfer tokens to cash"),transferTokensToAdvertising:s("Transfer tokens to advertising credit"),referredMember:s("Referred Member"),adminAdjustment:s("Admin Adjustment"),hasBeenResolved:s("This has been resolved by an administrator"),email:s("email"),emailLabel:s("Email"),spyShow:s("Spy Show"),fanClubMembership:s("Fan Club Membership"),broadcasterWelcomeWarning:s("Broadcaster Rules: Tokens are the only form of payment allowed. You may promote your personal website as long as it does not offer video chat. Do not ask users to chat with you elsewhere."),viewerWelcomeWarning:s("Rules: No spamming. Do not insist the cam hosts to do as you please. Do not announce other rooms or websites that would conflict with this room. Avoid any argumentative and/or rude posts related to the cam viewing. Do not attempt to post your e-mail address in the public chat."),useExternalEncoder:s("Use External Encoder to Broadcast"),broadcastWithOBS:s("Broadcast yourself using Open Broadcaster Software (OBS)"),accept:s("Accept"),decline:s("Decline"),userTokenRate:s("User(s) Token Rate"),privateShowStats:s("Private Show Stats"),exitPrivateShow:s("Exit Private Show"),useAppsAndBots:s("Enhance your room with Apps & Bots in the tab below."),disabled:s("Disabled"),allowed:s("Allowed"),privates:s("Privates"),broadcastGuideTitle:s("Broadcaster's Guide"),myBroadcast:s("My Broadcast"),passwordProtectedWarning:s("Your room is password protected. Users may not enter your room unless they know your password. To remove your password, edit your settings & privacy."),kickBan:s("Kick/Ban"),removeModeratorStatus:s("Remove Moderator Status"),promoteToModerator:s("Promote to Moderator"),obsShareWarning:s("WARNING: Never show or share your broadcast token with anyone!"),yourBroadcastToken:s("Your broadcast token"),broadcastingInformation:s("RTMP/OBS Broadcasting Information"),clickToViewOBSSetupGuide:s("Click here to view our OBS Setup Guide"),importantInformation:s("Important Information"),doNotUpscale:s("Do not upscale your source input (e.g. using a 1080p camera to a 1440p stream)."),ensureMinimumBitrate:s("Ensure you use the minimum video bitrate specified in this table for a given resolution"),copyrightContentWarning:s("You may only have copyrighted content -- including music, movies, and video games -- in your stream if you are the rights holder or have the permission of all rights holders."),recommendedSettingsTable:s("Recommended Settings Table"),generateNewOBSTokenConfirm:s("Generate a new broadcast token? \n(This will invalidate your prior RTMP / OBS token and disconnect your current broadcast)"),thisIsSatisfactionScore:s('This is your satisfaction score. You can hide this by setting "Show my satisfaction score" to "No" in the Settings & Privacy tab.'),dataUpdatedOncePerDay:s("This data is updated once per day and is based on votes in the past 90 days."),clickScoreToSeeHistory:s("Click on your score (%) to view your rating history."),fetchingHistory:s("Fetching rating history"),noHistoryToShow:s("No history to show"),activeApp:s("Active App"),activeGame:s("Active Game"),bot1:s("Bot #1"),bot2:s("Bot #2"),bot3:s("Bot #3"),bot4:s("Bot #4"),bot5:s("Bot #5"),noneSelected:s("None Selected"),chooseAnApp:s("Choose an App"),chooseABot:s("Choose a Bot"),chooseAGame:s("Choose a Game"),endGame:s("End Game"),stopStreamingGame:s("Stop streaming game"),areYouAPublisher:s("Are you a publisher?"),addYourGameLink:s("Add your game."),restart:s("Restart"),addNewSocialMedia:s("Add new social media"),uploadNewPics:s("Upload new pics"),uploadNewVideos:s("Upload new videos"),editYourBio:s("Edit Your Bio"),currentContestStatistics:s("Current Contest Statistics for"),payoutInformation:s("Payout Information"),refreshStats:s("Refresh Stats"),seeContestDetails:s("See contest details"),managePhotoSet:s("Manage photo sets"),updateBio:s("Update Bio"),january:s("January"),february:s("February"),march:s("March"),april:s("April"),may:s("May"),june:s("June"),july:s("July"),august:s("August"),september:s("September"),october:s("October"),november:s("November"),december:s("December"),expiredFanClubMemberships:s("Expired Fan Club Memberships"),expiredSocialMediaSubscriptions:s("Expired Social Media Subscriptions"),noActiveMemberships:s("You Have No Active Memberships"),expires:s("Expires"),expired:s("Expired"),extendThreeMonths:s("Extend by 3 months"),renews:s("Renews"),renew:s("renew"),cantRenew:s("can't renew"),cantExtend:s("can't extend"),noEmailOnFile:s("No email address on file"),blockedCountries:s("Blocked countries"),ableToView:s("Able to view"),blockedRegions:s("Blocked regions"),security:s("Security"),statistics:s("Statistics"),updateSettings:s("Update Settings"),updateYourPassword:s("Update your password"),viewSecurityCenter:s("View the security center and adjust Two-Step Verification settings"),authorizeThirdPartyStats:s("Authorize your 3rd party stats"),addEmailAddress:s("Add an email address"),changeEmailAddress:s("Change email address"),emailVerified:s("E-mail Verified"),resendVerificationEmail:s("Resend verification email"),verificationEmailSent:s("Verification Email Sent"),emailIsUnverifiedForNotificationsAndNewsletter:s("Email is Unverified. Verify to receive follower notifications and newsletters."),detailedIncomeStats:s("Detailed Income Stats"),paymentInformationForm:s("Payment Information Form"),requiredForPayments:s("required for payments"),broadcasterVerificationForm:s("Broadcaster Verification Form"),downloadTransactionHistory:s("Download Transaction History"),pleaseWaitForFileToGenerate:s("Please wait for the file to be generated"),download30Days:s("Download your last 30 days of transactions?\nProcessing may take up to 20 seconds."),yourAccountsActivity:s("Your Account's Activity"),latestCashOuts:s("Latest cashouts"),tokensAutoCashedAtMidnight:s("tokens are automatically cashed out at midnight"),verifyToEnableTokens:s("Please verify your identity to enable tokens on your account"),transferTokens:s("Transfer Tokens"),transferTokensDateInfo:s("Tokens transferred on the 1st-15th of the month will be sent by the 22nd. Tokens transferred on the 16th-31st will be sent by the 7th."),silencedTableTitle:s("Silenced Users"),silencedUsersInfo:s("Listed are users currently silenced from your room. Silences expire after 6 hours by default. You can convert a silence to a ban."),bannedTableTitle:s("Banned Users"),bannedUsersInfo:s("Listed are users currently banned from your room. Bans expire after 1 month by default. You can convert a ban to a permanent ban."),banned:s("Banned"),silenced:s("Silenced"),actions:s("Actions"),remove:s("Remove"),makePermanent:s("Make Permanent"),convertToBan:s("Convert to Ban"),clickToClearHiddenBansAndSilences:s("Click here to clear hidden silences and bans"),addBan:s("Add ban"),enterUsernameToBan:s("Enter user to ban"),viewEditBansAndSilences:s("View/Edit Bans and Silences"),viewEditModerators:s("View/Edit Moderators"),viewFanClubMembers:s("View Fan Club Members"),viewEditRegionBlockExemptions:s("View/Edit Region Block Exemptions"),viewEditBannedTerms:s("View/Edit Banned Terms"),alphabetically:s("Alphabetically"),allUsers:s("All Users"),usersWhoTippedToday:s("Users who tipped me today"),usersWhoHaveTipped:s("Users who have tipped me"),usersWhoHaveTokens:s("Users who have tokens"),oneDay:s("1 Day"),twoDays:s("2 Days"),oneWeek:s("1 Week"),twoWeeks:s("2 Weeks"),oneMonth:s("1 Month"),twoMonths:s("2 Months"),sixMonths:s("6 Months"),no:s("No"),yes:s("Yes"),yesIfBroadcasting:s("Yes, only if they're broadcasting now"),ageVerificationRequired:s("Age Verification Required"),onlyAgeVerifiedCanChangeSetting:s("Only age verified broadcasters can change this setting"),currentFanClubMembersInfo:s("Listed are your current fan club members, the date they last joined, and the total number of months they've been your fan (Expiring memberships have a short grace period to renew before removed from your fanclub.)"),allFanClubMembersInfo:s("Listed are all of your fan club members past and present and how long they were a member for. Current members are <strong>highlighted</strong>."),addUsername:s("Add user"),add:s("Add"),regionBlockExemptions:s("Region Block Exemptions"),regionBlockExemptionsInfo:s("Users on this list will be exempt from region blocks"),uniqueRegisteredViewers:s("Unique Registered Viewers"),yourPoints:s("Your Points"),yourRank:s("Your Rank"),aboutMeHelpText:s("You may use some HTML tags (a p i strong b u ul ol li h1 h2 h3 img font br span)."),wishListHelpText:s("You may post links to external wish lists (amazon wish list, for example) and use some HTML tags (a p i strong b u ul ol li h1 h2 h3 img font br)."),displayName:s("Display Name"),displayBirthday:s("Display Birthday"),interestedIn:s("Interested in"),spokenLanguages:s("Spoken languages"),wishLists:s("Wish Lists"),joinFanClub:s("Join Fan Club"),member:s("Member"),fanClubMember:s("Fan Club Member"),lastJoined:s("Last Joined"),totalMonthsAMember:s("Total Months a Member"),improveVideoQuality:s("Improve Video Quality"),darkMode:s("Dark Mode"),searchBarPlaceholder:s("Search #tags or broadcasters"),broadcastingNow:s("Broadcasting right now"),recentlyOnline:s("Recently online"),previouslySearched:s("Previously searched"),tapToUnmute:s("TAP TO UNMUTE"),yesCancelSupporter:s("Yes, cancel the membership"),noKeepSupporter:s("No, keep the features"),cancellationSuccessful:s("Cancellation Successful"),sendAndClose:s("Send and close"),supporterPlan:s("Supporter Plan"),renewSubscription:s("Renew subscription"),whyDidYouCancel:s("Why did you decide to cancel your membership plan? (Optional)"),wouldYouCancel:s("Would you like to cancel your supporter membership and lose all your supporter features?"),renewNotice:s("You are about to renew your subscription."),cancelFailed:s("Cancellation Failed"),confirmOK:s("OK"),pleaseRefreshRetry:s("Error, please try and refresh your window."),homepageInBioViolation:s("Please note that the 'Room subject' of your broadcast and the 'Location' field of your bio may not be used for promotion of social media or other websites. Thank you for your understanding."),noteText:s("Note"),loadingPlaceholderText:s("Loading..."),writeNotePlaceholderText:s("Enter notes about this user (only seen by you)"),unsavedText:s("(unsaved)"),back:s("Back"),loadingMoreMessages:s("Loading More Messages"),sendPrivateMessage:s("Send a private message"),sendDirectMessage:s("Send a direct message"),sendDirectMessageNew:s("Send a direct message"),searchUsers:s("Search users"),unopenedCAPS:s("UNOPENED"),now:s("now"),oneMinuteAgo:s("1 minute ago"),anHourAgo:s("an hour ago"),aDayAgo:s("a day ago"),leavePrivateShowWarningText:s("To avoid ending the private show, a new tab will open. Click OK to continue."),acceptRules:s("Accept Rules"),chatCapitalized:s("Chat"),unmuteCapitalized:s("Unmute"),directMessageLabel:s("Direct Messages"),fanclubCancelErrorMessage:s("There was an error cancelling your Fan Club."),supporterCancelConfirmMessage:s("Are you sure you wish to remove your supporter status? You will remain a supporter until your currently paid month expires."),supporterCancelErrorMessage:s("There was an error cancelling your supporter membership."),eventsApiSettingsHeader:s("Events API"),banRemovedMessage:s("Ban removed"),silenceRemovedMessage:s("Silence removed"),banRemoveErrorMessage:s("Error removing ban, please try again"),banConvertErrorMessage:s("Error converting to ban, please try again"),silenceRemoveErrorMessage:s("Error removing silence â€“â€“Â it may have already been removed"),inlineUndoText:s("Undo"),inlineBanText:s("Ban"),showMyCamTip:s("Cam To Cam is the best way to share your cam with broadcasters you are watching."),transViewers:s("trans viewers"),and:s("and"),howIsChaturbateDoingToday:s("How is Chaturbate doing today?"),howIsSmcDoingToday:s("How is Cam To Cam doing today?"),yourFeedbackHasBeenSent:s("Your feedback has been sent!"),describeYourIssues:s("Describe your issues or share your ideas."),unfollowInfo:s("You will no longer receive notifications or see them in your followed tab."),runningApps:s("Running Apps"),allApps:s("All Apps"),aspDescription:s("Customize your chat room experience with Apps"),createAppsText:s("Create your own app"),legacyAppsText:s("Switch back to legacy apps"),confirmRemoveApp:s("Do you want to remove this app?"),orderBy:s("Order By:"),searchForApps:s("Search for Apps"),search:s("Search"),appsLoadingError:s("Failed to load Apps"),appsLoadingErrorV2:s("Failed to load v2 Apps"),topEarning:s("Top Earning"),featuredApps:s("Featured Apps"),recentlyUpdated:s("Recently Updated"),recentlyUsed:s("Recently Used"),version:s("version"),installed:s("Installed"),videoPanelLabel:s("Broadcast panel"),updateAvailable:s("Update available"),uninstall:s("Uninstall"),transformMessagesLabel:s("Transform messages"),restartApp:s("Restart app"),tipOptionsLabel:s("Tip options"),exclusiveAppPermissionText:s("Only one app can have this permission."),addApp:s("Add app"),upgradeAndApply:s("Upgrade & Apply"),upgradeAndRestart:s("Upgrade & Restart"),apply:s("Apply"),running:s("Running"),stopped:s("Stopped"),stop:s("Stop"),upgrade:s("Upgrade"),settings:s("Settings"),sourceCode:s("Source code"),noDescription:s("No Description"),noAppSettingsText:s("This app does not have any settings."),fieldRequiredText:s("This field is required"),stringMinError:s("This field is too short"),stringMaxError:s("This field is too long"),invalidInputText:s("Invalid input"),selectAnOption:s("Select an option"),permissions:s("Permissions"),allPermissionsText:s("All permissions granted"),noPermissionsText:s("No permissions granted"),somePermissionsText:s("Some permissions granted"),permissionModalText:s("The app you are adding is requesting the following permissions."),activeAppOverrideText:s('âš ï¸� App running in "Active App" is overriding this permission.'),aspPermissionOverrideText:s('âš ï¸� Apps running in "Active App" slot can override this permission.'),appLimitError:s("You have reached the maximum number of apps."),appNotAgeVerified:s("Only age verified broadcasters may install apps."),becomeAgeVerified:s("Verify Age"),appNotAvailable:s("App is not available."),refresh:s("Refresh"),userAddedToExemptList:s("User has been added to your exemption list."),userRemovedFromExemptList:s("User has been removed from your exemption list."),anErrorOccurred:s("An error occurred."),confirmPhotoDelete:s("Do you really want to delete this image? This cannot be undone."),errorDeletingMedia:s("There was an error deleting your media."),errorUploadingMedia:s("There was an error uploading your media."),invalidFileErrorUploadingMedia:s("This file type is not supported or the file is corrupted."),fileSizeErrorUploadingMedia:s("This file is too large. Images must be at most 50MB"),errorLoadingMedia:s("Could not load media. It may have been deleted."),switchToOBS:s("Switch to OBS to stream games"),selectGameHeaderText:s("Select your game from the list of approved games below."),installGameHeaderText:s("Install and start the game"),installGameSectionText:s("Download and and run the game."),downloadOBSHeaderText:s("Download OBS and set it up"),authorizeGameHeaderText:s("Authorize this game"),privateShowC2cTip:s("Pro tip: Viewers who use Cam To Cam tip 50% more on average than viewers who donâ€™t. Encouraging your viewers to share their cam can build a more intimate connection and potentially earn you more tokens!"),notifyWhenBroadcastersOnlineMessage:s("Notify me when broadcasters I follow come online with"),popularCAPS:s("POPULAR"),browserNotificationLabel:s("Browser notification"),browserNotificationEnabled:s("Browser notification enabled"),saveNotificationSettings:s("Save notification settings"),emailAddressText:s("Email address"),preferencesSavedText:s("Your preferences have been saved."),checkYourEmailToVerifyText:s("Check your email inbox to verify your email!"),emailSavedAndVerifyText:s('Your email address has been updated on your account. Check your email inbox to <span style="font-family: UbuntuBold, Arial, Helvetica, sans-serif;">verify your email</span>!'),emailSendErrorMessage:s("Error sending verification email, please try again."),emailSubmitErrorMessage:s("Error submitting email, please try again."),browserSubmitErrorMessage:s("Error saving browser notification."),browserSubmitErrorMessagePt2:s("Please try again from the Settings & Privacy page on your profile."),errorSendingMessage:s("Unable to send message"),buyMoreTokens:s("Buy more tokens"),removedForViolation:s("Image removed for violating site rules"),imageAttached:s("Image attached"),emailInputTooltipMsg:s("Get email notifications when broadcasters come online"),enableEmailNotification:s("Enable email notification"),howPerfectScore:s("If you didnâ€™t give a perfect rating, what can we do to earn one?"),subgenderSelectionConfirm:s("Submit and Start Broadcasting"),subgenderSelectionHeader:s("We launched new gender categories in order to allow the Chaturbate community to better identify their gender identity."),subgenderSelectionPrompt:s("Please choose an option below, selecting which one expresses you best:"),broadcastSubgenderViolation:s("A subgender is required before streaming. Please specify a subgender in your bio or profile."),biographyMale:s("A Man"),biographyFemale:s("A Woman"),biographyCouple:s("A Couple"),subgenderFemme:s("Trans Femme"),subgenderMasc:s("Trans Masc"),subgenderNonbinary:s("Non-Binary"),whatImprovementsNext:s("What improvements would you be most excited to see implemented next?"),haveYouNoticedAnyBugs:s("Did you notice any bugs today? Please describe them in as much detail as possible."),whatPainPoints:s("What were the biggest pain points you experienced today?"),offline:s("Offline"),live:s("Live"),yourStreamIsCurrently:s("Your stream is currently "),obsAwayMessage:s('This private or group show has ended. To give you time to prepare, you are now shown as "Away" to those in your room. To return and be visible on cam, click "Exit Away Mode" below.'),streamRejected:s("Stream Rejected"),waitingforStreamStats:s("Waiting for stream stats"),streamStatusUnknown:s("Stream Status Unknown"),streamTime:s("Stream time"),codec:s("Codec"),frameRate:s("Frame Rate: "),bitrate:s("Bitrate: "),alsoSupportOtherEncoders:s("We also support other encoders such as XSplit, Wirecast, etc."),obsDescription:s(" (OBS) is an open source streaming software which provides broadcasters control to configure stream settings and customizable plugins so they can enhance their stream."),tryAddingHashtags:s("Try adding #hashtags to your room subject to attract more viewers."),viewRTMPInfo:s("View RTMP/OBS broadcast information and stream key"),waitingForStream:s("Waiting for stream to start"),startInBrowserBroadcaster:s("Start the in-Browser Broadcaster"),outdatedBrowser:s("Your browser is outdated and cannot use in browser broadcast. Please update to use the latest Chaturbate features. We recommend Chrome, Firefox, or Edge."),ctrlLToClose:s("(Ctrl+L to close)"),welcomeMessage:s("To go to next room, press Ctrl+/. To send a tip, press Ctrl+S or type \"/tip 25\". To disable emoticons or adjust autocomplete settings, click the 'Gear' tab above."),mobileWelcomeMessage:s('To send a tip, click SEND TIP or type "/tip 25".'),backToRoomMenu:s("Back to Room Menu"),bannedTerms:s("Banned Terms"),bannedTermsInfo:s("Viewers will not be able to send messages containing these terms. All characters are allowed, including spaces."),addTerm:s("Add term"),term:s("Term"),banAsSubstring:s("Ban as Substring"),banAsSubstringExplanation:s('Ban the term if it appears anywhere in a message, even as part of other words. For example, if the term is "hello" then this will also ban "xhellox". Otherwise, if disabled, only messages like "x hello x" will be banned.'),enterTermToBan:s("Enter term to ban"),pleaseEnterTermToBan:s("Please enter a term to ban"),errorBanningTerm:s("There was an error banning this term. Please try again later"),errorUpdatingTerm:s("There was an error updating this term. Please try again later"),errorRemovingTerm:s("There was an error removing this term. Please try again later"),followsYou:s("Follows you"),sharingCam:s("Sharing their cam"),notes:s("Notes"),broadcastDate:s("Broadcast Date"),broadcastWeekday:s("Broadcast Weekday"),broadcastLength:s("Broadcast Length"),maxViewers:s("Max Viewers"),tokensTotal:s("Tokens Total"),avgTokensPerMin:s("Average Tokens Per Minute"),avgTokensPerUser:s("Average Tokens Per User"),chatMessagesTotal:s("Chat Messages Total"),avgMessagesPerUser:s("Average Messages Per User"),featuredCAPS:s("FEATURED"),allGendersCAPS:s("ALL GENDERS"),notShowingFromRegions:s("Not showing broadcasters from"),noRoomsAvailableFiltered:s("No rooms match your preferences, please update your search/filter options."),dragToResize:s("Drag to resize"),userInRoom:s("User is in the room"),userNotInRoom:s("User has left the room"),userNotInPrivate:s("User is not in the private show"),dmCloseTab:s("Close tab"),dmCloseTabShortcut:s("Ctrl+L to close window"),reportThisUserText:s("Report this user"),inappropriateMessage:s("Inappropriate message"),rudeMessage:s("Rude message"),spamMessage:s("Spam message"),getMoreLabel:s("Get More"),invalidAmount:s("Invalid amount"),hashtag:s("Hashtag"),viewers:s("Viewers"),rooms:s("Rooms"),broadcastYourselfCapitalized:s("Broadcast Yourself"),supporterCAPS:s("SUPPORTER"),incorrectOrientation:s("Your stream may appear upside down or sideways to viewers. Turn your device."),incorrectPortrait:s("Your broadcast may appear upside down or sideways to viewers. Turn your device into landscape mode."),incorrectLandscape:s("Your broadcast may appear upside down to viewers. Turn your device 180 degrees."),missingFullscreen:s("Fullscreen is required for broadcasting. "),fullscreenStop:s("Screen is no longer fullscreen so stream has been stopped."),androidBroadcast:s("Starting a broadcast will enter fullscreen."),mobileBroadcastError:s("Must be in proper landscape to broadcast, rotate 90 or 180 degrees and try again"),allTagsCAPS:s("ALL TAGS"),dismissCapitalized:s("Dismiss"),noFanClub:s("Broadcaster doesn't have fanclub"),becomeSupporter:s("Become a supporter"),joinCB:s("Join Chaturbate"),popoutInNewWindow:s("Popout in new window"),connecting:s("Connecting"),connectingToBroadcastMessage:s("Please wait while we connect you to this webcam broadcast."),performerIsAway:s("Performer Is Away"),roomAwayMessage:s("You may continue chatting while you wait for the broadcaster to return."),roomPrivateNotWatchingMessage:s("You may continue chatting while you wait for the broadcaster to return from the private show."),spyOnThisPrivateShowCAPS:s("SPY ON THIS PRIVATE SHOW"),camIsHidden:s("Cam is Hidden"),roomOfflineSubheader:s("The member you are trying to view is currently offline. Please wait or choose another member to view."),passwordRequired:s("Password Required"),roomPasswordProtectedMessage:s("The broadcaster has set a password which is required for viewing. If you know the password, refresh this page to enter it."),errorLoadingConversationHistory:s("Error loading conversation history. Close and reopen this DM to reload"),ageVerifiedHeader:s("Age Verified Broadcasters"),ageVerifiedBodyHeader:s("Your account is age verified!"),ageVerifiedGuests:s("Additionally the following guests are approved to appear on your account:"),ageVerifiedBody:s("Only the age verified persons below can appear through your account. If you would like to broadcast with someone that is not displayed below, they must upload their government-issued identification prior to appearing on your account."),camCategoryNorthAmerica:s("North American Cams"),camCategorySouthAmerica:s("South American Cams"),camCategoryAsia:s("Asian Cams"),camCategoryEuroRussia:s("Euro Russian Cams"),camCategoryOtherRegion:s("Other Region Cams"),camCategoryTeen:s("Teen Cams (18+)"),camCategory18to20:s("18 to 20 Cams"),camCategory18to21:s("18 to 21 Cams"),camCategory20to30:s("20 to 30 Cams"),camCategory30to50:s("30 to 50 Cams"),camCategory21to35:s("21 to 35 Cams"),camCategoryMature:s("Mature Cams (50+)"),camCategoryExhib:s("Exhibitionist Cams"),camCategoryPrivate:s("Private Shows"),camCategoryHidden:s("Community Controlled Shows"),camCategoryNewCams:s("New Cams"),camCategoryGaming:s("Gaming Cams"),camCategory6TkPerMin:s("6 Tokens per Minute"),camCategory12TkPerMin:s("12 Tokens per Minute"),camCategory18TkPerMin:s("18 Tokens per Minute"),camCategory30TkPerMin:s("30+ Tokens per Minute"),camCategory60TkPerMin:s("60+ Tokens per Minute"),camCategory90TkPerMin:s("90+ Tokens per Minute"),categoryDescriptionHidden:s("Community controlled cams are using an app which has the ability to hide and show the cam based on viewers feedback."),firefoxWarning:s("Firefox is not recommended for browser broadcasting. For a better experience, please use Chrome or an external encoder."),noFanclub:s("Broadcaster does not currently have a fan club."),inValidTipAmount:s("Please input a full tip amount between 1 and 9999."),shortcodeNotSupportedInDMs:s("Shortcodes are not supported in DMs."),shortcodeNotSupportedInPMs:s("Shortcodes are not supported in PMs."),shortcodeGeneralError:s("Error sending shortcode. Please try again."),tipNotBroadcaster:s("Only broadcasters & apps can publish tip shortcodes"),tooManyShortcodes:s("Max shortcodes allowed per message is 5"),shortcode:s("Shortcode"),shortcodeHelp:s("Shortcodes are specific codes that can be typed into a chat room to automatically create clickable links with predefined actions. These shortcodes can act as a shortcut for users to perform various functions like joining a specific page, becoming a supporter, or tipping an amount."),shortcodeURLNotAllowedInTip:s("URLs are not allowed in tip shortcodes"),shortcodeHelpTipExample:s("Tip if you enjoyed!"),loggedInForFeature:s("You must be logged in to use this feature"),errorSendingTip:s("Error sending tip"),visibleRegionsTag:s("Visible Regions"),northAmericaTitle:s("North America"),southAmericaTitle:s("South America"),asiaTitle:s("Asia"),europeRussiaTitle:s("Europe/Russia"),otherTitle:s("Other"),refresh30Seconds:s("30 Seconds"),refresh45Seconds:s("45 Seconds"),refresh60Seconds:s("60 Seconds"),refresh90Seconds:s("90 Seconds"),refreshDisable:s("Disable"),refreshThumbnailsEvery:s("Refresh thumbnails every"),showLocations:s("Show locations"),showRecommendedCams:s("Show recommended cams"),previewRooms:s("Preview rooms"),enableFloatingPlayer:s("Enable floating player"),moreTags:s("(more tags)"),removeFilter:s("(remove filter)"),privateBrowsingMessage:s("Broadcasting while private browsing is not supported for Firefox. Please disable private browsing and try again."),unableToReloadErrorMessage:s("Something went wrong while loading the rooms. Please <a class='link'>refresh the page</a> to try again."),onlineRooms:s("Online Rooms"),offlineRooms:s("Offline Rooms"),metaContentCardDescriptionPremium:s("Join a private or spy show for greater intimacy and voyeurism. No registration required!"),metaContentCardDescriptionFemale:s("Enjoy uncensored adult chat & live webcams with amateur girls. No registration required!"),metaContentCardDescriptionMale:s("Enjoy uncensored adult chat & live webcams with amateur guys. No registration required!"),metaContentCardDescriptionCouples:s("Enjoy uncensored adult chat & live webcams with amateur couples. No registration required!"),metaContentCardDescriptionTrans:s("Enjoy uncensored adult chat & live trans webcams with amateurs. No registration required!"),metaContentCardDescriptionDefault:s("Enjoy free chat and live webcam broadcasts from amateurs around the world. No registration required!"),metaDescriptionDefault:s("Watch Live Cams Now! No Registration Required - 100% Free Uncensored Adult Chat. Start chatting with amateurs, exhibitionists, pornstars w/ HD Video & Audio."),metaDescriptionPremium:s("You can join a private show and for only a few tokens per minute. Chat in private shows and direct all the action!"),metaKeywordsFemale:s("free chat with girls, live cam girls, free webcam girls"),metaKeywordsMale:s("free chat with men, live gay cams, free gay webcams"),metaKeywordsCouple:s("free chat with couple, live cam couple, free webcam couple"),metaKeywordsTrans:s("free chat with trans, live cam trans, free webcam trans"),metaKeywordsDefault:s("free cams, free adult video chat, free sex webcams, live adult cams, adult webcams, free live porn"),metaKeywordsPremium:s("private cams and spy cams"),premiumShowsCaps:s("PREMIUM SHOWS"),featuredText:s("Featured"),highestTokenColorTooltip:s('If your "tipped recently" amount is higher than the selected value, your username will be displayed in the selected color.'),tipShortcodeMessageInDoubleQuotes:s("The message content for tip shortcode must be enclosed in double quotes."),loadingPreview:s("Loading Preview"),obsGuideCodec:s("Codec:"),obsGuideCodecBody:s("H.264 Video, AAC Audio."),obsGuideAspect:s("Aspect ratio:"),obsGuideAspectBody:s("4:3 or 16:9 only."),obsGuideResolution:s("Resolution:"),obsGuideResolutionBody:s("From a height of 240 pixels up to 4k (2160 pixels)."),obsGuideFPS:s("Frame Rate:"),obsGuideFPSBody:s("24-30fps, or 48-60fps for high frame rate."),obsGuideBitrate:s("Bitrate:"),obsGuideBitrateBody:s("Up to 50 Mbps (50 000 Kbps) Video, 192 Kbps Audio - CBR Preferred."),obsGuideKeyFrame:s("Key Frame Interval:"),obsGuideKeyFrameBody:s("2 seconds."),obsGuideKeyProfile:s("H.264 Profile:"),obsGuideKeyProfileBody:s("Main or High preferred; baseline is acceptable."),obsGuideGenerate:s("Generate New Token"),obsGuideGenerateFail:s("Failed to reset token. Please try again.")}},47:function(e,t,n){"use strict";n.d(t,{HY:function(){return a},rP:function(){return v},vz:function(){return h}});var i=n(4150),o=n(126),r=n(7693);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var a=function(){return"FRAGMENT"},l={style:function(e,t){Object.assign(e.style,t)},className:function(e,t){e.setAttribute("class",t)},class:function(e,t){e.setAttribute("class",t)},htmlFor:function(e,t){e.setAttribute("for",t)},colorClass:function(e,t){var n=t;Array.isArray(n)?n.forEach((function(t){""!==t&&e.classList.add(t)})):e.classList.add(n)},xlinkHref:function(e,t){e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t)},dangerouslySetInnerHTML:function(e,t){e.innerHTML=t.__html},bind:function(e,t){!function(e,t){p(e,(function(){Object.keys(t).forEach((function(n){var i=t[n];if(i instanceof Function){var o=t[n]();"display"===n?e.style.display=o:"text"===n?e.textContent=o:c(n,e,o)}else warn("Wrong binding for element ".concat(e.outerHTML," key ").concat(n," is not a function ").concat(i))}))}))}(e,t)},ref:function(e,t){"function"==typeof t&&t(e)},display:function(e,t){e.style.display=t}};function c(e,t,n){var i=l[e];void 0!==i?i(t,n):0===e.indexOf("on")?function(e,t,n){var i=e.toLowerCase(),o=!1;e.indexOf("Capture",e.length-7)>-1&&(o=!0,i=i.slice(-7)),null===t[i]?(0,r.j9)(i.slice(2),t,n,o):warn("Event declared for JSX element that does not exist on type ".concat(t.tagName,": ").concat(e))}(e,t,n):t.setAttribute(e,n)}function u(e,t){"function"==typeof e.ref&&e.ref(t,e)}function d(e){var t=document.createDocumentFragment();return e.forEach((function e(n){if(n instanceof HTMLElement||n instanceof SVGElement||n instanceof Comment||n instanceof DocumentFragment)t.appendChild(n),m(t,n);else if("string"==typeof n||"number"==typeof n){var i=document.createTextNode("".concat(n));t.appendChild(i)}else n instanceof Array?n.forEach(e):!1===n||null==n?debug("Logic expression in Tsx fragment: ".concat(n)):warn("Unexpected child in Tsx fragment: ".concat(n))})),t}function h(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];return"function"==typeof e?void 0===e.prototype||void 0===e.prototype.render?function(e,t,n){var i,o=Object.assign({},{},t,{children:n}),r=e(o);return u(o,i="FRAGMENT"===r?d(n):r),i}(e,t,r):function(e,t,n){var r=Object.assign({},{},t,{children:n}),s=[];void 0!==r.unsafeArgs&&(s=r.unsafeArgs);var a=(0,i.Z)(e,[r].concat((0,o.Z)(s))),l=a.render();return function(e,t){"function"==typeof e.classRef&&e.classRef(t,e)}(r,a),u(r,l),void 0!==Object.getPrototypeOf(a).updateState&&p(l,a),l}(e,t,r):function(e,t,n){var i=function(e){var t=new RegExp("^".concat(e,"$"),"i");return["path","svg","use","g"].some((function(e){return t.test(e)}))}(e)?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e),o=d(n);return i.appendChild(o),m(i,o),function(e,t){if(null!=t){var n=Object.keys(t),i=n.indexOf("colorClass");i>=0&&n.push(n.splice(i,1)[0]),n.forEach((function(n){c(n,e,t[n])}))}}(i,t),i}(e,t,r)}var f="__mm_bindings__";function p(e,t){f in e||(e[f]=[]),e[f].push(t)}function m(e,t){if(f in t){var n,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw r}}}}(t[f]);try{for(i.s();!(n=i.n()).done;)p(e,n.value)}catch(e){i.e(e)}finally{i.f()}}}function v(e){var t;return null!==(t=e[f])&&void 0!==t?t:[]}},1289:function(e,t,n){"use strict";n.d(t,{Ie:function(){return c},Lm:function(){return a},Vf:function(){return s},dD:function(){return u}});var i=n(3753),o=n(8978);function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function s(e){var t=l(e);if(t!==document.location.search&&"replaceState"in window.history){var n=null!==window.top?window.top:window,r=(0,o.gB)(t,n.location.pathname);if(window.history.replaceState("","",(0,i.BN)(r)),void 0!==window.parent){var s="",a=window.parent.history.state;"nav"===a.type&&(a.path=r,s=a),window.parent.history.replaceState(s,"",(0,i.BN)(r))}}}function a(e,t){var n=l(e);n!==window.location.search&&"pushState"in window.history&&window.history.pushState(t,"",(0,i.BN)((0,o.gB)(n,window.location.pathname)))}function l(e){var t=new URLSearchParams(window.location.search);e.forEach((function(e,n){""===e?t.delete(n):t.set(n,e)}));var n=t.toString().replace(/%2C/g,",");return""===n?"":"?".concat(n)}function c(e){for(var t="",n=0,i=Object.keys(e);n<i.length;n++){var o=i[n];""!==t&&(t+="&");var r=e[o];void 0===r&&(r=""),t+="".concat(encodeURIComponent(o),"=").concat(encodeURIComponent(r))}return t}function u(e){e.length>0&&"?"===e[0]&&(e=e.slice(1));var t,n={},i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw s}}}}(e.split("&"));try{for(i.s();!(t=i.n()).done;){var o=t.value;if(o.includes("=")){var s=o.split("=");s[0].length>0&&(n[decodeURIComponent(s[0])]=s[1].length>0?decodeURIComponent(s[1]):void 0)}else o.length>0&&(n[decodeURIComponent(o)]=void 0)}}catch(e){i.e(e)}finally{i.f()}return n}},9420:function(e,t,n){"use strict";n.d(t,{CD:function(){return h},GZ:function(){return c},He:function(){return s},M:function(){return d},SB:function(){return r},ae:function(){return u},qS:function(){return l},sC:function(){return a},wy:function(){return o}});var i=n(1794),o=new i.xB("roomListRequest"),r=new i.xB("playerForceMuted"),s=new i.xB("standardEmoticonRequest"),a=new i.xB("userInitiatedPm"),l=new i.xB("mentionUser"),c=new i.xB("appDebuggingToggled"),u=new i.xB("getMoreHistoryMessages"),d=new i.xB("repositionChatTabContent"),h=new i.xB("userModeratorStatusChanged")},858:function(e,t,n){"use strict";n.d(t,{J_:function(){return N},Wu:function(){return j},v9:function(){return _}});var i=n(5809),o=n(2951),r=n(1976),s=n(7169),a=n(7591),l=n(9492),c=n(3243),u=n(7597),d=n(6474),h=n(1185),f=n(7397),p=n(1194),m=n(2800),v=n(9760),g=n(6402),y=n(407),b=n(7693),w=n(1522),C=n(3753),x=n(695),k=n(2008),S=n(4793),T=n(8263),I=n(1794),R=n(27),P=n(4842),M=n(1625),A=n(3340),E=n(3705),B=n(2896),L=n(7108),O=n(9482),D=n(1809),U=n(758),Z=n(3543),F=n(9420);function _(){var e=j.state;return 0===e||1===e}function N(){j.setUserContextMenuState(3)}var j=function(e){(0,a.Z)(_,e);var t,n,L=(t=_,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var o=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,l.Z)(this,e)});function _(e,t,n){var i,r,a;(0,o.Z)(this,_),(a=L.call(this)).user=e,a.message=n,a.ucmListenerGroup=new I.mM,a.tearDownListener=function(e){var t=e.ctrlKey||e.metaKey,n=9===e.keyCode,i=t&&83===e.keyCode,o=t&&191===e.keyCode,r=191===e.keyCode,s=t&&76===e.keyCode,l=27===e.keyCode;(n||i||o||s||l||r)&&a.hideOverlay()},a.hideOverlayListener=function(){a.hideOverlay()},a.clickTargetEl=t,a.parentEl=null!==(i=_.ucmContainer)&&void 0!==i?i:t.offsetParent,a.createPlaceholder(),(0,b.j9)("keydown",document,a.tearDownListener),a.fullscreenChangeListener=M.gH.listen(a.hideOverlayListener),(0,b.j9)("popstate",window,a.hideOverlayListener),U.FJ.listen(a.hideOverlayListener,!1).addTo(a.ucmListenerGroup),A.WP.listen(a.hideOverlayListener,!1).addTo(a.ucmListenerGroup),D.vV.listen(a.hideOverlayListener,!1).addTo(a.ucmListenerGroup);var l=window.innerWidth;return v.nR.listen((function(){window.innerWidth<l&&a.hideOverlayListener(),l=window.innerWidth})).addTo(a.ucmListenerGroup),a.parentEl.appendChild(a.element),a.afterDOMConstructedIncludingChildren(),a.overlayClick.listen((function(){a.hideOverlay()})),(0,c.Z)((r=(0,s.Z)(a),(0,u.Z)(_.prototype)),"showOverlay",r).call(r),a.loadData(),a}return(0,r.Z)(_,[{key:"getUsername",value:function(){return this.user.username}},{key:"createPlaceholder",value:function(){this.initializeMenu(),this.addHeader(),this.addUserLabels(),this.addRestMenu(),this.addHeaderLeftData(),this.addLinksData()}},{key:"loadData",value:function(){var e=this;_.setUserContextMenuState(0),this.position(!0),(0,R.a)(this.user.username).then((function(t){2!==_.state&&(e.fillData(t),e.position())})).catch((function(t){error("Could not process user menu request",{username:e.user.username,reason:t.toString()})}))}},{key:"fillData",value:function(e){void 0===this.data&&(this.data=e,this.showSupporterAlert=this.data.needsSupporterToPm,this.addHeaderRightData(),this.addSilenceIfAllowed(),_.setUserContextMenuState(1))}},{key:"initializeMenu",value:function(){var e=this;_.setUserContextMenuState(0),this.element=document.createElement("div"),this.element.id="user-context-menu",this.element.dataset.testid="user-context-menu",this.menuContents=document.createElement("div"),this.modSection=document.createElement("div"),this.menuContents.style.backgroundColor="",this.element.appendChild(this.menuContents),this.element.style.textShadow="none",this.element.style.position="absolute",this.element.style.borderRadius="4px",this.element.style.borderStyle="solid",this.element.style.borderWidth="1px",this.element.style.top="0",this.element.style.fontWeight="normal",this.element.style.fontFamily="Tahoma, Arial, Helvetica, sans-serif",this.element.style.fontSize="12px",this.element.style.width="188px",this.element.style.cursor="default",this.element.style.visibility="visible",this.element.style.zIndex="".concat(1010),this.overlay.style.zIndex="".concat(1010),S.kN.listen((function(t){e.roomName=t.dossier.room,e.currentUsername=t.dossier.userName,e.chatConn=t.chatConnection})).addTo(this.ucmListenerGroup)}},{key:"addLoadingStyle",value:function(e){(0,h.vP)(e,"ucmPlaceholder")}},{key:"removeLoadingStyle",value:function(e){(0,h.FU)(e,"ucmPlaceholder")}},{key:"addHeader",value:function(){var e=document.createElement("div");(0,h.vP)(e,"ucmHeader"),e.style.padding="9px 10px",e.style.fontWeight="bold",e.style.borderTopLeftRadius="4px",e.style.borderTopRightRadius="4px",this.name=document.createElement("div"),this.name.style.display="inline-block",this.name.style.maxWidth="100px",this.name.style.height="12px",this.name.style.marginRight="4px",e.appendChild(this.name);var t=P.R.getOrCreateInstance().hasFollower(this.user.username);if(m.J.current.isBroadcast&&t&&this.user.username!==m.q.getState().room){var n=(0,g.R)(),i=(0,y.T)({content:Z.ag.followsYou,hasHTML:!1,divotPosition:1,divotLeftOrTop:"8px"});i.style.padding="6px",i.style.fontFamily="UbuntuLight, Helvetica, Arial, sans-serif",i.style.lineHeight="normal",i.style.position="fixed",i.style.display="block",i.style.width="max-content",i.style.zIndex="".concat(1011),(0,T.nH)(n).listen((function(e){var t;e?document.body.appendChild(i):null===(t=i.parentElement)||void 0===t||t.removeChild(i);var o=n.getBoundingClientRect(),r=(0,T.i6)();i.style.top="".concat(-r.top+o.top-i.offsetHeight-o.height/5-5,"px"),i.style.left="".concat(-r.left+o.left+o.width/2-18,"px")})),e.appendChild(n)}var o=document.createElement("div");o.style.display="inline-block",o.style.width="38px",o.style.height="12px",o.style.position="absolute",o.style.right="8px",this.age=document.createElement("span"),(0,h.vP)(this.age,"ucmAgespan"),this.age.style.display="inline-block",this.age.style.width="15px",this.age.style.minHeight="14px",this.age.style.fontSize="12px",this.age.style.fontWeight="bold",this.age.style.marginRight="6px",this.age.style.verticalAlign="top",o.appendChild(this.age),this.addLoadingStyle(this.age),this.genderSpan=document.createElement("span"),this.genderSpan.style.display="inline-block",this.genderSpan.style.width="15px",this.genderSpan.style.height="14px",this.genderSpan.style.verticalAlign="top",this.genderIcon=document.createElement("img"),void 0!==this.user.gender?(this.genderIcon.src=(0,O.Fg)(this.user.gender),this.genderIcon.style.display="inline-block",this.genderIcon.title=Z.ag.genderSymbolToIconTitle(this.user.gender)):(this.addLoadingStyle(this.genderSpan),this.genderIcon.style.display="none"),this.genderIcon.height=14,this.genderIcon.width=14,this.genderSpan.appendChild(this.genderIcon),o.appendChild(this.genderSpan),e.appendChild(o),this.menuContents.appendChild(e)}},{key:"addHeaderLeftData",value:function(){var e=this,t=document.createElement("a");t.innerText=this.user.username,(0,h.vP)(t,(0,O.c9)(this.user)),t.dataset.testid="username",t.style.fontWeight="bold",t.href=(0,C.BN)("/".concat(this.user.username,"/")),t.target="_blank",t.style.textDecoration="none",t.style.overflow="hidden",t.style.textOverflow="ellipsis",t.style.maxWidth="100px",t.style.display="inline-block",t.style.cursor="pointer",t.onmouseenter=function(){t.style.textDecoration="underline"},t.onmouseleave=function(){t.style.textDecoration="none"},(0,b.j9)("click",this.name,(function(t){(0,E.fg)("ViewProfile",{username:e.user.username}),t.stopPropagation(),e.hideOverlay()})),this.name.appendChild(t),this.overlay.style.background="rgba(0, 0, 0, 0.01)",this.element.style.visibility="visible"}},{key:"addHeaderRightData",value:function(){var e,t,n=document.createElement("div");if(n.style.width="188px",n.style.height="75px",n.style.overflow="hidden",n.style.borderRadius="4px 4px 0px 0px",!0===(null===(e=this.data)||void 0===e?void 0:e.online)){var i=document.createElement("img");(0,b.j9)("load",i,(function(){var e=n.getBoundingClientRect(),t=i.getBoundingClientRect();e.height<t.height&&(i.style.position="relative",i.style.left="0px",i.style.top="".concat((e.height-t.height)/2,"px"))})),i.src=this.data.imageUrl,i.dataset.testid="gender-icon",i.style.width="100%",n.appendChild(i),this.adjustForImg(),this.element.insertBefore(n,this.element.firstChild)}this.removeLoadingStyle(this.age),this.removeLoadingStyle(this.genderSpan),!0===(null===(t=this.data)||void 0===t?void 0:t.canAccess)&&(!isNaN(this.data.displayAge)&&this.data.displayAge>=18&&(this.age.innerText=this.data.displayAge.toString()),this.removeLoadingStyle(this.age),this.genderIcon.src=(0,O.Fg)(this.data.gender),this.genderIcon.style.display="inline-block")}},{key:"addUserLabels",value:function(){var e=(0,O.Lj)(this.user),t=(0,O.Ow)(this.user);if(void 0!==e){var n=document.createElement("div");(0,h.vP)(n,"ucmUserLabel"),n.style.padding="9px 10px",n.style.borderTopWidth="1px",n.style.borderTopStyle="solid",this.menuContents.appendChild(n);var i=document.createElement("div");if(i.dataset.testid="user-label",i.style.width="74px",i.style.height="12px",i.style.width="100%",i.innerText=e,(0,h.vP)(i,(0,O.c9)(this.user)),i.style.fontWeight="bold",n.appendChild(i),void 0!==t){var o=document.createElement("div");(0,h.vP)(o,"ucmSublabel"),o.style.height="10px",o.style.fontSize="10px",o.style.marginTop="4px",o.style["-webkit-text-size-adjust"]="none",o.innerText=t,n.appendChild(o)}}}},{key:"addRestMenu",value:function(){this.addLinks(this.user),this.addModSection(),this.addNotes(this.user.username)}},{key:"addNotes",value:function(e){var t=this;if(void 0!==this.currentUsername&&this.currentUsername!==e){var n=document.createElement("div"),i=p.d.get("UserNote");this.reactUserNote=new i({username:e,badgeManager:B.$.getOrCreateInstance(),isNotLoggedIn:x.Cg,removeMenu:function(){t.hideOverlay()}},n),this.menuContents.appendChild(n)}}},{key:"addLinks",value:function(e){this.menuLinks=document.createElement("div"),(0,h.vP)(this.menuLinks,"ucmLinks"),this.menuLinks.style.padding="5px 0",this.menuLinks.style.fontSize="12px",this.menuLinks.style.borderTopWidth="1px",this.menuLinks.style.borderTopStyle="solid",this.menuContents.appendChild(this.menuLinks)}},{key:"addModSection",value:function(){this.menuContents.appendChild(this.modSection),(0,h.vP)(this.modSection,"ucmModSection"),this.modSection.style.borderTopWidth="1px",this.modSection.style.borderTopStyle="solid",this.modSection.style.padding="5px 0",this.modSection.style.display="none"}},{key:"addLinksData",value:function(){if(this.currentUsername!==this.user.username){if(void 0===this.chatConn)return void error("ignoreText: Chatconnection should be defined");var e=this.createSendLink(this.user.username,!0);if(this.menuLinks.appendChild(e),(0,d.Fh)()){var t=this.createSendLink(this.user.username,!1);this.menuLinks.appendChild(t)}var n=this.createMentionLink(this.user.username);if(this.menuLinks.appendChild(n),this.roomName!==this.currentUsername){var i=this.createIgnoreLink(this.user.username,this.chatConn);this.menuLinks.appendChild(i)}if(void 0!==this.message){var o=this.createReportLink(this.user.username,this.message);this.menuLinks.appendChild(o)}}else this.menuLinks.style.display="none"}},{key:"addSilenceIfAllowed",value:function(){var e=this;if(void 0!==this.data&&this.data.canSilence){var t=document.createElement("div"),n=this.createLink(),i=this.createLinkSpan(),o=this.data.username;i.style.paddingLeft="20px",n.appendChild(i),n.dataset.testid="silence-toggle",t.appendChild(n),void 0!==this.data.silenceId?i.innerText=Z.ag.removeSilenceMessage:i.innerText=Z.ag.silenceDurationMessage,n.onclick=function(){void 0!==e.data&&void 0!==e.data.silenceId&&void 0!==e.roomName?(0,C.I5)("edit_room_ban/",{banid:String(e.data.silenceId),action:"remove_silence",room_username:e.roomName}).catch((function(e){error(e),(0,w.Cj)("Error removing silence from user ".concat(o))})):(0,w.oB)("Silence ".concat(e.user.username,"?"),(function(){(0,E.fg)("SilenceUser",{username:e.user.username,to_user:e.user.username}),(0,C.I5)("roomsilence/".concat(e.user.username,"/").concat(e.roomName,"/"),{}).catch((function(t){error(t),(0,w.Cj)("Error silencing user ".concat(e.user.username))}))})),e.hideOverlay()},this.modSection.appendChild(t),this.modSection.style.display=""}}},{key:"findBoundary",value:function(){if((0,M.rm)())return{boundV:(0,M.Gd)(),boundH:(0,M.Gd)()};for(var e,t,n=function(e,t,n){var i=window.getComputedStyle(e);return void 0===t&&"hidden"===i.overflowY&&(t=e),void 0===n&&"hidden"===i.overflowX&&(n=e),[t,n]},o=this.parentEl;void 0!==o&&"body"!==o.tagName.toLowerCase();o=null===o.parentElement?void 0:o.parentElement){var r=n(o,e,t),s=(0,i.Z)(r,2);if(e=s[0],t=s[1],void 0!==e&&void 0!==t)break}return{boundV:e,boundH:t}}},{key:"trapInBoundary",value:function(e,t){var n=void 0===e?document.documentElement:e,i=void 0===t?document.documentElement:t,o=n.getBoundingClientRect(),r=i.getBoundingClientRect(),s=this.element.getBoundingClientRect(),a=o.bottom-s.height-38,l=r.right-s.width,c=o.top,u=r.left,d=s.top,h=s.left;if(c>d){var f=c-d;this.element.style.top="".concat(this.element.offsetTop+f+4,"px")}if(u>h){var p=u-h;this.element.style.left="".concat(this.element.offsetLeft+p+4,"px")}if(a<d){var m=a-d;this.element.style.top="".concat(this.element.offsetTop+m-4,"px")}if(l<h){var v=l-h;this.element.style.left="".concat(this.element.offsetLeft+v-4,"px")}}},{key:"alignNameWith",value:function(e){if(document.body.contains(this.name)){var t=this.name.getBoundingClientRect(),n=e.top-t.top,i=e.left-t.left,o=this.element.offsetTop+n,r=this.element.offsetLeft+i;this.element.style.top="".concat(o,"px"),this.element.style.left="".concat(r,"px")}}},{key:"shiftUpToSeeNotes",value:function(){if(void 0!==this.currentUsername&&this.currentUsername!==this.user.username){var e=window.innerHeight-(this.element.getBoundingClientRect().top+this.element.offsetHeight+85);if(e<0){var t=parseInt(this.element.style.top.slice(0,-2));this.element.style.top="".concat(t+e,"px")}}}},{key:"adjustForImg",value:function(){this.element.style.top="".concat(this.element.offsetTop-75,"px")}},{key:"repositionToMatch",value:function(e){this.alignNameWith(e),this.shiftUpToSeeNotes()}},{key:"position",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this.repositionToMatch(this.clickTargetEl.getBoundingClientRect());var e=this.findBoundary();this.trapInBoundary(e.boundV,e.boundH)}},{key:"hideOverlay",value:function(){var e,t;2!==_.state&&((0,c.Z)((0,u.Z)(_.prototype),"hideOverlay",this).call(this),void 0!==this.chatReport&&this.chatReport.tearDown(),(0,b.SC)("keydown",document,this.tearDownListener),null===(e=this.fullscreenChangeListener)||void 0===e||e.removeListener(),this.fullscreenChangeListener=void 0,(0,b.SC)("popstate",window,this.hideOverlayListener),this.ucmListenerGroup.removeAll(),this.parentEl.removeChild(this.element),this.afterRemovedFromParent(),_.setUserContextMenuState(2),null===(t=this.reactUserNote)||void 0===t||t.dispose())}},{key:"createSendLink",value:function(e,t){var n=this,i=this.createLink(),o=document.createElement("div"),r=this.createLinkSpan();return(0,h.vP)(i,"ucmPMLink"),i.dataset.testid=t?"send-pm":"send-dm",i.appendChild(o),i.appendChild(r),r.innerText=t?Z.ag.sendPrivateMessageText:Z.ag.sendDirectMessageText,(0,h.vP)(o,t?"ucmSendPmIcon":"ucmSendDmIcon"),o.style.padding="0px 4px 0 0",o.style.verticalAlign="bottom",o.style.width="14px",o.style.height="14px",o.style.display="inline-block",o.style.marginRight="4px",(0,b.j9)("click",i,(function(i){n.hideOverlay(),(0,x.Cg)(t?Z.ag.loggedInToPm:Z.ag.loggedInToDm)||(t?((0,E.fg)("StartPrivateMessage",{username:e,to_user:e,location:"PMTab"}),F.sC.fire({username:e,focus:!0,showSupporterAlert:n.showSupporterAlert})):((0,E.fg)("StartDirectMessage",{username:e,to_user:e}),f.nh.fire(e)),i.stopPropagation())})),i}},{key:"createMentionLink",value:function(e){var t=this,n=this.createLink(),i=document.createElement("div"),o=this.createLinkSpan();return o.innerText=Z.ag.mentionUserText,(0,h.vP)(i,"ucmMentionIcon"),i.style.width="14px",i.style.height="14px",i.style.padding="0px 4px 0 0px",i.style.verticalAlign="bottom",i.style.display="inline-block",i.style.marginRight="4px",n.id="ucm-mentionuser",n.dataset.testid="mention-user",n.appendChild(i),n.appendChild(o),(0,b.j9)("click",n,(function(){F.qS.fire(e),t.hideOverlay()})),n}},{key:"createIgnoreLink",value:function(e,t){var n=this,i=this.createLink();i.dataset.testid="ignore-toggle";var o=document.createElement("div"),r=this.createLinkSpan();return t.isIgnored(e)?(r.style.paddingLeft="20px",r.innerText=Z.ag.unignoreThisUserText):((0,h.vP)(i,"notIgnored"),r.style.paddingLeft="0",r.innerText=Z.ag.ignoreThisUserText,i.appendChild(o)),(0,h.vP)(i,"ucmIgnoreLink"),i.appendChild(r),(0,h.vP)(o,"ucmIgnoreIcon"),o.style.padding="0px 4px 0 0px",o.style.verticalAlign="bottom",o.style.width="14px",o.style.height="14px",o.style.display="inline-block",o.style.marginRight="4px",(0,b.j9)("click",i,(function(){t.isIgnored(e)?t.unignore(e):t.ignore(e),n.hideOverlay()})),i}},{key:"createReportLink",value:function(e,t){var n=this,i=this.createLink(),o=document.createElement("div"),r=this.createLinkSpan();return(0,h.vP)(i,"ucmReportLink"),i.appendChild(o),i.appendChild(r),i.dataset.testid="report-room",(0,h.vP)(o,"ucmReportIcon"),o.style.padding="0 4px 0 0",o.style.verticalAlign="middle",o.style.width="14px",o.style.height="14px",o.style.display="inline-block",o.style.marginRight="4px",r.innerText=Z.ag.reportThisMessageText,(0,b.j9)("click",i,(function(){(0,E.fg)("ReportChatUser",{username:e,to_user:e}),n.element.removeChild(n.menuContents),n.chatReport=new k.P(e,t,n.chatConn),n.element.appendChild(n.chatReport.element),n.position(),n.chatReport.focusForm(),n.chatReport.closeChatReportRequest.listen((function(){n.hideOverlay()}))})),i}},{key:"createLink",value:function(){var e=document.createElement("div");return e.style.padding="3px 10px",e.style.whiteSpace="nowrap",e.style.fontWeight="normal",e.style.fontFamily="Tahoma, Arial, Helvetica, sans-serif",e.style.fontSize="12px",e.style["-webkit-text-size-adjust"]="none",(0,h.vP)(e,"ucmLinkColor"),this.addLinkMouseover(e),e}},{key:"createLinkSpan",value:function(){var e=document.createElement("span");return e.style.fontWeight="normal",e.style.fontFamily="Tahoma, Arial, Helvetica, sans-serif",e.style.fontSize="12px",e.style["-webkit-text-size-adjust"]="none",(0,h.vP)(e,"ucmLinkColor"),e}},{key:"addLinkMouseover",value:function(e){(0,h.vP)(e,"ucmLinkHover"),e.onmouseenter=function(){e.style.cursor="pointer"},e.onmouseleave=function(){e.style.cursor="default"}}}],[{key:"setUCMContainer",value:function(e){_.ucmContainer=e}},{key:"setUserContextMenuState",value:function(e){_.state=e}}]),_}(L.B);j.state=2},3328:function(e,t,n){"use strict";n.d(t,{_:function(){return S}});var i=n(2951),o=n(1976),r=n(7591),s=n(9492),a=n(7597),l=n(1185),c=n(7693),u=n(3243),d=n(6079),h=n(1522),f=n(3753),p=n(695),m=n(4793),v=n(3705),g=n(3543),y=n(9420),b=n(858);var w=function(e){(0,r.Z)(w,e);var t,n,b=(t=w,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function w(e,t,n){return(0,i.Z)(this,w),b.call(this,e,t,n)}return(0,o.Z)(w,[{key:"addRestMenu",value:function(){var e=this;if((0,u.Z)((0,a.Z)(w.prototype),"addRestMenu",this).call(this),this.currentUsername!==this.user.username){this.modSection.style.display="",this.promoteModSection=document.createElement("div"),(0,l.vP)(this.promoteModSection,"ucmPromoteModSection"),this.promoteModSection.style.borderTopWidth="1px",this.promoteModSection.style.borderTopStyle="solid",this.promoteModSection.style.padding="5px 0",this.hasTippedSection=document.createElement("div"),(0,l.vP)(this.hasTippedSection,"ucmHasTippedSection"),this.hasTippedSection.style.padding="9px 10px",this.hasTippedSection.style.borderTopWidth="1px",this.hasTippedSection.style.borderTopStyle="solid",this.menuContents.insertBefore(this.promoteModSection,this.modSection.nextSibling),this.menuContents.appendChild(this.hasTippedSection);var t=this.createLink();t.dataset.testid="kick-ban-toggle";var n=this.createLinkSpan();n.style.paddingLeft="20px",this.modSection.appendChild(t),t.appendChild(n),n.innerText=g.ag.kickBan,(0,c.j9)("click",t,(function(){e.hideOverlay(),(0,p.Cg)('You must be logged in to ban a user. Click "OK" to login.')||(0,h.oB)(g.ag.banUserConfirm(e.user.username),(function(){(0,v.fg)("BanUser",{username:e.user.username}),(0,f.I5)("roomban/".concat(e.user.username,"/").concat(e.roomName,"/"),{}).catch((function(t){error(t),(0,h.Cj)(g.ag.banUserError(e.user.username))}))}))}));var i=document.createElement("div"),o=document.createElement("img"),r=document.createElement("span");o.src="".concat(STATIC_URL,"ico-tip.gif"),o.style.width="13px",o.style.height="13px",o.style.padding="2px 4px 0 1px",i.appendChild(o),i.appendChild(r),r.innerText="".concat(g.ag.userHasTippedMe(this.user.username),":"),this.hasTippedSection.appendChild(i);var s=document.createElement("div"),d=document.createElement("div"),m=document.createElement("div");s.style.paddingLeft="20px",d.style.paddingLeft="20px",m.style.paddingLeft="20px";var y=document.createElement("span"),b=document.createElement("span"),C=document.createElement("span");s.appendChild(y),d.appendChild(b),m.appendChild(C),y.innerText=g.ag.tokensInPastHour(0),y.dataset.testid="tipped-hour",b.innerText=g.ag.tokensInPastDay(0),b.dataset.testid="tipped-day",C.innerText=g.ag.tokensInPastTwoWeeks(0),C.dataset.testid="tipped-two-weeks",i.appendChild(s),i.appendChild(d),i.appendChild(m),void 0!==this.roomName&&void 0!==this.currentUsername&&(0,f.I5)("api/getchatusermenu/",{roomname:this.roomName,fromuser:this.currentUsername,touser:this.user.username}).then((function(t){e.promoteModSection.appendChild(e.createChangeModStatusLink(Boolean(t.getResponseHeader("X-Target_Is_Mod")),e.user)),y.innerText=g.ag.tokensInPastHour(e.getTipHeaderValue(t.getResponseHeader("X-Tipped_Performer_Last_Hour"))),b.innerText=g.ag.tokensInPastDay(e.getTipHeaderValue(t.getResponseHeader("X-Tipped_Performer_Last_24_Hours"))),C.innerText=g.ag.tokensInPastTwoWeeks(e.getTipHeaderValue(t.getResponseHeader("X-Tipped_Performer_Last_Two_Weeks")))})).catch((function(e){error(e),(0,h.Cj)("Error fetching user menu")}))}}},{key:"addLinksData",value:function(){var e=this;(0,u.Z)((0,a.Z)(w.prototype),"addLinksData",this).call(this);var t=this.createLink();t.style.display="none";var n=document.createElement("img");n.style.padding="0px 5px 0 2px",n.style.verticalAlign="bottom",t.appendChild(n);var i=this.createLinkSpan();t.appendChild(i),m.kN.once((function(o){var r=d.M.getInstance();if(void 0!==r){var s=r.getContextMenuLinkInfo(e.user.username);""!==s.linkText&&(n.src=s.icon,i.textContent=s.linkText,(0,c.j9)("click",t,(function(){s.action(),e.hideOverlay()})),t.style.display="")}})),this.menuLinks.prepend(t)}},{key:"createChangeModStatusLink",value:function(e,t){var n,i,o,r=this,s=this.createLink(),a=this.createLinkSpan();return a.style.paddingLeft="20px",s.dataset.testid="moderator-toggle",e?(a.innerText=g.ag.removeModeratorStatus,n='You must be logged in to remove a moderator. Click "OK" to login.',i="removemoderator/".concat(t.username,"/").concat(this.roomName,"/"),o="Error promoting user ".concat(t.username)):(a.innerText=g.ag.promoteToModerator,n='You must be logged in to promote a user to moderator. Click "OK" to login.',i="addmoderator/".concat(t.username,"/").concat(this.roomName,"/"),o="Error promoting user ".concat(t.username)),(0,c.j9)("click",s,(function(){r.hideOverlay(),(0,p.Cg)(n)||(0,f.I5)(i,{}).then((function(){y.CD.fire({isMod:!e,username:t.username})})).catch((function(e){error(e),(0,h.Cj)(o)}))})),s.appendChild(a),s}},{key:"getTipHeaderValue",value:function(e){if(null===e)return 0;var t=Number(e);return t<0?0:t}}]),w}(b.Wu),C=n(4406),x=n(9),k=n(9482);var S=function(e){(0,r.Z)(d,e);var t,n,u=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,a.Z)(t);if(n){var o=(0,a.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)});function d(e,t){var n,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,i.Z)(this,d),(n=u.call(this)).user=e,(0,l.vP)(n.element,(0,k.c9)(e)),n.element.style.height="auto",n.element.style.width="auto",n.element.style.position="",n.element.style.display="inline-block",n.element.style.maxWidth="100%",n.element.style.textOverflow="ellipsis",n.element.style.whiteSpace="nowrap",n.element.style.fontWeight="bold",n.element.style.cursor="pointer",n.element.style.overflow="visible",n.badgeSpan=C.x.createBadges(e.username),n.element.appendChild(n.badgeSpan),n.usernameText=document.createElement("span"),n.usernameText.dataset.testid="username",n.usernameText.textContent=e.username,n.usernameText.title=g.ag.usernameText,n.element.appendChild(n.usernameText),o){var r=document.createElement("img");r.style.display="inline-block",r.style.height="16px",r.style.margin="0 5px",r.style.verticalAlign="middle",r.src=(0,k.Fg)(e.gender),r.title=g.ag.genderSymbolToIconTitle(e.gender),n.element.insertBefore(r,n.element.firstChild),n.element.style.whiteSpace="nowrap"}n.element.onmouseenter=function(){n.element.style.textDecoration="underline"},n.element.onmouseleave=function(){n.element.style.textDecoration="none"};var s=function(i){i.preventDefault(),null!==n.element.parentElement?((0,v.fg)("OpenUserContextMenu",{username:e.username}),d.createUserContextMenu(e,n.usernameText,t)):error("Username span has no parent")};return(0,c.j9)("click",n.element,s),(0,c.j9)("contextmenu",n.element,s),n}return(0,o.Z)(d,[{key:"createMentionLabel",value:function(e,t){return this.usernameText.textContent="@".concat(this.user.username),this.badgeSpan.style.display="none",t&&((0,l.vP)(this.element,"mentionHl"),this.element.style.padding="2px"),this.element}}],[{key:"createUserContextMenu",value:function(e,t,n){2===b.Wu.state&&((0,k.hY)()?new w(e,t,n):new b.Wu(e,t,n))}}]),d}(x.w)},2974:function(e,t,n){"use strict";n.d(t,{S:function(){return f}});var i=n(2951),o=n(1976),r=n(8759),s=n(1234),a=n(1794),l=n(4801),c=n(1625),u=n(3705),d=new l.KS("AflThtrMd3"),h=function(){function e(){var t=this;(0,i.Z)(this,e),this.storageKey="isTheaterMode",this.changeVideoMode=new a.xB("changeVideoMode",{listenersWarningThreshold:function(){return 20+a.q6}});var n=this.getInitialVideoMode(),o="split"===n?"theater":"split";this.videoMode=n,this.lastVideoMode=o,this.lastNonFullscreenVideoMode=o,this.saveVideoModeStorage(),this.listenForFullscreen(),(0,u.zB)(this.videoMode),d.active&&"theater"===this.videoMode&&d.record(),d.eligible&&(0,u.fg)("AfflThtrMd",{group:d.active?"active":"inactive",page:"non-fullvideo"}),s.C.listen((function(e){t.isMobile="mobile"===e,t.isMobile&&((0,c.rm)()?(0,u.zB)("landscapeFullscreen"):(0,u.zB)("portraitClassic"))}))}return(0,o.Z)(e,[{key:"listenForFullscreen",value:function(){var e=this;c.gH.listen((function(){(0,c.rm)()?window.setTimeout((function(){"fullscreen"!==e.videoMode&&f.setFireVideoMode("noninteractive-fullscreen")}),0):f.setFireVideoMode(e.lastNonFullscreenVideoMode)}))}},{key:"setVideoModeInternal",value:function(e){return!!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]||e!==this.videoMode)&&(-1===["noninteractive-fullscreen","fullscreen","fullvideo"].indexOf(this.videoMode)&&(this.lastNonFullscreenVideoMode=this.videoMode),this.lastVideoMode=this.videoMode,this.videoMode=e,"noninteractive-fullscreen"===this.videoMode&&this.isMobile?(0,u.zB)("landscapeFullscreen"):(0,u.zB)(this.videoMode),this.saveVideoModeStorage(),!0)}},{key:"setVideoMode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.setVideoModeInternal(e,t)}},{key:"setFireVideoMode",value:function(e,t){var n,i;(this.setVideoModeInternal(e,null!==(n=null==t?void 0:t.update)&&void 0!==n&&n)||null!==(i=null==t?void 0:t.fire)&&void 0!==i&&i)&&this.changeVideoMode.fire({currentMode:this.videoMode,previousMode:this.lastVideoMode})}},{key:"saveVideoModeStorage",value:function(){["split","theater"].includes(this.videoMode)&&(0,r.IU)()&&window.localStorage.setItem(this.storageKey,JSON.stringify({isTheaterMode:"theater"===this.videoMode}))}},{key:"getInitialVideoMode",value:function(){var e=d.active?"theater":"split";if((0,r.IU)()){var t=window.localStorage.getItem(this.storageKey);if(null!==t){var n=JSON.parse(t).isTheaterMode;e=Boolean(n)?"theater":"split"}}return e}},{key:"getVideoMode",value:function(){return this.videoMode}},{key:"getPreviousNonFullscreenVideoMode",value:function(){return this.lastNonFullscreenVideoMode}}]),e}(),f=new h},2750:function(e,t,n){"use strict";n.d(t,{MY:function(){return l},Pv:function(){return a},UG:function(){return p},jZ:function(){return u},me:function(){return C},oc:function(){return y},rq:function(){return d},uX:function(){return c},zd:function(){return b}});var i=n(7693),o=n(3753),r=n(1794),s=n(1625);function a(e,t,n,i){l(e,t,n)}function l(e,t,n,i){return new Promise((function(i){var r;(0,s.rm)()?((0,s.Qg)(),window.setTimeout((function(){var r=window.open((0,o.BN)(e),t,n);null!==r&&window.setTimeout((function(){r.focus()}),200),i(null!=r?r:void 0)}),s.Vc)):i(null!==(r=window.open((0,o.BN)(e),t,n))&&void 0!==r?r:void 0)}))}var c="status=0,toolbar=1,menubar=0,directories=0,resizable=1,scrollbars=1,height=768,width=850,top=50,left=50",u="status=0,toolbar=0,menubar=0,directories=0,resizable=1,scrollbars=1,height=768,width=850",d="status=0,toolbar=0,menubar=0,directories=0,resizable=1,scrollbars=1,height=700,width=715",h="",f="";"hidden"in document?(h="hidden",f="visibilitychange"):"msHidden"in document?(h="msHidden",f="msvisibilitychange"):"webkitHidden"in document&&(h="webkitHidden",f="webkitvisibilitychange");var p=new r.xB("documentVisibilityChange",{maxHistorySize:1}),m=!document[h],v=function(e){m!==e&&(m=e,p.fire(m))};if(""!==h&&""!==f){var g=function(){v(!document[h])};(0,i.j9)(f,document,g),(0,i.j9)("pagehide",window,(function e(){(0,i.SC)(f,document,g),(0,i.SC)("pagehide",window,e),v(!1),(0,i.j9)("pagehide",window,(function(){v(!1)})),(0,i.j9)("pageshow",window,(function(){v(!0)}))}))}else(0,i.j9)("blur",window,(function(){v(!1)})),(0,i.j9)("focus",window,(function(){v(!0)}));function y(){return m}function b(){try{return window.self!==window.top}catch(e){return!0}}var w=(new Date).getTime();function C(){return((new Date).getTime()-w)/1e3}},5543:function(e,t,n){"use strict";n.d(t,{r:function(){return It},c:function(){return Tt}});var i=n(2951),o=n(1976),r=n(949),s=n(6474),a=n(8213),l=n(6272),c=n(7591),u=n(9492),d=n(7597),h=n(7693),f=n(9),p=n(9165),m=n(2578),v=n(9760),g=n(3243),y=n(3753);var b=function(e){(0,c.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,d.Z)(t);if(n){var o=(0,d.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,u.Z)(this,e)});function s(e){var t;return(0,i.Z)(this,s),t=r.call(this,e),e.gender!==p.Y0.All?t.url=new URL("../",t.element.href):t.url=new URL(t.element.href),t}return(0,o.Z)(s,[{key:"createElement",value:function(e){return e.anchorElement}},{key:"updateState",value:function(){(0,g.Z)((0,d.Z)(s.prototype),"updateState",this).call(this);var e=this.url.searchParams.toString();e=""===e?"":"?".concat(e);var t=this.url.pathname===(0,y.BN)("/")?(0,p.eN)(this.state.gender):p.aI.get(this.state.gender),n=""===t?"":"".concat(t,"/");this.element.href=(0,y.BN)("".concat(this.url.pathname).concat(n).concat(e))}}]),s}(n(7585).I),w=n(8871);var C=function(e){(0,c.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,d.Z)(t);if(n){var o=(0,d.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,u.Z)(this,e)});function s(e){var t;(0,i.Z)(this,s),(t=r.call(this,e)).genderedLinks=[];var n=e.querySelector(".nav");null!==n&&n instanceof HTMLElement&&(0,v.FR)(n,["padding-left","padding-right"],10,65,500,800);var o=document.querySelector(".footer-holder .footer-cb-address");return null!==o&&o instanceof HTMLElement&&(0,v.FR)(o,"margin-left",-55,0,500,589,(function(e){0===e&&(o.style.marginLeft="")})),e.querySelectorAll(".footercon a").forEach((function(e){(0,h.j9)("click",e,(function(e){w.k4.fire(e)}))})),e.querySelectorAll("div[gendered-category] a").forEach((function(e){t.genderedLinks.push(new b({anchorElement:e,gender:(0,p.ej)()}))})),w.Me.addListener((function(e){t.genderedLinks.forEach((function(t){t.setState({gender:e})})),document.querySelectorAll("#footer-holder form").forEach((function(e){(0,m.nM)(e)}))}),t.element),t}return(0,o.Z)(s)}(f.w),x=n(8263),k=n(3607),S=n(3705),T=n(2800),I=n(1612),R=n(5696);function P(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var A=function(e){(0,c.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,d.Z)(t);if(n){var o=(0,d.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,u.Z)(this,e)});function s(e){var t;return(0,i.Z)(this,s),(t=r.call(this,e)).makeLogoResponsive(),t.makeHeaderAdResponsive(),t.addHeaderAdPageAction(),t.makeTopNavResponsive(),t.makeUserInfoResponsive(),t.bindLinkUpdateHandling(),t}return(0,o.Z)(s,[{key:"makeTopNavResponsive",value:function(){var e=this;this.genderedLinks=[],this.initFirstTopSectionAnchor();var t=document.querySelector(".nav-bar");null!==t&&(0,v.FR)(t,["padding-left"],4,15,500,600);var n=document.getElementById("nav");if(null!==n){this.nav=new f.w(n);var i=(0,p.ej)();Array.from(n.children).forEach((function(t){if(t instanceof HTMLLIElement){var n=new R.tB(t);e.nav.attachChild(n),n.element.style.display="block";var o=n.element.getElementsByTagName("a")[0];if(null!==o&&o instanceof HTMLAnchorElement){var r=getComputedStyle(o);o.style.color=r.color,o.style.font=r.font,o.style.fontFamily=r.fontFamily,o.style.fontWeight=r.fontWeight,o.style.fontSize=r.fontSize,o.hasAttribute("gendered-link")&&e.genderedLinks.push(new b({anchorElement:o,gender:i}))}o.onfocus=function(){e.focusIntoDropdown(n)},o.onblur=function(t){e.blurOutOfDropdown(t)},n.onCollapseEvent.listen((function(e){n.element.style.padding=e?"8px 4px":""}))}}));var o=new R.QY("li",!0);this.nav.addChild(o),(0,x.pY)(o.element),(0,x.Zs)(o,{border:"1px solid transparent",borderRadius:"4px 4px 0 0",height:"30px",top:"6px",width:"39px",paddingTop:"3px",color:I.w.navigationFontColor}),o.dropDown.toggleEvent.listen((function(e){e.isShowing?o.element.style.border="1px solid ".concat(I.w.tabBorderColor):o.element.style.border="1px solid transparent"})),(0,x.Zs)(o.dropDown,{borderColor:"".concat(I.w.tabBorderColor),padding:"8px 20px 8px 8px"}),o.dropDown.element.classList.add("header-dropdown"),this._headerCollapseDropDownTab=o,this.setCollapsibleDropdownSpacerWidth()}}},{key:"focusIntoDropdown",value:function(e){(0,R.OF)(e)&&(this._headerCollapseDropDownTab.dropDown.showElement(),this.setTabIndexForDropdown(200),window.setTimeout((function(){e.element.getElementsByTagName("a")[0].focus()}),0))}},{key:"blurOutOfDropdown",value:function(e){var t=e.target,n=e.relatedTarget;e.preventDefault(),t instanceof HTMLAnchorElement&&this._headerCollapseDropDownTab.isTargetOverflownAnchor(t)&&(n instanceof HTMLElement&&!this._headerCollapseDropDownTab.isTargetOverflownAnchor(n)||null===n)&&(this.setTabIndexForDropdown(0,!0),this._headerCollapseDropDownTab.dropDown.hideElement())}},{key:"setTabIndexForDropdown",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this._headerCollapseDropDownTab.lastShownSibling();void 0!==n&&(n.element.getElementsByTagName("a")[0].tabIndex=t?0:e);var i,o=P(this._headerCollapseDropDownTab.dropDown.element.getElementsByTagName("a"));try{for(o.s();!(i=o.n()).done;)i.value.tabIndex=t?0:e+1}catch(e){o.e(e)}finally{o.f()}null!==this.firstTopSectionAnchor&&void 0!==this.firstTopSectionAnchor&&(this.firstTopSectionAnchor.tabIndex=t?0:e+2)}},{key:"initFirstTopSectionAnchor",value:function(){var e=document.querySelector(".top-section");null!==e&&(this.firstTopSectionAnchor=e.getElementsByTagName("a")[0],void 0===this.firstTopSectionAnchor&&(this.firstTopSectionAnchor=e.getElementsByTagName("li")[0]))}},{key:"setCollapsibleDropdownSpacerWidth",value:function(){if(void 0!==this.nav&&null!==this.nav.element.parentElement){var e,t=0,n=P(this.nav.element.parentElement.children);try{for(n.s();!(e=n.n()).done;){var i=e.value;i!==this.nav.element&&i instanceof HTMLElement&&(t+=i.offsetWidth)}}catch(e){n.e(e)}finally{n.f()}this._headerCollapseDropDownTab.setSpacerWidth(t)}}},{key:"makeHeaderAdResponsive",value:function(){var e=document.querySelector("#header .ad");if(null!==e&&e instanceof HTMLElement){var t=document.querySelector(".right_section"),n=(0,x.r7)(null!==e.firstElementChild&&e.firstElementChild instanceof HTMLElement?e.firstElementChild:e),i=n.width?n.right:(0,x.r7)(e).right;v.nR.listen((function(){var n=null===t?document.body.offsetWidth:t.offsetLeft;e.style.display=n-25<i?"none":"block"}))}}},{key:"addHeaderAdPageAction",value:function(){var e=document.querySelector("#header .ad a");null!==e&&(e.onclick=function(){(0,S.fg)("BannerAdClicked",{content:"real_ads",ad_title:e.getAttribute("data-feature-show-title"),location:T.J.current.pageLocation})})}},{key:"makeLogoResponsive",value:function(){var e=document.querySelector(".logo-zone");if(null!==e&&e instanceof HTMLElement){var t=document.querySelector(".logo-zone svg"),n=document.querySelector(".logo-zone strong:last-child");(0,v.FR)(e,"padding-left",8,15,500,600),(0,v.FR)(e,"padding-top",12,6,500,600),null!==t&&t instanceof HTMLElement&&((0,v.FR)(t,"width",145,198,500,600),(0,v.FR)(t,"height",45,61,500,600)),null!==n&&n instanceof HTMLElement&&((0,v.FR)(n,"font-size",8,10,500,600),(0,v.FR)(n,"padding-left",13,17,500,600));var i=document.querySelector(".logo-zone .logo");if(null!==i&&i instanceof HTMLElement){var o=i.clientWidth;o>500-(0,x.np)()&&v.nR.listen((function(){o+i.offsetLeft>(0,k._U)()?i.style.maxWidth="".concat((0,k._U)()-i.offsetLeft-1,"px"):i.style.maxWidth=""}))}}}},{key:"makeUserInfoResponsive",value:function(){var e=document.querySelector("#user_information");null!==e&&e instanceof HTMLElement&&(0,v.FR)(e,"margin-right",4,15,500,600)}},{key:"bindLinkUpdateHandling",value:function(){var e=this;w.Me.addListener((function(t){e.genderedLinks.forEach((function(e){e.setState({gender:t})}))}),this.element)}}]),s}(f.w),E=n(7397),B=n(7542),L=n(2765),O=n(8759),D=n(1522),U=n(695),Z=n(6767),F=n(7191);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,d.Z)(e);if(t){var o=(0,d.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,u.Z)(this,n)}}var N=function(e){(0,c.Z)(n,e);var t=_(n);function n(e){var o,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,i.Z)(this,n),(o=t.call(this,null!=s?s:{},e,r)).toggleElement=e,o}return(0,o.Z)(n)}(F.Ku),j=function(e){(0,c.Z)(n,e);var t=_(n);function n(e){return(0,i.Z)(this,n),t.call(this,e)}return(0,o.Z)(n,[{key:"initUI",value:function(){(0,g.Z)((0,d.Z)(n.prototype),"initUI",this).call(this),this.element.style.display="block"}},{key:"showElement",value:function(){var e=this.element.parentElement;return null!==e&&(e.classList.toggle("pushmenu-animate",!0),this.toggleEvent.fire(new F.cJ(!0)),!0)}},{key:"hideElement",value:function(){var e=this.element.parentElement;return null!==e&&(e.classList.toggle("pushmenu-animate",!1),this.toggleEvent.fire(new F.cJ(!1)),!0)}},{key:"isShown",value:function(){var e=this.element.parentElement;return null!==e&&e.classList.contains("pushmenu-animate")}}]),n}(N),H=n(3340),z=n(4649),W=n(6832),V=n(8525),q=n(6265),K=n(2239),J=n(3543),G=n(47),Y=n(7122),$=n(5925),Q=n(932),X=n(1994),ee=n(8015),te=n(8107),ne=n(8069),ie=n(5343),oe=n(4043);var re=function(e){(0,c.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,d.Z)(t);if(n){var o=(0,d.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,u.Z)(this,e)});function s(e){var t;return(0,i.Z)(this,s),t=r.call(this,"div",e),(0,$.Rp)(),t}return(0,o.Z)(s,[{key:"initData",value:function(e){this.myUsername=e.myUsername,this.allDmWindowsMap=new Map,this.orderedDmSessionKeys=new ie.O,this.isTouchingScreen=!1,this.onShow=e.onShow,this.onHide=e.onHide}},{key:"initUI",value:function(e){var t=this;this.element=(0,G.vz)("div",{style:{width:"320px",height:"calc(var(--vh, 1vh) * 100)",position:"absolute",top:0,bottom:0,left:0,backgroundColor:"#FFF",color:"#000",boxSizing:"border-box",display:"flex",flexDirection:"column"}},(0,G.vz)(ce,{onClick:function(){t.handleBackButtonClick()}})),(0,K.pS)(this.element,"transform 150ms ease"),this.bindMenuChangeEvents(),this.bindListeners(),this.bindWindowListeners(),this.initVirtualKeyboardHandling(),this.hideElement()}},{key:"showElement",value:function(){(0,x.Zs)(this.element,{transform:"translateX(0)"}),this.onShow()}},{key:"hideElement",value:function(){(0,x.Zs)(this.element,{transform:"translateX(-100%)"}),this.onHide();var e=this.orderedDmSessionKeys.currentElem;void 0!==e&&this.hideWindow(e)}},{key:"bindListeners",value:function(){var e=this;E.nh.listen((function(t){e.showElement(),void 0===e.allDmWindowsMap.get(t)&&e.createWindow(t),e.showWindow(t)})),E.Lj.listen((function(t){var n=t.username,i=t.deleteWindow,o=e.getCurrentOpenWindow();(null==o?void 0:o.username)===n&&e.removeShownWindow(),!0===i&&e.allDmWindowsMap.delete(n)})),ee.Kd.listen((function(t){var n=e.allDmWindowsMap.get(t.otherUsername);void 0!==n&&n.handleNewMessage(t)})),(0,X.I)((function(t){return e.allDmWindowsMap.get(t)}))}},{key:"createWindow",value:function(e){if(!this.allDmWindowsMap.has(e)){var t=new Q.Dv({username:e,myUsername:this.myUsername,open:!0,markAsRead:!0,raiseWindowZIndexToTop:function(){}});this.allDmWindowsMap.set(e,t),this.orderedDmSessionKeys.addToTop(e),this.addChild(t)}}},{key:"removeShownWindow",value:function(){var e=this.getCurrentOpenWindow();void 0!==e&&(e.removeFromDOM(),this.orderedDmSessionKeys.remove(e.username),this.handleBackButtonClick())}},{key:"showWindow",value:function(e){var t=this.orderedDmSessionKeys.currentElem;void 0!==t&&this.hideWindow(t);var n=this.allDmWindowsMap.get(e);void 0!==n&&(this.orderedDmSessionKeys.makeCurrent(e),n.openOrCollapseWindow(!0))}},{key:"getCurrentOpenWindow",value:function(){var e,t=this.allDmWindowsMap.get(null!==(e=this.orderedDmSessionKeys.currentElem)&&void 0!==e?e:"");return!0===(null==t?void 0:t.isWindowOpen())?t:void 0}},{key:"hideWindow",value:function(e){var t=this.allDmWindowsMap.get(e);void 0!==t&&t.openOrCollapseWindow(!1)}},{key:"handleBackButtonClick",value:function(){this.hideElement()}},{key:"bindMenuChangeEvents",value:function(){var e=this;oe.YL.listen((function(t){t||e.hideElement()}))}},{key:"blurInputIfFocused",value:function(){var e=this.getCurrentOpenWindow();!0===(null==e?void 0:e.isInputFocused())&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()}},{key:"bindWindowListeners",value:function(){var e,t=this,n=window.innerWidth,i=function(){var e=t.getCurrentOpenWindow();window.innerWidth!==n&&(null==e||e.scrollToBottom(),n=window.innerWidth,window.setTimeout((function(){null==e||e.scrollToBottom()}),300),t.blurInputIfFocused())};(0,h.j9)("resize",window,(function(){if((0,O.Tt)())(0,O.G6)()?i():window.setTimeout(i,125);else{var e=t.getCurrentOpenWindow();null==e||e.resizeTipCallout()}})),(0,h.j9)("touchstart",window,(function(){t.isTouchingScreen=!0})),(0,h.j9)("touchend",window,(function(){t.isTouchingScreen=!1})),null===(e=window.visualViewport)||void 0===e||e.addEventListener("scroll",(function(){t.isTouchingScreen&&t.blurInputIfFocused()}))}},{key:"initVirtualKeyboardHandling",value:function(){var e=this,t=new ne.d((function(){var t;e.element.style.top="".concat(null===(t=window.visualViewport)||void 0===t?void 0:t.offsetTop,"px");var n=window.setInterval((function(){var t;e.element.style.top="".concat(null===(t=window.visualViewport)||void 0===t?void 0:t.offsetTop,"px")}),100);window.setTimeout((function(){window.clearInterval(n)}),1e3)}),{bounceLimitMS:1e3,debounceType:2});te.K.listen((function(){t.callFunc()})),(0,h.j9)("scroll",document,(function(){t.callFunc()}))}}]),s}(f.w);function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(Object(n),!0).forEach((function(t){(0,z.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var le=function(e){(0,c.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,d.Z)(t);if(n){var o=(0,d.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,u.Z)(this,e)});function s(e){return(0,i.Z)(this,s),r.call(this,"div",e)}return(0,o.Z)(s,[{key:"initData",value:function(e){this.dmListIconRoot=e.dmListIconRoot,this.userUpdatesBellRoot=e.userUpdatesBellRoot,this.hamburgerIcon=e.hamburgerIcon}},{key:"initUI",value:function(e){var t,n=this,i={width:"320px",position:"fixed",top:0,bottom:0,left:0,backgroundColor:"#FFF",color:"#000",boxSizing:"border-box",display:"flex",flexDirection:"column"},o=null===(t=T.J.current.loggedInUser)||void 0===t?void 0:t.username;if(void 0!==o){var r=new V.E({isFullVideoMode:!1,room:""});this.dmList=new Y.i({onItemRemoved:function(){},openConversationEvent:E.nh,isDropdown:!0,searchBar:r}),this.contentMask=(0,G.vz)("div",{style:{width:"320px",display:"none",position:"fixed",top:0,bottom:0,left:0,backgroundColor:"#FFF"}});var s=new re({myUsername:o,onShow:function(){return n.toggleMaskingContent(!0)},onHide:function(){return n.toggleMaskingContent(!1)}});this.element=(0,G.vz)("div",{style:i},(0,G.vz)(ce,{onClick:function(){n.handleBackButtonClick()}}),r.element,this.dmList.element,this.contentMask,s.element)}else{var a={color:"#0a5a83",textDecoration:"none"};this.element=(0,G.vz)("div",{style:i},(0,G.vz)("div",{style:{height:"45px",display:"flex",alignItems:"center",paddingLeft:"10px",borderBottom:"1px solid #EFEFEF"}},J.ag.directMessageLabel),(0,G.vz)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",flex:1}},(0,G.vz)("img",{style:{display:"inline-block",width:"50px",height:"50px"},src:"".concat(STATIC_URL,"pms/empty-chat-state.svg")}),(0,G.vz)("span",{style:{margin:"25px 0",display:"inline-block"}},J.ag.sendDirectMessage),(0,G.vz)("span",{style:ae(ae({},a),{},{marginBottom:"50px"}),onClick:function(){-1!=="".concat(window.location.pathname).concat(window.location.search).indexOf(m.PU)||(0,q.iW)({fromFeature:!0});var e=document.querySelector(".push-overlay");n.hideElement(),e instanceof HTMLElement&&e.click()}},J.ag.loginVerbText),(0,G.vz)("span",null,J.ag.dontHaveAccount," ",(0,G.vz)("a",{href:m.Ng,style:a,"account-redirect":!0},J.ag.signUpText))))}(0,K.pS)(this.element,"transform 150ms ease"),this.bindIconClickEvent(),this.bindMenuChangeEvents(),this.bindNumUnreadEvents(),this.bindResizeEvents(),this.hideElement()}},{key:"handleBackButtonClick",value:function(){this.hideElement()}},{key:"showElement",value:function(){(0,x.Zs)(this.element,{transform:"translateX(0)"}),this.dmListIconRoot.classList.add("active")}},{key:"hideElement",value:function(){(0,x.Zs)(this.element,{transform:"translateX(-100%)"}),this.dmListIconRoot.classList.remove("active")}},{key:"toggleMaskingContent",value:function(e){this.contentMask.style.display=e?"block":"none"}},{key:"isShown",value:function(){return"translateX(-100%)"!==this.element.style.transform}},{key:"bindIconClickEvent",value:function(){var e=this;this.dmListIconRoot.onclick=function(){e.isShown()||e.showElement()}}},{key:"bindMenuChangeEvents",value:function(){var e=this;oe.ah.listen((function(t){t&&!e.isShown()?e.showElement():!t&&e.isShown()&&e.hideElement()})),oe.YL.listen((function(t){t||e.hideElement()}))}},{key:"bindNumUnreadEvents",value:function(){var e=this;W.zS.unreadConversationsCountUpdate.listen((function(){var t,n,i,o,r;void 0!==e.dmList&&((null===(t=e.dmList)||void 0===t?void 0:t.getNumUnread())>0?(e.dmListIconRoot.classList.add("has_unread"),null===(n=e.hamburgerIcon)||void 0===n||n.classList.add("has_unseen")):(e.dmListIconRoot.classList.remove("has_unread"),null!==(i=null===(o=e.userUpdatesBellRoot)||void 0===o?void 0:o.classList.contains("has_unseen"))&&void 0!==i&&i||null===(r=e.hamburgerIcon)||void 0===r||r.classList.remove("has_unseen")))}))}},{key:"bindResizeEvents",value:function(){var e=this;(0,O.Tt)()||(0,h.j9)("resize",window,(function(){var t=(0,k.mP)();e.element.style.top=t<250?"":"0"}))}}]),s}(f.w),ce=function(e){return(0,G.vz)("span",{style:{height:"45px",display:"flex",alignItems:"center",paddingLeft:"10px",color:"#306A91",borderBottom:"1px solid #EFEFEF"},onClick:e.onClick},J.ag.back)},ue=n(6874),de=n(2750),he=n(1185),fe=n(9846),pe=n(7510),me=n(2952);var ve=function(e){(0,c.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,d.Z)(t);if(n){var o=(0,d.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,u.Z)(this,e)});function s(e){var t;return(0,i.Z)(this,s),(t=r.call(this,e.toggleElement,!0,e)).convosOpenedWithoutClosingDropdown=0,(0,h.j9)("keydown",document,(function(e){var n;if(t.isShown()){var i,o=t.dmList.element.contains(document.activeElement),r=!0===(null===(n=E.qd.getInstance())||void 0===n?void 0:n.element.contains(document.activeElement));if("Tab"===e.key)o||!t.element.contains(document.activeElement)?null===(i=t.popoutLink)||void 0===i||i.focus():t.dmList.focusSearchBar(),e.stopPropagation(),e.preventDefault();else"Escape"===e.key?t.hideElement():o||r||!["ArrowUp","ArrowDown"].includes(e.key)&&!(0,fe.r)(e.keyCode)||t.dmList.focusSearchBar()}})),me.y.showingEvent.listen((function(){return t.hideElement()})),E.nh.listen((function(){t.isShown()&&(t.convosOpenedWithoutClosingDropdown+=1,(0,S.fg)("OpenedDmFromDropdown",{seq_convos_opened:t.convosOpenedWithoutClosingDropdown}))})),W.zS.unreadConversationsCountUpdate.listen((function(e){var n=e.dmsCount;t.updateNumUnread(n)})),t}return(0,o.Z)(s,[{key:"initUI",value:function(e){var t=this,n=(0,U.TF)(),i={fontFamily:"UbuntuRegular, Tahoma, Arial, Helvetica, sans-serif",fontSize:"14px",borderWidth:"1px",borderStyle:"solid",borderRadius:"4px 0 4px 4px",boxShadow:"0px 0px 16px rgba(0, 0, 0, 0.32)",height:n?"":"383px",maxHeight:"calc(var(--vh, 1vh) * 100 - ".concat(Q.Tx.expandedHeight," - 44px)"),minHeight:"280px",padding:"1px",position:"absolute",right:"0",width:"304px",display:"none",flexDirection:"column"};this.dmList=new pe.p({isDms:!0,clearSearchOnSelect:(0,O.s2)(),isFullVideoMode:!1,openConversationEvent:E.nh}),this.element=(0,G.vz)("div",{style:i,colorClass:"dmListDropdownRoot"},(0,G.vz)("div",{style:{padding:"10px 8px",borderBottomWidth:"1px",borderBottomStyle:"solid"},colorClass:"header"},(0,G.vz)("span",null,J.ag.directMessageLabel),(0,G.vz)("span",{style:{marginLeft:"4px"},ref:function(e){return t.numUnreadContainer=e}}),!n&&(0,G.vz)("button",{style:{display:"inline-block",position:"absolute",right:"8px",top:"12px",height:"13px",width:"13px",border:"none",cursor:"pointer"},title:J.ag.popoutInNewWindow,colorClass:"popoutIcon",ref:function(e){return t.popoutLink=e},onClick:function(){t.hideElement(),me.y.show()}})),n?(0,G.vz)(ge,null):this.dmList.element)}},{key:"showElement",value:function(){return(0,he.vP)(this.toggleElement,"active"),this.convosOpenedWithoutClosingDropdown=0,(0,g.Z)((0,d.Z)(s.prototype),"showElement",this).call(this,"flex")}},{key:"hideElement",value:function(e){var t;if(!(0,O.s2)()&&(null==e?void 0:e.target)instanceof HTMLElement&&(!0===(null===(t=E.qd.getInstance())||void 0===t?void 0:t.element.contains(e.target))||!document.body.contains(e.target)))return!1;var n=(0,g.Z)((0,d.Z)(s.prototype),"hideElement",this).call(this,e);return n&&(0,he.FU)(this.toggleElement,"active"),n}},{key:"updateNumUnread",value:function(e){var t=e>0;this.numUnreadContainer.innerText=t?"(".concat(e,")"):"",t?this.toggleElement.classList.add("has_unread"):this.toggleElement.classList.remove("has_unread")}}]),s}(N),ge=function(){var e={cursor:"pointer",fontSize:"12px"},t="".concat(STATIC_URL,"pms/empty-chat-state.svg");return(0,G.vz)("div",{style:{fontSize:"12px",marginTop:"0",padding:"44px 0 16px",position:"static",textAlign:"center",top:"50%",width:"100%"}},(0,G.vz)("img",{src:t,alt:"empty-chat-state"}),(0,G.vz)("div",{style:{fontSize:"14px",lineHeight:"18px",margin:"8px 0"},colorClass:"sendDmPrompt"},J.ag.sendDirectMessage),(0,G.vz)("div",{style:{margin:"16px 0 44px"}},(0,G.vz)("a",{style:e,colorClass:"link",onClick:function(e){e.preventDefault(),(0,q.iW)({fromFeature:!0})},"account-redirect":!0},J.ag.loginVerbText)),(0,G.vz)("div",{colorClass:"signupPrompt"},J.ag.dontHaveAccount," ",(0,G.vz)("a",{href:m.Ng,style:e,colorClass:"link",onClick:function(){(0,S.fg)("PMSignupClicked")},"account-redirect":!0},J.ag.signUpLower)))},ye=n(4484),be=n(1794),we=(0,o.Z)((function e(){(0,i.Z)(this,e)}));we.dropDownToggle=new be.xB("dropDownToggle"),we.updatesAreRead=new be.xB("updatesAreRead"),we.updatesAreUnread=new be.xB("updatesAreUnread"),we.tabItemsLoaded=new be.xB("tabItemsLoaded");var Ce=n(5809),xe=n(126),ke=n(7169),Se=n(8016),Te=n(391),Ie=function(){function e(){(0,i.Z)(this,e)}return(0,o.Z)(e,null,[{key:"getUserUpdates",value:function(e,t){var n=e.map((function(e){return"notification_type=".concat(e)})).join("&");(0,y.Ue)("notifications/updates/?".concat(n)).then((function(e){var n=new Te.j(e.responseText).getList("items");if(void 0!==n){var i=n.map((function(e){return{text:e.getString("text"),url:e.getString("url"),timestamp:e.getNumber("timestamp"),timeSince:e.getString("time_since"),seen:e.getBoolean("seen"),notificationType:e.getString("notification_type")}}));t(i)}})).catch((function(){}))}},{key:"recordLastSeen",value:function(e,t,n){(0,y.I5)(e,{timestamp:t.toString()}).then((function(){n()})).catch((function(){}))}},{key:"hasUnseen",value:function(e){(0,y.Ue)("notifications/has_unseen/").then((function(t){var n=JSON.parse(t.responseText);e(n.has_unseen)})).catch((function(){}))}}]),e}(),Re=n(2923);var Pe=function(e){(0,c.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,d.Z)(t);if(n){var o=(0,d.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,u.Z)(this,e)});function s(){var e;return(0,i.Z)(this,s),(e=r.call(this)).element.style.overflow="",e.element.style.position="static",e.element.style.overflowX="hidden",e.element.style.overflowY="auto",e.enableMomentumScrollingForIPad(),e}return(0,o.Z)(s,[{key:"enableMomentumScrollingForIPad",value:function(){var e=this;/iPad|iPhone|iPod/.test(navigator.platform)&&(this.element.style["-webkit-overflow-scrolling"]="touch",(0,h.j9)("scroll",this.element,(function t(){e.element.style.overflowY="scroll",(0,h.SC)("scroll",e.element,t)})))}}]),s}(f.w);var Me=function(e){(0,c.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,d.Z)(t);if(n){var o=(0,d.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,u.Z)(this,e)});function s(e){var t;(0,i.Z)(this,s),t=r.call(this),(0,he.vP)(t.element,"twitterUpdateRow"),t.element.style.fontFamily="UbuntuRegular, Helvetica, Arial, sans-serif",t.element.style.fontStyle="normal",t.element.style.fontWeight="normal",t.element.style.position="relative",t.element.style.height="",t.element.style.width="",t.element.style.margin="7px",t.element.style.padding="6px",t.setSeenColors(e.seen),t.element.style.borderWidth="1px",t.element.style.borderStyle="solid",t.element.style.borderRadius="4px",t.element.appendChild(t.createContentElement(e.text));var n,o,a="offline_tip"===e.notificationType&&T.J.current.isMobile;if(""!==e.timeSince){var l=(n=e.timeSince,o=document.createElement("div"),(0,he.vP)(o,"timeSince"),o.appendChild(document.createTextNode(n)),o.style.fontSize="9px",o.style.lineHeight="13px",o.style.cssFloat="left",o);t.element.appendChild(l)}if(""!==e.url&&!a){var c="twitter_feed";void 0!==e.notificationType&&(c=e.notificationType);var u=function(e,t){var n=document.createElement("a");n.href=(0,y.BN)(e),n.target="_blank";var i="twitter_feed"===t,o="offline_tip"===t,r=function(e){switch(e){case"twitter_feed":return J.ag.viewOnTwitterText;case"offline_tip":return J.ag.showTipsAndMessages}return J.ag.seeMore}(t);return n.appendChild(document.createTextNode(r)),(0,he.vP)(n,"twitterLink"),n.style.fontSize="9px",n.style.lineHeight="13px",n.style.textAlign="right",n.style.cssFloat="right",i?n.onclick=function(){(0,S.fg)("NewsfeedItemViewOnTwitter")}:o&&(n.onclick=function(){(0,S.fg)("OfflineTipItemLinkClick")}),n}(e.url,c);t.element.appendChild(u)}return t}return(0,o.Z)(s,[{key:"setSeenColors",value:function(e){e?(0,he.vP)(this.element,"seen"):(0,he.FU)(this.element,"seen")}},{key:"createContentElement",value:function(e){var t=this.buildContentFromText(e);return(0,he.vP)(t,"contentSection"),t.style.fontSize="12px",t.style.lineHeight="14px",t.style.whiteSpace="pre-wrap",t.style.marginBottom="6px",t.style.wordWrap=t.style.wordBreak="break-word",t.style.overflow="hidden",t}},{key:"buildContentFromText",value:function(e){var t=document.createElement("div");return t.innerHTML=e,this.makeLinksShorterAndAddStyle(t),t}},{key:"makeLinksShorterAndAddStyle",value:function(e){Array.from(e.querySelectorAll("a")).forEach((function(e){(0,he.vP)(e,"tweetLink"),e.target="_blank",e.style.outline="none",e.style.fontSize="12px",e.style.lineHeight="14px",null!==e.firstChild&&e.firstChild instanceof Text&&null!==e.firstChild.textContent&&(e.firstChild.textContent=e.firstChild.textContent.replace(/^http(s)?:\/\//,"").replace(/^www\./,"")),e.onclick=function(){(0,S.fg)("NewsfeedItemLinkClick")}}))}}]),s}(f.w);function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,d.Z)(e);if(t){var o=(0,d.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,u.Z)(this,n)}}var Ee=function(e){(0,c.Z)(n,e);var t=Ae(n);function n(){var e;return(0,i.Z)(this,n),(e=t.call(this)).addChild(new Me({text:"".concat(J.ag.loadingTextLower,"..."),seen:!0,timestamp:0,timeSince:"",url:""})),e}return(0,o.Z)(n,[{key:"setUpdateItems",value:function(e){var t=this;this.removeAllChildren(),0===e.length&&this.addChild(new Me({text:"".concat(J.ag.noNewUpdates),seen:!0,timestamp:0,timeSince:"",url:""})),e.forEach((function(e){t.addChild(new Me(e))}))}},{key:"initUI",value:function(){this.element.style.maxHeight="307px",this.element.style["-webkit-transform"]="translateZ(0)"}}]),n}(Pe),Be=function(e){(0,c.Z)(n,e);var t=Ae(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"initUI",value:function(){(0,g.Z)((0,d.Z)(n.prototype),"initUI",this).call(this),this.element.style.maxHeight="",(0,Re.q)(this.element)}}]),n}(Ee);function Le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Oe=function(e){(0,c.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,d.Z)(t);if(n){var o=(0,d.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,u.Z)(this,e)});function s(e){var t;return(0,i.Z)(this,s),(t=r.call(this)).numUnread=0,t.isLoaded=!1,t.isDropDownVisible=!1,t.items=[],t.markAllAsSeenTimeout=void 0,t.updateTabOpenTime=0,t.highestUnreadTs=0,t.tabTitle=J.ag.updatesText,t.recordLastSeenUrl="notifications/record_last_seen/",t.notificationTypes=["twitter_feed","offline_tip"],t.openPageActionName="NewsfeedOpened",t.closePageActionName="NewsfeedClosed",t.contents=e?new Be:new Ee,t.addChild(t.contents),we.dropDownToggle.listen((function(e){t.isDropDownVisible=e,t.isShowing()||t.sendUpdatesClosedEvent()})),t.isAnonymous=void 0===T.J.current.loggedInUser,(0,h.j9)("beforeunload",window,t.sendUpdatesClosedEvent.bind((0,ke.Z)(t))),(0,h.j9)("unload",window,t.sendUpdatesClosedEvent.bind((0,ke.Z)(t))),t}return(0,o.Z)(s,[{key:"getNewsTopic",value:function(e){}},{key:"getNewsSeenTopic",value:function(e){return new Se.Z4(e)}},{key:"getOfflineTipTopic",value:function(e){if(void 0!==e)return new Se.HL(e)}},{key:"getUpdateOfflineTipTopic",value:function(e){if(void 0!==e)return new Se.aS(e)}},{key:"hasUnread",value:function(){return this.numUnread>0}},{key:"recordLastSeenNotification",value:function(e,t){this.isAnonymous||Ie.recordLastSeen(this.recordLastSeenUrl,e,(function(){void 0!==t&&t()}))}},{key:"sendUpdatesClosedEvent",value:function(){if(0!==this.updateTabOpenTime){var e={duration_seconds:((new Date).getTime()-this.updateTabOpenTime)/1e3};this.updateTabOpenTime=0;try{(0,S.fg)(this.closePageActionName,e)}catch(e){}}}},{key:"getTabHandleContent",value:function(){var e;return e=this.numUnread>99?"".concat(this.tabTitle," (99+)"):this.numUnread>0?"".concat(this.tabTitle," (").concat(this.numUnread,")"):this.tabTitle,[document.createTextNode(e)]}},{key:"getTabId",value:function(){return"updates-tab"}},{key:"showElement",value:function(){(0,g.Z)((0,d.Z)(s.prototype),"showElement",this).call(this),this.repositionChildren()}},{key:"setAsCurrentTab",value:function(){(0,g.Z)((0,d.Z)(s.prototype),"setAsCurrentTab",this).call(this);try{(0,S.fg)(this.openPageActionName,{is_orange:this.hasUnread()})}catch(e){}this.updateTabOpenTime=(new Date).getTime(),this.loadFeed()}},{key:"hideElement",value:function(){(0,g.Z)((0,d.Z)(s.prototype),"hideElement",this).call(this),this.sendUpdatesClosedEvent()}},{key:"isShowing",value:function(){return this.isDropDownVisible&&this.isCurrentTab()}},{key:"unreadItems",get:function(){return this.items.filter((function(e){return!e.seen}))}},{key:"loadFeed",value:function(){var e=this;this.isLoaded?(this.contents.setUpdateItems(this.items),this.scheduleMarkAllAsSeen(),we.tabItemsLoaded.fire()):Ie.getUserUpdates(this.notificationTypes,(function(t){var n,i,o,r;e.items=t,e.contents.setUpdateItems(t);var s=e.unreadItems;e.numUnread=s.length,e.highestUnreadTs=0,s.length>0&&(e.highestUnreadTs=Math.max.apply(Math,(0,xe.Z)(s.map((function(e){return e.timestamp}))))),e.refreshTabs(),e.isLoaded=!0,we.tabItemsLoaded.fire();var a=null===(n=T.J.current.loggedInUser)||void 0===n?void 0:n.userUid;void 0!==a&&e.getNewsSeenTopic(a).onMessage.listen((function(t){debug("news seen update",t),e.markAsSeen(t.timestamp),e.numUnread=e.unreadItems.length,we.updatesAreRead.fire(),e.refreshTabs()})),null===(i=e.getNewsTopic(a))||void 0===i||i.onMessage.listen((function(t){debug("news item",t);var n=0;e.items.length>0&&(n=Math.max.apply(Math,(0,xe.Z)(e.items.map((function(e){return e.timestamp}))))),n<t.timestamp&&(e.items.splice(0,0,t),e.numUnread=e.unreadItems.length,e.contents.setUpdateItems(e.items),t.seen||(e.highestUnreadTs=t.timestamp,we.updatesAreUnread.fire()),e.refreshTabs(),e.scheduleMarkAllAsSeen())})),null===(o=e.getOfflineTipTopic(a))||void 0===o||o.onMessage.listen((function(t){var n=0;e.items.length>0&&(n=Math.max.apply(Math,(0,xe.Z)(e.items.map((function(e){return e.timestamp}))))),n<t.timestamp&&(e.items.splice(0,0,t),e.numUnread=e.unreadItems.length,e.contents.setUpdateItems(e.items),t.seen||(e.highestUnreadTs=t.timestamp,we.updatesAreUnread.fire()),e.refreshTabs(),e.scheduleMarkAllAsSeen())})),null===(r=e.getUpdateOfflineTipTopic(a))||void 0===r||r.onMessage.listen((function(t){var n=t.fromUsername,i=0;if(e.items.length>0&&(i=Math.max.apply(Math,(0,xe.Z)(e.items.map((function(e){return e.timestamp}))))),i<t.timestamp){var o,r=e.items,s=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Le(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(r.entries());try{for(s.s();!(o=s.n()).done;){var a=(0,Ce.Z)(o.value,2),l=a[0];if(a[1].text.includes(n)){r.splice(l,1),r.splice(0,0,t);break}}}catch(e){s.e(e)}finally{s.f()}e.contents.setUpdateItems(e.items),e.refreshTabs(),e.scheduleMarkAllAsSeen()}}))}))}},{key:"markAsSeen",value:function(e){this.items.forEach((function(t){t.timestamp<=e&&(t.seen=!0)}))}},{key:"scheduleMarkAllAsSeen",value:function(){var e=this;this.numUnread>0?(void 0!==this.markAllAsSeenTimeout&&clearTimeout(this.markAllAsSeenTimeout),this.isShowing()&&(this.markAsSeen(this.items[0].timestamp),this.markAllAsSeenTimeout=window.setTimeout((function(){e.numUnread=0,e.highestUnreadTs=0,e.recordLastSeenNotification(e.items[0].timestamp,(function(){we.updatesAreRead.fire()}))}),500))):we.updatesAreRead.fire()}}]),s}(ye.NQ);function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){(0,z.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,d.Z)(e);if(t){var o=(0,d.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,u.Z)(this,n)}}var Fe=function(e){(0,c.Z)(n,e);var t=Ze(n);function n(e){var o,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,i.Z)(this,n),(o=t.call(this)).isDropDownVisible=!1,o.tabsLoaded=0,o.element.id="UserUpdatesPanel",(0,he.vP)(o.element,"userUpdatesPanel"),o.tabHandlesRow.element.style.borderBottom="none",o.tabHandlesRow.element.style.padding="4px 0 0 6px",o.tabHandlesRow.element.style.marginBottom="4px",o.tabHandlesRow.element.style.boxSizing="border-box",o.window.style.position="static",o.tabHandleStyle=Ue(Ue({},o.tabHandleStyle),{},{fontSize:"12px",padding:"5px 10px"}),o.updatesTabs=[new Oe(r)],o.updatesTabs.forEach((function(e){o.addTab(e)})),we.dropDownToggle.listen((function(e){e?(o.tabsLoaded=0,o.updatesTabs.forEach((function(e){return e.loadFeed()})),o.tabsLoaded===o.updatesTabs.length&&o.switchToMostRecentUnreadTab()):o.currentTab=void 0})),we.tabItemsLoaded.listen((function(){o.tabsLoaded+=1})),o.addFeedbackLink(),o.dropDownComponent=o.createDropDownComponent(e),o}return(0,o.Z)(n,[{key:"createDropDownComponent",value:function(e){return new He(this,e)}},{key:"initAdditionalToggleElement",value:function(e){var t=this;we.updatesAreUnread.listen((function(){t.anyUpdatesTabUnread()&&(null==e||e.classList.add("has_unseen"))})),we.updatesAreRead.listen((function(){var n,i;t.anyUpdatesTabUnread()||null!==(n=null===(i=document.querySelector("#dmListIconRoot"))||void 0===i?void 0:i.classList.contains("has_unread"))&&void 0!==n&&n||(e.className=e.className.replace("has_unseen",""))}))}},{key:"switchToMostRecentUnreadTab",value:function(){this.changeToTab(this.updatesTabs.reduce((function(e,t){return t.highestUnreadTs>e.highestUnreadTs?t:e})))}},{key:"anyUpdatesTabUnread",value:function(){return this.updatesTabs.some((function(e){return e.hasUnread()}))}},{key:"addFeedbackLink",value:function(){this.addFooter(Ne(!1))}},{key:"repositionChildren",value:function(){}},{key:"initUI",value:function(){this.element.style.overflow="",this.element.style.position="static",this.element.style.borderWidth="1px",this.element.style.borderStyle="solid",this.element.style.borderTop="none",this.element.style.borderRadius="0 0 4px 4px"}}]),n}(ye.Le),_e=function(e){(0,c.Z)(n,e);var t=Ze(n);function n(e){var o;(0,i.Z)(this,n),o=t.call(this,e,!0);for(var r=1;r<o.element.children.length-1;r+=1)o.element.children[r].style.height="calc(100% - ".concat(60,"px)");return o}return(0,o.Z)(n,[{key:"createDropDownComponent",value:function(e){return new ze(this,e)}},{key:"addFeedbackLink",value:function(){this.addFooter(Ne(!0))}},{key:"initUI",value:function(){(0,g.Z)((0,d.Z)(n.prototype),"initUI",this).call(this),this.element.style.borderRight="0"}}]),n}(Fe);function Ne(e){var t=document.createElement("A");return(0,he.vP)(t,"feedbackLink"),t.innerText=J.ag.howCanWeImproveText,t.style.fontSize="11px",t.style.textAlign="center",t.style.width="100%",t.style.display="block",t.style.padding="5px 0",t.style.marginBottom="7px",e?(t.href=(0,y.BN)(I.D.userUpdatesFeedbackLink),t.target="_blank"):(t.href="#",t.onclick=function(){B.F.fire({source:"site_updates"})}),t}function je(e,t,n){n.listen((function(n){e.isDropDownVisible!==n.isShowing&&(e.isDropDownVisible=n.isShowing,we.dropDownToggle.fire(n.isShowing),t.classList.toggle("active",n.isShowing))})),we.updatesAreUnread.listen((function(){e.anyUpdatesTabUnread()&&t.classList.add("has_unseen")})),we.updatesAreRead.listen((function(){e.refreshTabs(),e.anyUpdatesTabUnread()||(t.className=t.className.replace("has_unseen",""))})),e.updatesTabs.forEach((function(e){e.loadFeed()}))}var He=function(e){(0,c.Z)(n,e);var t=Ze(n);function n(e,o){var r;return(0,i.Z)(this,n),(r=t.call(this,o)).element.appendChild(e.element),je(e,o,r.toggleEvent),r}return(0,o.Z)(n,[{key:"initUI",value:function(){(0,g.Z)((0,d.Z)(n.prototype),"initUI",this).call(this),(0,x.Zs)(this.element,{maxHeight:"368px",height:"",width:"100%",zIndex:1001,backgroundColor:"transparent",fontFamily:"UbuntuBold, Helvetica, Arial, sans-serif",left:"-1px",top:"24px",right:"auto"})}}]),n}(N),ze=function(e){(0,c.Z)(n,e);var t=Ze(n);function n(e,o){var r;return(0,i.Z)(this,n),(r=t.call(this,o)).element.appendChild(e.element),je(e,o,r.toggleEvent),r}return(0,o.Z)(n,[{key:"initUI",value:function(){var e=this;(0,g.Z)((0,d.Z)(n.prototype),"initUI",this).call(this),this.element.style.maxHeight="",this.element.style.width="100%",this.element.style.zIndex="1001",this.element.style.backgroundColor="#FFFFFF",this.element.style.fontFamily="UbuntuBold, Helvetica, Arial, sans-serif",this.element.style.left="-1px",this.element.style.top="0",this.element.style.height="calc(100% - ".concat(46,"px)"),this.element.style.top="".concat(46,"px"),this.pushmenu=document.querySelector(".pushmenu.main-menu"),null!==this.pushmenu&&(0,h.j9)("touchmove",this.pushmenu,(function(){e.isShown()&&e.hideElement()}))}},{key:"showElement",value:function(){var e=(0,g.Z)((0,d.Z)(n.prototype),"showElement",this).call(this);return this.scrollTopPushmenu(),e}},{key:"scrollTopPushmenu",value:function(){null!==this.pushmenu&&(this.pushmenu.scrollTop=0)}}]),n}(j);var We=function(e){(0,c.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,d.Z)(t);if(n){var o=(0,d.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,u.Z)(this,e)});function s(e,t,n){var o;if((0,i.Z)(this,s),(o=r.call(this,e)).username=t,o.darkModeEnabled=n,o.element.id="UserMenuDropDown",(0,he.vP)(o.element,"userMenuDropDown"),(0,he.vP)(o.element,he.ql.userInfoDropdownBgColor),(0,x.Zs)(o.element,{display:"none",width:"100%",height:"auto",boxSizing:"border-box",top:"24px",left:"0px",zIndex:1001,borderRadius:"0 0 5px 5px",borderStyle:"solid",borderWidth:"1px",borderTop:"none",fontFamily:"UbuntuBold, Helvetica, Arial, sans-serif",padding:"5px 0",position:"absolute",right:"auto"}),I.w.isWhiteLabel||o.setupDarkmode(),""!==t){if(o.profileLink=o.createDropdownLink(J.ag.myProfileTextLc),o.element.appendChild(o.profileLink),o.myCollectionLink=o.createDropdownLink(J.ag.myCollectionText),o.myCollectionLink.href=(0,y.BN)("/my_collection/"),o.element.appendChild(o.myCollectionLink),void 0!==window.live_chat_support){var a=o.createDropdownLink(J.ag.liveChatSupportTextLc);a.href=(0,y.BN)("/accounts/support_chat/"),a.onclick=function(e){e.preventDefault(),(0,de.Pv)("/accounts/support_chat/","support_chat","height=630,width=375,resizable=0,location=0")},o.element.appendChild(a)}var l=document.createElement("form");l.method="post",l.action=(0,y.BN)("/auth/logout/"),l.target="_top",l.style.display="none";var c=document.createElement("input");c.type="hidden",c.name="csrfmiddlewaretoken",c.value=(0,Z.ve)("csrftoken"),l.appendChild(c),o.element.appendChild(l);var u=o.createDropdownLink(J.ag.sendFeedbackTextLc);u.style.cursor="pointer",u.onclick=function(e){e.preventDefault(),o.hideElement(),B.F.fire({source:"user_menu"})},o.element.appendChild(u);var d=o.createDropdownLink(J.ag.logOutTextLc);d.href=(0,y.BN)("/auth/logout/"),d.onclick=function(e){e.preventDefault(),o.hideElement(),(0,D.oB)(J.ag.logoutModalText,(function(){c.value=(0,Z.ve)("csrftoken"),l.submit()}))},o.element.appendChild(d),void 0!==t&&o.setUsername(t)}else{var h=o.createDropdownLink(J.ag.loginVerbText);h.classList.add("login-link"),h.classList.add("nooverlay"),h.href=(0,y.BN)(m.PU),(0,m.rk)(h),o.element.appendChild(h);var f=o.createDropdownLink(J.ag.signUpText);f.href=(0,y.BN)("".concat(m.Ng,"?src=header")),(0,m.rk)(f),o.element.appendChild(f);var p=o.createDropdownLink(J.ag.sendFeedbackTextLc);p.style.cursor="pointer",p.href="#",p.onclick=function(e){e.preventDefault(),o.hideElement(),B.F.fire({source:"user_menu"})},o.element.appendChild(p)}return o}return(0,o.Z)(s,[{key:"setupDarkmode",value:function(){if(void 0!==this.darkModeEnabled){this.isDarkMode=document.body.classList.contains("darkmode");var e=this.createDarkModeSwitch();this.element.insertBefore(e,this.element.firstChild),!document.body.classList.contains("isIpad")&&(0,O._1)()&&document.body.classList.add("isIpad")}}},{key:"createDarkModeSwitch",value:function(){var e=this,t=document.createElement("div"),n=document.createElement("span");return this.dmSwitchCircle=document.createElement("span"),t.innerText=J.ag.darkMode,n.appendChild(this.dmSwitchCircle),t.appendChild(n),(0,he.vP)(this.dmSwitchCircle,"dmSwitchCircle"),(0,x.Zs)(this.dmSwitchCircle,{borderRadius:"50%",display:"inline-block",height:"16px",width:"16px",position:"relative",top:"2px",left:"3px"}),(0,x.Zs)(n,{borderRadius:"25px",display:"inline-block",height:"20px",marginLeft:"10px",position:"relative",verticalAlign:"bottom",width:"44px",cssFloat:"right",right:"6px",top:"-2px"}),(0,he.vP)(n,"dmSwitch"),(0,K.ql)(t,"none"),(0,K.pS)(this.dmSwitchCircle,"left 100ms"),(0,he.vP)(t,he.ql.userInfoDropdownTextColor),(0,he.vP)(t,he.ql.userInfoDropdownHighlightColor),t.style.fontSize="14px",t.style.fontWeight="normal",t.style.cursor="pointer",t.style.fontFamily="UbuntuMedium, Arial, Helvetica, sans-serif",t.style.padding="5px 0 5px 10px",t.onclick=function(){e.setColorModeFn(),void 0!==document.changeColorMode&&document.changeColorMode()},H.F_.listen((function(){e.setColorModeFn()})),this.isDarkMode&&(this.dmSwitchCircle.style.left="25px"),t}},{key:"setColorModeFn",value:function(){I.w.isWhiteLabel||(this.isDarkMode?(this.dmSwitchCircle.style.left="3px",this.isDarkMode=!1,(0,he.FU)(document.body,"darkmode"),(0,he.vP)(document.body,"lightmode"),(0,Z.C)("theme_name","lightmode",60)):(this.dmSwitchCircle.style.left="25px",this.isDarkMode=!0,(0,he.FU)(document.body,"lightmode"),(0,he.vP)(document.body,"darkmode"),(0,Z.C)("theme_name","darkmode",60)),this.updateMenuColors(),(0,S.fg)("colorModeChanged",{username:void 0===this.username?"__anon__":this.username,color_mode:this.isDarkMode?"darkmode":"lightmode"}),H.rb.fire(this.isDarkMode?"darkmode":"lightmode"),(0,U.TF)()||(0,y.I5)("api/ts/accounts/userpreferredtheme/",{theme:this.isDarkMode?"darkmode":"lightmode"}))}},{key:"updateMenuColors",value:function(){I.w.isWhiteLabel&&(this.element.style.backgroundColor=I.w.userInfoDropdownBgColor,this.element.style.border="1px solid ".concat(I.w.tabBorderColor))}},{key:"createDropdownLink",value:function(e){var t=this,n=document.createElement("a");return n.style.textDecoration="none",n.innerText=e,n.style.display="block",n.style.fontSize="14px",n.style.padding="5px 0 5px 10px",(0,he.vP)(n,he.ql.userInfoDropdownTextColor),(0,he.vP)(n,he.ql.userInfoDropdownHighlightColor),n.onclick=function(){t.hideElement()},n}},{key:"setUsername",value:function(e){void 0!==this.profileLink&&(this.profileLink.href=(0,y.BN)("/p/".concat(e,"/?tab=bio")))}},{key:"showElement",value:function(){return(0,g.Z)((0,d.Z)(s.prototype),"showElement",this).call(this)}},{key:"hideElement",value:function(e){return(0,g.Z)((0,d.Z)(s.prototype),"hideElement",this).call(this)}}]),s}(N),Ve=n(4801),qe=n(6853),Ke=n(4793),Je=n(4266),Ge=n(6698),Ye=n(14);function $e(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Qe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qe(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function Qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Xe={fontSize:"13px",fontFamily:"UbuntuMedium, Helvetica, Arial, sans-serif",width:"auto",height:"auto",position:"absolute",display:"none",overflow:"",cursor:"default",top:"0px",left:"0px",zIndex:5},et={width:"314px",maxHeight:"450px",overflowY:"auto",overflowX:"hidden",position:"relative",boxSizing:"border-box",padding:"8px",borderRadius:"4px 4px 4px 4px",WebkitBorderRadius:"4px 4px 4px 4px"},tt={cssFloat:"right"},nt={margin:"5px 0"},it=function(e){(0,c.Z)(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,d.Z)(t);if(n){var o=(0,d.Z)(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return(0,u.Z)(this,e)});function s(e,t,n){var o;return(0,i.Z)(this,s),(o=r.call(this,e,!1)).isAnonymous=t,o.showFollowedCount=n,o.followedData=lt.getInstance(),o.topMargin=5,o}return(0,o.Z)(s,[{key:"setDropDownStyleFromToggle",value:function(e){var t=getComputedStyle(this.element).borderBottomRightRadius;this.setBorderRadius(e,t)}},{key:"createBaseElement",value:function(){var e=this;return(0,G.vz)("div",{className:"followedDropdown","data-href":"skip"},(0,G.vz)("div",{className:"followedContainer",style:et,colorClass:[he.ql.tabActiveBgColor,"tabBorderNoHover"],ref:function(t){e.followedContainer=t}}))}},{key:"initData",value:function(e){var t=this;(0,g.Z)((0,d.Z)(s.prototype),"initData",this).call(this,null!=e?e:{}),this.gender=(0,p.ej)(),w.Me.addListener((function(e){t.gender=e,void 0!==t.moreAnchor&&(t.moreAnchor.href=(0,y.BN)(ot(t.gender,t.followedData.getOnlineFollowed().online>0)))}),this.element)}},{key:"initUI",value:function(e){(0,g.Z)((0,d.Z)(s.prototype),"initUI",this).call(this,e),(0,x.Zs)(this.element,Xe)}},{key:"updateFollowedCount",value:function(){if(void 0!==this.followedCount){var e=this.followedData.getOnlineFollowed();this.followedCount.textContent=J.ag.followCountLong(e.online,e.total)}}},{key:"navigateToFollowedPage",value:function(e){(0,S.fg)("FollowedDropdownSeeAll"),w.k4.fire(e)}},{key:"replaceRooms",value:function(){var e=this;if(!this.isShown()){for(;null!==this.followedContainer.firstChild;)this.followedContainer.removeChild(this.followedContainer.firstChild);if(!this.isAnonymous){var t=this.followedData.getOnlineFollowed(),n=this.followedData.getCurrentShownRooms().length>1;this.followedContainer.appendChild((0,G.vz)("div",{style:{margin:"5px 3px"}},(0,G.vz)("a",{href:ot(this.gender,t.online>0),style:{height:"auto",width:"auto",border:"none",borderRadius:"0px",textDecoration:"none",cursor:"pointer",cssFloat:"none",padding:"0px"},"data-floatingnav":"",colorClass:[he.ql.tabActiveBgColor,he.ql.hrefColor],ref:function(t){e.moreAnchor=t},onMouseEnter:function(){e.moreAnchor.style.textDecoration="underline",(0,he.vP)(e.moreAnchor,he.ql.tabActiveColor),(0,he.FU)(e.moreAnchor,he.ql.hrefColor)},onMouseLeave:function(){e.moreAnchor.style.textDecoration="none",(0,he.vP)(e.moreAnchor,he.ql.hrefColor),(0,he.FU)(e.moreAnchor,he.ql.tabActiveColor)},onClick:this.navigateToFollowedPage},J.ag.showAllText),this.showFollowedCount&&(0,G.vz)("div",{style:n?tt:nt,className:"followedCount",ref:function(t){e.followedCount=t}},J.ag.followCountLong(t.online,t.total))))}this.followedContainer.style.width="auto";var i=(0,G.vz)("div",{style:{display:"table"}}),o=(0,G.vz)("div",null),r=0;if(this.followedData.getCurrentShownRooms().forEach((function(e){r%2==0&&(o=(0,G.vz)("div",{style:{display:"table-row"}}),i.appendChild(o));var t=(0,G.vz)("div",{style:{display:"table-cell"}});t.appendChild(e.card),o.appendChild(t),r+=1})),this.followedContainer.appendChild(i),0===this.followedData.getCurrentShownRooms().length){var s=(0,G.vz)("div",{colorClass:he.ql.textColor,style:{margin:"5px 3px 5px 3px",fontSize:"12px",fontFamily:"UbuntuRegular"}});if(this.isAnonymous){var a=function(e){var t=(0,G.vz)("a",{href:e.href,style:{height:"auto",width:"auto",border:"none",borderRadius:"0px",textDecoration:"none",cursor:"pointer",cssFloat:"none",padding:"0px"},colorClass:[he.ql.tabActiveBgColor,he.ql.hrefColor],onMouseEnter:function(){t.style.textDecoration="underline"},onMouseLeave:function(){t.style.textDecoration="none"},onClick:void 0!==e.onClick?e.onClick:void 0,"account-redirect":!0},e.children);return t};s.appendChild((0,G.vz)(G.HY,null,(0,G.vz)(a,{href:(0,y.BN)("".concat(m.Ng,"?src=followed_tab"))},J.ag.signUpText),(0,G.vz)("span",null," ".concat(J.ag.orLower," ")),(0,G.vz)(a,{href:(0,y.BN)(m.PU),onClick:function(t){t.metaKey||t.ctrlKey||(t.preventDefault(),e.hideElement(),(0,q.iW)({}))}},J.ag.loginVerbText))),s.appendChild((0,G.vz)("span",null,J.ag.anonFollowMore))}else s.appendChild((0,G.vz)("span",null,J.ag.userFollowMore));this.followedContainer.appendChild(s),this.followedContainer.style.width="265px"}}}},{key:"updateThumbnails",value:function(){var e,t=$e(this.followedData.getCurrentShownRooms());try{for(t.s();!(e=t.n()).done;)e.value.updateThumbnail()}catch(e){t.e(e)}finally{t.f()}}},{key:"showElement",value:function(){if(!(0,g.Z)((0,d.Z)(s.prototype),"showElement",this).call(this))return!1;this.updateThumbnails(),this.followedContainer.scrollTop=0,this.followedData.resetLastUnseen();var e=(0,x.r7)(this.element),t=Math.max((0,k._U)(),(0,x.gV)(document.body.style.minWidth));return e.right>t&&(this.element.style.width="".concat(this.element.offsetWidth-(e.right-t)-4,"px"),this.followedContainer.style.overflowX="auto"),!0}},{key:"hideElement",value:function(e){if(void 0!==e&&(e.metaKey||e.ctrlKey))return!1;if(!(0,g.Z)((0,d.Z)(s.prototype),"hideElement",this).call(this))return!1;var t,n=$e(this.followedData.getCurrentShownRooms());try{for(n.s();!(t=n.n()).done;)t.value.unhighlight()}catch(e){n.e(e)}finally{n.f()}return this.element.style.width="auto",this.followedContainer.style.overflowX="hidden",this.replaceRooms(),!0}},{key:"reposition",value:function(){(0,g.Z)((0,d.Z)(s.prototype),"reposition",this).call(this),this.connectedOverlay.element.style.display="none"}}]),s}(Ye.i);function ot(e,t){return t?"".concat("/followed-cams/online/").concat(e!==p.Y0.All?"".concat(p.aI.get(e),"/"):""):"/followed-cams/offline/"}var rt=function(){function e(t,n,o){var r=this;(0,i.Z)(this,e),this.room=t,this.highlighted=n,this.username="",this.username=t.room;var s=""!==this.room.image?this.room.image:"".concat(STATIC_URL_ROOT,"images/no_thumbnail_1_wide.jpg");this.a=(0,G.vz)("a",{className:"roomElementAnchor",colorClass:[he.ql.tabInactiveColor,this.highlighted?"isHighlighted":"notHighlighted"],style:{width:"180px",height:"126px",borderRadius:"4px",border:"none",padding:"0px",margin:"0px",display:"block",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",textDecoration:"none"},"data-room":this.room.room,href:(0,y.BN)("/".concat(this.room.room,"/")),onClick:function(){(0,S.fg)("FollowedDropdownVisit")}},(0,G.vz)("img",{alt:"",src:s,width:180,height:101,style:{borderRadius:"3px 3px 0px 0px"},className:"room_thumbnail",ref:function(e){r.img=e}}),(0,G.vz)("span",{style:{padding:"5px"}},this.room.room)),this.card=(0,G.vz)("div",{className:"roomElement",style:{display:"inline-block",width:"180px",height:"126px",borderRadius:"4px",margin:"3px",cursor:"pointer"}},this.a),(0,h.Zf)(["click","mousedown","touchstart"],this.a,(function(){(0,Ge.bc)(r.username,"ft",o)}))}return(0,o.Z)(e,[{key:"unhighlight",value:function(){this.highlighted=!1,(0,he.vP)(this.a,"notHighlighted"),(0,he.FU)(this.a,"isHighlighted")}},{key:"updateThumbnail",value:function(){var e;this.setImageStreamer(),""!==this.room.image&&(null===(e=this.imageStreamer)||void 0===e||e.loadImage(0).catch((function(e){warn("Error loading image",{imageSrc:e})})))}},{key:"setImageStreamer",value:function(){var e=this;""!==this.room.image&&void 0===this.imageStreamer&&(this.imageStreamer=new Je.hE(this.username,this.img),(0,h.j9)("mouseenter",this.card,(function(){var t;(0,Ge.fr)()&&(null===(t=e.imageStreamer)||void 0===t||t.startStreaming())})),(0,h.j9)("mouseleave",this.card,(function(){var t;(0,Ge.fr)()&&(null===(t=e.imageStreamer)||void 0===t||t.stopStreaming())})))}}]),e}();function st(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return at(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?at(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function at(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var lt=function(){function e(){(0,i.Z)(this,e),this.first=!0,this.currentShownRooms=[],this.lastUnseen=[],this.seenRooms={},this.forceSeen={},this.onlineFollowed={online:0,total:0}}return(0,o.Z)(e,[{key:"init",value:function(e){var t=this;if(this.currentOptions=e,H.WP.listen((function(){t.currentOptions.dropdown.hideElement()})),Ke.kN.listen((function(e){t.currentOptions.dropdown.replaceRooms(),t.setSeen([e.dossier.room])})),v.nR.listen((function(){t.currentOptions.dropdown.isShown()&&(t.disableResizeDebounce||t.currentOptions.dropdown.hideElement())})),this.currentOptions.dropdown.toggleEvent.listen((function(){t.currentOptions.dropdown.isShown()&&t.disableResizeDebounceEvent()})),this.currentOptions.dropdown.replaceRooms(),!0===window.showcam&&"string"==typeof window.broadcaster&&this.setSeen([window.broadcaster]),this.currentOptions.isAnonymous)this.currentOptions.dropdown.replaceRooms();else{(0,qe.On)(),qe.yY.listen((function(e){t.updateViaStorageCallback(e,!1,t.currentOptions.username,t.currentOptions.updateViaStorageCallback)})),qe.KR.listen((function(e){t.updateViaStorageCallback(e,!1,void 0,t.currentOptions.followedDropdownClickedCallback)})),window._followedTabUpdate=function(e){t.setSeen([e]),t.getUpdatesFromCB(!0,t.currentOptions.username,t.currentOptions.updateFromCBCallback)};var n=0===window.location.pathname.indexOf("/followed-cams/",0)?void 0:(0,qe.js)();void 0!==n&&n.username===this.currentOptions.username&&Date.now()-n.timestamp<3e4?(this.notFirst(),this.updateViaStorageCallback(n,!0,this.currentOptions.username,this.currentOptions.updateViaStorageCallback),(0,qe._t)(),this.getUpdatesFromCB(!0,this.currentOptions.username,this.currentOptions.updateFromCBCallback)):this.getUpdatesFromCB(!1,this.currentOptions.username,this.currentOptions.updateFromCBCallback);var i=function(e){clearInterval(t.updateInterval),t.updateInterval=window.setInterval((function(){t.currentOptions.dropdown.isShown()||t.getUpdatesFromCB(!1,t.currentOptions.username,t.currentOptions.updateFromCBCallback)}),e)};i(2e4),window.setTimeout((function(){i(6e4)}),6e5),window.setTimeout((function(){i(12e5)}),18e5),window.setTimeout((function(){clearInterval(t.updateInterval)}),216e5),qe.MG.listen((function(){t.currentOptions.followedTab.flash()}))}}},{key:"getSeenRooms",value:function(){return this.seenRooms}},{key:"getlastUnseen",value:function(){return this.lastUnseen}},{key:"getforceSeen",value:function(){return this.forceSeen}},{key:"getOnlineFollowed",value:function(){return this.onlineFollowed}},{key:"setOnlineFollowed",value:function(e){this.onlineFollowed=e}},{key:"setSeenRoom",value:function(e){this.seenRooms[e]=!0}},{key:"setForceSeen",value:function(e){this.forceSeen[e]=!0}},{key:"getCurrentShownRooms",value:function(){return this.currentShownRooms}},{key:"notFirst",value:function(){this.first=!1}},{key:"resetLastUnseen",value:function(){this.lastUnseen=[]}},{key:"setSeen",value:function(e){var t,n=st(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.setSeenRoom(i),this.setForceSeen(i)}}catch(e){n.e(e)}finally{n.f()}}},{key:"setDropdownViewed",value:function(){(0,qe.Ve)(),(0,qe.YX)()}},{key:"updateViaStorageCallback",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;e.timestamp<=this.lastUpdate||e.username!==n||(this.onlineFollowed=e.onlineFollowedList.onlineFollowed,this.seenRooms=e.seenRooms,this.lastUnseen=e.unseenRooms,this.update(e.onlineFollowedList,!0),void 0!==i&&i(e,t),this.lastUpdate=e.timestamp)}},{key:"update",value:function(e){var t,n=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o={},r=[],s=[],a=st(e.roomList);try{for(a.s();!(t=a.n()).done;){var l=t.value;void 0!==this.seenRooms[l.room]||this.first?s.push(l):r.push(l),this.seenRooms[l.room]=!0,o[l.room]=l}}catch(e){a.e(e)}finally{a.f()}var c=r.length>0;this.lastUnseen=this.lastUnseen.reduce((function(e,t){return void 0===o[t.room]||n.forceSeen[t.room]||e.push(o[t.room]),e}),[]);for(var u=0,d=r;u<d.length;u++){var h=d[u];this.lastUnseen.push(h)}var f={};this.currentShownRooms=[];var p,m=st(this.lastUnseen);try{for(m.s();!(p=m.n()).done;){var v=p.value;f[v.room]=!0,this.currentShownRooms.push(new rt(v,!0,this.currentShownRooms.length+1))}}catch(e){m.e(e)}finally{m.f()}for(var g=0,y=s;g<y.length;g++){var b=y[g];void 0===f[b.room]&&this.currentShownRooms.push(new rt(b,!1,this.currentShownRooms.length+1))}this.currentOptions.dropdown.replaceRooms();var w=!this.first&&c;return w&&!i&&qe.MG.fire(void 0),this.first=!1,{flash:w,rooms:this.lastUnseen}}},{key:"getUpdatesFromCB",value:function(){var e=this,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&Date.now()-this.lastUpdate<1e4||(0,qe.GB)().then((function(i){e.lastUpdate=Date.now(),e.onlineFollowed=i.onlineFollowed;var o=e.update(i);n(o),(0,qe.iq)(t,i,e.seenRooms,o.flash,o.rooms)})).catch((function(){}))}},{key:"disableResizeDebounceEvent",value:function(){var e=this;this.disableResizeDebounce=!0,window.setTimeout((function(){e.disableResizeDebounce=!1}),300)}}],[{key:"getInstance",value:function(){return e._instance}}]),e}();lt._instance=new lt;var ct=function(){function e(t,n,o){var r,s,a,l=this;(0,i.Z)(this,e),this.toggleEl=t,this.orange=!1,this.followedData=lt.getInstance(),this.moveFollowCountTest=new Ve.BJ(["MvFlw2","MvFlw2Ntf","MvFlw2Onl"],"mv_flw_ct"),this.ratioText=null!==(r=this.toggleEl.querySelector(".followed_counts"))&&void 0!==r?r:void 0,["MvFlw2","MvFlw2Ntf"].includes(null!==(s=this.moveFollowCountTest.activeSide)&&void 0!==s?s:"")&&void 0!==this.ratioText&&(this.ratioText.remove(),this.ratioText=void 0),this.followingLink=null!==(a=document.getElementById("followed_anchor"))&&void 0!==a?a:void 0;var c={username:o,isAnonymous:n,updateFromCBCallback:function(e){l.updateRatioText(!0),0===e.rooms.length&&(l.orange=!1,l.updateTabHighlight())},updateViaStorageCallback:function(e,t){l.updateRatioText(!1),l.orange=e.unseenRooms.length>0,l.updateTabHighlight(),e.flash&&!t&&l.flash()},followedDropdownClickedCallback:function(){l.updateRatioText(!1),clearInterval(l.flashInterval),l.flashInterval=void 0,l.orange=!1,l.updateTabHighlight()},dropdown:new it(this.toggleEl,n,this.moveFollowCountTest.active),followedTab:this};this.dropdown=c.dropdown,this.dropdown.toggleEvent.listen((function(e){if(e.isShowing){clearInterval(l.getFlashingInterval()),l.setFlashingInterval(void 0),l.setOrange(!1),l.updateTabHighlight();var t=l.followedData.getOnlineFollowed().online;(0,S.fg)("FollowedDropdownOpened",{onlineBroadcasters:t}),l.followedData.setDropdownViewed()}})),w.Me.listen((function(e){l.updateFollowingLink(e,l.followedData.getOnlineFollowed().online>0)})),this.followedData.init(c),this.moveFollowCountTest.active||(this.followedData.setOnlineFollowed((0,qe.RH)(this.toggleEl.innerText)),this.updateRatioText(!0))}return(0,o.Z)(e,[{key:"setOrangeStyle",value:function(e){if(e){(0,he.vP)(this.toggleEl,"orange");var t,n=this.followedData.getlastUnseen().length;n>0&&"MvFlw2Ntf"===this.moveFollowCountTest.activeSide&&((0,he.vP)(this.toggleEl,"text"),null===(t=document.getElementById("followed_anchor"))||void 0===t||null===(t=t.style)||void 0===t||t.setProperty("--unseen-follow-count",'"'.concat(n,'"')))}else(0,he.FU)(this.toggleEl,"orange"),(0,he.FU)(this.toggleEl,"text")}},{key:"setOrange",value:function(e){this.orange=e}},{key:"setFlashingInterval",value:function(e){this.flashInterval=e}},{key:"getFlashingInterval",value:function(){return this.flashInterval}},{key:"flash",value:function(){var e=this;if(void 0===this.flashInterval){var t=3,n=!0;this.flashInterval=window.setInterval((function(){if(n){if(e.setOrangeStyle(!0),0==(t-=1))return clearInterval(e.flashInterval),void(e.flashInterval=void 0)}else e.setOrangeStyle(!1);n=!n}),500)}}},{key:"updateRatioText",value:function(e){var t=this;if(this.moveFollowCountTest.active&&this.dropdown.updateFollowedCount(),void 0!==this.ratioText){var n=this.followedData.getOnlineFollowed();this.toggleEl.style.width="auto";var i=void 0===T.J.current.loggedInUser?"":"(".concat(n.online,")");this.ratioText.textContent="MvFlw2Onl"===this.moveFollowCountTest.activeSide?i:"(".concat(n.online,"/").concat(n.total,")"),null!==this.toggleEl.offsetParent&&window.setTimeout((function(){e||(t.toggleEl.style.width="".concat(t.toggleEl.offsetWidth+1,"px")),t.dropdown.isShown()&&t.dropdown.reposition()})),this.updateFollowingLink((0,p.ej)(),n.online>0)}}},{key:"updateTabHighlight",value:function(){this.orange&&!this.dropdown.isShown()?this.setOrangeStyle(!0):this.setOrangeStyle(!1)}},{key:"updateFollowingLink",value:function(e,t){void 0!==this.followingLink&&(this.followingLink.href=ot(e,t))}}]),e}();function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function dt(e){if(void 0!==e){var t,n=[],i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ut(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(JSON.parse(e));try{for(i.s();!(t=i.n()).done;){var o=t.value;n.push({provider:o[0],name:o[1]})}}catch(e){i.e(e)}finally{i.f()}return n}}function ht(e){var t;if(null!==e)return{username:e.username,gender:e.gender,subgender:null!==(t=e.subgender)&&void 0!==t?t:void 0,isSupporter:e.is_supporter,isStaff:e.is_staff,tokenBalance:e.token_balance,userUid:e.user_uid,signedUsername:e.signed_username,isAgeVerified:e.is_age_verified,isBroadcasting:e.is_broadcasting,totalFollowed:e.total_followed,onlineFollowed:e.online_followed,canWegOneClick:e.can_weg_oneclick,canEpochOneClick:e.can_epoch_oneclick}}var ft=n(7600),pt=n(795),mt=n(9447),vt=n(2673),gt=n(2896),yt=n(6422),bt=n(1289),wt=n(3682),Ct=n(7201),xt=n(1625);function kt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return St(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?St(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function St(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Tt(e){window.TS=e}var It=function(){function e(t){if((0,i.Z)(this,e),this.parseContext(t),T.J.current=this.context,this.init(),this.listenForOrientationChanges(),this.addErrorAttributes(),!0===T.J.current.darkModeEnabled&&void 0===T.J.current.themeName){var n=new Ve.KS("DrkSysStngsV3"),o=window.matchMedia("(prefers-color-scheme: dark)").matches;o&&n.record(),n.active&&(o?(0,Z.C)("sys_color_settings","darkmode",60):(0,Z.C)("sys_color_settings","lightmode",60))}}return(0,o.Z)(e,[{key:"parseContext",value:function(e){var t,n,i,o,r,s,a,l;if(this.context={current_logo:e.current_logo,isMobile:e.is_mobile,sample_metrics_off:e.sample_metrics_off,qualityMessage:e.quality_message,loggedInUser:ht(e.logged_in_user),animateThumbnails:e.animate_thumbnails,socialAuths:dt(e.social_auths),isBroadcast:!1,darkModeEnabled:e.dark_mode_enabled,themeName:e.theme_name,maxPmAge:e.chat_settings.max_pm_age,pmMediaEnabled:null!==(t=e.pm_photos_enabled)&&void 0!==t&&t,dmsEnabled:null!==(n=e.sitewide_pms_enabled)&&void 0!==n&&n,contextID:e.entrypoint_context_id,csrftoken:e.csrftoken,isLoadedFromCache:void 0,showPaxumNotice:null!==(i=e.show_paxum_notice)&&void 0!==i&&i,realtimeUserlistEnabled:!0===e.realtime_userlist_enabled,isInternal:e.INTERNAL,pageLocation:"homepage",PurchaseEventSources:e.PurchaseEventSources,languageCode:e.language_code,showLocation:null===(o=Boolean(e.showLocation))||void 0===o||o,showRecommendations:null!==(r=e.showRecommendations)&&void 0!==r&&r,regions:null!==(s=e.regions)&&void 0!==s?s:"",isTestbed:null!==(a=e.isTestbed)&&void 0!==a&&a,noImage:null!==(l=e.noImage)&&void 0!==l&&l,throttleTopicPublish:!0===e.push_throttle_topic_publish},ft._.initialize(e),(0,Ge.X7)(this.context.animateThumbnails),(0,O.IU)()){var c=window.localStorage.getItem("contextID");window.localStorage.setItem("contextID",this.context.contextID),this.context.isLoadedFromCache=c===this.context.contextID}}},{key:"init",value:function(){window.setTimeout((function(){(0,de.oc)()||location.reload(),de.UG.listen((function(){location.reload()}))}),1728e5),!0===this.context.pmMediaEnabled&&(0,a.Je)(),this.roomReload=Ge.Bb.exportToJS(),this.addPageAction=S.fg,this.context.isMobile?this.initMobile():this.initDesktop(),(0,S.qV)("history_length",history.length.toString()),(0,Ct.c8)(),(0,te.x)(),(0,xt.Yu)()}},{key:"initMobile",value:function(){var e,t;this.bindUserUpdatesPanel(!0),this.bindDmListDropdown(!0),e=document.querySelector(".nav_list"),null!==(t=document.querySelector(".push-overlay"))&&null!==e&&((0,h.j9)("click",e,(function(){oe.YL.fire(!0)})),(0,h.j9)("click",t,(function(){oe.YL.fire(!1)})),oe.ah.listen((function(n){n&&!(0,ue.GD)()?e.click():!n&&(0,ue.GD)()&&t.click()}))),this.bindAdvancedSearchOptions(!0),this.bindPurchaseTokenLinks(),this.bindTokenCountUpdater(),this.setupEmoticonPreviewModal(!0),(0,m.QZ)(),this.updateFlashMessageDisplay(),this.showLoginOverlay=q.iW}},{key:"initDesktop",value:function(){this.bindUserInfoPanelDropdown(),this.bindUserUpdatesPanel(!1),this.bindDmListDropdown(!1),this.bindPurchaseTokenLinks(),this.bindFollowedTab(),this.bindFollowingIcons(),this.handlePmChatWindows(),this.setupEmoticonPreviewModal(!1),this.bindHeader(),this.bindFooter(),this.bindTokenCountUpdater(),(0,m.QZ)(),void 0===this.context.loggedInUser&&(window.location.pathname!==m.PU&&this.setupLoginOverlay(),void 0!==(0,bt.dD)(window.location.search).join_overlay&&window.location.pathname!==m.Ng&&this.setupJoinOverlay()),this.setupUserFeedbackForm(),this.watchForAdIntervention(),this.displayLoginOverlay=q.iW,this.openFeedbackForm=function(e){B.F.fire({source:e})},this.showModal=Ge.kC}},{key:"initRoom",value:function(){gt.$.getOrCreateInstance()}},{key:"addErrorAttributes",value:function(){void 0!==this.context.loggedInUser?((0,S.qV)("username",this.context.loggedInUser.username),(0,S.qV)("enduser.id",this.context.loggedInUser.userUid)):((0,S.qV)("username","__anon__"),(0,S.qV)("enduser.id","0")),(0,S.qV)("enduser.session",this.context.contextID),(0,S.qV)("revision","a55ee9da2e72")}},{key:"setupJoinOverlay",value:function(){(0,yt.fd)(),yt.q2.fire(void 0),this.addJoinOverlayListener(new yt.be({}))}},{key:"addJoinOverlayListener",value:function(e){var t;yt.wJ.listen((function(n){void 0===t&&(t=e),window.scrollTo(0,0),t.initAndShow(n)}))}},{key:"setupUserFeedbackForm",value:function(){B.F.listen((function(e){L.K.show(e)}))}},{key:"setupLoginOverlay",value:function(){var e,t=kt(document.querySelectorAll("a.login-link"));try{for(t.s();!(e=t.n()).done;)e.value.onclick=function(e){(0,q.iW)({}),e.preventDefault()}}catch(e){t.e(e)}finally{t.f()}}},{key:"listenForOrientationChanges",value:function(){if((0,wt.s2)()){var e=function(){wt.bs.fire()};(0,wt.a1)()?screen.orientation.addEventListener("change",e):(0,wt.qn)()&&(0,h.j9)("orientationchange",window,e)}}},{key:"bindUserInfoPanelDropdown",value:function(){return e=document.querySelector("#userInfoPanelMenuDropdownRoot"),t=document.getElementById("user_information_profile_container"),n=void 0!==this.context.loggedInUser?this.context.loggedInUser.username:"",i=this.context.darkModeEnabled,null!==e&&null!==t&&(o=new We(t,n,i),e.appendChild(o.element),o.repositionChildrenRecursive()),o;var e,t,n,i,o}},{key:"bindUserUpdatesPanel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;return I.w.isWhiteLabel||null===e||null===t||(i?(n=new _e(e),null!=o&&n.initAdditionalToggleElement(o)):n=new Fe(e),t.appendChild(n.dropDownComponent.element)),n}(document.querySelector("#userUpdatesBellRoot"),document.querySelector("#userUpdatesMenuDropdownRoot"),e,document.querySelector("#mmnav"))}},{key:"bindDmListDropdown",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=document.querySelector("#userUpdatesBellRoot"),n=document.querySelector("#dmListDropdownRoot"),i=document.querySelector("#dmListIconRoot"),o=document.querySelector("#mmnav");if(!e)return function(e,t){var n;return null!==e&&null!==t&&(n=new ve({toggleElement:e}),t.appendChild(n.element)),n}(i,n);!function(e,t,n,i){null!==e&&null!==i&&i.appendChild(new le({dmListIconRoot:e,userUpdatesBellRoot:t,hamburgerIcon:n}).element)}(i,t,o,n)}},{key:"bindPurchaseTokenLinks",value:function(){var e,t=kt(document.querySelectorAll(".purchase_tokens a, a.purchase_tokens, a#purchase_tokens"));try{for(t.s();!(e=t.n()).done;){var n=e.value;void 0!==this.context.loggedInUser?(0,pt.sh)(n):n.onclick=function(e){(0,q.iW)({}),e.preventDefault()}}}catch(e){t.e(e)}finally{t.f()}}},{key:"watchForAdIntervention",value:function(){if(window.hasOwnProperty("ReportingObserver")){var e=function(e){var t,n=kt(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;"intervention"===i.type&&(0,S.fg)("AdIntervention",{report:JSON.stringify(i.body)})}}catch(e){n.e(e)}finally{n.f()}},t=new window.ReportingObserver((function(t,n){e(t)}),{buffered:!0});t.observe(),(0,h.j9)("beforeunload",window,(function(n){var i=t.takeRecords();e(i)}))}}},{key:"bindFollowedTab",value:function(){var e=document.getElementById("followed_anchor");null!==e&&e instanceof HTMLAnchorElement&&(e.onclick=function(e){e.ctrlKey||e.metaKey||e.preventDefault()},new ct(e,void 0===this.context.loggedInUser,void 0!==this.context.loggedInUser?this.context.loggedInUser.username:""))}},{key:"bindHeader",value:function(){var e=document.querySelector("#header");if(null!==e&&e instanceof HTMLElement)return new A(e)}},{key:"bindFooter",value:function(){var e=document.querySelector(".footer-holder");if(null!==e&&e instanceof HTMLElement)return new C(e)}},{key:"handlePmChatWindows",value:function(){var e,t=window.location.pathname.startsWith("/staff_tools"),n=document.getElementById("header");null===n||null===n.offsetParent||t||(!0===(null===(e=this.context.loggedInUser)||void 0===e?void 0:e.isStaff)||void 0!==this.context.loggedInUser&&(0,s.Fh)())&&(0,E.FP)(this.context.loggedInUser.username)}},{key:"setupEmoticonPreviewModal",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];mt.gi.listen((function(n){void 0===e&&(e=t?new mt.nz:new mt.cv),e.initAndShow(n)}))}},{key:"bindFollowingIcons",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e?"broadcasters":"room_list",n=document.querySelector("#".concat(t)),i=document.querySelector("div.icon_not_following"),o=document.querySelector("div.icon_following");null===n||null===i&&null===o||new vt.T(void 0===this.context.loggedInUser,t,e)}},{key:"bindAdvancedSearchOptions",value:function(e){return new r.Ld(e)}},{key:"bindTokenCountUpdater",value:function(){var e,t=null===(e=T.J.current.loggedInUser)||void 0===e?void 0:e.userUid;void 0!==t&&new Se.IH(t).onMessage.listen((function(e){l.A3.fire(e)})),l.A3.listen((function(e){(0,pt.f_)(e.tokens)}))}},{key:"updateFlashMessageDisplay",value:function(){var e=document.querySelector(".flash-message-container");null!==e&&0===e.querySelectorAll(".message p").length&&(e.style.display="none")}}]),e}();Tt(It)},4487:function(e,t,n){"use strict";(0,n(3256).j)()},569:function(){"use strict";window.PRODUCTION=!0,window.CHATURBATE_URL_PREFIX="/",window.STATIC_URL_ROOT="https://static-assets.highwebmedia.com/",window.STATIC_URL_MOBILE="https://static-assets.highwebmedia.com/mobileassets/",window.STATIC_URL="https://static-assets.highwebmedia.com/tsdefaultassets/"},4585:function(e,t,n){var i=n(3593);window.debug=i.debug,window.info=i.info,window.warn=i.warn,window.error=i.error}}]);
//# sourceMappingURL=62-prod-8619378f58871a397370.js.map