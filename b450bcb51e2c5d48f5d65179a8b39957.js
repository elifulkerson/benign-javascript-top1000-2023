var AsanaAnalytics={KEYS:{ENCRYPTED_USER_ID:"cd3",PLATFORM_CUSTOM_DIMENSION:"platform",FAST_FORWARD_ENROLLMENT:"fast_forward"},init:function(){window.dataLayer=window.dataLayer||[];var t=AsanaStorage.getEncryptedUserId();t?AsanaAnalytics.setEncryptedUserId(t):AsanaAppUserInfo.get(function(t){AsanaAnalytics.setEncryptedUserId(t.encrypted_user_id),AsanaStorage.setEncryptedUserId(t.encrypted_user_id)}),AsanaAnalytics.setPlatformCustomDimension("asanadotcom")},setEncryptedUserId:function(t){var n={};n[this.KEYS.ENCRYPTED_USER_ID]=t,window.dataLayer.push(n)},setPlatformCustomDimension:function(t){var n={};n[this.KEYS.PLATFORM_CUSTOM_DIMENSION]=t,window.dataLayer.push(n)},initGTM:function(){var t="GTM-5KGDZGG",n=("gtm-qa.netlify.app"===window.location.hostname&&(t="GTM-WX7N4WQ"),window),a=document,e="script",i="dataLayer";n[i]=n[i]||[],n[i].push({"gtm.start":(new Date).getTime(),event:"gtm.js"}),n=a.getElementsByTagName(e)[0],(i=a.createElement(e)).async=!0,i.src="https://t-antenna.asana.com/gtm.js?id="+t,n.parentNode.insertBefore(i,n),window.dataLayer=window.dataLayer||[],window.gtag=function(){dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("set","developer_id.dNzMyY2",!0),window.gtag("config","UA-11757081-1",{send_page_view:!1}),window.AsanaTimings&&window.AsanaTimings.setTiming&&window.AsanaTimings.setTiming("initGTMExecuted")},trackGTM:function(t,n){try{n?"string"==typeof t&&"[object Object]"===Object.prototype.toString.call(n)&&0!==Object.keys(n).length?dataLayer.push(Object.assign({},{event:t},n)):window.AsanaErrors.notify("AsanaAnalytics.trackGTM only accepts one argument of type <string>, one argument of type <object>, or two arguments of type [<string>, <object>]."):"string"==typeof t?dataLayer.push({event:t}):dataLayer.push(t)}catch(t){window.AsanaErrors.notifyException(t,"Failed to push an event to the GTM data layer.")}},buildCustomGtmEventName:function(t){var n,a={};for(n in t)a[n]=function(t){return t=(t=t.trim()).split(" "),n=[],t.forEach(function(t){var a;t[0]&&(a="",t.split("").forEach(function(t,n){n=0===n?t.toUpperCase():t.toLowerCase();a+=n}),n.push(a))}),n.join(" ").split(" ").join("");var n}(t[n]);return a.action=a.action||"",a.page=a.page||"",a.subAction=a.subAction?"-"+a.subAction:"",a.subLocation=a.subLocation?"-"+a.subLocation:"",a.action+a.subAction+"@"+a.page+a.subLocation},isGtmDomLoaded:function(){return window&&window.google_tag_manager&&window.google_tag_manager.dataLayer&&window.google_tag_manager.dataLayer.gtmDom},trackGtmWithEventData:function(t,n,a){AsanaAnalytics.trackGTM(t,{eventCategory:t,eventAction:n,eventLabel:a})},trackSignupEventsInGtm:{pathToLocationMap:{"/pricing":"Pricing","/create-account":"Create Account"},hashesToSublocationMap:{"#signup":"Signup","#buy-premium":"Buy Premium","#buy-business":"Buy Business"},sessionStorageKey:"gtmSignupData",init:function(t,n,a,e){var i=JSON.parse(AsanaStorage.getFromSessionStorage(this.sessionStorageKey));AsanaStorage.removeFromSessionStorage(this.sessionStorageKey),t&&n&&i&&(a=this.createEventLabel(n,i.path,a,i.hash))&&(n={eventCategory:t,eventAction:n,eventLabel:a},e&&(a=this.getCurrentTime()-i.submissionTime,n.eventValue=a),AsanaAnalytics.trackGTM(t,n))},createEventLabel:function(t,n,a,e){n=this.getLocationFromPath(n);if(n)return e=this.hashesToSublocationMap[e],AsanaAnalytics.buildCustomGtmEventName({action:t,page:n,subAction:a||"",subLocation:e||""})},storeGtmSignupSubmissionData:function(){var t={};t.path=window.location.pathname,t.hash=window.location.hash,t.submissionTime=this.getCurrentTime(),AsanaStorage.setToSessionStorage(this.sessionStorageKey,JSON.stringify(t))},getCurrentTime:function(){return(new Date).getTime()},getLocationFromPath:function(n){var t=Object.keys(this.pathToLocationMap).filter(function(t){return new RegExp(t,"g").test(n)});return this.pathToLocationMap[t[0]]}},stringToArrayBuffer:function(t){for(var n=new ArrayBuffer(t.length),a=new Uint8Array(n),e=0,i=t.length;e<i;e++)a[e]=t.charCodeAt(e);return n},hashString:function(i,o){return new Promise(function(n,t){var a=AsanaAnalytics.stringToArrayBuffer(o),e=(new TextEncoder).encode(i);window.crypto.subtle.importKey("raw",a,{name:"HMAC",hash:"SHA-256"},!1,["sign","verify"]).then(function(t){return window.crypto.subtle.sign("HMAC",t,e).then(function(t){t=Array.from(new Uint8Array(t)).map(function(t){return t.toString(16).padStart(2,"0")});n(t.join(""))})}).catch(function(t){window.AsanaErrors.notify("[hashString] Failed to hash string")})})},getIpAddressFromGTM:function(){if(window.dataLayer)for(var t,n=0;n<window.dataLayer.length;n++)for(var a in t=window.dataLayer[n])if(t[a]&&t[a].ip)return t[a].ip},sendHashedIpAddressToGTM:function(){var t;window.dataLayer&&(t=this.getIpAddressFromGTM())&&this.hashString(t,"srnbyhsomm9iqk5h2z39uyl9h").then(function(t){AsanaAnalytics.trackGTM({hashedIP:t})}).catch(function(t){window.AsanaErrors.notify("[sendHashedIpAddressToGTM] Failed to push hashed IP to GTM dataLayer")})},sendHashedEmailToGTM:function(){var t=AsanaStorage.getUserEmailCookie();t&&this.hashString(t,"srnbyhsomm9iqk5h2z39uyl9h").then(function(t){AsanaAnalytics.trackGTM({hashedEmail:t})}).catch(function(){window.AsanaErrors.notify("[sendHashedEmailToGTM] Failed to push hashed Email to GTM dataLayer")})},timing:{consent:{defaultRun:null,updateRun:null}}};AsanaAnalytics.init();