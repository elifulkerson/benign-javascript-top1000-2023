!function e(r,n,t){function a(i,l){if(!n[i]){if(!r[i]){var s="function"==typeof require&&require;if(!l&&s)return s(i,!0);if(o)return o(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[i]={exports:{}};r[i][0].call(u.exports,(function(e){return a(r[i][1][e]||e)}),u,u.exports,e,r,n,t)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<t.length;i++)a(t[i]);return a}({1:[function(e,r,n){const t=RA.config.set,a=RA.config.get,o=a("domainAuth"),i=a("domainApigw");t("paywall.cookieName","rat"),t("paywall.auth.page","/login"),t("paywall.verification.page","/verification"),t("paywall.verificationpro.page","/verificationpro"),t("paywall.profile.payment.page","/profile/payment"),t("paywall.profile.paymentpro.page","/profile/paymentpro"),t("paywall.regist.url",o+"/v2/user/"),t("paywall.regist.corp.url",o+"/v2/user/corporate/"),t("paywall.logout.url",o+"/v2/user/logout/"),t("paywall.login.url",o+"/v2/user/login/"),t("paywall.login.corp.url",o+"/v2/user/corporate/login/"),t("paywall.userInfo.url",o+"/v2/user/info/"),t("paywall.emailSubscribe.url",o+"/v2/mailing/user/subscription/"),t("paywall.userLog.url",o+"/v2/user/log/"),t("paywall.serverEvents.url",o+"/v2/user/notifications/paywall/"),t("paywall.notification.url",o+"/v2/billing/paywall/notification_flag/"),t("paywall.serverEvents.urlPro",o+"/v2/user/notifications/rbcpro/"),t("paywall.notification.urlPro",o+"/v2/billing/rbcpro/notification_flag/"),t("paywall.subscribe.url",i+"/api/billing/adapter/v3/subscribe/"),t("paywall.cancelOrder.url",i+"/api/billing/adapter/rbcpro/v1/buy/reject/{cart_id}/"),t("paywall.subscribeNoBanners.url",i+"/api/billing/adapter/rbcpro/v1/buy/subscribe_cloudpayments/"),t("paywall.cancelNoBannersOrder.url",i+"/api/billing/adapter/rbcpro/v1/buy/cancel/"),t("paywall.statusNoBanners.url",i+"/api/billing/adapter/rbcpro/v1/buy/success/"),t("paywall.autopayment.url",i+"/api/billing/adapter/v3/changeautorenewal/"),t("paywall.card.url",i+"/api/billing/adapter/v3/payment/bindcard/"),t("paywall.autopayment.urlPro",i+"/api/billing/adapter/rbcpro/v1/auto_renewal/"),t("paywall.card.urlPro",i+"/api/billing/adapter/rbcpro/v1/bind_card/"),t("paywall.tariffInfo.urlPro",i+"/api/billing/adapter/rbcpro/v1/statistic/subscription/"),RA.repo.paywall=e("repo/paywall/main"),RA.repo.paywallServerEvents=e("repo/paywall-server-events/main")},{"repo/paywall-server-events/main":2,"repo/paywall/main":3}],2:[function(e,r,n){const t=RA.repo.paywall,a={1:"пользователь не авторизован",2:"ошибка в конфигурации"};let o,i,l,s=!1;function c(){return s?0:t&&t.isLogined()?(i=RA.config.get("paywall.serverEvents.url"),l=RA.config.get("paywall.notification.url"),i&&l?(s=!0,0):2):1}function u(){return new Promise(((e,r)=>{(function(e){return RA.repo.request.create(e,{headers:{"Content-Type":"application/json;charset=UTF-8"},credentials:"include"}).send()})(i).then((r=>{const n=r&&"success"===r.status&&r.data;e(n||{})})).catch(r)}))}function p(e,r,n){return RA.repo.request.create(e,{method:n||"POST",headers:{"Content-Type":"application/json;charset=UTF-8"},body:JSON.stringify(r),credentials:"include"}).send()}function d(e){return"repo::paywall-server-events - "+e||"неизвестная ошибка"}r.exports={get:function(){const e=c();return e?1===e?Promise.resolve({}):Promise.reject(d(a[e])):(o||(o=u()),o)},delete:function(e,r){const n=c();if(n)return Promise.reject(d(a[n]));if("string"!=typeof e||!Array.isArray(r))return Promise.reject(d("неверные параметры для метода .delete"));const t={};return t[e]=r,p(i,t,"POST")},setNotifications:function(e){const r=c();return r?Promise.reject(d(a[r])):e?p(l,e,"POST"):Promise.reject(d("неверные параметры для метода .setNotifications"))}}},{}],3:[function(e,r,n){const t=RA.config.get,a=t("paywall"),o=`${t("proProjectUrl")}/api/pro/frontend/v1/user/info/`;let i;const l={isLogined:function(){return!!a.user.logined},isPaid:function(){return!!a.user.paid},isCrossDomain:function(){const e=l.getUrlParams();return e.host?!e.host.includes(".rbc.ru"):".rbc.ru"!==RA.config.get("domain")},clearXssInAttr:function(e){return e.replace(/^javascript:/,"")},getAuthLocation:function(){const e=l.getAuthLocation;return e.location||(e.location=t("domainAuth"))},getUrlParams:function(e){let r=e?e.split("?")[1]:window.location.search.slice(1);const n={};if(r){const e=(r=r.split("#")[0]).split("&");for(let r=0;r<e.length;r++){const t=e[r].split("=");t[0]&&t[1]&&(n[t[0]]=decodeURIComponent(t[1]))}}return n},getPrevPage:function(e,r,n){let t="";const a=document.location;if(r&&r.host&&r.pathname)t=e+"host="+encodeURIComponent(r.host)+"&pathname="+encodeURIComponent(r.pathname);else{let r=a.pathname;n||(r+=a.search),t=e+"host="+encodeURIComponent(a.origin)+"&pathname="+encodeURIComponent(r)}return t},getFullUrlFromQuery:function(e){if(!e)return;let r=e.host||"";return e.pathname&&(r+=e.pathname),l.clearXssInAttr(r)},getSpecUrl:function(e,r){const n=l.getUrlParams();let t="";return e?(n&&n.host?(t=n.host+"/rat/"+e,r?t+=r:n.pathname&&(t+=n.pathname)):l.isCrossDomain()&&(t=document.location.origin+"/rat/"+e+document.location.pathname),l.clearXssInAttr(t)):t},getUserData:function(e,r){return r=r||{},new Promise(((n,t)=>{if(i&&!r.force)n(i);else{e=e?"&"+e:"";let r=`${a.userInfo.url}profile/?fields=display_name,email${e}`;l.isCrossDomain()&&(r="/auth/user/display_name/"),RA.repo.request.create(r,{headers:{"Content-Type":"application/json;charset=UTF-8"},credentials:"include"}).send().then((e=>{e&&"success"===e.status&&e.data&&e.data.profile?(i=e.data.profile,n(i)):t()})).catch(t)}}))},getProTariffInfo:function(e){const r=l.getProTariffInfo;return e&&(r.xhr&&(r.xhr.abort(),r.xhr=null),r.promise&&(r.promise=null)),r.promise||(r.promise=new Promise(((e,n)=>{l.isLogined()||n(),r.xhr=RA.repo.request.create(a.tariffInfo.urlPro,{headers:{"Content-Type":"application/json;charset=UTF-8"},credentials:"include"},"raw"),r.xhr.send().then((r=>{r||n();const t=r.headers.get("x-rbc-user-uuid");r.json().then((r=>{t&&(r.userUuid=t),e(r)}))})).catch(n).finally((()=>r.xhr=null))}))),r.promise},logout:function(){const e=l.logout;e.xhr&&(e.xhr.abort(),e.xhr=null);const r=l.isCrossDomain()?"/auth/user/logout/":a.logout.url;e.xhr=RA.repo.request.create(r,{method:"POST",headers:{"Content-Type":"application/json;charset=UTF-8"},credentials:"include"}).send().finally((()=>window.location.reload()))},checkSubscribe:function(e){const r=l.checkSubscribe;"function"==typeof e&&(r.xhr&&(r.xhr.abort(),r.xhr=null),RA.repo.request.create(a.emailSubscribe.url,{headers:{"Content-Type":"application/json;charset=UTF-8"},credentials:"include"}).send().then((r=>{r&&"success"===r.status&&r.data&&r.data.default&&e(r)})))},loadOnboarding:function(){if(!l.shouldRunOnboarding())return;const e=RA.repo.dynamic;e.require("fn.paywallOnboarding",a.staticPath),e.ready((()=>{RA.fn.paywallOnboarding&&RA.fn.paywallOnboarding.init()}))},shouldRunOnboarding:function(){return!navigator.userAgent.includes("RBCReader")&&!l.isPaid()},getProUserInfo:function(){const e=l.getProUserInfo;return e.promise||(e.promise=new Promise(((r,n)=>{l.isLogined()?(e.xhr=RA.repo.request.create(o,{method:"GET",headers:{"Content-Type":"application/json;charset=UTF-8"},credentials:"include"},"json"),e.xhr.send().then((e=>{e||n(),r(e)})).catch(n).finally((()=>e.xhr=null))):n()}))),e.promise}};r.exports=l},{}]},{},[1]);