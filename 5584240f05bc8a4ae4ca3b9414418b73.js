yp.ready(function(){var e=window.oPageConfig,a=(e.oUrl,e.oLoginInfo),t={};t.$body=$("body"),t.$topBar=$(".js-topBar"),t.$userInfo=$("#userInfo"),t.$userInfo_panel=$("#userInfo-panel"),t.$history_panel=$("#history-panel"),t.$history_loading=t.$history_panel.find(".loading"),t.$history_boxCon=t.$history_panel.find(".js-history-body"),t.$history_boxCon_list=t.$history_panel.find(".js-boxCon-history"),t.$search_panel=$("#js-top-search-panel"),t.$task_panel=$("#js-div-topbar-task"),t.$top_bar_follow_panel=$("#yp-follow-panel"),t.$top_bar_follow_btn=$("#yp-btn-follow");var n=$("#t_listFollow").html();t.$js_left_panel_more=$("#js-left-panel-more");var o={create:function(){var e=this;yp.sub("page/logout/done",function(){window.bUserCenter||e.showArea()}),yp.sub("page/login/done",function(a,t){e.showArea(t)}),yp.sub("page/regist/done",function(a,t){e.showArea(t)}),yp.sub("page/site/level/update/next",function(t,n){e.showArea(a)}),t.$userInfo_panel.on("click",".js-profile",function(e){mfTongji("pc_video_click_count_home_title_login_homepage","videos")});var n=0;t.$topBar.find(".js-nav-li-hover").hover(function(){n&&clearTimeout(n),t.$topBar.find(".js-nav-li-hover.nav-li-hover").removeClass("nav-li-hover"),$(this).addClass("nav-li-hover")},function(){var e=$(this);n=setTimeout(function(){e.removeClass("nav-li-hover")},500)});var o=0,l=null,i="",s="";t.$topBar.find(".js-login-nav-hover").hover(function(a){var t=$(this),n=$(a.target),r=t.data("type");if(s=r,i)i==r?(o&&clearTimeout(o),l&&(l.reject(),l=null),i=""):l&&"pending"==l.state()&&$.when(l).done(function(){s==r&&e.fShowPanel(t)});else{if(n.hasClass("js-login-nav-hover-panel")||n.closest(".js-login-nav-hover-panel").length)return!1;e.fShowPanel(t)}yp.pub("page/topbar/navhover",{type:s})},function(){var e=$(this),a=e.data("type");s="",e.hasClass("nav-hover")&&(l=$.Deferred(),i=a,o=setTimeout(function(){i="",e.find(".js-login-nav-hover-panel").stop(!0,!0).fadeOut(function(){l&&(l.resolve(),l=null)}).addClass("out"),e.removeClass("nav-hover")},300))}),e.showArea(a),$("#js-btnLogin").on("click",function(e){e.preventDefault(),yp.pub("page/login")}),$("#yp-btnLogout").on("click",function(e){e.preventDefault(),yp.pub("page/logout")}),$("#js-regist-btn").on("click",function(e){e.preventDefault(),yp.pub("page/regist")}),yp.sub("page/inbox/unread",function(e,a){a.msg_count?t.$userInfo_panel.find(".msg_count").html(99<a.msg_count?99:a.msg_count).toggle(0<+a.msg_count):t.$userInfo_panel.find(".msg_count").html(0).hide()}),yp.sub("page/rich/change",function(e,a){t.$userInfo_panel.find(".js-gold-txt").html(a.gold),t.$userInfo_panel.find(".js-coin-txt").html(a.coin)}),t.$search_panel.length&&t.$search_panel.zqSearch({focusClass:"search-focus",source:"topbar"}),t.$top_bar_follow_panel.find(".flow").smoothScroll().on("scroll",function(){var a=$(this),t=a.scrollTop();a.height()+t>=a[0].scrollHeight&&0<e.follow.cnt&&e.follow.totalPage>e.follow.page&&e.fLoadFollowList(e.follow.page+1)}),t.$userInfo.find(".js-skill-item").on("mouseenter",function(e){var n=t.$userInfo.find(".js-skill-hover-ibox"),o=$(this),l=o.data("id"),i=null;a.role&&a.role.skill&&(yp.each(a.role.skill,function(e){l==e.id&&(i=e)}),i&&(n.find(".js-skill-name").html(i.name),n.find(".js-skill-level").html(i.level),n.find(".js-skill-effect").html(i.description),n.find(".js-skill-type").html(i.typeStr),n.find(".js-skill-img").attr("src",i.icon),n.find(".js-skill-title").html(i.unlockLevel==i.next?i.next+"级解锁":0==i.next?"":"下次升级："+i.next),n.css("left",o.position().left-(n.outerWidth()/2-o.outerWidth()/2)),n.show()))}).on("mouseleave",function(e){t.$userInfo.find(".js-skill-hover-ibox").hide()}),e.fImInit(),this.fFetchNavData(),this.fLoadTopBarAds()},fShowPanel:function(e){var a=this,t=e.find(".js-login-nav-hover-panel");e.stop(!0,!0).animate({},50,function(){if(t.stop(!0,!0).removeClass("out").show(),e.addClass("nav-hover"),"userinfo"==e.data("type")&&(e.find(".js-left-level-rate").css({width:0}),e.find(".js-left-my-level-rate").css({width:0})),Modernizr.cssanimations)e.off("animationend webkitAnimationEnd").on("animationend webkitAnimationEnd",function(){switch(e.off("animationend webkitAnimationEnd"),e.data("type")){case"userinfo":e.find(".js-left-level-rate").css({width:e.find(".js-left-level-rate").data("width")+"%"}),e.find(".js-left-my-level-rate").css({width:e.find(".js-left-my-level-rate").data("width")+"%"});break;case"follow":a.fLoadFollowList(1)}});else switch(e.data("type")){case"userinfo":e.find(".js-left-level-rate").css({width:e.find(".js-left-level-rate").data("width")+"%"}),e.find(".js-left-my-level-rate").css({width:e.find(".js-left-my-level-rate").data("width")+"%"});break;case"follow":a.fLoadFollowList(1)}}),this.calcLayerMargin(e)},showArea:function(e){var a=!!e,n=this;if(t.$userInfo.toggleClass("loginOn",a),n.fResetFollowPanel(),a){if(t.$userInfo.find(".js-avatar").attr("src",e.avatar+"-big"),t.$userInfo.find(".js-nav-avatar").attr("src",e.avatar+"-big"),t.$userInfo.find(".js-uname").text(e.nickname),t.$userInfo.find(".js-account").text(e.account),e&&e.role&&e.role.level){var o=e.role.level.level,l=fLVLevelIconClass(o),i=fLVLevelIconClass(o+1),s=t.$userInfo.find(".js-plevel-icon").data("level"),r=t.$userInfo.find(".js-plevel-next-icon").data("level"),f=e.role.level.total-e.role.level.current;s&&t.$userInfo.find(".js-plevel-icon").removeClass(s),r&&t.$userInfo.find(".js-plevel-next-icon").removeClass(r),t.$userInfo.find(".js-plevel-icon").addClass(l).data("level",l),t.$userInfo.find(".js-plevel-next-icon").addClass(i).data("level",i),t.$userInfo.find(".js-plevel-next-icon").toggle(!!i),t.$userInfo.find(".js-left-level-rate").css({width:e.role.level.percent+"%"}).data("width",e.role.level.percent),t.$userInfo.find(".js-plevel-left-exp").toggle(f>0).html("距离下一级还差"+f+"经验"),t.$userInfo.find(".mid-level-bd").toggleClass("mb10",f<=0)}if(e&&e.slevel){var o=e.slevel.level,c=e.slevel.pos,p=e.slevel.type,l=fLevelIconClass(o,c,p),d=fLevelTitle(o,c),i=fLevelIconClass(+o+1,c,p),s=t.$userInfo.find(".js-slevel-icon").data("level"),r=t.$userInfo.find(".js-slevel-next-icon").data("level");s&&t.$userInfo.find(".js-slevel-icon").removeClass(s),r&&t.$userInfo.find(".js-slevel-next-icon").removeClass(r),t.$userInfo.find(".js-slevel-icon").addClass(l).data("level",l).prop("title","VIP等级："+d),t.$userInfo.find(".js-slevel-next-icon").addClass(i).data("level",i),t.$userInfo.find(".js-slevel-icon").toggle(o>0),t.$userInfo.find(".js-slevel-next-icon").toggle(!!i)}e.rich?(t.$userInfo_panel.find(".js-gold-txt").html(e.rich.gold),t.$userInfo_panel.find(".js-coin-txt").html(e.rich.coin)):(t.$userInfo_panel.find(".js-gold-txt").html(0),t.$userInfo_panel.find(".js-coin-txt").html(0)),t.$userInfo_panel.find(".js-anchor").off("click.checkMobile").prop("target","_blank"),e.isAnchor?(t.$userInfo_panel.find(".js-anchor").attr("href",e.roomUrl).closest("li").show(),t.$userInfo_panel.find(".js-anchor").find("p").html("我的直播间"),t.$userInfo_panel.find(".js-anchor-level").show(),t.$userInfo_panel.find(".js-anchor-level").removeClass("anchor-grade-"+t.$userInfo_panel.find(".js-anchor-level").data("level")),t.$userInfo_panel.find(".js-anchor-level").addClass("anchor-grade-"+e.rlevel)):(e.bindMobile?t.$userInfo_panel.find(".js-anchor").attr("href","/anchor/apply/step1"):t.$userInfo_panel.find(".js-anchor").attr("href","javascript:;").prop("target","").on("click.checkMobile",function(e){e.preventDefault(),$.ibox({title:"提示信息",width:300,content:"<p>完成任务需要先绑定手机号</p>",btns:[{name:"前去绑定",callback:function(){location.href="/user/bind/mobile",this.close()}},{name:"偏不绑定"}]})}),t.$userInfo_panel.find(".js-anchor").closest("li").show(),t.$userInfo_panel.find(".js-anchor").find("p").html("我要直播"),t.$userInfo_panel.find(".js-anchor-level").hide()),t.$userInfo_panel.toggleClass("anchor-account",!!e.isAnchor),t.$userInfo_panel.find(".js-profile").attr("href","/user/videos"),t.$userInfo_panel.find(".js-v-icon").remove(),e.vlevel&&t.$userInfo_panel.find(".js-uname").after('<i class="site-v-icon site-v-icon-'+e.vlevel+' js-v-icon dv" data-uid="'+e.uid+'"></i>')}t.$js_left_panel_more.length&&(t.$js_left_panel_more.find(".js-tobe-anchor").toggle(!(a&&e.isAnchor)),t.$js_left_panel_more.find(".js-my-room").toggle(a&&e.isAnchor).attr("href",a&&e.isAnchor?e.roomUrl:"javascript:;"))},fResetFollowPanel:function(){var e=this;t.$top_bar_follow_panel.find(".js-topbar-no-follow").hide(),t.$top_bar_follow_panel.find(".js-topbar-follow-loading").show(),t.$top_bar_follow_panel.find(".js-panel-list").html("").hide(),e.follow={cnt:0,page:0,loaded:!1,liveEnd:!1,totalPage:0,perPage:6}},ajax:function(e,a){return yp.ajax(e,a).done(function(e){})},follow:{cnt:0,page:0,loaded:!1,liveEnd:!1,totalPage:0,perPage:6},fLoadFollowList:function(a){var o=this;return!t.$top_bar_follow_panel.data("ajaxing")&&(!o.follow.liveEnd&&((1!=a||!o.follow.loaded)&&(!(1!=a&&o.follow.totalPage<a)&&(t.$top_bar_follow_panel.find(".js-topbar-no-follow").hide(),t.$top_bar_follow_panel.find(".js-topbar-follow-loading").show(),t.$top_bar_follow_panel.data("ajaxing",!0),void yp.ajax(yp.format(e.oUrl.sTopFollowListUrl,{page:a,nums:o.follow.perPage}),{type:"get",dataType:"json"}).always(function(){t.$top_bar_follow_panel.data("ajaxing",!1),t.$top_bar_follow_panel.find(".js-topbar-follow-loading").hide()}).done(function(e){if(0==e.code){if(1==a&&(o.follow.cnt=e.data.cnt,o.follow.loaded=!0,o.follow.totalPage=Math.ceil(o.follow.cnt/o.follow.perPage),t.$top_bar_follow_panel.find(".js-topbar-no-follow").toggle(0==o.follow.cnt).find(".js-topbar-no-follow-txt").html("您还未关注任何主播"),t.$top_bar_follow_panel.find(".js-panel-list").toggle(0<o.follow.cnt)),o.follow.page=a,e.data.list.length){var l="";yp.each(e.data.list,function(e){if(e.statusClass=+e.status>0?"line-on":"",e.guardHidden=e.guardLevel&&0<e.guardLevel?"":"hidden",!e.statusClass)return o.follow.liveEnd=!0,!1;1e6<e.online?e.online=(+e.online/1e4).toFixed(0)+"万":1e4<e.online&&(e.online=(+e.online/1e4).toFixed(1)+"万"),l+=yp.format(n,e)}),l?(t.$top_bar_follow_panel.find(".js-panel-list").append(l),Modernizr.cssanimations&&yp.each(t.$top_bar_follow_panel.find(".js-panel-list").find(".js-bar-follow-item-new"),function(e){$(e).removeClass("js-bar-follow-item-new").addClass("att_jz").on("animationend webkitAnimationEnd",function(){$(this).off("animationend webkitAnimationEnd").removeClass("att_jz")})})):1==a&&(t.$top_bar_follow_panel.find(".js-panel-list").hide(),t.$top_bar_follow_panel.find(".js-topbar-no-follow").show().find(".js-topbar-no-follow-txt").html("您关注的主播还未开播"))}}else 1==a&&t.$top_bar_follow_panel.find(".js-topbar-follow-loading").show()})))))},fImInit:function(){var e=this;yp.sub("page/zqim/unread",function(a,t){e.fSetImUnread(t)}),t.$userInfo_panel.on("click",".js-topbar-go-im",function(a){e.fSetImUnread({showRedPoint:!1})}),window.imType&&"full"==window.imType||yp.use("simpleIM",function(e,a){(new a).init()})},showRedPoint:!1,showRedPointNum:0,fSetImUnread:function(e){var a=this;void 0!==e.showRedPoint&&(a.showRedPoint=!!e.showRedPoint),void 0!==e.cnt&&(a.showRedPointNum=parseInt(e.cnt)||0),t.$topBar.find('.js-login-nav-hover[data-type="userinfo"] .js-im-unread-num').toggle(a.showRedPointNum>0).html(a.showRedPointNum>99?"99+":a.showRedPointNum),t.$userInfo_panel.find(".js-im-unread").toggle(!!a.showRedPoint&&a.showRedPointNum<=0),t.$topBar.find('.js-login-nav-hover[data-type="userinfo"] .js-im-unread').toggle(!!a.showRedPoint&&a.showRedPointNum<=0)},fFetchNavData:function(){var e=this;yp.ajax("/api/static/v2.2/index/gamelist.json").done(function(a){0===a.code&&e.fRenderNavLayer(a.data.anchors)})},fRenderNavLayer:function(e){var a="",t=$(".js-nav-layer");yp.each(e,function(e){a+=yp.format('<li> <a href="${url}" class="sub-nav-a" onclick="mfTongji(\'top_navigation_sort_item\', \'pc\')">${nickname}</a></li>',e)}),t.html(a)},calcLayerMargin:function(e){var a=$(window).width(),t=e[0].getBoundingClientRect().right,n=a-t,o=e.find(".js-login-nav-hover-panel"),l=o.width(),i=n>l/2?l/2:l-n-20;o.css("marginLeft",-i)},fLoadTopBarAds:function(){yp.ajax("/api/static/v2.1/ads/new/topbar.banner/1/0/0.json",{noCache:!0}).done(function(e){if(0==e.code&&0<e.data.length){var a=e.data[0],t="";t='<li class="nav-li">              <a href="'+(a.cntUrl||a.adsUrl)+'" target="_blank" class="top-bar-gg" title="'+a.title+'">                <img src="'+a.pic+'" alt="">              </a>            </li>',$("#topbar-left-nav-ul").append(t),$.ajax({url:"https://tj.zhanqi.tv/ad.show?roomId=0&ids="+a.id,type:"get",dataType:"jsonp"})}})}},l={type:1,taskFormIdIndex:{danmu:2,dingyue:3,liwu:4,fenxiang:5},init:function(){this.view(),this.bindEvent(),this.listenYpEvent(),this.oTaskData=yp.oTaskDataManage,this.fGetTaskList()},view:function(){this.tmpl='<li class="clearfix ${liStatusClass}">                     <div class="task-name fl pr"><div class="dot fl"><i></i></div>${description}</div>                     <a href="javascript:;" class="fr get-btn ${statusClass}"  data-time="${time}" data-id="${id}">${btnHtml}</a>                   </li>',t.$mobile_prompt=$('<div class="APP-down-ibox" id="js-panel-task-mobile-prompt-topbar" style="display:none;position: fixed; top:50%; left: 50%;margin: -129px -100px;z-index: 32;"><a href="javascript:;" class="close js-btn-close"></a></div>')},bindEvent:function(){var e=this;t.$task_panel.on("click",".js-btn-get-reward",function(a){a.preventDefault(),e.fGetReward($(this))}),t.$task_panel.on("click",".js-btn-share",function(a){a.preventDefault(),$("#js-room-new-share-panel").length?e.fShareUrl($(this)):yp.successNotify("请前往直播间分享")}),t.$task_panel.on("click",".js-btn-mobile",function(e){e.preventDefault(),t.$body.find("#js-panel-task-mobile-prompt-topbar").length<=0&&t.$body.append(t.$mobile_prompt),t.$mobile_prompt.show()}),t.$task_panel.on("click",".js-btn-to-mobile-info",function(e){e.preventDefault(),yp.successNotify("请前往战旗APP阅读资讯")}),t.$task_panel.on("click",".js-btn-to-mobile-kuaixun",function(e){e.preventDefault(),yp.successNotify("请前往战旗APP阅读快讯")}),t.$mobile_prompt.on("click",".js-btn-close",function(e){e.preventDefault(),t.$mobile_prompt.hide()})},listenYpEvent:function(){var e=this;e._ui;yp.sub("page/logout/done",function(){e.taskList=[],e.type=1}),yp.sub("page/login/done",function(){e.fGetTaskList()}),yp.sub("page/regist/done",function(){e.fGetTaskList()}),yp.sub("page/task/data/update",function(){e.fGetTaskList()}),yp.sub("page/site/generalLevel/level_up",function(){e.fGetTaskList(!0)}),yp.sub("page/task/part_complete/after",function(a,t){var n=e.taskFormIdIndex[t.type];n&&e.fUpdateTaskData(n,t.num)})},fUpdatePanel:function(a){var n=this,o="",l=["","新手任务","每日任务"],i=l[n.type]||"每日任务",s=[7,9,10,12];fSortArr(a,{by:function(a){return e.oLoginInfo.role.level.level<a.unlockLevel?0:1}},{by:function(e){return e.progress.current<e.progress.total||s.indexOf(+e.formId)>=0?0:1}},{by:function(e){return 0==e.groupId?0:1}},{by:function(e){return e.groupId},bAsc:!0}),yp.each(a,function(a,t){var l={id:a.id,name:a.name,description:a.description,statusClass:"",btnHtml:"",time:0};if(l.liStatusClass="under-way yet",e.oLoginInfo.role.level.level<a.unlockLevel)l.statusClass="none-level",l.btnHtml=a.unlockLevel+"级解锁";else if(7==a.formId)l.statusClass="js-btn-mobile",l.btnHtml="去完成";else if(9==+a.formId||10==+a.formId)l.statusClass="js-btn-to-mobile-info",l.btnHtml="去完成";else if(12==+a.formId)l.statusClass="js-btn-to-mobile-kuaixun",l.btnHtml="去完成";else if(a.progress.total<=a.progress.current&&a.progress.total>0)l.statusClass="js-btn-get-reward",l.liStatusClass="",l.btnHtml="领取";else if(1==a.formId){var i=Math.floor(a.progress.current/a.progress.total*100)+"%";l.statusClass="done-btn js-btn-time-count",l.btnHtml=i}else 5==a.formId?(l.statusClass="share-btn js-btn-share",l.btnHtml="去分享"):(l.statusClass="done-btn js-btn-complete-count",l.btnHtml=a.progress.current+"/"+a.progress.total);t<3&&(o+=yp.format(n.tmpl,l))}),t.$task_panel.find(".js-txt-task-title").html(i),t.$task_panel.find(".js-task-list").html(o),t.$task_panel.find(".task-bd").toggleClass("nodata",!o),t.$task_panel.find(".js-div-line").css({height:a.length<=3?36*(a.length-1)+"px":"72px"})},fUpdateTaskData:function(e,a){var t=this;t.fUpdatePanel(t.taskList)},fGetTaskList:function(a){var t=this;if(!e.oLoginInfo)return!1;1===t.type?t.oTaskData.fGetTaskInfo(1,a).done(function(){t.oTaskData.data.newbie.list.length>0?(t.taskList=t.oTaskData.data.newbie.list,t.type=1,t.fUpdatePanel(t.taskList)):t.oTaskData.fGetTaskInfo(2,a).done(function(){t.taskList=t.oTaskData.data.daily.list,t.type=2,t.fUpdatePanel(t.taskList)})}):2===t.type&&t.oTaskData.fGetTaskInfo(2,a).done(function(){t.taskList=t.oTaskData.data.daily.list,t.fUpdatePanel(t.taskList)})},fShareUrl:function(a){return!a.data("ajaxing")&&(e.oLoginInfo?(a.data("ajaxing",!0),void yp.ajax("/api/actives/chance/send.share",{type:"post",dataType:"json"}).always(function(){a.data("ajaxing",!1)}).done(function(e){0==e.code?(setTimeout(function(){yp.pub("page/room/share")},0),yp.pub("page/task/panel/hide"),yp.pub("page/task/part_complete",{type:"fenxiang",num:1})):yp.errorNotify(e.message)}).fail(function(){})):(yp.pub("page/login"),!1))},fGetReward:function(a){var t,n=this,o=a.data("id");return yp.each(n.taskList,function(e){e.id==o&&(t=e)}),void 0!==t&&(!a.data("ajaxing")&&(e.oLoginInfo?e.oLoginInfo.account?e.oLoginInfo.bindMobile?(a.data("ajaxing",!0),void yp.ajax("/api/user/task.complete",{type:"post",data:{taskId:o,roomId:e.oRoom?e.oRoom.id:0},dataType:"json"}).always(function(){a.data("ajaxing",!1)}).done(function(e){if(0==e.code){if(0!=e.data.upgrade.level&&yp.pub("page/base/levelPrompt",e.data.upgrade),e.data.experience&&0<e.data.experience){var a="获得经验 *"+e.data.experience;e.data.guardExperience&&0<e.data.guardExperience&&(a+="，守护额外获得 *"+e.data.guardExperience),yp.successNotify(a)}e.data.gold&&0<e.data.gold&&yp.successNotify("获得金币 *"+e.data.gold),e.data.coin&&0<e.data.coin&&yp.successNotify("获得战旗币 *"+e.data.coin),e.data.propId&&0<e.data.propId&&e.data.propsNumber&&0<e.data.propsNumber&&yp.successNotify("获得道具 "+e.data.propsName+" *"+e.data.propsNumber),n.fPubRewardEvent(o),n.fGetTaskList(!0)}else yp.errorNotify(e.message)}).fail(function(){})):($.ibox({title:"提示信息",width:300,content:"<p>完成任务需要先绑定手机号</p>",btns:[{name:"前去绑定",callback:function(){location.href="/user/bind/mobile",this.close()}},{name:"偏不绑定"}]}),!1):($.ibox({title:"提示信息",width:300,content:"<p>完成任务需要先绑定账号</p>",btns:[{name:"前去绑定",callback:function(){location.href="/user/third_complete",this.close()}},{name:"偏不绑定"}]}),!1):(yp.pub("page/login"),!1)))},fPubRewardEvent:function(e){var a=this,t=null;yp.each(a.taskList,function(a){a.id==e&&(t=a)}),+t.experience&&yp.pub("page/experience/add",{exp:t.experience}),+t.gold&&yp.pub("page/rich/update",{num:t.gold,type:"gold"}),+t.coin&&yp.pub("page/rich/update",{num:t.coin,type:"coin"}),+t.bullet&&yp.pub("page/rich/update",{num:t.bullet,type:"bullet"})}};o.create(),l.init(),yp.use("rich",function(a,t){t.init({sGetRichUrl:e.oUrl.sGetRichUrl})}),function(){({matchDataIsLoad:!1,heightNum:0,_ui:{},oDtd:{gameClassDtd:null},init:function(){if(this._ui.$js_left_panel=$("#js-left-panel"),!this._ui.$js_left_panel.length)return!1;this.oDtd.gameClassDtd=$.Deferred(),this.view(),this.bindEvent(),this.listenYpEvent(),this.fLeftPanelResize(),this.fLoadGameClassList(),this.getMatchSpecialData()},view:function(){var e=this,a=e._ui;a.$body=$("body"),a.$win=$(window),a.$topBar=$(".topBar-bg"),a.$js_left_panel_collapse_btn=$(".js-left-panel-collapse-btn"),a.$js_left_panel_more=$("#js-left-panel-more"),a.$left_open_game_class_list=$("#js-left-open-game-class-list"),a.$left_open_game_class_list_small=$("#js-left-open-game-class-list-small"),a.$match_special_area=$(".match-special-area"),a.$match_special_top=$(".match-special-top"),a.$match_special_bd=$(".match-special-bd"),$.when(e.oDtd.gameClassDtd).always(function(){a.$body.hasClass("open-left")||e.fCheckToAutoOpenLeft()})},bindEvent:function(){var e=this,a=e._ui;e.fBindCollapsePanel(),a.$match_special_top.on("click",function(t){if(t.preventDefault(),a.$match_special_area.hasClass("open-special"))a.$match_special_bd.css({height:0}),a.$match_special_area.removeClass("open-special"),mfTongji("pc_video_click_count_live_title_match","open");else{e.heightNum;a.$match_special_bd.css({height:a.$match_special_bd.find(".match-special").outerHeight(!0)}),a.$match_special_area.addClass("open-special"),mfTongji("pc_video_click_count_live_title_match","close")}})},fBindCollapsePanel:function(){var e=this,a=e._ui;a.$js_left_panel_collapse_btn.on("click",function(t){t.preventDefault();var n=!!a.$body.hasClass("open-left");e.fCollapsePanel(n),yp.pub("page/leftpanel/collapse/click",{bClose:n}),e.fSetOpenLeftFlag(!n),mfTongji("leftnavigation_openclose","videos")})},fCollapsePanel:function(e){var a=this;a._ui.$body.toggleClass("open-left",!e),yp.pub("page/leftpanel/collapse",{bClose:e}),a.fLeftPanelResize()},listenYpEvent:function(){var e=this;e._ui;yp.sub("ui/resize",function(){e.fLeftPanelResize()}),yp.sub("page/collapse/left",function(a,t){e.fCollapsePanel(!!t.collapse)}),yp.sub("page/leftpanel/resize",function(){e.fLeftPanelResize()})},fLeftPanelResize:function(){var e=this,a=e._ui,t=a.$win.height()-a.$topBar.height();a.$js_left_panel.height(t),a.$js_left_panel_more.height(t),a.$body.hasClass("open-left")&&a.$js_left_panel_more.find(".js-scroll").add(a.$js_left_panel_more.find(".slimScrollDiv")).height(t-100)},getMatchSpecialData:function(){var e=this;e._ui;if(e.matchDataIsLoad)return!1;e.matchDataIsLoad=!0,yp.ajax("/api/static/v2.2/index/matchlist.json").done(function(a){if(0==a.code){var t=a.data||[],n=[];yp.each(t,function(e,a){e.leftTeam.teamLogo&&n.push(e)}),e.oBlockData.previewData=n,0<e.oBlockData.previewData.length&&e.fRenderPreviewBlock(e.oBlockData.previewData)}}),yp.ajax("/api/static/esport/news/5.json").done(function(a){0==a.code&&(e.oBlockData.informationData=a.data,0<e.oBlockData.informationData.length&&e.fRenderInformationBlock(e.oBlockData.informationData))})},bLoaded:!1,fLoadGameClassList:function(){var e=this;e._ui;if(e.bLoaded)return!1;e.bLoaded=!0,yp.ajax("/api/static/v2.2/class/lists.json",{noCache:!0}).done(function(a){0==a.code&&(e.oBlockData.gameClassData=a.data,e.fRenderGameClassList(e.oBlockData.gameClassData),e.fRenderGameClassListSmall(e.oBlockData.gameClassData))}).always(function(){e.oDtd.gameClassDtd.resolve()})},fRenderGameClassList:function(e){var a=this,t=a._ui,n="",o="",l="";yp.each(e,function(e){var a="chuanqi"==e.classKey?"/legend/index":e.classUrl;l=1==e.display?'<li><a class="all" href="/games?cid='+e.id+"#spm=slider.left\" onclick=\"mfTongji('leftnavigation_open_item', '"+e.classKey+"_all');\">全部&raquo;</a></li>":"",o="",yp.each(e.classContent,function(e){1==e.isLeftShow&&(o+='<li class="js-left-side-game-item" data-id="'+e.gameId+'"><a href="'+e.gameUrl+'#spm=slider.left" title="'+e.gameName+"\" onclick=\"mfTongji('leftnavigation_open_item', '"+e.gameId+"');\">"+e.gameName+"</a></li>")}),n+='<div class="side-hot-game"><div class="hd"><h2><a href="'+a+"#spm=slider.left\" onclick=\"mfTongji('leftnavigation_open_item', '"+e.classKey+"');\">"+e.name+'</a></h2></div><div class="bd"><ul class="clearfix">'+o+l+"</ul></div></div>"}),n&&t.$left_open_game_class_list.replaceWith(n)},fRenderGameClassListSmall:function(e){var a=this,t=a._ui,n="";yp.each(e,function(e){if(e.subtitle){var a="chuanqi"==e.classKey?"/legend/index":e.classUrl;n+='<li class="li">              <a href="'+a+'#spm=slider.left.close" class="a" onclick="mfTongji(\'leftnavigation_close_item\', \''+e.classKey+'\');">                <i class="fn-icon" style="background-image:url('+e.icon+');"></i>                <p>'+e.subtitle+"</p>              </a>            </li>"}}),n&&t.$left_open_game_class_list_small.append(n)},fCheckToAutoOpenLeft:function(){var e=this,a=!1;if(window.localStorage&&!window.roomType){1==yp.localStorage.getItem("left_open")&&(e.fCollapsePanel(!1),a=!0)}return a},fSetOpenLeftFlag:function(e){window.localStorage&&yp.localStorage.setItem("left_open",e?"1":"0")},oBlockData:{gameClassData:null,previewData:null,informationData:null,videoData:null},fRenderPreviewBlock:function(e){var a=this,t=a._ui,n="",o="",l="",i=0;yp.each(e,function(e,a){e.icon&&i<3&&(++i,n+='<li>            <div class="img-box">              <img src="'+e.icon+'" alt="" class="img-wh">            </div>          </li>'),o+='<li>            <div class="match">'+e.title+'</div>            <div class="time">'+e.esportTime+'</div>            <div class="info clearfix">              <div class="left fl">                <img src="'+e.leftTeam.teamLogo+'" alt="'+e.leftTeam.teamName+'" class="img-wh">              </div>              <div class="vs fl">                <i class="icon"></i>                <a href="'+e.url+'" class="btn" target="_blank" onclick="mfTongji(\'pc_video_click_count_live_title_match_foreshow\', \'videos\')">查看</a>              </div>              <div class="right fr">                <img src="'+e.rightTeam.teamLogo+'" alt="'+e.rightTeam.teamName+'" class="img-wh">              </div>            </div>            </li>',l='<div class="preview-hd">          <i class="icon dv"></i>          <span class="dv">赛事预告</span>          </div>          <div class="preview-bd">            <ul>'+o+"</ul>          </div>"}),t.$match_special_top.find(".special-top-ul-list").html(n),t.$match_special_bd.find(".match-preview-area").html(l)},fRenderInformationBlock:function(e){var a=this,t=a._ui,n="";yp.each(e,function(e,a){var t="";0==a&&(t="first"),n+='<li class="clearfix '+t+'">            <a href="https://www.zhanqi.tv/information/'+e.informationId+'.html" target="_blank">              <i class="icon fl"></i>              <p class="fl">'+e.title+"</p>            </a>          </li>"}),t.$match_special_bd.find(".match-information-list").html(n)},fRenderVideoBlock:function(e){var a=this,t=a._ui,n="";yp.each(e,function(e,a){var t="";t=e.vspic?e.vspic:e.bpic,n+='<li>            <a href="'+e.url+'" target="_blank">              <div class="img-ibox">                <img src="'+t+'" alt="" class="img-wh">                <i class="play-icon"></i>                <span class="time">'+e.showTime+'</span>              </div>              <p class="title">'+e.title+"</p>            </a>          </li>"}),t.$match_special_bd.find(".match-video-list").html(n)}}).init()}()}),define("j/public/4.0/topLeftNav",function(){});