var $jscomp={scope:{},findInternal:function(a,e,c){a instanceof String&&(a=String(a));for(var b=a.length,d=0;d<b;d++){var f=a[d];if(e.call(c,f,d,a))return{i:d,v:f}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,e,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[e]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,e,c,b){if(e){c=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var d=a[b];d in c||(c[d]={});c=c[d]}a=a[a.length-1];b=c[a];e=e(b);e!=b&&null!=e&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:e})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6-impl","es3");
$(function(){var a=$("#modalAuth").find("form"),e=$("#modalAuthEmailField"),c=$("#modalAuthPassword"),b=$("#modalAuthError"),d=$("#modalAuthSubmit");a.riaForm({errorInput:!0,errorLabel:!0,errorClass:"m-error",errorMessage:!1,errorAlert:!0,alert:"#modalAuthError",alertLabel:"",loader:".l-modal__container .l-modal__loader",rules:{login:"empty",password:"empty"},alerts:{login:{empty:GLOBAL.locale.id.errors.emptylogin,not_exist:GLOBAL.locale.id.errors.wrong},password:{wrong:GLOBAL.locale.id.errors.wrong},
secret:{secret:GLOBAL.locale.id.errors.confirm},user:{banned:GLOBAL.locale.id.errors.block,deleted:GLOBAL.locale.id.errors.del,confirmationRequired:GLOBAL.locale.id.errors.confirmation}},successCallback:function(a,b){modalLayer.close({clearForm:!0,afterClose:function(){GLOBAL.events.trigger("login",a)}})},errorCallback:function(a){d.hide();a.user&&b.attr("user_id",a.user);a.errors&&"confirmationRequired"===a.errors.user&&setTimeout(function(){b.find(".m-email").text(e.val())},0);d.show().find(".form__btn").attr("disabled",
!0)}});$(".modal__social a").each(function(){$(this).riaAuthSocial({provider:$(this).data("provider")})});a.on("input change paste",function(){a[0].checkValidity()&&(b.hide(),d.show().find(".form__btn").removeAttr("disabled"))});e.on("input change paste keyup",function(){this.checkValidity()?(b.hide(),d.show()):(b.show().html(GLOBAL.locale.id.errors.wronglogin),d.hide().find(".form__btn").attr("disabled",!0))});c.on("input change paste keyup",function(){this.checkValidity()||d.find(".form__btn").attr("disabled",
!0)});$("body").on("click","#modalUserRemindLetter",function(){$.ajax({url:"/services/id/email/restore_account/",type:"post",dataType:"json",data:{user_id:b.attr("user_id")},success:function(a){"success"===a.status?b.html(GLOBAL.locale.id.errors.send):b.html(GLOBAL.locale.id.errors.notsend)}})});"?restore_account"==location.search&&setTimeout(function(){modalLayer.open({customTitle:GLOBAL.locale.id.restoreaccount.success,customContent:""})},100);"?restore_account_error"==location.search&&setTimeout(function(){modalLayer.open({customTitle:GLOBAL.locale.id.restoreaccount.error,
customContent:""})},100);GLOBAL.events.subscribe("login",function(a){$(".header__menu-login").removeAttr("data-modal-open").attr("href","/id/profile/");GLOBAL.auth.status="ok";GLOBAL.auth.moderator=a.user.moderator;GLOBAL.user=a.user;GLOBAL.csrf_token=a.user.csrf_token;$('input[name="csrf_token"]').val(GLOBAL.csrf_token);ria_sock&&ria_sock.send({type:"user_login",message:{user_id:GLOBAL.user.id||null}});ria_chat&&ria_chat.auth();$("body").addClass("m-auth")});GLOBAL.events.subscribe("logout",function(){ria_sock&&
ria_sock.send({type:"user_logout",message:{user_id:GLOBAL.user.id||null}})})});
