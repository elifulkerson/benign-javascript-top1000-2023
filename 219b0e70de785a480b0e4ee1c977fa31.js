WH.Wow.TodayInWow=function(e,t){const n=WH.StatusWidget.Assaults;const a=WH.BlizzardApi;const i=WH.Device;const s=WH.Wow.Expansion;const o=WH.Game;const l=WH.Icon;const r=WH.Wow.Item;const c=WH.LocalStorage;const d=WH.StatusWidget.Progression;const f=WH.Strings;const u=WH.Switcher;const W=WH.TERMS;const g=WH.Time;const m=WH.StatusWidget.Timers;const H=WH.Url;const w=WH.StatusWidget.Warfronts;const p=WH.Wow;const h="assault";const S="lines";const E="mythic-progression";const M="timer";const _="warfront";const v="token";const I=[h,S,E,M,_,v];const y="Group has missing or invalid content";const N=[s.DF,s.SL,s.BFA,s.LEGION,s.WOD];const T=[...new Set(t.map((e=>e.regionId)))];const D=["group-mythic-progression","group-holiday"];const q=[p.SIDE_ALLIANCE,p.SIDE_HORDE];const O="expansion";const b="region";const L="settings";const $="side";const C=[b,O,$,L];const R=WH.getServerTime().getTime()-Date.now();const x=10*g.MS_SEC;const A={assaultWidgets:{},assaultWidgetData:{},delayedGroups:[],elements:{container:undefined,header:undefined,regionPanels:{},switcherContainer:undefined},isStandalone:undefined,progressionWidget:{},region:undefined,settingsSwitcher:undefined,timerWidgetData:{},timerWidgets:{},warfrontWidgetData:{},warfrontWidgets:{}};function k(){if(!c.isSupported()){return}let e=Te(c.KEY_WOW_TODAY_IN_WOW_VISIBILITY);WH.qsa("[data-tiw-section]",A.elements.container).forEach((function(t){WH.aE(t,"click",qe.bind(null,t));WH.ae(t,WH.ce("span",{className:"tiw-config-section-control fa fa-eye-slash"}));WH.ae(t,WH.ce("span",{className:"tiw-config-section-control fa fa-eye"}));var n=t.dataset.tiwSection;if(D.indexOf(n)>=0){t.classList.add("tiw-config-hidden")}if(e.hasOwnProperty(n)){if(!!e[n]){t.classList.remove("tiw-config-hidden")}else{t.classList.add("tiw-config-hidden")}}}));Ye()}function Y(){WH.qsa("a",A.elements.container).forEach((function(e){WH.Track.setLinkClickEvent(e,"Home",(function(e){if(e.parentNode&&e.parentNode.nodeName=="B"){return"Today in WoW - Heading"}return"Today in WoW - Link"}))}))}function U(){A.elements.container.querySelectorAll(".tiw-group-wowtoken svg[data-prices]").forEach((function(e){let t;try{t=JSON.parse(e.dataset.prices)}catch(n){WH.error("Bad JSON for token prices: "+e.dataset.prices);t=[]}if(!t.length){return}let n=e.querySelector("line");if(i.isTouch()){let a=WH.qs(".tiw-group-name a",e.parentNode.parentNode);let i=e.parentNode.querySelector("span");if(!i||!a){WH.error("Could not find token price display.");return}let s=WH.ce("span",{className:"q1",style:{display:"none",textTransform:"none"}});WH.ae(a.parentNode,s);i.dataset.original=i.innerText.trim();WH.aE(e,"click",(function(o){let l=Q(e,n,t,o);WH.st(i,l.price);WH.st(s,l.formattedTime);WH.displayNone(a);WH.displayDefault(s)}));WH.aE(e,"mouseout",(function(){WH.st(i,i.dataset.original);WH.displayDefault(a);WH.displayNone(s);n.x1.baseVal.value=n.x2.baseVal.value=-1e3}))}else{WH.aE(e,"mousemove",(function(a){let i=Q(e,n,t,a);let s=f.sprintf(e.dataset.tooltipTemplate,i.price,i.formattedTime);WH.Tooltip.showAtCursor(a,s)}));WH.aE(e,"mouseout",(function(){n.x1.baseVal.value=n.x2.baseVal.value=-1e3;WH.Tooltip.hide()}))}}))}function B(e){let t=e.expansion;if(N.indexOf(t)===-1){t=null}let n=[];n.push({active:t===null,name:WH.TERMS.featured,onChange:ve.bind(null,null)});for(let e=0,a;a=N[e];e++){n.push({active:t===a,name:s.getAbbreviation(a),onChange:ve.bind(null,a)})}new u(WH.qs("#tiw-switcher-expansion",A.elements.container),n);ve(t,true)}function P(){if(A.isStandalone){A.elements.header=WH.ce("header",{className:"tiw-header"});WH.ae(A.elements.container,A.elements.header);WH.ae(A.elements.header,WH.getMajorHeading(Z(),1,1));[b,L].forEach((e=>F(e)));WH.ae(A.elements.header,WH.ce("section",{className:"tiw-local-timezone"},WH.ct(WH.TERMS.timesinyourtimezone_tip)));let e=WH.qs('meta[name="description"]');if(e&&e.content){WH.ae(A.elements.header,WH.ce("p",{className:"tiw-lead-paragraph"},WH.ct(e.content)))}}else{WH.ae(A.elements.container,WH.getMajorHeading(WH.ce("a",{href:H.generatePath(J())},WH.ct(Z())),2,3));C.forEach((e=>F(e)))}}function V(){T.forEach((e=>{A.elements.regionPanels[e]=WH.ce("section",{className:"tiw-region",dataset:{region:e}});WH.ae(A.elements.container,A.elements.regionPanels[e])}))}function z(e){let t=[];T.forEach((n=>{t.push({active:n===e,name:a.getRegionAbbreviation(n),onChange:Ie.bind(null,n)})}));new u(WH.qs("#tiw-switcher-region",A.elements.container),t)}function K(e){let t=e.side;if(q.indexOf(t)===-1){t=null}let n=[];n.push({active:t===null,name:WH.TERMS[p.getSideTerm(p.SIDE_BOTH)],onChange:ye.bind(null,null)});for(let e=0,a;a=q[e];e++){n.push({active:t===a,name:WH.TERMS[p.getSideTerm(a)],onChange:ye.bind(null,a)})}new u(WH.qs("#tiw-switcher-side",A.elements.container),n);ye(t,true)}function F(e){if(A.isStandalone&&!A.elements.switcherContainer){A.elements.switcherContainer=WH.ce("section",{className:"tiw-switcher-container"});WH.ae(A.elements.header,A.elements.switcherContainer)}WH.ae(A.elements.switcherContainer||A.elements.container,WH.ce("section",{id:`tiw-switcher-${e}`,className:"tiw-switcher"}))}function G(){A.settingsSwitcher=new u(WH.ge("tiw-switcher-settings"),[{id:L,name:WH.TERMS.settings,onChange:function(){A.elements.container.classList.toggle("tiw-config-mode");xe()},nonTouchTooltip:function(){let e=X();if(e===0){return undefined}let t=WH.term(e===1?"savedChange_format":"savedChanges_format",e);return WH.ce("div",{className:"no-wrap q"},WH.ct(t)).outerHTML}}],{toggleable:true})}function j(){let e=o.get();if(e===o.WOW){return WH.getDataTree()===WH.dataTree.RETAIL?o.getAbbrev(e):s.getAbbreviation(s.get())}else{return o.getSeoName(e)}}function Z(){return WH.term("todayIn_format",j())}function J(){return`/today-in-${o.getKey(o.get())}`}function Q(e,t,n,a){let i=WH.getOffset(e);let s=(a.clientX-i.left)/e.clientWidth;t.x1.baseVal.value=t.x2.baseVal.value=(e.viewBox.baseVal.width-1)*s;s=Math.round(s*1e3);let o=0;let l=n.length-1;let r;while(o!==l){r=Math.ceil((o+l)/2);if(n[r][0]>s){l=r-1}else{o=r}}let c={price:n[r][1],formattedTime:WH.TERMS.unknown};let d=n[r][2];if(n[r][0]<s&&r<l){let e=n[r][0];let t=n[r+1][0];if(s-e>t-s){c.price=n[r+1][1];d=n[r][2]}}else if(n[r][0]>s&&r>o){let e=n[r-1][0];let t=n[r][0];if(s-e<t-s){c.price=n[r-1][1];d=n[r][2]}}if(d){let e=new Date(d*g.MS_SEC);c.formattedTime=e.toLocaleTimeString([],{hour:"numeric",minute:"2-digit",timeZoneName:"short"})+WH.TERMS.wordspace_punct+e.toLocaleTimeString([],{weekday:"short"}).split(" ")[0]}return c}function X(){let e=Te(c.KEY_WOW_TODAY_IN_WOW_VISIBILITY);return e?Object.keys(e).length:0}function ee(e,t,n=false){A.elements.container=e;A.isStandalone=n;if(A.isStandalone){WH.aE(A.elements.container,"resize",(e=>{let t=e.target;let n=t.getBoundingClientRect().width;if(n<=WH.Responsive.BREAKPOINTS.MOBILE_MODE&&!t.dataset.layoutMode){t.dataset.layoutMode="small"}else if(n>WH.Responsive.BREAKPOINTS.MOBILE_MODE){delete t.dataset.layoutMode}}))}P();V();He(t);T.forEach((e=>{We(e);he(e);Ee(e)}));!A.isStandalone&&A.delayedGroups.forEach((e=>{me(e.group,e.container,e.region,true)}));T.forEach((e=>{WH.isRetailTree()&&Me(e)}));let a=Te(c.KEY_WOW_TODAY_IN_WOW_FILTER);let i=a.region||"US";i=i==="Oceanic"?"US":i;z(i);if(WH.isRetailTree()){if(!A.isStandalone){B(a);K(a)}G()}Ie(i);ue();se();ae();ie();T.forEach((e=>{te(e);ne(e);le(e);re(e);ce(e);fe(e);oe(e);WH.isRetailTree()&&!A.isStandalone&&ge(e)}));Y();k();U()}function te(e){const t="group-aylaag-camp";const n=WH.qs(`#${e}-${t}`);if(n){const e="current";const a="moving";const i="next";const s=["quantity","name","ending"];const o={[e]:[{level:1,time:1*g.MS_DAY},{level:2,time:.5*g.MS_DAY},{level:3,time:.25*g.MS_DAY},{level:4,time:.08*g.MS_DAY}],[a]:[{level:1,time:1*g.MS_DAY},{level:2,time:.5*g.MS_DAY},{level:3,time:.25*g.MS_DAY},{level:4,time:.08*g.MS_DAY}]};let l={stage:e};let r={stage:a};let c={stage:i};let d=[l,r,c];s.forEach((e=>{d.forEach((t=>{let a=WH.qs(`.tiw-line-${e}.camp-stage-${t.stage}`,n);a.classList.add("tiw-active");t[e]=a}))}));n.dataset.campStage=e;let f=s=>{let l=Date.now()+R;let r=parseInt(s.ending.dataset.ut,10);let c=r-Math.floor(l/g.MS_SEC);if(c>0){WH.st(s.ending,g.formatDeltaWithSymbols(c));Ce(s.ending,s.stage===a?o[a]:o[e],c*g.MS_SEC);if(!n.dataset.campStage){n.dataset.campStage=s.stage}}else{delete n.dataset.campStage;if(s.stage===i){let e=WH.qs(`.tiw-group-wrapper[data-tiw-section="${t}"]`);WH.ee(e);WH.de(e);u.forEach((e=>clearInterval(e)))}}};let u=[];d.forEach((e=>{u.push(setInterval(f,x,e))}))}}function ne(e){let t=WH.qs(`#${e}-group-community-feast`,A.elements.container);if(!t){return}let n=WH.qs(".tiw-line-ending",t);let a=WH.qs(".tiw-line-name",t);if(!n||!a){return}let i={US:"2022-11-22T21:00+0000",EU:"2022-11-29T20:30+0000"};let s=Date.now()+R;let o=15*g.MS_MIN;let l=1.5*g.MS_HOUR;let r=Date.parse(i[e]);let c=Math.floor((s-r)/l);let d=r+c*l;while(d+o-s<0){d+=l}function f(){let e=Date.now()+R;d=d+o-e<0?d+l:d;let t=d+o;let i=d-e;let s=WH.TERMS.cookingBegins;let r="tiw-active";n.classList.remove(r);a.classList.remove(r);if(t-e<=o){s=WH.TERMS.cookingStarted;i=t-e;n.classList.add(r);a.classList.add(r)}let c=[{level:1,time:30*g.MS_MIN},{level:2,time:15*g.MS_MIN},{level:3,time:10*g.MS_MIN},{level:4,time:5*g.MS_MIN}];Ce(n,c,i);WH.st(n,`${g.formatDeltaWithSymbols(i/g.MS_SEC)}`);WH.st(a,s)}f();setInterval(f,x)}function ae(){let e='.tiw-group-wrapper[data-tiw-section="group-a-greedy-emissary"]';let t=WH.qsa(e,A.elements.container);if(t.length===0){return}let n=0;t.forEach(((e,t)=>{["ending","quantity","name"].forEach((t=>{let a=0;let i=WH.qsa(`.tiw-line-${t}`,e).forEach((e=>e.dataset.row=a++));n=a}))}));setInterval(be,x,n);be(n)}function ie(){let e='.tiw-group-wrapper[data-tiw-section="group-d4-world-bosses"]';let t=WH.qsa(e,A.elements.container);if(t.length===0){return}t.forEach((e=>{["ending","quantity","name"].forEach((t=>{let n=0;WH.qsa(`.tiw-line-${t}`,e).forEach((e=>e.dataset.row=n++))}));let t=WH.ce("a",{className:"tiw-group-toggler fa fa-caret-down",dataset:{show:"more"}},WH.ct(WH.TERMS.more));let n=WH.ce("a",{className:"tiw-group-toggler fa fa-caret-up",dataset:{show:"less"}},WH.ct(WH.TERMS.less));WH.aE(t,"click",(()=>e.dataset.show="more"));WH.aE(n,"click",(()=>delete e.dataset.show));WH.preventSelectStart(t);WH.preventSelectStart(n);WH.ae(e,t);WH.ae(e,n)}));setInterval(Le,x);Le()}function se(){let e='.tiw-group-wrapper[data-tiw-section="group-dragonflight-rares"]';let t=WH.qsa(e,A.elements.container);if(t.length===0){return}let n=0;t.forEach(((e,t)=>{["ending","quantity","name"].forEach((t=>{let a=0;let i=WH.qsa(`.tiw-line-${t}`,e).forEach((e=>e.dataset.row=a++));n=a}))}));setInterval($e,x,n);$e(n)}function oe(e){const t=`#${e}-group-tiw-timer`;const n=`#${e}-group-raidresets`;const a=[t,n];const i={[t]:{interval:g.SEC_DAY,urgencies:[{level:1,time:3*g.SEC_HOUR},{level:2,time:g.SEC_HOUR},{level:3,time:30*g.SEC_MIN},{level:4,time:10*g.SEC_MIN}]},[n]:{interval:g.SEC_DAY*7,urgencies:[{level:1,time:3.5*g.SEC_DAY},{level:2,time:2*g.SEC_DAY},{level:3,time:g.SEC_DAY},{level:4,time:.5*g.SEC_DAY}]}};a.forEach((e=>{let t=WH.qs(e);if(!t){return}let n=WH.qsa(".tiw-line-ending",t);if(!n){return}n.forEach((t=>{let n=()=>{let n=Date.now()+R;let a=parseInt(t.dataset.ut,10);let s=a-Math.floor(n/g.MS_SEC);if(s>0){WH.st(t,g.formatDeltaWithSymbols(s));Ce(t,i[e].urgencies,s)}else{t.dataset.ut=`${a+i[e].interval}`}};setInterval(n,x)}))}))}function le(e){let t=WH.qs(`#${e}-group-dragonriding-race`,A.elements.container);if(!t){return}let n=["quantity","name","ending"];let a=[];n.forEach((e=>{let n=WH.qsa(`.tiw-line-${e}`,t);if(n){n.forEach(((t,n)=>{if(!a[n]){a.push({})}a[n][e]=t}))}}));let i={US:"2022-11-12T15:00+0000",EU:"2022-11-12T04:00+0000"};let s=1*g.MS_DAY;let o=Date.parse(i[e]);function l(){let e=Date.now()+R;let t=Math.floor((e-o)/s)%a.length;a.forEach(((e,a)=>{n.forEach((n=>{if(e[n]){e[n].style.display=a===t?"block":"none"}}))}))}l();setInterval(l,x)}function re(e){let t=WH.qs(`#${e}-group-elemental-storms`,A.elements.container);if(!t){return}let n=["name","ending","quantity"];let a=[];n.forEach((e=>{let n=WH.qsa(`.tiw-line-${e}`,t);if(n){n.forEach(((t,n)=>{if(!a[n]){a.push({})}if(e==="name"){let e;["earth","air","fire","water"].forEach((n=>{if(t.classList.contains(`elemental-storm-${n}`)){e=n}}));let n=WH.qs("span",t);if(e&&n){WH.Tooltips.attach(n,WH.TERMS[e],`element-${e}`,{byCursor:true})}}else if(e==="ending"){t.classList.add("tiw-active")}a[n][e]=t}))}}));let i=2*g.MS_HOUR;let s=[];let o=(e,n)=>{let{name:o,ending:l,quantity:r}=e;let c=parseInt(l.dataset.ut);let d=Math.floor((Date.now()+R)/g.MS_SEC);let f=c-d;if(c-d<=0){WH.de(o);WH.de(l);WH.de(r);a.splice(n,1);clearInterval(s[n]);if(a.length===0||s.length===0){WH.ee(t);WH.de(t)}}else if(c-d<=i){f=c-d}let u=[{level:1,time:20*g.MS_MIN},{level:2,time:10*g.MS_MIN},{level:3,time:5*g.MS_MIN},{level:4,time:2*g.MS_MIN}];Ce(l,u,f*g.MS_SEC);WH.st(l,`${g.formatDeltaWithSymbols(f)}`)};a.forEach(((e,t)=>{o(e,t);let n=setInterval(o,x,e,t);s.push(n)}))}function ce(e){let t=WH.qs(`#${e}-group-grand-hunt`,A.elements.container);if(!t){return}let n=["name","ending"];let a=[];n.forEach((e=>{let n=WH.qsa(`.tiw-line-${e}`,t);if(n){n.forEach(((t,n)=>{if(!a[n]){a.push({})}a[n][e]=t}))}}));let i=2*g.MS_HOUR;let s=(e,t)=>{let n="tiw-active";t.classList.remove(n);e.classList.remove(n);let a=parseInt(t.dataset.ut);let s=Math.floor((Date.now()+R)/g.MS_SEC);let o=a-s;if(a-s<0){o=2*g.MS_HOUR/g.MS_SEC;t.dataset.ut=a+i/g.MS_SEC;t.classList.add(n);WH.ee(e);WH.st(e,WH.TERMS.huntStarted);e.classList.add(n)}else if(a-s<=i){o=a-s;t.classList.add(n);e.classList.add(n)}let l=[{level:1,time:20*g.MS_MIN},{level:2,time:10*g.MS_MIN},{level:3,time:5*g.MS_MIN},{level:4,time:2*g.MS_MIN}];Ce(t,l,o*g.MS_SEC);WH.st(t,`${g.formatDeltaWithSymbols(o)}`)};a.forEach((e=>{let{name:t,ending:n}=e;s(t,n);setInterval(s,x,t,n)}))}function de(e,t,n,a=true){let i={};i.tiwSection=`group-${e.id}`;if(e.wowExpansion){i.wowExpansion=e.wowExpansion}if(e.requiresWowExpansion&&!A.isStandalone){i.requiresWowExpansion=e.requiresWowExpansion}let s=WH.ce("section",{className:"tiw-group-wrapper",dataset:i});if(D.includes(e.id)){s.classList.add("tiw-config-hidden")}let o={};o.className="tiw-group";o.dataset={};o.id=`${n}-group-${e.id}`;o.dataset.type=e.content.icons?"icons":[h,E,M,_].includes(e.type)?"status-widget":"multi-line";let c=WH.ce("section",o);let d=WH.ce("section",{className:"tiw-group-ending"});let f=WH.ce("section",{className:"tiw-group-quantity"});let u=WH.ce("section",{className:"tiw-group-name"});let W;let g=e.type==="token"&&r.getQualityClass(r.QUALITY_WOW_TOKEN)||"";if(e.url){W=WH.ce("a",{href:e.url,className:`${g} tiw-group-name-link`},WH.ct(e.name))}else{W=WH.ce("span",{className:g},WH.ct(e.name))}if(e.wowIcon&&a){let t=l.getIconUrl(e.wowIcon,l.TINY);let n=WH.ce("a",{href:e.iconUrl},WH.ce("img",{src:t}));WH.ae(u,n)}WH.ae(s,c);WH.ae(c,d);WH.ae(c,f);WH.ae(c,u);WH.ae(u,W);WH.ae(t,s);return[s,c]}function fe(e){let t=WH.qs(`#${e}-group-dragonbane-keep`,A.elements.container);if(!t){return}let n=WH.qs(".tiw-line-ending",t);if(!n){return}const a={US:"2022-11-28T15:00+0000",EU:"2022-11-28T16:00+0000"};let i=Date.now()+R;let s=1*g.MS_HOUR;let o=2*g.MS_HOUR;let l=Date.parse(a[e]);let r=Math.floor((i-l)/o);let c=l+r*o;while(c+s-i<0){c+=o}function d(){let e=Date.now()+R;c=c+s-e<0?c+o:c;let a=c+s;let i=c-e;let l=WH.TERMS.forcesGathering;let r="tiw-active";n.classList.remove(r);if(a-e<=s){l=WH.TERMS.siegeStarted;i=a-e;n.classList.add(r)}let d=[{level:1,time:20*g.MS_MIN},{level:2,time:10*g.MS_MIN},{level:3,time:5*g.MS_MIN},{level:4,time:2*g.MS_MIN}];Ce(n,d,i);WH.st(n,g.formatDeltaWithSymbols(i/g.MS_SEC));let f=WH.qs(".tiw-line-name",t);f&&WH.st(f,l)}d();setInterval(d,x)}function ue(){let e='.tiw-group-wrapper[data-tiw-section="group-tormentors-of-torghast"]';let t=WH.qsa(e,A.elements.container);if(t.length===0){return}t.forEach((function(e){let t=0;let n=function(e){e.dataset.row=t++};t=0;WH.qsa(".tiw-line-ending",e).forEach(n);t=0;WH.qsa(".tiw-line-quantity",e).forEach(n);t=0;WH.qsa(".tiw-line-name",e).forEach(n)}));setInterval(ke,x);ke()}function We(e){A.assaultWidgets[e]=new n(e,A.elements.regionPanels[e],A.assaultWidgetData[e])}function ge(e){let t;if(t=A.elements.regionPanels[e]){let e=WH.ce("a",{href:H.generatePath(J()),className:"tiw-group-cta",tabIndex:0});if(WH.isRetailTree){e.dataset.imageNumber=`${Math.floor(Math.random()*2)}`}let n=WH.ce("section",{className:"tiw-group-cta-text"});let a=[WH.ce("section",{className:"tiw-group-cta-graphic"}),n,WH.ce("section",{className:"tiw-group-cta-button"})];let i=[WH.ce("section",{className:"tiw-group-cta-text-heading"},WH.ct(WH.TERMS.seeMoreOnThe_cta)),WH.ce("section",{className:"tiw-group-cta-text-callout"},WH.ct(WH.term("page_format",Z())))];a.forEach((t=>WH.ae(e,t)));i.forEach((e=>WH.ae(n,e)));WH.ae(e,n);WH.ae(t,e);WH.aE(e,"resize",(()=>{if(e.getBoundingClientRect().width<320){e.dataset.layout="small"}else{delete e.dataset.layout}}))}}function me(e,t,n,a=false){switch(e.type){case h:if(!A.assaultWidgetData[n]){A.assaultWidgetData[n]=[]}A.assaultWidgetData[n].push(e);de(e,t,n,false);break;case S:we(e,t,n);break;case E:if(!A.isStandalone&&!a){A.delayedGroups.push({group:e,container:t,region:n})}else{pe(e,t,n)}break;case M:if(!A.timerWidgetData[n]){A.timerWidgetData[n]=[]}A.timerWidgetData[n].push(e);de(e,t,n,false);break;case v:Se(e,t,n);break;case _:if(!A.warfrontWidgetData[n]){A.warfrontWidgetData[n]=[]}A.warfrontWidgetData[n].push(e);de(e,t,n,false);break}}function He(e){e.forEach((e=>{let t=WH.qs(`.tiw-region[data-region="${e.regionId}"]`,A.elements.container);if(A.isStandalone){let n=WH.ce("section",{className:"tiw-category-wrapper",id:e.id});WH.ae(n,WH.getMajorHeading(e.name,2,2,{classes:"tiw-category-name heading-bar"}));WH.ae(t,n);t=n}e.groups.forEach((n=>Be(n)&&me(n,t,e.regionId)))}))}function we(e,t,n){let[a,i]=de(e,t,n);let s={};s.idPrefix=`${n}-group-${e.id}-line`;s.iconSize=e.content.icons||l.TINY;WH.Wow.TodayInWow.prototype.addLines(i,e.content.lines,s)}function pe(e,t,n){let[a,i]=de(e,t,n,false);A.progressionWidget[n]=new d(n,a,e)}function he(e){A.timerWidgets[e]=new m(e,A.elements.regionPanels[e],A.timerWidgetData[e])}function Se(e,t,n){let[a,i]=de(e,t,n);Ne(i,e)}function Ee(e){A.warfrontWidgets[e]=new w(e,A.elements.regionPanels[e],A.warfrontWidgetData[e])}function Me(e){let t={[s.DF]:"df",[s.SL]:"sl",[s.BFA]:"bfa",[s.LEGION]:"legion"};Object.entries(t).forEach((([t,n])=>{t=parseInt(t);let a=WH.ce("section",{className:"tiw-group-wrapper",dataset:{tiwSection:`world-quests-link-${n}`,wowExpansion:`${t}`}});if(!A.isStandalone){a.dataset.requiresWowExpansion=`${t!==s.getCurrent()}`}let i=WH.ce("section",{className:"tiw-group",dataset:{type:"other"}});let o=WH.ce("a",{className:"tiw-group-map",href:`/world-quests/${n}/${e==="EU"?"eu":"na"}`});WH.ae(o,WH.ce("section",{className:"tiw-group-map-button"}));WH.ae(i,WH.ce("section",{className:"tiw-group-name"},WH.ce("span",{},WH.ct(WH.TERMS.worldquestmaps))));WH.ae(i,o);WH.ae(a,i);let l=WH.qs(`#quests-${t}`,A.elements.regionPanels[e])||A.elements.regionPanels[e];WH.ae(l,a)}))}function _e(e,t){let n=Te(c.KEY_WOW_TODAY_IN_WOW_FILTER);if(t===null){delete n[e]}else{n[e]=t}De(c.KEY_WOW_TODAY_IN_WOW_FILTER,n)}function ve(e,t){if(N.indexOf(e)===-1){e=null}_e(O,e);if(e===null){delete A.elements.container.dataset.wowExpansion}else{A.elements.container.dataset.wowExpansion=e}if(t!==true){xe()}}function Ie(e){A.region=e;_e(b,e);WH.setData('.tiw-region[data-visibility="visible"]',"visibility",null);WH.qs(`.tiw-region[data-region="${e}"]`,A.elements.container).dataset.visibility="visible";xe()}function ye(e,t){if(q.indexOf(e)===-1){e=null}_e($,e);if(e===null){delete A.elements.container.dataset.side}else{A.elements.container.dataset.side=e===p.SIDE_ALLIANCE?"alliance":"horde"}if(t!==true){xe()}}function Ne(e,t){e.classList.add("tiw-group-wowtoken");WH.ae(e,WH.ce("section",{classList:"tiw-line-ending"}));WH.ae(e,WH.ce("section",{classList:"tiw-line-quantity"}));let n=WH.ce("section",{classList:"tiw-line-name"});WH.ae(e,n);n.innerHTML=`${t.content.priceHtml}${t.content.svg}`}function Te(e){return c.get(e)||{}}function De(e,t){if(!Object.keys(t).length){c.remove(e)}else{c.set(e,t)}}function qe(e){if(!A.elements.container.classList.contains("tiw-config-mode")){return}var t=e.dataset.tiwSection;if(!t){WH.error("Section does not have a section ID data property.",e);return}var n=e.classList.contains("tiw-config-hidden");WH.qsa('[data-tiw-section="'+t+'"]',A.elements.container).forEach((function(e){if(n){e.classList.remove("tiw-config-hidden")}else{e.classList.add("tiw-config-hidden")}}));{let e=Te(c.KEY_WOW_TODAY_IN_WOW_VISIBILITY);if(n){if(D.indexOf(t)>=0){e[t]=true}else{delete e[t]}}else{if(D.indexOf(t)>=0){delete e[t]}else{e[t]=false}}De(c.KEY_WOW_TODAY_IN_WOW_VISIBILITY,e)}Ye()}function Oe(){if(A.assaultWidgets[A.region]){A.assaultWidgets[A.region].update()}}function be(e){let t=.5*g.MS_HOUR;let n={US:"2023-05-25T17:00+0000",EU:"2023-05-25T06:00+0000"};let a=Date.now()+R;for(let i in n){if(!n.hasOwnProperty(i)){continue}let s=Date.parse(n[i]);let o=WH.ge(i+"-group-a-greedy-emissary");if(!o){continue}let l=g.MS_MIN;let r=a-l-s;let c=Math.floor(r/t);let d=c%e;let f=[];for(let t=0;t<=3;t++){f.push((d+t)%e)}let u;WH.qsa("[data-row]",o).forEach((e=>{let n=parseInt(e.dataset.row);let a=f.indexOf(n);if(a>=0){e.dataset.visible=1;if(e.classList.contains("tiw-line-quantity")){let n=s+(c+a)*t;u=new Date(n);let i=u.toLocaleTimeString([Locale.getIetf()],{hour:"numeric",minute:"2-digit",timeZoneName:"short"});WH.st(e,i)}if(a===0){let t=(Date.now()-u)/g.MS_SEC;e.dataset.activeRare=t<15*g.SEC_MIN?"true":"false"}}else{delete e.dataset.visible}}));f.forEach((e=>{if(e>=0){WH.qsa('[data-row="'+e+'"]',o).forEach((e=>e.parentNode.appendChild(e)))}}))}}function Le(){const e=15*g.SEC_MIN;let t=Date.now()/g.MS_SEC;T.forEach((n=>{let a=WH.ge(`${n}-group-d4-world-bosses`);if(!a){return}let i={};let s=0;WH.qsa("[data-row]",a).forEach((n=>{let a=i[n.dataset.row]??=parseInt(n.dataset.ut);let o=a>t;let l=!o&&a>t-e;n.dataset.state=l?"active":o?"upcoming":"ended";if(s<4&&(o||l)){if(n.classList.contains("tiw-line-name")){s++}n.style.display=null}else{n.style.display="none"}if(n.classList.contains("tiw-line-ending")){let e=new Date(a*g.MS_SEC);WH.st(n,g.formatFutureTimeAndDay(e,undefined,g.FORMAT_SYMBOL))}}))}))}function $e(e){let t=.5*g.MS_HOUR;let n={US:"2023-02-09T10:30+0000",EU:"2023-02-07T19:30+0000"};let a=Date.now()+R;for(let i in n){if(!n.hasOwnProperty(i)){continue}let s=Date.parse(n[i]);let o=WH.ge(i+"-group-dragonflight-rares");if(!o){continue}let l=g.MS_MIN;let r=a-l-s;let c=Math.floor(r/t);let d=c%e;let f=[];for(let t=0;t<=3;t++){f.push((d+t)%e)}let u;WH.qsa("[data-row]",o).forEach((e=>{let n=parseInt(e.dataset.row);let a=f.indexOf(n);if(a>=0){e.dataset.visible=1;if(e.classList.contains("tiw-line-quantity")){let n=s+(c+a)*t;u=new Date(n);let i=u.toLocaleTimeString([Locale.getIetf()],{hour:"numeric",minute:"2-digit",timeZoneName:"short"});WH.st(e,i)}if(a===0){let t=(Date.now()-u)/g.MS_SEC;e.dataset.activeRare=t<15*g.SEC_MIN?"true":"false"}}else{delete e.dataset.visible}}));f.forEach((e=>{if(e>=0){WH.qsa('[data-row="'+e+'"]',o).forEach((e=>e.parentNode.appendChild(e)))}}))}}function Ce(e,t,n){t.forEach((t=>{let{level:a,time:i}=t;let s="ending-soon";if(n<i){e.classList.add(`${s}-${a}`)}else{e.classList.remove(`${s}-${a}`)}}))}function Re(){if(A.progressionWidget[A.region]){A.progressionWidget[A.region].update()}}function xe(){Oe();Ae();Re();Ue()}function Ae(){if(A.timerWidgets[A.region]){A.timerWidgets[A.region].update()}}function ke(){let e=120*g.MS_MIN;let t={US:"2021-07-26T07:00+0000",EU:"2021-08-01T02:00+0000"};let n=Date.now()+R;for(let a in t){if(!t.hasOwnProperty(a)){continue}let i=Date.parse(t[a]);let s=WH.ge(a+"-group-tormentors-of-torghast");if(!s){continue}let o=0;WH.qsa(".tiw-line-name[data-row]",s).forEach((function(e){let t=parseInt(e.dataset.row);o=Math.max(o,t+1)}));let l=g.MS_MIN;let r=n-l-i;let c=Math.floor(r/e);let d=c%o;let f=[];for(let e=0;e<=2;e++){f.push((d+e)%o)}let u=false;let W=14;let m=f.length;if(f.indexOf(W)<0){u=true;let e=f[m-1];let t=W-e-1;if(t<0){t+=o}while(f.length<m+t){f.push(-1)}f[m+t]=W}let H;WH.qsa("[data-row]",s).forEach((function(t){let n=parseInt(t.dataset.row);let a=f.indexOf(n);if(a>=0){t.dataset.visible=1;if(t.classList.contains("tiw-line-quantity")){let n=i+(c+a)*e;H=new Date(n);let s=H.toLocaleTimeString([Locale.getIetf()],t.dataset.row==="14"&&u&&H.getDate()!==(new Date).getDate()?{hour:"numeric",minute:"2-digit",timeZoneName:"short",weekday:"short"}:{hour:"numeric",minute:"2-digit",timeZoneName:"short"});WH.st(t,s)}if(a===0){let e=(Date.now()-H+5)/g.MS_SEC;t.dataset.activeRare=e<15*g.SEC_MIN?"true":"false"}}else{delete t.dataset.visible}}));f.forEach((function(e){if(e>=0){WH.qsa('[data-row="'+e+'"]',s).forEach((function(e){e.parentNode.appendChild(e)}))}}))}}function Ye(){if(!A.settingsSwitcher){return}let e=WH.TERMS.settings;let t=X();if(t>0){e=WH.term("parens_format",e,t)}A.settingsSwitcher.setChoiceLabel(L,e)}function Ue(){if(A.warfrontWidgets[A.region]){A.warfrontWidgets[A.region].update()}}function Be(e){let t=false;if(e&&e.content&&e.type&&Object.keys(e.content).length!==0){switch(e.type){case h:case M:if(e.content&&Object.keys(e.content).length!==0){t=true}break;case S:if(e.content.lines&&e.content.lines.length!==0){t=true}else{WH.debug(`${y}: ${e.id}`)}break;case E:if(e.content.defeatedBosses&&e.content.topGuildCount&&e.content.totalBosses){t=true}else{WH.debug(`${y}: ${e.id}`)}break;case v:if(e.content.priceHtml&&e.content.url){t=true}else{WH.debug(`${y}: ${e.id}`)}break;case _:t=true;break;default:t=false;WH.error(`Unsupported content type: ${e.type}`)}}return t}ee.apply(this,arguments)};WH.Wow.TodayInWow.prototype.addLines=function(e,t,n){const a=WH.Icon;n=n||{};for(let i=0,s;s=t[i];i++){let t=s.endingSoon?" ending-soon ending-soon-"+s.endingSoon:"";let o=s.class||"";let l=WH.ce("section",{className:`tiw-line-ending${t} ${o}`},s.endingShort?WH.ct(s.endingShort):undefined);WH.ae(e,l);if(s.endingUt){l.dataset.ut=s.endingUt}let r=WH.ce("section",{className:`tiw-line-quantity${t} ${o}`},s.type==="money"?WH.Wow.buildMoney({copper:s.qty}):(s.qty||1)>1?WH.ct(s.qty+"x"):undefined);WH.ae(e,r);let c={};c.className=`tiw-line-name${t} ${o}`;c.id=n.idPrefix?`${n.idPrefix}-${i}`:"";let d=WH.ce("section",c);if(s.ending){WH.Tooltip.addTooltipText(d,s.ending,"q")}let f=s.url&&s.name?WH.ce("a",{href:s.url},WH.ct(s.name||"")):WH.ce("span",undefined,WH.ct(s.name||""));if(s.icon){let e=n.iconSize&&a.isValidSize(n.iconSize)?n.iconSize:a.TINY;let t=a.getIconUrl(s.icon,e);let i=WH.ce("img",{src:t});if(s.iconUrl){let e=WH.ce("a",{href:s.iconUrl});WH.ae(e,i);WH.aef(d,e)}else{WH.aef(f,i)}}WH.ae(d,f);if(s.side){l.dataset.side=s.side;r.dataset.side=s.side;d.dataset.side=s.side}WH.ae(e,d)}};