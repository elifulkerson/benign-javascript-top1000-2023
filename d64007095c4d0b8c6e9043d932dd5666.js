!function(){var e="https://api.comment.digital.asahi.com/";function t(e){"use strict";var t=e.split("articles")[1];return void 0!==e.split("articles")[1]?t=(t=t.substring(0,t.indexOf(".html"))).replace("/",""):null}if(null!==document.querySelector("#tabBody_latestComments")){var n=window.location.pathname.split("/").includes("sp"),a=new XMLHttpRequest;a.open("GET",e+"comments?id=&latest=true",!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){"use strict";if(4===this.readyState&&200===this.status){var e=document.getElementById("tabBody_latestComments"),t=document.createElement("h3");t.className="p-latestCommentsList__commentPlusLogo";var a=document.createElement("a");a.href=n?"//www.asahi.com/comment/?iref=sptop_LatestComments_logo":"//www.asahi.com/comment/?iref=comtop_LatestComments_logo";var s=document.createElement("img");s.width=88,s.alt="コメントプラス",s.src="https://www.asahicom.jp/css/images/logo_commentPlus.png",a.appendChild(s),t.appendChild(a);var o=document.createElement("ul");o.className="p-latestCommentsList";var i=JSON.parse(this.response).result;Object.values(i).map((function(e){return e})).flat().sort((function(e,t){return new Date(t.published_at.replace(/-/g,"/"))-new Date(e.published_at.replace(/-/g,"/"))})).slice(0,20).map((function(e){var t=document.createElement("li");t.className="p-latestCommentsList__item";var a=document.createElement("a");a.href="https://digital.asahi.com/articles/"+e.article_id+".html?comment_id="+e.comment_id+(n?"&iref=sptop_LatestComments_list#expertsComments":"&iref=comtop_LatestComments_list#expertsComments");var s=document.createElement("img");s.width=n?44:40,s.height=n?44:40,s.className="p-latestCommentsList__item__commentatorImage",s.src=e.image_url,s.alt=e.user_name,a.appendChild(s);var i=document.createElement("span");i.className="p-latestCommentsList__item__infoText";var c=document.createElement("img"),r=document.createTextNode(e.user_name+"さんがコメントしました");c.width=14,c.height=13,c.src="https://contents.comment.digital.asahi.com/img/brand/icon_expertsComments.svg",c.alt="コメント",i.appendChild(c),i.appendChild(r),a.appendChild(i);var l=document.createElement("h4");l.className="p-latestCommentsList__item__articleTitle";var m=document.createTextNode(e.title);l.appendChild(m),a.appendChild(l),i.appendChild(r),t.appendChild(a),o.appendChild(t)}));var c=document.createElement("a"),r=document.createTextNode("最新コメント一覧へ"),l=n?"?iref=sptop_LatestComments":"?iref=comtop_LatestComments_bottomLink";c.href="https://www.asahi.com/comment/"+l,c.className="p-latestCommentsList__moreLink",c.appendChild(r);var m=document.createElement("div");m.className="p-tab__body__functionInfo";var u=document.createElement("span");u.className="p-tab__body__functionInfo__close",u.onclick=function(){m.className="p-tab__body__functionInfo"};var d=document.createElement("strong");d.appendChild(document.createTextNode("最新のコメントつき記事はこちら。共感したら押せるハートボタンも登場！")),d.appendChild(u),m.appendChild(d),e.appendChild(m),e.appendChild(t),e.appendChild(o),e.appendChild(c);var p=document.getElementsByClassName("p-tab__header p-tab__header__latestComments");p[0].classList.add("isLoaded");var h=new Date("2022-03-18 09:59:59");if(!document.cookie.split(";").some((function(e){return e.trim().startsWith("newPopup=")}))&&h>new Date){var _=new Date;_.setDate(_.getDate()+1),_.setHours(9,59,59),document.cookie="newPopup=true; expires="+_.toUTCString(),p[0].classList.add("isNew")}if(!document.cookie.split(";").some((function(e){return e.trim().startsWith("latestNotification=")}))){var f=new Date;f.setDate(f.getDate()+1),f.setHours(9,59,59),document.cookie="latestNotification=true; expires="+f.toUTCString(),p[0].classList.add("hasLatest")}document.cookie.split(";").some((function(e){return e.trim().startsWith("informationBar=")}))||(document.cookie="informationBar=true; expires=Fri, 31 Dec 9999 23:59:59 GMT",m.className="p-tab__body__functionInfo isShow");var C=!0;document.querySelector(".p-tab__header__latestComments").addEventListener("click",(function(){p[0].classList.contains("isActive")&&C&&(function(e,t){try{sc_trackClickBtn(e)}catch(e){console.log("Failed to track of: ".concat(e.stack))}}("top|LatestComments"),C=!1)}))}},a.send()}if("/"===window.location.pathname||"/sp/"===window.location.pathname){var s='<figure class="c-icon">';s+='<img src="https://contents.comment.digital.asahi.com/img/brand/icon_expertsCommentsL.svg" alt="コメントあり" style="width: 66px; height: 17px">',s+="</figure>";var o=[],i=document.querySelector(".c-articleModule a"),c=document.querySelectorAll(".p-topNews__list a"),r=document.querySelectorAll(".p-breaking a"),l=document.querySelectorAll(".p-theme a"),m=document.querySelectorAll(".p-opinion a"),u=t(i.href);if(null===u||o.includes(u)||o.push(u.trim()),c.forEach((function(e){"use strict";var n=t(e.href);null===n||o.includes(n)||o.push(n.trim())})),r.forEach((function(e){"use strict";var n=t(e.href);null===n||o.includes(n)||o.push(n.trim())})),l.forEach((function(e){"use strict";var n=t(e.href);e.parentElement.classList.contains("c-articleModule")&&null!==n&&!o.includes(n)&&o.push(n.trim())})),m.forEach((function(e){"use strict";var n=t(e.href);e.parentElement.classList.contains("c-articleModule")&&null!==n&&!o.includes(n)&&o.push(n.trim())})),o.length){var d=new XMLHttpRequest;d.open("GET",e+"icons?id="+o.join(),!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.onreadystatechange=function(){"use strict";if(4===this.readyState&&200===this.status){var e=[],n=JSON.parse(this.response);Object.keys(n.result).forEach((function(a){if(!e.includes(a)&&n.result[a]>0){var o=t(i.href),u=i.parentElement.querySelector(".c-articleModule__meta");o===a&&null!==u&&(u.innerHTML+=s,e.push(a)),c.forEach((function(n){var o=t(n.href),i=n.parentElement.querySelector(".c-articleModule__meta");o===a&&null!==i&&(i.innerHTML+=s,e.push(a))})),r.forEach((function(n){var o=t(n.href),i=n.querySelectorAll("span")[1];o===a&&null!==i&&(i.innerHTML+=s,e.push(a))})),l.forEach((function(n){var o=t(n.href),i=n.parentElement.querySelector(".c-articleModule__txt");n.parentElement.classList.contains("c-articleModule")&&o===a&&null!==i&&(i.innerHTML+=s,e.push(a))})),m.forEach((function(n){var o=t(n.href),i=n.parentElement.querySelector(".c-articleModule__meta");if(o===a)if(null!==i)i.innerHTML+=s,e.push(a);else{var c=n.parentElement.querySelector(".c-articleModule__txt");null!==c&&(c.innerHTML+=s,e.push(a))}}))}}))}},d.send()}}}();