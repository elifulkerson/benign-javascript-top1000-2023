+function(){var e={_ui:{},init:function(){var e=this;if(e.view(),!e._ui.$loginModal.length)return!1;e.bindEvent(),e.fListenYpEvent()},view:function(){var e=this,i=e._ui;i.$loginModal=$("#js-login-normal-area"),i.$loginForm=i.$loginModal.find(".js-login-form"),i.$checkboxs=i.$loginForm.find(".js-checkbox")},bindEvent:function(){var e=this,i=e._ui;i.$loginForm.on("submit",function(o){o.preventDefault(),e.fFormSubmitBefore(i.$loginForm)}),i.$checkboxs.on("click",function(e){e.preventDefault();var i=$(this),o=!i.hasClass("checkboxed");i.closest(".label-row").find(".js-checkbox-hidden").prop("checked",o),i.toggleClass("checkboxed",o)});var o="input";window.ie678&&(o="propertychange"),i.$loginModal.find(".js-input").on(o,function(){var e=$(this);""==e.val()?e.closest(".js-input-row").find(".input-labels").fadeIn():e.closest(".js-input-row").find(".input-labels").fadeOut()}).on("blur",function(){var e=$(this);""==e.val()&&e.closest(".js-input-row").find(".input-labels").fadeIn()}).on("focus",function(i){e.fValidSuccess($(this))}),i.$loginModal.find(".input-labels").on("click",function(e){e.preventDefault(),$(this).closest(".js-input-row").find(".js-input").focus()})},fListenYpEvent:function(){var e=this;e._ui;yp.sub("page/login/normal",function(i,o){e.showModal()}),yp.sub("page/regist",function(){e.hideModal()})},getUname:function(){return yp.localStorage.getItem("login-uname")||""},setUname:function(e){yp.localStorage.setItem("login-uname",e)},showModal:function(){var e=this,i=e._ui;yp.use("geetest",function(e,i){i.init("login")}),this.hideLoading(),i.$loginForm[0].reset(),yp.each(i.$loginForm.find(".js-input-row"),function(i){e.fValidSuccess($(i)),$(i).find(".input-labels").show()});var o=yp.login.getUname(),n=o?1:0,t=i.$loginModal.find('[data-valid="uname"]');t.val(o),o&&t.closest(".js-input-row").find(".input-labels").hide(),1==n?i.$loginModal.find('[name="password"]').focus():t.focus()},hideModal:function(){var e=this;e._ui;e.clearForm()},clearForm:function(){this._ui.$loginModal.find(".js-input").val("")},showLoading:function(e){var i=this,o=i._ui,n=["登录中","登录中..","登录中...","登录中."];o.$loginForm.data("loading",!0).find(".js-pop-login-btn").html(e?n[e]:"登录中")},hideLoading:function(){var e=this,i=e._ui,o=i.$loginForm.data("loading",!1).find(".js-pop-login-btn");o.html(o.data("login")||"登&nbsp;录")},loginTimeout:8e3,fFormSubmitCheck:function(e,i){var o,n,t=this,a=!0,s={uname:t.fCheckAccount,password:t.fCheckPassword};return yp.each(e.find("[data-valid]"),function(e){n=$(e),o=s[n.data("valid")].call(t,n.val()),o.isok?i&&t.fValidSuccess(n):(a=!1,i&&t.fValidError(n,o.message))}),!!a},fFormSubmitDo:function(e){var i=this,o=i._ui;e.data("ajaxing",!0).ajaxSubmit({timeout:i.loginTimeout}).ajax.done(function(e){if(0==e.code){i.loginTimeout=8e3;var n=o.$loginModal.find('.js-input[data-valid="uname"]').val();yp.login.setUname(n),oPageConfig.oLoginInfo=e.data,yp.pub("page/login/done",oPageConfig.oLoginInfo)}else 11001==e.code?alert('<div class="ibox-msg">                    <div class="info">                      <div class="no-something-list">                        <i class="qn-logo dv"></i>                        <span class="text dv">您的账号存在异常暂时无法登录，若有疑问请 <a href="javascript:;" class="js-open-kefu">联系客服</a>。</span>                      </div>                    </div>                  </div>',"","",{width:500}):102==e.code?alert(e.message):e.message&&yp.errorNotify(e.message);e.code&&setTimeout(function(){yp.pub("page/geet3.0/reset")},0)}).fail(function(e,o,n){yp.pub("page/geet3.0/reset"),"timeout"==o&&(alert("登录超时，请稍后再试"),i.loginTimeout=15e3)}).always(function(){i.hideLoading(),e.data("ajaxing",!1)})},fFormSubmitBefore:function(e){var i=this,o=i._ui;if(!i.fFormSubmitCheck(e,!0)||e.data("ajaxing")||e.data("loading"))return!1;i.showLoading(3),e.find(".js-geetest-form").length&&e.find(".js-geetest-form").remove();var n=e.serializeArray();e.data("ajaxing",!0),yp.ajax("/api/auth/user.prelogin",{type:"post",data:n,dataType:"json"}).always(function(){i.hideLoading(),e.data("ajaxing",!1)}).done(function(n){if(0==n.code){i.loginTimeout=8e3;var t=o.$loginModal.find('.js-input[data-valid="uname"]').val();yp.login.setUname(t),oPageConfig.oLoginInfo=n.data,yp.pub("page/login/done",oPageConfig.oLoginInfo)}else 101==n.code?i.fFormSubmit(e):11001==n.code?alert('<div class="ibox-msg">                  <div class="info">                    <div class="no-something-list">                      <i class="qn-logo dv"></i>                      <span class="text dv">您的账号存在异常暂时无法登录，若有疑问请 <a href="javascript:;" class="js-open-kefu">联系客服</a>。</span>                    </div>                  </div>                </div>',"","",{width:500}):102==n.code?alert(n.message):n.message&&yp.errorNotify(n.message)}).fail(function(e,o,n){"timeout"==o&&(alert("登录超时，请稍后再试"),i.loginTimeout=15e3)})},fFormSubmit:function(e){var i=this,o=i._ui;if(!i.fFormSubmitCheck(e,!0)||e.data("ajaxing")||e.data("loading"))return!1;i.showLoading(1),yp.pub("page/geetest/show",{self:i,type:"login",fun:function(e,n){if("login"!=n)return i.hideLoading(),!1;i.showLoading(2),o.$loginForm.find(".js-geetest-form").length&&o.$loginForm.find(".js-geetest-form").remove();var t='<div class="geetest_form js-geetest-form" style="display:none;">                <input type="hidden" value="'+e.geetest_challenge+'" name="geetest_challenge">                <input type="hidden" value="'+e.geetest_validate+'" name="geetest_validate">                <input type="hidden" value="'+e.geetest_seccode+'" name="geetest_seccode">            </div>';o.$loginForm.append(t),i.fFormSubmitDo(o.$loginForm)},remove:function(e){!e&&i.hideLoading()}})},fCheckAccount:function(e){var i={isok:!0,message:""};return""==e&&(i.isok=!1,i.message="请输入您的账号/手机号码"),i},fCheckPassword:function(e){var i={isok:!0,message:""};return""==e&&(i.isok=!1,i.message="请输入您的登录密码"),i},fValidSuccess:function(e){var i=this,o=i._ui,n=e.closest(".js-input-row");n.removeClass("error"),n.data("errorid")&&(o.$loginModal.find("#error-"+n.data("errorid")).remove(),n.data("errorid",0))},fValidError:function(e,i){var o=this;if(e){var n=e.closest(".js-input-row");n.hasClass("error")&&o.fValidSuccess(e),n.addClass("error");var t=$.now(),a='<p class="error-title" id="error-'+t+'">'+i+"</p>";n.data("errorid",t).append(a)}}};define("oNormalLogin",[],function(){return e})}(),function(){var e={_ui:{},init:function(){if(this.view(),!this._ui.$qrcode_login_area.length)return!1;this.bindEvent(),this.listenYpEvent()},view:function(){this._ui.$qrcode_login_area=$("#js-qrcode-login-area")},bindEvent:function(){var e=this;e._ui.$qrcode_login_area.find(".js-qrcode-flash-btn").on("click",function(i){i.preventDefault(),1==$(this).data("errorType")?window.location.reload():e.fShowModal()})},bLogouted:!1,listenYpEvent:function(){var e=this,i=e._ui;yp.sub("page/login/qrcode",function(o,n){if(e.bLogouted)return e.fShowQrcodeError("二维码获取失败",1),i.$qrcode_login_area.find(".js-qrcode-img-layer").html(""),e.fClearQrcodeCD(!0),!1;!e.fQrcodeBeLoaded&&e.fShowModal()}),yp.sub("page/regist",function(){e.fHideModal()}),yp.sub("ws/qrcode.login.pc",function(i,o){e.fClearQrcodeCD(!1),e.fShowQrCode(o.data)}),yp.sub("ws/qrcode.login.notify",function(i,o){e.fQrcodeSubmit(o)}),yp.sub("page/logout/done",function(){e.bLogouted=!0}),yp.sub("ws/qrcode.login.reget",function(i,o){e.fClearQrcodeCD(!1),e.fShowQrCode(o.data)}),yp.sub("ws/close",function(){e.fShowQrcodeError("二维码已失效"),e.fClearQrcodeCD(!1)})},fQrcodeBeLoaded:!1,fShowModal:function(){var e=this,i=e._ui;e.fQrcodeBeLoaded=!0,i.$qrcode_login_area.find(".js-qrcode-img-layer").html('<i class="loading"></i>'),e.fHideQrcodeError(),e.fQrcodeLoadingCD(10),window.oWS?e.fWSInit():$.getScript(oPageConfig.oUrl.sUrlBase+"j/lib/websocket/ws.js",function(){e.fWSInit()})},fHideModal:function(){},fWSInit:function(){var e=this;e._ui;window.oWS&&oWS.regist("qrcodeLogin",function(e){!e&&oWS.fSendMsg("qrcode.login.pc",{data:$.cookie("PHPSESSID"),type:1,to:1})})},fWSClear:function(){window.oWS&&oWS.unregist("qrcodeLogin")},fShowQrCode:function(e){var i=this;i._ui.$qrcode_login_area.find(".js-qrcode-img-layer").html('<img class="img-wh" src="https://apis.zhanqi.tv/public/qrcode?'+e.qrcode+'" />'),i.fQrcodeCD(e.timeout)},qrcodeCD:0,fQrcodeCD:function(e){var i=this;i._ui;if(0>=e)return i.fShowQrcodeError("二维码已失效"),i.fClearQrcodeCD(!0),!1;i.qrcodeCD=setTimeout(function(){e--,i.fQrcodeCD(e)},1e3)},fShowQrcodeError:function(e,i){var o=this,n=o._ui;n.$qrcode_login_area.find(".js-qrcode-login-bd").addClass("login-past").find(".js-qrcode-error-txt").html(e);var t="请点击刷新";1==i&&(t="点击刷新页面"),n.$qrcode_login_area.find(".js-qrcode-flash-btn").html(t).data("errorType",i)},fHideQrcodeError:function(){this._ui.$qrcode_login_area.find(".js-qrcode-login-bd").removeClass("login-past")},fClearQrcodeCD:function(e){var i=this;i.qrcodeCD&&clearTimeout(i.qrcodeCD),e&&i.fWSClear()},fQrcodeLoadingCD:function(e){var i=this,o=i._ui;if(0>=e)return i.bLogouted?i.fShowQrcodeError("二维码获取失败",1):i.fShowQrcodeError("二维码获取失败"),o.$qrcode_login_area.find(".js-qrcode-img-layer").html(""),i.fClearQrcodeCD(!0),!1;i.qrcodeCD=setTimeout(function(){e--,i.fQrcodeLoadingCD(e)},1e3)},fQrcodeSubmit:function(e){var i=this;yp.ajax({url:"/api/auth/qrcode/login",type:"post",data:{token:e.token,timestamp:e.timestamp},dataType:"json"}).done(function(e){0==e.code?(i.fHideModal(),i.fQrcodeBeLoaded=!1,oPageConfig.oLoginInfo=e.data,yp.pub("page/login/done",e.data),mfTongji("qrcode_login","pc"),i.fClearQrcodeCD(!0)):yp.ajaxNotice(e)})}};define("oQrcodeLogin",[],function(){return e})}(),function(){var e={_ui:{},oDtd:{nicknameDtd:null},init:function(){var e=this;if(e.view(),!e._ui.$quickLoginModal.length)return!1;e.bindEvent(),e.listenYpPub()},view:function(){var e=this;e._ui;e._ui.$quickLoginModal=$("#js-quick-login-area"),e._ui.$inputs=e._ui.$quickLoginModal.find(".js-input"),e._ui.$input_labels=e._ui.$quickLoginModal.find(".input-labels"),e._ui.$checkboxs=e._ui.$quickLoginModal.find(".js-checkbox"),e._ui.$phoneLoginForm=e._ui.$quickLoginModal.find(".js-phone-login-form"),e._ui.$country_select=e._ui.$phoneLoginForm.find(".js-select-panel"),e._ui.$login_phone=e._ui.$phoneLoginForm.find(".js-login-phone"),e._ui.$login_phone_code_btn=e._ui.$phoneLoginForm.find(".js-login-phone-code-btn"),e._ui.$phoneRegistForm=e._ui.$quickLoginModal.find(".js-phone-regist-form"),window.pageTag&&("lives_room"==window.pageTag?e._ui.$phoneRegistForm.append('<input type="hidden" name="scope" value="1" /><input type="hidden" name="detail" value="'+oPageConfig.oRoom.id+'" />'):-1==window.pageTag.indexOf("topic_")&&"topic"!=window.pageTag||e._ui.$phoneRegistForm.append('<input type="hidden" name="scope" value="2" /><input type="hidden" name="detail" value="'+window.location.pathname+'" />'))},bindEvent:function(){var e=this;e._ui;e._ui.$phoneLoginForm.on("submit",function(i){i.preventDefault(),e.fPhoneLoginSubmit()}),e._ui.$phoneRegistForm.on("submit",function(i){i.preventDefault(),e.fPhoneRegistSubmit()}),e._ui.$checkboxs.on("click",function(e){e.preventDefault();var i=$(this),o=!i.hasClass("checkboxed");i.closest(".label-row").find(".js-checkbox-hidden").prop("checked",o),i.toggleClass("checkboxed",o)});var i={password:e.fPswCheck,nickname:e.fNicknameCheck,phone:e.fPhoneCheck,phonecode:e.fPhoneCodeCheck},o="input";window.ie678&&(o="propertychange"),e._ui.$inputs.on("change",function(){$(this).data("isok",!1);var o=$(this),n=i[o.data("type")].call(e,o);e.fDealCheckResult(o,n.message,n.isok)}).on("blur",function(){var i=$(this);""==i.val()&&(i.closest(".js-input-row").find(".input-labels").fadeIn(),"password"==i.data("type")&&e.fDealCheckResult(i,"设置密码后，可以通过手机号和密码进行登录",!1))}).on(o,function(){var i=$(this);""==i.val()?i.closest(".js-input-row").find(".input-labels").fadeIn():i.closest(".js-input-row").find(".input-labels").fadeOut(),e.fDealCheckResult(i,"password"==i.data("type")?"设置密码后，可以通过手机号和密码进行登录":"",!0)}).on("focus",function(i){var o=$(this);""==o.val()&&e.fDealCheckResult(o,"password"==o.data("type")?"设置密码后，可以通过手机号和密码进行登录":"",!0)}),e._ui.$input_labels.on("click",function(e){e.preventDefault(),$(this).closest(".js-input-row").find(".js-input").focus()}),e._ui.$country_select.zqSelect({inputName:"countryCode",bShowVal:!0}),e._ui.$login_phone_code_btn.on("click",function(i){i.preventDefault(),e.fGetPhoneCode()})},listenYpPub:function(){var e=this;yp.sub("page/regist",function(){e.hideModal()}),yp.sub("page/login/phone",function(i,o){e.showModal()})},showModal:function(){var e=this;yp.use("geetest",function(e,i){i.init("phoneQuickLogin")}),e._ui.$phoneLoginForm.show(),e._ui.$phoneRegistForm.hide(),e._ui.$phoneLoginForm[0].reset(),e._ui.$phoneRegistForm[0].reset(),yp.each(e._ui.$inputs,function(i){e.fDealCheckResult($(i),"",!0),$(i).closest(".js-input-row").find(".input-labels").show()}),e._ui.$country_select.trigger("selectReset"),e.fCodeTimeReset(e._ui.$login_phone_code_btn,"获取验证码"),e._ui.$phoneLoginForm.find('[data-type="phone"]').focus()},hideModal:function(){if(!this._ui.$quickLoginModal)return!1},fPhoneLoginSubmit:function(){var e=this,i=e._ui;if(i.$phoneLoginForm.data("ajaxing"))return!1;var o={phone:e.fPhoneCheck,phonecode:e.fPhoneCodeCheck},n=!0;if(i.$phoneLoginForm.find(".js-input").each(function(){$(this).data("isok",!1);var i=$(this),t=o[i.data("type")].call(e,i);e.fDealCheckResult(i,t.message,t.isok),t.isok||(n=!1)}),!n)return!1;var t=i.$phoneLoginForm.find('.js-input[data-type="phonecode"]').val(),a=i.$login_phone.val(),s="",l=i.$country_select.data("selectVal")();"+86"==l?s=a:(l=l.slice(1),s=l+"-"+a),i.$phoneLoginForm.data("ajaxing",!0),yp.ajax({url:"/api/auth/user.login",type:"post",data:{type:1,code:t,account:s},dataType:"json"}).done(function(i){0==i.code?(e.hideModal(),oPageConfig.oLoginInfo=i.data,yp.pub("page/login/done",i.data),mfTongji("phone_quick_login","pc")):11002==i.code?(mfTongji("phone_quick_login_first","pc"),e.fShowRegist()):102==i.code?alert(i.message):i.message&&yp.errorNotify(i.message)}).always(function(){i.$phoneLoginForm.data("ajaxing",!1)})},fShowRegist:function(){var e=this,i=e._ui;e._ui.$phoneLoginForm.hide(),e._ui.$phoneRegistForm.show(),e._ui.$phoneRegistForm.find(".js-phone-hide-input").val(i.$login_phone.val()),e._ui.$phoneRegistForm.find(".js-country-code-hide-input").val(i.$country_select.data("selectVal")()),e._ui.$phoneRegistForm.find(".js-phone-code-hide-input").val(i.$phoneLoginForm.find('.js-input[data-type="phonecode"]').val()),e._ui.$phoneRegistForm.find('[data-type="nickname"]').focus(),e.fDealCheckResult(e._ui.$phoneRegistForm.find('[data-type="password"]'),"设置密码后，可以通过手机号和密码进行登录",!0)},fPhoneRegistSubmit:function(){var e=this;e._ui;if(e._ui.$phoneRegistForm.data("ajaxing"))return!1;var i={password:e.fPswCheck,nickname:e.fNicknameCheck},o=!0;if(e._ui.$phoneRegistForm.find(".js-input").each(function(){$(this).data("isok",!1);var n=$(this),t=i[n.data("type")].call(e,n);e.fDealCheckResult(n,t.message,t.isok),t.isok||(o=!1)}),!o)return!1;$.when(e.oDtd.nicknameDtd).done(function(){if(e._ui.$phoneRegistForm.find(".js-input").each(function(){$(this).data("isok")||(o=!1)}),e._ui.$phoneRegistForm.data("ajaxing")||!o)return!1;e._ui.$phoneRegistForm.data("ajaxing",!0).ajaxSubmit().ajax.done(function(i){0==i.code?(e.hideModal(),oPageConfig.oLoginInfo=i.data,yp.pub("page/regist/done",i.data),mfTongji("phone_quick_login_first_regist","pc")):i.message&&yp.errorNotify(i.message)}).always(function(){e._ui.$phoneRegistForm.data("ajaxing",!1)})}).always(function(){"rejected"==e.oDtd.nicknameDtd.state()&&(e.oDtd.nicknameDtd=null)})},fDealCheckResult:function(e,i,o){var n=this;n._ui;if(e.data("isok",o),i){e.closest(".js-input-row").addClass("error");var t=$.now(),a='<p class="error-title" id="error-'+t+'">'+i+"</p>";e.data("errorid")&&n._ui.$quickLoginModal.find("#error-"+e.data("errorid")).remove(),e.data("errorid",t).closest(".js-input-row").append(a)}else e.closest(".js-input-row").removeClass("error"),e.data("errorid")&&(n._ui.$quickLoginModal.find("#error-"+e.data("errorid")).remove(),e.data("errorid",0))},fNicknameCheck:function(e){var i=this,o=e.val(),n=0,t={isok:!1,message:""};return n=i.fGetStrLen(o),i.oDtd.nicknameDtd=$.Deferred(),""==o?(t.message="看官老爷，请填写昵称。",i.oDtd.nicknameDtd.reject()):6>n||24<n?(t.message="昵称需6-24位中英文字符。",i.oDtd.nicknameDtd.reject()):(t.isok=!0,yp.ajax(yp.format(oPageConfig.oUrl.sUrlValidate,{type:"nickname"}),{data:{nickname:o},type:"post",dataType:"json"}).done(function(o){0==o.code?(i.oDtd.nicknameDtd.resolve(),i.fDealCheckResult(e,"",!0)):(i.oDtd.nicknameDtd.reject(),i.fDealCheckResult(e,o.message,!1))}).fail(function(){i.fDealCheckResult(e,"",!0),i.oDtd.nicknameDtd.resolve()})),t},fPswCheck:function(e){var i=/^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])[A-Za-z0-9]{8,20}$/,o=e.val(),n={isok:!1,message:"设置密码后，可以通过手机号和密码进行登录"};return""==o?n.message="设置密码后，可以通过手机号和密码进行登录":i.test(o)?n.isok=!0:n.message="密码格式为8～20位大小写字母和数字组合",n},fPhoneCheck:function(e){var i=this,o=e.val(),n={isok:!1,message:""},t=i._ui;return""==o?n.message="看官老爷，请留下您的账号哦！":86==+t.$country_select.data("selectVal")()&&11!=o.length?n.message="请输入正确的手机号":n.isok=!0,n},fPhoneCodeCheck:function(e){var i=e.val(),o={isok:!1,message:""};return""==i?o.message="看官老爷，请填写手机验证码！":o.isok=!0,o},fGetPhoneCode:function(){var e=this,i=e._ui;return""==i.$login_phone.val()?(e.fDealCheckResult(i.$login_phone,"请填写手机号",!1),!1):!i.$login_phone_code_btn.data("timing")&&!i.$login_phone_code_btn.hasClass("disable")&&(e.fShowLoading(),void yp.pub("page/geetest/show",{self:e,type:"phoneQuickLogin",fun:function(i,o){"phoneQuickLogin"==o&&e.fDoGetPhoneCode(i)},remove:function(o){!o&&e.fCodeTimeReset(i.$login_phone_code_btn,"重新获取")}}))},fDoGetPhoneCode:function(e){var i=this,o=i._ui;o.$login_phone_code_btn.data("timing",!0),i.fCodeTimeCutdown(o.$login_phone_code_btn,60),yp.ajax(oPageConfig.oUrl.sRegistPhoneCode+"?geetest_ver=3.0&os=0&platform=1",{type:"post",dataType:"json",data:{mobile:o.$login_phone.val(),countryCode:o.$country_select.data("selectVal")(),geetest_challenge:e.geetest_challenge,geetest_validate:e.geetest_validate,geetest_seccode:e.geetest_seccode,type:1}}).done(function(e){0==e.code?i.fDealCheckResult(o.$login_phone,"",!0):(yp.pub("page/geet3.0/reset"),i.fDealCheckResult(i._ui.$phoneLoginForm.find(".js-login-phone"),e.message,!1),i.fCodeTimeReset(o.$login_phone_code_btn,"重新获取"))}).fail(function(){yp.pub("page/geet3.0/reset"),i.fCodeTimeReset(o.$login_phone_code_btn,"重新获取")})},fShowLoading:function(){this._ui.$login_phone_code_btn.addClass("disable").html("获取中...")},fCodeTimeCutdown:function(e,i){var o=this,n=0;e.data("timeout")&&clearTimeout(e.data("timeout")),i?(e.addClass("disable").html("发送中("+i+")"),n=setTimeout(function(){i--,o.fCodeTimeCutdown(e,i)},1e3),e.data("timeout",n)):o.fCodeTimeReset(e,"重新获取")},fCodeTimeReset:function(e,i){var o=this;o._ui;e.removeClass("disable").data("timing",!1),e.data("timeout")&&clearTimeout(e.data("timeout")),e.html(i)},fGetStrLen:function(e){for(var i=0,o=e.split(""),n=0;n<o.length;n++)o[n].charCodeAt(0)<299?i++:i+=3;return i}};define("oPhoneQuickLogin",[],function(){return e})}(),function(){var e={_ui:{},oDtd:{nicknameDtd:null},init:function(){var e=this;if(e.view(),!e._ui.$registModal.length)return!1;e.bindEvent(),e.listenYpPub()},view:function(){var e=this;e._ui;e._ui.$registModal=$("#js-regist-area"),e._ui.$inputs=e._ui.$registModal.find(".js-input"),e._ui.$input_labels=e._ui.$registModal.find(".input-labels"),e._ui.$checkboxs=e._ui.$registModal.find(".js-checkbox"),e._ui.$phoneRegistForm=e._ui.$registModal.find(".js-phone-form"),e._ui.$country_select=e._ui.$phoneRegistForm.find(".js-select-panel"),e._ui.$regist_phone=e._ui.$phoneRegistForm.find(".js-regist-phone"),e._ui.$regist_phone_code_btn=e._ui.$phoneRegistForm.find(".js-regist-phone-code-btn"),window.pageTag&&("lives_room"==window.pageTag?e._ui.$phoneRegistForm.append('<input type="hidden" name="scope" value="1" /><input type="hidden" name="detail" value="'+oPageConfig.oRoom.id+'" />'):-1==window.pageTag.indexOf("topic_")&&"topic"!=window.pageTag||e._ui.$phoneRegistForm.append('<input type="hidden" name="scope" value="2" /><input type="hidden" name="detail" value="'+window.location.pathname+'" />'))},bindEvent:function(){var e=this;e._ui;e._ui.$phoneRegistForm.on("submit",function(i){i.preventDefault(),e.fPhoneFormSubmit()}),e._ui.$checkboxs.on("click",function(e){e.preventDefault();var i=$(this),o=!i.hasClass("checkboxed");i.closest(".label-row").find(".js-checkbox-hidden").prop("checked",o),i.toggleClass("checkboxed",o)});var i={password:e.fPswCheck,nickname:e.fNicknameCheck,phone:e.fPhoneCheck,phonecode:e.fPhoneCodeCheck},o="input";window.ie678&&(o="propertychange"),e._ui.$inputs.on("change",function(){$(this).data("isok",!1);var o=$(this),n=i[o.data("type")].call(e,o);e.fDealCheckResult(o,n.message,n.isok)}).on("blur",function(){var e=$(this);""==e.val()&&e.closest(".js-input-row").find(".input-labels").fadeIn()}).on(o,function(){var i=$(this);""==i.val()?i.closest(".js-input-row").find(".input-labels").fadeIn():i.closest(".js-input-row").find(".input-labels").fadeOut(),e.fDealCheckResult(i,"",!0)}).on("focus",function(i){""==$(this).val()&&e.fDealCheckResult($(this),"",!0)}),e._ui.$input_labels.on("click",function(e){e.preventDefault(),$(this).closest(".js-input-row").find(".js-input").focus()}),e._ui.$country_select.zqSelect({inputName:"countryCode",bShowVal:!0}),e._ui.$regist_phone_code_btn.on("click",function(i){i.preventDefault(),e.fGetPhoneCode()})},listenYpPub:function(){var e=this;yp.sub("page/login",function(){e.hideModal()}),yp.sub("page/regist/phone",function(i,o){e.showModal()})},showModal:function(){var e=this;e._ui;yp.use("geetest",function(e,i){i.init("phoneRegist")}),e._ui.$phoneRegistForm[0].reset(),yp.each(e._ui.$inputs,function(i){e.fDealCheckResult($(i),"",!0),$(i).closest(".js-input-row").find(".input-labels").show()}),e._ui.$country_select.trigger("selectReset"),e.fCodeTimeReset(e._ui.$regist_phone_code_btn,"获取验证码"),e._ui.$checkboxs.removeClass("checkboxed"),e._ui.$phoneRegistForm.find('[data-type="phone"]').focus()},hideModal:function(){var e=this;e._ui;if(!e._ui.$registModal)return!1;e._ui.$phoneRegistForm.find(".js-input-extra-action").remove()},fPhoneFormSubmit:function(){var e=this;e._ui;if(e._ui.$phoneRegistForm.data("ajaxing"))return!1;var i={password:e.fPswCheck,nickname:e.fNicknameCheck,phone:e.fPhoneCheck,phonecode:e.fPhoneCodeCheck},o=!0;return e._ui.$phoneRegistForm.find(".js-input").each(function(){$(this).data("isok",!1);var n=$(this),t=i[n.data("type")].call(e,n);e.fDealCheckResult(n,t.message,t.isok),t.isok||(o=!1)}),!!o&&(e._ui.$phoneRegistForm.find(".terms-service-input").prop("checked")?void $.when(e.oDtd.nicknameDtd).done(function(){if(e._ui.$phoneRegistForm.find(".js-input").each(function(){$(this).data("isok")||(o=!1)}),e._ui.$phoneRegistForm.data("ajaxing")||!o)return!1;$.cookie("bf_ref_url")&&e._ui.$phoneRegistForm.append('<input class="js-input-extra-action" type="hidden" name="bf_ref_url" value="'+$.cookie("bf_ref_url")+'" />'),e._ui.$phoneRegistForm.data("ajaxing",!0).ajaxSubmit().ajax.done(function(i){0==i.code?(e.hideModal(),oPageConfig.oLoginInfo=i.data,yp.pub("page/regist/done",i.data)):i.message&&yp.errorNotify(i.message)}).always(function(){e._ui.$phoneRegistForm.data("ajaxing",!1)}).fail(function(e,i,o){"timeout"==i&&alert("注册超时，请稍后再试")})}).always(function(){"rejected"==e.oDtd.nicknameDtd.state()&&(e.oDtd.nicknameDtd=null)}):(yp.errorNotify("客官，您还未同意服务条款"),!1))},fDealCheckResult:function(e,i,o){var n=this;n._ui;if(e.data("isok",o),o)e.closest(".js-input-row").removeClass("error"),e.data("errorid")&&(n._ui.$registModal.find("#error-"+e.data("errorid")).remove(),e.data("errorid",0));else{e.closest(".js-input-row").addClass("error");var t=$.now(),a='<p class="error-title" id="error-'+t+'">'+i+"</p>";e.data("errorid")&&n._ui.$registModal.find("#error-"+e.data("errorid")).remove(),e.data("errorid",t).closest(".js-input-row").append(a)}},fNicknameCheck:function(e){var i=this,o=e.val(),n=0,t={isok:!1,message:""};return n=i.fGetStrLen(o),i.oDtd.nicknameDtd=$.Deferred(),""==o?(t.message="看官老爷，请填写昵称。",i.oDtd.nicknameDtd.reject()):6>n||24<n?(t.message="昵称需6-24位中英文字符。",i.oDtd.nicknameDtd.reject()):(t.isok=!0,yp.ajax(yp.format(oPageConfig.oUrl.sUrlValidate,{type:"nickname"}),{data:{nickname:o},type:"post",dataType:"json"}).done(function(o){0==o.code?(i.oDtd.nicknameDtd.resolve(),i.fDealCheckResult(e,"",!0)):(i.oDtd.nicknameDtd.reject(),i.fDealCheckResult(e,o.message,!1))}).fail(function(){i.fDealCheckResult(e,"",!0),i.oDtd.nicknameDtd.resolve()})),t},fPswCheck:function(e){var i=/^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])[A-Za-z0-9]{8,20}$/,o=e.val(),n={isok:!1,message:""};return""==o?n.message="看官老爷，请填写密码。":i.test(o)?n.isok=!0:n.message="密码格式为8～20位大小写字母和数字组合",n},fPhoneCheck:function(e){var i=this,o=e.val(),n={isok:!1,message:""},t=i._ui;return""==o?n.message="看官老爷，请留下您的账号哦！":86==+t.$country_select.data("selectVal")()&&11!=o.length?n.message="请输入正确的手机号":n.isok=!0,n},fPhoneCodeCheck:function(e){var i=e.val(),o={isok:!1,message:""};return""==i?o.message="看官老爷，请填写手机验证码！":o.isok=!0,o},fGetPhoneCode:function(){var e=this,i=e._ui;return""==i.$regist_phone.val()?(e.fDealCheckResult(i.$regist_phone,"请填写手机号",!1),!1):!i.$regist_phone_code_btn.data("timing")&&!i.$regist_phone_code_btn.hasClass("disable")&&(e.fShowLoading(),void yp.pub("page/geetest/show",{self:e,type:"phoneRegist",fun:function(i,o){"phoneRegist"==o&&e.fDoGetPhoneCode(i)},remove:function(o){!o&&e.fCodeTimeReset(i.$regist_phone_code_btn)}}))},fDoGetPhoneCode:function(e){var i=this,o=i._ui;o.$regist_phone_code_btn.data("timing",!0),i.fCodeTimeCutdown(o.$regist_phone_code_btn,60),yp.ajax(oPageConfig.oUrl.sRegistPhoneCode+"?geetest_ver=3.0&os=0&platform=1",{type:"post",dataType:"json",data:{mobile:o.$regist_phone.val(),countryCode:o.$country_select.data("selectVal")(),geetest_challenge:e.geetest_challenge,geetest_validate:e.geetest_validate,geetest_seccode:e.geetest_seccode}}).done(function(e){0==e.code?i.fDealCheckResult(o.$regist_phone,"",!0):(yp.pub("page/geet3.0/reset"),10001==e.code?i.fDealCheckResult(i._ui.$phoneRegistForm.find('[name="mobile"]'),'该手机已注册或已绑定，<br />您可以使用该手机号码<a href="javascript:;" class="js-go-login">直接登录</a>',!1):i.fDealCheckResult(i._ui.$phoneRegistForm.find('[name="mobile"]'),e.message,!1),i.fCodeTimeReset(o.$regist_phone_code_btn,"重新获取"))}).fail(function(){yp.pub("page/geet3.0/reset"),i.fCodeTimeReset(o.$regist_phone_code_btn,"重新获取")})},fShowLoading:function(){this._ui.$regist_phone_code_btn.addClass("disable").html("获取中...")},fCodeTimeCutdown:function(e,i){var o=this,n=0;e.data("timeout")&&clearTimeout(e.data("timeout")),i?(e.addClass("disable").html("发送中("+i+")"),n=setTimeout(function(){i--,o.fCodeTimeCutdown(e,i)},1e3),e.data("timeout",n)):o.fCodeTimeReset(e,"重新获取")},fCodeTimeReset:function(e,i){var o=this;o._ui;e.data("timing",!1),e.data("timeout")&&clearTimeout(e.data("timeout")),e.removeClass("disable").html(i)},fGetStrLen:function(e){for(var i=0,o=e.split(""),n=0;n<o.length;n++)o[n].charCodeAt(0)<299?i++:i+=3;return i}};define("oPhoneRegist",[],function(){return e})}(),function(){define("loginRegistModule",["oNormalLogin","oPhoneRegist","oQrcodeLogin","oPhoneQuickLogin"],function(e,i,o,n){return{init:function(){e.init(),i.init(),o.init(),n.init()},fRenderThirdLogin:function(e){var i="";window.pageType&&"login"==window.pageType?(i=getQueryString("redirect"),i=i?i=decodeURIComponent(i):oPageConfig.oUrl.sUrlHost):i=window.location.href,i="&redirect="+i,window.pageTag&&("lives_room"==window.pageTag?i+="&scope=1&detail="+oPageConfig.oRoom.id:-1==window.pageTag.indexOf("topic_")&&"topic"!=window.pageTag||(i+="&scope=2&detail="+window.location.pathname)),e.html('<ul class="clearfix">              <li class="qq">                <a href="/api/auth/user.other_login?type=qq'+i+'" onclick="mfTongji(\'sign_threeentry\', \'qq\')">                  <i class="icon"></i>                  <i class="bg"></i>                </a>              </li>              <li class="wx">                <a href="/api/auth/user.other_login?type=wx'+i+'" onclick="mfTongji(\'sign_threeentry\', \'wx\')">                  <i class="icon"></i>                  <i class="bg"></i>                </a>              </li>              <li class="wb">                <a href="/api/auth/user.other_login?type=wb'+i+'" onclick="mfTongji(\'sign_threeentry\', \'wb\')">                  <i class="icon"></i>                  <i class="bg"></i>                </a>              </li>              <li class="tb">                <a href="/api/auth/user.other_login?type=bd'+i+'" onclick="mfTongji(\'sign_threeentry\', \'bd\')">                  <i class="icon"></i>                  <i class="bg"></i>                </a>              </li>            </ul>')}}})}(),yp.use("loginRegistModule",function(e,i){e.ready(function(){({_ui:{},bAppend:!1,oAfterLoginRegist:null,init:function(){this.view(),this.listenYpEvent()},view:function(){
this._ui.$login_regist_panel=$('<div style="display:none;">            <div class="mask js-mask" style="z-index:100;"></div>            <div class="new-logins-ibox" style="z-index:101;">              <a href="javascript:;" class="close js-close"></a>              <div class="logins-area-content js-block-area" id="js-login-normal-area" data-type="normalLogin" style="display:none;">                <a href="javascript:;" class="transformation-btn js-go-login-qrcode">                  <div class="two-code-area">                    <img src="'+oPageConfig.oUrl.sUrlBase+'i/index/logins/code.png?v=20190429" alt="">                  </div>                </a>                <div class="login-area-hd clearfix">                  <a href="javascript:;" class="login-nav active">账号登录</a>                  <a href="javascript:;" class="login-nav js-go-login-phone">免密登录</a>                </div>                <div class="accounts-login">                  <div class="bd">                    <form action="/api/auth/user.login?geetest_ver=3.0&os=0&platform=1" autocomplete="off" class="js-login-form">                      <div class="row clearfix js-input-row">                        <div class="row-left">                          <i class="accounts-icon"></i>                        </div>                        <div class="row-right">                          <label class="label input-labels">账号/手机号</label>                          <input type="text" name="account" class="input js-input" data-valid="uname" />                        </div>                      </div>                      <div class="row clearfix js-input-row">                        <div class="row-left">                          <i class="password-icon"></i>                        </div>                        <div class="row-right">                          <label class="label input-labels">密码</label>                          <input type="password" name="password" class="input js-input" data-valid="password" />                        </div>                      </div>                      <div class="label-row clearfix">                        <a target="_blank" href="/user/findpwd" class="fr" onclick="mfTongji(\'sign_accountlogin_forgetpassword\', \'pc\')">忘记密码</a>                        <i class="checkbox checkboxed js-checkbox dv"></i>                        <input type="checkbox" checked="checked" class="js-checkbox-hidden" style="display:none;" />                        <span class="dv">一个月内免登录</span>                      </div>                      <div class="btn-area">                        <button type="submit" class="news-login-btn js-pop-login-btn">登&nbsp;录</button>                      </div>                    </form>                    <div class="third-login clearfix">                      <a href="javascript:;" class="fr js-go-regist">注册</a>                      <span class="fl">第三方登录</span>                      <div class="third-area js-third-login-area"></div>                    </div>                  </div>                </div>              </div>              <div class="js-block-area" id="js-quick-login-area" data-type="phoneLogin" style="display:none;">                <form class="js-phone-login-form">                  <div class="logins-area-content">                    <a href="javascript:;" class="transformation-btn  js-go-login-qrcode">                      <div class="two-code-area">                        <img src="'+oPageConfig.oUrl.sUrlBase+'i/index/logins/code.png?v=20180803" alt="">                      </div>                    </a>                    <div class="login-area-hd clearfix">                      <a href="javascript:;" class="login-nav js-go-login-normal">账号登录</a>                      <a href="javascript:;" class="login-nav active">免密登录</a>                    </div>                    <div class="mobile-login">                      <div class="bd">                        <div class="js-input-row row row-mobile clearfix">                          <div class="row-left">                            <i class="mobile-icon"></i>                          </div>                          <div class="row-right">                            <div class="select js-select-panel">                              <select>                                <option value="+86">中国大陆</option>                                <option value="+852">香港</option>                                <option value="+853">澳门</option>                                <option value="+886">台湾</option>                                <option value="+61">澳大利亚(Australia)</option>                                <option value="+1">加拿大(Canada)</option>                                <option value="+33">法国(France)</option>                                <option value="+49">德国(Germany)</option>                                <option value="+39">意大利(Italy)</option>                                <option value="+81">日本(Japan)</option>                                <option value="+82">韩国(Korea)</option>                                <option value="+60">马来西亚(Malaysia)</option>                                <option value="+64">新西兰(New Zealand)</option>                                <option value="+31">荷兰(Netherlands)</option>                                <option value="+7">俄罗斯(Russia)</option>                                <option value="+65">新加坡(Singapore)</option>                                <option value="+66">泰国(Thailand)</option>                                <option value="+44">英国(UK)</option>                                <option value="+1">美国(USA)</option>                                <option value="+84">越南(Vietnam)</option>                                <option value="+351">葡萄牙(Portugal)</option>                                <option value="+62">印度尼西亚(Indonesia)</option>                              </select>                            </div>                            <label class="label input-labels">输入手机号码</label>                            <input type="text" class="input js-input js-login-phone" data-type="phone" />                          </div>                        </div>                        <div class="js-input-row row row-yzm clearfix">                          <div class="row-left">                            <label class="label input-labels">验证码</label>                            <input type="text" class="yzm-input js-input" data-type="phonecode" />                          </div>                          <div class="row-right">                            <a href="javascript:;" class="yzm-btn js-login-phone-code-btn">获取验证码</a>                          </div>                        </div>                        <div class="label-row clearfix">                          <i class="checkbox checkboxed js-checkbox dv"></i>                          <input type="checkbox" checked="checked" class="js-checkbox-hidden" style="display:none;" />                          <span class="dv">一个月内免登录</span>                        </div>                        <div class="btn-area">                          <button type="submit" class="news-login-btn">登&nbsp;录</button>                        </div>                        <div class="third-login clearfix">                          <a href="javascript:;" class="fr js-go-regist">注册</a>                          <span class="fl">第三方登录</span>                          <div class="third-area js-third-login-area"></div>                        </div>                      </div>                    </div>                  </div>                </form>                <form action="/api/auth/user.mobile_register?geetest_ver=3.0&os=0&platform=1" class="js-phone-regist-form" style="display:none;">                  <input type="hidden" name="mobile" class="js-phone-hide-input" />                  <input type="hidden" name="countryCode" class="js-country-code-hide-input" />                  <input type="hidden" name="code" class="js-phone-code-hide-input" />                  <div class="first-login">                    <div class="logins-hd">                      <span>首次登录设置</span>                    </div>                    <div class="bd">                      <div class="js-input-row row clearfix">                        <div class="row-left">                          <i class="name-icon"></i>                        </div>                        <div class="row-right">                          <label class="label input-labels">昵称</label>                          <input type="text" name="nickname" class="input js-input" data-type="nickname" />                        </div>                      </div>                      <div class="js-input-row row clearfix">                        <div class="row-left">                          <i class="password-icon"></i>                        </div>                        <div class="row-right">                          <label class="label input-labels">密码</label>                          <input type="password" name="password" class="input js-input" data-type="password" />                        </div>                      </div>                      <div class="btn-area">                        <button type="submit" class="news-login-btn">登&nbsp;录</button>                      </div>                      <div class="third-login clearfix"></div>                    </div>                  </div>                </form>              </div>              <div class="code-login js-block-area" id="js-qrcode-login-area" data-type="qrcodeLogin" style="display:none;">                <a href="javascript:;" class="transformation-btn  js-go-login-qrcode">                  <div class="two-pc-area">                    <img src="'+oPageConfig.oUrl.sUrlBase+'i/index/logins/pc.png?v=20190429" alt="">                  </div>                </a>                <div class="bd js-qrcode-login-bd clearfix">                  <div class="code-title">扫码登录</div>                  <div class="img-box">                    <div class="js-qrcode-img-layer"></div>                    <i class="sub-mask"></i>                    <p class="sub-title js-qrcode-error-txt"></p>                    <a href="javascript:;" class="code-btn js-qrcode-flash-btn">请点击刷新</a>                    <p class="code-tit">请使用<span class="color">战旗APP</span>扫码登录</p>                  </div>                  <div class="code-yd">                    <img src="'+oPageConfig.oUrl.sUrlBase+'i/index/logins/code-yd.png" alt="" class="img-wh">                    <p class="code-tit">扫描入口在<span class="color">“我的”</span>右上角</p>                  </div>                </div>              </div>              <div class="new-register js-block-area" id="js-regist-area" data-type="phoneRegist" style="display:none;">                <div class="logins-hd">                  <span>账号注册</span>                </div>                <div class="bd">                  <form action="/api/auth/user.mobile_register?geetest_ver=3.0&os=0&platform=1" class="js-phone-form">                    <div class="js-input-row row row-mobile clearfix">                      <div class="row-left">                        <i class="mobile-icon"></i>                      </div>                      <div class="row-right">                        <div class="select js-select-panel">                          <select>                            <option value="+86">中国大陆</option>                            <option value="+852">香港</option>                            <option value="+853">澳门</option>                            <option value="+886">台湾</option>                            <option value="+61">澳大利亚(Australia)</option>                            <option value="+1">加拿大(Canada)</option>                            <option value="+33">法国(France)</option>                            <option value="+49">德国(Germany)</option>                            <option value="+39">意大利(Italy)</option>                            <option value="+81">日本(Japan)</option>                            <option value="+82">韩国(Korea)</option>                            <option value="+60">马来西亚(Malaysia)</option>                            <option value="+64">新西兰(New Zealand)</option>                            <option value="+31">荷兰(Netherlands)</option>                            <option value="+7">俄罗斯(Russia)</option>                            <option value="+65">新加坡(Singapore)</option>                            <option value="+66">泰国(Thailand)</option>                            <option value="+44">英国(UK)</option>                            <option value="+1">美国(USA)</option>                            <option value="+84">越南(Vietnam)</option>                            <option value="+351">葡萄牙(Portugal)</option>                            <option value="+62">印度尼西亚(Indonesia)</option>                          </select>                        </div>                        <label class="label input-labels">输入手机号码</label>                        <input type="text" class="input js-input js-regist-phone" name="mobile" data-type="phone" />                      </div>                    </div>                    <div class="js-input-row row clearfix">                      <div class="row-left">                        <i class="name-icon"></i>                      </div>                      <div class="row-right">                        <label class="label input-labels">昵称</label>                        <input type="text" class="input js-input" name="nickname" data-type="nickname" />                      </div>                    </div>                    <div class="js-input-row row clearfix">                      <div class="row-left">                        <i class="password-icon"></i>                      </div>                      <div class="row-right">                        <label class="label input-labels">密码</label>                        <input type="password" class="input js-input" name="password" data-type="password" />                      </div>                    </div>                    <div class="js-input-row row row-yzm clearfix">                      <div class="row-left">                        <label class="label input-labels">验证码</label>                        <input type="text" class="yzm-input js-input" name="code" data-type="phonecode" />                      </div>                      <div class="row-right">                        <a href="javascript:;" class="yzm-btn js-regist-phone-code-btn">获取验证码</a>                      </div>                    </div>                    <div class="btn-area">                      <button type="submit" class="news-login-btn">注&nbsp;册&nbsp;并&nbsp;登&nbsp;录</button>                    </div>                    <div class="label-row clearfix">                      <div class="fr">                        <span>已有账号？</span><a class="js-go-login" href="javascript:;">马上登录</a>                      </div>                      <i class="checkbox dv js-checkbox"></i>                      <input type="checkbox" class="dv terms-service-input js-checkbox-hidden" style="display:none;" />                      <span class="dv">同意并接受<a href="/common/agreement.html" target="_blank">《用户协议》</a>和<a href="/common/privacy.html" target="_blank">《隐私政策》</a></span>                    </div>                  </form>                </div>              </div>            </div>          </div>')},bindEvent:function(){var e=this,i=e._ui;i.$login_regist_panel.on("click",".js-close",function(i){i.preventDefault(),e.fHidePanel()}),i.$login_regist_panel.on("click",".js-go-regist",function(i){mfTongji("sign_register","pc"),i.preventDefault(),e.curLoginType=e.curAreaType,e.fShowArea("phoneRegist")}),i.$login_regist_panel.on("click",".js-go-login",function(i){mfTongji("register_sign","pc"),i.preventDefault(),e.fShowArea(e.curLoginType)}),i.$login_regist_panel.on("click",".js-go-login-qrcode",function(o){mfTongji("sign_sweep_code","pc"),o.preventDefault(),i.$login_regist_panel.find('.js-block-area[data-type="qrcodeLogin"]').is(":visible")?e.fShowArea(e.curLoginType):(e.curLoginType=e.curAreaType,e.fShowArea("qrcodeLogin"))}),i.$login_regist_panel.on("click",".js-go-login-phone",function(i){mfTongji("sign_privacylogin","pc"),i.preventDefault(),e.fShowArea("phoneLogin")}),i.$login_regist_panel.on("click",".js-go-login-normal",function(i){mfTongji("sign_accountlogin","pc"),i.preventDefault(),e.fShowArea("normalLogin")})},listenYpEvent:function(){var i=this;i._ui;e.sub("page/login",function(e,o){if(oPageConfig.oLoginInfo)return!1;i.fShowPanel("normalLogin",o)}),e.sub("page/regist",function(e,o){if(oPageConfig.oLoginInfo)return!1;i.fShowPanel("phoneRegist",o)}),e.sub("page/logout",function(){confirm('<div class="exit-content"></div>',function(){i.logout()},"",{title:"退出提示",width:388})}),e.sub("page/login/done",function(){if(!i.bAppend)return!1;e.pub("page/loginRegist/after"),i.fHidePanel()}),e.sub("page/regist/done",function(){if(!i.bAppend)return!1;e.pub("page/loginRegist/after"),i.fHidePanel()}),e.sub("page/loginRegist/after",function(){if(!i.bAppend)return!1;i.oAfterLoginRegist&&(i.oAfterLoginRegist.callback&&i.oAfterLoginRegist.callback(),i.oAfterLoginRegist=null)})},fShowPanel:function(e,i){var o=this,n=o._ui;n.$login_regist_panel.show(),window.ie678&&n.$login_regist_panel.find(".js-mask").css({background:"#000",opacity:.5}),o.fShowArea(e),o.oAfterLoginRegist=i},fHidePanel:function(){this._ui.$login_regist_panel.hide()},curAreaType:"",curLoginType:"normalLogin",fShowArea:function(e){var o=this,n=o._ui;o.bAppend||($("body").append(n.$login_regist_panel),o.bAppend=!0,o.bindEvent(),i.fRenderThirdLogin(n.$login_regist_panel.find(".js-third-login-area")),i.init()),o.curAreaType&&n.$login_regist_panel.find('.js-block-area[data-type="'+o.curAreaType+'"]').hide(),n.$login_regist_panel.find('.js-block-area[data-type="'+e+'"]').show(),o.curAreaType=e,o.fPubEvent(e)},oPubEvent:{normalLogin:"page/login/normal",qrcodeLogin:"page/login/qrcode",phoneLogin:"page/login/phone",phoneRegist:"page/regist/phone"},fPubEvent:function(i){var o=this;e.pub(o.oPubEvent[i])},logouting:!1,logout:function(){var i=this;if(i.logouting)return!1;i.logouting=!0,e.ajax(oPageConfig.oUrl.sUrlLogout,{type:"post",dataType:"json"}).done(function(i){i.code||(oPageConfig.oLoginInfo=null,e.localStorage.setItem("liaokeLogin",""),e.pub("page/logout/done")),i.message&&e.notify(i.message,i.code)}).fail(function(e,i,o){"timeout"==i&&alert("退出超时，请稍后再试")}).always(function(){i.logouting=!1})}}).init()})},!0),define("j/public/4.0/popLoginRegistNew",function(){});