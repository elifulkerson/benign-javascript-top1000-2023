(function(a,d){"function"==typeof define&&define.amd?define(["jquery"],d):d(a.jQuery)})(this,function(a){var d=navigator.userAgent,k=/Edge/i.test(d),h=function(b){this.origHtmlMargin=parseFloat(a("html").css("margin-top"));this.options=a.extend({},a.smartbanner.defaults,b);b=navigator.standalone;this.options.force?this.type=this.options.force:null!==d.match(/Windows Phone/i)&&null!==d.match(/Edge|Touch/i)?this.type="windows":null!==d.match(/iPhone|iPod/i)||d.match(/iPad/)&&this.options.iOSUniversalApp?
null!==d.match(/Safari/i)&&(null!==d.match(/CriOS/i)||null!=d.match(/FxiOS/i)||6>window.Number(d.substr(d.indexOf("OS ")+3,3).replace("_",".")))&&(this.type="ios"):d.match(/\bSilk\/(.*\bMobile Safari\b)?/)||d.match(/\bKF\w/)||d.match("Kindle Fire")?this.type="kindle":null!==d.match(/Android/i)&&(this.type="android");if(this.type&&!b&&!this.getCookie("sb-closed")&&!this.getCookie("sb-installed")&&(this.scale="auto"==this.options.scale?a(window).width()/window.screen.width:this.options.scale,1>this.scale&&
(this.scale=1),b=a("android"==this.type?'meta[name="google-play-app"]':"ios"==this.type?'meta[name="apple-itunes-app"]':"kindle"==this.type?'meta[name="kindle-fire-app"]':'meta[name="msApplication-ID"]'),b.length)){if("windows"==this.type)k&&(this.appId=a('meta[name="msApplication-PackageEdgeName"]').attr("content")),this.appId||(this.appId=a('meta[name="msApplication-PackageFamilyName"]').attr("content"));else{var c=/app-id=([^\s,]+)/.exec(b.attr("content"));if(c)this.appId=c[1];else return}this.title=
this.options.title?this.options.title:b.data("title")||a("title").text().replace(/\s*[|\-\u00b7].*$/,"");this.author=this.options.author?this.options.author:b.data("author")||(a('meta[name="author"]').length?a('meta[name="author"]').attr("content"):window.location.hostname);this.iconUrl=b.data("icon-url");this.price=b.data("price");this.options.onInstall="function"==typeof this.options.onInstall?this.options.onInstall:function(){};this.options.onClose="function"==typeof this.options.onClose?this.options.onClose:
function(){};this.create();this.show();this.listen()}};h.prototype={constructor:h,create:function(){var b,c=this.price||this.options.price,e=this.options.url||function(){switch(this.type){case "android":return"market://details?id=";case "kindle":return"amzn://apps/android?asin=";case "windows":return k?"ms-windows-store://pdp/?productid=":"ms-windows-store:navigate?appid="}return"https://itunes.apple.com/"+this.options.appStoreLanguage+"/app/id"}.call(this)+this.appId,d=c?function(){var a=c+" - ";
switch(this.type){case "android":return a+this.options.inGooglePlay;case "kindle":return a+this.options.inAmazonAppStore;case "windows":return a+this.options.inWindowsStore}return a+this.options.inAppStore}.call(this):"",f=null==this.options.iconGloss?"ios"==this.type:this.options.iconGloss;"android"==this.type&&this.options.GooglePlayParams&&(e+="&referrer="+this.options.GooglePlayParams);e='<div id="smartbanner" class="'+this.type+'"><div class="sb-container"><a href="#" class="sb-close">&times;</a><span class="sb-icon"></span><div class="sb-info"><strong>'+
this.title+"</strong><span>"+this.author+"</span><span>"+d+'</span></div><a href="'+e+'" class="sb-button"><span>'+this.options.button+"</span></a></div></div>";this.options.layer?a(this.options.appendToSelector).append(e):a(this.options.appendToSelector).prepend(e);this.options.icon?b=this.options.icon:this.iconUrl?b=this.iconUrl:0<a('link[rel="apple-touch-icon-precomposed"]').length?(b=a('link[rel="apple-touch-icon-precomposed"]').attr("href"),null==this.options.iconGloss&&(f=!1)):0<a('link[rel="apple-touch-icon"]').length?
b=a('link[rel="apple-touch-icon"]').attr("href"):0<a('meta[name="msApplication-TileImage"]').length?b=a('meta[name="msApplication-TileImage"]').attr("content"):0<a('meta[name="msapplication-TileImage"]').length&&(b=a('meta[name="msapplication-TileImage"]').attr("content"));b?(a("#smartbanner .sb-icon").css("background-image","url("+b+")"),f&&a("#smartbanner .sb-icon").addClass("gloss")):a("#smartbanner").addClass("no-icon");this.bannerHeight=a("#smartbanner").outerHeight()+2;1<this.scale&&(a("#smartbanner").css("top",
parseFloat(a("#smartbanner").css("top"))*this.scale).css("height",parseFloat(a("#smartbanner").css("height"))*this.scale),a("#smartbanner .sb-container").css("-webkit-transform","scale("+this.scale+")").css("-msie-transform","scale("+this.scale+")").css("-moz-transform","scale("+this.scale+")").css("width",a(window).width()/this.scale));a("#smartbanner").css("position",this.options.layer?"absolute":"static")},listen:function(){a("#smartbanner .sb-close").on("click",a.proxy(this.close,this));a("#smartbanner .sb-button").on("click",
a.proxy(this.install,this))},show:function(b){var c=a("#smartbanner");c.stop();this.options.layer?(c.animate({top:0,display:"block"},this.options.speedIn).addClass("shown").show(),a(this.pushSelector).animate({paddingTop:this.origHtmlMargin+this.bannerHeight*this.scale},this.options.speedIn,"swing",b)):a.support.transition?(c.animate({top:0},this.options.speedIn).addClass("shown"),a(this.pushSelector).addClass("sb-animation").one(a.support.transition.end,function(){a("html").removeClass("sb-animation");
b&&b()}).emulateTransitionEnd(this.options.speedIn).css("margin-top",this.origHtmlMargin+this.bannerHeight*this.scale)):c.slideDown(this.options.speedIn).addClass("shown")},hide:function(b){var c=a("#smartbanner");c.stop();this.options.layer?(c.animate({top:-1*this.bannerHeight*this.scale,display:"block"},this.options.speedIn).removeClass("shown"),a(this.pushSelector).animate({paddingTop:this.origHtmlMargin},this.options.speedIn,"swing",b)):a.support.transition?("android"!==this.type?c.css("top",
-1*this.bannerHeight*this.scale).removeClass("shown"):c.css({display:"none"}).removeClass("shown"),a(this.pushSelector).addClass("sb-animation").one(a.support.transition.end,function(){a("html").removeClass("sb-animation");b&&b()}).emulateTransitionEnd(this.options.speedOut).css("margin-top",this.origHtmlMargin)):c.slideUp(this.options.speedOut).removeClass("shown")},close:function(a){a.preventDefault();this.hide();this.setCookie("sb-closed","true",this.options.daysHidden);this.options.onClose(a)},
install:function(a){this.options.hideOnInstall&&this.hide();this.setCookie("sb-installed","true",this.options.daysReminder);this.options.onInstall(a)},setCookie:function(a,c,e){a+="-2";var d=new Date;d.setDate(d.getDate()+e);c=encodeURI(c)+(null==e?"":"; expires="+d.toUTCString());document.cookie=a+"="+c+"; path=/;"},getCookie:function(a){a+="-2";var c,d,g,f=document.cookie.split(";");for(c=0;c<f.length;c++)if(d=f[c].substr(0,f[c].indexOf("=")),g=f[c].substr(f[c].indexOf("=")+1),d=d.replace(/^\s+|\s+$/g,
""),d==a)return decodeURI(g);return null},switchType:function(){var b=this;this.hide(function(){b.type="android"==b.type?"ios":"android";var c=a("android"==b.type?'meta[name="google-play-app"]':'meta[name="apple-itunes-app"]').attr("content");b.appId=/app-id=([^\s,]+)/.exec(c)[1];a("#smartbanner").detach();b.create();b.show()})}};a.smartbanner=function(b){var c=a(window),d=c.data("smartbanner");d||c.data("smartbanner",d=new h("object"==typeof b&&b));if("string"==typeof b)d[b]()};a.smartbanner.defaults=
{title:null,author:null,price:"FREE",appStoreLanguage:"us",inAppStore:"On the App Store",inGooglePlay:"In Google Play",inAmazonAppStore:"In the Amazon Appstore",inWindowsStore:"In the Windows Store",GooglePlayParams:null,icon:null,iconGloss:null,button:"VIEW",url:null,scale:"auto",speedIn:300,speedOut:400,daysHidden:15,daysReminder:90,force:null,hideOnInstall:!0,layer:!1,iOSUniversalApp:!0,appendToSelector:"body",pushSelector:"html"};a.smartbanner.Constructor=h;void 0===a.support.transition&&(a.fn.emulateTransitionEnd=
function(b){var c=!1,d=this;a(this).one(a.support.transition.end,function(){c=!0});setTimeout(function(){c||a(d).trigger(a.support.transition.end)},b);return this},a(function(){var b=a.support,c;a:{c=document.createElement("smartbanner");var d={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},g;for(g in d)if(void 0!==c.style[g]){c={end:d[g]};break a}c=!1}b.transition=c}))});
