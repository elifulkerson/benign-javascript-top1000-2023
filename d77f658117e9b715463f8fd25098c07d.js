var $jscomp={scope:{},findInternal:function(d,a,c){d instanceof String&&(d=String(d));for(var b=d.length,e=0;e<b;e++){var f=d[e];if(a.call(c,f,e,d))return{i:e,v:f}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(d,a,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");d!=Array.prototype&&d!=Object.prototype&&(d[a]=c.value)};
$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(d,a,c,b){if(a){c=$jscomp.global;d=d.split(".");for(b=0;b<d.length-1;b++){var e=d[b];e in c||(c[e]={});c=c[e]}d=d[d.length-1];b=c[d];a=a(b);a!=b&&null!=a&&$jscomp.defineProperty(c,d,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6-impl","es3");
$(function(){var d={init:function(){function a(){b.body.addClass("m-widget-lenta-mini");b.body.removeClass("m-widget-lenta-active");$(".js__counter-lenta").addClass("m-zero").text(0);ria.lsSet("ria_lenta_mini","true");ria.lsSet("ria_lenta_count","0");dataLayer.push({block:"lenta_widget",event:"lenta_hide"})}function c(){return Math.max(window.innerHeight||0,(document.getElementsByTagName("html")[0]||{}).clientHeight||0)}var b=this;b.$elem=$("#widgetLenta .lenta__content");b.cashList=!1;b.loading=
!1;b.waitList=!1;b.title=$(".lenta__header");b.body=$("#body");b.maxdate=1E3*b.$elem.find(".lenta__item:first").data("maxtime");b.loader_delay=3E3;b.delay=700;b.widget=$(".widgets__b-slide");b.$elem.theinScroll();window.dataLayer=window.dataLayer||[];$("body").on("widget",function(a,c,e){"lenta"==c&&e&&(b.$elem.find(".lenta__list").height()<b.$elem.height()&&(b.cashList?b.addList():b.loading?b.waitList=!0:b.updateCash()),dataLayer.push({block:"lenta_widget",event:"lenta_open"}));"lenta"!=c||e||(b.$elem.trigger("scroll-up.the-in-scroll",
[0,100]),b.$elem.css("top",""),dataLayer.push({block:"lenta_widget",event:"lenta_close"}))});$(".lenta__close").on("click",function(){a()});$(".lenta-mini").on("click",function(){window.dataLayer=window.dataLayer||[];dataLayer.push({block:"lenta_widget",event:"lenta_open_not_fullscreen"});b.body.removeClass("m-widget-lenta-mini");b.body.addClass("m-widget-lenta-active");b.widget.addClass("m-transitiondelay");b.widget.on("transitionend",function(){$(this).removeClass("m-transitiondelay")});ria.lsSet("ria_lenta_mini",
"false")});0<$("body.m-width-max .article.m-visual_journalism_black").length||768>ria.getClientWidth()&&null==ria.lsGet("ria_lenta_mini")||"true"==ria.lsGet("ria_lenta_mini")?(0<parseInt(ria.lsGet("ria_lenta_count"))&&$(".js__counter-lenta").removeClass("m-zero"),$(".js__counter-lenta").text(ria.lsGet("ria_lenta_count")||0),b.body.addClass("m-widget-lenta-mini")):b.body.addClass("m-widget-lenta-active");if(768>ria.getClientWidth()&&"ontouchstart"in document.documentElement){var e=b.$elem.find(".lenta__list"),
d=new Hammer($(".widgets__b-cover").get(0)),g=$(".widgets__b-slide").position().top,h=-c();d.get("pan").set({direction:Hammer.DIRECTION_ALL});$("#widgetLenta").css({"touch-action":"none","user-select":"none","-webkit-user-drag":"none"});d.on("panstart",function(a){e.addClass("m-lenta-pan");b.widget.addClass("m-notransition");g=b.widget.position().top;windowHeight=c()});d.on("panmove",function(a){a=a.deltaY+g;b.widget.css("top",(a<h?h:0<a?0:a)+"px")});d.on("panend pancancel",function(c){e.removeClass("m-lenta-pan");
b.widget.removeClass("m-notransition");console.log("panend pancancel = ",c.deltaY);b.body.hasClass("m-widget-lenta")&&100<c.deltaY?(b.widget.css("top",""),ria_layout_manager.changeState("lenta",!1)):!b.body.hasClass("m-widget-lenta")&&20<c.deltaY?(b.widget.css("top",""),a()):-100>c.deltaY?(b.widget.css("top",""),ria_layout_manager.changeState("lenta",!0)):(b.widget.css("top",g),b.widget.on("transitionend",function(){$(this).css("top","")}))})}$("#widgetLenta a").on("click",function(){dataLayer.push({block:"lenta_widget",
event:"lenta_link",link:$(this).attr("href")})});b.$elem.trigger("add-scrolling-trigger.the-in-scroll",[{name:"lenta_loadmore",down:!0,sign:"<",position:75,move:!0}]);b.$elem.on("lenta_loadmore.the-in-scroll",function(a){b.body.hasClass("m-widget-lenta")&&(b.cashList?b.addList():b.loading?b.waitList=!0:b.updateCash())});b.$elem.trigger("add-scrolling-trigger.the-in-scroll",[{name:"lenta_scroll_start",sign:">",position:1,once:!0,move:!0}]);b.$elem.on("lenta_scroll_start.the-in-scroll.the-in-scroll",
function(a){dataLayer.push({block:"lenta_widget",event:"lenta_scroll"})});ria_sock&&ria_sock.on("bus_notify",function(a){"new_article"===a.subtype&&(a.domain==GLOBAL.project||"ria_ru"==a.domain&&"ria"==GLOBAL.project)&&b.newArticle(a)})},updateCash:function(){if(!this.cashList){var a=this,c=a.$elem.find(".lenta__item:last").data("next");c?(a.loading=!0,$.ajax({url:c,dataType:"html"}).done(function(b){a.cashList=b;a.loading=!1;a.waitList&&(a.addList(),a.waitList=!1)}).fail(function(){a.loading=!1})):
a.$elem.off("lenta_loadmore.the-in-scroll")}},addList:function(){if(this.cashList){var a=this.$elem.data("theinScroll").$container;a.find(".lenta__item:last").removeAttr("data-next");a.find(".lenta__list").append(this.cashList);this.cashList=!1;this.updateCash()}},newArticle:function(a){var c=a.article_date,b=Date.now(),e=ria.getClientWidth(),c=c.split(" "),c=Date.parse(c[0]+"T"+c[1]+c[2].substr(0,3)+":"+c[2].substr(3,2));c>this.maxdate&&c<b&&(this.maxdate=c,this.body.hasClass("m-widget-lenta-mini")||
$("#widgetLenta").hasClass("lenta-alert")?this.renderHidden(a):1234<e&&!this.body.hasClass("m-widget-lenta")?this.renderColumnAnimate(a):this.body.hasClass("m-widget-lenta")?this.renderListAnimate(a):this.renderLineAnimate(a),this.renderMini(a))},renderColumnAnimate:function(a){var c=this,b=0===a.article_url.lastIndexOf("http",0)?a.article_url:GLOBAL.www+a.article_url,e=c.$elem.find(".lenta__list"),d=$(document.createElement("div")).addClass("lenta__item");d.html('<a href="'+b+'" class="lenta__item-size color-font-hover-only"><span class="lenta__item-valign"><span class="lenta__item-date">'+
a.article_date.substr(11,5)+'</span><span class="lenta__item-text">'+a.article_title+"</span></span></a>");1==a.article_priority&&(d.addClass("lenta__item-warn"),d.find(".lenta__item-text").append('<span class="lenta__item-icon m-breaking">'+ria.getIcon("icon-lightning_small")+"</span>"));c.title.addClass("m-color");e.prepend(d).addClass("shift");setTimeout(function(){e.addClass("animate")},100);setTimeout(function(){e.removeClass("shift animate");d.addClass("m-color")},700);setTimeout(function(){c.title.removeClass("m-color");
d.removeClass("m-color")},1400)},renderLineAnimate:function(a){var c=this,b=0===a.article_url.lastIndexOf("http",0)?a.article_url:GLOBAL.www+a.article_url,d=$(document.createElement("div")),f=c.$elem.find(".lenta__item").first();c.$elem.find(".lenta__list").prepend(d);d.addClass("lenta__item empty show m-color");setTimeout(function(){f.addClass("hide");c.title.addClass("m-color")},c.delay);setTimeout(function(){d.removeClass("empty")},c.delay+100);setTimeout(function(){d.html('<a href="'+b+'" class="lenta__item-size color-font-hover-only"><span class="lenta__item-valign"><span class="lenta__item-date">'+
a.article_date.substr(11,5)+'</span><span class="lenta__item-text">'+a.article_title+"</span></span></a>");1==a.article_priority&&(d.addClass("lenta__item-warn"),d.find(".lenta__item-text").append('<span class="lenta__item-icon m-breaking">'+ria.getIcon("icon-lightning_small")+"</span>"));d.removeClass("show");f.addClass("no-transition").removeClass("hide")},c.delay+200);setTimeout(function(){c.title.removeClass("m-color");d.removeClass("m-color");f.removeClass("no-transition")},c.delay+900)},renderListAnimate:function(a){var c=
this,b=0===a.article_url.lastIndexOf("http",0)?a.article_url:GLOBAL.www+a.article_url,d=$(document.createElement("div"));c.$elem.find(".lenta__list").prepend(d);d.addClass("lenta__item loading empty");c.$elem.addClass("m-loading");setTimeout(function(){d.removeClass("empty")},100);setTimeout(function(){d.html('<a href="'+b+'" class="lenta__item-size color-font-hover-only"><span class="lenta__item-valign"><span class="lenta__item-date">'+a.article_date.substr(11,5)+'</span><span class="lenta__item-text">'+
a.article_title+"</span></span></a>");1==a.article_priority&&(d.addClass("lenta__item-warn"),d.find(".lenta__item-text").append('<span class="lenta__item-icon m-breaking">'+ria.getIcon("icon-lightning_small")+"</span>"))},c.loader_delay);setTimeout(function(){d.removeClass("loading");c.$elem.removeClass("m-loading")},c.loader_delay+100)},renderMini:function(a){$(".js__counter-lenta.m-zero").removeClass("m-zero");1==a.article_priority&&$(".js__counter-lenta").addClass("m-alert");a=parseInt($(".js__counter-lenta").text());
$(".js__counter-lenta").text(99<=a?"99+":++a);ria.lsSet("ria_lenta_count",a)},renderHidden:function(a){var c=0===a.article_url.lastIndexOf("http",0)?a.article_url:GLOBAL.www+a.article_url,b=$(document.createElement("div"));b.addClass("lenta__item");b.html('<a href="'+c+'" class="lenta__item-size color-font-hover-only"><span class="lenta__item-valign"><span class="lenta__item-date">'+a.article_date.substr(11,5)+'</span><span class="lenta__item-text">'+a.article_title+"</span></span></a>");1==a.article_priority&&
(b.addClass("lenta__item-warn"),b.find(".lenta__item-text").append('<span class="lenta__item-icon m-breaking">'+ria.getIcon("icon-lightning_small")+"</span>"));this.$elem.find(".lenta__list").prepend(b)}};$("#widgetLenta").length&&$("#widgetLenta").data("url").length&&$.ajax({url:$("#widgetLenta").data("url"),dataType:"html",type:"GET",success:function(a){$("#widgetLenta .lenta__content").find(".lenta__list").append(a);d.init()}})});
