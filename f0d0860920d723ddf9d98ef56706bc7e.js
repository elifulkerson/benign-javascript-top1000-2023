(function(window, $, undefined) {
var gamecrazy = {"setting":[{"boxtitle":"\u96fb\u73a9\u760b","btime":"2020-01-01 00:00:00","etime":"2022-12-31 23:59:59"}],"video":[{"bno":"2,1","id":"Jw4vpy7nRBE","number":"1","title":"\u96fb\u73a9\u760b#670 PS5 \u65b0\u6b3e\u4e3b\u6a5f 11 \u6708\u5728\u7f8e\u570b\u6436\u5148\u63a8\u51fa\ud83d\ude80\u9ed1\u6697\u985e\u9b42 ARPG\u300a\u58ae\u843d\u4e4b\u738b 2023\u300b\u2694\ufe0f\u300a\u5492\u8853\u8ff4\u6230 \u96d9\u83ef\u4e82\u821e\u300b\u9996\u6b3e\u5bb6\u6a5f\u904a\u62322024\u5e742\u6708\u63a8\u51fa\ud83d\udc4f\u7f8e\u5c11\u5973\u65b0\u4f5c\u300a\u5973\u62f3\u4e3b\u7fa9F-ist\uff01\u300b\ud83d\udc69\ud83c\udffb","ad_btime":"2023-10-16 10:16:18","ad_etime":"2030-12-31 23:59:59","cover":"https:\/\/i.ytimg.com\/vi\/Jw4vpy7nRBE\/maxresdefault.jpg","area":"youtube","viewer":"29726","islive":"0","video":"https:\/\/www.youtube.com\/watch?v=Jw4vpy7nRBE"},{"bno":"2,2","id":"sX7ySTVdoBc","number":"2","title":"20231014 \u96fb\u73a9\u760b\u624b\u6a5f\u904a\u6232\u9031\u5831","ad_btime":"2023-10-16 10:15:41","ad_etime":"2030-12-31 23:59:59","cover":"https:\/\/i.ytimg.com\/vi\/sX7ySTVdoBc\/maxresdefault.jpg","area":"youtube","viewer":"22290","islive":"0","video":"https:\/\/www.youtube.com\/watch?v=sX7ySTVdoBc"},{"bno":"2,3","id":"zidYoOVAuxc","number":"3","title":"\u300a\u661f\u4e4b\u5f8c\u88d4\uff1aKnights of Veda\u300b\u4e2d\u6587\u7248 BETA \u6e2c\u8a66 \u5be6\u6a5f\u8a66\u73a9","ad_btime":"2023-10-13 19:09:16","ad_etime":"2030-12-31 23:59:59","cover":"https:\/\/i.ytimg.com\/vi\/zidYoOVAuxc\/maxresdefault.jpg","area":"youtube","viewer":"4092","islive":"0","video":"https:\/\/www.youtube.com\/watch?v=zidYoOVAuxc"},{"bno":"2,4","id":"dhh1w1r1W14","number":"4","title":"\u5e74\u5ea6\u6700\u591a\u904a\u6232\u9f4a\u767c\uff0110 \u6708 30 \u6b3e\u671f\u5f85\u904a\u6232\u63a8\u85a6\u300a\u7d22\u5c3c\u514b \u8d85\u7d1a\u5de8\u661f\u300b\u300a\u6f5b\u9f8d\u8adc\u5f71 Master Collection Vol.1\u300b\u300a\u5fc3\u9748\u6bba\u624b 2\u300b\u300a\u6f2b\u5a01\u8718\u86db\u4eba 2\u300b\u300a\u5200\u528d\u795e\u57df \u7570\u7d46\u96c6\u7d50\u300b","ad_btime":"2023-10-06 20:22:00","ad_etime":"2030-12-31 23:59:59","cover":"https:\/\/i.ytimg.com\/vi\/dhh1w1r1W14\/maxresdefault.jpg","area":"youtube","viewer":"43748","islive":"0","video":"https:\/\/www.youtube.com\/watch?v=dhh1w1r1W14"},{"bno":"2,5","id":"-8kDy1wUnYo","number":"5","title":"\u96fb\u73a9\u760b#668 2024\u503c\u5f97\u671f\u5f85\u768413 \u6b3e\u65e5\u5f0f RPG\uff01\u2694\ufe0f\ud83c\udfae\u300aFinal Fantasy VII \u91cd\u751f\u300b\u300a\u4eba\u4e2d\u4e4b\u9f8d 8\u300b\u300a\u78a7\u85cd\u5e7b\u60f3 Relink\u300b\u300a\u6d6a\u4eba\u5d1b\u8d77\u300b\u300a\u738b\u570b\u4e4b\u5fc3 4\u300b","ad_btime":"2023-10-02 12:40:36","ad_etime":"2030-12-31 23:59:59","cover":"https:\/\/i.ytimg.com\/vi\/-8kDy1wUnYo\/maxresdefault.jpg","area":"youtube","viewer":"118255","islive":"0","video":"https:\/\/www.youtube.com\/watch?v=-8kDy1wUnYo"},{"bno":"2,6","id":"FnzAi2-uqME","number":"6","title":"10 \u6708\u65b0\u756a\u7e8c\u4f5c\u6700\u591a\u7684\u4e00\u5b63\uff0130 \u90e8\u79cb\u5b63\u65b0\u756a\u4ecb\u7d39\u300a\u846c\u9001\u7684\u8299\u8389\u84ee\u300b\u300aPLUTO\uff5e\u51a5\u738b\uff5e\u300b\u300a\u9032\u64ca\u7684\u5de8\u4eba The Final Season \u5b8c\u7d50\u7bc7\u300b  \u300a\u95dc\u65bc\u6211\u8f49\u751f\u8b8a\u6210\u53f2\u840a\u59c6\u9019\u6a94\u4e8b \u9ad8\u91cc\u70cf\u65af\u4e4b\u5922\u300b","ad_btime":"2023-09-15 12:28:07","ad_etime":"2030-12-31 23:59:59","cover":"https:\/\/i.ytimg.com\/vi\/FnzAi2-uqME\/maxresdefault.jpg","area":"youtube","viewer":"12567","islive":"0","video":"https:\/\/www.youtube.com\/watch?v=FnzAi2-uqME"},{"bno":"2,7","id":"ol9mD2hkuE0","number":"7","title":"\u96fb\u73a9\u760b#656 \u7206\u91cf\u904a\u6232\u6f6e\uff012023 \u4e0b\u534a\u5e74 33 \u6b3e PS5\u3001PC\u3001XBS X|S \u671f\u5f85\u904a\u6232\uff01","ad_btime":"2023-07-10 10:09:43","ad_etime":"2030-12-31 23:59:59","cover":"https:\/\/i.ytimg.com\/vi\/ol9mD2hkuE0\/maxresdefault.jpg","area":"youtube","viewer":"270278","islive":"0","video":"https:\/\/www.youtube.com\/watch?v=ol9mD2hkuE0"},{"bno":"2,8","id":"6IEe3i6-IAg","number":"8","title":"2023 \u4e0b\u534a\u5e74 20 \u6b3e\u671f\u5f85\u624b\u6a5f\u904a\u6232 \u55ae\u6a5f\u5927\u4f5c\u90fd\u8981\u767b\u4e0a\u624b\u6a5f\u5566\uff01\u300a\u9cf4\u6f6e\u300b\u3001\u300a\u7d55\u5340\u96f6\u300b\u3001\u300aGoddess Order \u5973\u795e\u6307\u4ee4\u300b\u3001\u300aSD \u92fc\u5f48 G \u4e16\u4ee3\uff1a\u6c38\u6046\u300b\u4f86\u52e2\u6d36\u6d36","ad_btime":"2023-07-06 15:58:14","ad_etime":"2030-12-31 23:59:59","cover":"https:\/\/i.ytimg.com\/vi\/6IEe3i6-IAg\/maxresdefault.jpg","area":"youtube","viewer":"113116","islive":"0","video":"https:\/\/www.youtube.com\/watch?v=6IEe3i6-IAg"},{"bno":"2,9","id":"CPnpkWL6-Ko","number":"9","title":"\u96fb\u73a9\u760b#655  Switch 2023 \u4e0b\u534a\u5e74 21 \u6b3e\u671f\u5f85\u904a\u6232\u2726\u746a\u5927\u53d4\u56de\u6b78\u51fa\u65b0\u4f5c\u300a\u8d85\u7d1a\u746a\u5229\u6b50\u5144\u5f1f \u9a5a\u5947\u300b\u3001\u91cd\u88fd\u300a\u8d85\u7d1a\u746a\u5229\u6b50 RPG\u300b\u2726\u300a\u52c7\u8005\u9b25\u60e1\u9f8d \u602a\u7269\u4ed9\u5883 3\u300b\u2726\u300a\u8fea\u58eb\u5c3c\u5947\u5e7b\u5cf6\u300b","ad_btime":"2023-07-03 10:52:37","ad_etime":"2030-12-31 23:59:59","cover":"https:\/\/i.ytimg.com\/vi\/CPnpkWL6-Ko\/maxresdefault.jpg","area":"youtube","viewer":"390380","islive":"0","video":"https:\/\/www.youtube.com\/watch?v=CPnpkWL6-Ko"}]};
var gamecrazyAd = gamecrazy.ad;
var gamecrazyVideoTop = gamecrazy.videotop || [];
var gamecrazyVideoGeneral = gamecrazy.video;
var setting = gamecrazy.setting;

var html1 = '', len = 0, pit = 3;

$('#gamecrazyContainer > nav li.is-only').text(setting[0].boxtitle);

//general random
if (setting[0].btime <= '2023-10-16 13:00:06' && setting[0].etime >= '2023-10-16 13:00:06') {
for (var i = 0; i < gamecrazyVideoGeneral.length - 1; i++) {
var j = i+ Math.floor(Math.random() * (gamecrazyVideoGeneral.length-i));
var temp = gamecrazyVideoGeneral[j];
gamecrazyVideoGeneral[j] = gamecrazyVideoGeneral[i];
gamecrazyVideoGeneral[i] = temp;
}
}

//merge top & general
var gamecrazyVideo = jQuery.merge(jQuery.merge([], gamecrazyVideoTop), gamecrazyVideoGeneral);
for (var i = 0; i < gamecrazyVideo.length - 1; i++) {
if (gamecrazyVideo[i].ad_btime > '2023-10-16 13:00:06' || gamecrazyVideo[i].ad_etime < '2023-10-16 13:00:06') {
gamecrazyVideo.splice(i, 1);
i--;
}
}

len = gamecrazyVideo.length;

//ad
if (gamecrazyAd) {
for (var j = 0; j < gamecrazyAd.length; j++) {
var bno = gamecrazyAd[j].bno.split(",");
if (gamecrazyAd[j].area == 'twitch') {
var url = 'https://gnn.gamer.com.tw/gamecrazy.php?k=12&gt=T';
} else if (gamecrazyAd[j].area == 'youtube') {
var url = 'https://gnn.gamer.com.tw/gamecrazy.php?vid='+gamecrazyAd[j].id;
} else { //banner
var url = gamecrazyAd[j].id;
}

if (gamecrazyAd[j].ad_btime <= '2023-10-16 13:00:06' && gamecrazyAd[j].ad_etime >= '2023-10-16 13:00:06') {
html1 += '  <div class="liveAction">';
html1 += '    <span class="livead-title">'+gamecrazyAd[j].adtitle+'</span>';
html1 += '    <a data-gtm-service="gnn" data-gtm-page="首頁" data-gtm-area="電玩瘋" data-gtm-click="點擊電玩瘋" data-gtm-var1="' + url + '" class="a-mercy-d" data-ssn="'+bno[1]+'" data-gtm="電玩瘋" href="'+url+'">';
if (gamecrazyAd[j].islive == 1) {
html1 += '      <div style="pointer-events:none;" class="spectator">';
html1 += '        <p class="is-live-text">直播中</p>';
html1 += '        <i class="material-icons">person</i>';
html1 += '        <p class="people">'+gamecrazyAd[j].viewer+'</p>';
html1 += '      </div>';
} else {
if (gamecrazyAd[j].viewer != 0) {
html1 += '      <div style="pointer-events:none;" class="spectator">';
html1 += '        <i class="material-icons">visibility</i>';
html1 += '        <p class="people">'+gamecrazyAd[j].viewer+'</p>';
html1 += '      </div>';
}
}
html1 += '    <img style="pointer-events:none;" class="is-livead-img" src="'+gamecrazyAd[j].cover+'">';
html1 += '    <div style="pointer-events:none;" class="live-adlight"></div>';
html1 += '    </a>';
html1 += '    <a data-gtm-service="gnn" data-gtm-page="首頁" data-gtm-area="電玩瘋" data-gtm-click="點擊電玩瘋" data-gtm-var1="' + url + '" class="is-livead a-mercy-d" data-ssn="'+bno[1]+'" data-gtm="電玩瘋" href="'+url+'">'+gamecrazyAd[j].title+'</a>';
html1 += '  </div>';

len = len + 1;
pit = pit - 1;
}

if (!gamecrazyAd[j]) {
break;
}
}
}

let gamecrazyPage = 1;
live = {
gamecrazyBlock: function(pagesign) {
var livedata = [], html = '';

if (4 > len) {
livedata = gamecrazyVideo;
if (pit > livedata.length) {
pit = livedata.length;
}
} else {
let totalpage = Math.ceil(gamecrazyVideo.length / pit);

pagesign = pagesign || 0;
gamecrazyPage += pagesign;
gamecrazyPage = (gamecrazyPage > totalpage) ? 1 : (gamecrazyPage < 1 ? totalpage : gamecrazyPage);

//分頁切換button
$('#gamecrazyContainer').find('div.bh-section-more.is-right').addClass('is-show');
if (gamecrazyPage > 1) {
$('#gamecrazyContainer').find('div.bh-section-more.is-left').addClass('is-show');
}

//分頁導覽
$('#gamecrazyContainer').find('div[data-pagenav="gamecrazy"]').empty();
for (let p=1; p <= totalpage; p++) {
$('#gamecrazyContainer').find('div[data-pagenav="gamecrazy"]').append('<div class="dot' + (gamecrazyPage == p ? ' is-now' : '') + '"></div>');
}
$('#gamecrazyContainer').find('div[data-pagenav="gamecrazy"]').show();

if (pagesign) {
let tmppit = pagesign > 0 ? pit : -pit;
gamecrazyVideo = [].concat(gamecrazyVideo.slice(tmppit), gamecrazyVideo.slice(0, tmppit));
}

let tmpVideo = [].concat(gamecrazyVideo);
while (livedata.length < pit) {
var tmp = tmpVideo.shift();
livedata.push(tmp);
}
}
html += html1;

for (var j = 0; j < pit; j++) {
if (livedata[j].area == 'twitch') {
var url = 'https://gnn.gamer.com.tw/gamecrazy.php?k=12&gt=T';
} else if (livedata[j].area == 'youtube') {
var url = 'https://gnn.gamer.com.tw/gamecrazy.php?vid='+livedata[j].id;
}
html += '  <div class="liveAction">';
html += '    <a data-gtm-service="gnn" data-gtm-page="首頁" data-gtm-area="電玩瘋" data-gtm-click="點擊電玩瘋" data-gtm-var1="' + url + '" data-gtm="電玩瘋" href="'+url+'">';
if (livedata[j].islive == 1) {
html += '      <div style="pointer-events:none;" class="spectator">';
html += '        <p class="is-live-text">直播中</p>';
html += '        <i class="material-icons">person</i>';
html += '        <p class="people">'+livedata[j].viewer+'</p>';
html += '      </div>';
} else {
if (livedata[j].viewer != 0) {
html += '      <div style="pointer-events:none;" class="spectator">';
html += '        <i class="material-icons">visibility</i>';
html += '        <p class="people">'+livedata[j].viewer+'</p>';
html += '      </div>';
}
}
html += '    <img style="pointer-events:none;" src="'+livedata[j].cover+'">';
html += '    </a>';
html += '    <a data-gtm-service="gnn" data-gtm-page="首頁" data-gtm-area="電玩瘋" data-gtm-click="點擊電玩瘋" data-gtm-var1="' + url + '" class="is-livead" data-gtm="電玩瘋" href="'+url+'">'+livedata[j].title+'</a>';
html += '  </div>';

if (!livedata[j]) {
break;
}
}

$('#gamecrazyContainer').find('div[data-content="gamecrazy"]').html(html);
}
};

window.GAMECRAZY_LIVE = live;
})(window, jQuery);