!function(){"use strict";const e=e=>{const t=document.cookie.split(";").map((e=>e.trim()));for(let o=0;o<t.length;o+=1){const[n="",i=""]=t[o].split("=");if(n===e)return i}return null},t=function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8e3;const n=e("_autid");if(n)return void t(n);let i=!1;const a=setTimeout((()=>{i||t(null)}),o);window.addEventListener("nyp-aqfer:aut-cookie-ready",(o=>{clearTimeout(a);const{detail:{aut:n=e("_autid")}={}}=o;i=!0,t(n),clearTimeout(a)}))},o=async(e,t)=>{const o=`__cachedAqferResponse_${t}`,n=window.localStorage?.getItem(o);if(n){const{data:e,expiration:t}=JSON.parse(n);if(t>(new Date).getTime())return e}const i=(new Date).getTime()+6048e5,{nypAqfer:{aqferAccessToken:a=null}={}}=window;if(!a||!a.length)throw new Error("No aqferAccessToken found.");return fetch(e,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>(localStorage?.setItem(o,JSON.stringify({data:e,expiration:i})),e)))},n=async t=>t?o(`https://graphds-c057.a24365.io/v2/entities/ck~nypost~${t}/edges`,"neighbors").then((t=>{window.localStorage?.setItem("aqfer",JSON.stringify(t));const{data:o=[]}=t;if(console.log("Aqfer Neighbors",o),o.length){const t=o.filter((e=>"em"===e.type)).map((e=>e.key));t.length&&(n=t[0],e("uid2_identity")||(console.log(`Fetching UID2 token for ${n}`),fetch("https://api.nypdev.com/ads/tradedesk/token",{body:JSON.stringify({email:n}),headers:{Authorization:"Basic QGxsZXk6dmZEVEJPM1Y3cnJ5","Content-Type":"application/json"},method:"POST"}).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>{const{Message:{Data:t}={}}=e;t&&((e,t,o)=>{const n=new Date;n.setTime(n.getTime()+31536e6);const i=`expires=${n.toUTCString()}`;document.cookie=`uid2_identity=${t};${i};path=/`})(0,JSON.stringify(t))})).catch((e=>console.error("Error fetching UID2 token",e)))),(e=>{const t=()=>{const t=window.atsenvelopemodule||window.ats||null;t&&e&&t.setAdditionalData&&t.setAdditionalData({type:"email",id:e})};window.atsenvelopemodule||window.ats?t():window.addEventListener("envelopeModuleReady",t)})(t[0]))}var n})).catch((e=>console.error("Aqfer Neighbors Error",e))):(console.log("No _autid cookie found for edge lookup."),null),i=async e=>{e?o(`https://dbds-c057.a24365.io/v2/entities/ck~nypost~${e}`,"nyp_id").then((t=>{const{key:o=""}=t;window.localStorage?.setItem("nyp_id",o),window.dispatchEvent(new CustomEvent("nyp-aqfer:nyp-id-ready",{detail:{nypId:o}})),((e,t)=>{const o=[];t&&o.push({id:t,tag:"_nypid-sync",priority:1}),o.push({id:e,tag:"_autid-sync",priority:2}),window.permutive?.identify(o)})(e,o||null)})).catch((e=>console.error("Aqfer NYPID Error",e))):console.log("No _autid cookie found for NYP ID Lookup.")},a=e=>{window.nypGa((()=>{window.ga("set","dimension82",e)})),window.ga4Dims=window.ga4Dims||{},window.ga4Dims.ga_aut_id=e},s=()=>{if(!document.cookie)return"";let e="";return document.cookie.split(";").forEach((t=>{t.includes("_autid=")&&(window.nypGa((()=>{window.ga("set","dimension82",t.split("=")[1])})),window.ga4Dims=window.ga4Dims||{},window.ga4Dims.ga_aut_id=t.split("=")[1]),t.includes("sailthru_visitor=")&&([,e]=t.split("="))})),e};(async()=>{const e=JSON.parse(window.localStorage?.getItem("zephr")||"")||{},{user:{account:{emailAddress:o=""}={},trackingId:r=""}={}}=e,{nypAqfer:{featureFlags:{tag:d=!1}={},root:c=""}={}}=window;d&&((()=>{const{root:e=""}=window.nypAqfer||{};window.addEventListener("message",(t=>{if(t.origin!==e)return;const{data:o}=t;try{const e=JSON.parse(o),{message:t="",sub_autId:n="",sub_ipaddr:i=""}=e;"aut cookie ready"===t&&n&&(window.dispatchEvent(new CustomEvent("nyp-aqfer:aut-cookie-ready",{detail:{aut:n}})),window.ga&&window.ga("send","event","Aqfer","aUT","Viewed",{nonInteraction:!0})),localStorage?(n&&localStorage?.setItem("_autId",n),i&&localStorage?.setItem("ipaddr",i)):console.error("localStorage is not supported on this browser for ID5 Identity Resolution")}catch(e){console.log("Error parsing message for ID5 Identity Resolution",e)}}))})(),t(n),t(i),t(a),(e=>{const{nypAqfer:{isProduction:t=!1}={}}=window,o=e;t||(o.cls="preprod"),console.log("Aqfer C057Data",o),window.c057Data=o,function(e,t,o,n){var i,a=[],s=e.tt.slice(-1),r={cdmn:1,lm:1,tt:1},d={cid:1,cls:1,dmn:1,pubid:1,evid:1,aq_m:1};for(i in e.dmn=(e.dmn||(o.top[n]===o[n]?""+o[n]:t.referrer).split("/")[2]).split(":")[0],e)(d[i]||("j"!=s||e.aq_m)&&!r[i])&&a.push(i+"="+e[i]);const c=t.createElement("f"==s?"img":"script");c.id=c.title="pxscrpt",c.async=c.defer=!0,c.src="//"+e.cdmn+"/1/"+e.lm+"/"+e.tt+"?"+a.join("&"),t.body.appendChild(c)}(o,document,window,"location")})({cdmn:c.replace("https://",""),lm:"e",tt:"tcs.dhj",aqet:"pv",v0:o,v1:s(),v2:r,v3:"",v4:"",v5:""}))})()}();