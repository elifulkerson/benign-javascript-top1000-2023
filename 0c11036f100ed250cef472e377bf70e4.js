(()=>{let e={vapidPublicKey:"BCkpzMqeR-NuTSermGyC0SfB2R1BoWuRCUx00sc15AjEK3dG317V4Yobo1IVxqwHz-0PQDW1F1cYNxHY8Mgc-bs=",appKey:"C_Cadm5QRFy6_zdgEmgVCA",token:"MTpDX0NhZG01UVJGeTZfemRnRW1nVkNBOkllZ3BqMm1rQ1BpV3cxRHhrRGlyTlZGVm4tSjhFTlRMMlNRSEdGbzBPNUE"};window.version_us&&(e={vapidPublicKey:"BGHmIs6vXRJq4L_bJhnZg42QYnbHZiqXtR8aN2d283jyQZA-2UqwP-kL6Zj1pCjRTMh21YqP-ZzzvREoHsytL-w=",appKey:"WIACEbbBSQy7CZdY2JumKw",token:"MTpXSUFDRWJiQlNReTdDWmRZMkp1bUt3OkNpMGdXQUdiUjlGemVkSzZ5SzBvX29CdElEM2hkQkNwOTZjc1NreU9MMXM"}),ExpressApp.Log("[PUSH NOTIFICATION] Service worker scope",e),function(e,r,t,o,i){var n,p="Promise"in e,s={then:function(){return s},catch:function(e){return e(new Error("Airship SDK Error: Unsupported browser")),s}},a=p?new Promise((function(e,r){n=function(t,o){t?r(t):e(o)}})):s;a._async_setup=function(e){if(p)try{n(null,e(i))}catch(e){n(e)}},e.UA=a;var c=r.createElement("script");c.src="https://aswpsdkus.com/notify/v1/ua-sdk.min.js",c.async=!0,c.id="_uasdk",c.rel="UA",r.head.appendChild(c)}(window,document,0,0,e),window.addEventListener("load",(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/push-worker.js").then((()=>{ExpressApp.Log("[PUSH NOTIFICATION] Service worker registered!")})).catch((e=>{ExpressApp.Log("[PUSH NOTIFICATION]] Error registering service worker:",e)}))}));const r=e=>Math.floor(e/1e3),t={push:e=>{ExpressApp.Log("[PUSH NOTIFICATION TRACKING]",{event:e}),window.dataLayer.push({event:e})},promptDisplayed:()=>{t.push("airship.promptDisplayed")},promptAccepted:()=>{t.push("airship.promptAccepted")},promptDeclined:()=>{t.push("airship.promptDeclined")},browserPromptDisplayed:()=>{t.push("airship.browserPromptDisplayed")},browserPromptAccepted:()=>{t.push("airship.browserPromptAccepted")},browserPromptDeclined:()=>{t.push("airship.browserPromptDeclined")},successfulSubscription:()=>{t.push("airship.successfulSubscription")}};UA.then((e=>{if(e.getChannel().then((e=>{ExpressApp.Log("[PUSH NOTIFICATION] Channel ID:",e.id)})),(()=>{if("default"===Notification.permission){const e=r(parseFloat(window.localStorage.getItem("last-push-notification")))||0;return r(Date.now())-e>604800}return!1})()&&(()=>{var e;let r=parseInt(null!==(e=window.localStorage.getItem("pageview-number"))&&void 0!==e?e:"1",10);return 1===r?(window.localStorage.setItem("pageview-number","2"),!1):2===r})()){const r=document.getElementById("push-notification-wrapper");r.style.display="block",t.promptDisplayed(),document.getElementById("notification-yes").addEventListener("click",(()=>{t.promptAccepted(),t.browserPromptDisplayed();const o=setInterval((()=>{"granted"===Notification.permission?(t.browserPromptAccepted(),clearInterval(o)):"denied"===Notification.permission&&(t.browserPromptDeclined(),clearInterval(o))}),1e3);e.register().then((e=>{t.successfulSubscription()})),window.localStorage.removeItem("pageview-number"),r.remove()})),document.getElementById("notification-no").addEventListener("click",(()=>{t.promptDeclined(),window.localStorage.setItem("last-push-notification",Date.now().toString()),window.localStorage.removeItem("pageview-number"),r.remove()}))}}))})();