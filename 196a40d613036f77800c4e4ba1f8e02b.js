(function(){"use strict";const PerfTimer="object"==typeof performance&&"function"==typeof performance.now?performance:Date,FAST_FRAME_THRESHOLD=20,SLOW_FRAME_THRESHOLD=34;class CPUIdleMonitor{constructor(){this.idleCPUTime=0,this.busyCPUTime=0,this.startedTracking=PerfTimer.now(),this.lastFrame=this.startedTracking,this.requestID=requestAnimationFrame((()=>{this.updateCPUTimes()})),console.timeStamp&&console.timeStamp("cpu_idle_tracking_started")}updateCPUTimes(e={forceUpdate:!1,currentCPUSpan:0}){const t=PerfTimer.now(),s=t-this.lastFrame;let r;this.lastFrame=t,r=s>=SLOW_FRAME_THRESHOLD?0:s<=FAST_FRAME_THRESHOLD?1:(SLOW_FRAME_THRESHOLD-s)/(SLOW_FRAME_THRESHOLD-FAST_FRAME_THRESHOLD);let n=s*(1-r);e.forceUpdate&&n<e.currentCPUSpan&&(n=Math.min(s,e.currentCPUSpan)),this.busyCPUTime+=n,this.idleCPUTime+=s-n,e.forceUpdate||(this.requestID=requestAnimationFrame((()=>{this.updateCPUTimes()})))}stop(){null!==this.requestID&&(console.timeStamp&&console.timeStamp("cpu_idle_tracking_stopped"),cancelAnimationFrame(this.requestID),this.requestID=null)}getIdleCPUTime(){return this.idleCPUTime}getCPUTimeSnapshot(e){return void 0!==e&&this.updateCPUTimes({forceUpdate:!0,currentCPUSpan:e}),{idleTime:this.idleCPUTime.toString(),busyTime:this.busyCPUTime.toString()}}getTotalTrackedTime(){return this.idleCPUTime+this.busyCPUTime}getIdlePercentOfTracked(){const e=this.idleCPUTime+this.busyCPUTime;return 0===e?0:this.idleCPUTime/e}getUntrackedTimeSinceTTFB(){if("object"!=typeof performance||"function"!=typeof performance.now||"object"!=typeof performance.timing||"number"!=typeof performance.timing.responseStart||"number"!=typeof performance.timing.navigationStart)return null;const e=performance.timing.responseStart-performance.timing.navigationStart;return this.startedTracking-e}}function reportNonceMismatch(e,t){window.addRequireLoadCallback((()=>{setTimeout((()=>{const s=new Error("Refused to execute script from because window.CSP_SCRIPT_NONCE is defined and the nonce doesn't match.");throw s.excExtra={page_nonce:e,script_tag_nonce:t,err_version:3},s.tags=["csp-nonce-error"],s}),0)}))}const hasPerfNow=!(!window.performance||!window.performance.now);function consoleTimeStamp(e){console.timeStamp&&console.timeStamp(e)}class EnsembleStopwatch{constructor(){this._data={}}getNow(){if(hasPerfNow)return window.performance.now()}markSpan(e,t={}){if(consoleTimeStamp(e),"number"!=typeof t.startTime&&(t.startTime=0),"number"!=typeof t.endTime){const e=this.getNow();if(void 0===e)return;t.endTime=e}t.startTime=Math.round(t.startTime),t.endTime=Math.round(t.endTime),this._data[e]?console.error("stopwatch error: spanName has been used before: "+e):this._data[e]={start:t.startTime,end:t.endTime,annotations:t.annotations||{}}}getData(){const e={};for(const t in this._data)if(this._data.hasOwnProperty(t)){const s=this._data[t];e[t]={end:s.end,start:s.start,annotations:s.annotations}}return e}}class EventTracker{constructor(){this._postEventCallbacks=[],this._eventMarked=!1}callAfterEvent(e){this._eventMarked?e():this._postEventCallbacks.push(e)}_triggerPostEventCallbacks(){for(const e of this._postEventCallbacks)e();this._postEventCallbacks=[]}markEvent(){if(this._eventMarked)throw new Error("event can't be marked twice");this._eventMarked=!0,this._triggerPostEventCallbacks()}}const ScriptTypes=["text/javascript","text/ecmascript","application/javascript","application/ecmascript","",void 0];function insertPagelet(e,t){return e.innerHTML=t,t=>_evaluateScripts(e,t)}function evaluateScript(e,t){const s=document.createElement("div");return s.innerHTML=e,_evaluateScripts(s,t)}function _evaluateScripts(e,t){const s=e.getElementsByTagName("script");for(let e=0;e<s.length;e++){const r=s[e];if(-1===ScriptTypes.indexOf(r.type))continue;const n=r.nonce||r.getAttribute("nonce"),o=window.CSP_SCRIPT_NONCE;if(o===n){if(r.src)throw new Error("Do not add scripts with src in the pagelet html, they should instead be loaded via requirejs or as pagelet dependencies");eval.call(window,r.innerHTML)}else t(o,n)}}const loaderOrder=["loadCssWithCache","CssEntryPoint","css-modules"],sortedLoaders=["css-modules"];function findInsertPosition(e,t,s){if(s[t].length>0){if(sortedLoaders.includes(t)){const r=s[t];for(let t=0;t<r.length;t++){const{elem:s,path:n}=r[t];if(n>e.path)return[s,t]}}return[s[t][s[t].length-1].elem.nextElementSibling,null]}const r=loaderOrder.indexOf(t);for(let e=r-1;e>=0;e--){const t=s[loaderOrder[e]];if(t.length>0)return[t[t.length-1].elem.nextElementSibling,null]}for(let e=r+1;e<loaderOrder.length;e++){const t=s[loaderOrder[e]];if(t.length>0)return[t[0].elem,null]}return[null,null]}function injectCssElement(e,t,s,r,n){e.elem.setAttribute("data-loader",t),e.elem instanceof HTMLStyleElement&&e.elem.setAttribute("path",e.path);let o=null,i=null;n||([o,i]=findInsertPosition(e,t,s)),null===i?s[t].push(e):s[t].splice(i,0,e),o?r.insertBefore(e.elem,o):r.appendChild(e.elem)}function injectCss(e,t,s=document){const r=s.defaultView;r.__injectCssCache||(r.__injectCssCache={loadCssWithCache:[],CssEntryPoint:[],"css-modules":[]});const n=r.__injectCssCache,o=sortedLoaders.includes(t);if(!o&&e.length>1){const[r]=findInsertPosition(e[0],t,n),i=s.createDocumentFragment();for(const s of e)injectCssElement(s,t,n,i,!o);null===r?s.head.appendChild(i):s.head.insertBefore(i,r)}else for(const r of e)injectCssElement(r,t,n,s.head,!1)}const _loadedCSS={},_CSSElements={};function appendLinkTags(e,t,s){const r=[];for(const e of t){const t=_CSSElements[e];if(t)if(_loadedCSS[e])s();else{const r=t.onload,n=t.onerror;t.onload=()=>{s(),r()},t.onerror=()=>{s({resource:e,type:"stylesheet"}),n()}}else{const t=document.createElement("link");t.href=e,t.rel="stylesheet",t.onload=()=>{_loadedCSS[e]=!0,s()},t.onerror=()=>{s({resource:e,type:"stylesheet"})},r.push({elem:t,path:e}),_CSSElements[e]=t}}injectCss(r,"CssEntryPoint",e)}function appendScriptTags(e,t,s){let r;window.hasOwnProperty("_csp_external_script_nonce")&&(r=window._csp_external_script_nonce);for(const n of t){const t=document.createElement("script");t.src=n,t.type="text/javascript",t.async=!0,t.onload=()=>{s()},t.onerror=()=>{s({resource:n,type:"script"})},r&&t.setAttribute("nonce",r),e.appendChild(t)}}class ResourceLoader{constructor(e,t){this.totalResources=0,this.loadedResources=0,this.onLoadCallbacks=[],this.errors=[],e.stylesheets&&(this.totalResources+=e.stylesheets.length),e.scripts&&(this.totalResources+=e.scripts.length),t&&this.onLoadCallbacks.push(t),0!==this.totalResources?this.loadResources(e.stylesheets,e.scripts):setTimeout(this.runCallbacks.bind(this),0)}isDoneLoading(){return this.loadedResources===this.totalResources}addOnLoadCallback(e){if(this.isDoneLoading())throw new Error("ResourceLoader error: added callback after resources have finished loading");this.onLoadCallbacks.push(e)}loadResources(e,t){const s=function(e){this.loadedResources+=1,e&&this.errors.push(e),this.loadedResources===this.totalResources&&this.runCallbacks()}.bind(this);if(e&&appendLinkTags(document,e,s),t){const e=document.createDocumentFragment();appendScriptTags(e,t,s),document.body.appendChild(e)}}runCallbacks(){let e;if(0!==this.errors.length){e={failedStylesheets:[],failedScripts:[]};for(const t of this.errors)"stylesheet"===t.type?e.failedStylesheets.push(t.resource):"script"===t.type&&e.failedScripts.push(t.resource)}for(let t=0;t<this.onLoadCallbacks.length;t++)this.onLoadCallbacks[t](e)}}function doFrameBust(e){if(e.mini_frame_bust){let e=!1;try{e=top.location.hostname===self.location.hostname}catch(e){}if(self!==top&&!e){setTimeout((()=>{window.DB_FRAME_BUST=!0,document.body.innerHTML="<img src='https://cfl.dropboxstatic.com/static/metaserver/static/images/logo.png' id='frame-bust-image'/>",document.getElementById("frame-bust-image").addEventListener("click",(function(e){top.location.href=window.location.href}))}),4);try{top.location.replace(self.location.href)}catch(e){console.error(e)}}}e.frame_bust&&self===top&&(document.body.style.display="")}class TTITracker{constructor(){this._postTTICallbacks=[],this.ttiMarked=!1}callAfterTTI(e){this.ttiMarked?e():this._postTTICallbacks.push(e)}_triggerPostTTICallbacks(){for(const e of this._postTTICallbacks)e();this._postTTICallbacks=[]}markTTI(){clearTimeout(this.ttiTimeoutId),setTimeout((()=>{this.ttiMarked=!0,this._triggerPostTTICallbacks();const e=document.createEvent("Event");e.initEvent("TTI",!0,!0),window.dispatchEvent(e)}),0)}startTTITimeout(e,t){this.ttiTimeoutId=setTimeout((()=>{t&&t(),this._triggerPostTTICallbacks()}),e)}}function validateObjectProperties(e,t,s){for(const r of Object.keys(s)){if(!Object.prototype.hasOwnProperty.call(t,r))throw new Error(e+" missing required property '"+r+"'");let n,o=!1;const i=s[r];if(null!==i)if("object"==typeof i?(n=i.kind,o=i.nullable):n=i,o){if(null!=t[r]&&typeof t[r]!==n)throw new Error(e+" property '"+r+"' has incorrect type. Expected '"+n+"' or null, got '"+typeof t[r]+"'")}else{const s=typeof t[r];if(s!==n)throw new Error(e+" property '"+r+"' has incorrect type. Expected '"+n+"', got '"+s+"'")}}}function validatePageletConfig(e){if(null==e)throw new Error("Pagelet config is null or undefined");if("object"!=typeof e)throw new Error("Pagelet config is not an object");switch(validateObjectProperties("Pagelet config",e,{name:"string",driver:"string"}),e.driver){case"simple":_validateSimplePageletConfig(e);break;case"requirejs":case"js_only":_validateRequireJSPageletConfig(e);break;case"inline":_validateInlinePageletConfig(e);break;default:throw new Error("Unknown pagelet config driver '"+e.driver+"'")}return e}function _validateSimplePageletConfig(e){if(validateObjectProperties("Pagelet config",e,{html:"string",script:{kind:"string",nullable:!0},stylesheets:null}),!Array.isArray(e.stylesheets))throw new Error("Pagelet config property 'stylesheets' has incorrect type. Expected 'Array' or null, got '"+typeof e.stylesheets+"'");for(const t of e.stylesheets)if("string"!=typeof t)throw new Error("Pagelet config property 'stylesheets' has an element of incorrect type. Expected 'string', got '"+typeof t+"'")}function _validateRequireJSPageletConfig(e){if(validateObjectProperties("Pagelet config",e,{html:"string",stylesheets:null}),!Array.isArray(e.stylesheets))throw new Error("Pagelet config property 'stylesheets' has incorrect type. Expected 'Array' or null, got '"+typeof e.stylesheets+"'");for(const t of e.stylesheets)if("string"!=typeof t)throw new Error("Pagelet config property 'stylesheets' has an element of incorrect type. Expected 'string', got '"+typeof t+"'")}function _validateInlinePageletConfig(e){validateObjectProperties("Pagelet config",e,{html:"string",style:{kind:"string",nullable:!0},script:{kind:"string",nullable:!0}})}function validateUsers(e){if(!Array.isArray(e))throw new Error("users must be an array");for(let t=0;t<e.length;t++){_validateUser(e[t])}}function _validateUser(e){if(validateObjectProperties("User",e,{userId:"number",displayName:"string",personalName:{kind:"string",nullable:!0},isActive:"boolean",isTeam:"boolean",teamName:{kind:"string",nullable:!0},teamSize:"number",redirectUrl:{kind:"string",nullable:!0},role:"string"}),-1!==e.userId&&!e.isTeam&&null==e.personalName)throw new Error("Non-team user must have 'personalName' set");if(e.isTeam&&null==e.teamName)throw new Error("Team user must have 'teamName' set");if(e.isTeam&&-1===e.teamSize)throw new Error("Team user must have 'teamSize' set");if(-1===["work","personal"].indexOf(e.role))throw new Error(`role ${e.role} is not recognized`);if(-1===e.userId&&null==e.redirectUrl||-1!==e.userId&&null!=e.redirectUrl)throw new Error("User property 'redirectUrl' must be set if and only if the user is not paired")}class Viewer{constructor(e){if(!e.users)throw new Error("Viewer config must contain users. Config: "+JSON.stringify(e));validateUsers(e.users),this.users=e.users}getActiveUser(){for(let e=0;e<this.users.length;e++)if(this.users[e].isActive)return this.users[e];return null}getUserById(e){for(let t=0;t<this.users.length;t++){const s=this.users[t];if(s.userId===e)return s}throw new Error(`user ${e} is not in the current viewer`)}isValidRole(e){return-1!==["personal","work"].indexOf(e)}}let started=!1;function startVisibilityWatcher(){if(!started&&window.performance&&window.performance.mark){started=!0;const e=()=>{const e=document.visibilityState;e&&window.performance.mark(`VisibilityState.${e}`)};e(),document&&document.addEventListener&&document.addEventListener("visibilitychange",e,!1)}}const cpuIdleMonitor=new CPUIdleMonitor;startVisibilityWatcher();const CLIENT_HANDLED_QUERY_PARAMS={role:!0,email_just_verified:!0,email_just_verified_and_changed:!0,oref:!0,always_show_progressbar:!0,from_scl_sync_modal:!0};let jsStopwatch;function registerEnsembleStopwatch(){jsStopwatch=new EnsembleStopwatch}class Pagelet{constructor(e,t){this.name=e.name,this.driver=e.driver,this.exceptionInfo=t}}class SimplePagelet extends Pagelet{constructor(e,t){super(e,t),this.html=e.html,this.script=e.script,this.stylesheets=e.stylesheets}initializeLoad(e,t,s,r){const n=()=>{this.renderHtml(e),t?s.callAfterTTI((()=>this.loadScript())):this.loadScript(),r()};this.stylesheets&&this.stylesheets.length>0?new ResourceLoader({stylesheets:this.stylesheets},n):n()}renderHtml(e){const t=document.getElementById(e);if(!t)throw new Error("Unable to find pagelet targetElementId '"+e+"'");t.innerHTML=this.html}loadScript(){null!=this.script&&globalEval(this.script)}getDOMInteractive(){throw new Error("SimplePagelet does not track DOMInteractive")}}function globalEval(script){eval(script)}class RequireJSPagelet extends Pagelet{constructor(e,t,s){super(e,t),this.html=e.html,this.stylesheets=e.stylesheets,this._ensemble=s}insertIntoDOM(e,t,s){const r=document.getElementById(e);r.style.visibility="hidden",r.style.position="absolute";const n=insertPagelet(r,this.html);t?s.callAfterTTI((()=>n(reportNonceMismatch))):n(reportNonceMismatch),jsStopwatch.markSpan("dws_pagelet_render_on_page_"+e),jsStopwatch.markSpan("dws_pagelet_render_on_page_"+this.name),jsStopwatch.markSpan("dws_pagelet_render_on_page_uncached_"+this.name)}_showPageletElement(e){const t=document.getElementById(e);t.style.position="",t.style.visibility="visible"}initializeLoad(e,t,s,r){jsStopwatch.markSpan("dws_start_initialize_load_uncached_"+this.name),jsStopwatch.markSpan("dws_pagelet_payload_available_"+e),this.insertIntoDOM(e,t,s),this._domInteractive=(new Date).getTime(),console.timeStamp&&console.timeStamp("DOMInteractive"),"embedded-app"===e&&(this._ensemble.waitingForCss=!0),new ResourceLoader({stylesheets:this.stylesheets},(()=>{this._showPageletElement(e),"embedded-app"===e&&(this._ensemble.waitingForCss=!1,this._ensemble.mark_tti_callback()),jsStopwatch.markSpan("dws_pagelet_css_loaded_"+e),jsStopwatch.markSpan("dws_pagelet_load_stylesheet_"+this.name),jsStopwatch.markSpan("dws_pagelet_load_stylesheet_uncached_"+this.name),r()}))}getDOMInteractive(){if(!this._domInteractive)throw new Error("DOMInteractive has not been logged");return this._domInteractive}}class JSOnlyPagelet extends RequireJSPagelet{constructor(e,t,s){super(Object.assign(Object.assign({},e),{driver:"requirejs",html:""}),t,s)}_showPageletElement(e){}insertIntoDOM(e){jsStopwatch.markSpan("dws_pagelet_render_on_page_"+e),jsStopwatch.markSpan("dws_pagelet_render_on_page_"+this.name),jsStopwatch.markSpan("dws_pagelet_render_on_page_uncached_"+this.name)}}function removeServiceWorker(){navigator.serviceWorker&&navigator.serviceWorker.getRegistration().then((function(e){e&&e.unregister()}))}class Ensemble{constructor(){this.bufferedEventEmitter=null,this.globalHeaderEventEmitter=null,this.eventEmitter=null,this.ttiTracker=new TTITracker,this.ttiMarked=!1,this.ttiTracker.callAfterTTI((()=>this.ttiMarked=!0)),this.pageletsByElemId={},this.waitingForCss=!1,this.mark_tti_callback=()=>{},this.constModules={},this.constModuleCallbacks={},this._placeholderLoadedTrackerByElemId={},this.exceptionInfo=null,registerEnsembleStopwatch(),jsStopwatch.markSpan("dws_ensemble_constructor")}init(e){const t=jsStopwatch.getNow();if(jsStopwatch.markSpan("dws_ensemble_begin_init"),!e)throw new Error("Missing ensemble configuration");if(!e.viewerData)throw new Error("Missing viewer data needed to initialize the Ajax calls afterwards");if(!e.jsCsrfCookieName)throw new Error("Missing jsCsrfCookieName info for CSRF cookie");if(!e.frameProtection)throw new Error("Missing frameProtection");if(!e.errorStrings)throw new Error("Missing errorStrings");if(!e.dwsPageName)throw new Error("Missing dwsPageName");if(!e.exceptionInfo)throw new Error("Missing exceptionInfo");if(doFrameBust(e.frameProtection),!e.ttiTimeoutMS)throw new Error("Missing ttiTimeoutMS needed to ensure post-TTI pagelets always load");this.ttiTracker.startTTITimeout(e.ttiTimeoutMS,(()=>jsStopwatch.markSpan("dws_tti_timeout_expired"))),jsStopwatch.markSpan("dws_tti_timeout_started"),this.viewer=new Viewer(e.viewerData),this.jsCsrfCookieName=e.jsCsrfCookieName,this._embeddedAppPagelet=null,this.errorStrings=e.errorStrings,this.dwsPageName=e.dwsPageName,this.exceptionInfo=e.exceptionInfo,this.lazyLoadJQuery=e.lazyLoadJQuery;try{this.switchedAccounts=!!sessionStorage.getItem("Ensemble.switchedAccounts"),sessionStorage.removeItem("Ensemble.switchedAccounts")}catch(e){console.error(e),this.switchedAccounts=!1}removeServiceWorker(),this.prefetchedResourcesLoader=new ResourceLoader({stylesheets:e.prefetchResources.stylesheets,scripts:e.prefetchResources.scripts}),window.addRequireLoadCallback((()=>{if(window.requireContexts.externals){const e=this.lazyLoadJQuery?["react","react-dom"]:["jquery","react","react-dom"];window.requireContexts.externals.require(e,(()=>{jsStopwatch.markSpan("dws_core_externals_loaded")}))}}));const s=jsStopwatch.getNow(),r=cpuIdleMonitor.getCPUTimeSnapshot(s&&t?s-t:void 0);jsStopwatch.markSpan("dws_ensemble_init",{annotations:r})}getPageName(){return this.dwsPageName}getExceptionInfo(){return this.exceptionInfo}markTTI(){this.ttiTracker.markTTI()}stopwatchPagelet(e,t){const s=cpuIdleMonitor.getCPUTimeSnapshot(),r="dws_"+e+"_"+t;console.timeStamp&&console.timeStamp(r),jsStopwatch.markSpan(r,{annotations:s})}insertAfterTTI(e){this.ttiTracker.callAfterTTI((()=>evaluateScript(e,reportNonceMismatch)))}snapshotTimingProfile(){cpuIdleMonitor.stop();const e={idleCPUTime:cpuIdleMonitor.getIdleCPUTime(),totalTrackedCPUTime:cpuIdleMonitor.getTotalTrackedTime()},t=cpuIdleMonitor.getUntrackedTimeSinceTTFB();return t&&(e.untrackedTimeAfterFirstByte=t),e}showError(e){document.body.innerHTML='\n      <link href="https://cfl.dropboxstatic.com{\'/static/metaserver/static/css/font_paper_atlas_grotesk.css\'}" rel="stylesheet">\n    ';const t=document.createElement("div");t.id="dws-error",t.innerHTML=`\n      <div class="embedded-app__error-state">\n        <img alt="" src="https://assets.dropbox.com/www/en-us/illustrations/spot/target-miss.svg" />\n        <p>${this.errorStrings.sorryForTheHiccup}</p>\n        <p>\n          <a class="reload-link" href="#">\n            ${this.errorStrings.tryRefreshingYourPage}\n          </a>\n        </p>\n        <span id="debug_info"></span>\n      </div>\n    `,document.body.appendChild(t);const s=document.querySelectorAll(".embedded-app__error-state .reload-link");for(let e=0;e<s.length;e++)s[e].addEventListener("click",(()=>window.location.reload()))}setupPlaceholder(e,t,s,r,n,o,i){if(!this.prefetchedResourcesLoader.isDoneLoading())return void this.prefetchedResourcesLoader.addOnLoadCallback((()=>{this.setupPlaceholder(e,t,s,r,n,o,i)}));const a=new EventTracker;this._placeholderLoadedTrackerByElemId[s]=a,this._setupPagelet(e,t,!1,(()=>{}),(()=>a.markEvent()),r,n,o,i)}setupPagelet(e,t,s,r,n,o,i,a,l){if(!this.prefetchedResourcesLoader.isDoneLoading())return void this.prefetchedResourcesLoader.addOnLoadCallback((()=>{this.setupPagelet(e,t,s,r,n,o,i,a)}));const c=()=>{this._setupPagelet(e,t,s,r,(()=>null==l?void 0:l()),n,o,i,a)},d=this._placeholderLoadedTrackerByElemId[e];null!=d?d.callAfterEvent(c):c()}_setupPagelet(e,t,s,r,n,o,i,a,l){const c=validatePageletConfig(t);jsStopwatch.markSpan("dws_before_internal_setup_pagelet_uncached_"+c.name);const d={pagelet_client_load_time:(new Date).getTime()/1e3,pagelet_element_id:e,pagelet_name:t.name,repo_rev:o,served_by_hostname:i,yaps_project:a,yaps_deployment:l};let h;switch(t.driver){case"requirejs":h=new RequireJSPagelet(t,d,this);break;case"js_only":h=new JSOnlyPagelet(t,d,this);break;case"simple":h=new SimplePagelet(t,d);break;default:throw new Error(`unrecognized driver ${t.driver}`)}this.pageletsByElemId[e]=h,"embedded-app"===e&&(this._embeddedAppPagelet=h),h.initializeLoad(e,s,this.ttiTracker,n),r&&(s?this.ttiTracker.callAfterTTI(r):r())}loadCSS(e){new ResourceLoader({stylesheets:e})}getEmbeddedAppDOMInteractive(){if(!this._embeddedAppPagelet)throw new Error("Cannot get DOMInteractive, embedded app is not initialized");return this._embeddedAppPagelet.getDOMInteractive()}getPageletInfoForExceptionReporting(){const e=[];for(const t in this.pageletsByElemId)this.pageletsByElemId.hasOwnProperty(t)&&e.push(this.pageletsByElemId[t].exceptionInfo);return e}requestConstModule(e,t,s){this.constModules[t]||(this.constModules[t]={}),this.constModuleCallbacks[t]||(this.constModuleCallbacks[t]={}),e in this.constModules[t]?s(this.constModules[t][e]):(this.constModuleCallbacks[t][e]||(this.constModuleCallbacks[t][e]=[]),this.constModuleCallbacks[t][e].push(s))}defineConstModule(e,t,s){if(this.constModules[t]||(this.constModules[t]={}),e in this.constModules[t])return;this.constModules[t][e]=s;const r=this.constModuleCallbacks[t]&&this.constModuleCallbacks[t][e];if(r){for(const e of r)e(s);this.constModuleCallbacks[t][e]=[]}}processChunk(e,t,s){const r=window.performance&&window.location.search.indexOf("show_debug_spans")>-1;r&&window.performance.mark(`${e} ${t} processChunk start`);const n=jsStopwatch.getNow();s();const o=jsStopwatch.getNow();n&&o&&(cpuIdleMonitor.updateCPUTimes({forceUpdate:!0,currentCPUSpan:o-n}),jsStopwatch.markSpan(`dws-processChunk-${e}-${t}`,{startTime:n,endTime:o,annotations:cpuIdleMonitor.getCPUTimeSnapshot(o-n)})),r&&(window.performance.mark(`${e} ${t} processChunk end`),window.performance.measure(`${e} ${t} processChunk`,`${e} ${t} processChunk start`,`${e} ${t} processChunk end`))}preLoadJs(e,t){window.preLoadFile&&window.preLoadFile(e)}_hasOnlyClientHandledQueryParams(e){const t=e.split("&");for(const e of t){if(!(e.split("=")[0]in CLIENT_HANDLED_QUERY_PARAMS))return!1}return!0}_getCookieValue(e){const t=document.cookie.match("(^|; )"+e+"=([^;]*)");return t?t[2]:""}getCsrfToken(){return this._getCookieValue(this.jsCsrfCookieName)}getJSStopwatchData(){const e=jsStopwatch.getData();return window.timingCraftPrefetchStart&&(e.craft_fast_prefetch_start={end:window.timingCraftPrefetchStart,start:0,annotations:{}}),window.timingCraftPrefetchDone&&(e.craft_fast_prefetch_done={end:window.timingCraftPrefetchDone,start:0,annotations:{}}),e}}window.ensemble=new Ensemble})();