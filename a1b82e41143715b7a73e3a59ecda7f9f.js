(()=>{"use strict";const e=(e,t)=>{let n={type:1,left:e.offsetLeft+(e.offsetWidth-45)/2,top:e.offsetTop+(e.offsetHeight-45)/2,bottom:"auto",right:"auto"};t=Object.assign(Object.assign({},n),t),e.insertAdjacentHTML("afterend",'<span class="preloader v'+t.type+'"/>');let o=`width:45px; height:45px; position: absolute; left: ${t.left}px;top: ${t.top}px; z-index:999;`;e.parentElement.querySelector("span.preloader").style.cssText=o},t=e=>{e.parentElement.querySelector("span.preloader").remove()};const n=e=>{document.querySelector(e).addEventListener("submit",(e=>{let t=e.target;if(t.dataset.searched)return!0;t.dataset.searched="true";let n=t.querySelector("[type=search]").value,o=t.getAttribute("action"),i=encodeURI(n.replace(/\s+/g,"+"));return t.setAttribute("action",o+"?s="+i),t.dispatchEvent(new SubmitEvent("submit")),!1}))};window.addEventListener("DOMContentLoaded",(()=>{n(".search-form form"),window.loadMoreSearchResults&&((n,o,i)=>{const r=document.querySelector(n),a=document.querySelector(o);(i=Object.assign(Object.assign({},{url:!1,itemTpl:"tmpl_search_item",limit:10,inProduction:!1,page:!1,itemsCount:!1,pushState:!0}),i)).url||(i.url=r.getAttribute("href")),r.style.opacity="1",r.addEventListener("click",(n=>{if(n.preventDefault(),window.searchLocked)return!1;var o,s,l,c;window.searchLocked=!0,r.classList.add("blocked"),e(r,{left:530}),o=void 0,s=void 0,c=function*(){yield fetch(`${i.url}&type=ajax&aid`,{headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{let n=r.getAttribute("href").split("?"),o=new URLSearchParams(n[1]),s=!1;if(i.page){o.has("page")||o.set("page","1");let e=parseInt(o.get("page"))+1;o.set("page",e+"")}else{o.has("o")||o.set("o","0");let e=parseInt(o.get("o"))+parseInt(i.limit);o.set("o",e+"")}if(i.pushState&&"function"==typeof window.history.pushState&&window.history.pushState({},"",n.join("?")),i.inProduction&&("object"==typeof _gaq&&_gaq.push(["_trackPageview"],n.join("?")),"function"==typeof ga&&ga("send","pageview",n.join("?"))),i.itemsCount&&i.page?i.itemsCount<i.limit*parseInt(o.get("page"))&&(s=!0):i.itemsCount&&i.itemsCount<i.limit+parseInt(o.get("o"))&&(s=!0),e.length<i.limit||s?r.style.display="none":(n[1]=o.toString(),r.setAttribute("href",n.join("?")),i.url=n.join("?")),void 0!==e.length)for(let t=0;t<e.length;t++){let n=e[t];a.insertAdjacentHTML("beforeend",tmpl(i.itemTpl,n))}else for(let t in e){let n=e[t];a.insertAdjacentHTML("beforeend",tmpl(i.itemTpl,n))}return window.searchLocked=!1,r.classList.remove("blocked"),t(r),!0}))},new((l=void 0)||(l=Promise))((function(e,t){function n(e){try{r(c.next(e))}catch(e){t(e)}}function i(e){try{r(c.throw(e))}catch(e){t(e)}}function r(t){var o;t.done?e(t.value):(o=t.value,o instanceof l?o:new l((function(e){e(o)}))).then(n,i)}r((c=c.apply(o,s||[])).next())}))}))})(window.loadMoreSearchResults.trigger,window.loadMoreSearchResults.target,window.loadMoreSearchResults.options),window.bindAnotherSearchForm&&n(window.bindAnotherSearchForm)}))})();