!function(){"use strict";$(document).ready((function(){(Cookie.get("client_id")||Cookie.get("identity"))&&PublicAPI.call("UpgradeCookie_1","upgrade_id")}))}();var Dom={getText:function(e){return(e=elt(e))?e.textContent:""},setText:function(e,t){(e=elt(e))&&(e.textContent=t)},getValue:function(e){switch((e=elt(e)).type){case"checkbox":return e.checked?e.value:null;case"radio":var t=document.getElementsByName(e.name);for(let e=0,n=t.length;e<n;e++)if(t[e].checked)return t[e].value;return null}return e.value},setUnselectable:function(e){(e=elt(e))&&(e.style.userSelect="none")},focus:function(e){e=elt(e);try{e.focus()}catch(e){}},select:function(e,t){e=elt(e);try{e.select(),t&&e.focus()}catch(e){}},getDocumentHeight:function(){return document.documentElement["gecko"==Browser.type?"offsetHeight":"scrollHeight"]},wrapElem:function(e,t){return U.isString(t)&&(t=document.createElement(t)),$(t).insertBefore(e).append(e),t},scrollToElement:function(e,t,n){if(e.charAt&&"#"!=e.charAt(0)&&(e="#"+e),!(e=$(e)).length)return;e.parents().each((function(e,t){t.style&&"none"==t.style.display&&(t.style.display="")}));let a=document.scrollingElement;if(a||(a=document.documentElement&&null!=document.documentElement.scrollTop?document.documentElement:document.body),null==t&&(t=-10),n){const n=document.documentElement.clientHeight,i=e.height(),o=a.scrollTop,s=a.scrollTop+n,r=e.offset().top,l=e.offset().top+i;if(r>=o){if(l<s)return;t+=l-n}else t+=r}else t+=e.offset().top;$(a).animate({scrollTop:t},500)},hideEverythingStack:[],hideEverythingThanksAndroid:function(){if("androidbrowser"==Browser.make){const e=Array.prototype.slice.call(arguments);if(0==e.length)return;const t=$(".logView")[0];t&&e.push(t),$(this.hideEverythingStack[0]).css("visibility","inherit"),$(e).css("visibility","visible"),$(e).each((function(e,t){})),this.hideEverythingStack.unshift(e),$(document.body).css("visibility","hidden")}},unhideEverythingThanksAndroid:function(){if("androidbrowser"==Browser.make){const e=Array.prototype.slice.call(arguments),t=this.hideEverythingStack[0];let n=!1;if(t&&t.length>0&&$(e).each((function(e,a){$(t).each((function(e,t){n=n||a==t}))})),!n)return void Log.error("Elt not found unhiding for android fixup");this.hideEverythingStack.shift(),elems=this.hideEverythingStack[0]||document.body,$(elems).css("visibility","visible"),$(elems).each((function(e,t){}))}},hackLinkClicksThanksSafari:function(e,t){e=$(e),"iphone"==Browser.platform?e.on({touchend:function(e){const t=this.getAttribute("href");t&&"#"!=t.substring(0,1)&&this.setAttribute("href","#"+t)},click:function(e){const n=this.getAttribute("href");if(n&&"#"==n.substring(0,1)&&this.setAttribute("href",n.substring(1)),t)return t.apply(this,arguments)}}):t&&e.on("click",t)},inViewport:function(e){let t=e.offsetTop,n=e.offsetLeft;const a=e.offsetWidth,i=e.offsetHeight;for(;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+i>window.pageYOffset&&n+a>window.pageXOffset},getCursorPosition:function(e){let t,n=0;return document.selection?(e.focus(),t=document.selection.createRange(),t.moveStart("character",-e.value.length),n=t.text.length):void 0!==e&&void 0!==e.selectionStart&&(n=e.selectionStart),n},setCursorPosition:function(e,t){let n;e.setSelectionRange?(e.focus(),e.setSelectionRange(t,t)):e.createTextRange&&(n=e.createTextRange(),n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select())},getXY:function(e){if("none"==window.getComputedStyle(e).display)return!1;const t=e.ownerDocument,n=t.documentElement,a=t.body,i=Math.max(n.scrollLeft,a.scrollLeft),o=Math.max(n.scrollTop,a.scrollTop),s=e.getBoundingClientRect();return xy=new Array(2),xy[0]=Math.round(s.left+i),xy[1]=Math.round(s.top+o),xy}},TextFormat={currency:function(e,t,n,a,i){e.is_money&&(window.CurrencyData||Log.server("Missing CurrencyData for TextFormat.currency on "+window.location.pathname,"error"),t=window.CurrencyData.info[e.currency],e=e.amount/100);const o=t||{prefix:"$",symbol:"USD",places:2};let s=e>=1||0==e?o.places:2;a&&e>=1&&Math.round(e)==e&&(s=0);let r=e.toFixed(s);return n?r:(r=TextFormat.commafyNumber(r),o.symbol&&!i&&(r+=" "+o.symbol),o.prefix_utf8+r)},money:function(e,t,n){"use strict";window.CurrencyData||Log.server("Missing CurrencyData for TextFormat.money on "+window.location.pathname,"error"),e&&e.is_money&&("number"==typeof t&&(n=t),t=e.currency,e=e.amount/100),e=e||0,t=t||"USD",n=n||1;const a=CurrencyData.info[t];let i=a.places;e===Math.round(e)?2!==n&&7!==n&&9!==n||(i=0):0===i&&(i=2);let o=e.toFixed(i);return 5!==n&&8!==n&&9!==n&&(o=this.commafyNumber(o)),4===n&&"-"===o[0]&&(o="("+o.substr(1)+")"),1===n||2===n?o=a.prefix_utf8+o:6!==n&&7!==n||(o=a.prefix_utf8+" "+o),5===n&&(o=Array(8-o.length).join(" ")+o),o},formatMillions:function(e,t){"use strict";let n,a=Math.round(e),i=!1;"ja"===t?a>=100?(i=!0,e=a/100,a=Math.round(e)):(e*=100,a=Math.round(e)):a>=1e3&&(i=!0,e=a/1e3,a=Math.round(e));let o=!1;const s=parseFloat(e.toFixed(1)),r=parseFloat(e.toFixed(2));return s>=100?n=a:r>=10?n=s:(n=r,"de"===t||"es"===t?1===r&&(o=!0):r<2&&(o=!0)),{large:i,one:o,value:n}},million_usd:function(e,t){"use strict";const n="en"===t?"$":"",a=TextFormat.formatMillions(e,t);let i;switch(t){case"fr":i=a.large?a.one?" milliard de dollars":" milliards de dollars":a.one?" million de dollars":" millions de dollars";break;case"ja":i=a.large?"億ドル":"万ドル";break;case"de":i=a.large?a.one?" Milliarde Dollar":" Milliarden Dollar":a.one?" Million Dollar":" Millionen Dollar";break;case"es":i=a.large?" mil millones de dólares":a.one?" millón de dólares":" millones de dólares";break;case"pt":i=a.large?" mil milhões de dólares":a.one?" milhão de dólares":" milhões de dólares";break;default:i=a.large?" billion":" million"}return"fr"!==t&&"de"!==t&&"es"!==t&&"pt"!==t||(a.value=a.value.toString().replace(/\./g,",")),"".concat(n).concat(a.value).concat(i)},toMb:function(e,t){const n=t?1e3:1024;let a=1,i=n;const o=Iter.find([" bytes","K","MB","GB","TB","PB"],(function(){return e<i||(a=i,i*=n,!1)}));if(!o)return e.toString();const s=Math.round(e/a*10);return s%10==0?s/10+o:(s/10).toFixed(1)+o},pad:function(e,t,n){for(e=e.toString();parseInt(e,10)<n&&n>1;n/=10)e=t+e;return e},_determine_locale_separators:function(){1.2.toFixed(1).indexOf(".")>=0?TextFormat._separators={decimal:".",thousands:","}:TextFormat._separators={decimal:",",thousands:"."}},commafyNumber:function(e){TextFormat._separators||TextFormat._determine_locale_separators();const t=e.split(TextFormat._separators.decimal);let n=t[0];const a=t[1]?TextFormat._separators.decimal+t[1]:"";let i=!1;if(0==n&&!a)return"0";"-"===n.substr(0,1)&&(n=n.substr(1),i=!0);const o=n.length;let s="",r=0;for(;(o-r)%3>0;)s+=n.substr(r,1),r++;for(s.length>0&&o-r>0&&(s+=TextFormat._separators.thousands);o-r>3;)s+=n.substr(r,3)+TextFormat._separators.thousands,r+=3;return o-r>0&&(s+=n.substr(r)),(i?"-":"")+s+a},noOrphan:function(e){return e.replace(/([^ ]+) +([^ ]+)$/,"$1 $2")}};function addExpandEventListeners(e,t){$(e).off(".bcExpand").on("paste.bcExpand keyup.bcExpand focus.bcExpand",(function(e){updateFieldHeight(e,t)}))}function updateFieldHeight(e,t){const n=e.target,a=250,i=parseInt(n.clientHeight);let o=parseInt(n.scrollHeight);t?(n.style.height="auto",n.style.height=o>a?a+"px":n.scrollHeight+"px"):o>i&&(o>a&&(o=a),n.style.height=o+"px")}function addShrinkEventListeners(e,t){$(e).blur((function(e){shrinkFieldHeight(e,t)}))}function shrinkFieldHeight(e,t){const n=e.target;parseInt(n.scrollHeight)>t&&(n.style.height=t+"px")}function addCharacterCountdownEventListeners(e,t,n){function a(a){let i=n-$(e).val().length;$(t).toggleClass("notable",i<=0),i<0&&a&&($(e).val($(e).val().substr(0,n)),i=0),$(t).find(".counter").text(""+i)}$(e).on("input",(function(){a(!0)})),(!("oninput"in e)||"ie"===Browser.make&&Browser.version[0]<=9)&&$(e).on("paste cut keyup",(function(){setTimeout(a,0,!0)})),a(!1)}function InterruptibleTimer(){this._timer=null}InterruptibleTimer.prototype={start:function(e,t){this.stop(),this._timer=setTimeout(e,t)},stop:function(){clearTimeout(this._timer)}};var WatchInput={watchInput:function(e,t,n){$assert("string"==typeof e),null==this.__watching&&(this.__watching={});const a=this.__watching[e]={};a.__watchInput_elt=e,a.__watchInput_default=t,a.__watchInput_type=n||"float";const i=this;setTimeout((function(){i.__watchInput(e)}),500)},__watchInput:function(e){const t=this.__watching[e];if(!t)return;let n;const a=elt(t.__watchInput_elt);if(!a)return void(this.__watching[e]=null);const i=null==a.value?a.innerHTML:a.value;switch(t.__watchInput_type){case"float":var o=parseFloat(i);isNaN(o)&&(o=t.__watchInput_default);break;case"integer":o=parseInt(i);isNaN(o)&&(o=t.__watchInput_default);break;default:o=i}if(o!=t.__watchInput_Last&&this.inputChanged)try{this.inputChanged(o,t.__watchInput_elt)}catch(n){Log.error(n)}t.__watchInput_Last=o;const s=this;setTimeout((function(){s.__watchInput(e)}),500)}},Expression={eval:function(e,t,n){const a=this.init(e,t,n),i=this.parse_top(a);if("end"!=this.next_token(a).kind)throw"Expression error: '"+a.expr+"' -- end expected";return i},dump:function(e,t,n){const a=this.init(e,t,n);for(;;){const e=this.next_token(a);if(console.log(e.kind+" "+e.value),"end"==e.kind)break}},init:function(e,t,n){const a={};return a.expr=e,a.handle_constants=n,a.eval_lambda=t,a.return_prev_token=!1,a.short_circuit=!1,a},OPERATORS:["||","&&","<=","==","!=",">=","<",">","+","-","*","/","%","!","(",")"],next_token:function(e){if(e.return_prev_token)return e.return_prev_token=!1,e.previous_token;const t={};if(e.expr=e.expr.replace(/^\s+/,""),""==e.expr)t.kind="end";else{for(let n=0;n<this.OPERATORS.length;++n){const a=this.OPERATORS[n];if(e.expr.substr(0,a.length)==a){t.kind=a,e.expr=e.expr.slice(a.length);break}}if(!t.kind){let n;n=e.expr.match(/^(\'[^\']*\')/)||e.expr.match(/^(\"[^\"]*\")/)||e.expr.match(/([^\s\+\-\*\/\%\(\)\<\=\>\!\&\|\'\"]+)/),n&&(t.value=n[1],t.kind="term",e.expr=e.expr.slice(t.value.length))}}return e.previous_token=t,t},backup:function(e){e.return_prev_token=!0},is_true:function(e){return!1!==e&&null!=e},parse_top:function(e){return this.parse_boolean_op(e)},parse_boolean_op:function(e){let t=this.parse_comparison_op(e);for(;;)switch(this.next_token(e).kind){case"||":if(this.is_true(t)){var n=e.short_circuit;e.short_circuit=!0,this.parse_boolean_op(e),e.short_circuit=n}else t=this.parse_comparison_op(e);break;case"&&":if(this.is_true(t))t=this.parse_comparison_op(e);else{n=e.short_circuit;e.short_circuit=!0,this.parse_boolean_op(e),e.short_circuit=n}break;default:return this.backup(e),t}},parse_comparison_op:function(e){let t,n=this.parse_additive_op(e);for(;;)switch(t=this.next_token(e).kind){case"<":case"<=":case"==":case"!=":case">=":case">":n=this.evaluate_comparison(t,n,this.parse_additive_op(e));break;default:return this.backup(e),n}},evaluate_comparison:function(e,t,n){if("=="===e)return t&&t.is_money?n&&n.is_money&&t.currency===n.currency&&t.amount===n.amount:t==n;if("!="===e)return!this.evaluate_comparison("==",t,n);if(void 0!==t&&void 0!==n||Log.error("Expression: inequality comparison with an undefined operand will always return false"),t&&t.is_money){if(!n||!n.is_money)throw"money cannot be compared with non-money";if(t.currency!==n.currency)throw"money comparison currency mismatch";t=t.amount,n=n.amount}switch(e){case"<":return t<n;case">":return t>n;case"<=":return t<=n;case">=":return t>=n;default:throw"invalid comparison operator: "+e}},parse_additive_op:function(e){let t=this.parse_multiplicative_op(e);for(;;)switch(this.next_token(e).kind){case"+":t+=this.parse_multiplicative_op(e);break;case"-":t-=this.parse_multiplicative_op(e);break;default:return this.backup(e),t}},parse_multiplicative_op:function(e){let t=this.parse_term(e);for(;;)switch(this.next_token(e).kind){case"*":t*=this.parse_term(e);break;case"/":t/=this.parse_term(e);break;case"%":t%=this.parse_term(e);break;default:return this.backup(e),t}},parse_term:function(e){const t=this.next_token(e);let n;switch(t.kind){case"(":if(n=this.parse_top(e),")"!=this.next_token(e).kind)throw"Expression error: '"+e.expr+"' -- unbalanced parentheses";break;case"+":n=this.parse_term(e);break;case"-":n=-this.parse_term(e);break;case"!":n=!this.is_true(this.parse_term(e));break;case"term":if(!e.short_circuit){let a=e.handle_constants;if(a&&(a=this.constant(t.value),a&&(n=a.v)),!a){if(!e.eval_lambda)throw"Expression error: '"+e.expr+"' -- not a term";n=e.eval_lambda(t.value)}}}return e.short_circuit?1:n},constant:function(e){let t;return e.match(/^\d/)?e.match(/e|E|\./)?{v:parseFloat(e)}:{v:parseInt(e)}:(t=e.match(/^\'(.*)\'$/)||e.match(/^\"(.*)\"$/))?{v:t[1]}:"true"==e?{v:!0}:"false"==e?{v:!1}:"nil"==e?{v:null}:null}},StatusSpinny={spinnyID:"status-spinny",spinningClass:"spinning",timeouts:[],showQueue:[],showingQueue:!1,isShown:!1,spinny:function(e){let t=$("#"+StatusSpinny.spinnyID);return 0===t.length&&(t=$('<div id="'+StatusSpinny.spinnyID+'"></div>').appendTo(document.body)),"boolean"==typeof e&&t[e?"addClass":"removeClass"](StatusSpinny.spinningClass),t},show:function(e,t,n,a){void 0!==n&&null!=n||(n=""),StatusSpinny.resetTimeouts();const i=function(){StatusSpinny.isShown=!0,StatusSpinny.spinny(t).html(n).fadeIn(e),"number"==typeof a&&StatusSpinny.timeout(a)};StatusSpinny.isShown?StatusSpinny.scheduleShow(n,i):i()},scheduleShow:function(e,t){if(StatusSpinny.showQueue.push({message:e,fn:t}),!StatusSpinny.showingQueue){StatusSpinny.showingQueue=!0;var n=function(){StatusSpinny.hide(100,null,(function(){if(StatusSpinny.showQueue.length>2){const e=StatusSpinny.showQueue.shift();for(;StatusSpinny.showQueue.length>1&&e.message==StatusSpinny.showQueue[1].message;)StatusSpinny.showQueue=StatusSpinny.showQueue.slice(2);e.fn()}else{if(!(StatusSpinny.showQueue.length>0))return StatusSpinny.showingQueue=!1,null;StatusSpinny.showQueue.shift().fn()}window.setTimeout(n,1500)}))};n()}},wouldShowAfter:function(e,t,n,a,i){const o=StatusSpinny.timeoutId(),s=StatusSpinny.spinny();return s.on(o,(function(){StatusSpinny.show(t,n,a,i)})),window.setTimeout((function(){s.trigger(o)}),e),o},hide:function(e,t,n){void 0!==t&&"string"==typeof t&&StatusSpinny.spinny().off(t),void 0===e&&(e="fast"),StatusSpinny.spinny().fadeOut(e,n),StatusSpinny.isShown=!1},timeout:function(e){const t=StatusSpinny.timeoutId(),n=StatusSpinny.spinny();n.on(t,StatusSpinny.hide),StatusSpinny.timeouts.push(t),window.setTimeout((function(){n.trigger(t)}),e)},resetTimeouts:function(){for(;StatusSpinny.timeouts.length>0;)StatusSpinny.spinny().off(StatusSpinny.timeouts.shift())},timeoutId:function(){return(new Date).getTime()+""+Math.random()}},TaskQueue=function(){this.queue=[]};TaskQueue.prototype.addTask=function(e,t){this.queue.push({task:e,delay:t})},TaskQueue.prototype.run=function(){const e=this.queue.shift(),t=this;e&&setTimeout((function(){e.task(),t.run()}),e.delay)};var PromiseQueue=function(){this._queue=[]};PromiseQueue.prototype.add=function(e){this._queue.push(e),1===this._queue.length&&this.execute()},PromiseQueue.prototype.execute=function(){const e=this;if(0===this._queue.length)return;const t=this._queue[0];t().then((function(){e._queue.splice(e._queue.indexOf(t),1),e.execute()}))},function(){"use strict";const e=function(){this.handlers={};try{const e=window.location&&window.location.href&&new URL(window.location.href);this.debug=e&&e.searchParams&&e.searchParams.has("debugEvents")}catch(e){Log.server("url params error - "+e+" ua: "+navigator.userAgent,"error")}};e.prototype.subscribe=function(e,t){this.handlers[e]=this.handlers[e]||[],this.handlers[e].push(t)},e.prototype.publish=function(e,t){const n=this;this.debug&&Log.debug("event: "+e),n.handlers[e]&&n.handlers[e].forEach((function(e){e(t)}))},window.EventBus=e,window.BCEvents=new e}();var Identities=function(e){"use strict";const t=new function(t){const s=this;this.initialData=t,this.user=ko.observable(t.user),this.fan=ko.observable(t.fan),this.partner=ko.observable(t.partner),this.isAdmin=ko.observable(t.is_admin),this.ip_country_code=t.ip_country_code,this.pageBand=t.page_band&&new n(t.page_band),this.bmgr=new a(t.bands),this.lmgr=new o(t.labels),this.labels=this.lmgr.labels,this.labelIds=ko.computed((function(){return Iter.collect(s.labels(),(function(e){return e.id}))})),this.linkedNonLabelMemberBands=ko.computed((function(){return Iter.findAll(s.bmgr.bands(),(function(e){return!s.lmgr.isLabelMemberBand(e.id)}))})),this.linkedNonLabelBands=ko.computed((function(){return Iter.findAll(s.linkedNonLabelMemberBands(),(function(t){return-1===e.inArray(t.id,s.labelIds())}))})),this.hasLabels=ko.computed((function(){return s.labels().length>0})),this.pageBandParentLabel=ko.computed((function(){return Iter.find(s.labels(),(function(e){return e.id===t.page_band_parent_label_id}))}));const r=t.page_label&&new i(t.page_label);this.pageLabel=ko.computed((function(){return s.pageBandParentLabel()||s.pageBand&&s.labels()&&Iter.find(s.labels(),(function(e){return e.id===s.pageBand.id}))||r})),this.isPageBandMember=ko.observable(t.is_page_band_member),this.isPageBandNonLabelMember=ko.computed((function(){return s.pageBand&&Iter.find(s.bmgr.bands(),(function(e){return e.id==s.pageBand.id}))})),this.isParentLabel=ko.computed((function(){return!!s.pageBandParentLabel()})),this.hasFullAccess=ko.computed((function(){return s.isPageBandMember()||s.isAdmin()})),this.hasLimitedAccess=ko.computed((function(){return s.isParentLabel()&&t.page_band&&!t.page_band.authed})),this.isPageBand=function(e){return s.pageBand&&e===s.pageBand.id},this.isMemberOfBand=function(e){return s.bmgr.bandByID(e)||s.lmgr.isMemberBandAuthed(e)},this.activeLicenses=ko.observableArray(t.active_licenses),this.subscribedToPageBand=ko.observable(t.subscribed_to_page_band||!1),this.updateFromHash=function(e){e.bands&&s.bmgr.updateBands(Iter.collect(e.bands,(function(e){return new n(e)}))),e.page_band&&s.pageBand&&(e.page_band.name&&s.pageBand.name(e.page_band.name),e.page_band.photo&&s.pageBand.photo(e.page_band.photo),e.page_band.trackpipe_local_url&&s.pageBand.trackpipeLocalUrl(e.page_band.trackpipe_local_url)),s.isPageBandMember(e.is_page_band_member)},this.add=function(e){e.bands&&e.bands.length>0&&s.bmgr.addBands(e.bands),e.labels&&e.labels.length>0&&s.lmgr.addLabels(e.labels)},this.remove=function(e){e.bands&&e.bands.length>0&&s.bmgr.removeBands(e.bands),e.labels&&e.labels.length>0&&(s.lmgr.removeLabels(e.labels),s.bmgr.removeBands(e.labels))}}(U.pagedataBlob().identities||{});return t.BandVM=n,t.BandsMgr=a,window.ko&&window.ko.options.bindingGlobals&&(window.ko.options.bindingGlobals.Identities=t),t;function n(e){const t=this;this.id=e.id,this.name=ko.observable(e.name||""),this.photo=ko.observable(e.photo||e.bio&&e.bio.image_id),this.trackpipeUrl=ko.observable(e.trackpipe_url||e.url),this.trackpipeLocalUrl=ko.observable(e.trackpipe_local_url||e.url||e.trackpipe_url),this.trackpipeUrlHttps=ko.observable(e.trackpipe_url_https),this.dashboardUrl=ko.computed((function(){return t.trackpipeLocalUrl()+"/dashboard"})),this.isPro=ko.observable(e.is_pro),this.hasService=ko.observable(e.has_service),this.serviceName=ko.observable(e.service_name),this.serviceUrlFragment=ko.observable(e.service_url_fragment),this.isLabel=ko.observable(e.is_label),this.isLabelMemberBand=ko.observable(!1)}function a(e){const t=this;let a;this.addBands=function(e){let t,i;t=Iter.collect(e,(function(e){return e instanceof n?e:new n(e)})),i=[Number.MAX_VALUE,0].concat(t),a.splice.apply(a,i)},this.bandByID=function(e){return Iter.find(a(),(function(t){return t.id===e}))},this.removeBands=function(e){const t=Iter.findAll(a(),(function(t){return!!Iter.find(e,(function(e){return e===t.id}))}));a.removeAll(t)},this.updateBandName=function(e,n){const a=t.bandByID(e);a&&a.name(n)},this.updateBands=function(e){a(e)},a=ko.observableArray(Iter.collect(e||[],(function(e){return new n(e)}))),this.bands=ko.computed((function(){const e=a.slice(0);return e.sort((function(e,t){return(e=e.name().toLowerCase())<(t=t.name().toLowerCase())?-1:e>t?1:0})),e})).extend({throttle:1}),this.anyPro=ko.computed((function(){return!!Iter.find(a(),(function(e){return e.isPro()}))}))}function i(e){const t=this;this.id=e.id,this.name=ko.observable(e.name),this.url=ko.observable(e.url),this.memberBands=ko.observableArray(Iter.collect(e.member_bands,(function(e){const t=new n(e);return t.isLabelMemberBand(!0),t.isAuthed=ko.observable(e.authed),t.hasItems=ko.observable(e.band_has_items),t}))),this.memberBandIds=ko.computed((function(){return Iter.collect(t.memberBands(),(function(e){return e.id}))}))}function o(e){const t=this;this.labels=ko.observableArray(Iter.collect(e||[],(function(e){return new i(e)})));const n=ko.computed((function(){const e={};return Iter.each(t.labels(),(function(t){Iter.each(t.memberBands(),(function(t){e[t.id]=e[t.id]||t.isAuthed()}))})),e}));this.isMemberBandAuthed=function(e){return n()[e]},this.isLabelMemberBand=function(e){return e in n()},this.labelByID=function(e){return Iter.find(t.labels(),(function(t){return t.id===e}))},this.addLabels=function(e){const n=Iter.collect(e,(function(e){return new i(e)})),a=[Number.MAX_VALUE,0].concat(n);t.labels.splice.apply(t.labels,a)},this.removeLabels=function(e){Iter.each(e,(function(e){const n=t.labelByID(e);t.labels.remove(n)}))}}}(jQuery);!function(e){"use strict";var t={logoutAndRedirect:function(e){Crumb.ajax({url:"/api/login/1/logout",type:"POST",dataAs:"JSON",success:function(t){e?window.location.href=e:t.ok&&t.redirect_url?window.location.href=t.redirect_url:window.location.href=siteroot_https},error:function(t,n,a){window.location.href=e||siteroot_https}})},initialize:function(){e(".logout-action").click((function(){e(this).parents()[4]!=e("#menubar")[0]&&e(this).parents()[6]!=e("#menubar")[0]||Stats.record({kind:"click",click:"menubar_logout"});let n=null;return"corp_home"===e(this).data("logout-override")&&(n=siteroot_https),t.logoutAndRedirect(n),!1}))}};window.Logout=t,t.initialize()}(jQuery),function(){"use strict";const e=["electronic","metal","rock","alternative",{name:"hip-hop/rap",link:"hip-hop-rap"},"experimental","punk","pop","ambient",{name:"browse all",fulllink:"/#discover"}],t="Enter",n="Escape",a="ArrowUp",i="ArrowRight",o="ArrowLeft",s="ArrowDown",r=100;function l(e,t,n,a,i,o,s){const l={},c=n.resultsCache[[n.menubars[0].search.value.trim(),n.currentFilter]];switch(t){case"click":l.interaction_type=i,a&&(l.target=a),l.click_type=o,l.selected_index=s;break;case"search_query":var d;if(n.menubars[0].searchForm.classList.contains("has-results")){d=c.auto.results.length<=r?c.auto.results:c.auto.results.slice(0,r-1);const e=[];d.forEach((t=>{return e.push({type:(n=t).type,id:n.id});var n})),l.results=e}var p=n.menubars[0].autocompleteResults;p.classList.contains("genre-match")&&n.menubars[0].tagResult&&!n.menubars[0].tagResult.classList.contains("no-show")&&(l.genre_result=p.classList.contains("genre-match")?c.genre.match.genre:null);var u=n.get("desktop","tagResult")?n.get("desktop","tagResult").classList.contains("no-show"):n.get("mobile","tagResultMobile").classList.contains("no-show");l.tag_result=n.get("desktop","tagResult")||n.get("mobile","tagResultMobile")&&u?null:c.tag.matches[0].norm_name}l.feature="search-autocomplete",l.search_backend=e?"Elastic":"Fuzzy",l.query_text=n.menubars[0].search.value.trim(),l.n_results=c&&c.auto.results?c.auto.results.length:0,l.selected_filter=n.currentFilter?n.currentFilter:"all",window.BCTracker.record(t,l)}function c(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a=e?e.resultsCache[[e.menubars[0].search.value.trim(),e.currentFilter]]:null;let i=n;const o=a&&a.genre.match?a.genre.match.subgenre:null;!i&&a&&a.genre.match?i=a.genre.match.genre:!i&&a&&a.tag.matches&&(i=a.tag.matches[0].norm_name);const s={feature:"search-autocomplete",genre:i,subgenre:o,interaction:"discover_"+t};e&&a&&(s.query_text=e.menubars[0].search.value.trim(),s.n_results=a.auto.results.length),BCTracker.record("click",s)}window.BCMenubarSearch=function(){const r=this;r.makeArrow=function(){const e=document.createElement("span");return e.innerHTML='<svg class="arrow" viewBox="0 0 24 24"><use href="#discover-arrow"></svg>',e};const d=siteroot+"/tag/";let p;r.mobileCssFix=function(){document.body.classList.add("mobile-search-fix")},r.generateGenreList=function(e){r.get("desktop","genreList").innerHTML="",e.forEach((function(e){const t=document.createElement("li");t.className="simple";const n=document.createElement("a"),a=document.createElement("span");"string"==typeof e?(n.href=d+e,a.textContent=e,n.ariaLabel="browse "+e+" music"):(n.href=e.fulllink?siteroot+e.fulllink:d+e.link,"browse all"==e.name?(e.name=TM("browse all","pre"),n.ariaLabel=e.name+" music",n.addEventListener("click",(e=>r.discoverJump(e,r.genre,r.subgenre)))):n.ariaLabel="browse "+e.name+" music",a.textContent=e.name),n.appendChild(a),n.tabIndex="-1",n.addEventListener("keydown",r.keydown);const i=r.makeArrow(!0);n.appendChild(i),t.appendChild(n),r.get("desktop","genreList").appendChild(t)}))},r.genre=null,r.subgenre=null,r.discoverJump=function(e,t,n){const a=document.getElementById("discover");if(a){e.stopPropagation(),e.preventDefault(),c(r,t=t||"all",n,"scroll");let i=HomeControl.discoverVM.genres.pills().filter((function(e){return e.value==t}))[0];HomeControl.discoverVM.genres.selectPill(i),$("html, body").animate({scrollTop:a.offsetTop},1e3),n&&(i=HomeControl.discoverVM.subgenres.pills().filter((function(e){return e.value==n}))[0],HomeControl.discoverVM.subgenres.selectPill(i)),HomeControl.discoverVM.setupScrollers();const o=HomeControl.discoverVM.currentPage().items();o&&o.length>0&&(HomeControl.discoverVM.player.currentItem(o[0]),HomeControl.discoverVM.player.playlist.load([HomeControl.discoverVM.player.currentItem().featuredTrack])),r.hideAutocomplete()}else{let e="";e=window.siteroot_https+"?g="+t+"&t="+n,Identities.user()?e+="&from=menubar_explore_logged_in":e+="&from=menubar_explore_logged_out",e+="#discover",window.location.href=encodeURI(e),c(r,"genre-link")}},r.generateFilterList=function(e){r.menubars.forEach((function(t){t.filterList.innerHTML="",e.forEach((function(e){const n=document.createElement("li"),a=e.code?e.code:"x";n.classList.add("filter-link",a),e.code==r.currentFilter&&n.classList.add("selected-filter"),n.ariaLabel="display "+e.label+" results",n.textContent=e.label,e.code&&(n.dataset.code=e.code),n.addEventListener("keydown",r.keydown),n.tabIndex="-1",t.filterList.appendChild(n)}))}))},r.resultTypeString=function(e,t){switch(e){case"t":return TM("Track","pre");case"a":return TM("Album","pre");case"f":return TM("Fan","pre");case"b":return t?TM("Label","pre"):TM("Artist","pre");default:return""}},r.resultImgURL=function(e){return e.img_id?ImageUtils.imageURL(e.img_id,3):e.art_id?ImageUtils.artURL(e.art_id,3):e.img?e.img:null},r.makeResultItem=function(e,t,n){const a="b"==e.type||"f"==e.type,i=r.resultTypeString(e.type,e.is_label),o=e.name,s=e.band_name,l=r.resultImgURL(e),c=r.resultItemTemplate.content.cloneNode(!0),d=c.querySelector("a");let p="?from=search&"+e.stat_params;r.ES_search?(d.href=e.item_url_path||e.item_url_root,document.getElementById("menubar-vm")||document.getElementById("menubar-2018-phone")?Identities.user()?p+=n?"&logged_in_menubar=true":"&logged_in_mobile_menubar=true":p+=n?"&logged_out_menubar=true":"&logged_out_mobile_menubar=true":document.getElementById("header-wrapper")&&(p+="&corp_header=true"),d.href+=p):(d.href=e.url,document.getElementById("menubar-vm")||document.getElementById("menubar-2018-phone")?Identities.user()?p+=n?"&logged_in_menubar=true":"&logged_in_mobile_menubar=true":p+=n?"&logged_out_menubar=true":"&logged_out_mobile_menubar=true":document.getElementById("header-wrapper")&&(p+="&corp_header=true"),d.href+=p),d.ariaLabel=i+" result: "+o+("b"==e.type||"f"==e.type?"":" by "+s),d.dataset.itemIndex=t,d.dataset.itemID=e.id,d.dataset.itemType=e.type,d.addEventListener("keydown",r.keydown);const u=c.querySelector("a .result-art");a&&u.classList.add("round-art");const m=c.querySelector("a .result-art img");l?m.src=l:m.remove();c.querySelector("a .result-title strong").textContent=o;const h=c.querySelector("a cite");"a"==e.type||"t"==e.type?h.textContent=TM("by {{artist_name}}","pre",{artist_name:s}):h.remove();return c.querySelector("a .result-type").textContent=i,c},r.currentSearchTerm=function(){return r.menubars[0].search.value.trim()},r.updateAutocompleteResults=function(e,t){r.menubars.forEach((function(n){if(n.autocompleteResults.querySelectorAll(".result-item").forEach((function(e){e.remove()})),"desktop"==n.type)if(t.genre&&t.genre.match){r.genre=t.genre.match.genre,r.subgenre=t.genre.match.subgenre;const e=n.autocompleteResults.querySelector(".results-genre a"),a="/?g="+encodeURIComponent(r.genre)+(r.subgenre?"&t="+encodeURIComponent(r.subgenre):"")+"#discover";e.href=siteroot+a,e.ariaLabel="browse "+(r.subgenre?r.subgenre:r.genre)+" music";n.autocompleteResults.querySelector(".results-genre .msg").textContent=TM("Explore {{genre}} music","pre",{genre:r.subgenre?r.subgenre:r.genre}),n.autocompleteResults.classList.add("genre-match")}else n.autocompleteResults.classList.remove("genre-match");const a=t.auto.results;for(let e=0;e<a.length;e++){const t=r.makeResultItem(a[e],e,"desktop"==n.type);n.autocompleteResults.insertBefore(t,n.seeAll),n.autocompleteResults.children[e].addEventListener("click",(function(e){r.handleResults(e)}))}0===a.length?(n.seeAll.classList.add("no-show"),n.noResults.classList.remove("no-show")):(n.seeAll.classList.remove("no-show"),n.noResults.classList.add("no-show"));const i=n.seeAll.querySelector("a");if(i.href="/search?from=autocomplete&q="+encodeURIComponent(e),r.currentFilter){const e="&item_type="+encodeURIComponent(r.currentFilter);i.href+=e}let o=null;if(t.tag.matches&&t.tag.matches.length>0&&!n.autocompleteResults.classList.contains("genre-match")&&(r.ES_search||function(e,t){const n=[],a=e.length,i=t.length;if(0===a)return i;if(0===i)return a;for(var o=a;o>=0;o--)n[o]=[];for(o=a;o>=0;o--)n[o][0]=o;for(var s=i;s>=0;s--)n[0][s]=s;for(o=1;o<=a;o++){const r=e.charAt(o-1);for(s=1;s<=i;s++){if(o==s&&n[o][s]>4)return a;const i=t.charAt(s-1),l=r==i?0:1;let c=n[o-1][s]+1;const d=n[o][s-1]+1,p=n[o-1][s-1]+l;d<c&&(c=d),p<c&&(c=p),n[o][s]=c,o>1&&s>1&&r==t.charAt(s-2)&&e.charAt(o-2)==i&&(n[o][s]=Math.min(n[o][s],n[o-2][s-2]+l))}}return n[a][i]}(t.tag.matches[0].display_name,e)<3)&&(o=t.tag.matches[0]),o){let e=null;"desktop"==n.type?(n.tagResult.classList.remove("no-show"),e=n.autocompleteResults.querySelector(".results-tags a")):(n.tagResultMobile.classList.remove("no-show"),e=n.searchForm.querySelector(".mobile-results-tags a"),n.autocompleteResults.classList.add("tag-room"));let a=encodeURIComponent(o.norm_name);a+="?from=search&",a+=t.auto.stat_params_for_tag?t.auto.stat_params_for_tag:"",e.href=d+a,e.ariaLabel="explore music tagged with "+o.display_name;e.querySelector(".msg").textContent=TM("Music tagged with “{{tagname}}”","pre",{tagname:o.display_name.toLowerCase()})}else"desktop"==n.type?n.tagResult.classList.add("no-show"):(n.tagResultMobile.classList.add("no-show"),n.autocompleteResults.classList.remove("tag-room"))}))},r.resultsCache={},r.fetch=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;r.menubars.forEach((function(e){e.searchForm.classList.add("pending"),"mobile"==e.type&&(e.autocompleteResults.scrollTop=e.autocompleteResults.scrollTop)})),r.handleAriaBusy("true");const n=r.ES_search?"autocomplete_elastic":"autocomplete_fuzzy",a=r.ES_search?{search_text:e,search_filter:r.currentFilter?r.currentFilter:"",full_page:!1,fan_id:null}:{search_text:e,search_filter:r.currentFilter?r.currentFilter:"",dark_loading:r.ES_dark_loading};BCAPI.call("BCSearchPublicAPI_1",n,a).then((function(n){if(!n.auto||1==n.auto.ac_error)return r.menubars.forEach((function(e){e.searchForm.classList.remove("pending")})),r.handleAriaBusy("false"),void console.log("problem fetching autocomplete data. status: "+n);r.resultsCache[[e,r.currentFilter]]=n;const a=r.currentSearchTerm();if(e==a){if(r.updateAutocompleteResults(e,n),r.menubars.forEach((function(e){e.searchForm.classList.add("has-results"),e.searchForm.classList.remove("pending")})),r.handleAriaBusy("false"),m&&t){let e="click";"keydown"==t.type&&(e="enter");const n=t.target.innerText;l(r.ES_search,"click",r,"filter-"+n,e,"filter")}l(r.ES_search,"search_query",r)}}))},r.doSearch=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=r.resultsCache[[e,r.currentFilter]];n?(r.get("mobile","autocompleteResults")&&(r.get("mobile","autocompleteResults").scrollTop=0),r.updateAutocompleteResults(e,n),r.menubars.forEach((function(e){e.searchForm.classList.add("has-results")}))):r.fetch(e,t)},r.hideAutocomplete=function(){const e=document.getElementById("menubar-2018-phone");e&&e.querySelector(".mobile-searchbar-2018").classList.add("no-show"),r.blurred=!0,document.body.classList.remove("search-active","mobile-search-active"),document.removeEventListener("focusin",r.checkFocus),r.clearSelection(!0)},r.activateAutocomplete=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=r.get("mobile","menubar");n&&n.querySelector(".mobile-searchbar-2018").classList.remove("no-show");let a=r.menubars[0].search.value.trim();if(1==t){r.MobileResultsSize(),r.handleMobileResultsSize();a=r.get("mobile","search").value.trim(),r.menubars.length>1&&(r.get("desktop","search").value=r.get("mobile","search").value),document.body.classList.add("mobile-search-active")}else r.menubars.length>1&&(r.get("mobile","search").value=r.get("desktop","search").value);r.clearSelection(),r.blurred=!1,a&&a.length>0?(t||"f"!=r.currentFilter||r.resetFilters(),r.doSearch(a,e)):(r.clear(),r.menubars.forEach((function(e){e.searchForm.classList.remove("pending")})),r.handleAriaBusy("false")),r.get("desktop","searchForm")&&document.addEventListener("focusin",r.checkFocus),document.body.classList.add("search-active")},r.nextPrevVisible=function(e,t){for(;e;){if("none"!=window.getComputedStyle(e).getPropertyValue("display"))return e;e=t?e.nextElementSibling:e.previousElementSibling}return null},r.selectNext=function(){const e=r.get("desktop","searchForm").querySelector("body.search-active .menubar-search:not(.has-results) .genre-list, body.search-active .has-results .search-autocomplete");if(!e)return;let t=null,n=e.querySelector("li a.selected"),a=null;if(n)a=n.parentNode.nextElementSibling;else{if(r.get("desktop","searchForm").classList.contains("has-results")){if(n=r.get("desktop","filterList").querySelector("li.selected"),!n)return r.get("desktop","filterList").children[0].focus(),r.get("desktop","filterList").children[0].parentElement.classList.add("key-nav"),r.get("desktop","filterList").children[0].classList.add("selected");{n.parentElement.classList.remove("key-nav"),n.classList.remove("selected");const e=r.nextPrevVisible(n.nextElementSibling,!0);if(e)return e.focus(),e.parentElement.classList.add("key-nav"),e.classList.add("selected")}}a=e.querySelector("li")}a=r.nextPrevVisible(a,!0),t=a&&a.querySelector("a"),t?(n&&(n.parentElement.classList.remove("key-nav"),n.classList.remove("selected")),t.focus(),t.parentElement.classList.add("key-nav"),t.classList.add("selected")):(n&&(n.parentElement.classList.remove("key-nav"),n.classList.remove("selected")),r.get("desktop","search").focus())},r.selectPrev=function(){const e=r.get("desktop","searchForm").querySelector("body.search-active .menubar-search:not(.has-results) .genre-list, body.search-active .has-results .search-autocomplete");if(!e)return;let t=null,n=e.querySelector("li a.selected");if(n){var a=n.parentNode.previousElementSibling;a=r.nextPrevVisible(a,!1),n.parentElement.classList.remove("key-nav"),n.classList.remove("selected"),t=a&&a.querySelector("a")}else{if(!r.get("desktop","filterList").querySelector("li.selected")&&r.get("desktop","searchForm").classList.contains("has-results"))return void(r.get("desktop","autocompleteResults").classList.contains("genre-match")?(r.get("desktop","genreResult").querySelector("a").focus(),r.get("desktop","genreResult").classList.add("key-nav"),r.get("desktop","genreResult").querySelector("a").classList.add("selected")):r.get("desktop","tagResult").classList.contains("no-show")?(r.get("desktop","seeAll").querySelector("a").focus(),r.get("desktop","seeAll").classList.add("key-nav"),r.get("desktop","seeAll").querySelector("a").classList.add("selected")):(r.get("desktop","tagResult").querySelector("a").focus(),r.get("desktop","tagResult").classList.add("key-nav"),r.get("desktop","tagResult").querySelector("a").classList.add("selected")));r.get("desktop","searchForm").classList.contains("has-results")||(e.lastChild.querySelector("a").focus(),e.lastChild.classList.add("key-nav"),e.lastChild.querySelector("a").classList.add("selected"))}if(t)t.focus(),t.parentElement.classList.add("key-nav"),t.classList.add("selected");else{if(r.get("desktop","searchForm").classList.contains("has-results")){if(n=r.get("desktop","filterList").querySelector("li.selected"),!n){const e=r.nextPrevVisible(r.get("desktop","filterList").lastChild,!1);return e.focus(),e.parentElement.classList.add("key-nav"),e.classList.add("selected")}if(n.parentElement.classList.remove("key-nav"),n.classList.remove("selected"),n.previousElementSibling)return n.previousElementSibling.focus(),n.previousElementSibling.parentElement.classList.add("key-nav"),n.previousElementSibling.classList.add("selected");r.get("desktop","search").focus()}else document.activeElement!=r.get("desktop","search")&&document.activeElement!=r.get("desktop","genreList").lastChild.querySelector("a")&&r.get("desktop","search").focus();a=e.querySelector("li")}},r.clearSelection=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];r.menubars.forEach((function(t){if(t.searchForm.querySelectorAll("ul li a.selected").forEach((function(e){e.parentElement.classList.remove("key-nav"),e.classList.remove("selected")})),e){t.filterList.classList.remove("key-nav");t.filterList.querySelectorAll("li.selected").forEach((function(e){e.classList.remove("selected")}))}}))},r.keydown=function(e){if(e.isComposing)return e.preventDefault();switch(e.code){case s:"INPUT"===e.target.tagName&&e.shiftKey||(r.selectNext(),e.preventDefault());break;case a:"INPUT"===e.target.tagName&&e.shiftKey||(r.selectPrev(),e.preventDefault());break;case n:r.clearSelection(),r.hideAutocomplete(),e.preventDefault();break;case i:e.target.classList.contains("dismiss-tooltip-alt")||(r.selectNext(),e.preventDefault());break;case o:e.target.classList.contains("dismiss-tooltip-alt")||(r.selectPrev(),e.preventDefault());break;case t:{const t=e.target.classList,n=r.get("desktop","filterList").querySelector(".selected");t&&t.contains("filter-link")&&(n?r.handleFilters(null,n.dataset.code):r.menubars[0].searchForm.submit());break}}},r.submit=function(e){const t=r.get("desktop","filterList").querySelector(".selected");t&&(r.handleFilters(null,t.dataset.code),e.preventDefault());const n=r.get("desktop","searchForm").querySelector("a.selected");n&&(window.location.href=n.href,e.preventDefault()),r.trackSearchSubmit(r,e)},r.resetFilters=function(){r.currentFilter=null,r.menubars.forEach((function(e){Array.from(e.filterList.children).forEach((e=>{e.dataset.code?e.classList.remove("selected-filter"):e.classList.add("selected-filter")}))}))},r.clear=function(){r.menubars.forEach((function(e){e.autocompleteResults.querySelectorAll(".result-item").forEach((function(e){e.remove()})),e.autocompleteResults.classList.remove("genre-match"),e.searchForm.classList.remove("has-results","pending"),e.search.value="",e.searchForm.children[0].focus(),r.resetFilters(),"mobile"==e.type&&e.tagResultMobile.classList.add("no-show")}))};const u=500;r.handleInput=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];clearTimeout(p),1==r.menubars.length?r.menubars[0].search.value.trim().length>0&&1==e?p=setTimeout((function(){r.activateAutocomplete(null,!0)}),u):r.menubars[0].search.value.trim().length>0&&1!=e?p=setTimeout(r.activateAutocomplete,u):r.activateAutocomplete(null,1==e):r.menubars.length>1?r.get("mobile","search").value.trim().length>0&&1==e?p=setTimeout((function(){r.activateAutocomplete(null,!0)}),u):r.get("desktop","search").value.trim().length>0&&1!=e?p=setTimeout(r.activateAutocomplete,u):r.activateAutocomplete(null,1==e):r.activateAutocomplete(null,1==e)};var m=!1;r.handleFilters=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e&&e.preventDefault();const n=e?e.target.dataset.code:t,a=r.currentFilter;!n&&!a||n&&n==a||r.menubars[0].searchForm.classList.contains("pending")||(r.currentFilter=n||null,r.menubars.forEach((function(e){Array.from(e.filterList.children).forEach((e=>{e.classList.remove("selected-filter"),n!=e.dataset.code&&(n||e.dataset.code)||e.classList.add("selected-filter")})),e.selectedFilter.value=r.currentFilter})),e&&r.menubars[0].search.value.trim().length>0?e.composedPath().some((e=>e.classList&&e.classList.contains("mobile-searchbar-2018")))?r.activateAutocomplete(e,!0):r.activateAutocomplete(e):e||r.activateAutocomplete())},r.handleResults=function(e){if(r.menubars[0].searchForm.classList.contains("pending"))return e.preventDefault(),void e.stopPropagation();if(document.activeElement.dataset.itemType&&document.activeElement.dataset.itemID&&document.activeElement.dataset.itemIndex){const e={type:document.activeElement.dataset.itemType,id:document.activeElement.dataset.itemID};l(r.ES_search,"click",r,e,"click","result-item",document.activeElement.dataset.itemIndex)}},r.clickIcon=function(e){e.preventDefault(),r.activateAutocomplete(),r.menubars.forEach((function(e){e.searchForm.children[0].focus()})),e.stopPropagation(),r.handleMobileResultsSize()};const h=function(e,t){return e.composedPath().some((e=>e.classList&&e.classList.contains(t)))};r.checkFocus=function(e){return h(e,"menubar-search")?null:r.hideAutocomplete()},r.handleFocus=function(e){const t=r.get("desktop","searchForm").querySelector("body.search-active .menubar-search:not(.has-results) .genre-list, body.search-active .has-results .search-autocomplete"),n=!h(e,"mobile-searchbar-2018")&&!h(e,"menubar-search")&&!h(e,"menubar-search-icon");t&&n&&r.hideAutocomplete(),t&&!n&&r.menubars[0].searchForm.classList.contains("pending")&&(e.preventDefault(),e.stopPropagation())};let f=null;r.handleClearSelection=function(){r.menubars[0].search.value.trim()===document.getSelection().toString().trim()&&(f=document.getSelection().toString(),document.addEventListener("mouseup",r.handleHighlightedText),document.addEventListener("keyup",r.handleHighlightedText),r.menubars.forEach((function(e){e.search.addEventListener("input",r.handleHighlightedText)})))},r.handleHighlightedText=function(e){document.removeEventListener("mouseup",r.handleHighlightedText),document.removeEventListener("keyup",r.handleHighlightedText),r.menubars.forEach((function(e){e.search.removeEventListener("input",r.handleHighlightedText)})),"input"===e.type&&(r.currentFilter=null,f=null,r.resetFilters(),m&&l(r.ES_search,"click",r,null,"clear-selection","clear"))},r.handleAriaBusy=function(e){r.menubars.forEach((function(t){t.searchForm.ariaBusy=e,t.searchForm.querySelector(".loading-icon").ariaBusy=e,t.filterList.ariaBusy=e,t.autocompleteResults.ariaBusy=e,"desktop"==t.type&&(t.genreList.ariaBusy=e)}))},r.currentFilter=null,r.phoneNoSubmit=function(e){e.preventDefault(),e.stopPropagation()},r.init=function(t){r.cfg=t,r.ES_search=!!t.use_elasticsearch_backed_search,r.ES_dark_loading=!!t.es_dark_loading,m=r.cfg&&r.cfg.search_tracking&&window.ClientID;const n=[{label:TM("all","pre"),code:null},{label:TM("artists & labels","pre"),code:"b"},{label:TM("albums","pre"),code:"a"},{label:TM("tracks","pre"),code:"t"},{label:TM("fans","pre"),code:"f"}];window.BCTracker||Log.error("BCMenubar used on page without Tracker_1 page element");const a=document.getElementById("header-wrapper"),i=document.getElementById("menubar-wrapper")||a,o=document.getElementById("menubar-2018-phone");if(r.resultItemTemplate=document.getElementById("autocomplete-results-item"),r.menubars=[],r.get=function(e,t){let n=null;return r.menubars.forEach((function(a){a.type==e&&(n=a[t])})),n},i&&r.menubars.push({menubar:i,type:"desktop"}),o){r.menubars.push({menubar:o,type:"mobile"});const e=o.querySelector("form.menubar-search");e&&(e.removeEventListener("submit",r.phoneNoSubmit),e.addEventListener("submit",r.phoneNoSubmit))}r.menubars.forEach((function(t){t.searchForm=t.menubar.querySelector("form.menubar-search"),t.searchForm&&(t.search=t.menubar.querySelector("form.menubar-search input"),t.filterList=t.menubar.querySelector("form.menubar-search .filter-list"),t.selectedFilter=t.menubar.querySelector("input.selected-filter"),t.autocompleteResults=t.menubar.querySelector("form.menubar-search .search-autocomplete"),t.searchIcon=t.menubar.querySelector(".search-link"),t.noResults=t.autocompleteResults.querySelector(".autocomplete-no-results"),t.seeAll=t.autocompleteResults.querySelector(".results-see-all"),"mobile"==t.type?(t.cancelSearch=t.menubar.querySelector(".cancel-autocomplete"),t.clearSearch=t.menubar.querySelector("form.menubar-search .clear-autocomplete"),t.tagResultMobile=t.searchForm.querySelector(".mobile-results-tags")):(t.genreList=t.menubar.querySelector("form.menubar-search .genre-list"),t.genreResult=t.autocompleteResults.querySelector(".results-genre"),t.tagResult=t.autocompleteResults.querySelector(".results-tags")),t.search.removeEventListener("input","mobile"==t.type?function(){r.handleInput(!0)}:r.handleInput),t.filterList.removeEventListener("click",r.handleFilters),t.search.removeEventListener("select",r.handleClearSelection),t.search.addEventListener("input","mobile"==t.type?function(){r.handleInput(!0)}:r.handleInput),t.filterList.addEventListener("click",r.handleFilters),t.search.addEventListener("select",r.handleClearSelection),"desktop"==t.type&&(t.search.removeEventListener("focus",r.activateAutocomplete),t.search.addEventListener("focus",r.activateAutocomplete),t.searchForm.removeEventListener("submit",r.submit),t.searchForm.addEventListener("submit",r.submit),t.genreResult.removeEventListener("click",(function(e){r.discoverJump(e,r.genre,r.subgenre)})),t.genreResult.addEventListener("click",(function(e){r.discoverJump(e,r.genre,r.subgenre)})),t.tagResult.removeEventListener("click",(function(){c(r,"tag-link")})),t.tagResult.addEventListener("click",(function(){c(r,"tag-link")})),t.search.removeEventListener("click",(function(e){r.activateAutocomplete(),e.stopPropagation()})),t.search.addEventListener("click",(function(e){r.activateAutocomplete(),e.stopPropagation()})),t.search.removeEventListener("keydown",r.keydown),t.search.addEventListener("keydown",r.keydown),t.tagResult.querySelector("a").removeEventListener("keydown",r.keydown),t.genreResult.querySelector("a").removeEventListener("keydown",r.keydown),t.seeAll.querySelector("a").removeEventListener("keydown",r.keydown),t.tagResult.querySelector("a").addEventListener("keydown",r.keydown),t.genreResult.querySelector("a").addEventListener("keydown",r.keydown),t.seeAll.querySelector("a").addEventListener("keydown",r.keydown),t.genreList.removeEventListener("click",(function(e){const t=e.target;t&&c(null,"top-level-genre-link",t.textContent)})),t.genreList.addEventListener("click",(function(e){const t=e.target;t&&c(null,"top-level-genre-link",t.textContent)})),r.generateGenreList(e)),"mobile"==t.type&&(t.clearSearch.removeEventListener("click",r.clear),t.clearSearch.addEventListener("click",r.clear),t.cancelSearch.removeEventListener("click",(function(e){if("/search"!==window.location.pathname)r.clear(),r.resetMobileResultsSize(),r.hideAutocomplete(),document.activeElement.blur(),clearTimeout(p),e.stopPropagation();else{const t=document.referrer;window.location.href=encodeURI(t&&""!=t?document.referrer:window.location.origin),e.stopPropagation()}})),t.cancelSearch.addEventListener("click",(function(e){if("/search"!==window.location.pathname)r.clear(),r.resetMobileResultsSize(),r.hideAutocomplete(),document.activeElement.blur(),clearTimeout(p),e.stopPropagation();else{const t=document.referrer;window.location.href=encodeURI(t&&""!=t?document.referrer:window.location.origin),e.stopPropagation()}})),t.tagResultMobile.removeEventListener("click",(function(e){if(t.searchForm.classList.contains("pending"))return e.preventDefault(),void e.stopPropagation();c(r,"tag-link")})),t.tagResultMobile.addEventListener("click",(function(e){if(t.searchForm.classList.contains("pending"))return e.preventDefault(),void e.stopPropagation();c(r,"tag-link")})),t.search.removeEventListener("click",(function(e){r.activateAutocomplete(null,!0),e.stopPropagation()})),t.search.addEventListener("click",(function(e){r.activateAutocomplete(null,!0),e.stopPropagation()}))),t.searchIcon&&(t.searchIcon.removeEventListener("click",r.clickIcon),t.searchIcon.addEventListener("click",r.clickIcon)))})),r.blurred=!0,r.get("mobile","autocompleteResults")&&(r.get("mobile","autocompleteResults").scrollTop=0),r.menubars.some((e=>!e.searchForm))||(r.generateFilterList(n),r.get("desktop","searchForm")&&(document.removeEventListener("click",r.handleFocus),document.addEventListener("click",r.handleFocus)),r.MobileResultsSize=function(){document.documentElement.style.setProperty("--mobile-results-height","calc("+window.innerHeight.toString()+"px - 100px)"),document.documentElement.style.setProperty("--mobile-results-height-tag","calc("+window.innerHeight.toString()+"px - 150px)"),document.documentElement.style.setProperty("--mobile-results-text-width","calc("+window.innerWidth.toString()+"px - 73px)")},r.MobileScrollFocus=function(){document.activeElement.blur()},r.handleMobileResultsSize=function(){window.addEventListener("resize",r.MobileResultsSize),window.addEventListener("scroll",r.MobileScrollFocus),r.MobileResultsSize()},r.resetMobileResultsSize=function(){document.documentElement.style.setProperty("--mobile-results-height","calc(100vh - 101px)"),document.documentElement.style.setProperty("--mobile-results-height-tag","calc(100vh - 152px)"),window.removeEventListener("resize",r.MobileResultsSize),window.removeEventListener("scroll",r.MobileScrollFocus)},window.initiatedAutocomplete=!0,window.AutocompleteController=this)},r.trackSearchSubmit=function(e,t){let n=!0;return n="submit"==t.type?""!=t.target.elements.q.value.trim()&&""!=r.menubars[0].search.value.trim():""!=r.menubars[0].search.value.trim(),n&&m&&l(r.ES_search,"click",e,"submit-search",null,"submit-search"),n}}}();var NotificationCenterVM=function(e,t){"use strict";return e((function(){let t;window.initializeNotificationCenter=function(a){return Log.debug("initializing notifications"),t=new n,e("#notification-center-container .messages").scroll((function(){e("#notification-center-container .messages").scrollTop()>=e("#notification-center-container .message-container").height()-250&&t.paginate()})),e(document).click((function(){t.show(!1)})),window.MediaView&&"phone"==MediaView.mode||e(document).scroll((function(){t.show(!1)})),e(".notification-center-menubar-button").on("mouseover",(function(){t.firstLoad()})),e(".notification-center-menubar-button").click((function(e){return e.stopPropagation(),t.show(!t.show()),t.show()&&(a.publish("notificationCenter.open"),t.firstLoad()),!1})),t}}));function n(){const e=this;this.show=t.observable(!1),this.messages=t.observableArray([]),this.oldestId=t.pureComputed((function(){return e.messages()[e.messages().length-1]?e.messages()[e.messages().length-1].id:null})),this.newestId=t.pureComputed((function(){return e.messages()[0]?e.messages()[0].id:null})),this.markAllAsRead=function(){BCAPI.call("PushNotificationPublicAPI_1","mark_menubar_activity_read",{user_id:Identities.user().id},!0).fail((function(){console.log("oops")})).fail(BCAPI.makeFailureAlert({OopsError:TM("I made an oops.")})).done((function(){BCEvents.publish("notificationCenter.markAllAsRead"),Iter.collect(e.messages(),(function(e){e.unread(!1)}))}))},this.hasMoreOldMessages=t.observable(!0),this.loaded=t.observable(!1),this.firstLoad=function(){e.loaded()||(e.loaded(!0),Identities.user()&&BCAPI.call("PushNotificationPublicAPI_1","get_menubar_activity",{user_id:Identities.user().id},!0).fail((function(){console.log("oops")})).done((function(t){Iter.collect(t.activity,(function(t){e.messages.push(new a(t))})),e.hasMoreOldMessages(t.has_more)})))},this.paginating=t.observable(!1),this.empty=t.pureComputed((function(){return e.loaded()&&0===e.messages().length})),this.paginate=function(){!e.paginating()&&e.hasMoreOldMessages()&&(e.paginating(!0),BCAPI.call("PushNotificationPublicAPI_1","get_menubar_activity",{user_id:Identities.user().id,before_id:e.oldestId()}).fail((function(){console.log("oops"),e.hasMoreOldMessages(!1),e.paginating(!1)})).done((function(t){Iter.collect(t.activity,(function(t){e.messages.push(new a(t))})),e.hasMoreOldMessages(t.has_more),e.paginating(!1)})))},this.refreshing=t.observable(!1),this.refresh=function(){e.refreshing()||BCAPI.call("PushNotificationPublicAPI_1","get_menubar_activity",{user_id:Identities.user().id,after_id:e.newestId()}).fail((function(){console.log("oops"),e.refreshing(!1)})).done((function(t){Iter.collect(t.activity.reverse(),(function(t){e.messages.unshift(new a(t))})),e.refreshing(!1),t.has_more&&t.activity.length<5&&e.refresh()}))}}function a(e){this.id=e.id,this.fanName=e.data.fan_name,this.fanImageId=e.data.fan_image_id&&ImageUtils.imageURL(e.data.fan_image_id,3),this.messageUrl=Url.addQueryParams(e.data.message_url,{from:"com-not"}),this.recipientName=Identities.bmgr.bandByID(e.data.band_id)&&Identities.bmgr.bandByID(e.data.band_id).name,this.unread=t.observable(e.data.unread),this.relative_time=t.observable(Time.relative_time(new Date(1e3*e.date)))}}(jQuery,ko),Translate=function(){"use strict";let e=document.documentElement.lang;if(!e){const t=document.querySelector("#pagedata"),n=t&&JSON.parse(t.dataset.blob);e=n&&n.locale||"en"}function t(e,t){const n=e+t;return void 0!==window.bcStrings.md5s[n]?window.bcStrings.md5s[n]:null}function n(e,t){return void 0===t&&(t={}),e.replace(/\{\{(.*?)\}\}/g,(function(e,n){return t[n]}))}function a(e){e.indexOf("'")>=0&&(e.search(/[a-z]'[a-z]/)>=0||e.search(/s' /)>=0||e.search(/'s /)>=0)&&Log.server("single quotes used in place of apostrophe, use [’] character instead!! ["+e+"]","error")}const i={};function o(e,t,n,a,o){if("pre"===o||"dev"===o||i[n])return;if(window.location.pathname.startsWith("/page"))return;const s={tag_type:e,locale:t,str:n,context:a,dev:o};fetch("/api/internationalization/1/missing_js_translation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).catch((function(e){Log.server("Missing translation logging fail. Error: "+e,"error")})),i[n]=!0}let s=!1;function r(){var e;let t=!1;if(void 0===(null===(e=window.bcStrings)||void 0===e?void 0:e.translations[Translate.locale])&&(t=!0,!s)){s=!0;const e=new URL(location.href).pathname;Log.server("localized page contains no localized string data, locale ".concat(Translate.locale,", path ").concat(e),"error")}return t}return{EN_DEFAULT:"en",VALID_LOCALES:["en","ja","fr","qq","pt","de","es"],locale:e,translateMsg:function(i){let s,l=arguments[1];"string"==typeof l?s=2:(s=1,l=null);const c=arguments[s++]||null,d=(s++,arguments[s++]||"");a(i);let p=null,u=Translate.locale!==document.documentElement.lang,m=Translate.VALID_LOCALES.includes(Translate.locale);if(Translate.locale===Translate.EN_DEFAULT||!m||u)p=i;else if("qq"===Translate.locale)"Pseudoloc"in window?p=Pseudoloc.str(i):(Log.server("translateMsg called before initialization, locale "+Translate.locale+", translation in JS for string: "+i,"error"),p=i);else if(r())p=i;else{const n=t(i,d);n&&(p=window.bcStrings.translations[Translate.locale][n]),p||(o("TM",e,i,d,l),p=i)}return n(p,c)},translatePlural:function(i,s,l){let c,d=arguments[3];"string"==typeof d?c=4:(c=3,d=null);const p=arguments[c++]||{},u=(c++,arguments[c++]||"");let m,h;a(i),a(s),p.count=l,1==l?(m=i,h="s"):(m=s,h="p");let f=null;if(Translate.locale===Translate.EN_DEFAULT)f=m;else if("qq"===Translate.locale)"Pseudoloc"in window?f=Pseudoloc.str(m):(Log.server("translateMsg called before initialization, locale "+Translate.locale+", translation in JS for string: "+m,"error"),f=m);else if(r())f=m;else{const n=t(m,u);n&&(f=window.bcStrings.translations[Translate.locale][n]&&window.bcStrings.translations[Translate.locale][n][h]),f||(o("TP",e,m,u,d),f=m)}return n(f,p)}}}();window.TM=Translate.translateMsg,window.TP=Translate.translatePlural,function(e,t,n){"use strict";function a(a,i){const o=this;o.pageData=t("#pagedata").data("blob"),o.mapDictToArray=function(e){const t=[];for(const n in e)e.hasOwnProperty(n)&&t.push({key:n,value:e[n]});return t},o.curr_locale=n.observable(a),o.locales=n.observableArray(o.mapDictToArray(i)),o.display_locale=n.pureComputed((function(){const e=Iter.find(o.locales(),(function(e){return o.curr_locale()===e.key}));return e&&e.value})),o.otherLocales=n.pureComputed((function(){return Iter.findAll(o.locales(),(function(e){return e.key!==o.curr_locale()}))})),o.update_locale=function(n){if(n.key!==o.curr_locale()){t("#lang-picker-content").hide();let a=null;Url.isCustomDomain(e.location.hostname)&&(Cookie.set("bc_cdloc",n.key,null,"/",e.location.hostname,!1),a=ClientID);const i=o.pageData.identities,s=i&&i.user&&i.user.id,r=i&&i.fan&&i.fan.id,l={locale:n.key,user_id:s,client_id:a,fan_id:r};fetch("/api/internationalization/1/update_locale",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}).then((function(t){200===t.status?e.location.reload():Log.server("update locale failed")})).catch((function(e){Log.server("update locale failed")}))}},o.show_dialog_phone=function(){const e=[];Iter.each(o.locales(),(function(n){o.curr_locale()!==n.key&&e.push({text:n.value,value:n.key,click:function(e){o.update_locale(n),t(this).dialog("close")}})})),NuDialog.alertHTML(TM("Language"),"",{buttons:e,dialogClass:"nu-dialog lang-picker-m"}),t(".ui-dialog-buttonset>button").after("<br>")}}t((function(){!function(){const i=t("#pagedata").data("blob"),o=i&&i.locale||null;if(null!=o){const r="phone"===Browser.media_mode?"#lang-picker-vm-m":"#lang-picker-vm",l=t(r);if(l[0]){var s;let r={},c=null===(s=document.querySelector("#corp-footer-lang-data"))||void 0===s?void 0:s.dataset.languages;r=c?JSON.parse(c):i.languages?i.languages:{fr:"Français",ja:"日本語",en:"English"};const d=new a(o,r);n.applyBindings(d,l[0]);const p=t(".lang-picker-content");t(".lang-picker-current-lang").click((function(){return p.bcmenu(p.is(":visible")?"hide":"show"),!1})),t(".lang-picker-content").bcmenu({show:function(){t(".pg-ft-nav:not(.lang-picker-container)").addClass("dimmed")},hide:function(){t(".pg-ft-nav").removeClass("dimmed")},triggerElements:".lang-picker-current-lang"}),e.LangPicker=d}}}()}))}(window,jQuery,ko),function(){"use strict";function e(){const e=$("#menubar-vm"),n=$("#pagedata").data("blob")||{},a=n.cfg||{};if(e[0]){const i=e.data("initial-values").admin_level,o=$("#menubar").hasClass("admin-impersonating");(i>0||o)&&(a.header_rework_2018?MenubarAdmin.addMenuItems($("#user-nav .user-menu > :first-child"),i):MenubarAdmin.addMenuItems($("#user-nav .user-menu"),i));const s=new t(!1);window.MenubarVM=s,ko.applyBindings(s,e[0]),e.removeClass("loading"),e.addClass("loaded"),a.header_rework_2018?$("#menubar").bcmenubar({menu_position:{phone:{my:"top",at:"bottom",collision:"flipfit"},other:{my:"left top",at:"left bottom-7"}}}):$("#menubar").bcmenubar({menu_position:{phone:{my:"top",at:"bottom",collision:"flipfit"},other:{my:"left top",at:"left bottom"}}}),"async"===s.unshippedOrderCount()&&(n.loadFirstResultsAsync?BCEvents.subscribe("merchOrders.searchResultsLoaded",(function(){s.loadUnshippedOrderCount()})):window.setTimeout(s.loadUnshippedOrderCount,100))}if(a.header_rework_2018){$(".artist-filter-text").keydown((function(e){e.stopPropagation()})),HiddenParams.get("launch_edit_design")&&"undefined"!=typeof Design&&$("#custom-design-rules-style").data("design")&&Design.editDesign(!0);const e=$("#menubar-2018-phone");if(e[0]&&!e.hasClass("mbm-ko-bound")){const n=new t(!0);ko.applyBindings(n,e[0]),e.removeClass("loading"),e.addClass("mbm-ko-bound")}$(document).ready((function(){let e,t=!1,n=0,a=0;const i="phone"===MediaView.mode?100:20;if(e="phone"===MediaView.mode?$("#menubar-2018-phone"):$(".menubar-outer"),!e[0]&&(e=$(".hd"),!e[0]))return;const o=e.offset().top,s=e.offset().top+e.outerHeight();let r=0;const l="phone"===MediaView.mode&&$(".hd-banner-mobile-2018"),c=l&&l.outerHeight();let d=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){t={passive:!0}}}))}catch(e){}window.addEventListener("scroll",(function(t){e.hasClass("fixed")&&$(window).width()<$("#menubar").width()+32?(d=!0,$("#menubar-wrapper").css("left",-$(window).scrollLeft()+"px")):d&&(d=!1,$("#menubar-wrapper").css("left","0px"));const l=Menubar.getScroll().top;r>l?n+=Math.abs(l-r):a+=Math.abs(l-r),n>i||a>20||l<200?(n=0,a=0,function(t,n){let a;if(n>=t){let n=!0;t>=o&&(a=e.hasClass("hide"),t>200?e.removeClass("hide"):(e.removeClass("hide"),n=!1),a&&BCEvents.publish("menubar.show")),n&&e.addClass("fixed")}else t>=s&&(a=e.hasClass("hide"),e.addClass("hide"),$("#menubar").bcmenubar("collapseAll"),a||BCEvents.publish("menubar.hide")),"string"==typeof document.activeElement.className&&-1!==document.activeElement.className.indexOf("you-autocomplete-me")&&$(".you-autocomplete-me").blur();"desktop"===MediaView.mode&&(scroll.top>=s&&!$("body").hasClass("prevent-header-hiding")?e.addClass("hide-tooltips"):(e.removeClass("tooltips-hidden"),e.removeClass("hide-tooltips")));(0===t||c&&t<=c+10)&&(e.removeClass("fixed"),$("#menubar-wrapper").css("left","0px"))}(l,r),r=l):r=l}),t)})),$(window).on("resize",(function(){$("#menubar").bcmenubar("collapseAll")}))}}function t(e){let t;t=this,this.isMobile=e,this.root=t.isMobile?$("#menubar-2018-phone"):$("#menubar-vm"),this.data=this.root.data("initial-values")||{},this.forceNoControl=t.data.force_no_control,this.hideArtistMenu=t.data.hide_artist_menu,this.hide_unseen_notification_indicator=ko.observable(t.data.hide_unseen_notification_indicator),this.dashboardTooltipVM=ko.observable({showing:!1}),t.root.on("dashboardLinkTooltipReady",(function(e,n){t.dashboardTooltipVM(n)})),this.showMobileMenu=ko.observable(!1),this.showMobileAutocomplete=ko.observable(!1),Iter.each(["fan","isAdmin","pageBand","partner","user"],(function(e){t[e]=Identities[e]})),this.showBandControls=ko.computed((function(){return Identities.pageBand&&Identities.hasFullAccess()&&!t.forceNoControl})),this.showLimitedAccessControls=ko.computed((function(){return Identities.pageBand&&Identities.hasLimitedAccess()&&!t.forceNoControl})),this.artistsMenu=new n(this),this.statsLinkHref=ko.computed((function(){return t.pageBand?Identities.isParentLabel()&&!Identities.hasFullAccess()?Identities.pageBandParentLabel().url()+"/stats?band="+t.pageBand.id+"&from=menubar":t.pageBand.trackpipeLocalUrl()+"/stats?from=menubar":""})),this.statsLinkHref2018=ko.computed((function(){return t.pageBand?Identities.isParentLabel()?Identities.pageBandParentLabel().url()+"/stats?band="+t.pageBand.id+"&from=menubar":t.pageBand.trackpipeLocalUrl()+"/stats?from=menubar":""})),this.dashboardLinkHref=ko.computed((function(){return Identities.pageBand?Identities.isPageBandNonLabelMember()||Identities.isAdmin()?t.pageBand.trackpipeLocalUrl()+"/dashboard":Identities.isParentLabel()?Identities.pageBandParentLabel().url()+"/dashboard":"":""})),this.ordersLinkHref=ko.computed((function(){return t.pageBand?Identities.isParentLabel()?Identities.pageBandParentLabel().url()+"/merch_orders":t.pageBand.trackpipeLocalUrl()+"/merch_orders":""})),this.unshippedOrderCount=ko.observable(t.data.unshipped_order_count),this.loadUnshippedOrderCount=function(){Crumb.ajax({type:"POST",url:"/api/merch/1/get_unshipped_order_count",data:{user_id:t.user().id,band_id:t.pageBand.id},dataAs:"JSON",error:function(e){t.setUnshippedOrderCount("?")},success:function(e){e.error?t.setUnshippedOrderCount("?"):t.setUnshippedOrderCount(e.count)}})},this.setUnshippedOrderCount=function(e){let n,a;const i=e.length<=1;let o;if(e=e.toString(),t.unshippedOrderCount(e),n=document.querySelector(".menubar-2018 .unshipped-order-count-value"),"0"===e)return n.classList.add("order-count-zero"),void window.setTimeout((function(e){n.classList.remove("order-count-loading")}),50);a=n.cloneNode(),a.style.position="absolute",a.style.top="-9999px",a.style.width="auto",a.innerHTML=e,n.after(a),o=a.scrollWidth,n.style.transitionDuration="".concat(50,"ms"),n.style.width=a.scrollWidth+"px",window.setTimeout((function(t){n.innerHTML=e,n.classList.remove("order-count-loading")}),i?1:50)},this.addAlbumClick=function(){return Stats.record({kind:"click",click:"menubar_add_album"}),!LabelAddItemDialog.showDialog("album")},this.addTrackClick=function(){return Stats.record({kind:"click",click:"menubar_add_track"}),!LabelAddItemDialog.showDialog("track")},this.addMerchClick=function(){return Stats.record({kind:"click",click:"menubar_add_merch"}),window.EditTralbum&&window.EditTralbum.viewModel&&window.EditTralbum.viewModel.createNewMerch?(window.EditTralbum.viewModel.createNewMerch(),!1):!LabelAddItemDialog.showDialog("merch")},this.addLiveEventClick=function(){return Stats.record({kind:"click",click:"menubar_add_live_event"}),BCTracker.record("click",{feature:"live",band_id:Identities.pageBand.id,user_id:Identities.user().id,feature_sub_type:"live_event_edit_page",event_sub_type:"add_live_stream"}),!LabelAddItemDialog.showDialog("live_show")},this.addListeningPartyClick=function(){return Stats.record({kind:"click",click:"menubar_add_listening_party"}),BCTracker.record("click",{feature:"live",band_id:Identities.pageBand.id,user_id:Identities.user().id,feature_sub_type:"listening_party",event_sub_type:"plus_add_listening_party"}),!LabelAddItemDialog.showDialog("listening_party")},this.addNewArtist=function(){Stats.record({kind:"click",click:"menubar_add_new_artist"}),t.data.lapsed_or_cancelled_label?window.location=t.data.lapsed_redirect_url:AddNewArtistDialog.showDialog()},this.addExistingArtist=function(){Stats.record({kind:"click",click:"menubar_add_existing_artist"}),t.data.lapsed_or_cancelled_label?window.location=t.data.lapsed_redirect_url:AddExistingArtistDialog.showDialog()},this.numCartItemsDisplay=ko.pureComputed((function(){return"undefined"!=typeof Sidecart&&Sidecart?Sidecart.ko_num_cart_items()>99?"99+":Sidecart.ko_num_cart_items():t.data.cart_quantity})),this.hasCart=ko.pureComputed((function(){if("undefined"!=typeof Sidecart&&Sidecart)return Sidecart.ko_num_cart_items()>0;if(t.data.cart_quantity)return t.data.cart_quantity>0;return($("#pagedata").data("blob")||{}).cart_quantity>0})),this.shrinkLogo=ko.pureComputed((function(){return t.data.gift_card_balance||t.hasCart()})),this.goCart=function(e,t){if(t.shiftKey||t.ctrlKey||t.metaKey)return!0;if("undefined"==typeof Sidecart||!Sidecart)return!0;if(!Sidecart.ko_num_cart_items())return!0;if(Menubar.getScroll().top>0){let e=document.scrollingElement;e||(e=document.documentElement&&null!=document.documentElement.scrollTop?document.documentElement:document.body),$(e).animate({scrollTop:-10},500).promise().done((function(){Sidecart.wiggle()}))}else Sidecart.wiggle();return!1},this.goCartMobile=function(e,t){if("undefined"==typeof Sidecart||!Sidecart)return!0;if(!Sidecart.ko_num_cart_items())return;if(Menubar.getScroll().top>0){Dom.scrollToElement(document.body);$("#sidecart").hasClass("expanded")||Sidecart.show_cart_phone()}else Sidecart.toggle_cart_phone()},this.loggedInFanPhoto=ko.computed((function(){return t.fan()&&t.fan().photo})),this.currLocale=ko.pureComputed((function(){if("undefined"!=typeof LangPicker&&LangPicker)return LangPicker.display_locale();{const e=$("#pagedata").data("blob");return e&&e.locale||"English"}})),this.langPickerDialog=function(){LangPicker.show_dialog_phone()};const a=$("#pagedata").data("blob"),i=a.cfg;let o=new BCMenubarSearch;window.initiatedAutocomplete||a.is_search_page||document.getElementById("daily-nav")?a.is_search_page||document.getElementById("daily-nav")||(o=window.AutocompleteController):o.init(i),this.mobileShowSearch=function(e){document.body.classList.contains("search-active")||o.activateAutocomplete()},this.isMobile&&document.body.classList.add("search-responsive"),"phone"===MediaView.mode&&o&&o.mobileCssFix(),this.altSearch=ko.observable(!1),this.showAltSearch=function(){this.altSearch(!0),o.init(i)};const s=new URL(window.siteroot);e&&window.location.hostname==s.hostname&&"/search"==window.location.pathname&&(o.init(i),this.mobileShowSearch());const r=new EventBus;!e&&window.initializeNotificationCenter&&(this.NotificationCenterVM=window.initializeNotificationCenter(r)),r.subscribe("notificationCenter.open",(function(){t.hide_unseen_notification_indicator(!0),Cookie.set("hide_unseen_notification_indicator",1,5),Crumb.ajax({type:"POST",url:"/api/community/1/hide_notifications_indicator",data:{user_id:Identities.user().id},dataAs:"JSON",error:function(e){},success:function(e){}})})),BCEvents.subscribe("community.feed.allCommentsSeen",(function(){t.hide_unseen_notification_indicator(!0)})),this.initialized=!0}function n(e){const t=this;function n(){const e=t.pageLabelMemberBands().length,n=Math.ceil(e/t.columns()),a=t.otherLinkedAccounts().length,i=Math.ceil(a/t.columns());let o,s;return n+i<9||!t.hasLabels()?{labelBands:e,linkedBands:a}:a<e?(o=(9-i)*t.columns(),e>o&&--o,{labelBands:o,labelBandsOverflow:e-o,linkedBands:a}):(s=(9-n)*t.columns(),a>s&&--s,{labelBands:e,linkedBands:s,linkedBandsOverflow:a-s})}function a(e,n){let a,i,o;for(a=e.slice(0,n),a=a.sort((function(e,t){return e.name()<t.name()?-1:e.name()>t.name()?1:0})),i=Math.ceil(a.length/t.columns()),o=[];a.length>0;)o.push({bands:a.splice(0,i)});return o}this.menubar=e,Iter.each(["bmgr","lmgr","hasLabels","isPageBand","isPageBandMember","isParentLabel","linkedNonLabelMemberBands","pageBandParentLabel","pageLabel"],(function(e){t[e]=Identities[e]})),this.toolsProfileBand=ko.computed((function(){return e.showBandControls()||e.showLimitedAccessControls()?e.pageBand:1===t.bmgr.bands().length?t.bmgr.bands()[0]:null})),this.options=ko.computed((function(){const n=t.toolsProfileBand();return{title:n?n.name():"artists",showPhoto:!!n,photo:n?n.photo():null,showPro:n?n.isPro():t.bmgr.anyPro(),toolsProfileEditable:n&&(Identities.isMemberOfBand(n.id)||e.isAdmin()),adminAccess:n&&!t.isPageBandMember()&&e.isAdmin()}})),this.pageLabelMemberBands=ko.computed((function(){if(t.pageLabel())return t.pageLabel().memberBands();if(Identities.lmgr&&Identities.lmgr.labels()){let e=[];return Iter.each(Identities.lmgr.labels(),(function(t){e=e.concat(t.memberBands())})),e}return[]})),this.otherLinkedAccounts=ko.computed((function(){return Iter.findAll(t.linkedNonLabelMemberBands(),(function(e){return!(t.pageLabel()&&e.id===t.pageLabel().id||t.toolsProfileBand()&&e.id===t.toolsProfileBand().id)}))})),this.columns=ko.computed((function(){const e=t.pageLabelMemberBands().length+t.otherLinkedAccounts().length;return t.hasLabels()?e>26?3:Math.floor((e-1)/9)+1:1})),this.liveEvents=ko.observable(e.data.live_events),this.labelBands=ko.computed((function(){return t.hasLabels()?a(t.pageLabelMemberBands(),n().labelBands):null})),this.labelBandsOverflow=ko.computed((function(){return n().labelBandsOverflow})),this.linkedBands=ko.computed((function(){return a(t.otherLinkedAccounts(),n().linkedBands)})),this.linkedBandsOverflow=ko.computed((function(){return n().linkedBandsOverflow})),this.findPageBand=function(){const e=1==Identities.linkedNonLabelMemberBands().filter((function(e){return Identities.pageBand&&e.id==Identities.pageBand.id})).length;return Identities.isAdmin()&&Identities.pageBand||e?(Cookie.set("menubar_active_band",Identities.pageBand.id,7776e3),Identities.pageBand):Cookie.get("menubar_active_band")&&Identities.bmgr.bandByID(parseInt(Cookie.get("menubar_active_band")))?Identities.bmgr.bandByID(parseInt(Cookie.get("menubar_active_band"))):Identities.linkedNonLabelMemberBands()[0]},this.loggedInBand=ko.observable(t.findPageBand()),this.optionsLoggedInBand=ko.computed((function(){const n=t.loggedInBand();return{title:n?n.name():"",showPhoto:!!n,photo:n&&n.photo()?n.photo():null,showPro:n?n.isPro():t.bmgr.anyPro(),toolsProfileEditable:n&&(Identities.isMemberOfBand(n.id)||e.isAdmin()),adminAccess:n&&!t.isPageBandMember()&&e.isAdmin()}})),this.pageDesignable=function(e){return!("undefined"==typeof Design||!$("#custom-design-rules-style").data("design"))&&t.isPageBand(e.id)},this.launchPageDesign=function(e){t.pageDesignable(e)?Design.editDesign(!0):window.location=e.trackpipeLocalUrl()+"?launch_edit_design=1"},this.labelMemberBandsSearchTerm=ko.observable(""),this.showLinkedBands=ko.observable(!1),this.loggedInLabelMemberBandsCountStr=ko.pureComputed((function(){const e=t.loggedInLabelMemberBands().length;return TP("1 Artist","{{count}} Artists",e)})),this.loggedInLinkedBandsCountStr=ko.pureComputed((function(){const e=t.linkedNonLabelMemberBands().length-1;return TP("1 Connected Account","{{count}} Connected Accounts",e)})),this.loggedInLabelMemberBands=ko.computed((function(){const n=t.loggedInBand();if(t.lmgr&&t.lmgr.labels()){let a=[];if(Iter.each(t.lmgr.labels(),(function(e){e.id==n.id&&(a=a.concat(e.memberBands()))})),e.pageBand){const t=e.pageBand.id;a.sort((function(e,n){return e.id===t?-1:n.id===t||e.name().toLowerCase().trim()>=n.name().toLowerCase().trim()?1:-1}))}else a.sort((function(e,t){return e.name().toLowerCase().trim()>=t.name().toLowerCase().trim()?1:-1}));return a}return[]})),this.filteredLoggedInLabelMemberBands=ko.computed((function(){return Iter.findAll(t.loggedInLabelMemberBands(),(function(e){const n=t.labelMemberBandsSearchTerm().toLowerCase();return-1!==e.name().toLowerCase().indexOf(n)}))})),this.activeLabelMemberBand=ko.observable(e.pageBand?e.pageBand.id:null),this.setActiveLabelMemberBand=function(e){t.activeLabelMemberBand()==e?t.activeLabelMemberBand(null):t.activeLabelMemberBand(e)}}window.Menubar={initialize:e,initialValues:$("#menubar-vm")[0]?$("#menubar-vm").data("initial-values"):{},getScroll:function(){const e=document.body,t=document.documentElement;return{left:parseFloat(window.pageXOffset||e.scrollLeft||t.scrollLeft),top:parseFloat(window.pageYOffset||e.scrollTop||t.scrollTop)}}},$(document).ready((function(){e()}))}(),function(e,t){var n=6,a=e.event.add,i=e.event.remove,o=function(t,n,a){e.event.trigger(n,a,t)},s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){return window.setTimeout((function(){e()}),25)},r={textarea:!0,input:!0,select:!0},l={move:"mousemove",cancel:"mouseup dragstart",end:"mouseup"},c="touchmove",d="touchend",p="touchend";function u(e){var t=e,n=!1,a=!1;function i(e){n?(t(),s(i),a=!0,n=!1):a=!1}this.kick=function(e){n=!0,a||i()},this.end=function(e){var i=t;e&&(a?(t=n?function(){i(),e()}:e,n=!0):e())}}function m(e){return!1}function h(e){e.preventDefault()}function f(e){r[e.target.tagName.toLowerCase()]||e.preventDefault()}function g(e,t){var n,a;if(e.identifiedTouch)return e.identifiedTouch(t);for(n=-1,a=e.length;++n<a;)if(e[n].identifier===t)return e[n]}function _(e,t){var n=g(e.changedTouches,t.identifier);if(n&&(n.pageX!==t.pageX||n.pageY!==t.pageY))return n}function b(e){T(e,e.data,e,y)}function v(e){y()}function y(){i(document,l.move,b),i(document,l.cancel,y)}function w(e){var t=e.data,n=_(e,t);n&&T(e,t,n,x)}function k(e){var t=e.data;g(e.changedTouches,t.identifier)&&x(t)}function x(e){i(document,"."+e.identifier,w),i(document,"."+e.identifier,k)}function T(t,a,i,s){var r=i.pageX-a.startX,l=i.pageY-a.startY;if(!(r*r+l*l<n*n))return function(t,n,a,i,s,r){var l,c,d,p=n.target;for(;p&&p!==document.documentElement;){if((l=e.data(p,"events"))&&(l.movestart||l.move||l.moveend))return c=t.targetTouches,d=t.timeStamp-n.timeStamp,n.type="movestart",n.distX=i,n.distY=s,n.deltaX=i,n.deltaY=s,n.pageX=a.pageX,n.pageY=a.pageY,n.velocityX=i/d,n.velocityY=s/d,n.targetTouches=c,n.finger=c?c.length:1,o(n.target,n,[n,t]),r(n);p=p.parentNode}}(t,a,i,r,l,s)}function C(e){var t=e.data.event,n=e.data.timer;I(t,e,e.timeStamp,n)}function S(e){var t=e.data.event,n=e.data.timer;i(document,l.move,C),i(document,l.end,S),E(t,n,(function(){setTimeout((function(){i(t.target,"click",m)}),0)}))}function L(e){var t=e.data.event,n=e.data.timer,a=_(e,t);a&&(e.preventDefault(),t.targetTouches=e.targetTouches,I(t,a,e.timeStamp,n))}function P(e){var t=e.data.event,n=e.data.timer;g(e.changedTouches,t.identifier)&&(!function(e){i(document,"."+e.identifier,L),i(document,"."+e.identifier,P)}(t),E(t,n))}function I(e,t,n,a){var i=n-e.timeStamp;e.type="move",e.distX=t.pageX-e.startX,e.distY=t.pageY-e.startY,e.deltaX=t.pageX-e.pageX,e.deltaY=t.pageY-e.pageY,e.velocityX=.3*e.velocityX+.7*e.deltaX/i,e.velocityY=.3*e.velocityY+.7*e.deltaY/i,e.pageX=t.pageX,e.pageY=t.pageY,a.kick()}function E(e,t,n){t.end((function(){return e.type="moveend",o(e.target,e),n&&n()}))}function F(e){return!!e&&(e.movestart?1:0)+(e.move?1:0)+(e.moveend?1:0)>1}function M(t,n,i){if(!F(e.data(this,"events")))return a(this,"dragstart.move drag.move",h),a(this,"mousedown.move",f),!0}function D(t){if(!F(e.data(this,"events")))return i(this,"dragstart drag",h),i(this,"mousedown touchstart",f),!0}e.event.special.movestart={setup:M,teardown:D,_default:function(e,t,n){var i={event:t,timer:new u((function(n){o(e.target,t)}))};undefined===t.identifier?(a(t.target,"click",m),a(document,l.move,C,i),a(document,l.end,S,i)):(n.preventDefault(),a(document,c+"."+t.identifier,L,i),a(document,p+"."+t.identifier,P,i))}},e.event.special.move=e.event.special.moveend={setup:M,teardown:D},a(document,"mousedown.move",(function(e){var t;(function(e){return 1===e.which&&!e.ctrlKey&&!e.altKey})(e)&&(t={target:e.target,startX:e.pageX,startY:e.pageY,pageX:e.pageX,pageY:e.pageY,timeStamp:e.timeStamp},a(document,l.move,b,t),a(document,l.cancel,v,t))})),a(document,"touchstart.move",(function(e){var t,n;r[e.target.tagName.toLowerCase()]||(n={target:(t=e.changedTouches[0]).target,startX:t.pageX,startY:t.pageY,pageX:t.pageX,pageY:t.pageY,timeStamp:e.timeStamp,identifier:t.identifier},a(document,c+"."+t.identifier,w,n),a(document,d+"."+t.identifier,k,n))}))}(jQuery),function(e,t){for(var n=["changedTouches","targetTouches"],a=n.length,i=e.event.props;a--;){for(var o=n[a],s=!1,r=0,l=i.length;r<l;++r)if(i[a]==o){s=!0;break}s||i.push(o)}}(jQuery);var PopupImage={_urls:[],_imgs:[],_preloading:!1,_imgSizes:{},attach:function(e){e=$(e),Dom.hackLinkClicksThanksSafari(e,PopupImage.click),this.preload(e,!0)},delegate:function(e){$(e).delegate("a.popupImage","click",PopupImage.click)},preload:function(e,t){if(window.MediaView&&"desktop"!=MediaView.mode)return;const n=this;$(e).each((function(e,a){t&&"true"!=a.getAttribute("data-image-preload")||n._urls.push(a.getAttribute("href"))})),this._urls.length&&!this._preloading&&this._preloader()},preload_url:function(e){this._urls.push(e),this._preloading||this._preloader()},_preloader:function(){if(this._urls.length)if(this._preloading=!0,this._imgs.push(CommUtils.loadImage(this._urls.shift())),this._urls.length){let e=this;setTimeout((function(){e._preloader(),e=null}),100)}else this._preloading=!1},click:function(e){if(e.ctrlKey||e.metaKey)return;let t=e.currentTarget;t&&"A"!=t.tagName&&(t=$(t).parents("A")[0]),PopupImage.showFor(t,!1)&&(e.preventDefault(),e.stopPropagation())},showFor:function(e,t){this.dismiss();let n=e&&e.href;if(!n)return!1;const a=e.getAttribute("data-statclick");if(a&&a.length>0&&Stats.record({kind:"click",click:a}),e.getAttribute("data-image-error"))return Log.debug("bailing on popup due to image load error: "+n),!1;const i=PopupImage.getCachedImageSize(e);if(i&&i.w&&i.h)return Log.debug("PopupImage.showFor: got cached image size; showing image immediately"),PopupImage.show(n,i.w,i.h,e,t),!0;Log.debug("PopupImage.showFor: no cached image size; delaying image display");const o=$(e).find("IMG")[0]||e;let s,r=document.createElement("div");r.className="popupimage_loading",r.style.top=o.offsetTop+"px",r.style.left=o.offsetLeft+"px",r.style.width=o.offsetWidth+"px",r.style.height=o.offsetHeight+"px",o.offsetWidth<200||o.offsetHeight<200?r.innerHTML="<div class='popupimage_spinny_sm'></div>":r.innerHTML="<div class='popupimage_spinny_lg'></div>",r.style.opacity=0,o.offsetParent.appendChild(r),$(r).delay(500).fadeTo("fast",.5);const l=function(){r&&r.parentNode.removeChild(r),r=null},c=function(){s=new Image,s.onload=function(){PopupImage._imgSizes[s.src]={w:s.width,h:s.height},PopupImage.show(s.src,s.width,s.height,e,t),s.onload=s.onerror=null,e=s=n=null,l()},s.onerror=function(){Log.debug("image load error: "+n),e.setAttribute("data-image-error","1"),s.onload=s.onerror=null,e=s=n=null,l()},s.src=n},d=function(){s.onload=s.onerror=null,s.src=null,s=null,l()};return r.onclick=d,c(),!0},show:function(e,t,n,a,i){this.show_inner(e,t,n,a,i)},show_inner:function(e,t,n,a,i){if(window.MediaView&&"phone"==window.MediaView.mode)return this.show_mobile(e,t,n,a,i);const o=this;o.dismiss();const s=document.documentElement,r=s.scrollHeight,l=s.scrollLeft;let c=s.scrollTop+40;if(t&&n){const e=s.clientWidth-60,a=s.clientHeight-60;if(e/a>t/n?n>a&&(t*=a/n,n=a):t>e&&(n*=e/t,t=e),n>a-80)var d=(a-n)/2;else d=60;c=s.scrollTop+d-20}const p=!i&&null!=a;e=e.replace(/'/g,"\\'");let u=document.createElement("div");u.className="imageviewer_top",u.onclick=function(e){e.ctrlKey||e.metaKey||(e.preventDefault(),o.dismiss(this))};const m="<table align=center style='position:relative; top:"+c+"px;left:"+l+"px'><tr><td>",h=this.hasNext(a),f=this.hasPrev(a);if(u.innerHTML="<div id='popupimage_back' class='imageviewer_back' style='"+(p?"visibilityx: hidden; ":"")+"height:"+r+"px;width:100%'></div>"+m+"<div id='popupimage_dismiss' class='imageviewer_dismiss'"+(p?"style='visibility: hidden;' ":"")+"></div></td></tr><tr><td "+(t?" width='"+t+"px'":"")+(n?" height='"+n+"px'":"")+"><a target='_blank' style='position:relative;display:inline-block;' href='"+e+"'><img id='popupimage_image' class='imageviewer_image' src='"+e+"'"+(t?" width='"+t+"px'":"")+(n?" height='"+n+"px'":"")+(p?"style='position: relative; visibility: hidden; opacity: 0.5; filter: alpha(opacity=50);' ":"")+" />"+(f?"<span class='imageviewer_nav prev' "+(p?"style='display:none;'":"")+"><span class='imageviewer_navicon prev'></span></span>":"")+(h?"<span class='imageviewer_nav next' "+(p?"style='display:none;'":"")+"><span class='imageviewer_navicon next'></span></span>":"")+"</a></td></tr></table></div>",$(".imageviewer_nav.prev",u).click(PopupImage.goPrev.bind(PopupImage)),$(".imageviewer_nav.next",u).click(PopupImage.goNext.bind(PopupImage)),document.body.appendChild(u),o._current=u,o._currentSrc=a,o.globalListenersOn(),p){let e=elt("popupimage_image");const i=Dom.getXY(e),o=[t,n],s=1*t/n,r=Dom.getXY(a),l=a.offsetHeight>a.offsetWidth;start_width=a.offsetWidth,start_height=a.offsetHeight;const c=l?[start_width,start_width/s]:[start_height*s,start_height];l?r[1]+=a.offsetHeight/2-Math.round(c[0]/s/2):r[0]+=a.offsetWidth/2-Math.round(c[1]*s/2),r[0]+=Math.round((i[0]-r[0])/2),r[1]+=Math.round((i[1]-r[1])/2),c[0]+=Math.round((o[0]-c[0])/2),c[1]+=Math.round((o[1]-c[1])/2),e.width=c[0]+"px",e.height=c[1]+"px",e.left=r[0]-i[0]+"px",e.top=r[1]-i[1]+"px",e.style.visibility="visible";const d={opacity:.9,width:o[0],height:o[1],left:0,top:0};$(e).animate(d,{duration:200,easing:"linear",complete:function(){elt("popupimage_dismiss").style.visibility="visible";const e=elt("popupimage_image").style;e.position=e.opacity=e.filter="",$(".imageviewer_nav").css("display","inline-block")}}),e=a=null}return u=null,elt("popupimage_image")},show_mobile:function(e,t,n,a,o){const s=window.MediaView&&"phone"==window.MediaView.mode;if(s&&$(a).find("img").outerWidth()>$(window).width()/2){if($(a).closest(".popupImageGallery").find(".popupImage").length<=1)return!1}let r=null,l=null,c=null;function d(){const e={w:$(window).width(),h:$(window).height()};return s||(e.w-=40,e.h-=60),e}function p(e){Log.debug("PopupImage.build; goto_url: ",e);const t=$(a).closest(".popupImage"),n=$(a).closest(".popupImageGallery");if(n.length>0)var o=n.find(".popupImage");else o=$(t);const s=d();if(r=$("<div class='popupimage_gallery'></div>"),r.append($("<span class='popupimage_widget popupimage_nav dismiss'><span class='popupimage_navicon dismiss'></span>")).bind("click",(function(e){f()})),o.length>1){const e=$("<span class='popupimage_widget popupimage_nav navdots'></span>").appendTo(r).bind("click",(function(e){}));for(i=0;i<o.length;i++)e.append($("<span class='popupimage_dot'></span>"))}c=r.find(".popupimage_widget");const p=$("<ul class='popupimage_container'></ul>").css("width",101*o.length+"%").appendTo(r);e=e||t.attr("href"),o.each((function(t){const n=$(this),a=n.attr("href"),i=PopupImage.limitImageSize(PopupImage.getCachedImageSize(n)||{},s),o=a==e&&i.w&&i.h,r="<li class='popupimage_item' id='popupimage_item_"+t+"' style='width:"+s.w+"px;'><img "+(a==e?"src":"data-src")+"='"+a+"' style='display:"+(o?"block":"none")+"; width:"+(o?i.w+"px":"auto")+"; height:"+(o?i.h+"px":"auto")+";'></li>";p.append(r)}));let h=0;let w=null;p.find(".popupimage_item").bind("touchstart",(function(e){w="start",m(self)})).bind("touchmove",(function(e){w="moving"})).bind("movestart",(function(e){h=$(this).closest(".popupimage_container")[0].offsetLeft,l=$(this),w="start"})).bind("move",(function(e){try{if("ignore"==w||Math.abs(e.distY)>Math.abs(e.distX))return g(e,l),w="ignore",!1;w="moving";const t=$(this).closest(".popupimage_container");let n=e.distX;(n>0&&!y($(this))||n<0&&!v($(this)))&&(n=Math.round(n/2.5)),t.css({left:h+n})}catch(e){Log.note("move error: "+e.message)}})).bind("moveend",(function(e){"moving"==w?w=function(e,t){try{return e.distX<-35&&e.velocityX<=0?(_(null,t),!0):e.distX>35&&e.velocityX>=0?(b(null,t),!0):(g(null,t),!1)}catch(e){Log.note("finishMove error: "+e.message)}}(e,this)?"moved":"revert":Log.note("moveend not moving: "+w)})).bind("click",(function(e){if(e.target!=this)switch(e.stopPropagation(),w){case"moved":case"moving":case"revert":case"ignore":break;default:w="click";$(this);e.clientX>.67*this.offsetWidth?_(e,this):e.clientX<.33*this.offsetWidth?b(e,this):f()}else f()})),p.find(".popupimage_item img").bind("load",u),$(document).on("keydown",k),$(document.body).on("orientationchange",(function(){C(!1,"orientation")})),$(window).on("resize",(function(){C(!1,"resize")})),$(document.body).append(r),Dom.hideEverythingThanksAndroid(r[0]),r.find(".popupimage_item").each((function(t,n){(n=$(n)).find("img").attr("src")==e&&(l=n)})),g(null,l,!0)}function u(e){const t=$(this),n=this;if(function(e){e=$(e),clearTimeout(e.data("loading-timer")),e.removeClass("loading"),e.addClass("loaded")}(t.closest(".popupimage_item")),n&&"auto"==n.style.width&&"auto"==n.style.height){"ie"==Browser.type&&t.css({display:"block"});const e={w:t.prop("width"),h:t.prop("height")};PopupImage._imgSizes[t.attr("src")]=e;const a=PopupImage.limitImageSize(e,d());t.css({width:a.w+"px",height:a.h+"px",display:"block"}),Log.debug("PopupImage: image loaded -- width: ",e.w,"height: ",e.h,n)}m(this)}function m(e){h((e=$(e).closest(".popupimage_item")).prev(".popupimage_item")),h(e.next(".popupimage_item"))}function h(e){const t=$(e).find("img"),n=t.attr("data-src");n&&(t.attr("src",n),t.attr("data-src",null))}function f(){$(".popupimage_gallery").remove(),$(document).off("keydown",k),$(document.body).off("orientationchange",C),$(window).off("resize",C),r&&Dom.unhideEverythingThanksAndroid(r[0]),r=l=c=null}function g(e,t,n){t=$(t),e&&e.preventDefault();const a=t.closest(".popupimage_container");if(a)try{t[0]&&(n?a.css({left:-t[0].offsetLeft+"px"}):a.animate({left:-t[0].offsetLeft+"px"},100,"linear"))}catch(e){Log.note("goTo error: "+e.message)}!function(e){e=$(e),e.hasClass("loaded")||e.data("loading-timer",setTimeout((function(){e.addClass("loading")}),250))}(t),w(t[0]),l=t}function _(e,t){(t=$(t||l)).is(".popupimage_container")&&(Log.note("hmmm container got event: "+e.which),t=$(e.target).closest(".popupimage_item")),w(t.next()[0]),g(e,$(t.next(".popupimage_item")[0]||t))}function b(e,t){(t=$(t||l)).is(".popupimage_container")&&(Log.note("hmmm container got event: "+e.which),t=$(e.target).closest(".popupimage_item")),w(t.prev()[0]),g(e,$(t.prev(".popupimage_item")[0]||t))}function v(e){return null!=$(e).next(".popupimage_item")[0]}function y(e){return null!=$(e).prev(".popupimage_item")[0]}function w(e){if(!e)return;const t=e.id.match(/\d+/g),n=$(".navdots");n.children().removeClass("active"),$(n.children()[t]).addClass("active")}function k(e){if(!e.ctrlKey&&!e.metaKey)switch(e.keyCode){case 13:case 27:case 32:f();break;case 39:case 40:_(null,l);break;case 37:case 38:b(null,l)}}let x,T=null;function C(e,t){if(!e)return T&&clearTimeout(T),void(T=setTimeout((function(){C(!0)}),500));if(!r)return;const n=$(l).find("img").attr("src");f(),p(n)}try{f(),p(),!s&&a&&l&&function(){const e=l.find("img"),t=e.offset(),n=e.outerWidth(),i=e.outerHeight(),o=1*n/i,s=r.find(".popupimage_container"),c=s.css("display");s.css({display:"none"});const d=$(a).offset(),p={width:$(a).outerWidth(),height:$(a).outerHeight()},u=1*p.width/p.height;center_by_width=o<u,o<u?(d.top+=Math.round(p.height/2),p.height=Math.round(p.width/o),d.top-=Math.round(p.height/2)):(d.left+=Math.round(p.width/2),p.width=Math.round(p.height*o),d.left-=Math.round(p.width/2)),d.left+=Math.round((t.left-d.left)/2),d.top+=Math.round((t.top-d.top)/2),p.width+=Math.round((n-p.width)/2),p.height+=Math.round((i-p.height)/2);const m=$("<img/>");m.attr({src:e.attr("src")}),m.css({position:"absolute","z-index":r.css("z-index")+1,opacity:.33,width:p.width+"px",height:p.height+"px",left:d.left+"px",top:d.top+"px"}),m.appendTo(document.body),m.animate({opacity:.9,width:n+"px",height:i+"px",left:t.left+"px",top:t.top+"px"},150,"swing",(function(){m.remove(),s.css({display:c})}))}()}catch(x){return Log.note("show_mobile error: "+x.message),!1}return!0},limitImageSize:function(e,t){return e&&e.w&&e.h&&(e={w:e.w,h:e.h},t.w/t.h>e.w/e.h?e.h>t.h&&(e.w*=t.h/e.h,e.h=t.h):e.w>t.w&&(e.h*=t.w/e.w,e.w=t.w)),e},getCachedImageSize:function(e){const t=(e=$(e)).attr("href"),n=PopupImage.getPresuppliedImageSize(e)||PopupImage._imgSizes[t]||null;return n&&Log.debug("PopupImage: found cached size for image: ",t,"width: ",n.w,"height: ",n.h),n},getPresuppliedImageSize:function(e){const t=(e=$(e)).attr("data-image-size");let n,a,i=null;try{t&&(a=t.toString().split(","),2==a.length&&(i={w:parseInt(a[0]),h:parseInt(a[1])}))}catch(n){Log.note("getPresuppliedImageSize error: "+n.message)}return i},hasNext:function(e){if(!(e=e||this._currentSrc))return!1;const t=$(e).closest(".popupImageGallery").find(".popupImage"),n=$.inArray(e,t);return n>-1&&n<t.length-1},goNext:function(e,t){if(e&&U.stopEvent(e),!(t=t||this._currentSrc))return;const n=$(t).closest(".popupImageGallery").find(".popupImage"),a=$.inArray(t,n);a>-1&&a<n.length-1&&(e&&e.preventDefault(),this.showFor(n[a+1],!0))},hasPrev:function(e){if(!(e=e||this._currentSrc))return!1;const t=$(e).closest(".popupImageGallery").find(".popupImage");return $.inArray(e,t)>0},goPrev:function(e,t){if(e&&U.stopEvent(e),!(t=t||this._currentSrc))return;const n=$(t).closest(".popupImageGallery").find(".popupImage"),a=$.inArray(t,n);a>0&&(e&&e.preventDefault(),this.showFor(n[a-1],!0))},dismiss:function(e){(e=e||this._current)&&e.parentNode&&e.parentNode.removeChild(e),e==this._current&&(this._current=null,this._currentSrc=null),PopupImage.globalListenersOff()},globalListenersOn:function(){$(document).on("keydown",PopupImage.popupKeys)},globalListenersOff:function(){$(document).off("keydown",PopupImage.popupKeys)},popupKeys:function(e){if(!e.ctrlKey&&!e.metaKey)switch(e.keyCode){case $.ui.keyCode.ENTER:case $.ui.keyCode.ESCAPE:case $.ui.keyCode.SPACE:U.stopEvent(e),PopupImage.dismiss();break;case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:U.stopEvent(e),PopupImage.goNext();break;case $.ui.keyCode.LEFT:case $.ui.keyCode.UP:U.stopEvent(e),PopupImage.goPrev()}}};window.Crumb={ajax:function(e){let t=0;const n=Url.toHash(e.url).pathname.substring(1),a="JSON"===e.dataAs;let i=e.data;function o(){a?(i.crumb=_crumbs[n],e.data=ko.toJSON(i)):("string"!=typeof i&&(i=$.param(i)),_crumbs[n]&&(e.data=i+"&"+Url.joinQuery({crumb:_crumbs[n]})))}function s(a){_crumbs[n]=a,t+=1,o(),$.ajax(e)}function r(e,t){if(e){$.isArray(e)||(e=[e]);for(let n=0;n<e.length;n++)t(e[n])}}"JSON"===e.dataAs&&(e.contentType||(e.contentType="application/json")),i||(i=a?{}:"");const l=e.error,c=e.success,d=e.complete;return o(),e.success=function(e,n,a){const i=jQuery.parseJSON(a.responseText);if("invalid_crumb"===i.error&&t<2)return void s(i.crumb);const o=this;r(c,(function(t){t.apply(o,[e,n,a])})),r(d,(function(e){e.apply(o,[a,n])}))},e.error=function(e,n,a){const i=this;if(403===e.status)try{const n=jQuery.parseJSON(e.responseText);if("invalid_crumb"===n.error&&t<2)return void s(n.crumb)}catch(e){}r(l,(function(t){t.apply(i,[e,n,a])})),r(d,(function(t){t.apply(i,[e,n])}))},e.complete=null,$.ajax(e)},get:function(e){const t=Url.toHash(e).pathname.substring(1);return _crumbs[t]?_crumbs[t]:""},put:function(e){$.extend(_crumbs,e)}},U.augmentObject(Form,{_lifeBoatEnabled:!1,_formElem:null,_validateSections:null,_validateMessages:null,_onValidate:null,_customSubmitter:null,_submitOnEnter:!1,_allowSubmit:!1,_submitBlock:null,_cancellationListeners:null,_stack:new Array,_auxillaryValidationErrors:{},INTL_FLOAT_PATTERN:/^\d*,\d?\d?$/,init:function(e,t,n,a,i,o,s){if(Form._formElem&&Form._push(),e=elt(e),Form._formElem=e,window.onbeforeunload=Form._navigate,Form._cancellationListeners=$(e).find("[type='submit'][name='cancel'],[type='button'][name='cancel']"),Form._cancellationListeners.on("click.form_js"+Form._stack.length,(function(e){Form._cancelled(e,n)})),a)for(const e in a.sections){let t=a.sections[e].prefix;if(t?t+=".":t="",window.Validators){const n=Validators[e];for(const e in n){const a=n[e];"date"==a.type?Form.interpretDateFieldOnChange(t+e):"float"==a.type?Form.interpretFloatSeparatorOnChange(t+e):"url"==a.implicit_type?Form.qualifyUrlFieldOnChange(t+e):"isrc"==a.type?Form.interpretISRCFieldOnChange(t+e):"iswc"==a.type?Form.interpretISWCFieldOnChange(t+e):"upc"==a.type&&Form.interpretUPCFieldOnChange(t+e)}}else Log.debug("Form.init: no form Validators installed")}$(e).keydown(Form.filter_returnkey).submit(Form._submitted),Form._lifeBoatEnabled=!(!t||!t.length),Form._lifeBoatMsg=t||"There are unsaved changes here. If you continue, you will lose them.";const r=Url.getQueryParam(location.toString(),"show_alert");switch(r){case null:case void 0:break;case"all":$(".alert").addClass("alertActive").each((function(){this.innerHTML="error text: "+this.id+" lorem ipsum dolor sit amet."}));break;default:(e=Form.validate.get_alert_elt(r)||elt(r))&&($(e).addClass("alertActive"),e.innerHTML="error text: "+e.id+" lorem ipsum dolor sit amet.")}a&&null==Url.getQueryParam(location.href,"novalidate")&&(Form._validateSections=a.sections,Form._validateMessages=a.messages,Form._onValidate=a.onValidate),Form._customSubmitter=i,Form._submitOnEnter=o,s||(Form._allowSubmit=!0)},extend:function(e,t,n){const a=elt(e);if(Form._formElem!=a)return void Log.debug("Form.extend: Form not initted, or wrong form is active: "+e);const i=Form._validateSections[t];if(!i)return void Log.debug("Form.extend: sectionName not found");let o=i.prefix;if(o?o+=".":o="",window.Validators){Form._extensions=Form._extensions||{},Form._extensions[t]=Form._extensions[t]||[],-1==Iter.index(Form._extensions[t],n)&&Form._extensions[t].push(n);const e=Validators[t];for(const t in e){const a=e[t];"date"==a.type?Form.interpretDateFieldOnChange(o+t+n):"float"==a.type?Form.interpretFloatSeparatorOnChange(o+t+n):"url"==a.implicit_type?Form.qualifyUrlFieldOnChange(o+t+n):"isrc"==a.type?Form.interpretISRCFieldOnChange(o+t+n):"iswc"==a.type?Form.interpretISWCFieldOnChange(o+t+n):"upc"==a.type&&Form.interpretUPCFieldOnChange(o+t+n)}}else Log.debug("Form.extend: no form Validators installed")},allowSubmit:function(){Form._allowSubmit=!0},_push:function(){const e={lifeBoatEnabled:Form._lifeBoatEnabled,formElem:Form._formElem,validateSections:Form._validateSections,validateMessages:Form._validateMessages,onValidate:Form._onValidate,customSubmitter:Form._customSubmitter,submitOnEnter:Form._submitOnEnter,allowSubmit:Form._allowSubmit,submitBlock:Form._submitBlock,cancellationListeners:Form._cancellationListeners,extensions:Form._extensions};Form._stack.push(e)},detach:function(){Form._lifeBoatEnabled=!1,Form._validateSections=null,Form._validateMessages=null,Form._onValidate=null,Form._submitOnEnter=!1,Form._allowSubmit=!1,Form._submitBlock=null,Form._extensions=null,Form._cancellationListeners.off("click.form_js"+Form._stack.length),Form._cancellationListeners=null,Form._formElem=null,Form._pop()},setSubmitBlock:function(e){Form._submitBlock=e},interpretDateFieldOnChange:function(e){let t=Form._formElem.elements[e];$(t).on("change",(function(){const e=Time.strToDate(this.value);if(e){const t=Time.to_ui(e,4);t!=this.value&&(this.value=t)}})),t=null},interpretFloatSeparatorOnChange:function(e){let t=Form._formElem.elements[e];$(t).on("change",Form.validate.priceOnChangeHandler),t=null},qualifyUrlFieldOnChange:function(e){let t=Form._formElem.elements[e];$(t).on("change",(function(){let e=U.trim(this.value);e=e.replace(/^(https?:)(\w)/i,"$1//$2"),""!=e&&-1==e.search(/^https?:\/\//i)&&(e="http://"+e),this.value=e})),t=null},interpretISRCFieldOnChange:function(e){let t=Form._formElem.elements[e];$(t).on("change",(function(){const e=Form.validate.isrc(U.trim(this.value));e&&(this.value=e)})),t=null},interpretISWCFieldOnChange:function(e){let t=Form._formElem.elements[e];$(t).on("change",(function(){const e=Form.validate.iswc(U.trim(this.value));e&&(this.value=e)})),t=null},interpretUPCFieldOnChange:function(e){let t=Form._formElem.elements[e];$(t).on("change",(function(){const e=Form.validate.upc(this.value);e&&(this.value=e)})),t=null},disableLifeboat:function(){Form._lifeBoatEnabled=!1},_isCancelButton:function(e){return"cancel"==e.name},filter_returnkey:function(e){return e&&13==e.keyCode&&("TEXTAREA"!=e.target.tagName&&U.stopEvent(e),Form._submitOnEnter&&Form._submitted(e)),!0},_submitted:function(e){const t=e.target;if(t!=Form._formElem&&$(t).parents("form")[0]!=Form._formElem)return;Form.validate.clear_alerts();let n=null;if(Form._validateSections&&!Form._isCancelButton(t)&&(n=Form.validateAndShowErrors()),n&&n.length>0)return U.stopEvent(e),n;Form._customSubmitter&&Form._customSubmitter(e)},_pop:function(){if(Form._stack.length>0){const e=Form._stack.pop();Form._lifeBoatEnabled=e.lifeBoatEnabled,Form._formElem=e.formElem,Form._validateSections=e.validateSections,Form._validateMessages=e.validateMessages,Form._onValidate=e.onValidate,Form._customSubmitter=e.customSubmitter,Form._submitOnEnter=e.submitOnEnter,Form._allowSubmit=e.allowSubmit,Form._submitBlock=e.submitBlock,Form._cancellationListeners=e.cancellationListeners,Form._extensions=e.extensions}},_cancelled:function(e,t){U.stopEvent(e),Form._lifeBoatEnabled=!1,t&&(location.href=t)},validateAndShowErrors:function(e){e||(e=Form._validateSections),$assert(e);const t=[];for(const o in e){const s=e[o],r=Form._extensions?Form._extensions[o]:null;if(r&&r.length>0){for(var n=[],a=0,i=r.length;a<i;++a)n=n.concat(Form.validate.check_field_errors(o,s,r[a])||[]);0==n.length&&(n=null)}else n=Form.validate.check_field_errors(o,s);if(n)for(a=0;a<n.length;a++){const e=n[a];Log.warn('error in field "'+e.field+'": '+e.reason,e),Form.validate.show_alert(e),t.push(e)}}return t&&t.length&&this.revealError(),t},revealError:function(){try{let e=null;const t=$(".alertActive")[0],n=t.id.match(/^(.*)[\_\-]alert$/);n&&(e=$("#"+n[1])[0],Log.warn(e?"using alt elt":"using err elt"));const a=e?-10:-50;Dom.scrollToElement(e||t,a)}catch(e){Log.error("validate: error scrolling to reveal error message")}},formIsDirty:function(e){if((e=elt(e)).lifeboatDirty)return!0;const t=e.elements;for(let e=0;e<t.length;e++){const n=t[e];if(Form.fieldIsDirty(n))return Log.info("Form element "+n.name+" is dirty."),!0}return!1},formIsNotDirty:function(e){(e=elt(e)).lifeboatDirty&&(e.lifeboatDirty=!1);const t=e.elements;for(let e=0;e<t.length;e++){const n=t[e];Form.fieldIsNotDirty(n)}$(e).triggerHandler("undirty")},dirtyForm:function(e){(e=e?elt(e):Form._formElem)&&"FORM"!=e.tagName.toUpperCase()&&(e=$(e).parents("form")[0]),e&&(e.lifeboatDirty=!0,$(e).triggerHandler("dirty"))},unDirty:function(){Form._lifeBoatEnabled&&Form.formIsNotDirty(Form._formElem)},fieldIsDirty:function(e){if(!e.name)return!1;if("button"==e.tagName.toLowerCase())return!1;switch(e.type){case"checkbox":case"radio":if(e.checked!=e.defaultChecked)return!0;break;case"submit":case"reset":case"image":case"button":case"hidden":return!1;case"select-one":var t,n=e.options,a=!1;for(let e=0;e<n.length;e++){const i=n[e];i.defaultSelected&&(a=!0),i.defaultSelected!=i.selected&&(t=e)}if(null!=t&&(a||t>0))return!0;break;default:if(e.defaultValue!=e.value)return!0}return!1},fieldIsNotDirty:function(e){switch(e.type){case"checkbox":case"radio":e.defaultChecked=e.checked;break;case"submit":case"reset":case"image":case"button":case"hidden":break;case"select-one":var t=e.options;for(let e=0;e<t.length;e++){const n=t[e];n.defaultSelected=n.selected}break;default:e.defaultValue=e.value}},_navigate:function(){if(Form._lifeBoatEnabled&&Form.formIsDirty(Form._formElem))return Form._lifeBoatMsg},validate:{check_field_errors:function(e,t,n){if(!window.Validators)return Log.debug("Form.validate: no form Validators installed"),null;n=n||"";const a=Validators[e];let i=null;for(let e in a){const o=a[e];t.prefix&&(e=t.prefix+"."+e+n);const s=Form.validate.check_value_error(e,o)||Form._auxillaryValidationErrors[e];s&&(n&&(s.suffix=n),i||(i=[]),i[i.length]=s,Log.info("field failed validation: "+e))}return i},check_value_error:function(e,t){const n=Form._formElem.elements[e];if(!n)return null;if("hidden"==n.type&&!$(n).hasClass("validate-hidden"))return null;if(n.disabled)return null;if(!t)return Log.debug("no validator"),null;let a=Form.validate._check_value_error_inner(e,t,n);if(Form._onValidate){const i=Form._onValidate(n,e,t,a);void 0!==i&&(Log.debug("onValidate override for field: "+e+"; previous error: "+(a?a.reason:"none")),a=i)}return a},_check_value_error_inner:function(e,t,n,a){if(!(a=U.trim(void 0===a?n.value:a))||"checkbox"==n.type&&!n.checked)return t.req&&("function"!=typeof t.req||t.req(e))?(Log.warn("required field "+e+" empty"),{reason:"missingValue",field:e,validator:t}):null;switch(t.type){case"int":var i=parseInt(a);if(isNaN(i)||null!=t.max&&i>t.max||null!=t.min&&i<t.min||!a.match(/^\d+$/))return Log.warn("bad number: "+e),{reason:"badNumber",field:e,max:t.max,min:t.min,validator:t};break;case"float":i=parseFloat(a);if(isNaN(i)||null!=t.max&&i>t.max||null!=t.min&&i<t.min||!a.match(/^\d*(\.\d+)?$/))return Log.warn("bad float: "+e),{reason:"badNumber",field:e,max:t.max,min:t.min,validator:t};break;case"text":if(null!=t.max&&a.length>t.max||null!=t.min&&a.length<t.min)return Log.warn("string length out of range: "+e),{reason:"stringLength",field:e,max:t.max,min:t.min,validator:t};break;case"date":var o=Form.validate.validate_date(a);if(U.isString(o))return Log.warn("bad date: "+e),{reason:o,field:e,validator:t};$assert(o);var s=Time.to_ui(o,4);s!=a&&(n.value=s);break;case"isrc":if(!Form.validate.isrc(a,t))return Log.warn("bad isrc: "+e),{reason:"badisrc",field:e,validator:t};break;case"iswc":if(!Form.validate.iswc(a,t))return Log.warn("bad iswc: "+e),{reason:"badiswc",field:e,validator:t};break;case"upc":var r=Form.validate.upc(a,t);if(!r)return Log.warn("bad upc: "+e),{reason:"badupc",field:e,validator:t};n.value=r}if(t.match&&(rex=new RegExp(t.match),!rex.test(a)))return Log.warn("failed pattern match: "+e),{reason:"badFormat",field:e,customMessage:t.message,validator:t};if(t.clientproc){let n;switch(t.clientproc){case"EditTralbum.validate_tralbum_tags":n=EditTralbum.validate_tralbum_tags;break;case"EditTralbum.validate_track_about":n=EditTralbum.validate_track_about;break;case"EditTralbum.validate_track_lyrics":n=EditTralbum.validate_track_lyrics;break;case"EditTralbum.validate_track_credits":n=EditTralbum.validate_track_credits;break;case"CatNumber.validate_catalog_number":n=CatNumber.validate_catalog_number}if(!n)return Log.server("Unknown clientproc validator: "+t.clientproc,"error"),null;try{const i=n(e,a);if(i)return i.validator=t,i}catch(e){Log.error("validate: error executing clientproc: "+t.clientproc)}}return null},parsePrice:function(e){return 0==(e=U.trim(e)).search(Form.INTL_FLOAT_PATTERN)&&(e=e.replace(",",".")),parseFloat(e)},validate_date:function(e){const t=Time.strToDate(e);if(t){const e=t.getFullYear();return e>2037||e<1902?"dateOutOfRange":t}return"dateFormat"},validate_price:function(e,t,n,a,i,o,s,r){const l=a?elt(a):Form.validate.get_alert_elt(e),c=elt(e)||Form._formElem.elements[e];if(c){const a=U.trim(c.value);if(0==a.length&&l){if(t)return Log.debug("Missing required price for ",e),FormUtils.showHideAlert(l,i||"Please provide the price."),$(c).addClass("has-validation-error"),!1}else if(n&&l&&(price=Form.validate.parsePrice(a),!isNaN(price))){if(r&&0==price&&s)return Log.debug("Zero price is not allowed for ",e),FormUtils.showHideAlert(l,s),$(c).addClass("has-validation-error"),!1;if(price<n&&(r||0!=price)){Log.debug("Price out of range for ",e);const t=o||"This price is too small to process.  Please enter "+(r?"":"either zero, or ")+TextFormat.currency(n,CurrencyData.current,!1,!0,!0)+" or more.";return FormUtils.showHideAlert(l,t),$(c).addClass("has-validation-error"),!1}}}return!0},validate_price_nonzero:function(e,t,n,a,i,o,s){return Form.validate.validate_price(e,t,n,a,i,o,s,!0)},priceOnChangeHandler:function(e){const t=U.trim(this.value);""!=t&&0==t.search(Form.INTL_FLOAT_PATTERN)&&(this.value=t.replace(",","."))},check_email_typos:function(e,t,n,a){if(a)var i=console.log;else i=function(){};if(!e||""===e)return null;const o=e.split("@"),s=o[0].toLowerCase(),r=o[1].toLowerCase(),l=function(e,t,n){if(i("NAME TYPO"),!t||""==t||!n||""==n)return null;const a={Á:"A",Ă:"A",Ắ:"A",Ặ:"A",Ằ:"A",Ẳ:"A",Ẵ:"A",Ǎ:"A",Â:"A",Ấ:"A",Ậ:"A",Ầ:"A",Ẩ:"A",Ẫ:"A",Ä:["A","AE"],Ǟ:"A",Ȧ:"A",Ǡ:"A",Ạ:"A",Ȁ:"A",À:"A",Ả:"A",Ȃ:"A",Ā:"A",Ą:"A",Å:["A","AA"],Ǻ:"A",Ḁ:"A",Ⱥ:"A",Ã:"A",Ꜳ:"AA",Æ:"[AE,E]",Ǽ:"AE",Ǣ:"AE",Ꜵ:"AO",Ꜷ:"AU",Ꜹ:"AV",Ꜻ:"AV",Ꜽ:"AY",Ḃ:"B",Ḅ:"B",Ɓ:"B",Ḇ:"B",Ƀ:"B",Ƃ:"B",Ć:"C",Č:"C",Ç:"C",Ḉ:"C",Ĉ:"C",Ċ:"C",Ƈ:"C",Ȼ:"C",Ď:"D",Ḑ:"D",Ḓ:"D",Ḋ:"D",Ḍ:"D",Ɗ:"D",Ḏ:"D",ǲ:"D",ǅ:"D",Đ:"D",Ƌ:"D",Ǳ:"DZ",Ǆ:"DZ",É:"E",Ĕ:"E",Ě:"E",Ȩ:"E",Ḝ:"E",Ê:"E",Ế:"E",Ệ:"E",Ề:"E",Ể:"E",Ễ:"E",Ḙ:"E",Ë:"E",Ė:"E",Ẹ:"E",Ȅ:"E",È:"E",Ẻ:"E",Ȇ:"E",Ē:"E",Ḗ:"E",Ḕ:"E",Ę:"E",Ɇ:"E",Ẽ:"E",Ḛ:"E",Ꝫ:"ET",Ḟ:"F",Ƒ:"F",Ǵ:"G",Ğ:"G",Ǧ:"G",Ģ:"G",Ĝ:"G",Ġ:"G",Ɠ:"G",Ḡ:"G",Ǥ:"G",Ḫ:"H",Ȟ:"H",Ḩ:"H",Ĥ:"H",Ⱨ:"H",Ḧ:"H",Ḣ:"H",Ḥ:"H",Ħ:"H",Í:"I",Ĭ:"I",Ǐ:"I",Î:"I",Ï:"I",Ḯ:"I",İ:"I",Ị:"I",Ȉ:"I",Ì:"I",Ỉ:"I",Ȋ:"I",Ī:"I",Į:"I",Ɨ:"I",Ĩ:"I",Ḭ:"I",Ꝺ:"D",Ꝼ:"F",Ᵹ:"G",Ꞃ:"R",Ꞅ:"S",Ꞇ:"T",Ꝭ:"IS",Ĵ:"J",Ɉ:"J",Ḱ:"K",Ǩ:"K",Ķ:"K",Ⱪ:"K",Ꝃ:"K",Ḳ:"K",Ƙ:"K",Ḵ:"K",Ꝁ:"K",Ꝅ:"K",Ĺ:"L",Ƚ:"L",Ľ:"L",Ļ:"L",Ḽ:"L",Ḷ:"L",Ḹ:"L",Ⱡ:"L",Ꝉ:"L",Ḻ:"L",Ŀ:"L",Ɫ:"L",ǈ:"L",Ł:"L",Ǉ:"LJ",Ḿ:"M",Ṁ:"M",Ṃ:"M",Ɱ:"M",Ń:"N",Ň:"N",Ņ:"N",Ṋ:"N",Ṅ:"N",Ṇ:"N",Ǹ:"N",Ɲ:"N",Ṉ:"N",Ƞ:"N",ǋ:"N",Ñ:"N",Ǌ:"NJ",Ó:"O",Ŏ:"O",Ǒ:"O",Ô:"O",Ố:"O",Ộ:"O",Ồ:"O",Ổ:"O",Ỗ:"O",Ö:["O","OE"],Ȫ:"O",Ȯ:"O",Ȱ:"O",Ọ:"O",Ő:"O",Ȍ:"O",Ò:"O",Ỏ:"O",Ơ:"O",Ớ:"O",Ợ:"O",Ờ:"O",Ở:"O",Ỡ:"O",Ȏ:"O",Ꝋ:"O",Ꝍ:"O",Ō:"O",Ṓ:"O",Ṑ:"O",Ɵ:"O",Ǫ:"O",Ǭ:"O",Ø:["O","OE"],Ǿ:"O",Õ:"O",Ṍ:"O",Ṏ:"O",Ȭ:"O",Ƣ:"OI",Ꝏ:"OO",Ɛ:"E",Ɔ:"O",Ȣ:"OU",Ṕ:"P",Ṗ:"P",Ꝓ:"P",Ƥ:"P",Ꝕ:"P",Ᵽ:"P",Ꝑ:"P",Ꝙ:"Q",Ꝗ:"Q",Ŕ:"R",Ř:"R",Ŗ:"R",Ṙ:"R",Ṛ:"R",Ṝ:"R",Ȑ:"R",Ȓ:"R",Ṟ:"R",Ɍ:"R",Ɽ:"R",Ꜿ:"C",Ǝ:"E",Ś:"S",Ṥ:"S",Š:"S",Ṧ:"S",Ş:"S",Ŝ:"S",Ș:"S",Ṡ:"S",Ṣ:"S",Ṩ:"S",Ť:"T",Ţ:"T",Ṱ:"T",Ț:"T",Ⱦ:"T",Ṫ:"T",Ṭ:"T",Ƭ:"T",Ṯ:"T",Ʈ:"T",Ŧ:"T",Ɐ:"A",Ꞁ:"L",Ɯ:"M",Ʌ:"V",Ꜩ:"TZ",Ú:"U",Ŭ:"U",Ǔ:"U",Û:"U",Ṷ:"U",Ü:["U","UE"],Ǘ:"U",Ǚ:"U",Ǜ:"U",Ǖ:"U",Ṳ:"U",Ụ:"U",Ű:"U",Ȕ:"U",Ù:"U",Ủ:"U",Ư:"U",Ứ:"U",Ự:"U",Ừ:"U",Ử:"U",Ữ:"U",Ȗ:"U",Ū:"U",Ṻ:"U",Ų:"U",Ů:"U",Ũ:"U",Ṹ:"U",Ṵ:"U",Ꝟ:"V",Ṿ:"V",Ʋ:"V",Ṽ:"V",Ꝡ:"VY",Ẃ:"W",Ŵ:"W",Ẅ:"W",Ẇ:"W",Ẉ:"W",Ẁ:"W",Ⱳ:"W",Ẍ:"X",Ẋ:"X",Ý:"Y",Ŷ:"Y",Ÿ:"Y",Ẏ:"Y",Ỵ:"Y",Ỳ:"Y",Ƴ:"Y",Ỷ:"Y",Ỿ:"Y",Ȳ:"Y",Ɏ:"Y",Ỹ:"Y",Ź:"Z",Ž:"Z",Ẑ:"Z",Ⱬ:"Z",Ż:"Z",Ẓ:"Z",Ȥ:"Z",Ẕ:"Z",Ƶ:"Z",Ĳ:"IJ",Œ:"OE",ᴀ:"A",ᴁ:"AE",ʙ:"B",ᴃ:"B",ᴄ:"C",ᴅ:"D",ᴇ:"E",ꜰ:"F",ɢ:"G",ʛ:"G",ʜ:"H",ɪ:"I",ʁ:"R",ᴊ:"J",ᴋ:"K",ʟ:"L",ᴌ:"L",ᴍ:"M",ɴ:"N",ᴏ:"O",ɶ:"OE",ᴐ:"O",ᴕ:"OU",ᴘ:"P",ʀ:"R",ᴎ:"N",ᴙ:"R",ꜱ:"S",ᴛ:"T",ⱻ:"E",ᴚ:"R",ᴜ:"U",ᴠ:"V",ᴡ:"W",ʏ:"Y",ᴢ:"Z",á:"a",ă:"a",ắ:"a",ặ:"a",ằ:"a",ẳ:"a",ẵ:"a",ǎ:"a",â:"a",ấ:"a",ậ:"a",ầ:"a",ẩ:"a",ẫ:"a",ä:["a","ae"],ǟ:"a",ȧ:"a",ǡ:"a",ạ:"a",ȁ:"a",à:"a",ả:"a",ȃ:"a",ā:"a",ą:"a",ᶏ:"a",ẚ:"a",å:["a","aa"],ǻ:"a",ḁ:"a",ⱥ:"a",ã:"a",ꜳ:"aa",æ:"[ae,e]",ǽ:"ae",ǣ:"ae",ꜵ:"ao",ꜷ:"au",ꜹ:"av",ꜻ:"av",ꜽ:"ay",ḃ:"b",ḅ:"b",ɓ:"b",ḇ:"b",ᵬ:"b",ᶀ:"b",ƀ:"b",ƃ:"b",ɵ:"o",ć:"c",č:"c",ç:"c",ḉ:"c",ĉ:"c",ɕ:"c",ċ:"c",ƈ:"c",ȼ:"c",ď:"d",ḑ:"d",ḓ:"d",ȡ:"d",ḋ:"d",ḍ:"d",ɗ:"d",ᶑ:"d",ḏ:"d",ᵭ:"d",ᶁ:"d",đ:"d",ɖ:"d",ƌ:"d",ı:"i",ȷ:"j",ɟ:"j",ʄ:"j",ǳ:"dz",ǆ:"dz",é:"e",ĕ:"e",ě:"e",ȩ:"e",ḝ:"e",ê:"e",ế:"e",ệ:"e",ề:"e",ể:"e",ễ:"e",ḙ:"e",ë:"e",ė:"e",ẹ:"e",ȅ:"e",è:"e",ẻ:"e",ȇ:"e",ē:"e",ḗ:"e",ḕ:"e",ⱸ:"e",ę:"e",ᶒ:"e",ɇ:"e",ẽ:"e",ḛ:"e",ꝫ:"et",ḟ:"f",ƒ:"f",ᵮ:"f",ᶂ:"f",ǵ:"g",ğ:"g",ǧ:"g",ģ:"g",ĝ:"g",ġ:"g",ɠ:"g",ḡ:"g",ᶃ:"g",ǥ:"g",ḫ:"h",ȟ:"h",ḩ:"h",ĥ:"h",ⱨ:"h",ḧ:"h",ḣ:"h",ḥ:"h",ɦ:"h",ẖ:"h",ħ:"h",ƕ:"hv",í:"i",ĭ:"i",ǐ:"i",î:"i",ï:"i",ḯ:"i",ị:"i",ȉ:"i",ì:"i",ỉ:"i",ȋ:"i",ī:"i",į:"i",ᶖ:"i",ɨ:"i",ĩ:"i",ḭ:"i",ꝺ:"d",ꝼ:"f",ᵹ:"g",ꞃ:"r",ꞅ:"s",ꞇ:"t",ꝭ:"is",ǰ:"j",ĵ:"j",ʝ:"j",ɉ:"j",ḱ:"k",ǩ:"k",ķ:"k",ⱪ:"k",ꝃ:"k",ḳ:"k",ƙ:"k",ḵ:"k",ᶄ:"k",ꝁ:"k",ꝅ:"k",ĺ:"l",ƚ:"l",ɬ:"l",ľ:"l",ļ:"l",ḽ:"l",ȴ:"l",ḷ:"l",ḹ:"l",ⱡ:"l",ꝉ:"l",ḻ:"l",ŀ:"l",ɫ:"l",ᶅ:"l",ɭ:"l",ł:"l",ǉ:"lj",ſ:"s",ẜ:"s",ẛ:"s",ẝ:"s",ḿ:"m",ṁ:"m",ṃ:"m",ɱ:"m",ᵯ:"m",ᶆ:"m",ń:"n",ň:"n",ņ:"n",ṋ:"n",ȵ:"n",ṅ:"n",ṇ:"n",ǹ:"n",ɲ:"n",ṉ:"n",ƞ:"n",ᵰ:"n",ᶇ:"n",ɳ:"n",ñ:"n",ǌ:"nj",ó:"o",ŏ:"o",ǒ:"o",ô:"o",ố:"o",ộ:"o",ồ:"o",ổ:"o",ỗ:"o",ö:["o","oe"],ȫ:"o",ȯ:"o",ȱ:"o",ọ:"o",ő:"o",ȍ:"o",ò:"o",ỏ:"o",ơ:"o",ớ:"o",ợ:"o",ờ:"o",ở:"o",ỡ:"o",ȏ:"o",ꝋ:"o",ꝍ:"o",ⱺ:"o",ō:"o",ṓ:"o",ṑ:"o",ǫ:"o",ǭ:"o",ø:["o","oe"],ǿ:"o",õ:"o",ṍ:"o",ṏ:"o",ȭ:"o",ƣ:"oi",ꝏ:"oo",ɛ:"e",ᶓ:"e",ɔ:"o",ᶗ:"o",ȣ:"ou",ṕ:"p",ṗ:"p",ꝓ:"p",ƥ:"p",ᵱ:"p",ᶈ:"p",ꝕ:"p",ᵽ:"p",ꝑ:"p",ꝙ:"q",ʠ:"q",ɋ:"q",ꝗ:"q",ŕ:"r",ř:"r",ŗ:"r",ṙ:"r",ṛ:"r",ṝ:"r",ȑ:"r",ɾ:"r",ᵳ:"r",ȓ:"r",ṟ:"r",ɼ:"r",ᵲ:"r",ᶉ:"r",ɍ:"r",ɽ:"r",ↄ:"c",ꜿ:"c",ɘ:"e",ɿ:"r",ś:"s",ṥ:"s",š:"s",ṧ:"s",ş:"s",ŝ:"s",ș:"s",ṡ:"s",ṣ:"s",ṩ:"s",ʂ:"s",ᵴ:"s",ᶊ:"s",ȿ:"s",ɡ:"g",ᴑ:"o",ᴓ:"o",ᴝ:"u",ť:"t",ţ:"t",ṱ:"t",ț:"t",ȶ:"t",ẗ:"t",ⱦ:"t",ṫ:"t",ṭ:"t",ƭ:"t",ṯ:"t",ᵵ:"t",ƫ:"t",ʈ:"t",ŧ:"t",ᵺ:"th",ɐ:"a",ᴂ:"ae",ǝ:"e",ᵷ:"g",ɥ:"h",ʮ:"h",ʯ:"h",ᴉ:"i",ʞ:"k",ꞁ:"l",ɯ:"m",ɰ:"m",ᴔ:"oe",ɹ:"r",ɻ:"r",ɺ:"r",ⱹ:"r",ʇ:"t",ʌ:"v",ʍ:"w",ʎ:"y",ꜩ:"tz",ú:"u",ŭ:"u",ǔ:"u",û:"u",ṷ:"u",ü:["u","ue"],ǘ:"u",ǚ:"u",ǜ:"u",ǖ:"u",ṳ:"u",ụ:"u",ű:"u",ȕ:"u",ù:"u",ủ:"u",ư:"u",ứ:"u",ự:"u",ừ:"u",ử:"u",ữ:"u",ȗ:"u",ū:"u",ṻ:"u",ų:"u",ᶙ:"u",ů:"u",ũ:"u",ṹ:"u",ṵ:"u",ᵫ:"ue",ꝸ:"um",ⱴ:"v",ꝟ:"v",ṿ:"v",ʋ:"v",ᶌ:"v",ⱱ:"v",ṽ:"v",ꝡ:"vy",ẃ:"w",ŵ:"w",ẅ:"w",ẇ:"w",ẉ:"w",ẁ:"w",ⱳ:"w",ẘ:"w",ẍ:"x",ẋ:"x",ᶍ:"x",ý:"y",ŷ:"y",ÿ:"y",ẏ:"y",ỵ:"y",ỳ:"y",ƴ:"y",ỷ:"y",ỿ:"y",ȳ:"y",ẙ:"y",ɏ:"y",ỹ:"y",ź:"z",ž:"z",ẑ:"z",ʑ:"z",ⱬ:"z",ż:"z",ẓ:"z",ȥ:"z",ẕ:"z",ᵶ:"z",ᶎ:"z",ʐ:"z",ƶ:"z",ɀ:"z",ﬀ:"ff",ﬃ:"ffi",ﬄ:"ffl",ﬁ:"fi",ﬂ:"fl",ĳ:"ij",œ:"oe",ﬆ:"st",ₐ:"a",ₑ:"e",ᵢ:"i",ⱼ:"j",ₒ:"o",ᵣ:"r",ᵤ:"u",ᵥ:"v",ₓ:"x"};let o=1;Object.keys(a).forEach((function(e){o=Math.max(o,Array.isArray(a[e])?a[e].length:1)})),e=e.toLowerCase();const s=d(t),r=d(n);t=s[0],n=r[0];const l=s[1],c=r[1];function d(e){const t=new RegExp("[^A-Za-z0-9\\[\\] ]","g"),n=new RegExp("(^(\\w )+)|(( \\w)+$)","g");let i=[];if(t.test(e)){i[o-1]="",i.fill("");const n=function(e){for(let t=0;t<i.length;t++)i[t]+=e};for(var s=0;s<e.length;s++){const o=e[s];if(t.test(o))if(a[o]&&Array.isArray(a[o]))for(let e=0;e<a[o].length;e++)i[e]+=a[o][e];else n(a[o]?a[o]:e[s]);else n(e[s])}}else i=[e];i=i.filter((function(e,t,n){return t==n.indexOf(e)}));for(s=0;s<i.length;s++)i[s]=i[s].replace(n,"").toLowerCase().replace(/[^a-z]/g,"");return[i.pop(),i]}if(i(t),i(n),i(l),i(c),p(t,n)||p(t,t[0]+n)||p(n[0]+t,n))return null;function p(e,t){const n=e.length<t.length?e:t,a=e.length<t.length?t:e;i("checking for similarities in first and last name");for(let e=0;e<a.length-(n.length-1);e++){const t=a.substring(e,n.length+1+e);if(u(n,t)||u(t,n))return!0}}const g={jenny:"jenni",peter:"pete",ann:"an",jono:"jona",joe:"jose",charlie:"charle",paul:"pabl"};let _,b=[],v=f(e,0,t);if(v){const t=e.substring(0,v.elem.index)+v.newLeftPart;(v.elem.orig==g[v.elem.correction]||m(v.elem.orig,l)||h(n,e)&&!h(n,t))&&(v=null)}v?v.elem.index+t.length+n.length>e.length?(_=e,T=0):(_=v.newLeftPart,T=v.startIndex):(_=e,T=0);let y=f(_,T,n);y&&m(y.elem.orig,c)&&(y=null);i(v),i(y);const w=[];v&&!v.found&&w.push(v.elem);y&&!y.found&&w.push(y.elem);const k=new RegExp("(.*)\\.\\.(.*)");let x=e;for(;k.test(x);){const e=k.exec(x);i(e),x=e[1]+"."+e[2],w.push({index:e[1].length,orig:"..",correction:"."})}if(0==w.length)return null;w.sort((function(e,t){return e.index-t.index}));var T=0;for(let t=0;t<w.length;t++)b.push({orig:e.substring(T,w[t].index)}),b.push({orig:w[t].orig,correction:w[t].correction}),T=w[t].index+w[t].orig.length;return b.push({orig:e.substring(T)}),b=b.filter((function(e){return e.correction||""!=e.orig})),i(b),b}(s,t,n),c=function(e){i("DOMAIN TYPO");const t=["gmail","hotmail","outlook","yahoo","icloud","mail","mac","aol","zoho"],n=e.split("."),a=n.shift(),o=n.join("."),s=o.split("."),r=s[s.length-1];let l,c,d=[];const p=new RegExp("\\d+");if(p.test(r)||"con"===r){for(c=r;p.test(c);)c=c.replace(p,"");c="con"===c?"com":c}for(let e=0;e<t.length;e++){const n=t[e];if(i(n),!(a.length>n.length+1||a.length<n.length-1)){if(a==n){if(!c)return null}else l=u(a,n,!0),l&&l.orig!=a&&(l=null);if(l||c){d=[];const e={orig:a},t={orig:o};return l&&(e.correction=l.correction),c&&(s[s.length-1]=c,t.correction=s.join(".")),d.push(e),d.push({orig:"."}),d.push(t),i(d),d}}}return null}(r),d={userEmail:e};if(!l&&!c)return null;d.snippets=function(t){const n=[],a=e.split("@");for(let e=0;e<t.length;e++){if(t[e])for(let a=0;a<t[e].length;a++)n.push(t[e][a]);else n.push({orig:a[e]});0==e&&n.push({orig:"@"})}return n}([l,c]),d.correctedEmail=function(e){let t="";for(let n=0;n<e.length;n++)t+=e[n].correction||e[n].orig;return t}(d.snippets),d.correctedEmail==d.userEmail&&(d.correctedEmail=null);const p=d.correctedEmail.split("@");return l&&(d.personalSection=p[0]),c&&(d.domainSection=p[1]),i(d),d;function u(e,t,n){if(i("check for close match: "+(n?"strict":"loose")),t.length<3)return null;if(n){if(t===e)return i("shortString "+t+" = longString "+e),null}else{const n=new RegExp("(.?)"+t+"(.?)");if(n.test(e))return i(e+" contains "+t),{orig:t,correction:t,before:(a=n.exec(e))[1],after:a[a.length-1]}}i(e),i(t);for(let o=1;o<=t.length;o++){const s=t.substring(0,o),r=t.substring(o),l=new RegExp("[a-z]");var a;if((a=new RegExp(s+"(.)"+r).exec(e))&&(i("extra letter match"),n||!n&&/[A-Za-z0-9]/.test(a[1])))return i("extra letter: "+s+", "+r),i(a),{orig:s+a[1]+r,correction:t,before:"",after:""};if((a=new RegExp("(.?)"+s+"(.)"+r.substring(1)+"(.?)").exec(e))&&(i("wrong letter match"),l.test(a[2])))return i("wrong letter: "+s+", "+r.substring(1)),i(a),{orig:s+a[2]+r.substring(1),correction:t,before:a[1],after:a[a.length-1]};if("mail"!==r){const o=s.substring(0,s.length-1);if((a=new RegExp("(.*)"+o+r+"(.*)").exec(e))&&(i("missing letter match"),n||!n&&""!=o&&1!=s.length&&s!=t[0]))return i("missing letter: "+o+", "+r),i(a),{orig:o+r,correction:t,before:a[1],after:a[a.length-1]}}const c=t.substring(0,o-1),d=t.substring(o+1),p=t.charAt(o)+t.charAt(o-1);if(a=new RegExp("(.?)"+c+p+d+"(.?)").exec(e))return i("switched letter match"),i("switched letters: "+c+", "+d),i(a),{orig:c+p+d,correction:t,before:a[1],after:a[a.length-1]}}return null}function m(e,t){return t.indexOf(e)>-1}function h(e,t){return-1!=t.indexOf(e)}function f(e,t,n){if(i(""),i("searchForName"),i(e),i(""),e.length<n.length-1||n.length<2)return null;const a=e.substring(0,n.length+1);let o=e.substring(n.length+1),s=u(a,n);if(i(s),s&&(o=e.substring(s.before.length+s.orig.length),i({orig:s.orig,theRest:o,correction:n})),s&&s.orig!==s.correction&&(s.orig===n.substring(0,s.orig.length)&&o[0]==n[n.length-1]||s.orig.substring(0,n.length-1)===n.substring(0,n.length-1))&&(i("ignoring result"),s=null),t+=s?s.before.length:0,s&&s.orig==s.correction)return{found:!0,newLeftPart:o,startIndex:t+n.length,elem:{index:t,orig:s.orig}};if(s){const e=s.orig.length-s.correction.length,a={newLeftPart:o,startIndex:t+n.length+e,elem:{index:t,orig:s.orig,correction:n}};return i("toReturn",a),a}return f(e.substring(1),t+1,n)}},isrc:function(e,t){let n,a;return n=e.replace(/ |-|\//g,"").toUpperCase(),12!=n.length?null:(a=n.substr(0,2),a.match(/[A-Z]{2,2}/)&&n.substr(2,3).match(/[0-9A-Z]{3,3}/)&&n.substr(5,7).match(/[0-9]{7,7}/)?n.substr(0,2)+"-"+n.substr(2,3)+"-"+n.substr(5,2)+"-"+n.substr(7,5):null)},iswc:function(e,t){const n=e.replace(/ |[.]|-|\//g,"").toUpperCase();return n.match(/^[A-Z]{1}\d{10}$/)?"".concat(n.substr(0,1),"-").concat(n.substr(1,3),".").concat(n.substr(4,3),".").concat(n.substr(7,3),"-").concat(n.substr(10,1)):null},upc:function(e,t){let n;return n=e.replace(/ |-|\//g,""),12!=n.length&&13!=n.length||n.match(/[^0-9]/)?null:12==n.length?n.substr(0,6)+" "+n.substr(6,6):n.substr(0,7)+" "+n.substr(7,6)},upc_checksum:function(e,t){let n;if(n=e.replace(/ |-|\//g,""),12!=n.length&&13!=n.length)return null;if(n.match(/[^0-9]/))return null;const a=(12==n.length?"0"+n:n).split("").map((function(e){return parseInt(e)}));let i=!1,o=0;for(let e=0;e<12;e++)o+=i?3*a[e]:a[e],i=!i;const s=(10-o%10)%10;return a[12]!=s?null:12==n.length?n.substr(0,6)+" "+n.substr(6,6):n.substr(0,7)+" "+n.substr(7,6)},clear_alerts:function(){$(".alertActive").each((function(){FormUtils.showHideAlert(this,null)})),$(".has-validation-error",Form._formElem).removeClass("has-validation-error")},clear_alert:function(e){FormUtils.showHideAlert(e,null)},onchange_maybe_hide_alert:function(e){const t=e.target,n=e.data.err;if(n.validator&&!Form.validate.check_value_error(n.field,n.validator)){const e=Form.validate.get_alert_elt(n.field);$(t).removeClass("has-validation-error"),$(e).removeClass("alertActive"),Form.validate.remove_onchange_listeners(t)}},remove_onchange_listeners:function(e){$(e).off("keyup").off("change")},show_alerts:function(e,t){void 0===t&&(t=!0),e?U.isArray(e)||(e=[e]):e=[{field:"generic",reason:"generic"}];for(let t=0;t<e.length;t++)Form.validate.show_alert(e[t]);t&&Form.revealError()},show_alert:function(e){const t=Form.validate.get_alert_elt(e.field),n=Form.validate.get_error_text(e);if(t){FormUtils.showHideAlert(t,n);const a=Form._formElem.elements[e.field];$(a).addClass("has-validation-error").on("keyup",{err:e},Form.validate.onchange_maybe_hide_alert).on("change",{err:e},Form.validate.onchange_maybe_hide_alert)}else NuDialog.alertHTML("Oops!",n)},get_alert_elt:function(e){return elt(e+"_alert")||elt(e+"-alert")||$(Form._formElem.elements[e]).siblings(".alert")[0]||$(Form._formElem.elements[e]).siblings(".license-alert")[0]||$(Form._formElem.elements[e]).closest("label").siblings(".alert")[0]||$(Form._formElem.elements[e]).closest(".fieldHintWrapper").siblings(".alert")[0]||$(Form._formElem.elements[e]).closest(".jquery-placeholder-wrapper").siblings(".alert")[0]||$(Form._formElem.elements[e]).closest(".acWidget").siblings(".alert")[0]},get_error_text:function(e){const t=e.reason;let n=e.field;e.suffix&&n.lastIndexOf(e.suffix)==n.length-e.suffix.length&&(n=n.substring(0,n.length-e.suffix.length));let a=n;if(window.Validators&&Validators._fieldNames&&Validators._fieldNames[a]&&(a=Validators._fieldNames[a]),Form._validateMessages){const e=Form._validateMessages[n];if(e){const n=e[t];if(n)return n}}if(e.customMessage)return e.customMessage;switch(t){case"missingValue":return a?"Required field: "+a+".":"Required field.";case"badNumber":return null!=e.min&&null!=e.max?"A number between "+e.min+" and "+e.max+" is required.":null!=e.min?"A number (at least "+e.min+") is required.":null!=e.max?"A number (up to "+e.max+") is required.":"A number is required.";case"stringLength":return null!=e.min&&null!=e.max?"This value must be between "+e.min+" and "+e.max+" characters.":null!=e.min?"This value is too short (minimum length: "+e.min+" characters).":($assert(null!=e.max),"This value is too long (maximum length: "+e.max+" characters).");case"badFormat":return"Invalid "+a+" format.";case"dateFormat":return"Please enter a date in the form mm/dd/yyyy.";case"dateOutOfRange":return"Please enter a date between 1902 and 2037.";case"badisrc":return"Please enter a valid ISRC code (or leave blank).";case"badiswc":return"Please enter a valid ISWC code (or leave blank).";case"badupc":return"Please enter a valid UPC/EAN code (or leave blank)."}return a?"error: field="+a+", reason="+t:"error: "+t}}});var SimpleForm={submit:function(e,t,n){n=n||"post";const a=document.createElement("form");a.setAttribute("method",n),a.setAttribute("action",e);for(const e in t){const n=document.createElement("input");n.setAttribute("type","hidden"),n.setAttribute("name",e),n.setAttribute("value",t[e]),a.appendChild(n)}document.body.appendChild(a),a.submit()}},FormUtils={showHideAlert:function(e,t){(e=U.elt(e))&&("boolean"!=typeof t&&(e.innerHTML=t||""),t?$(e).addClass("alertActive"):($(e).removeClass("alertActive"),window.Form&&window.Form.validate&&Form.validate.remove_onchange_listeners(e)))}};if(!window.Cookie)throw"expected Cookie library";Cookie.CommChannel=function(e,t){$assert(Text.notEmpty(e)),this._id=Math.round(1e9*Math.random()),t&&(e+=this._id),this._channelName=e;const n=Cookie.CommChannel.COOKIE_NAME_PREFIX+e;this._cookieName=n+"_"+this._id,this._namePattern=new RegExp("^"+Text.regexpEscape(n)+"_(\\d+)$"),this._queue={last:0,msgs:[]},this._lastSeen={},this._scanTimer=null,Cookie.clear(this._cookieName)},Cookie.CommChannel.EVENT_NAME="cookiecomm_message",Cookie.CommChannel.COOKIE_NAME_PREFIX="_comm_",Cookie.CommChannel.MAX_QUEUE_SIZE=5,Cookie.CommChannel.SCAN_TIMEOUT=250,Cookie.CommChannel.COOKIE_MAX_AGE=5,Cookie.CommChannel.prototype={getName:function(){return this._channelName},startListening:function(){if(!this._scanTimer){const e=this,t=function(){e._scanAllQueues()};this._scanTimer=setInterval(t,Cookie.CommChannel.SCAN_TIMEOUT),Log.info("Cookie comm channel "+this.getName()+" started listening.")}},stopListening:function(){this._scanTimer&&(clearInterval(this._scanTimer),this._scanTimer=null,Log.info("Cookie comm channel "+this.getName()+" stopped listening."))},subscribe:function(e){$(document).on(Cookie.CommChannel.EVENT_NAME+"_"+this._id,e)},unsubscribe:function(e){$(document).off(Cookie.CommChannel.EVENT_NAME+"_"+this._id,e)},send:function(e){$assert(U.isString(e));const t=Iter.collect(arguments);Log.debug("Cookie comm channel "+this.getName()+" sending message "+t[0],t);for(let e=t.length-1;e>0&&null==t[e];e--)t.pop();const n=this._queue.msgs;n.push(t),this._queue.last++,n.length>Cookie.CommChannel.MAX_QUEUE_SIZE&&(this._queue.msgs=n.slice(1)),this._writeTimeout&&clearTimeout(this._writeTimeout);const a=this;this._writeTimeout=setTimeout((function(){a._writeQueue()}),0)},cleanup:function(){Cookie.clear(this._cookieName),this.stopListening(),this._lastSeen=this._queue=null},_writeQueue:function(){const e=JSON.stringify(this._queue);Cookie.set(this._cookieName,e,Cookie.CommChannel.COOKIE_MAX_AGE,null,null,!0,"None")},_scanAllQueues:function(){const e=Cookie.getAll();for(const t in e){const n=this._namePattern.exec(t);if(!n)continue;const a=n[1]-0;if(a===this._id)continue;const i=e[t];$assert(!U.isArray(i),"we expect only one cookie per name");const o=JSON.parse(i);this._scanOneQueue(a,o)}},_scanOneQueue:function(e,t){const n=t.last;$assert(U.isNumber(n));const a=n-(this._lastSeen[e]||0);if(a>0){const i=t.msgs.slice(-a);$assert(i.length),this._lastSeen[e]=n;for(let t=0;t<i.length;t++){const n=i[t];if(Log.debug("Cookie comm channel "+this.getName()+" received from "+e+" message "+n[0],n),n.unshift(e),$.event.trigger(Cookie.CommChannel.EVENT_NAME+"_"+this._id,[n]),!this._scanTimer)break}}}};var Player={};Player.TrackInfo=function(){function e(e){this.update(e)}e.prototype={update:function(e){const n=t;for(let t=0;t<n.length;t++)this[n[t]]=e[n[t]];return this},is_playable:function(){return!!this.file},is_busy:function(){return this.encoding_pending&&!this.encoding_error},mark_as_capped:function(){this.is_capped=!0},copy:function(){const e={},n=t;for(let t=0;t<n.length;t++)e[n[t]]=this[n[t]];return e}},e.is_same=function(e,n){const a=t;for(let t=0;t<a.length;t++)if(e[a[t]]!=n[a[t]])return!1;return!0};var t=["tracknum","file","encoding_error","encoding_pending","title","title_link","id","track_license_id","has_lyrics","has_info","is_downloadable","free_album_download","has_free_download","duration","private","album_private","artist","album_preorder","unreleased_track","alt_link","continuous","video_source_type","video_caption","video_id","video_mobile_url","is_capped"];return e}(),Player.Playlist=function(){function e(t,n,a,i){i=i||{},this._options=i,this._player=t,this._playlist=[],this._playing_from=n,i.url_params&&i.url_params.esig&&(i.url_params.album||i.url_params.track)&&(a+="&esig="+i.url_params.esig+"&rsig="+i.url_params.rsig+(i.url_params.album?"&album="+i.url_params.album:"&track="+i.url_params.track),this._url_referrer=i.url_params.url_referrer),this._referer=a,this._track=0,this._loadedtrack=-1,this._loadpercent=0,this._duration=null,this._state="IDLE",this._unloaded=!0,this._scrubbed=!1,this._trackstate=!i.no_trackstate,this._trackchanged=EventSender.create(this,"trackchanged"),this._trackplayed=EventSender.create(this,"trackplayed"),this._trackcapped=EventSender.create(this,"trackcapped"),this._scrubbedback=EventSender.create(this,"scrubbedback"),this._completedplay=EventSender.create(this,"completedplay"),this._playlistchanged=EventSender.create(this,"playlistchanged"),this._statechanged=EventSender.create(this,"statechanged"),this._loaded=EventSender.create(this,"loaded"),this._timechanged=EventSender.create(this,"time"),this.first_playable_track=-1,this.last_playable_track=-1,this._ui_listeners=new Object,this._usecomm=!0;const o=$("#pagedata").data("blob")||{};this._stream_buffer_duration_stats=o.cfg&&o.cfg.stream_buffer_duration_stats||null,this._buffering_start_time=null;const s=this;this._player.onstate((function(e,t){s._unloaded||s._handle_state({oldstate:s._state,newstate:t.newstate})})),this._player.ontime((function(e,t){s._unloaded||s._handle_time(t)})),this._player.onloaded((function(e,t){s._unloaded||s._handle_load(t)})),e.coordinator||(e.coordinator=new Player.PlaylistCoordinator),e.coordinator.add(this)}e.prototype={getoption:function(e){return this._options[e]},add_track:function(e){e=new Player.TrackInfo(e);if(this._url_referrer&&e.file)for(const t in e.file)e.file[t]+="&urlref="+document.URL.replace(/\&/g,"/");const t=this._playlist.push(e)-1;return this._playlist[t].tracknum=t,e.is_playable()&&(-1==this.first_playable_track&&(this.first_playable_track=t,this._track=t),this.last_playable_track=t),this._playlistchanged(),t},set_initial_track:function(e){this._playlist[e]&&this._playlist[e].is_playable()&&(this._track=e)},update_trackinfo:function(e,t){if(t.tracknum=e,t=this._playlist[e].update(t),this._loadedtrack=-1,t.is_playable())(-1==this.first_playable_track||e<this.first_playable_track)&&(this.first_playable_track=e),(-1==this.last_playable_track||e>this.last_playable_track)&&(this.last_playable_track=e);else{if(e==this.first_playable_track){this.first_playable_track=-1;for(var n=e+1;n<this._playlist.length;n++)if(this._playlist[n].is_playable()){this.first_playable_track=n;break}}if(e==this.last_playable_track){this.last_playable_track=-1;for(n=e-1;n>=0;n--)if(this._playlist[n].is_playable()){this.last_playable_track=n;break}}}this._playlistchanged(),"BUSY"==this._state&&t.is_playable()&&this.play()},playpause:function(){let e=null;switch(this._state){case"IDLE":case"COMPLETED":case"PAUSED":this.play(),e=1;break;case"PLAYING":case"BUFFERING":this._player.pause(),this._comm_stop(),e=-1;break;case"BUSY":this._player.stop(),this._comm_stop(),this._handle_state({newstate:"IDLE",oldstate:this._state}),e=0}return e},play:function(){let e=this._playlist[this._track];if(e&&e.is_capped)return this._reset(),void this._trackcapped(e.id);switch(this._state){case"IDLE":case"COMPLETED":case"BUSY":if(Log.debug("playlist loading track "+this._track),!e)break;for(;!e.is_playable()&&this._track<this.last_playable_track;)this._track++,e=this._playlist[this._track];if(!e.is_playable()&&1==this._playlist.length&&e.encoding_pending)this._handle_state({newstate:"BUSY",oldstate:this._state});else if(this._playlist[this._track].file&&(this._load(),this._player.play(),this._usecomm))try{this._comm_start(),this._stop_other_players()}catch(e){}break;case"PAUSED":case"BUFFERING":if(this._player.play(),this._usecomm)try{this._comm_start(),this._stop_other_players()}catch(e){}}const t=this._track;this._trackplayed(t)},pause:function(){switch(this._state){case"PLAYING":case"BUFFERING":this._player.pause(),this._comm_stop();break;case"BUSY":this._player.stop(),this._comm_stop(),this._handle_state({newstate:"IDLE",oldstate:this._state})}},stop:function(){this._player.stop(),this._handle_state({newstate:"IDLE",oldstate:this._state})},seek:function(e){if(this._unloaded=!1,(t=this._playlist[this._track])&&t.is_capped)return this._reset(),void this._trackcapped(t.id);if(e<=2&&null==this._playstat){var t;if((t=this._playlist[this._track])&&t.is_capped)return this._reset(),void this._trackcapped(t.id);t&&this._scrubbedback(t.id),this._scrubbed=!0}this._player.seek(e)},play_track:function(e,t){const n=this.get_track_info(e);if(n&&n.is_capped)return this._reset(),void this._trackcapped(n.id);this._loadedtrack!=e&&(this._state="IDLE",this._player.stop(),this._track=e,this._load()),this._unloaded=!1,null!=t?this.seek(t):this.play()},percent_loaded:function(){return this._loadpercent||0},position:function(){return this._position},duration:function(){if(null!=this._duration)return this._duration;{const e=this.get_track_info();return e?e.duration:0}},init_complete:function(e){this._trackstate&&this._loadstate()||(e||this._track>0)&&this._trackchanged(this._playlist[this._track])},register_listener:function(e,t){let n=this._ui_listeners[e];n?($assert($.isArray(n),"expected array of event listeners"),n.push(t)):(n=new Array,n.push(t),this._ui_listeners[e]=n)},player:function(){return this._player},unload:function(){this.stop(),this._unloaded=!0,this._playlist=[],this._track=0,this._loadedtrack=-1,this._loadpercent=0,this._position=0,this.first_playable_track=-1,this.last_playable_track=-1,this._playlistchanged(),this._handle_state({newstate:"IDLE",oldstate:this._state})},load:function(e){this.unload();for(let t=0;t<e.length;t++)this.add_track(e[t])},_reset:function(){this.stop(),this._track=this.first_playable_track,this._trackchanged(this._playlist[this._track]),this._loadedtrack=-1},_handle_state:function(e){if(this._state!=e.newstate){if("PLAYING"!=e.newstate&&"BUFFERING"!=e.newstate&&("PAUSED"!=e.newstate&&(this._position=0),this._clearstate()),this._state=e.newstate,"COMPLETED"!=e.newstate||"PLAYING"!=e.oldstate&&"BUFFERING"!=e.oldstate&&"PAUSED"!=e.oldstate)this._statechanged(e);else if(!this.seeking)if(this._track+1<=this.last_playable_track){this._state="IDLE",this._player.stop();const t=this.get_track_info();t&&0==t.continuous?this._statechanged(e):this.next_track()}else this._track=0,this._loadedtrack=-1,this._statechanged(e),this._trackchanged(this._playlist[this.first_playable_track]);1==this._stream_buffer_duration_stats&&("BUFFERING"!=e.newstate||"IDLE"!=e.oldstate&&"COMPLETED"!=e.oldstate?null!=this._buffering_start_time&&"PLAYING"==e.newstate&&(buffering_duration=Date.now()-this._buffering_start_time,this._buffering_start_time=null,this._playstat&&this._playstat.report_stream_buffer_duration(buffering_duration,this._options.hq)):this._buffering_start_time=Date.now()),"PAUSED"==e.newstate&&this._playstat&&this._playstat.report_stream_end(this._position)}},_handle_load:function(e){0==e.total?this._loadpercent=0:this._loadpercent=100*e.loaded/e.total,this._loaded(this._loadpercent)},_handle_time:function(e){this._trackstate&&this._savestate(e.position),this._position=e.position,this._duration=e.duration,this._timechanged(e);const t=this._playlist[this._track];this._playstat&&e.duration>0&&(this._playstat.play_progress(e.position,e.duration)||(this._playstat=null,t&&"undefined"!=t&&this._completedplay(t.id)));Player.PlayStat.is_complete(e.position,e.duration)&&this._scrubbed&&(this._scrubbed=!1,t&&"undefined"!=t&&this._completedplay(t.id,!0))},prev_track:function(){let e=this._track;do{e--}while(e>=0&&!this._playlist[e].file);-1==e&&(e=0),this._track=e,this._isplaying()&&(this._state="IDLE",this._player.stop()),this.play()},next_track:function(){let e=this._track;do{e++}while(e<this._playlist.length&&!this._playlist[e].file);e==this._playlist.length&&(e=0),this._track=e,this._isplaying()&&(this._state="IDLE",this._player.stop()),this.play()},get_state:function(){return this._state},get_track:function(){return this._track},get_track_info:function(e){return 0==this._playlist.length?null:void 0!==e?this._playlist[e].copy():this._playlist[this._track].copy()},cap_playback_for_track:function(e){for(let t=0;this._playlist&&t<this._playlist.length;t++){const n=this._playlist[t];if(n.id==e){n.mark_as_capped();break}}},length:function(){return this._playlist.length},_notify_listeners:function(e,t){const n=this._ui_listeners[e];if(n)for(let e=n.length-1;e>=0;e--)n[e](t)},_load:function(){if(this._loadedtrack==this._track)return void this.seek(0);this._loadedtrack=this._track,this._unloaded=!1,this._player.load(this._playlist[this._track].file,this._options.hq),this._loadpercent=0;const e=this._playlist[this._track];this._trackchanged(e),this._playstat=new Player.PlayStat(e,this._playing_from,this._referer),this._scrubbed=!1},_isplaying:function(){return"PLAYING"==this._state||"PAUSED"==this._state||"BUFFERING"==this._state},_managestate:"iphone"!=Browser.platform,_loadstate:function(){return!!this._managestate&&(Log.debug("reading/clearing playlist state"),!1)},_clearstate:function(){if(this._managestate)try{Cookie.clear(t)}catch(e){}},_savestate:function(e){if(!this._managestate||"PLAYING"!=this._state&&"BUFFERING"!=this._state)return;const i=this._playlist[this._track].id;if(Math.abs(this._saved_pos-e)>a||i!=this._saved_track_id){this._saved_track_id=i,this._saved_pos=e;const a={track_id:i,pos:e};try{const e=JSON.stringify(a);Cookie.set(t,e,n)}catch(e){}}},_comm_start:function(){this._comm||(this._comm=new Cookie.CommChannel("playlist"),this._comm.subscribe($.proxy(this._comm_recv,this))),this._comm.startListening()},_comm_stop:function(){this._comm&&this._comm.stopListening()},_comm_recv:function(e,t){if("stop"===t[1])Log.debug("received cookie comm stop command.  stopping."),this.stop()},_stop_other_players:function(){this._comm.send("stop")}};var t="playlist_state",n=30,a=1;return e.PLAY_TRACK="play_track",e}(),Player.PlaylistCoordinator=function(){function e(){this._playlists=[],this._playingcount=0,this._playing=EventSender.create(this,"playing"),this._stopped=EventSender.create(this,"stopped")}return e.prototype.add=function(e){const t=this;e.onstatechanged((function(n){t._handle_playlist_statechanged(e,n)})),this.onplaying((function(t){e!=t&&(e.getoption("savepos")?e.pause():e.stop())}))},e.prototype._handle_playlist_statechanged=function(e,t){const n="PLAYING"==t.newstate||"BUFFERING"==t.newstate,a="PLAYING"==t.oldstate||"BUFFERING"==t.oldstate;n&&!a?this._playingcount++:a&&!n&&(this._playingcount--,0==this._playingcount&&this._stopped()),n&&this._playing(e)},e}(),Player.PlayStat=function(){function e(e,n,a){params={kind:"track play",track_id:e.id,track_license_id:e.track_license_id,from:n,from_url:a||location.toString(),stream_duration:null},t.call(this,params,"started")}var t=Stats.PhasedStat;for(const t in Stats.PhasedStat.prototype)e.prototype[t]=Stats.PhasedStat.prototype[t];return e.prototype.play_progress=function(t,n){const a=e.is_partial(t,n),i=e.is_past_30(t,n),o=e.is_complete(t,n);return!this._partial_sent&&a&&(this._partial_sent=!0,this.change_phase("partial")),!this._30_seconds_sent&&i&&(this._30_seconds_sent=!0,this.change_phase("thirty")),!(!this._complete_sent&&o)||(this._complete_sent=!0,this._params.stream_duration=n,this.change_phase("complete"),!1)},e.is_partial=function(e,t){let n=!1;return e&&t&&(partial=10*t/100,n=e>partial),n},e.is_past_30=function(e){let t=!1;return e&&(t=e>30),t},e.is_complete=function(e,t){let n=!1;return e&&t&&(complete=90*t/100,n=e>complete),n},e.prototype.report_stream_end=function(e){e>30&&this._params.stream_duration<e&&(this._params.stream_duration=e,this.change_phase("stream_end"))},e.prototype.report_stream_buffer_duration=function(e,t){return Stats.record({kind:"stream buffer duration",duration_ms:e,is_hq:t}),!0},e}();var TitlePlayIndicator={playing:!1,browser_supported:!("ie"==Browser.make&&Browser.version[0]<9),play:function(){this.playing||(this.playing=!0,this.browser_supported&&(document.title="▶︎ "+document.title))},stop:function(){this.playing&&(this.playing=!1,this.browser_supported&&(document.title=document.title.substring(3)))}};window.ImageUtils=function(){"use strict";const e={JPEG:"jpg",PNG:"png"};function t(t,a,i,o){if(!a)return TemplGlobals.static_siteroot+"/img/blank.gif";i=n(i);const s=ImageUtils.imageRoot(o);let r;return r=i.anim_ok?"":i.file_format&&"original"!=i.file_format?"."+e[i.file_format]:"",s+"/img/"+t+(a=("000000000"+a).slice(-10))+"_"+i.id+r}function n(e){if("object"==typeof e)return e;const t=TemplGlobals.image_formats;if(t)for(let n=0;n<t.length;++n)if(t[n].id==e||t[n].name==e)return t[n];return Log.error("bad image format",e),null}const a={imageURL:function(e,n,a){return t("",e,n,a)},artURL:function(e,n,a){return t("a",e,n,a)},imageFormat:n,imageDimensions:function(e,t,a){let i,o;return(a=n(a))&&"original"!=a.resize_algo?"thumb"==a.resize_algo?(i=a.width,o=a.height):"fit"==a.resize_algo?e<=a.width&&t<=a.height?(i=e,o=t):e/a.width>t/a.height?(i=a.width,o=Math.round(t*(a.width/e))):(i=Math.round(e*(a.height/t)),o=a.height):(Log.error("bad image resize algo",a),i=e,o=t):(i=e,o=t),{width:i,height:o}},imageRoot:function(e){return void 0===e&&(e="https:"===window.location.protocol),e?TemplGlobals.image_siteroot_https:TemplGlobals.image_siteroot}};return"uploadImage"in window&&(a.upload=uploadImage),a}(),window.Imager=ImageUtils;var gplaylist,Templ=function(){"use strict";const e=function(){const e=document.querySelector("#pagedata");return e&&JSON.parse(e.dataset.blob)},t="en",n=e(),a=window.Translate&&Translate.locale||n&&n.locale||t,i=a!==t?"."+a:"",o="(\\s+|^)",s="(\\()?",r="(http://|https://)?",l="(([^@\\./\\s\\/'\"><&]+)(\\.[^@\\./\\s\\/'\"><&]+)*(\\.[a-z]{2,}))",c="(?::\\d+)?",d="(/[^?\\s]*?)?",p="(\\?[^#\\s]*?)?",u="(#[^\\s]*?)?",m="(\\))?",h="([.,;](\\s|$)|\\s+|$)",f=new RegExp(o+s+r+l+c+d+p+u+m+h+"|(\\s+\\(?|^\\(?)([^\\s\\(\\)\"'/><,@]+@\\w([^\\s\\(\\)\"'/><&,@]*\\w)?\\.\\w[^\\s\\(\\)\"'/><&,@]*\\w)(\\)?\\s+|\\)?$)","i"),g=new RegExp(o+s+r+l+c+d+p+u+m+h),_={".com":!0,".ru":!0,".org":!0,".net":!0,".de":!0,".jp":!0,".uk":!0,".br":!0,".it":!0,".pl":!0,".fr":!0,".in":!0,".au":!0,".ir":!0,".info":!0,".nl":!0,".cn":!0,".es":!0,".cz":!0,".kr":!0,".ca":!0,".eu":!0,".ua":!0,".co":!0,".gr":!0,".za":!0,".ro":!0,".biz":!0,".ch":!0,".se":!0,".tw":!0,".mx":!0,".vn":!0,".hu":!0,".be":!0,".tr":!0,".at":!0,".dk":!0,".tv":!0,".me":!0,".ar":!0,".sk":!0,".no":!0,".us":!0,".fi":!0,".id":!0,".cl":!0,".xyz":!0,".io":!0,".pt":!0,".by":!0,".il":!0,".ie":!0,".nz":!0,".kz":!0,".hk":!0,".lt":!0,".cc":!0,".my":!0,".sg":!0,".club":!0,".bg":!0,".edu":!0,".pk":!0,".su":!0,".top":!0,".th":!0,".hr":!0,".rs":!0,".pe":!0,".pro":!0,".si":!0,".lv":!0,".az":!0,".pw":!0,".ae":!0,".ph":!0,".online":!0,".ng":!0,".ee":!0,".ws":!0,".ve":!0,".pizza":!0,".cat":!0},b=new RegExp("(^|\\.)("+["bandcamp\\.com","bigcartel\\.com","blogspot\\.com","dailymotion\\.com","facebook\\.com","instagram\\.com","myspace\\.com","patreon\\.com","soundcloud\\.com","spotify\\.com","tumblr\\.com","twitter\\.com","vimeo\\.com","wordpress\\.com","youtu\\.be","youtube\\.com"].join("|")+")$"),v=new RegExp("^www\\.(\\w+\\.("+["bandcamp\\.com","blogspot\\.com","bigcartel\\.com","tumblr\\.com","wordpress\\.com"].join("|")+"))$"),y=/(?:^|\.)bandcamp.com$/i,w=/\brel=["']([^"']*)["']/i,k=/\breferrerpolicy=["']/i,x=/(^|\s)\*(\S|\S.*?\S)\*(?=\s|$)/g;function T(e,t){e=""+e;let n="";for(x.lastIndex=0;;){const a=x.lastIndex,i=x.exec(e);if(!i){n+=e.substring(a,e.length);break}n+=e.substring(a,i.index),n+=i[1],t&&(n+="<"+t+">"),n+=i[2],t&&(n+="</"+t+">")}return n}return{cfgFlags:n&&n.cfg||{},locale:a,locale_suffix:i,templates:{},globals:null,register:function(e){Object.assign(Templ.templates,e)},getGlobals:function(){if(!Templ.globals){const t=e(),n=t&&t.templglobals,a="undefined"!=typeof TemplGlobals?TemplGlobals:null;Templ.globals=Object.assign({},a,n)}return Templ.globals},RENDER_SPEED_TEST:!1,render:function(e,t){const n=Object.assign({},Templ.getGlobals(),t),a=new Templ.Context(n);let i=[];if(this.RENDER_SPEED_TEST){Log.debug(">>> start rendering "+e);const t=new Date;for(let t=0;t<100;++t)i=[],Templ.renderInternal(e,a,i);const n=new Date;Log.debug(">>> end rendering "+e+" - "+(n-t)/100+"ms")}else Templ.current_context=a,Templ.renderInternal(e,a,i),Templ.current_context=null;return i.join("")},runWithContext:function(e){const t=new Templ.Context(Templ.getGlobals());Templ.current_context=t,e(),Templ.current_context=null},renderElem:function(e,t,n){(e=elt(e)).innerHTML=Templ.render(t,n)},renderTableRow:function(e,t,n){e=elt(e);const a=document.createElement("DIV");a.innerHTML="<table><tbody><tr>"+Templ.render(t,n)+"</tr></tbody></table>";const i=a.firstChild.firstChild.firstChild;for(;null!=e.firstChild;)e.removeChild(e.firstChild);for(;null!=i.firstChild;)e.appendChild(i.removeChild(i.firstChild))},renderInternal:function(e,t,n){const a=Templ.templates[e+Templ.locale_suffix]?Templ.templates[e+Templ.locale_suffix]:Templ.templates[e];if(a)Templ.renderTokens(a,t,n);else{const t="[template not found: "+e+"]";n.push(t),Log.server(t,"warn")}},renderTokens:function(e,t,n){if(e)for(let a=0;a<e.length;a++){const i=e[a];if("string"==typeof i)n.push(i);else try{Templ.renderOneToken(i,t,n)}catch(e){throw Log.error("Error rendering token",i,"context",t),e}}},renderOneToken:function(e,t,n){let a,i;switch(e.type){case"translate":case"translateVariable":Templ.renderTokens(e.nodelist,t,n);break;case"translatePlural":for(a=0;a<e.blocks.length;a++)if(i=e.blocks[a],Templ.evalNCondition(i,t)){Templ.renderTokens(i.attachment,t,n);break}break;case"variable":if(!e.name)return;var o=Expression.eval(e.name,(function(e){return t.resolve(e)})),s=Templ.filters;Iter.each(e.filters,(function(e){const n=Iter.collect(e[1],(function(e){return t.resolve(e)})),a=e[0]?s[e[0]]:null;a?(n.unshift(o),o=a.apply(null,n)):(o="[template error: filter not found: "+e[0]+"]",Log.error(o))})),null!=o&&(Array.isArray(o)&&(o=o.join("")),n.push(o));break;case"assign":t.hash[e.to]=t.resolve(e.from);break;case"case":case"if":var r=e.blocks;for(a=0;a<r.length;a++)if(i=r[a],Templ.evalCondition(i,t)){Templ.renderTokens(i.attachment,t,n);break}break;case"for":var l=t.resolve(e.collection_name);l instanceof Templ.Range&&(l=l.expand());var c=e.nodelist,d=null!=e.attribs.offset?t.resolve(e.attribs.offset):0,p=l?l.length-d:0;null!=e.attribs.limit&&(p=Math.min(p,t.resolve(e.attribs.limit)));var u=l?l.slice(d,d+p):[];for(e.reversed&&u.reverse(),t.stashLoopvars(),a=0;a<p;a++)t.hash[e.variable_name]=u[a],t.hash.forloop={length:p,index:a+1,index0:a,rindex:p-a,rindex0:p-a-1,first:0===a,last:a===p-1},Templ.renderTokens(c,t,n);t.restoreLoopvars();break;case"include":var m=t.resolve(e.template_name);Templ.renderInternal(m,t,n);break;case"capture":var h=[];Templ.renderTokens(e.nodelist,t,h);var f="";for(a=0;a<h.length;a++)f+=h[a];t.hash[e.to]=f;break;case"ef":for(r=e.blocks,a=0;a<r.length;a++)if(i=r[a],Templ.evalNCondition(i,t)){Templ.renderTokens(i.attachment,t,n);break}break;case"let":t.hash[e.variable]=Expression.eval(e.expression,(function(e){return t.resolve(e)}))}},evalNCondition:function(e,t){return"else_ncondition"==e.type||Templ.isTrue(Expression.eval(e.expression,(function(e){return t.resolve(e)})))},evalCondition:function(e,t){if("else_condition"==e.type)return!0;let n;const a=t.resolve(e.left),i=e.operator;if(i){const o=Templ.operators[i];if(!o)return Log.error("template: unrecognized operator: "+i),!1;n=o(a,t.resolve(e.right))}else n=Templ.isTrue(a);return"or"==e.child_relation?n=Templ.isTrue(n)||Templ.isTrue(Templ.evalCondition(e.child_condition,t)):"and"==e.child_relation&&(n=Templ.isTrue(n)&&Templ.isTrue(Templ.evalCondition(e.child_condition,t))),n},isTrue:function(e){return!1!==e&&null!=e},EMPTY:{equals:function(e){return e==this||(!e||""===e.toString())}},Range:function(e,t){this.start=e,this.end=t,this.expand=function(){const e=[];for(let t=this.start;t<=this.end;t++)e.push(t);return e}},operators:{"==":C,"!=":function(e,t){return!C(e,t)},"<>":function(e,t){return!C(e,t)},"<":function(e,t){return Expression.evaluate_comparison("<",e,t)},">":function(e,t){return Expression.evaluate_comparison(">",e,t)},"<=":function(e,t){return Expression.evaluate_comparison("<=",e,t)},">=":function(e,t){return Expression.evaluate_comparison(">=",e,t)},contains:function(e,t){if("string"==typeof e)return e.indexOf(t)>=0;if(Array.isArray(e)){for(let n=0;n<e.length;n++)if(e[n]==t)return!0;return!1}return e instanceof Templ.Range&&(t>=e.start&&t<=e.end)}},filters:{size:function(e){return e?e.length:0},downcase:function(e){return null!=e?e.toString().toLowerCase():""},upcase:function(e){return null!=e?e.toString().toUpperCase():""},escape:function(e){return null!=e?Text.escapeHtml(e.toString()):""},escape_html_attr:function(e){return Templ.filters.escape(e)},noblanks:function(e,t){let n;return n=t?e.replace(/(\n *)+/g,"").replace(/\n--/g,"\n"):e.replace(/(\n *)+/g,"\n").replace(/\n--/g,"\n"),n},strip:function(e){return null!=e?e.toString().trim():""},strip_html:function(e){return null!=e?e.toString().replace(/<.*?>/g,""):""},strip_newlines:function(e){return null!=e?e.toString().replace(/\n/g,""):""},newline_to_br:function(e){return null!=e?e.toString().replace(/\n/g,"<br />\n"):""},newline_to_gap:function(e,t){const n=t?/(\n[\r\t ]*)+\n/g:/\n[\r\t ]*\n/g;return null!=e?e.toString().replace(n,'<br /><span class="lightweightBreak" /></span><br />').replace(/\n/g,"<br />\n"):""},replace:function(e,t,n){return Templ.filters.replace_regex(e,Text.regexpEscape(t),n)},replace_regex:function(e,t,n){if(null==e)return"";null==n&&(n="");return(e=e.toString()).replace(new RegExp(t,"gm"),n)},replace_first:function(e,t,n){return null==n&&(n=""),null!=e?e.toString().replace(t,n):""},remove:function(e,t){return Templ.filters.replace(e,t)},remove_first:function(e,t){return Templ.filters.replace_first(e,t)},encode_uri_c:function(e){return null!=e?encodeURIComponent(e).replace(/'/g,"%27"):""},join:function(e,t){return null==t&&(t=" "),Array.isArray(e)?e.join(t):e},sort:function(e){return Array.isArray(e)?e.slice(0).sort((function(e,t){return e>t?1:e<t?-1:0})):e},first:function(e){return Array.isArray(e)?e[0]:null},last:function(e){return Array.isArray(e)&&e.length?e[e.length-1]:null},edit_if_empty:function(e,t,n,a){return e&&e.length>0?e:Templ.filters.edit_field(a,t,n)},edit_field:function(e,t,n){return'<a href="/edit?id='+t+"&focus="+n+'">'+e+"</a>"},date:function(e,t){return"string"==typeof e&&(e=new Date(Date.parse(e))),Time.strftime(e,t)},time:function(e,t,n){return Time.to_ui(e,t,a,n)},ui_datetime:function(e){return e?Time.to_ui(e,1):""},ui_date:function(e,t){return e?t?Time.to_ui(e,4):Time.to_ui(e,2):""},to_date:function(e){return new Date(1e3*e)},relative_day:function(e,t){return e?Time.relative_day(e,t,a):""},relative_time:function(e,t){return e?Time.relative_time(e,t,a):""},relative_duration:function(e,t){return e?Time.relative_duration(e,t,a):""},json:function(e){return JSON.stringify(e)},plural:function(e,t,n){return null==n&&(n=t+"s"),"1"==e?t:n},capitalize:function(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()},capitalize_first_character:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},titlecase:function(e){return null!=e?e.toString().replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})):""},currency:function(e,t,n,a,i){return null==e?"":TextFormat.currency(e,window.CurrencyData?CurrencyData.info[t||"USD"]:null,n,a,i)},money:function(e,t,n){return TextFormat.money(e,t,n)},million_usd:function(e){return TextFormat.million_usd(e,a)},negate:function(e){return e&&e.is_money?{amount:-e.amount,currency:e.currency,is_money:!0}:"number"==typeof e?-e:""},abs:function(e){return e&&e.is_money?{amount:Math.abs(e.amount),currency:e.currency,is_money:!0}:"number"==typeof e?Math.abs(e):""},truncate:function(e,t,n){return n=n||"...",Text.truncate(e,t,n)},add_query_parm:function(e,t){return e?null===t||0===t.length?e:e+(e.indexOf("?")>-1?"&":"?")+t:""},mb:function(e){return TextFormat.toMb(e)},mb_si:function(e){return TextFormat.toMb(e,!0)},url:function(e,t,n){let a=t?"https_url":"url";return n&&("_"!=(n+="").charAt(n.length-1)&&(n+="_"),a=n+a),e[a]},commafy:function(e){return TextFormat.commafyNumber(""+e)},smallest_number_text:function(e,t){const n=parseInt(e);let a=n.toString();if(isNaN(n)||a.length<=t)return TextFormat.commafyNumber(a);let i=Math.floor(n/1e3*10)/10;if(i>0&&(a=i+"K"),a.length<=t)return a;if(i=Math.floor(i),i>0&&(a=i+"K"),a.length<=t||n<1e6)return a;let o=Math.floor(n/1e6*10)/10;return a=o+"M",a.length<=t||(o=Math.floor(o),a=o+"M",a.length),a},fan_link:function(e,t){return"<a href='"+e.trackpipe_url+"' style='"+t+"'>"+e.name+"</a>"},add_product_utm:function(e,t){let n="";if(!e)return n;let a,i=0,o=e;for(;i<300&&(a=g.exec(o));){if(i++,n+=o.substring(0,a.index),o=o.substring(a.index+a[0].length),!a[3]&&!_[a[7].toLowerCase()]){n+=a[0];continue}let e=[a[3]||"http://",a[4],a[8],a[9],a[10],a[11]].join(""),t="";"("===a[2]&&")"===e[e.length-1]&&(e=e.substring(0,e.length-1),t=")"),n+=(a[1]||"")+(a[2]||""),n+=e,n+=t,n+=void 0===a[12]?" ":a[12]}return n+=o,n},highlight_mention:function(e,t){return e.split("@"+t).join("<span class='mention-highlight'>@"+t+"</span>")},html_autolink:function(e,t,n){n=n||!0;let a="";if(!e)return a;t?" "!==t[0]&&(t=" "+t):t="",e=e.replace(/ +/g," ");let i,o=0;const s=n?f:g;let r=e;for(;o<300&&(i=s.exec(r));){if(o++,a+=Text.escapeHtml(r.substring(0,i.index)),r=r.substring(i.index+i[0].length),i[15])a+=" ",a+=Text.escapeHtml(i[14].substring(i[14].length-1)),a+='<a href="mailto:',a+=Text.escapeHtml(i[15]),a+='">',a+=Text.escapeHtml(i[15]),a+="</a>",a+=Text.escapeHtml(void 0===i[17]?" ":i[17]);else{if(!i[3]&&!_[i[7].toLowerCase()]){a+=i[0];continue}const e="https://"==i[3]||b.test(i[4])?"https://":"http://",n=i[4].replace(v,"$1"),o=i[9]&&"?"+i[9].substr(1).split("&").filter((function(e){return"utm_"!==e.substr(0,4)})).join("&");let s=[n,"/"===i[8]?"":i[8],o,i[10],i[11]].join(""),r=[e,n,i[8],i[9],i[10],i[11]].join(""),l="";"("===i[2]&&")"===r[r.length-1]&&(r=r.substring(0,r.length-1),s=s.substring(0,s.length-1),l=")"),a+=" ",a+=Text.escapeHtml((i[1]||"")+(i[2]||"")),a+='<a href="',a+=Text.escapeHtml(r),a+='"',a+=S(s,t),a+=">",a+=Text.escapeHtml(s),a+="</a>",a+=l,a+=Text.escapeHtml(void 0===i[12]?" ":i[12])}a+=" "}return a+=Text.escapeHtml(r),a},plus:function(e,t){return e+t},minus:function(e,t){return e-t},times:function(e,t){return e*t},divided_by:function(e,t){return e==Math.floor(e)&&t==Math.floor(t)?Math.floor(e/t):e/t},image:function(e,t){const n="number"==typeof e||!e,a=n?e:e.image_id,i=Templ.filters.image_url(a,t);if(n)return'src="'+i+'"';{const n=ImageUtils.imageDimensions(e.width,e.height,t);return'src="'+i+'" width="'+n.width+'" height="'+n.height+'"'}},image_url:function(e,t){return ImageUtils.imageURL(e,t,Templ.current_context.resolve("is_https"))},art:function(e,t){return'src="'+Templ.filters.art_url(e,t)+'"'},art_url:function(e,t){return ImageUtils.artURL(e,t,Templ.current_context.resolve("is_https"))},popup_image:function(e,t){const n="number"==typeof e,a=n?e:e.image_id,i=Templ.filters.image_url(a,t);if(n)return'href="'+i+'"';{const n=ImageUtils.imageDimensions(e.width,e.height,t);return'href="'+i+'" data-image-size="'+n.width+","+n.height+'"'}},image_width:function(e,t){return ImageUtils.imageDimensions(e.width,e.height,t).width},image_height:function(e,t){return ImageUtils.imageDimensions(e.width,e.height,t).height},possessify:function(e){return null===e||"string"!=typeof e||a&&a!=t?e:/s$/.test(e)?e+"'":e+"'s"},possessify_smart:function(e){return null===e||"string"!=typeof e||a&&a!=t?e:/s$/.test(e)?e+"’":e+"’s"},enumerate_items:function(e,t){void 0===t&&(t="and");var n=function(e){return 0===e.length||null===e?"":1===e.length?e[0]:2===e.length?e[0]+" "+t+" "+e[1]:e[0]+", "+n(e.slice(1,e.length))};return n(e)},fan_page_url:function(e){return Templ.current_context.resolve("siteroot_current")+"/"+e},band_url:function(e){if(!e)return"";const t=e.custom_domain,n=e.custom_domain_verified,a=e.subdomain,i=Templ.current_context.resolve("custom_domains_active"),o=Templ.current_context.resolve("base_port_str")||"",s=Templ.current_context.resolve("sitedomain");return i&&t&&n?"https://"+t+o:a?location.protocol+"//"+a+"."+s:""},lpad:function(e,t){void 0===t&&(t=10);const n=(e=String(e)).length;let a="";return t-n>0&&(a=new Array(t-n+1).join(" ")),a+e},asterisks_to_em:function(e){return T(e,"em")},strip_asterisks:function(e){return T(e,null)},tralbum_url:function(e){if(!e)return"";let t="";switch(e.item_type){case"a":t="/album/";break;case"t":t="/track/";break;case"p":t="/merch/";break;case"c":t="/campaign/"}return Templ.filters.band_url(e)+t+e.slug},subscribe_url:function(e){if(!e)return"";const t=e.subscribe_url_fragment||"subscribe";return Templ.filters.band_url(e)+"/"+t},featured_track_url:function(e,t){return e?Templ.filters.tralbum_url(e)+"?t="+t:""},hex_to_rgb:function(e){if(!e)return null;if("#"===e[0]&&(e=e.substring(1)),!e.match(/[0-9A-Fa-f]{6}/))return null;const t=parseInt(e,16);return(t>>16&255)+", "+(t>>8&255)+", "+(255&t)},fixnum:function(e,t){return e.toFixed(t)},wrap_emojis:function(e){const t=/(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDC8F\uDC91\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1F\uDD26\uDD30-\uDD39\uDD3C-\uDD3E\uDD77\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD\uDEC3-\uDEC5\uDEF0-\uDEF8])(?:\uD83C[\uDFFB-\uDFFF])?|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEDC-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8])\uFE0F/g;if(e.match(t)&&!e.match(/\u270C/g)){return"<span>"+e.replace(t,(function(e){return"<span class='emoji'>"+e+"</span>"}))+"</span>"}return e}},Context:function(e){this.hash=e||{},this.loopvars=null}};function C(e,t){return e==Templ.EMPTY?e.equals(t):t==Templ.EMPTY?t.equals(e):Expression.evaluate_comparison("==",e,t)}function S(e,t){const n=e.split("/")[0];let a;if(y.test(n))return t;if(a=w.exec(t)){let e=a[1];-1===e.indexOf("nofollow")&&(e+=" nofollow ugc"),t=t.substring(0,a.index)+'rel="'+e+'"'+t.substring(a.index+a[0].length)}else t+=' rel="nofollow ugc"';return k.test(t)||(t+=' referrerpolicy="strict-origin-when-cross-origin"'),t}}();Templ.filters.h=Templ.filters.escape,Templ.filters.a=Templ.filters.attr=Templ.filters.escape_html_attr,Templ.filters.u=Templ.filters.encode_uri_c,Templ.Context.prototype=function(){"use strict";const e=/\[[^\]]+\]|[\w-]+\??/g,t=/^\[(.+)\]$/;return{resolve:function(e){switch(e){case null:case"nil":case"null":case"":return null;case"true":return!0;case"false":return!1;case"empty":return Templ.EMPTY}let t;return(t=/^'(.*)'$/.exec(e))||(t=/^"(.*)"$/.exec(e))?t[1]:/^\d+$/.test(e)?parseInt(e):(t=/^\((\S+)\.\.(\S+)\)$/.exec(e))?new Templ.Range(this.resolve(t[1]),this.resolve(t[2])):/^(\d[\d\.]+)$/.test(e)?parseFloat(e):this.variable(e)},variable:function(n){const a=e.lastIndex;e.lastIndex=0;let i,o,s,r=this.hash;try{for(;i=e.exec(n);)s=i[0],(o=t.exec(s))&&(s=this.resolve(o[1])),r="size"!==s&&"first"!==s&&"last"!==s||r&&"object"==typeof r&&r.hasOwnProperty(s)?r&&r[s]:Templ.filters[s](r);return r}finally{e.lastIndex=a}},stashLoopvars:function(){const e=this.hash.forloop;e&&(this.loopvars=this.loopvars||[],this.loopvars.push(e))},restoreLoopvars:function(){this.loopvars&&(this.hash.forloop=this.loopvars.pop())}}}();var gplayerviews=[];Player.init=function(e,t){Player.tralbum_data=e,Player.private_streaming="private_streaming"==Player.tralbum_data.playing_from.slice(0,17);Sound.whenloaded((function(e){let n,a=null,i=null;if(e.success&&(a=new Sound.SoundPlayer,i=new Player.Playlist(a,Player.tralbum_data.playing_from,null,{hq:Player.tralbum_data.is_purchased||Player.tralbum_data.is_private_stream||Player.tralbum_data.is_band_member})),gplaylist=i,$(".inline_player").each((function(){const e={};this.attributes.rel&&(e.onetrack=!0,n||(n=this.attributes.rel.value)),gplayerviews.push(new Player.InlinePlayerView(i,this,e))})),i&&n){const e=Url.parseQuery(n),t=Player.tralbum_data.trackinfo[e.tracknum-1],a=i.add_track(t);t.id===Player.tralbum_data.featured_track_id&&i.set_initial_track(a)}let o=!1;$(".track_row_view").each((function(){const e=Url.parseQuery(this.attributes.rel.value),t=Player.tralbum_data.trackinfo[e.tracknum-1],n=new Player.TrackRowView(i,this,t,Player.private_streaming);i&&!o&&(Player.tralbum_data.initial_track_num&&t.track_num==Player.tralbum_data.initial_track_num&&t.file?(i.set_initial_track(n._tracknum),o=!0):t.id===Player.tralbum_data.featured_track_id&&i.set_initial_track(n._tracknum))})),t&&t(i),i&&i.init_complete()}))},Player.update=function(e){if(gplaylist){Player.tralbum_data=e;for(let t=0;t<e.trackinfo.length;t++)gplaylist.update_trackinfo(t,e.trackinfo[t])}},Player.CollectionView=function(){($("#pagedata").data("blob")||{}).cfg;function e(e){this._playlist=e,this._play_status_elements=[],this._play_hilite_elements=[],this._play_elapsed_time_elements={},this._waypoints=[],this._play_elem_stash={},this._track_list_ids={},this._playing_state="STOPPED",this._setup(),e&&(e.onstatechanged(this._handle_statechange,this),e.onplaylistchanged(this._handle_playlistchange,this),e.onloaded(this._handle_loaded,this),e.ontime(this._handle_time,this))}return e.prototype={is_playing:function(){return"PLAYING"==this._playing_state||"BUFFERING"==this._playing_state},currently_playing_track:function(){return this.is_playing()?this._current_track_list_entry():null},play:function(){return this._playlist.play(),1},playpause:function(e){return null==e||""==e||e==this._current_track_list_entry().id?this._playlist.playpause():this.play_track_id(e)},play_track_num:function(e){return e=e>0?e-1:e,this._playlist.play_track(e),1},play_track_id:function(e){const t=this.get_track_info(e);return t&&void 0!==t&&t.track_num&&this.play_track_num(t.track_num),1},get_track_info:function(e){for(const t in track_list)if(track_list.hasOwnProperty(t)&&track_list[t].track_id==e)return track_list[t];return null},_setup:function(){const e=$(".track_play_view");for(var t=0,n=e.length;t<n;t++){const d=e[t];if(this._playlist&&d.attributes["data-trackid"]){const p=d.attributes["data-trackid"].value;if(!p||""==p)continue;const u=this.get_track_info(p);if(!u||"undefined"==u)continue;const m=document.createElement("table");m.setAttribute("style","border: none;");const h=document.createElement("tr");h.setAttribute("itemprop","tracks"),h.setAttribute("itemscope",null),h.setAttribute("itemtype","http://www.schema.org/MusicRecording"),(i=document.createElement("td")).className="track_play_control";const f=document.createElement("a");function a(e){return function(){playerview.playpause(e)}}f.onclick=a(p);const g=document.createElement("div");var i;g.className="play_status",g.setAttribute("data-trackid",p),f.appendChild(g),i.appendChild(f),h.appendChild(i),(i=document.createElement("td")).className="track_play_name",i.innerHTML=u.title,h.appendChild(i),i.onclick=a(p),m.appendChild(h),d.parentNode.replaceChild(m,d),this._play_status_elements.push(g)}}const o=$(".track_play_auxiliary");this._setup_aux_controls(o);const s=$(".track_play_hilite");this._setup_hilites(s);const r=$(".track_play_time");this._setup_time_elems(r);const l=$(".track_play_waypoint");this._setup_waypoints(l);t=0;for(var c=track_list.length;t<c;t++)this._track_list_ids[track_list[t].track_id]=!0},_setup_aux_controls:function(e){if(null!=e&&void 0!==e)for(let n=0,a=e.length;n<a;n++){const i=e[n],o=i.attributes["data-trackid"].value;function t(e){return function(t){U.stopEvent(t);const n=e.attributes["data-trackid"].value,a=playerview.playpause(n),i=e.attributes["data-clickstat"];return!i||0!=a&&1!=a||Stats.record({kind:"click",click:i.value}),!1}}o&&""!=o&&("A"==i.tagName?Dom.hackLinkClicksThanksSafari(i,t(i)):i.onclick=t(i))}},_setup_hilites:function(e){if(null!=e&&void 0!==e)for(let t=0,n=e.length;t<n;t++){const n=e[t];if(n.attributes["data-trackid"]){n.attributes["data-trackid"].value&&this._play_hilite_elements.push(n)}}},_setup_time_elems:function(e){if(null!=e&&void 0!==e)for(let t=0,n=e.length;t<n;t++){const n=e[t];if(n.attributes["data-trackid"]){const e=n.attributes["data-trackid"].value;if(e){const t=this.get_track_info(e);if(t){const a=$("span.time_elapsed",n)[0];a&&(this._play_elapsed_time_elements[e]||(this._play_elapsed_time_elements[e]=[]),this._play_elapsed_time_elements[e].push(a)),total_str=Time.timeStr(t.duration>1?t.duration:1);const i=$("span.time_total",n)[0];i&&(i.innerHTML=total_str)}}}}},_setup_waypoints:function(e){null!=e&&void 0!==e&&(this._waypoints=e)},_sleepyhead:function(e,t,n,a){this._add_trackinfo(a),this._setup_aux_controls(e),this._setup_hilites(t),this._setup_time_elems(n)},_add_trackinfo:function(e){if(null==e)return;const t=e.track_id;null!=this._track_list_ids[t]&&this._track_list_ids[t]||(e.track_num=track_list.length+1,e.id=e.track_id,e.file=e.file||e.streaming_url,e.continuous=!1,this._playlist.add_track(e),track_list.push(e))},_update_track_play_elements:function(e,t,n,a){if(!e||"undefined"==e)return;const i=e.track_id;if(this._add_trackinfo(e),t&&void 0!==t)for(var o=0,s=t.length;o<s;o++){t[o].attributes["data-trackid"].value=i}if(n&&void 0!==n)for(o=0,s=n.length;o<s;o++)n[o].attributes["data-trackid"].value=i;if(a&&void 0!==a)for(o=0,s=a.length;o<s;o++){const e=a[o],t=$("span.time_elapsed",e)[0];t&&(this._play_elapsed_time_elements[i]||(this._play_elapsed_time_elements[i]=[]),this._play_elapsed_time_elements[i].push(t)),total_str=Time.timeStr(this.get_track_info(i).duration);const n=$("span.time_total",e)[0];n&&(n.innerHTML=total_str)}},_handle_loaded:function(e){},_handle_playlistchange:function(){},_handle_statechange:function(e){let t=!0;this._playing_state=e.newstate;const n=this._current_track_list_entry();let a=this._play_status_elements;for(var i=0,o=a.length;i<o;i++){if((r=a[i]).attributes["data-trackid"])(s=r.attributes["data-trackid"].value)&&(s!=n.id||"PLAYING"!=e.newstate&&"BUFFERING"!=e.newstate?$(r).removeClass("playing"):$(r).addClass("playing"))}a=this._play_hilite_elements;for(i=0,o=a.length;i<o;i++){var s;if((r=a[i]).attributes["data-trackid"])(s=r.attributes["data-trackid"].value)&&(s!=n.id||"PLAYING"!=e.newstate&&"BUFFERING"!=e.newstate?(s==n.id&&"PAUSED"==e.newstate&&$(r).addClass("paused"),$(r).removeClass("playing")):$(r).addClass("playing"))}a=this._waypoints;for(i=0,o=a.length;i<o;i++){var r=a[i];"PLAYING"==e.newstate||"BUFFERING"==e.newstate?($(r).removeClass("done").addClass("playing"),$("#track_play_waypoint, #track-play-waypoint-wrapper").removeClass("activated")):$(r).removeClass("playing").addClass("done");var l=$("[data-trackid='"+n.id+"']");if(0===l.length)continue;var c=$(".collection-item-art, .tralbum-art-large, .tralbum-art-medium",l)[0];const o=$(".collection-item-title",l)[0],s=$(".collection-item-artist",l)[0],u=$(l).parent()[0];var d=$(u).data("iswish");$("img",r)[0].src=null!=c?c.src:"",$(".waypoint-item-title",r)[0].innerHTML=o.innerHTML,$(".waypoint-artist-title",r)[0].innerHTML=s.innerHTML,$(r).unbind("click").click((function(){window.collectionTabs&&(d&&"wishlist"!==window.collectionTabs.currentTab.name?window.collectionTabs.switch("wishlist","wishlist-grid"):d||"collection"===window.collectionTabs.currentTab.name||window.collectionTabs.switch("collection","collection-grid"),$("#track_play_waypoint, #track-play-waypoint-wrapper").removeClass("activated")),Dom.scrollToElement(l.filter(":visible"),-30)})),$.waypoints("destroy");var p=!!window.collectionTabs;$(c).waypoint((function(e){p&&(d&&"wishlist"===window.collectionTabs.currentTab.name||!d&&"collection"===window.collectionTabs.currentTab.name)||!p?$("#track_play_waypoint, #track-play-waypoint-wrapper").toggleClass("activated","down"===e):$("#track_play_waypoint, #track-play-waypoint-wrapper").addClass("activated")})).waypoint((function(e){const n=p&&(d&&"wishlist"===window.collectionTabs.currentTab.name||!d&&"collection"===window.collectionTabs.currentTab.name);t||(n||!p?$("#track_play_waypoint, #track-play-waypoint-wrapper").toggleClass("activated","up"===e):$("#track_play_waypoint, #track-play-waypoint-wrapper").addClass("activated"))}),{offset:"80%"}),window.collectionTabs&&(window.collectionTabs.nowPlayingCallback=function(){const e=d?"wishlist":"collection";Dom.inViewport(c)&&e===collectionTabs.currentTab.name?$("#track_play_waypoint, #track-play-waypoint-wrapper").removeClass("activated"):$("#track_play_waypoint, #track-play-waypoint-wrapper").addClass("activated")})}let u=$("title").text();u="PLAYING"==e.newstate&&"PLAYING"!=e.oldstate?"▶︎ "+u:u.replace("▶︎ ",""),$("title").text(u),t=!1},_handle_time:function(e){const t=this._current_track_list_entry().id;null!=this._play_elem_stash.time_elems_tid&&this._play_elem_stash.time_elems_tid==t||(this._play_elem_stash.time_elems_tid=t,this._play_elem_stash.time_elems_elapsed=this._play_elapsed_time_elements[t]);const n=this._play_elem_stash.time_elems_elapsed;if(n){const t=Time.timeStr(e.position);for(let e=0,a=n.length;e<a;e++)n[e].innerHTML=t}},_current_track_list_entry:function(){return this._playlist.get_track_info()}},e}(),Player.TrackRowView=function(){function e(e,n,a,i){this._elem=n,this._playlist=e,this._trackinfo=a||{},this._private_streaming=i,e?(this._tracknum=e.add_track(a),this._trackinfo=e.get_track_info(this._tracknum)):this._tracknum=t++,this._setup_elements(),e&&(e.onstatechanged(this._state_changed,this),e.onplaylistchanged(this._handle_playlistchange,this))}e.prototype={_state_changed:function(e){const t=this._playlist.get_track();if(t==this._tracknum&&("PLAYING"==e.newstate||"BUFFERING"==e.newstate||"PAUSED"==e.newstate)?$(this._elem).addClass("current_track"):$(this._elem).removeClass("current_track"),t==this._tracknum)switch(e.newstate){case"PLAYING":case"BUFFERING":this._enable_button("pause");break;case"PAUSED":this._enable_button("play")}else this._trackinfo.file&&this._enable_button("play")},findelem:function(e){return $("."+e,this._elem)[0]},play:function(){this._playlist.play_track(this._tracknum)},toString:function(){return"[TrackRowView: id="+this._elem.id+", title="+this._trackinfo.title+"]"},activeNodes:function(){return window.MediaView&&"phone"==MediaView.mode?$(this._elem):$(this._elems.playbutton)},_enable_button:function(e){const t=$(this._elems.playbutton);if(t.length)if(t.removeClass("disabled"),this._playlist){const n=this;"play"==e?(t.removeClass("playing"),this.activeNodes().off("click.player").on("click.player",(function(){return n.play(),!1}))):"pause"==e&&(t.addClass("playing"),this.activeNodes().off("click.player").on("click.player",(function(){return n._playlist.playpause(),!1})))}else t.removeClass("playing"),t.parent().attr("href",this._trackinfo.file)},_setup_elements:function(){this._elems={},Templ.renderTableRow(this._elem,"_track_row",{tracknum:this._tracknum+1,track:this._trackinfo,private_streaming:this._private_streaming}),this._elems.playbutton=this.findelem("play_status"),this._elems.title=this.findelem("title"),$(".track-encoding-error-link",this._elem).click((function(){return Tracks.encoding_error($(this).data("error")),!1})),this._trackinfo.file?this._enable_button("play"):this.activeNodes().off("click.player").on("click.player",!1),window.Fixup&&Fixup.trackRows&&Fixup.trackRows(this._elem)},_handle_playlistchange:function(){correctinfo=this._playlist.get_track_info(this._trackinfo.tracknum),Player.TrackInfo.is_same(this._trackinfo,correctinfo)||(this._trackinfo=correctinfo,this._setup_elements())}};var t=0;return e}(),Player.InlinePlayerView=function(){function e(e,t,n){this._playlist=e,this._options=n||{},this._elem=t,this._elems={},this._tracklength=this._trackpos=this._loadpercent=0;const a=this._elems;if(a.next=this.find_elem("nextbutton"),a.prev=this.find_elem("prevbutton"),a.play=this.find_elem("playbutton"),a.title=this.find_elem("title"),a.title_link=this.find_elem("title_link"),a.prog=this.find_elem("progbar"),a.progthumb=this.find_elem("thumb"),a.progfill=this.find_elem("progbar_fill"),a.message=this.find_elem("message"),this._playlist){this._playlist.onstatechanged(this._handle_playstate,this),this._playlist.ontime(this._handle_time,this),this._playlist.onloaded(this._handle_loaded,this),this._playlist.ontrackchanged(this._handle_trackchange,this),this._playlist.onplaylistchanged(this._handle_playlistchange,this);var i=this;const e=function(e,t){i._handle_volumechange(t)};this._playlist._player.onvolume(e,this);i=this;if($(a.play).click((function(e){i._handle_playclick(e)})),$(a.next).click((function(e){i._handle_nextclick(e)})),$(a.prev).click((function(e){i._handle_prevclick(e)})),$(a.progthumb).draggable({containment:"parent",axis:"x",start:function(e){i._dragging=!0,i._playlist.seeking=!0,i._dragoffset=e.offsetX},drag:function(e){const t=Dom.getXY(i._elems.prog)[0],n=i._elems.prog.offsetWidth-i._elems.progthumb.offsetWidth;let a=e.clientX-t-i._dragoffset;a=a<0?0:a>n?n:a,a*=i._tracklength/n,i._trackpos=a,i._updateprog()},stop:function(e){i._playlist.seek(i._trackpos),i._dragging=!1,i._playlist.seeking=!1}}),"iphone"==Browser.platform||window.MediaView&&"phone"==MediaView.mode){(i=this)._elem&&i._elem.addEventListener("touchstart",(function(e){if($(e.target).closest(".playbutton, .nextbutton, .prevbutton").length)return;const t=e.touches[0].screenX,n=e.touches[0].screenY,a=i._trackpos||0;let o=null,s=null;const r=function(){switch(window.orientation){case 0:case 180:return window.screen.width;default:return window.screen.height}}(),l=Math.round(r*a/i._tracklength);let c=o;const d=document.createElement("div"),p=document.createElement("div");d.className="seekMask seekmask",p.className="seekText seektext",document.body.appendChild(d),document.body.appendChild(p);const u=window.pageXOffset,m=window.pageYOffset,h=window.innerHeight,f=window.innerWidth;function g(e){i._elem.removeEventListener("touchend",b),i._elem.removeEventListener("touchcancel",v),i._elem.removeEventListener("touchmove",_),i._playlist.seeking=!1,i._dragging=!1,e&&(i._trackpos==i._tracklength?i._playlist.next_track():0==i._trackpos&&a<3?i._playlist.prev_track():i._playlist.seek(i._trackpos)),document.body.removeChild(p),document.body.removeChild(d)}function _(e){if(null==o){e.changedTouches[0].screenY;if(Math.abs(e.changedTouches[0].screenY-n)>Math.abs(e.changedTouches[0].screenX-t))return void g(!1)}e.preventDefault();let d=e.changedTouches[0].screenX;d=1.4*d-.2*r,null==o&&(o=s=d);i._tracklength;if(s!=l){Math.abs(l-d)>Math.abs(l-c)&&(s>l?s--:s++)}let u=0;d<=s?(u=s<=0?0:d/s*a,u<0&&(u=0)):(u=(d-s)/(r-s)*(i._tracklength-a)+a,u>i._tracklength&&(u=i._tracklength)),i._trackpos=u,i._updateprog();let m="";m=u==i._tracklength?"&gt;&gt;":0==u&&a<3?"&lt;&lt;":Time.timeStr(i._trackpos),p.innerHTML=m,c=d}function b(e){g(!0)}function v(e){g(!1)}d.style.width=f+"px",d.style.height=h+"px",d.style.left=u+"px",d.style.top=m+"px",p.style.width=f+"px",p.style.height=h+"px",p.style.left=u+"px",p.style.top=m+"px",i._playlist.seeking=!0,i._dragging=!0,i._elem.addEventListener("touchmove",_),i._elem.addEventListener("touchend",b),i._elem.addEventListener("touchcancel",v)}))}this._showhide_nextprev()}else{const e=Player.tralbum_data.trackinfo[0];a.play.parentNode.href=e.file}}return e.prototype={_handle_playclick:function(e){U.stopEvent(e),this._playlist.playpause()},_handle_nextclick:function(e){U.stopEvent(e),$(this._elems.next).hasClass("hiddenelem")||this._playlist.next_track()},_handle_thumb_grab:function(){},_handle_prevclick:function(e){U.stopEvent(e),$(this._elems.prev).hasClass("hiddenelem")||this._playlist.prev_track()},_handle_playstate:function(e){switch(e.newstate){case"PLAYING":$(this._elems.play).removeClass("busy").addClass("playing"),TitlePlayIndicator.play();break;case"BUFFERING":case"BUSY":$(this._elems.play).removeClass("playing").addClass("busy");break;default:$(this._elems.play).removeClass("busy").removeClass("playing"),TitlePlayIndicator.stop()}},_handle_trackchange:function(e){if(this._showhide_nextprev(),this._trackinfo=e,this._options.onetrack){if(this._elems.message)if(e.encoding_error){let t=e.encoding_error;t=JSON.stringify(t),t=t.slice(1,t.length-1),t=Text.escapeHtml(t);const n=$('<a style="color:red" href="#">upload error</a>').click((function(){return Tracks.encoding_error(t),!1}));$(this._elems.message).removeClass("hiddenelem").html(n)}else e.encoding_pending?$(this._elems.message).removeClass("hiddenelem").html("processing..."):$(this._elems.message).addClass("hiddenelem")}else $(this._elem).find(".title-section").removeClass("hiddenelem"),this._elems.title.innerHTML=Text.escapeHtml(e.title);if(("iPhone"==Browser.platform||window.MediaView&&"phone"==MediaView.mode)&&$(this._elem).find(".video-link")[0])if(e.video_id){const t=$(this._elem).find(".video-link");t.attr("data-href-mobile",e.video_mobile_url),t.attr("href","#"),t.attr("data-caption",e.video_caption),t.removeClass("is-hidden")}else $(this._elem).find(".video-link").addClass("is-hidden");this._set_title_link(e.title_link),this._tracklength=this._playlist.get_track_info().duration||e.duration||0,this._zero_time()},_set_title_link:function(e){const t=this._elems.title_link;if(!t)return;const n=this._elems.title;t.href=e,e?n.parentNode!=t&&(n.parentNode.insertBefore(t,n),t.appendChild(n)):n.parentNode==t&&(t.parentNode.insertBefore(n,t),t.parentNode.removeChild(t))},_handle_volumechange:function(e){this._display_volume(e.volume)},_handle_playlistchange:function(){const e=this._playlist.get_track_info();e&&this._handle_trackchange(e)},_zero_time:function(){this._trackpos=0,this._updateprog()},_handle_time:function(e){this._dragging||"PLAYING"!==this._playlist.get_state()||(this._trackpos=e.position),e.duration&&this._tracklength!=e.duration&&(this._tracklength=e.duration),this._updateprog()},_showhide_nextprev:function(){const e=this._playlist.get_track(),t=this._playlist.first_playable_track,n=this._playlist.last_playable_track;this._elems.prev&&this.showhide_elem(this._elems.prev,t>=0&&e>t),this._elems.next&&this.showhide_elem(this._elems.next,n>=0&&e<n)},_handle_loaded:function(e){this._loadpercent=e,this._updateprog()},_updateprog:function(){const e=this._elems.prog.offsetWidth-this._elems.progthumb.offsetWidth,t=this._tracklength?this._trackpos/this._tracklength*e:0;this._elems.progthumb.style.left=t+"px",this._elems.progfill.style.width=this._loadpercent+"%",$(this._elem).find(".time.hiddenelem").removeClass("hiddenelem"),$(this._elem).find(".time_elapsed").text(Time.timeStr(this._trackpos)),$(this._elem).find(".time_total").text(Time.timeStr(this._tracklength>1?this._tracklength:1))},_display_volume:function(e){this._voltimer&&(clearTimeout(this._voltimer),this._voltimer=null);let t=this._elems.volbars;if(!t){t=document.createElement("div"),t.className="volumebars";const e='<div class="volumebar"></div>';let a="";for(var n=0;n<12;n++)a+=e;a+='<img class="volumebarimg" src="/img/volbang.png">',a+='<img class="volumebarimg" src="/img/volbang.png">',a+='<img class="volumebarimg" src="/img/volbang.png">',a+='<img class="volumebarimg" src="/img/vol1.png">',t.innerHTML=a,this._elems.volbars=t,document.body.appendChild(t)}t.classList.remove("hiddenelem");const a=t.childNodes;for(n=0;n<a.length;n++)n/a.length<e?a[n].classList.remove("hiddenelem"):a[n].classList.add("hiddenelem");const i=this;this._voltimer=setTimeout((function(){i._hide_volume()}),3e3)},_hide_volume:function(){this._elems.volbars.classList.add("hiddenelem"),this._voltimer=null},find_elem:function(e){return $("."+e,this._elem)[0]},showhide_elem:function(e,t){t?e.classList.remove("hiddenelem"):e.classList.add("hiddenelem")},toString:function(){return this._trackinfo?"[InlinePlayerView: id="+this._elem.id+", title="+this._trackinfo.title+"]":"[InlinePlayerView: id="+this._elem.id+", no track]"}},e}(),window.SocialControls={initFromDOM:function(e){const t=this,n=$(e);n.add(".social-controls",n).filter(".social-controls").each((function(){const e=$(this);t._initControlsOfType(e.find(".facebook-share-ctrl"),"renderFacebookShare"),t._initControlsOfType(e.find(".facebook-share-dlg-ctrl"),"renderFacebookDialogShare"),t._initControlsOfType(e.find(".twitter-ctrl"),"renderTwitterShare"),t._initControlsOfType(e.find(".reddit-ctrl"),"renderRedditShare"),t._initControlsOfType(e.find(".tumblr-ctrl"),"renderTumblrShare"),t._initControlsOfType(e.find(".email-ctrl"),"renderEmailShare")}))},renderFacebookDialogShare:function(e,t){!function(e,t,n){const a=e.getElementsByTagName(t)[0],i=e.createElement(t);i.id="facebook-jssdk",i.src="https://connect.facebook.net/en_US/sdk.js",a.parentNode.insertBefore(i,a)}(document,"script"),window.fbAsyncInit=function(){FB.init({appId:t.appId,autoLogAppEvents:!0,xfbml:!0,version:"v3.2"})};$(e).find(".facebook-link").first().click((function(e){FB.ui({method:"share_open_graph",action_type:"og.shares",action_properties:JSON.stringify({object:{"og:url":t.url,"og:title":t.title,"og:description":t.text,"og:image":t.image,"og:image:width":100,"og:image:height":100}})},(function(e){}))}))},renderFacebookShare:function(e,t){const n=this,a=$(e),i={url:location.href};const o={u:(t=$.extend(i,t)).url},s=!window.MediaView||"desktop"==MediaView.mode,r=Url.addQueryParams(s?"https://www.facebook.com/sharer.php":"https://m.facebook.com/sharer.php",o);let l=a.find(".facebook-link").first();l.length||(l=$('<a class="facebook-link" title="Share on Facebook">Share</a>').appendTo(a)),l.attr({href:r,target:"_blank"}).click((function(e){var a,i,o;window.TralbumData&&BCTracker.record("click",{feature:"tralbum-share-embed",click_type:"share",share_type:"facebook",user_id:null===(a=Identities.user())||void 0===a?void 0:a.id,item_id:null===(i=TralbumData.current)||void 0===i?void 0:i.id,item_type:null===(o=TralbumData.current)||void 0===o?void 0:o.type});n._statClick(t,"on"),s&&(window.open(r,"share_fb","toolbar=0,status=0,width=626,height=436"),e.preventDefault())}))},renderTwitterShare:function(e,t){const n=this,a=$(e),i={url:location.href};const o={url:(t=$.extend(i,t)).url},s=!window.MediaView||"phone"!=MediaView.mode;t.text&&(o.text=t.text);const r=Url.addQueryParams("https://twitter.com/intent/tweet",o);let l=a.find(".twitter-link").first();if(!l.length){let e,t;"undefined"==typeof TM?(e="Tweet",t="Share on Twitter"):(e=TM("Tweet"),t=TM("Share on Twitter")),l=$('<a class="twitter-link" title="'+t+'">'+e+"</a>").appendTo(a)}l.attr({href:r,target:"_blank"}).click((function(e){var a,i,o;(n._statClick(t,"on"),s&&(window.open(r,"share_tw","toolbar=0,status=0,width=550,height=450"),e.preventDefault()),window.TralbumData)&&BCTracker.record("click",{feature:"tralbum-share-embed",click_type:"share",share_type:"twitter",user_id:null===(a=Identities.user())||void 0===a?void 0:a.id,item_id:null===(i=TralbumData.current)||void 0===i?void 0:i.id,item_type:null===(o=TralbumData.current)||void 0===o?void 0:o.type})}))},renderRedditShare:function(e,t){const n=this,a=$(e),i={url:location.href};const o={url:(t=$.extend(i,t)).url,title:t.title,kind:"self"},s=!window.MediaView||"phone"!=MediaView.mode,r=Url.addQueryParams("https://www.reddit.com/submit",o);let l=a.find(".reddit-link").first();if(!l.length){const e=TM("Reddit"),t=TM("Share on Reddit");l=$('<a class="reddit-link" title="'+t+'">'+e+"</a>").appendTo(a)}l.attr({href:r,target:"_blank"}).click((function(e){n._statClick(t,"on"),s&&(window.open(r,"share_rd","toolbar=0,status=0,width=550,height=450"),e.preventDefault())}))},renderTumblrShare:function(e,t){const n=this,a=$(e),i={url:location.href,type:"link"};const o={};"audio"==(t=$.extend(i,t)).type?(o.external_url=t.url,t.text&&(o.caption=t.text)):(o.url=t.url,t.title&&(o.name=t.title),t.text&&(o.description=t.text));const s=Url.addQueryParams("https://www.tumblr.com/share/"+t.type,o);let r=a.find(".tumblr-link").first();r.length||(r=$('<a class="tumblr-link" title="Share on Tumblr">Share on Tumblr</a>').appendTo(a)),r.attr({href:s,target:"_blank"}).click((function(e){var a,i,o;(n._statClick(t,"on"),window.TralbumData)&&BCTracker.record("click",{feature:"tralbum-share-embed",click_type:"share",share_type:"tumblr",user_id:null===(a=Identities.user())||void 0===a?void 0:a.id,item_id:null===(i=TralbumData.current)||void 0===i?void 0:i.id,item_type:null===(o=TralbumData.current)||void 0===o?void 0:o.type})}))},renderEmailShare:function(e,t){const n=this,a=$(e),i={url:location.href},o={body:(t=$.extend(i,t)).url};t.text&&(o.body=t.text+"\r\n\r\n"+o.body),t.subject&&(o.subject=t.subject);const s="mailto:?"+Url.joinQuery(o);let r=a.find(".email-link").first();r.length||(r=$('<a class="email-link" title="Share via email">Email</a>').appendTo(a)),r.attr({href:s}).click((function(e){var a,i,o;(n._statClick(t,"on"),window.TralbumData)&&BCTracker.record("click",{feature:"tralbum-share-embed",click_type:"share",share_type:"email",user_id:null===(a=Identities.user())||void 0===a?void 0:a.id,item_id:null===(i=window.TralbumData.current)||void 0===i?void 0:i.id,item_type:null===(o=window.TralbumData.current)||void 0===o?void 0:o.type});return setTimeout((function(){location.href=s}),100),!1}))},_initControlsOfType:function(e,t){const n=this;$(e).each((function(){n[t](this,n._getData(this))}))},_getData:function(e,t){const n=$(e),a=n.data(),i=n.closest(".social-controls").data();return $.extend(t||{},i,a)},_statClick:function(e,t){let n=null;"on"==t?n=e.stat||e.statOn:"off"==t&&(n=e.statOff),n&&Stats.record({kind:"click",click:n})}};var Footer={init:function(){this.enhance();const e=HiddenParams.get("mvp");["p","d"].includes(e)&&this.setViewSwitcherCookie(e)},enhance:function(){this.initViewSwitcher($("#pgFt .view-switcher"))},initViewSwitcher:function(e){const t=$(e);"client"==MediaView.initType&&"desktop"==MediaView.mode&&"d"!=Cookie.get("mvp")&&t.filter(".desktop").hide(),t.on("click",(function(){const e=$(this).hasClass("phone")?"d":"p";return Cookie.set("mvp",e,7776e3),location.href=Url.addQueryParams(location.href,{".reload":(new Date).getTime(),mvp:e}),!1}))},forceMobile:function(){Cookie.set("mvp","p",7776e3)},setViewSwitcherCookie:function(e){Cookie.set("mvp",e,7776e3)}};$(document).ready($.proxy(Footer,"init"));var WebappSelector=function(){"use strict";return"undefined"!=typeof $&&$(document).ready((function(){setTimeout((function(){WebappSelector.create_ui(window.siteroot,Identities.isAdmin())}),1e3)})),{backendname:"unknown app",bc_cookie_set:!1,siteroot:null,create_ui:function(e,t){if(this.cookiename=$("#webapp-selector-ui").data("cookiename")||"bc_webapp",(t||Cookie.get(this.cookiename))&&e){WebappSelector.siteroot=e;let t=WebappSelector.backendname;const n=$("#webapp-selector-ui").data("bccookie"),a=$("#webapp-selector-ui").data("backendid");!n||a&&a!=n?a&&(WebappSelector.backendname=t=a):(WebappSelector.backendname=n,WebappSelector.bc_cookie_set=!0,t=WebappSelector.backendname+" (forced)"),WebappSelector.refresh_ui(t)}else $("#pgFt").one("dblclick",(function(t){if("A"!=t.target.tagName)return WebappSelector.create_ui(e,!0),!1})),$("#pgFt").on("touchend",(function(t){const n=(new Date).getTime();if(n-($(this).data("lastTap")||0)<500)return $(this).off("touchend"),WebappSelector.create_ui(e,!0),!1;$(this).data("lastTap",n)}))},refresh_ui:function(e){let t=$(".webapp-selector-link").off("click");if(!t.filter(".webapp-selector-ui .webapp-selector-link, .pg-ft-nav.connect .webapp-selector-link").length){const n=$('<a href="#" class="webapp-selector-link">').text(e);$(".webapp-selector-ui").css("display","inline-block").append(n),$(".pg-ft-nav.connect").append("<li>").append($('<li class="headroom">').append(n.clone(!0))),$(".pgft-phone .footer-extras").removeClass("hidden"),$("#pgFt-inner").addClass("webapp-selector-visible"),t=$(".webapp-selector-link")}t.text(e),t.on("click",(function(e){return WebappSelector.show_form(e),!1}))},show_form:function(){const e=[];WebappSelector.bc_cookie_set&&e.push({text:"Default webapp",click:function(){const e=WebappSelector.cookie_domain();Cookie.clear(WebappSelector.cookiename,"/",e,!1),WebappSelector.refresh_ui("reloading..."),$(this).dialog("close"),window.location.reload()}}),e.push({text:"OK",click:function(){const e=elt("webappselectordialog.item"),t=e.options[e.selectedIndex].value,n=WebappSelector.cookie_domain();Cookie.set(WebappSelector.cookiename,t,null,"/",n,!1),WebappSelector.refresh_ui("reloading..."),$(this).dialog("close"),window.location.reload()}}),NuDialog.alertHTML("Select webapp backend",'<select id="webappselectordialog.item" style="width:100%"></select>',{buttons:e}),WebappSelector.populate_machine_list()},populate_machine_list:function(){const e=$("#webapp-selector-ui").data("webapps"),t=elt("webappselectordialog.item");let n;t.innerHTML="";for(let a=0;a<e.length;a++)n=document.createElement("option"),n.value=e[a],n.innerHTML=Text.escapeHtml(e[a]),e[a]==WebappSelector.backendname&&(n.selected=!0),t.appendChild(n)},cookie_domain:function(){let e=window.location.hostname;return window.location.hostname.indexOf(WebappSelector.get_siteroot())>-1&&(e=WebappSelector.get_siteroot()),e},get_siteroot:function(){let e=WebappSelector.siteroot;return e?(e=e.replace("http://","").replace("https://",""),e.indexOf(":")>-1&&(e=e.substr(0,e.indexOf(":"))),e):""}}}(),NuDialog=function(){"use strict";$(document).on("dialogclose",(function(){$.event.trigger("bc_dialog_close")})),$(document).on("dialogopen",(function(){$.event.trigger("bc_dialog_open")}));const e=e=>{let t=document.querySelector('.ui-dialog.ui-widget .ui-dialog-titlebar-close.ui-state-focus[role="button"]');!t||" "!==e.key&&"Space"!==e.code&&"Enter"!==e.key&&"Enter"!==e.code||(t.click(),e.preventDefault())},t=e=>{document.body.addEventListener("keydown",e)};return{DEFAULT_OPTIONS:{dialogClass:"nu-dialog",draggable:!0,width:"35em",position:"center",modal:!0,buttons:{OK:function(){$(this).dialog("close")}},close:function(){var t;$(this).remove(),t=e,document.body.removeEventListener("keydown",t)},defaultFocus:function(){const e=$("div.nu-dialog").find("button");if(e)if(1==e.length)e.focus();else{const e=$("div.nu-dialog").find("button.default");e&&1==e.length&&e.focus()}else $("div.nu-dialog").focus()}},MOBILE_OPTIONS:{width:300,draggable:!1},alert:function(a,i,o,s){const r=o||NuDialog.DEFAULT_OPTIONS;return o&&o.dialogClass||((o=o||{}).dialogClass="nu-dialog no-close"),o=n($.extend({title:a,open:function(){r.defaultFocus&&r.defaultFocus()}},o)),t(e),$("<div>")[s?"html":"text"](i).dialog(o)},alertHTML:function(e,t,n){return NuDialog.alert(e,t,n,!0)},confirm:function(e,t,n){const a={buttons:[{text:"Cancel",class:"secondary",click:function(){$(this).dialog("close")}},{text:"OK",click:function(){$(this).dialog("close"),n()}}]};return NuDialog.alert(e,t,a)},showXHRError:function(e){if(window.isDebug&&Log.warn("FIXME: NuDialog.showXHRError is deprecated. Now code should use API endpoints and .showAPIError() instead."),!0===e.error){const t=e.exception&&e.exception.indexOf("ALERT: "),n={};return t&&t>=0?(e.alert_text=e.exception.slice(t+7),n.title="Note"):(e.browser=Browser,n.title="Error"),NuDialog.showTemplate("xhr_error_dialog",e,n),!0}return!1},showAPIError:function(e){return!!e.error&&(NuDialog.alert("API Error",e.error_message||"Unknown error."),!0)},showNetworkError:function(e,t,n){NuDialog.alert("Network Error","There was a network error. Please try again.\n(Status: "+t+")")},showTemplate:function(a,i,o){return o=n(o||{}),t(e),i=i||{},$("<div>").renderLiquid(a,i).dialog(o)},showViewModel:function(a){const i=a.templateName(),o="function"==typeof a.templateHash?a.templateHash():{};let s="function"==typeof a.dialogOptions?a.dialogOptions():{};const r=$("<div>").renderLiquid(i,o);return"function"==typeof a.$dialog&&a.$dialog(r),ko.applyBindings(a,r[0]),s=n(s),r.dialog(s),t(e),r}};function n(e){const t={};"string"==typeof e.dialogClass?t.dialogClass=NuDialog.DEFAULT_OPTIONS.dialogClass+" "+e.dialogClass:$.isArray(e.dialogClass)&&(t.dialogClass=NuDialog.DEFAULT_OPTIONS+" "+e.dialogClass.join(" "));const n=$.extend({},NuDialog.DEFAULT_OPTIONS);return"phone"===MediaView.mode&&$.extend(n,NuDialog.MOBILE_OPTIONS),$.extend(n,e,t),n}}();void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/xhr_error_dialog.liquid","warn"):Templ.register({xhr_error_dialog:['<div id="xhr-error-dialog">\r\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"alert_text ",attachment:["\r\n    <p>\r\n        ",{type:"variable",name:"alert_text",filters:[["h",[]]]},"\r\n    </p>\r\n    "]},{type:"else_ncondition",attachment:["\r\n    <h4>We regret to inform you that something odd happened.</h4>\r\n    \r\n    <p>\r\n        Please excuse the error.\r\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"member_of_current_band ",attachment:['\r\n            Artists: please  \r\n            <a href="/contact?subj=',{type:"variable",name:"error_type",filters:[["u",[]],["a",[]]]},"&amp;msg=",{type:"variable",name:"error_for_email",filters:[["a",[]]]},"\">click here</a> to let us know about the error. We'll get right on it.\r\n        "]}]},'\r\n    </p>\r\n    \r\n    <div class="dlg_errorInfo">\r\n    Some interesting stuff (to us):\r\n    <ul>\r\n        <li>url: ',{type:"variable",name:"url",filters:[["h",[]]]},"</li>\r\n        <li>error: ",{type:"variable",name:"exception",filters:[["h",[]]]},"</li>\r\n        <li>browser: ",{type:"variable",name:"browser.make",filters:[["h",[]]]}," ",{type:"variable",name:"browser.version",filters:[["join",["'.'"]],["h",[]]]}," ",{type:"variable",name:"browser.platform",filters:[["h",[]]]},"</li>\r\n        <li>date: ",{type:"variable",name:"date",filters:[["h",[]]]},"</li>\r\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"user ",attachment:["\r\n        <li>user: ",{type:"variable",name:"user",filters:[["h",[]]]},"</li>\r\n        "]}]},"\r\n        <li>host: ",{type:"variable",name:"host",filters:[["h",[]]]},"</li>\r\n    </div>\r\n    "]}]},"\r\n</div>"]}),$(document).ready((function(e){"use strict";const t=$("#pagedata").data("blob").cfg||{},n=new RegExp(TemplGlobals.siteroot+"/contact");$("a[href*='contact']:not([href*='contact_vinyl_support']):not([href*='contact_vinyl_rep'])").each((function(){let e=$(this).attr("href");(e.match(n)||e.match(/^\/contact/))&&$(this).click((function(n){n.preventDefault();const a=new RegExp(TemplGlobals.sitedomain),i=null===window.location.host.match(a),o=Url.toHash(e).search,s=Url.parseQuery(o),r=Contact.message_defaults(s,t);ContactTracker("click",r.band_id,"open_dialog"),"phone"==MediaView.mode||i||"ie"==Browser.make?(e=Url.addQueryParams(e,{p:location.href}),window.open(e)):Contact.show_form_dlg(r,n)})),$("#band-contact-mailto").click((function(e){const t=JSON.parse(document.getElementById("contact-tracker-data").dataset.bandId);ContactTracker("click",t,"open_mailto")}))}))}));var RecaptchaWrapper={_sdkLoadPromise:null,_gapi:new $.Deferred,_widget_id:null,initSDK:function(){if(RecaptchaWrapper._sdkLoadPromise)return RecaptchaWrapper._sdkLoadPromise;const e=$.cachedScript("https://www.google.com/recaptcha/api.js?onload=gcaptchaDependencyOnload&render=explicit").done((function(){Log.debug("ReCaptcha bootstrap loaded")}));return RecaptchaWrapper._sdkLoadPromise=$.when(e,RecaptchaWrapper._gapi)},resolve_gapi_deferred:function(){Log.debug("ReCaptcha API loaded"),RecaptchaWrapper._gapi.resolve()},public_key:function(){const e=$("#pagedata").data("blob");return e&&e.recaptcha_public_key},is_rendered:function(){return void 0!==$("#are-you-human iframe").attr("id")},render:function(){RecaptchaWrapper.is_rendered()?(Log.debug("resetting"),RecaptchaWrapper.reset()):RecaptchaWrapper._widget_id=grecaptcha.render("are-you-human",{sitekey:RecaptchaWrapper.public_key(),theme:"white",callback:function(){Log.debug("Valid ReCaptcha response"),Form.validate.clear_alert($("#contact\\.captcha_alert")),$(document).trigger("human-detected")}}),Contact.enable_the_buttons()},reset:function(){grecaptcha.reset(RecaptchaWrapper._widget_id)},fail:function(){Form.validate.show_alerts({field:"contact.captcha",reason:"recaptcha-not-reachable"},!1)},safe_destroy:function(){Contact.use_recaptcha()&&($(".pls-container").remove(),RecaptchaWrapper.reset())}},gcaptchaDependencyOnload=function(){RecaptchaWrapper.resolve_gapi_deferred()},Contact={show_form:function(e,t){let n=e;const a=new RegExp(TemplGlobals.sitedomain),i=null===window.location.host.match(a);if("phone"==MediaView.mode||i){n.p=location.href;const e="/contact?"+Url.joinQuery(n);window.open(e)}else n=Contact.message_defaults(e),Contact.show_form_dlg(n,t)},validation:{sections:{contact:{prefix:"contact"}},messages:{"contact.generic":{generic:TM("Sorry, there was an unexpected problem. Please try that again."),badBand:TM("Sorry, there was an unexpected problem. Please refresh the page and try again.")},"contact.name":{missingValue:TM("please enter your name")},"contact.email":{missingValue:TM("please enter your email address"),badFormat:TM("that’s not a valid email address"),noFacebook:TM("sorry, Facebook addresses are not supported.<br/>please enter a different email address.")},"contact.message":{missingValue:TM("please enter your message"),stringLength:TM("that message is too long")},"contact.fan_urls":{missingValue:TM("please provide your Fan Page URL"),badFormat:TM("hmm, this Fan Page URL doesn’t look right..."),badFormats:TM("hmm, not all of these Fan Page URLs look right...")},"contact.codes":{missingValue:TM("please provide your track/album code"),badFormat:TM("hmm, this doesn’t look like a Bandcamp track/album code..."),badFormats:TM("hmm, not all of these track/album codes look right...")},"contact.fb_urls":{missingValue:TM("please provide your Facebook Page URL"),badFormat:TM("hmm, this Facebook Page URL doesn’t look right..."),badFormats:TM("hmm, not all of these Facebook Page URLs look right...")},"contact.band_urls":{missingValue:TM("please provide your Bandcamp URL"),badFormat:TM("hmm, this Bandcamp URL doesn’t look right..."),badFormats:TM("hmm, not all of these Bandcamp URLs look right...")},"contact.dls":{missingValue:TM("please provide your download link"),badFormat:TM("hmm, this download link doesn’t look right..."),badFormats:TM("hmm, not all of these download links look right...")},"contact.preorders":{missingValue:TM("please provide a link to the album’s page"),badFormat:TM("hmm, this album link doesn’t look right..."),badFormats:TM("hmm, not all of these album links look right...")},"contact.original_email":{missingValue:TM("please enter the email address currently linked to the account"),badFormat:TM("that’s not a valid email address")},"contact.signup_date":{missingValue:TM("please enter the date you think you signed up")},"contact.purchased_item_url":{missingValue:TM("please provide the url of the item you purchased"),badFormat:TM("hmm, this Bandcamp URL doesn’t look right...")},"contact.purchase_email":{missingValue:TM("please enter the email address you think you used to purchase the item"),badFormat:TM("that’s not a valid email address")},"contact.reason_for_refund":{missingValue:TM("please provide the reason for refund")},"contact.purchase_url_or_album_title_and_artist_name":{missingValue:TM("please provide the purchase URL or album title and artist name")},"contact.bandcamp_or_paypal_transaction_id":{badFormat:TM("hmm, this id doesn’t look right...")},"contact.captcha":{"incorrect-captcha-sol":TM("please try again"),"captcha-timeout":TM("please try again"),"recaptcha-not-reachable":TM("apologies — human detection service unavailable, please try again later"),"malformed-api-response":TM("apologies — human detection service malfunctioning, please try again later"),"invalid-request-cookie":TM("please try again"),"missing-response":TM("please fill out the captcha")}}},subjects:{"Help setting up my Facebook app":{band_urls:"",fb_urls:""},"Help! I can’t log in!":{band_urls:"",original_email:"",signup_date:""},"Help! I never received my receipt.":{purchased_item_url:"",purchase_email:""},"Expired download":{dls:""},"Download code trouble":{codes:""},"Help with my Fan Account":{fan_urls:""},"Pre-order link not received":{preorders:""},"Fulfillment Inquiry":{band_urls:""},"Payment setup trouble":{band_urls:""},"Refund Request":{reason_for_refund:"",purchase_url_or_album_title_and_artist_name:"",bandcamp_or_paypal_transaction_id:""}},message_defaults:function(e,t){let n;const a=(n=e.b)&&(n=parseInt(n))?n:1;let i=null;const o=t&&t.zendesk_help_docs;(o&&location.href.match(/\/order_details\?(sig|payment_id|gift_id)=([^&]*)/)||!o&&location.href.match(/\/help\/physical_orders\/\?(sig|payment_id|gift_id)=([^&]*)/))&&(i=!0);const s=t&&t.contact_form_attachments;return{subj:e.subj||null,msg:e.msg||"",email:e.email||null,name:e.name||null,band_id:a,band_name:e.n||"Bandcamp Support",from_url:e.p||encodeURIComponent(location.href),prev_referrer_url:e.prev_referrer_url,from_order_details:i,contact_form_attachments:s}},populate_support_topic:function(){const e=Contact.fields.subj;e in Contact.subjects&&$.extend(Contact.fields,Contact.subjects[e]),1==Contact.fields.band_id&&(Contact.check_for_banner(),Contact.banner_msg&&(Contact.fields.banner_msg=Contact.banner_msg))},check_for_banner:function(){$.ajax({type:"POST",url:"/contact_banner_cb",dataType:"json",async:!1,success:function(e){e.banner_msg?Contact.banner_msg=e.banner_msg:delete Contact.banner_msg},error:function(e){Log.info("check_for_banner failed: "+e.status)}})},show_form_page:function(e,t,n){window.Form.revealError=function(){},Contact.fields=e,Contact.fields.use_captcha=Contact.use_recaptcha(),Contact.fields.last_sent_date=Contact.get_last_sent_date(),Contact.popped_open=t,Contact.return_url=n,Contact.populate_support_topic(),Contact.fields.is_modal=!1,t&&1!=Contact.fields.band_id&&(Contact.validation.messages["contact.generic"].badBand=TM("Sorry, there was an unexpected problem. Please return to the artist’s page and try again.")),Templ.renderElem("contact-form","contact_form_2018",Contact.fields),$("#contact\\.cancel").click(Contact.cancel_button);const a=$(".toggle-edit"),i=$(".toggleable input");a.click((function(){i.removeClass("no-edit"),i.attr("readonly",!1),a.hide()})),i.focusin((function(){i.attr("readonly")||a.hide()})),Form.init("contactForm",null,null,Contact.validation,(function(e){Contact.submit_button(e)})),Contact.setup_recaptcha(),Contact.make_stretchy_textareas(),Contact.prep_attachment_input()},show_form_dlg:function(e,t){if(window.Form.revealError=function(){},Contact.fields=e,Contact.populate_support_topic(),Contact.fields.is_modal=!0,Contact.fields.banner_msg){const e=TM("Contact {{band_name}}",{band_name:Contact.fields.band_name},"Contact modal header title"),n=Templ.render("contact_support_alert",{modal:!0,banner_msg:Contact.fields.banner_msg,faq_url:null}),a=TM("Contact Bandcamp Support"),i=this,o=function(){i.show_form_inner(t)};NuDialog.alertHTML(Text.escapeHtml(e),n,{dialogClass:"contact-dlg",buttons:[{text:a,click:function(){o(),$(this).dialog("close")}}]}),$(".mask").css("background","#000")}else this.show_form_inner(t)},show_form_inner:function(e){Contact.fields.use_captcha=Contact.use_recaptcha(),Contact.fields.last_sent_date=Contact.get_last_sent_date(),Contact.fields.language_msg=1===Contact.fields.band_id&&Translate&&Translate.locale!==Translate.EN_DEFAULT;const t=TM("Contact {{band_name}}",{band_name:Contact.fields.band_name},"Contact modal header title");let n=null;return NuDialog.showTemplate("contact_form_2018",Contact.fields,{title:Text.escapeHtml(t),width:"448px",dialogClass:"contact-dlg",buttons:[],open:function(){$(".mask").css("background","#000"),n=$(this),$("#contact\\.cancel").click((function(e){Contact.cancel_button(e,n)}));const e=$(".toggle-edit"),t=$(".toggleable input");e.click((function(){t.removeClass("no-edit"),t.attr("readonly",!1),e.hide()})),t.focusin((function(){t.attr("readonly")||e.hide()})),Form.init("contactForm",null,null,Contact.validation,(function(e){Contact.submit_button(e,n)})),Contact.setup_recaptcha(),Contact.make_stretchy_textareas(),Contact.prep_attachment_input()},close:function(){Form.detach(),$(this).find("form").remove(),$(this).dialog("destroy")}}),e&&e.stopPropagation(),n},use_recaptcha:function(){const e=$("#pagedata").data("blob");return!(1==Contact.fields.band_id||e.identities.user||!RecaptchaWrapper.public_key())},sent_date_cache_key:()=>"contact_".concat(Contact.fields.band_id),set_last_sent_date:()=>{try{const e=60*(new Date).getTimezoneOffset()*1e3,t=new Date(Date.now()-e).toISOString();localStorage.setItem(Contact.sent_date_cache_key(),t)}catch(e){}},get_last_sent_date:()=>{let e;try{e=localStorage.getItem(Contact.sent_date_cache_key())}catch(e){return null}return!e||new Date-Date.parse(e)>6048e5?null:e},setup_recaptcha:function(){Contact.use_recaptcha()&&(Contact.disable_the_buttons(),RecaptchaWrapper.initSDK().then(RecaptchaWrapper.render,RecaptchaWrapper.fail))},submit_button:function(e,t){$.Event(e).preventDefault(),Contact.disable_the_buttons(),ContactTracker("click",Contact.fields.band_id,"submit_form");let n=$("#contactForm").serialize();const a=document.querySelector("#contactForm input[type='file']");if(a&&0!==a.files.length){let e=a.files.length;if(e>5)return void alert(TM("You can attach a maximum of 5 files"));for(let i=0;i<e;i++){const o=a.files[i],s=new FileReader;s.addEventListener("error",(()=>{window.alert(TM("Did not send - could not attach files.")),Contact.enable_the_buttons()})),s.addEventListener("load",(()=>{const a={};a["contact.attachment_".concat(i,"_filename")]=o.name,a["contact.attachment_".concat(i,"_data")]=s.result,n+="&"+new URLSearchParams(a).toString(),--e||Contact.submit_form(n,t)}),!1),s.readAsDataURL(o)}}else Contact.submit_form(n,t)},submit_form:(e,t)=>{Crumb.ajax({type:"POST",url:"/contact_cb",data:e,dataType:"json",success:function(e,n,a){Contact.success(e,n,a,t)},error:function(e,t,n){Contact.failure(e,t,n)}})},success:function(e,t,n,a){if(e.errors||e.error){if(Contact.enable_the_buttons(),e.errors)Form.validate.show_alerts(e.errors,!1);else{NuDialog.alert("Oops!",Contact.validation.messages["contact.generic"].generic,{dialogClass:"contact-dlg"});$(".mask").css("background","#000")}RecaptchaWrapper.safe_destroy()}else if(Contact.set_last_sent_date(),a){RecaptchaWrapper.safe_destroy(),a.dialog("close");var i=Templ.render("contact_form_verification",{band_name:Contact.fields.band_name,ok:!0,to_support:1==Contact.fields.band_id,from_order_details:Contact.fields.from_order_details,return_url:!1});const e=TM("Contact {{band_name}}",{band_name:Contact.fields.band_name},"Contact modal verification pane"),t=TM("Done");NuDialog.alertHTML(Text.escapeHtml(e),i,{dialogClass:"contact-dlg",buttons:[{text:t,click:function(){$(this).dialog("close")}}]}),$(".mask").css("background","#000")}else if(Contact.popped_open)window.close();else{Contact.return_url||TemplGlobals.siteroot;i=Templ.render("contact_form_verification",{band_name:Contact.fields.band_name,ok:!0,to_support:1==Contact.fields.band_id,from_order_details:Contact.fields.from_order_details,return_url:Contact.return_url});if("phone"==MediaView.mode){$("#contact-banner").hide();let e=null;e=null!==$("#contact-page-info").first().offset()?$("#contact-page-info").first().offset().top:$(".vinyl-crowdfunding-contact-page-info").first().offset().top,$("html, body").animate({scrollTop:e},500)}a=$("#contact-form").replaceWith(i)}},failure:function(e,t,n){Contact.enable_the_buttons(),Form.validate.show_alerts({field:"contact.generic",reason:"generic"},!1),Log.info("contact callback failure: status: "+e.status+"; statusText: "+n)},cancel_button:function(e,t){if(e.stopPropagation(),t)RecaptchaWrapper.safe_destroy(),t.dialog("close");else if(Contact.popped_open)window.close();else{const e=Contact.return_url||TemplGlobals.siteroot;window.location=e}},disable_the_buttons:function(){$("#contact\\.send").addClass("disabled"),$("#contact\\.send").prop("disabled",!0),$("#contact\\.send").text="Sending...",$("#contact\\.cancel").addClass("disabled"),$("#contact\\.cancel").prop("disabled",!0)},enable_the_buttons:function(){$("#contact\\.send").removeClass("disabled"),$("#contact\\.send").prop("disabled",!1),$("#contact\\.send").text="Send",$("#contact\\.cancel").removeClass("disabled"),$("#contact\\.cancel").prop("disabled",!1)},make_stretchy_textareas:function(){$("#contactForm textarea").each((function(){addExpandEventListeners(this);let e=52;"contact.message"==this.name&&(e=this.value?$(this).height(0).height(this.scrollHeight):150),addShrinkEventListeners(this,e)}))},prep_attachment_input:()=>{const e=document.querySelector("#contactForm input[name='attachments']");null==e||e.addEventListener("change",(e=>{const t=e.target;if(!t.files)return;const n=Array.from(t.files);if(n.length>5)return window.alert(TM("Attachments removed - you can attach a maximum of 5 files")),void(t.value="");for(let e=0;e<n.length;e++)if(n[e].size>10485760){window.alert(TM("Attachments removed - each file must be smaller than 10mb")),t.value="";break}}))}},ContactTracker=function(e,t,n){if(!window.ClientID)return;const a={feature:"artist-contact-form",action:n,band_id:t};BCTracker.record(e,a)};void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/contact_form_2018.liquid","warn"):Templ.register({contact_form_2018:['<form id="contactForm" action="/no_js" method="post" accept-charset="utf-8">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"last_sent_date ",attachment:["\n        <p>\n            <strong>\n                ",{type:"translate",nodelist:["You sent a message using this form on ",{type:"translateVariable",var_name:"date",nodelist:[{type:"variable",name:"last_sent_date",filters:[["time",["'yyyyMMMMd'"]],["h",[]]]}]}," at ",{type:"translateVariable",var_name:"time",nodelist:[{type:"variable",name:"last_sent_date",filters:[["time",["'hhmm'"]],["h",[]]]}]},"."]},"\n            </strong>\n        </p>\n    "]}]},"\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"language_msg ",attachment:['\n        <div id="contact.languages">',{type:"translate",nodelist:["Our support in your language is still in progress. Please forgive us if we respond in English."]},"</div>\n    "]}]},'\n\n    <input type="hidden" name="contact.band_id" value="',{type:"variable",name:"band_id",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.band_name" value="',{type:"variable",name:"band_name",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.from_url" value="',{type:"variable",name:"from_url",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.prev_referrer_url" value="',{type:"variable",name:"prev_referrer_url",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.from_order_details" value="',{type:"variable",name:"from_order_details",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.from_vinyl_pledge_email" value="',{type:"variable",name:"from_vinyl_pledge_email",filters:[["a",[]]]},'"/>    \n    <input type="hidden" name="contact.platform" value="',{type:"variable",name:"platform",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.device" value="',{type:"variable",name:"device",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.app_version" value="',{type:"variable",name:"app_version",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.fan" value="',{type:"variable",name:"fan",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.contact_vinyl_support" value="',{type:"variable",name:"contact_vinyl_support",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.contact_vinyl_rep" value="',{type:"variable",name:"contact_vinyl_rep",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.reported_tou_url" value="',{type:"variable",name:"reported_tou_url",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.reported_item_type" value="',{type:"variable",name:"reported_item_type",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.reported_item_id" value="',{type:"variable",name:"reported_item_id",filters:[["a",[]]]},'"/>\n\n    \n    ',{type:"ef",blocks:[{type:"ncondition",expression:"from_order_details || from_vinyl_pledge_email ",attachment:["\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"subj ",attachment:['\n            <input type="hidden" name="contact.subject" value="',{type:"variable",name:"subj",filters:[["a",[]]]},'"/>\n        ']}]},"\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"name ",attachment:['\n            <input type="hidden" name="contact.name" value="',{type:"variable",name:"name",filters:[["a",[]]]},'"/>\n        ']}]},"\n    "]}]},'\n\n    <div id="contact.generic" class="alert"></div>\n\n    <dl class="tableLayout">\n        <div class="tableLayoutRow">\n            <dt>',{type:"translate",nodelist:["Email address"]},'</dt>\n            <dd>\n                <div class="toggleable">\n                    <input type="text" class="textInput ',{type:"ef",blocks:[{type:"ncondition",expression:"email ",attachment:["no-edit"]}]},'" id="contact.email" name="contact.email" value="',{type:"variable",name:"email",filters:[["a",[]]]},'" ',{type:"ef",blocks:[{type:"ncondition",expression:"email ",attachment:["readonly"]}]},"/>\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:"email ",attachment:['\n                        <span class="toggle-edit">',{type:"translate",nodelist:["change"]},"</span>\n                    "]}]},'\n                </div>\n                <p id="contact.email_alert" class="alert"></p>\n            </dd>\n        </div>\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"!name || !from_order_details ",attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["Name"]},'</dt>\n                <dd>\n                    <input class="textInput" id="contact.name" name="contact.name" value="',{type:"variable",name:"name",filters:[["a",[]]]},'"/>\n                    <p id="contact.name_alert" class="alert"></p>\n                </dd>\n            </div>\n        ']}]},"\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"!subj || !from_order_details ",attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["Subject"]},'</dt>\n                <dd>\n                    <input class="textInput" id="contact.subject" name="contact.subject" value="',{type:"variable",name:"subj",filters:[["a",[]]]},'"/>\n                    <p id="contact.subject_alert" class="alert"></p>\n                </dd>\n            </div>\n        ']}]},'\n        <div class="tableLayoutRow">\n            <dt>',{type:"translate",nodelist:["Message"]},'</dt>\n            <dd>\n                <textarea rows="7" class="textInput" id="contact.message" name="contact.message">',{type:"variable",name:"msg",filters:[["h",[]]]},'</textarea>\n                <p id="contact.message_alert" class="alert"></p>\n            </dd>\n        </div>\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"band_id == 1 && contact_form_attachments ",attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["Attachments"]},'</dt>\n                <dd>\n                    <input\n                        type="file"\n                        name="attachments"\n                        multiple="true"\n                        accept="image/*,audio/*,video/*,application/pdf,text/csv,application/csv,text/plain"\n                    />\n                </dd>\n            </div>\n        ']}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"fan_urls",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["Fan Account URL"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.fan_urls" name="contact.fan_urls">',{type:"variable",name:"fan_urls",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.fan_urls_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"codes",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["download code"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.codes" name="contact.codes" >',{type:"variable",name:"codes",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.codes_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"fb_urls",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["facebook URLs"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.fb_urls" name="contact.fb_urls">',{type:"variable",name:"fb_urls",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.fb_urls_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"band_urls",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["band URLs"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.band_url" name="contact.band_urls">',{type:"variable",name:"band_urls",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.band_urls_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"original_email",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["current login email"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.original_email" name="contact.original_email">',{type:"variable",name:"original_email",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.orginal_email_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"signup_date",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["approximate signup date"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.signup_date" name="contact.signup_date">',{type:"variable",name:"signup_date",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.signup_date_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"purchased_item_url",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["link to item you purchased"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.purchased_item_url" name="contact.purchased_item_url">',{type:"variable",name:"purchased_item_url",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.purchased_item_url_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"purchase_email",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["email you think you used to purchase the item"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.purchase_email" name="contact.purchase_email">',{type:"variable",name:"purchase_email",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.purchase_email_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"dls",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["download links"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.dls" name="contact.dls">',{type:"variable",name:"dls",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.dls_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"preorders",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["album page"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.preorders" name="contact.preorders">',{type:"variable",name:"preorders",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.preorder_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"reason_for_refund",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["reason for refund"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.reason_for_refund" name="contact.reason_for_refund">',{type:"variable",name:"reason_for_refund",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.reason_for_refund" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"purchase_url_or_album_title_and_artist_name",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["purchase url or album title and artist name"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.purchase_url_or_album_title_and_artist_name" name="contact.purchase_url_or_album_title_and_artist_name">',{type:"variable",name:"purchase_url_or_album_title_and_artist_name",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.purchase_url_or_album_title_and_artist_name" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"bandcamp_or_paypal_transaction_id",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["Bandcamp or PayPal transaction ID <span ",{type:"translateVariable",var_name:"markup_italics",nodelist:['class="contact-form-optional"']},">optional</span>"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.bandcamp_or_paypal_transaction_id" name="contact.bandcamp_or_paypal_transaction_id">',{type:"variable",name:"bandcamp_or_paypal_transaction_id",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.bandcamp_or_paypal_transaction_id" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n\n        ",{type:"if",blocks:[{type:"condition",left:"use_captcha",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["Be human"]},'</dt>\n                <dd>\n                    <div id="are-you-human"></div>\n                    <p id="contact.captcha_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},'\n\n        <div id="contact.support_alert" class="alert"></div>\n\n        <dd class="contact-action-buttons">\n            <button type="submit" name="contact.send" value="OK" id="contact.send">\n                <span id="contact.send.text">\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"band_id == 1 ",attachment:["\n                        ",{type:"translate",nodelist:["Send message"]},"\n                    "]},{type:"else_ncondition",attachment:["\n                        ",{type:"translate",nodelist:["Send message to ",{type:"variable",name:"band_name",filters:[["h",[]]]},""]},"\n                    "]}]},"\n                </span>\n            </button>\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"from_url ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_modal ",attachment:['\n                    <button type="button" name="contact.cancel" value="Cancel" id="contact.cancel"><span>',{type:"translate",nodelist:["cancel"]},"</span></button>\n                "]},{type:"else_ncondition",attachment:['\n                    <button type="button" name="contact.cancel" value="Cancel" id="contact.cancel"><span>',{type:"translate",nodelist:["go back"]},"</span></button>\n                "]}]},"\n            "]}]},"\n        </dd>\n    </dl>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/contact_form_verification.liquid","warn"):Templ.register({contact_form_verification:['<div class="contact-verification">\n    <div class="contact-verification-img">\n        <img src="/img/blue-checkmark.svg">\n    </div>\n    <div class="contact-verification-message">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"to_support ",attachment:["\n            <h1>",{type:"translate",nodelist:["Thank you for your message!"]},"</h1>\n            <p>",{type:"translate",nodelist:["We have received it and will email you a response as soon as we can."]},"</p>\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"from_order_details ",attachment:["\n                <h1>",{type:"translate",nodelist:["Your message was sent to ",{type:"translateVariable",var_name:"band_name",nodelist:[{type:"variable",name:"band_name",filters:[["h",[]]]}]}," and a copy of it was sent to your email."]},"</h1>\n            "]},{type:"else_ncondition",attachment:["\n                <h1>",{type:"translate",nodelist:["Your message was sent to ",{type:"translateVariable",var_name:"band_name",nodelist:[{type:"variable",name:"band_name",filters:[["h",[]]]}]},"."]},"</h1>\n            "]}]},"\n            <p>\n                <span>",{type:"translate",nodelist:["Please allow 5-7 business days for a response."]},"</span>\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"from_order_details ",attachment:['\n                    <br>\n                    <a href="/help/physical_orders#not-received" target="_blank" class="contact-verification-cancel">',{type:"translate",nodelist:["What to do if you don’t get a response."]},"</a>\n                "]}]},"\n            </p>\n        "]}]},"\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"return_url ",attachment:['\n            <p>\n                <a href="',{type:"variable",name:"return_url",filters:[["a",[]]]},'">',{type:"translate",nodelist:["Return to Bandcamp"]},"</a>\n            </p>\n        "]}]},"\n    </div>\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/contact_support_alert.liquid","warn"):Templ.register({contact_support_alert:["\n",{type:"capture",to:"greeting",nodelist:["\n    ",{type:"case",blocks:[{type:"condition",left:"banner_msg",right:"1",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Hello from Bandcamp Support!"]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"2",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Hello from Bandcamp Support!"]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"3",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Hello from Bandcamp Support!"]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"4",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Hey there!"]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"6",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Hello!"]},"\n    "],child_relation:null,child_condition:null}]},"\n"]},"\n",{type:"capture",to:"greeting",nodelist:[{type:"variable",name:"greeting",filters:[["strip",[]]]}]},"\n\n",{type:"capture",to:"body",nodelist:["\n    ",{type:"case",blocks:[{type:"condition",left:"banner_msg",right:"1",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["We’re experiencing a high volume of emails at this time and our response times are slower than usual."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"2",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Our support team is traveling from far and wide to meet up and work through ways to make the Bandcamp experience even better."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"3",operator:"==",attachment:["\n            &nbsp;❄ ❆&nbsp;",{type:"translate",nodelist:["Most of our support team is on holiday observing end-of-year festivities."]},"&nbsp;❄ ❆&nbsp;\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"4",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["We’re experiencing an unusually high volume of emails from our fundraisers this summer and our responses may take an extra few days."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"5",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["The Bandcamp Support team will be offline from December 24th through January 3rd."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"6",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Most of our support team is currently on holiday. Please allow us an extra day or two to respond to your message."]},"\n    "],child_relation:null,child_condition:null}]},"\n"]},"\n\n",{type:"capture",to:"closing",nodelist:["\n    ",{type:"case",blocks:[{type:"condition",left:"banner_msg",right:"1",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["We appreciate your patience."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"2",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Please allow us an extra day or two to reply to your message."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"3",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Please allow us an extra day or two to reply to your message."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"5",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["We appreciate your patience and will respond to any missed messages upon our return."]},"\n    "],child_relation:null,child_condition:null}]},"\n"]},"\n\n",{type:"capture",to:"faq_text",nodelist:["\n    ",{type:"case",blocks:[{type:"condition",left:"banner_msg",right:"4",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Here’s a list of <a ",{type:"translateVariable",var_name:"faq_url",nodelist:['href="https://get.bandcamp.help/hc/articles/360045411433"']},">common questions</a> that may help you in the meantime - power!"]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"6",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["In the meantime, we’ve put together a list of <a ",{type:"translateVariable",var_name:"faq_url",nodelist:['href="https://get.bandcamp.help/hc/articles/5129351828887"']},">common questions to help</a>. We appreciate your patience."]},"\n        "],child_relation:null,child_condition:null},{type:"else_condition",attachment:["\n            ",{type:"translate",nodelist:["Check out our FAQs to see if you can <a ",{type:"translateVariable",var_name:"faq_url",nodelist:['href="',{type:"variable",name:"faq_url",filters:[["a",[]]]},'"']},">resolve any issues right now</a>. Power!"]},"\n    "]}]},"\n"]},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"!popped_open && band_id == 1 && banner_msg ",attachment:["\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"modal ",attachment:['\n        <div id="contact-banner" class="modal">\n            <div class="contact-banner-img">\n                \n                <img src="/img/waving-hand.svg">\n            </div>\n            <div class="contact-banner-message">\n                <p class="contact-banner-message-header">\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:'greeting != "" ',attachment:["\n                        <span>",{type:"variable",name:"greeting",filters:[]},"</span>\n                    "]}]},"\n                    <br>\n                    <strong>",{type:"variable",name:"body",filters:[]},"</strong>\n                </p>\n                <p>\n                    <span>",{type:"variable",name:"closing",filters:[]},"</span>\n                </p>\n            </div>\n        </div>\n    "]},{type:"else_ncondition",attachment:['\n        <div id="contact-banner" class="page">\n            <div class="contact-banner-img">\n                \n                <img src="/img/waving-hand.svg">\n            </div>\n            <div class="contact-banner-message">\n                <p>\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:'greeting != "" ',attachment:["\n                        <span>",{type:"variable",name:"greeting",filters:[]},"</span>\n                    "]}]},"\n                    <strong>",{type:"variable",name:"body",filters:[]},"</strong>\n                    <span>",{type:"variable",name:"closing",filters:[]},"</span>\n                </p>\n            </div>\n        </div>\n    "]}]},"\n"]}]},'\n\n<p class="contact-banner-faq">\n    ',{type:"variable",name:"faq_text",filters:[]},"\n</p>\n"]});const MobileNavbar={scrollNavActive:function(){const e=document.querySelector("#band-navbar");if(e.scrollWidth>e.offsetWidth){var t;const n=e.querySelector('[aria-selected="true"]')||(null===(t=e.querySelector(".active"))||void 0===t?void 0:t.parentNode);if(!n)return;const a=n.offsetLeft;a+n.offsetWidth>e.offsetWidth&&e.scroll(a,0)}}};document.addEventListener("DOMContentLoaded",(()=>{window.MediaView&&"phone"===MediaView.mode&&document.querySelector("#band-navbar")&&MobileNavbar.scrollNavActive()}));var BubbleMessage=function(e,t){t||(t=2e3);const n=$('<div class="bubble-msg"><span class="bubble-msg-inner">'+e+"</span></div>");return n.appendTo(document.body).delay(150).fadeToggle("fast").delay(t).fadeOut("fast",null,(function(){$(this).remove()})),n.find(".bubble-msg-inner")};void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_signup_pane.liquid","warn"):Templ.register({"fan/signup/fan_signup_pane":['<form id="signup-vm" class=\'signup-form modern-form signup-common-form ',{type:"ef",blocks:[{type:"ncondition",expression:"show ",attachment:["visible"]}]},'\' data-bind=\'css: { "visible": visible, "immediate": immediate }, submit: submit\' novalidate>\n    <a id="signup-anchor"></a>\n\n    <div class="signup-common-inner">\n        <div class="item dialog-body choose-your-url" data-bind="visible: loggedIn() && !showExistingArtist()" style="display: none;">\n            \x3c!-- ko switch --\x3e\n                \x3c!-- ko case: showLiveInviteAcceptArtistMsg() --\x3e\n                    ',{type:"translate",nodelist:["In order to accept your invitation, please first choose a URL for your new fan account:"]},"\n                \x3c!-- /ko --\x3e\n\n                \x3c!-- ko case: $else --\x3e\n                    ",{type:"translate",nodelist:["Please choose a URL for your fan account:"]},'\n                \x3c!-- /ko --\x3e\n            \x3c!-- /ko --\x3e\n        </div>\n\n        <div class="item dialog-body existing-artist-standalone" data-bind="visible: showExistingArtist" style="display: none;">\n            <p>',{type:"translate",nodelist:["Greetings!"]},"</p>\n\n            <p>",{type:"translate",nodelist:["Fan accounts let you follow other artists and fans, give you instant streaming of your purchases via the free Bandcamp app, and <a ",{type:"translateVariable",var_name:"fanslink",nodelist:['target="_blank" href="/fans"']},">lots more</a>."]},"</p>\n            \n            <p>",{type:"translate",nodelist:["<strong>To add a Bandcamp fan account to your artist account, enter a fan URL below.</strong> If you prefer to keep your fan account separate from your artist account, please log out and return to sign up."]},'</p>\n        </div>\n\n        <div class="item dialog-body signup-prompt" data-bind="visible: showGiftCardPrompt" style="display: none;">\n            <p>',{type:"translate",nodelist:["Please sign up to continue your gift card purchase:"]},'<p>\n        </div>\n\n        <div class="skinny">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"download_item ",attachment:['\n                <div class="download-item-small-space-saver">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"rendered ",attachment:["\n                    ",{type:"include",template_name:"'account/download_item_small'"},"\n                "]}]},"\n                </div>\n            "]}]},'\n            <div class="before-chooser" data-bind="css: { \'disabled\': chooserVisible }">\n                <div class="existing-account-wrapper" data-bind="css: { \'show-existing\': inlineLoginVisible }">\n                    <div class="item" data-bind="visible: !loggedIn()" ',{type:"ef",blocks:[{type:"ncondition",expression:"pagedata && pagedata.identities && pagedata.identities.user ",attachment:['style="display: none;"']}]},">\n                        ",{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:['<label for="email-input" class="email-label">',{type:"translate",nodelist:["Email address"]},"</label>"]}]},'\n                        <div class="email">\n                            <div class="email-inner jquery-placeholder-wrapper">\n                                <input id="email-input" class="email-input" type="email" data-bind="\n                                    value: email,\n                                    hasfocus: email.focused,\n                                    valueUpdate: [\'input\', \'afterkeydown\'],\n                                    css: {\n                                        \'has-validation-error\': email.error_msg(),\n                                        \'error\': email.error_msg()\n                                    },\n                                    enable: !chooserVisible() && !disableEmailField()\n                                " ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['placeholder="',{type:"translate",nodelist:["email"]},'"']}]},' disabled>\n                            </div>\n                            <span data-bind="visible: email.checking" style="display: none;">\n                                \x3c!-- <img class="email-checking" src="/img/playerbusy_transp.gif"> --\x3e\n                            </span>\n                            <div class="error-bubble log-in-error" style="display: none;" data-bind="animateVisible: email.error_key() === \'existing_fan\'"><span class="message">',{type:"translate",nodelist:["A fan with that email address already exists. Please <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: function () { openLogin(true); }"']},">log in</a>."]},'</span></div>\n                            <div class="error-bubble" style="display: none;" data-bind="animateVisible: email.error_key() === \'fan_already_linked_email\'"><span class="message">',{type:"translate",nodelist:["That address is attached to an existing fan account, but is not the primary address used for login. Please <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: function () { openLogin(true); }"']},">log in</a> with your primary address."]},'</span></div>\n                            <div class="error-bubble" style="display: none;" data-bind="animateVisible: email.error_key() === \'invalid\'"><span class="message">',{type:"translate",nodelist:["That email address doesn’t look right."]},'</span></div>\n                        </div>\n                    </div>\n\n                    <div data-bind="css: { \'show\': inlineLoginVisible }" class="existing-account-login">\n                        <div class="account-message">\n                            <p>\n                            <strong>',{type:"translate",nodelist:["This address is associated with an existing artist account."]},"</strong>\n                            ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:["</p><p>"]}]},"\n                            ",{type:"translate",nodelist:["To add a Bandcamp fan account to your artist account, enter your password below. If you prefer to keep your fan account separate from your artist account, enter a different email address above."]},"</p>\n                            <p>",{type:"translate",nodelist:["Fan accounts let you follow other artists and fans, give you instant streaming of your purchases via the free Bandcamp app, and <a ",{type:"translateVariable",var_name:"fanslink",nodelist:['href="/fans"']},">lots more</a>."]},'</p>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="item" data-bind="visible: !loggedIn()" ',{type:"ef",blocks:[{type:"ncondition",expression:"pagedata && pagedata.identities && pagedata.identities.user ",attachment:['style="display: none;"']}]},">\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:['<label for="password-input" class="password-label">\n                        <span>\n                            ',{type:"translate",nodelist:["Password"]},"\n                        </span>\n                    </label>"]}]},'\n                    <div class="password" data-bind="visible: !passwordMasked()">\n                        <div class="password-inner jquery-placeholder-wrapper">\n                            <input id="password-input" type="password" class="password-input" data-bind="\n                                value: password,\n                                errorBubble: password.error_msg,\n                                valueUpdate: \'input\',\n                                hasfocus: password.focused,\n                                css: {\n                                    \'has-validation-error\': password.error_msg()\n                                },\n                                enable: !chooserVisible()\n                            " ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['placeholder="',{type:"translate",nodelist:["password"]},'"']}]},' disabled autocomplete="new-password">\n                        </div>\n                        <div class="error-bubble" style="display: none;">\n                            <span class="message"></span>\n                            <span data-bind=\'visible: password.error_key() === "incorrect"\' style="display: none;">\n                                \x3c!-- <a data-bind="click: function() { openForgotPassword(); }">forgot your password?</a> --\x3e\n                                <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/forgot_password">',{type:"translate",nodelist:["Forgot your password?"]},'</a>\n                            </span>\n                        </div>\n                    </div>\n                    <div class="password masked" data-bind="visible: passwordMasked" style="display: none;">\n                        &bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;\n                    </div>\n                </div>\n\n                ',{type:"capture",to:"placeholder",nodelist:[{type:"ef",blocks:[{type:"ncondition",expression:"pagedata && pagedata.identities && pagedata.identities.user ",attachment:[{type:"translate",nodelist:["choose your fan URL"]}]},{type:"else_ncondition",attachment:[{type:"translate",nodelist:["username"]}]}]}]},"\n\n                ",{type:"capture",to:"username_label",nodelist:[{type:"ef",blocks:[{type:"ncondition",expression:"pagedata && pagedata.identities && pagedata.identities.user ",attachment:[{type:"translate",nodelist:["Choose your fan URL"]}]},{type:"else_ncondition",attachment:[{type:"translate",nodelist:["Username"]}]}]}]},'\n\n                <div class="item ',{type:"ef",blocks:[{type:"ncondition",expression:"pagedata && pagedata.identities && pagedata.identities.user ",attachment:["existing-artist"]}]},'" data-bind="css: { \'existing-artist\': loggedIn }">\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:['<label for="username-input" class="username-label" data-bind="text: username.label, css: { \'artist-email\': inlineLoginVisible }">',{type:"variable",name:"username_label",filters:[]},"</label>"]}]},'\n                    <div class="username" data-bind="css: { \'artist-email\': inlineLoginVisible }">\n                        <div class="username-inner jquery-placeholder-wrapper">\n                            <div class="bandcamp-com"><span>bandcamp.com/</span></div><input id="username-input" type="text" class="username-input" data-bind="\n                                value: username.display,\n                                valueUpdate: \'input\',\n                                hasfocus: username.focused,\n                                css: {\n                                    \'has-validation-error\': username.error_msg(),\n                                    \'error\': username.error_msg()\n                                },\n                                enable: !chooserVisible()',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:[",\n                                attr: {\n                                    'placeholder': username.placeholder\n                                }"]}]},'\n                            " ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['placeholder="',{type:"variable",name:"placeholder",filters:[]},'"']}]},' disabled autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">\n                        </div>\n                        <div class="error-bubble" style="display: none;" data-bind="animateVisible: usernameIsURL() && username.error_key()">\n                            <span class="message" data-bind="visible: username.error_key() === \'missing\'">\n                                ',{type:"translate",nodelist:["Please choose your URL."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'tooShort\'">\n                                ',{type:"translate",nodelist:["Your URL must be at least 3 characters."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'tooLong\'">\n                                ',{type:"translate",nodelist:["Your URL can be at most 60 characters."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'duplicate\'">\n                                ',{type:"translate",nodelist:["That URL is already taken."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'invalid\'">\n                                ',{type:"translate",nodelist:["Your URL must only contain letters, numbers, dashes, or underscores."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'undies\'">\n                                ',{type:"translate",nodelist:["Your URL must contain at least one letter, number, or dash."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'isEmail\'">\n                                ',{type:"translate",nodelist:["Your URL cannot be an email address."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'existingFanLoggedIn\'">\n                                ',{type:"translate",nodelist:["A fan with that email address already exists. Please <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/logout?login=1"']},">log in</a>."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'fanAlreadyLinkedEmail\'">\n                                ',{type:"translate",nodelist:["That address is attached to an existing fan account, but is not the primary address used for login. Please <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/logout?login=1"']},">log in</a> with your primary address."]},'\n                            </span>\n\n                            <span data-bind="visible: suggestedUsername">',{type:"translate",nodelist:["How about ",{type:"translateVariable",var_name:"suggested_username",nodelist:['<strong><a href="#" data-bind="text: suggestedUsername, click: function () { useSuggestedUsername(); }"></a></strong>']},"?"]},'</span>\n                        </div>\n                        <div class="error-bubble" style="display: none;" data-bind="animateVisible: !usernameIsURL() && username.error_key()">\n                            <span class="message" data-bind="visible: username.error_key() === \'missing\'">\n                                ',{type:"translate",nodelist:["Please choose your username."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'tooShort\'">\n                                ',{type:"translate",nodelist:["Your username must be at least 3 characters."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'tooLong\'">\n                                ',{type:"translate",nodelist:["Your username can be at most 60 characters."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'duplicate\'">\n                                ',{type:"translate",nodelist:["That username is already taken."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'invalid\'">\n                                ',{type:"translate",nodelist:["Your username must only contain letters, numbers, dashes, or underscores."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'undies\'">\n                                ',{type:"translate",nodelist:["Your username must contain at least one letter, number, or dash."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'isEmail\'">\n                                ',{type:"translate",nodelist:["Your username cannot be an email address."]},'\n                            </span>\n\n                            <span data-bind="visible: suggestedUsername">',{type:"translate",nodelist:["How about ",{type:"translateVariable",var_name:"suggested_username",nodelist:['<strong><a href="#" data-bind="text: suggestedUsername, click: function () { useSuggestedUsername(); }"></a></strong>']},"?"]},'</span>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="item">\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"signup_params.save_card ",attachment:["\n                    <div class=\"save-card\">\n                        <div class='save-card-inner jquery-placeholder-wrapper'>\n                            ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n                            <div class="fancy-checkbox" data-bind="css: { \'checked\': saveCard }">\n                                <input type="checkbox" value="None" id="save-card-input" data-bind="\n                                    checked: saveCard,\n                                    enable: !chooserVisible()\n                                " disabled>\n                                <label for="save-card-input"></label>\n                            </div>\n                            ']},{type:"else_ncondition",attachment:['\n                            <input id="save-card-input" type="checkbox" class="save-card-input" data-bind="\n                                checked: saveCard,\n                                enable: !chooserVisible()\n                            " disabled>\n                            ']}]},'\n                            <label for="save-card-input" class="save-card-label">\n                                <span class=\'terms-text\'>\n                                    ',{type:"translate",nodelist:["Remember my card for faster checkout."]},"\n                                </span>\n                            </label>\n                        </div>\n                    </div>\n                    "]}]},"\n\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:"show_notify_me ",attachment:['\n                    <div class="notify-me-container">\n                        <div class="first">\n                            <label for="notify-me-band" class="notify-me">\n                                <input id="notify-me-band" name="notify-me-band" type="checkbox" data-bind="checked: notifyMeBand" class="notify-me-checkbox">\n                                <div class="notify-me-message">',{type:"translate",nodelist:["Add me to the mailing list for ",{type:"translateVariable",var_name:"seller",nodelist:[{type:"variable",name:"artist",filters:[["h",[]]]}]},"."]},"</div>\n                            </label>\n                        </div>\n                        ",{type:"ef",blocks:[{type:"ncondition",expression:"label ",attachment:['\n                        <div>\n                            <label for="notify-me-label" class="notify-me">\n                                <input id="notify-me-label" name="notify-me-label" type="checkbox" data-bind="checked: notifyMeLabel" class="notify-me-checkbox">\n                                <div class="notify-me-message">',{type:"translate",nodelist:["Add me to the mailing list for ",{type:"translateVariable",var_name:"seller",nodelist:[{type:"variable",name:"label",filters:[["h",[]]]}]},"."]},"</div>\n                            </label>\n                        </div>\n                        "]}]},"\n                    </div>\n                    "]}]},"\n\n                    <div class=\"tos\">\n                        <div class='tos-inner jquery-placeholder-wrapper'>\n                            ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n                            <div class="fancy-checkbox" data-bind="css: { \'checked\': tos }">\n                                <input type="checkbox" value="None" id="tos-input" data-bind="\n                                    checked: tos,\n                                    css: {\n                                        \'has-validation-error\': tos.error_msg()\n                                    },\n                                    enable: !chooserVisible()\n                                " disabled>\n                                <label for="tos-input"></label>\n                            </div>\n                            ']},{type:"else_ncondition",attachment:['\n                            <input id="tos-input" type="checkbox" class="tos-input" data-bind="\n                                checked: tos,\n                                css: {\n                                    \'has-validation-error\': tos.error_msg()\n                                },\n                                enable: !chooserVisible()\n                            " disabled>\n                            ']}]},'\n                            <label for="tos-input" class="tos-label">\n                                <span class=\'terms-text\'>\n                                    ',{type:"translate",nodelist:["I have read and agree to the <a ",{type:"translateVariable",var_name:"link",nodelist:["href='/terms_of_use' target='_blank'"]},">Terms of Use</a>."]},'\n                                </span>\n                            </label>\n                        </div>\n                        <div class="error-bubble" style="display: none;" data-bind="visible: tos.error_msg"><span class="message" data-bind="text: tos.error_msg"></span></div>\n                    </div>\n                </div>\n            </div>\n\n            <div class="item" data-bind="animateVisible: chooserVisible, animationType: \'slide\'" style="display: none;">\n                <div class="chooser">\n                    <div class="chooser-message">',{type:"translate",nodelist:["Please choose an artist account to associate this fan account with:"]},'</div>\n                    <select data-bind="options: possibleUsers,\n                        optionsText: function(user) {\n                            return formatUser(user);\n                        },\n                        value: selectedUser\n                    "></select>\n                </div>\n            </div>\n\n            <div class="buttons" data-bind="css: { \'no-bottom-link\': !bottomLinkVisible() }">\n                <button class="submit" type=\'submit\' data-bind=\'enable: submitEnabled\'>\n                    <span data-bind="text: submitText">\n                        ',{type:"ef",blocks:[{type:"ncondition",expression:"pagedata && pagedata.identities && pagedata.identities.user ",attachment:["\n                            ",{type:"translate",nodelist:["Complete setup"]},"\n                        "]},{type:"else_ncondition",attachment:["\n                            ",{type:"translate",nodelist:["Sign up"]},"\n                        "]}]},'\n                    </span>\n                </button>\n            </div>\n\n            <div class="item" data-bind="visible: bottomLinkVisible" ',{type:"ef",blocks:[{type:"ncondition",expression:"pagedata && pagedata.identities && pagedata.identities.user ",attachment:['style="display: none;"']}]},'>\n                <div class="login-link hint">\n                    ',{type:"translate",nodelist:["Already have an account? <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: function() { openLogin(); }"']},">Log in</a>."]},"\n                </div>\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:['\n                <div class="artist-signup hint" data-bind="visible: artistSignupVisible" ',{type:"ef",blocks:[{type:"ncondition",expression:"pagedata && pagedata.identities && pagedata.identities.user ",attachment:['style="display: none;"']}]},">\n                    ",{type:"translate",nodelist:["Are you an artist? <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/signup"']},">Sign up for an artist account</a>."]},"\n                </div>\n                "]}]},"\n            </div>\n        </div>\n        </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_login_pane.liquid","warn"):Templ.register({"fan/signup/fan_login_pane":['<form id="signup-vm" class=\'login-form modern-form signup-common-form ',{type:"ef",blocks:[{type:"ncondition",expression:"show ",attachment:["visible"]}]},'\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <a id="signup-anchor"></a>\n\n    <div class="signup-common-inner">\n        <div class="before-chooser" data-bind="css: { \'disabled\': userChooserVisible }">\n            <div class="item">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone && !portable ",attachment:['<label for="email-input" class="email-label">',{type:"translate",nodelist:["Username / email"]},"</label>"]}]},'\n                <div class="email">\n                    <div class="email-inner jquery-placeholder-wrapper">\n                        <input id="email-input" type="email" class="email-input" data-bind="\n                            value: email,\n                            errorBubble: email.error_msg,\n                            valueUpdate: \'input\',\n                            hasfocus: email.focused,\n                            css: {\n                                \'has-validation-error\': email.error_msg()\n                            }\n                        " ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone || portable ",attachment:['placeholder="',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:[{type:"translate",nodelist:["username / email"]}]},{type:"else_ncondition",attachment:[{type:"translate",nodelist:["Username / email"]}]}]},'"']}]},'>\n                    </div>\n                    <div class="error-bubble" style="display: none;"><span class="message"></span></div>\n                </div>\n            </div>\n\n            <div class="item pass">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone && !portable ",attachment:['<label for="password-input" class="password-label">',{type:"translate",nodelist:["Password"]},"</label>"]}]},'\n                <div class="password">\n                    <div class="password-inner jquery-placeholder-wrapper">\n                        <input id="password-input" type="password" class="password-input" data-bind="\n                            value: password,\n                            errorBubble: password.error_msg,\n                            valueUpdate: \'input\',\n                            hasfocus: password.focused,\n                            css: {\n                                \'has-validation-error\': password.error_msg()\n                            }\n                        " ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone || portable ",attachment:['placeholder="',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:[{type:"translate",nodelist:["password"]}]},{type:"else_ncondition",attachment:[{type:"translate",nodelist:["Password"]}]}]},'"']}]},'>\n                    </div>\n                    <div class="error-bubble" style="display: none;"><span class="message"></span></div>\n                </div>\n            </div>\n\n            <div class="two-factor" data-bind="animateVisible: twofactorVisible, animationType: \'slide\'" style="display: none;">\n                <div class="two-factor-heading-item">',{type:"translate",nodelist:["Please enter your two-factor authentication code below:"]},'</div>\n\n                <div class="item">\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone && !portable ",attachment:['<label for="two-factor-code-input" class="two-factor-code-label">',{type:"translate",nodelist:["Code"]},"</label>"]}]},'\n                    <div class="two-factor-code">\n                        <div class="two-factor-code-inner jquery-placeholder-wrapper">\n                            <input id="two-factor-code-input" type="text" class="two-factor-code-input" data-bind="\n                                value: twofactor,\n                                errorBubble: twofactor.error_msg,\n                                valueUpdate: \'input\',\n                                hasfocus: twofactor.focused,\n                                css: {\n                                    \'has-validation-error\': twofactor.error_msg()\n                                }\n                            " ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['placeholder="',{type:"translate",nodelist:["code"]},'"']}]},'>\n                        </div>\n                        <div class="error-bubble"><span class="message"></span></div>\n                    </div>\n                </div>\n\n                <div class="item two-factor-remember-wrapper">\n                    <div class="item-inner two-factor-remember">\n                        ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n                        <div class="fancy-checkbox">\n                            <input id="two-factor-remember-input" type="checkbox" class="two-factor-remember-input" data-bind="\n                                checked: twofactorRemember,\n                                valueUpdate: \'input\'\n                            ">\n                            <label for="two-factor-remember-input"></label>\n                        </div>\n                        ']},{type:"else_ncondition",attachment:['\n                        <input id="two-factor-remember-input" type="checkbox" class="two-factor-remember-input" data-bind="\n                            checked: twofactorRemember,\n                            valueUpdate: \'input\'\n                        ">\n                        ']}]},'\n                        <label for="two-factor-remember-input" class="two-factor-remember-label">',{type:"translate",nodelist:["Remember this computer for 30 days"]},'</label>\n                        <div class="error-bubble"><span class="message"></span></div>\n                    </div>\n                </div>\n\n                <div class="no-phone" data-bind="visible: !twofactorHelpVisible()">\n                    <a data-bind="click: showTwoFactorHelp">',{type:"translate",nodelist:["Help! I can’t access my phone!"]},'</a>\n                </div>\n            </div>\n\n            <div class="item two-factor-help" data-bind="animateVisible: twofactorHelpVisible, animationType: \'slide\'" style="display: none;">\n                <h3>',{type:"translate",nodelist:["I don’t have my phone on me right now"]},'</h3>\n                <div class="help-text">\n                    ',{type:"translate",nodelist:["If you don’t currently have access to your phone, you’ll need to log in using one of your backup codes. Enter one of your backup codes in the box above and log in as usual."]},'\n                </div>\n                <div class="help-text">\n                    ',{type:"translate",nodelist:["Each backup code can only be used once, so once you’ve logged in, you should open your two-factor authentication settings (within your user settings) and generate a fresh set of backup codes if you’re running short."]},"\n                </div>\n                \n                <h3>",{type:"translate",nodelist:["I’ve lost or replaced my phone"]},'</h3>\n                <div class="help-text">\n                    ',{type:"translate",nodelist:['Once you’ve logged in using a backup code as above, open your two-factor authentication settings and click the "Add another authentication method" link to add your new device.']},'\n                </div>\n            </div>\n        </div>\n\n        <div class="item" data-bind="animateVisible: userChooserVisible, animationType: \'slide\'" style="display: none;">\n            <div class="chooser">\n                <div class="chooser-message">',{type:"translate",nodelist:["Please choose an account:"]},'</div>\n                <select data-bind="options: possibleUsers,\n                    optionsText: function(user) {\n                        return formatUser(user);\n                    },\n                    value: selectedUser\n                "></select>\n            </div>\n        </div>\n\n        <div class="buttons">\n            <button class="submit" type="submit" data-bind="enable: submitEnabled">\n                <div data-bind="visible: !submitting()">',{type:"translate",nodelist:["Log in"]},'</div>\n                <div data-bind="visible: submitting()" style="display: none;">',{type:"translate",nodelist:["Please wait"]},'&hellip;</div>\n            </button>\n        </div>\n\n        <div class="forgot-password-wrapper">\n            <div class="forgot-password">\n                \x3c!-- <a href="#" data-bind="click: function() { forgotPassword(); }">Forgot your password?</a> --\x3e\n                <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/forgot_password">',{type:"translate",nodelist:["Forgot your password?"]},'</a>\n            </div>\n\n            <div class="change-email">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:["\n                    ",{type:"translate",nodelist:["Sign up as <a ",{type:"translateVariable",var_name:"fan_link",nodelist:['href="#" data-bind="click: function() { backToSignup(); }"']},">a fan</a>, <a ",{type:"translateVariable",var_name:"artist_link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/signup"']},">an artist</a> or <a ",{type:"translateVariable",var_name:"label_link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/labels"']},">a label</a>."]},"\n                "]},{type:"ncondition",expression:"fan_signup_only ",attachment:["\n                    ",{type:"translate",nodelist:["Don’t have an account? <a ",{type:"translateVariable",var_name:"fan_link",nodelist:['href="#" data-bind="click: function() { backToSignup(); }"']},">Sign up as a fan</a>."]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["Don’t have an account? Sign up as <a ",{type:"translateVariable",var_name:"fan_link",nodelist:['href="#" data-bind="click: function() { backToSignup(); }"']},">a fan</a>, <a ",{type:"translateVariable",var_name:"artist_link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/signup"']},">an artist</a> or <a ",{type:"translateVariable",var_name:"label_link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/labels"']},">a label</a>."]},"\n                "]}]},"\n            </div>\n        </div>\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_forgot_password_pane.liquid","warn"):Templ.register({"fan/signup/fan_forgot_password_pane":['<form id="signup-vm" class=\'forgot-password-form modern-form signup-common-form\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <a id="signup-anchor"></a>\n\n    <div class="signup-common-inner">\n        <div data-bind="visible: !sent()">\n\n            <div class="item heading-item">\n                ',{type:"translate",nodelist:["Enter your email address below to reset your password:"]},'\n            </div>\n\n            <div class="item">\n                <div class="email">\n                    <div class="email-inner jquery-placeholder-wrapper">\n                        <input id="email-input" class="email-input" type="email" data-bind="\n                            value: email,\n                            valueUpdate: \'input\',\n                            errorBubble: email.error_msg\n                        " placeholder="',{type:"translate",nodelist:["Email address"]},'">\n                    </div>\n                    <div class="error-bubble"><span class="message"></span></div>\n                </div>\n            </div>\n\n            <div class="buttons">\n                <button class="submit" type="submit" data-bind="click: submit, disable: submitDisabled" disabled>\n                    ',{type:"translate",nodelist:["Send"]},'\n                </button>\n            </div>\n\n            <div class="change-email">\n                <a href="#" data-bind="click: function() { backToSignup(); }">',{type:"translate",nodelist:["Back to signup."]},'</a>\n            </div>\n        </div>\n\n        <div data-bind="visible: sent">\n            <div class="done">\n                ',{type:"translate",nodelist:["Thanks! We’ve sent a password reset email to ",{type:"translateVariable",var_name:"email_addr",nodelist:['<span data-bind="text: email"></span>']},"."]},"\n            </div>\n        </div>\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_reset_password_pane.liquid","warn"):Templ.register({"fan/signup/fan_reset_password_pane":['<form id="signup-vm" class=\'signup-form modern-form\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <a id="signup-anchor"></a>\n\n    <div class="signup-common-inner">\n        \x3c!-- ko if: unrecoverableError() --\x3e\n            <div class="item">\n                ',{type:"translate",nodelist:["Something is wrong and we can’t reset your password. Here are some ideas for what\n                might be happening:"]},"\n                <ul>\n                    <li>\n                        ",{type:"translate",nodelist:["More than twenty-four hours has passed since you requested a password reset.\n                        For security, we limit the amount of time a password reset email can\n                        be used."]},"  \n                    </li>\n                    <li>\n                        ",{type:"translate",nodelist:["You clicked on a link in the reset password email, but the entire URL\n                        didn’t make it through. Try copying the URL out of your email client\n                        and pasting it in the browser’s location field."]},"\n                    </li>\n                    <li>\n                        ",{type:"translate",nodelist:["You’ve already reset your password using this URL, or the URL from another email."]},'\n                    </li>\n                </ul>\n            </div>\n        \x3c!-- /ko --\x3e\n\n        \x3c!-- ko if: !unrecoverableError() && !reset() --\x3e\n            <div class="item heading-item">\n                ',{type:"translate",nodelist:["Please enter a new password below."]},'\n            </div>\n\n            <div class="divider"></div>\n\n            <div class="item">\n                <label for="password-input" class="password-label">\n                    ',{type:"translate",nodelist:["Password:"]},'\n                </label>\n                <div class="password">\n                    <div class="password-inner jquery-placeholder-wrapper">\n                        <input id="password-input" class="password-input" type="password" data-bind="\n                            value: password,\n                            valueUpdate: \'input\',\n                            errorBubble: password.error_msg\n                            ">\n                    </div>\n                    <div class="error-bubble"><span class="message"></span></div>\n                </div>\n            </div>\n\n            <div class="buttons">\n                <button class="submit" type="submit" data-bind="click: submit, disable: submitDisabled">',{type:"translate",nodelist:["Reset"]},"</button>\n            </div>\n        \x3c!-- /ko --\x3e\n\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_tos_accept.liquid","warn"):Templ.register({"fan/signup/fan_tos_accept":['<div id="tos-accept-dialog" class=\'tos-accept-dialog tos-accept-form modern-form\'>\n    <form class="tos-accept-inner">\n        <iframe class="tos-accept-embed" src="/terms_of_use?from=embed"></iframe>\n        \n        <div class="tos-accept-controls">\n            <label class="tos-accept-label"><input id="tos-accept-agree" class="tos-accept-agree" type="checkbox" data-bind="checked: hasAgreed">\n                I have read and agree to Bandcamp’s Terms of Use\n            </label>\n\n            <button id="tos-accept-accept" class="submit" type="submit" data-bind="click: submit, disable: submitDisabled" disabled>\n                Accept\n            </button>\n        </div>\n    </form>\n</div>\n']}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_existing_artist_pane.liquid","warn"):Templ.register({"fan/signup/fan_existing_artist_pane":['<form id="signup-vm" class=\'existing-artist-form modern-form signup-common-form ',{type:"ef",blocks:[{type:"ncondition",expression:"show ",attachment:["visible"]}]},'\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <a id="signup-anchor"></a>\n    <div class="signup-common-inner">\n        <div class="dialog-body">\n            <p class="greetings">',{type:"translate",nodelist:["Greetings!"]},"</p>\n            <p>\n            ",{type:"case",blocks:[{type:"condition",left:"action",right:"'live_ticket'",operator:"==",attachment:["\n                ",{type:"translate",nodelist:["You have a Bandcamp artist account. To attend this live event, you’ll need a Bandcamp fan account."]},"\n            "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'follow'",operator:"==",attachment:["\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:'!action_item_type || action_item_type == \'b\' || action_item_type == "album" || action_item_type == "track" ',attachment:["\n                        ",{type:"translate",nodelist:["You have a Bandcamp artist account. To follow this artist, you’ll need a Bandcamp fan account."]},"\n                    "]},{type:"ncondition",expression:"action_item_type == 'f' ",attachment:["\n                        ",{type:"translate",nodelist:["You have a Bandcamp artist account. To follow this fan, you’ll need a Bandcamp fan account."]},"\n                    "]}]},"\n            "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'wishlist'",operator:"==",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"!action_item_type || action_item_type == 'a' || action_item_type == 'album' ",attachment:["\n                    ",{type:"translate",nodelist:["You have a Bandcamp artist account. To complete wishlisting this album, you’ll need a Bandcamp fan account."]},"</p>\n                "]},{type:"ncondition",expression:"action_item_type == 't' || action_item_type == 'track' ",attachment:["\n                    ",{type:"translate",nodelist:["You have a Bandcamp artist account. To complete wishlisting this track, you’ll need a Bandcamp fan account."]},"\n                "]}]},"\n            "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'redeem'",operator:"==",attachment:["\n                ",{type:"translate",nodelist:["You have a Bandcamp artist account. To redeem this gift card, you’ll need a Bandcamp fan account."]},"\n            "],child_relation:null,child_condition:null}]},"\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"!action ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone && unsupported_device ",attachment:["\n                    ",{type:"translate",nodelist:["Fan accounts let you follow other artists and fans, and <a ",{type:"translateVariable",var_name:"fanslink",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/fans"']},">lots more</a>."]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["Fan accounts let you follow other artists and fans, give you instant streaming of your purchases via the free Bandcamp app, and <a ",{type:"translateVariable",var_name:"fanslink",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/fans"']},">lots more</a>."]},"\n                "]}]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone && unsupported_device ",attachment:["\n                    ",{type:"translate",nodelist:["Fan accounts also let you follow other artists and fans, and <a ",{type:"translateVariable",var_name:"fanslink",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/fans"']},">lots more</a>."]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["Fan accounts also let you follow other artists and fans, give you instant streaming of your purchases via the free Bandcamp app, and <a ",{type:"translateVariable",var_name:"fanslink",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/fans"']},">lots more</a>."]},"\n                "]}]},"\n            "]}]},"\n            </p>\n\n            <p>",{type:"translate",nodelist:["Would you like your artist and fan account to be one and the same, or would you prefer to keep your fan account separate from your artist account?"]},"</p>\n        </div>\n\n        ",{type:"capture",to:"band_list",nodelist:[{type:"for",collection_name:"bands",nodelist:[{type:"variable",name:"band.band_name",filters:[["h",[]]]},{type:"ef",blocks:[{type:"ncondition",expression:"!forloop.last ",attachment:[", "]}]}],variable_name:"band",reversed:null,attribs:{}}]},'\n\n        <div class="buttons">\n            <button class="create-account" type="submit">\n                ',{type:"translate",nodelist:["Create my fan account as part of the <br>",{type:"variable",name:"user_name",filters:[["h",[]]]}," (",{type:"variable",name:"band_list",filters:[]},") artist account"]},"\n            </button>\n\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n            <button class="log-me-out" data-bind="click: logout">\n                ',{type:"translate",nodelist:["Log out of ",{type:"variable",name:"user_name",filters:[["h",[]]]}," and log in to an existing fan account, or create a new one"]},"\n            </button>\n            "]}]},"\n        </div>\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:['\n        <div class="or">',{type:"translate",nodelist:["or"]},'</div>\n\n        <div class="change-email">\n            <a href="#" data-bind="click: logout">',{type:"translate",nodelist:["Log out of ",{type:"variable",name:"user_name",filters:[["h",[]]]}," and log in to an existing fan account, or create a new one"]},"</a>\n        </div>\n        "]}]},"\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_almost_there_pane.liquid","warn"):Templ.register({"fan/signup/fan_almost_there_pane":['<form id="signup-vm" class=\'existing-artist-form modern-form signup-common-form\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <a id="signup-anchor"></a>\n\n    <div class="signup-common-inner">\n        <div class="dialog-body">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"!portable && is_phone ",attachment:['\n                <div class="almost-there">',{type:"translate",nodelist:["You’re almost there!"]},"</div>\n            "]}]},'\n            <div class="almost-there-confirm">',{type:"translate",nodelist:["Please check ",{type:"translateVariable",var_name:"new_fan_email",nodelist:["<i>",{type:"variable",name:"email",filters:[["h",[]]]},"</i>"]},"<br> to activate your account."]},'</div>\n            <button class="almost-there-button">',{type:"translate",nodelist:["Got it"]},"</button>\n        </div>\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_welcome_pane.liquid","warn"):Templ.register({"fan/signup/fan_welcome_pane":[{type:"ef",blocks:[{type:"ncondition",expression:"is_phone && !portable ",attachment:["\n",{type:"include",template_name:"'svg_shared'"},'\n<form id="signup-vm" class=\'modern-form signup-common-form welcome-form',{type:"ef",blocks:[{type:"ncondition",expression:"signup_params.pane == 'welcome' ",attachment:[" visible"]}]},'\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <img class="welcome-banner" src="/img/bandcamp-mobile-banner-first-time2x.jpg">\n\n    <div class="signup-common-inner">\n        <div class="dialog-body">\n            <div class="welcome-fan">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"is_activation_view || signup_params.pane == 'welcome' ",attachment:["\n                    ",{type:"translate",nodelist:["Thanks. Your account is active!"]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:"is_band_member ",attachment:["\n                        ",{type:"translate",nodelist:["Welcome to your new, improved artist and fan account."]},"\n                    "]},{type:"else_ncondition",attachment:["\n                        ",{type:"translate",nodelist:["Welcome ",{type:"translateVariable",var_name:"fan_name",nodelist:[{type:"variable",name:"username",filters:[["h",[]]]}]},"!"]},"\n                    "]}]},"\n                "]}]},"\n            </div>\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"unsupported_device ",attachment:['\n                <button class="welcome-collection-button">',{type:"translate",nodelist:["View your public collection"]},"</button>\n            "]},{type:"else_ncondition",attachment:['\n                <div class="welcome-message">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"action ",attachment:["\n                    ",{type:"translate",nodelist:["Get the free Bandcamp app, sign in and listen to your music now!"]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["Be sure to grab the free Bandcamp app:"]},"\n                "]}]},'\n                </div>\n                <div class="button-container">\n                    <a class="download-button blue-button" href=\'',{type:"variable",name:"platform_app_url",filters:[["a",[]]]},'\'>\n                        <div class="button-inner">\n                            <svg class="icon app-phone-logo" width="87px" height="76px" viewBox="0 0 43 37"><use xlink:href="#grab-app-opensignup"></svg>\n                            <div class="missing-app">',{type:"translate",nodelist:["Get the Bandcamp app!"]},"</div>\n                        </div>\n                    </a>\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:"!action ",attachment:['\n                    <a class="listen-button no-action" href=\'',{type:"variable",name:"mobile_app_url",filters:[["a",[]]]},'\'>\n                        <div class="button-inner">\n                            <div class="app-play-text">',{type:"translate",nodelist:["I have the app! Launch now."]},"</div>\n                        </div>\n                    </a>\n                    "]},{type:"else_ncondition",attachment:['\n                    <a class="listen-button" href=\'',{type:"variable",name:"mobile_app_url",filters:[["a",[]]]},'\'>\n                        <div class="button-inner">\n                            <svg class="icon app-play-logo" width="44px" height="60px" viewBox="0 0 44 60"><use xlink:href="#play-app"></svg>\n                            <div class="app-play-text">',{type:"translate",nodelist:["I have the app! Listen now."]},"</div>\n                        </div>\n                    </a>\n                    "]}]},"\n                </div>\n            "]}]},"\n        </div>\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"!action ",attachment:['\n        <div class="no-action-links">\n            ',{type:"translate",nodelist:["\n            Alternatively, <a ",{type:"translateVariable",var_name:"profile_href",nodelist:['href="/',{type:"variable",name:"username",filters:[["h",[]]]},'"']},">view your profile</a><br>\n            or<br>\n            go to the <a ",{type:"translateVariable",var_name:"bandcamp_href",nodelist:['href="/"']},">Bandcamp homepage</a>.\n            "]},"\n        </div>\n        "]}]},"\n    </div>\n</form>\n"]},{type:"ncondition",expression:"portable && is_phone ",attachment:['\n<form id="signup-vm" class=\'modern-form signup-common-form welcome-form\' data-bind=\'css: { "visible": visible }\' novalidate>\n    <div class="modal-welcome-message">\n        <div>\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"is_band_member ",attachment:["\n                ",{type:"translate",nodelist:["Welcome to your new, improved artist<br> and fan account!"]},"\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"!unsupported_device ",attachment:["\n                    ",{type:"translate",nodelist:["Be sure to get the free Bandcamp app:"]},"\n                "]}]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["Welcome to your new fan account!"]},"<br>\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"!unsupported_device ",attachment:["\n                    ",{type:"translate",nodelist:["Grab the free Bandcamp app:"]},"\n                "]}]},"\n            "]}]},'\n        </div>\n    </div>\n    <div class="buttons">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"!unsupported_device ",attachment:['\n        <button class="login get-app" type="submit" data-bind="click: getApp">\n            ',{type:"translate",nodelist:["Get app"]},"\n        </button>\n        "]}]},'\n        <button class="ok-button ',{type:"ef",blocks:[{type:"ncondition",expression:"unsupported_device ",attachment:["unsupported"]}]},'" data-bind="click: submit">\n            ',{type:"translate",nodelist:["Close"]},"\n        </button>\n    </div>\n</form>\n"]},{type:"ncondition",expression:"portable ",attachment:['\n<form id="signup-vm" class=\'modern-form signup-common-form welcome-form\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <div class="modal-welcome-message">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"is_band_member ",attachment:["\n            ",{type:"translate",nodelist:["\n            Welcome to your new, improved artist and fan account!\n            "]},"\n\n            <br>\n            ",{type:"ef",blocks:[{type:"ncondition",expression:'action == "follow" ',attachment:["\n                ",{type:"translate",nodelist:["\n                Click the feed link in the menu bar to view the latest releases from the artists you follow, and more.\n                "]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["\n                To view your wishlist, click the wishlist link in the menu bar.\n                "]},"\n            "]}]},"\n\n            <br>\n\n            ",{type:"translate",nodelist:["\n            Also, be sure to grab the free Bandcamp app for <a ",{type:"translateVariable",var_name:"ios_link",nodelist:['href="',{type:"variable",name:"app_store_url",filters:[["a",[]]]},'" target="_blank" ']},">iOS</a> or <a ",{type:"translateVariable",var_name:"android_link",nodelist:['href="',{type:"variable",name:"play_store_url",filters:[["a",[]]]},'"']},">Android</a>.\n            "]},"\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"translate",nodelist:["\n            Welcome to your new fan account!\n            "]},"\n\n            <br>\n            ",{type:"translate",nodelist:["\n            Be sure to grab the free Bandcamp app for <a ",{type:"translateVariable",var_name:"ios_link",nodelist:['href="',{type:"variable",name:"app_store_url",filters:[["a",[]]]},'" target="_blank" ']},">iOS</a> or <a ",{type:"translateVariable",var_name:"android_link",nodelist:['href="',{type:"variable",name:"play_store_url",filters:[["a",[]]]},'"']},">Android</a>.\n            "]},"\n            <br>\n        "]}]},'\n    </div>\n    <button class="almost-there-button">',{type:"translate",nodelist:["OK"]},"</button>\n</form>\n"]},{type:"else_ncondition",attachment:['\n<form id="signup-vm" class=\'welcome-form modern-form signup-common-form visible\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <div class="signup-common-inner">\n        <div class="welcome-inner">\n            <div class="welcome-phone">\n                <img src="img/phone-app-collection-welcome-1%402x.gif"></img>\n            </div>\n            <div class="welcome-app-promo">\n                <div>\n                    ',{type:"translate",nodelist:["\n                    We suggest you grab the free Bandcamp app from the App Store or Google Play Store.\n                    "]},'\n                </div>\n                <div class="welcome-app-button-container">\n                    <a href="',{type:"variable",name:"app_store_url",filters:[["a",[]]]},'" target="_blank"><div class="store-button app-store"></div></a>\n                    <a href="',{type:"variable",name:"play_store_url",filters:[["a",[]]]},'" target="_blank"><div class="store-button google-play-store"></div></a>\n                </div>\n                <div>\n                    ',{type:"translate",nodelist:["\n                    It gives you powerful ways to browse the music on Bandcamp, and unlimited streaming of your purchases. <a ",{type:"translateVariable",var_name:"email_href",nodelist:['data-bind="click: appLinkModal" href="#"']},">Email yourself a link</a> to the app (to open on your phone).\n                    "]},'\n                </div>\n                <button data-bind="enable: buttonEnabled">',{type:"translate",nodelist:["Right, what’s next?"]},"</button>\n            </div>\n        </div>\n    </div>\n</form>\n"]}]},"\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_email_link.liquid","warn"):Templ.register({"fan/signup/fan_email_link":['<div class="welcome-email-app-link" data-bind="visible: appLinkSent()">\n    ',{type:"translate",nodelist:["\n    A link to download the Bandcamp app has been sent to ",{type:"translateVariable",var_name:"address",nodelist:['<strong><span data-bind="text: appLinkEmail"></span></strong>']},".\n    "]},'\n</div>\n<div class="welcome-app-email-buttons" data-bind="visible: !appLinkSent()">\n    <button data-bind="click: closeAppLinkModal" class="no-thanks" type="button">',{type:"translate",nodelist:["No Thanks"]},'</button>\n    <button data-bind="click: sendAppLinkEmail" class="send" type="button">',{type:"translate",nodelist:["Send"]},'</button>\n</div>\n<div class="welcome-app-email-buttons okay" data-bind="visible: appLinkSent()">\n    <button data-bind="click: closeAppLinkModal" class="okay" type="button" display="display: none">',{type:"translate",nodelist:["OK"]},"</button>\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_verify_nag_pane.liquid","warn"):Templ.register({"fan/signup/fan_verify_nag_pane":['<form id="nag-vm" class=\'modern-form signup-common-form action-form verify-nag visible\' data-bind=\'submit: submit\' novalidate>\n    <div data-bind="visible: !submitted()">\n        <div data-bind="visible: !changingEmail()">\n            <div class="nag-verify-text">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"email ",attachment:["\n                    ",{type:"translate",nodelist:["\n                    Please check ",{type:"translateVariable",var_name:"email",nodelist:['<div class="nag-fan-email" data-bind="text: fanEmail"></div><br>']}," to activate your account.\n                    "]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["\n                    Please check your email to activate your account.\n                    "]},"\n                "]}]},"\n            </div>\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"email ",attachment:['\n            <a class="nag-email-change" data-bind="click: changeEmail">',{type:"translate",nodelist:["change email / send again"]},"</a>\n            "]}]},'\n            <div class="nag-buttons',{type:"ef",blocks:[{type:"ncondition",expression:"!email ",attachment:[" no-email"]}]},'">\n                <button class="nag-got-it">',{type:"translate",nodelist:["Got it"]},'</button>\n            </div>\n        </div>\n        <div data-bind="visible: changingEmail()">\n             <div class="nag-verify-text">\n                ',{type:"translate",nodelist:["\n                Please enter your email address:\n                "]},'\n            </div>\n            <div class="nag-email-input">\n                <input type="text" data-bind="css: {\'error\': emailError}, value: fanEmail"></input>\n                <div class="error-bubble" style="display: none" data-bind="visible: alreadyAFanError">',{type:"translate",nodelist:["A fan with that email address already exists."]},'</div>\n                <div class="error-bubble" style="display: none" data-bind="visible: fanAlreadyLinkedEmailError">',{type:"translate",nodelist:["That address is attached to an existing fan account, but is not the primary address used for login."]},'</div>\n                <div class="error-bubble" style="display: none" data-bind="visible: invalidEmailError">',{type:"translate",nodelist:["That email address doesn’t look right."]},'</div>\n            </div>\n            <div class="nag-buttons">\n                <button class="nag-send-again">',{type:"translate",nodelist:["Send again"]},'</button>\n                <button class="nag-cancel login" data-bind="click: cancel">',{type:"translate",nodelist:["Cancel"]},'</button>\n            </div>\n        </div>\n    </div>\n    <div data-bind="visible: submitted()" style="display: none">\n        <div class="nag-email-sent">\n            ',{type:"translate",nodelist:["\n            Email sent!\n            "]},'\n        </div>\n        <button class="nag-done">',{type:"translate",nodelist:["Done"]},"</button>\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_dupe_fan_pane.liquid","warn"):Templ.register({"fan/signup/fan_dupe_fan_pane":['<form id="signup-vm" class=\'dupe-fan-form modern-form signup-common-form ',{type:"ef",blocks:[{type:"ncondition",expression:"show ",attachment:["visible"]}]},'\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <a id="signup-anchor"></a>\n    <div class="signup-common-inner">\n        <div class="dialog-body">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"fan ",attachment:["\n            <p>",{type:"translate",nodelist:["Hello! Your email address <strong>",{type:"variable",name:"email",filters:[["h",[]]]},"</strong><br> is already linked to a fan account."]},"</p>\n\n            <p>",{type:"translate",nodelist:["Please either <a ",{type:"translateVariable",var_name:"logout_link",nodelist:[' href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/logout?login=1"']},">log out and log in as the fan linked to this address</a> or <a ",{type:"translateVariable",var_name:"change_link",nodelist:[' href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/settings"']},">change your address</a> to create a new fan account."]},"</p>\n        "]},{type:"ncondition",expression:"fan_already_linked_email ",attachment:["\n            <p>",{type:"translate",nodelist:["Hello! Your email address <strong>",{type:"variable",name:"email",filters:[["h",[]]]},"</strong> is attached to an existing fan account, but is not the primary address used for login."]},"</p>\n\n            <p>",{type:"translate",nodelist:["Please either <a ",{type:"translateVariable",var_name:"logout_link",nodelist:[' href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/logout?login=1"']},">log out and log in as the fan linked to this address</a> or <a ",{type:"translateVariable",var_name:"change_link",nodelist:[' href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/settings"']},">change your address</a> to create a new fan account."]},"</p>\n        "]}]},"\n        </div>\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_choose_account_pane.liquid","warn"):Templ.register({"fan/signup/fan_choose_account_pane":['<form id="signup-vm" class=\'choose-account-form modern-form signup-common-form ',{type:"ef",blocks:[{type:"ncondition",expression:"signup_params.standalone ",attachment:["standalone"]}]},'\' data-bind=\'css: { "visible": visible }\' novalidate>\n    <ul class="accounts-list">\n        <li class="fan account">\n            <div class="icon"></div>\n            <div class="description">\n                <a class="signup-button open-fan-signup" \n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"signup_params.standalone ",attachment:['\n                        href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/fan_signup?from=",{type:"variable",name:"fans_from",filters:[["h",[]]]},'">\n                    ']},{type:"else_ncondition",attachment:['\n                        href="#" data-bind="click: openFanSignup">\n                    ']}]},"\n                    ",{type:"translate",nodelist:["Sign up as a fan"]},'\n                </a>\n                <div class="text">\n                    ',{type:"translate",nodelist:["Follow your favorite artists, keep a wishlist, get instant streaming of your purchases, showcase your collection, and explore the music of like-minded fans. <a ",{type:"translateVariable",var_name:"link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/fans?from=",{type:"variable",name:"fans_from",filters:[["h",[]]]},'"']},">learn more</a>"]},'\n                </div>\n            </div>\n        </li>\n        <li class="artist account">\n            <div class="icon"></div>\n            <div class="description">\n                <a class="signup-button" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/artists?from=",{type:"variable",name:"artists_from",filters:[["h",[]]]},'">',{type:"translate",nodelist:["Sign up as an artist"]},'</a>\n                <div class="text">\n                    ',{type:"translate",nodelist:["Sell directly to your fans with total control over your music and pricing. Easy access to your customers’ data, real-time stats, music chart reporting, and more. <a ",{type:"translateVariable",var_name:"link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/artists?from=",{type:"variable",name:"artists_from",filters:[["h",[]]]},'"']},">learn more</a>"]},'\n                </div>\n            </div>\n        </li>\n        <li class="label account">\n            <div class="icon"></div>\n            <div class="description">\n                <a class="signup-button" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/labels?from=",{type:"variable",name:"labels_from",filters:[["h",[]]]},'">',{type:"translate",nodelist:["Sign up as a label"]},'</a>\n                <div class="text">\n                    ',{type:"translate",nodelist:["Unified accounting and stats across all your artists, a single fulfillment interface for all your merch, direct payments on a per-release basis, and a whole lot more. <a ",{type:"translateVariable",var_name:"link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/labels?from=",{type:"variable",name:"labels_from",filters:[["h",[]]]},'"']},">learn more</a>"]},"\n                </div>\n            </div>\n        </li>\n    </ul>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_genre_picker_pane.liquid","warn"):Templ.register({"fan/signup/fan_genre_picker_pane":['<form id="signup-vm" class=\'genre-picker-form modern-form signup-common-form ',{type:"ef",blocks:[{type:"ncondition",expression:"skinny ",attachment:["skinny"]}]},'\' data-bind=\'css: { "visible": visible, "has-selected-genres": selectedGenres().length > 0 }, click: deselectClick\' novalidate>\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"!from_newsletter_invite_banner ",attachment:['\n    <div class="heading-wrapper" ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['data-bind="visible: showGenres"']}]},">\n        <h3>",{type:"translate",nodelist:["Welcome, ",{type:"translateVariable",var_name:"fan_name",nodelist:[{type:"variable",name:"fan_name",filters:[["h",[]]]}]},"! What are your favorite genres?"]},"</h3>\n        <h4>",{type:"translate",nodelist:["This will help us recommend music you’ll love."]},"</h4>\n    </div>\n    "]},{type:"else_ncondition",attachment:['\n    <div class="heading-wrapper" ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['data-bind="visible: showGenres"']}]},">\n        <h3>",{type:"translate",nodelist:["Hi, ",{type:"translateVariable",var_name:"fan_name",nodelist:[{type:"variable",name:"fan_name",filters:[["h",[]]]}]},"! What are your favorite genres?"]},"</h3>\n        <h4>",{type:"translate",nodelist:["This will help us recommend music you’ll love."]},"</h4>\n    </div>\n    "]}]},"\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n    <div class="heading-wrapper mobile"data-bind="visible: showSubgenres">\n        <h3>',{type:"translate",nodelist:["Want to get more specific?"]},"<br/>",{type:"translate",nodelist:["Pick any subgenres you like."]},"</h3>\n    </div>\n    "]}]},"\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:["\n        ",{type:"include",template_name:"'fan/signup/fan_genre_picker_selected_genres'"},"\n    "]}]},'\n\n    <div class="genres-overflow-wrapper hide-scrollbar" data-bind="',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:["visible: showGenres, "]}]},'style: { height: genres_overflow_wrapper_height() }" >\n        <ul class="genres clearfix" data-bind="foreach: genres">\n            <li class="genre top-level" data-bind="attr: { \'id\': cssId }, css: { ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:["'expanded': hasExpandedClass,"]}]}," 'selected': selected, 'long': isLong, 'search': isSearch }, click: expand\">\n                <div class=\"content\">\n                    \x3c!-- ko if: isSearch --\x3e\n                    <h3 class=\"search-heading\">",{type:"translate",nodelist:["Not quite finding what you’re looking for?"]},'</h3>\n                    <h4 class="search-subheading">',{type:"translate",nodelist:["Try searching instead."]},'</h3>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko if: !isSearch --\x3e\n                    <h3 class="genre-name" data-bind="click: function () { ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:[" expanded() &amp;&amp; "]}]},' toggleSelect(false); }">\n                        <span class="genre-icon"></span><span class="genre-name-text" data-bind="text: name"></span>\n                    </h3>\n                    <ul class="subgenres" data-bind="foreach: subgenres">\n                        <li class="subgenre" data-bind="css: { \'selected\': selected }, click: function () { toggleSelect(false); }">\n                            <h3 class="subgenre-name">\n                                <span class="genre-icon"></span><span data-bind="text: name"></span>\n                            </h3>\n                        </li>\n                    </ul>\n                    \x3c!-- /ko --\x3e\n                </div>\n            </li>\n        </ul>\n        <div class="search-wrapper" data-bind="css: { \'searching\': searching }, click: searchWrapperClick">\n            <h2>',{type:"translate",nodelist:["You can also search for your favorite genres:"]},"</h2>\n            <div class=\"search-input-wrapper\">\n                <input type=\"text\" data-bind=\"css: { 'selected': searchSelectIndex() === 0 }, value: searchTerm, valueUpdate: 'input', hasFocus: searchHasFocus, click: searchClick, event: { 'keydown': searchInputKeypress, 'mouseover': searchInputMouseover }\" placeholder=\"",{type:"translate",nodelist:["Search for any genre"]},'">\n                <a class="search" data-bind="click: function () { expandSearch(); }">\n                    <span class="search-icon">&nbsp;</span>\n                    <svg class="search-spinner" width="14px" height="14px" viewBox="0 0 14 14"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#search-spinner"></use></svg>\n                </a>\n            </div>\n\n            <div class="search-results" data-bind="css: { \'results-visible\': searchResults().length > 0 }, event: { \'keydown\': searchResultsKeypress }, style: { top: search_results_top()}">\n                <ul data-bind="foreach: searchResults">\n                    \x3c!-- ko if: $data.isEmpty --\x3e\n                    <li class="empty">\n                        <span>',{type:"translate",nodelist:["Nothing here... yet!"]},'</span>\n                    </li>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko if: !$data.isEmpty --\x3e\n                    <li tabindex="0" data-bind="css: { \'selected\': $parent.searchSelectIndex() === ($index() + 1) }, click: function () { $parent.selectSearchResult($data); }, event: { \'mouseover\': function () { $parent.searchResultsMouseover($index()); } }">\n                        <span data-bind="html: displayName"></span>\n                        <span data-bind="text: countText" class="count"></span>\n                    </li>\n                    \x3c!-- /ko --\x3e\n                </ul>\n            </div>\n        </div>\n    </div>\n\n\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n        <div class="genres-overflow-wrapper mobile hide-scrollbar" data-bind="visible: showSubgenres">\n            <ul class="genres clearfix" data-bind="foreach: genres">\n                <li class="genre top-level expanded" data-bind="attr: { \'id\': cssId }, css: { \'long\': isLong, \'search\': isSearch }, click: expand">\n                    <div class="content">\n                        \x3c!-- ko if: isSearch --\x3e\n                        <h3 class="search-heading">',{type:"translate",nodelist:["Not quite finding what you’re looking for?"]},'</h3>\n                        <h4 class="search-subheading">',{type:"translate",nodelist:["Try searching instead."]},'</h3>\n                        \x3c!-- /ko --\x3e\n                        \x3c!-- ko if: !isSearch --\x3e\n                        <div class=\'genre-title\'>\n                            <span data-bind="text: name"></span>\n                        </div>\n                        <ul class="subgenres mobile">\n                            <li class="subgenre selected" data-bind="css: { \'selected\': selectedSecondPane }, click: function () { expanded() &amp;&amp; toggleSelect(false); }">\n                                <h3 class="subgenre-name">\n                                    <span class="genre-icon"></span>',{type:"translate",nodelist:["all"]},' <span data-bind="text: name"></span>\n                                </h3>\n                            </li>\n                            \x3c!-- ko foreach: subgenres --\x3e\n                            <li class="subgenre" data-bind="css: { \'selected\': selected }, click: function () { toggleSelect(false); }, clickBubble: false">\n                                <h3 class="subgenre-name">\n                                    <span class="genre-icon"></span><span data-bind="text: name"></span>\n                                </h3>\n                            </li>\n                            \x3c!-- /ko --\x3e\n                        </ul>\n                        \x3c!-- /ko --\x3e\n                    </div>\n                </li>\n            </ul>\n        </div>\n\n        ',{type:"include",template_name:"'fan/signup/fan_genre_picker_selected_genres'"},"\n    "]}]},'\n\n    <div class="buttons">\n        <button class="next" data-bind="click: next, enable: submitEnabled, css: { \'disabled\': selectedGenres().length === 0 }">\n            \x3c!-- ko if: submitting() --\x3e\n            ',{type:"translate",nodelist:["Please wait..."]},"\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: !submitting() && standalone() && !isMobile--\x3e\n            ",{type:"translate",nodelist:["Submit"]},"\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: !submitting() && (!standalone() || isMobile) --\x3e\n            ",{type:"translate",nodelist:["Next"]},"\n            \x3c!-- /ko --\x3e\n        </button>\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_genre_picker_selected_genres.liquid","warn"):Templ.register({"fan/signup/fan_genre_picker_selected_genres":['<div class="selected-genres-wrapper" ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['data-bind="visible: showGenres"']}]},'>\n    <div class="list-wrapper" data-bind="css: { \'has-genres\': selectedGenres().length > 0, \'no-animation\': selectedGenres.noAnimation() }">\n        <ul class="selected-genres" data-bind="foreach: selectedGenres">\n            \x3c!-- ko if: isFake --\x3e\n            <li class="selected-genre-placeholder"></li>\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: !isFake --\x3e\n            <li class="selected-genre" data-bind="click: function () { toggleSelect(true); }, css: { \'visible\': visible, \'hiding\': hiding }">\n                <h3 class="genre-name">\n                    <span class="genre-icon"></span><span data-bind="text: displayName"></span>\n                </h3>\n            </li>\n            \x3c!-- /ko --\x3e\n        </ul>\n    </div>\n\n    <a data-bind="click: pageLeft, visible: showPageLeft" class="page page-left">\n        <span class="page-fade"></span>\n        <svg class="icon" viewBox= "0 0 16 16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#larr-onboarding-ico"></use></svg>\n    </a>\n    <a data-bind="click: pageRight, visible: showPageRight" class="page page-right">\n        <span class="page-fade"></span>\n        <svg class="icon" viewBox="0 0 16 16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#rarr-onboarding-ico"></use></svg>\n    </a>\n</div>\n']}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_newsletter_picker_pane.liquid","warn"):Templ.register({"fan/signup/fan_newsletter_picker_pane":['<form id="signup-vm" class=\'newsletter-picker-form modern-form signup-common-form\' data-bind=\'css: { "visible": visible }\' novalidate>\n    <div class="heading-wrapper">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"!from_newsletter_invite_banner ",attachment:['\n        <div class="icon">\n            <img src="/img/fan_signup/record-2x.png">\n        </div>\n        <div class="text wide">\n            \x3c!-- ko if: hasSelectedGenres --\x3e\n            <h2>',{type:"translate",nodelist:["Great! Would you like to receive our weekly newsletter alerting you to the best new music in your favorite genres?"]},"</h2>\n            \x3c!-- /ko --\x3e\n\n            \x3c!-- ko if: !hasSelectedGenres --\x3e\n            <h2>",{type:"translate",nodelist:["Would you like to receive our weekly newsletter alerting you to the best new music on Bandcamp?"]},"</h2>\n            \x3c!-- /ko --\x3e\n        </div>\n        "]},{type:"else_ncondition",attachment:['\n        <div class="icon">\n            <img src="/img/fan_signup/record-2x.png">\n        </div>\n        <div class="text wide">\n            <h2>Great. We\'ll send you recommendations every Friday. Sound good?</h2>\n        </div>\n        ']}]},'\n    </div>\n\n    <div class="buttons split">\n        <button class="yes" data-bind="click: chooseBestOf, disable: submitting">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"!from_newsletter_invite_banner ",attachment:["\n                ",{type:"translate",nodelist:["Yes"]},"\n            "]},{type:"else_ncondition",attachment:["\n                Yes!\n            "]}]},'\n        </button>\n        <button class="no" data-bind="click: skip">',{type:"translate",nodelist:["No thanks"]},'</button>\n    </div>\n\n    \x3c!-- ko if: isValidEmail --\x3e\n    <div class="email-abuse">\n        ',{type:"translate",nodelist:["Emails will be sent to ",{type:"translateVariable",var_name:"email",nodelist:[{type:"variable",name:"email",filters:[["h",[]]]}]},"."]},'\n        <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/settings?from=tp">',{type:"translate",nodelist:["Change account email address"]},"</a>\n    </div>\n    \x3c!-- /ko --\x3e\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_welcome_2_pane.liquid","warn"):Templ.register({"fan/signup/fan_welcome_2_pane":["<form id=\"signup-vm\" class='welcome-2-form modern-form signup-common-form' data-bind='css: { \"visible\": visible }' novalidate>\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"show_tooltips ",attachment:['\n        <div class="icon">\n            <img src="/img/fan_signup/tent-2x.png">\n        </div>\n        <h2 class="welcome"><div class="to-bandcamp">',{type:"translate",nodelist:["Welcome to Bandcamp!"]},"</div> ",{type:"translate",nodelist:["Let’s take a quick look around."]},'</h2>\n        <div class="buttons split">\n            <button data-bind="click: submit">',{type:"translate",nodelist:["Yes, let’s"]},'</button><button data-bind="click: skip">',{type:"translate",nodelist:["No thanks"]},"</button>\n        </div>\n    "]},{type:"else_ncondition",attachment:['\n        <h2 class="welcome no-tooltips">',{type:"translate",nodelist:["Thanks! Your account is now active."]},'</h2>\n        <div class="buttons">\n            <button data-bind="click: submit">',{type:"translate",nodelist:["Got it"]},"</button>\n        </div>\n    "]}]},"\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_complete_profile_pane.liquid","warn"):Templ.register({"fan/signup/fan_complete_profile_pane":['<form id="signup-vm" class=\'complete-profile-form modern-form signup-common-form\' data-bind=\'css: { "visible": visible }, submit: completeProfileVM.submit\' novalidate>\n    <div class="signup-common-inner">\n        <div class="dialog-body">\n            <div class="skinny" data-bind="with: completeProfileVM">\n                ',{type:"include",template_name:"'common/fan/templates/complete_profile'"},"\n            </div>\n        </div>\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/login/user_picker_text.liquid","warn"):Templ.register({"login/user_picker_text":[{type:"variable",name:"username",filters:[["h",[]]]},"\n",{type:"ef",blocks:[{type:"ncondition",expression:"list.length > 4 ",attachment:["\n    ",{type:"let",variable:"num_others",expression:"(list.length - 3) "},"\n    ",{type:"capture",to:"list",nodelist:[{type:"for",collection_name:"list",nodelist:[{type:"variable",name:"name",filters:[["h",[]]]},{type:"ef",blocks:[{type:"ncondition",expression:"!forloop.last ",attachment:[", "]}]}],variable_name:"name",reversed:null,attribs:{limit:3}}]},"\n    ",{type:"translate",nodelist:["(",{type:"variable",name:"list",filters:[]}," and ",{type:"variable",name:"num_others",filters:[]}," more)"]},"\n"]},{type:"ncondition",expression:"list.length > 0 ",attachment:["\n    (",{type:"for",collection_name:"list",nodelist:[{type:"variable",name:"name",filters:[["h",[]]]},{type:"ef",blocks:[{type:"ncondition",expression:"!forloop.last ",attachment:[", "]}]}],variable_name:"name",reversed:null,attribs:{}},")\n"]}]}]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/home_2016/fan_verify_banner.liquid","warn"):Templ.register({"home_2016/fan_verify_banner":['<div class="corpbanner verify-email" ',{type:"ef",blocks:[{type:"ncondition",expression:"cc_menubar || !show_verify_banner ",attachment:['style="display: none;"']}]},' data-email="',{type:"variable",name:"verify_email",filters:[["a",[]]]},'">\n    <div class="text">\n        ',{type:"translate",nodelist:["Hey! Please verify your email by clicking the link we sent to ",{type:"translateVariable",var_name:"verify_email",nodelist:[{type:"variable",name:"verify_email",filters:[["h",[]]]}]},"."]},' <a href="#" id="resend-verification-email" class="resend-verification-email">',{type:"translate",nodelist:["Change email / Send again"]},"</a>\n    </div>\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/postcheckout/download_2016/mobile_app_button.liquid","warn"):Templ.register({"postcheckout/download_2016/mobile_app_button":[{type:"ef",blocks:[{type:"ncondition",expression:"cfg_mobile_download_fix ",attachment:['\n<div class="button-container">\n    <a class="listen-button ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_redownload ",attachment:["blue-button"]}]},'" href="',{type:"variable",name:"app_tralbum_url_redirect",filters:[["a",[]]]},'"  data-bind="click: dtdWatch.bind($data, \'fan_listen_in_app\')">\n        <div class="button-inner">\n            <svg class="icon app-play-logo" width="24px" height="31px" viewBox="0 0 24 31"><use xlink:href="#play-app-2"></svg>\n            <div class="app-play-text">',{type:"translate",nodelist:["Listen now in the Bandcamp app"]},"</div>\n        </div>\n    </a>\n</div>\n"]},{type:"else_ncondition",attachment:['\n<div class="button-container">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"probably_has_app ",attachment:['\n    <a class="listen-button blue-button" href=\'',{type:"variable",name:"app_tralbum_url",filters:[["a",[]]]},'\'>\n        <div class="button-inner">\n            <svg class="icon app-play-logo" width="44px" height="60px" viewBox="0 0 44 60"><use xlink:href="#play-app"></svg>\n            <div class="app-play-text">',{type:"translate",nodelist:["Listen now in the Bandcamp app"]},'</div>\n        </div>\n    </a>\n    <a class="download-button" href=\'',{type:"variable",name:"platform_app_url",filters:[["a",[]]]},'\'>\n        <div class="button-inner">\n            <svg class="icon app-phone-logo" width="87px" height="76px" viewBox="0 0 87 76"><use xlink:href="#grab-app"></svg>\n            <div class="missing-app">',{type:"translate",nodelist:["Don’t have the Bandcamp app?"]},'<br><div class="grab-it">',{type:"translate",nodelist:["Grab it here for free."]},"</div></div>\n        </div>\n    </a>\n    "]},{type:"else_ncondition",attachment:['\n    <a class="download-button blue-button" href=\'',{type:"variable",name:"platform_app_url",filters:[["a",[]]]},'\'>\n        <div class="button-inner">\n            <svg class="icon app-phone-logo" width="87px" height="76px" viewBox="0 0 87 76"><use xlink:href="#grab-app"></svg>\n            <div class="missing-app">',{type:"translate",nodelist:["Don’t have the Bandcamp app?"]},"<br>",{type:"translate",nodelist:["Grab it here for free."]},'</div>\n        </div>\n    </a>\n    <a class="listen-button" href=\'',{type:"variable",name:"app_tralbum_url",filters:[["a",[]]]},'\'>\n        <div class="button-inner">\n            <svg class="icon app-play-logo" width="44px" height="60px" viewBox="0 0 44 60"><use xlink:href="#play-app"></svg>\n            <div class="app-play-text">',{type:"translate",nodelist:["Listen now in the Bandcamp app"]},"</div>\n        </div>\n    </a>\n    "]}]},"\n</div>\n"]}]}]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/account/download_item_small.liquid","warn"):Templ.register({"account/download_item_small":['<div class="download-item-small-container">\n    <img class="download-thumbnail" ',{type:"variable",name:"download_item.art_id",filters:[["art",['"art_embedded_player_large"']]]},' title="',{type:"translate",nodelist:["",{type:"variable",name:"download_item.title",filters:[["attr",[]]]}," Cover Art"]},'" alt="',{type:"translate",nodelist:["",{type:"variable",name:"download_item.title",filters:[["attr",[]]]}," Cover Art"]},'"/>\n    \n    <div class="download-info">\n        <div class="tralbum-title">',{type:"variable",name:"download_item.title",filters:[["h",[]]]},"</div>\n        <div>",{type:"variable",name:"download_item.artist",filters:[["h",[]]]},"</div>\n    </div>\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/svg_shared.liquid","warn"):Templ.register({svg_shared:['\n\n<svg height="0" width="0" style="position:absolute;margin-left:-100%">\n    <path id="tweet" d="M16.1 3.5a9.6 9.6 0 01-1.7 6c-.6.9-1.3 1.6-2.1 2.3-.8.7-1.8 1.2-2.9 1.6-1.2.4-2.4.6-3.7.6-2.2 0-4.1-.6-5.7-1.6 2.5.2 4.1-.5 5.5-1.5-1.7 0-3-1.1-3.4-2.4.5.1 1.3 0 1.7-.1-1.5-.3-3-1.7-3-3.5.3.2.9.4 1.7.4C1.5 4.8.8 3.7.8 2.4c0-.6.2-1.4.5-1.8 1.7 2 4.4 3.6 7.6 3.7C8.3 1.4 10.6 0 12.5 0c1.1 0 2 .4 2.7 1.1.8-.1 1.6-.4 2.3-.8-.3.8-.8 1.5-1.6 1.9.7-.1 1.4-.2 2.1-.5-.5.7-1.1 1.3-1.9 1.8z"/>\n    <path id="buy-for-friend" d="M3.5 4h7c1.8-.3 2.4-1.9 2-2.9S10.7-.5 9.3.5 7 3 7 3 6.1 1.5 4.7.5s-2.8-.4-3.2.6.2 2.6 2 2.9zm6.8-3c.9-.2 1.6.1 1.3 1.1-.3 1.2-2.6 1.3-3.8 1.3 0 0 1.6-2.2 2.5-2.4zM3.8 1c1.1.4 2.4 2.4 2.4 2.4-1.3 0-3.4-.3-3.8-1.3C2 1.1 3 .8 3.8 1zM0 9h6V5H0v4zm7-4v4h7V5H7zm0 9h6v-4H7v4zm-6 0h5v-4H1v4z"/>\n    <path id="edit-profile-info" d="M10 10.5c0 .3-.2.5-.5.5h-8c-.3 0-.5-.2-.5-.5v-8c0-.3.2-.5.5-.5h3.7V1H1.5C.7 1 0 1.7 0 2.5v8c0 .8.7 1.5 1.5 1.5h8c.8 0 1.5-.7 1.5-1.5V7h-1v3.5zm2-9.1L10.5 0 6.4 4.4l-.6 2.2L8 5.7l4-4.3z"/>\n    <path id="fb-logo-share-profile" d="M3.9 12V6.3h1.8L6 4.2H4V2.9c0-.6.2-1 1-1h1.1V.1C5.8.1 5.2 0 4.4 0 2.8 0 1.8 1 1.8 2.7v1.5H0v2.1h1.8V12h2.1z"/>\n    <path id="following-checkmark" d="M4.3 10.7L0 5.8l1.5-1.3 2.8 3.1L11 0l1.5 1.3z"/>\n    <path id="follow-plus" d="M8 3H5V0H3v3H0v2h3v3h2V5h3z"/>\n    <path id="share-profile" d="M10.7.2s-.1-.1 0 0l-.4-.2h-.1L2.5 4.8.3 8.1v.1s0 .1.1.1l3.3.9h.1l5.1-6.5-3.3 7 .9 2.2.1.1s.1 0 .1-.1l.9-1.5 2.8.9.1-.1L11.8 7 10.7.2z"/>\n    <path id="search-magnifier" d="M10.1 10.4l-1.4-2C9.5 7.5 10 6.3 10 5c0-2.8-2.2-5-5-5S0 2.2 0 5s2.2 5 5 5c.7 0 1.4-.1 2-.4l1.5 2c.3.4 1 .5 1.4.2.4-.3.5-.9.2-1.4zM5 9C2.8 9 1 7.2 1 5s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4z"/>\n    <path id="close-search-results" d="M8 .7L7.3 0 4 3.3.7 0 0 .7 3.3 4 0 7.3l.7.7L4 4.7 7.3 8l.7-.7L4.7 4z"/>\n    <path id="camera-icon" d="M26 2h-4a2 2 0 00-2-2H8a2 2 0 00-2 2H2a2 2 0 00-2 2v14a2 2 0 002 2h24a2 2 0 002-2V4a2 2 0 00-2-2zM14 17a6 6 0 116-6 6 6 0 01-6 6zm1-10h-2v3h-3v2h3v3h2v-3h3v-2h-3z"/>\n    <g id="search-spinner">\n        <circle class="st1" cx="7" cy="1.5" r="1.5"/>\n        <circle class="st2" transform="rotate(-45 10.89 3.11)" cx="10.9" cy="3.1" r="1.5"/>\n        <circle class="st3" cx="12.5" cy="7" r="1.5"/>\n        <circle class="st4" transform="rotate(-45 10.89 10.89)" cx="10.9" cy="10.9" r="1.5"/>\n        <circle class="st5" cx="7" cy="12.5" r="1.5"/>\n        <circle class="st6" transform="rotate(-45 3.11 10.89)" cx="3.1" cy="10.9" r="1.5"/>\n        <circle class="st8" transform="rotate(-45 3.11 3.11)" cx="3.1" cy="3.1" r="1.5"/>\n        <circle class="st7" cx="1.5" cy="7" r="1.5"/>\n    </g>\n    <path id="mobile-web-collection-arrow" d="M20.3 17.3L3 0 .3 2.7 17.7 20 .3 37.3 3 40l17.3-17.3L23 20z"/>\n    <path id="homepage-mobile-arrow" d="M12.9 11L2.1.1 0 2.2l10.8 10.9L0 24l2.1 2.1 10.8-10.9 2.1-2.1z"/>\n    <path id="collect-control-wishlist" d="M10.5 20l-.8-.9s-1.9-2.3-4.6-4.7C1.8 11.2.1 8.5 0 6c0-1.6.6-3 1.8-4.3C3.4.3 5-.2 6.6.1c1.8.3 3.1 1.6 3.9 2.5.9-1 2.3-2.2 4.1-2.5 1.6-.2 3 .3 4.5 1.5 1.3 1.2 2 2.6 2 4.1 0 2.5-1.7 5.3-5.3 8.6a44.6 44.6 0 00-4.4 4.7l-.9 1zm-4-7.1c1.8 1.6 3.2 3.1 4 4 .8-.9 2.2-2.4 3.9-4 3.1-2.8 4.7-5.2 4.7-7.1 0-1-.4-1.9-1.3-2.7-1-.8-1.9-1.2-2.9-1-2 .3-3.6 2.7-3.6 2.7l-.9 1.4-.8-1.5S8.3 2.3 6.3 1.9c-1-.2-2 .2-3.1 1.1-.9.9-1.3 1.9-1.2 2.9 0 2 1.6 4.3 4.5 7z"/>\n    <path id="collect-control-purchased" d="M10.5 20l-.8-.9s-1.9-2.3-4.6-4.7C1.8 11.2.1 8.5 0 6c0-1.6.6-3 1.8-4.3C3.4.3 5-.2 6.6.1c1.8.3 3.1 1.6 3.9 2.5.9-1 2.3-2.2 4.1-2.5 1.6-.2 3 .3 4.5 1.5 1.3 1.2 2 2.6 2 4.1 0 2.5-1.7 5.3-5.3 8.6a44.6 44.6 0 00-4.4 4.7l-.9 1z"/>\n    <path id="collect-control-wishlisted" d="M10.5 20l-.8-.9s-1.9-2.3-4.6-4.7C1.8 11.2.1 8.5 0 6c0-1.6.6-3 1.8-4.3C3.4.3 5-.2 6.6.1c1.8.3 3.1 1.6 3.9 2.5.9-1 2.3-2.2 4.1-2.5 1.6-.2 3 .3 4.5 1.5 1.3 1.2 2 2.6 2 4.1 0 2.5-1.7 5.3-5.3 8.6a44.6 44.6 0 00-4.4 4.7l-.9 1z"/>\n    <path id="facebook-like" d="M2 0h12c1.15 0 2 .85 2 2v12c0 1.15-.85 2-2 2h-3.49V9.83h2.06l.34-2.52h-2.4V5.83c0-.34.12-.69.23-.8.12-.23.46-.34.92-.34h1.25V2.5c-.45-.11-1.02-.11-1.82-.11-.92 0-1.72.23-2.29.8-.57.57-.8 1.37-.8 2.4v1.83H5.94v2.4H8V16H2c-1.15 0-2-.85-2-2V2C0 .85.85 0 2 0z"/>\n    <path id="format-dropdown" d="M10 0L5 6 0 0z"/>\n    <path id="direct-download" d="M11.7 7.3c-.4-.4-1-.4-1.4 0L7 10.6V1c0-.5-.5-1-1-1S5 .5 5 1v9.6L1.7 7.3c-.4-.4-1-.4-1.4 0s-.4 1 0 1.4l5 5c.2.2.4.3.7.3.4 0 .5-.1.7-.3l5-5c.4-.4.4-1 0-1.4zM10 15H2c-.5 0-1 .5-1 1s.5 1 1 1h8c.5 0 1-.5 1-1s-.5-1-1-1z"/>\n    <path id="mobile-gift-ribbon" class="st0" d="M46.3 0C37.4 0 31.1 8.3 28 13.5 24.9 8.3 18.6 0 9.7 0 4.1 0 0 3.5 0 8.2 0 16.6 12.2 22 27.7 22 43.9 22 56 15 56 8.3c0-1.3-.3-2.6-1-3.8C53.5 1.7 50.2 0 46.3 0zM9.6 12.8c-3.1-1.6-3.9-3.1-3.9-4.6 0-1.5 1.5-3.1 4-3.1 6 0 10.8 6.6 13.4 10.9-6.9-.5-11.1-2-13.5-3.2zm37.3-.3c-2.8 1.6-7.4 3-14 3.4C35.5 11.6 40.1 5 46.1 5c2.1 0 4 .9 4 3 0 1.9-1.6 3.6-3.2 4.5z"/>\n    <path id="grab-app" d="M20.8 25c-.8-.8-2-.8-2.8 0-.8.8-.8 2 0 2.8l7.2 7.2H2a2 2 0 00-2 2c0 1.1.9 2 2 2h23.2L18 46.2c-.8.8-.8 2 0 2.8.8.8 2 .8 2.8 0l10.6-10.6c.3-.3.6-.8.6-1.4 0-.6-.3-1.1-.6-1.4L20.8 25zM77.6 0h-26C46 0 41 4 41 9.5v56C41 71 46 76 51.6 76h26c5.5 0 9.4-5 9.4-10.5v-56C87 4 83.1 0 77.6 0zM84 65.5c0 3.9-2.6 7.5-6.4 7.5h-26c-3.9 0-7.6-3.6-7.6-7.5V56h40v9.5zM84 53H44V17h40v36zm0-39H44V9.5C44 5.6 47.7 3 51.6 3h26C81.4 3 84 5.6 84 9.5V14zM64 67c1.7 0 3-1.3 3-3s-1.3-3-3-3-3 1.3-3 3 1.4 3 3 3z"/>\n    <path id="play-app" d="M1 60c-.2 0-.3 0-.5-.1-.3-.2-.5-.5-.5-.9V1C0 .6.2.3.5.1c.4-.1.8-.1 1.1.1l42 29c.3.2.4.5.4.8s-.2.6-.4.8l-42 29c-.2.2-.4.2-.6.2zM2 2.9v54.2L41.3 30 2 2.9z"/>\n    <path id="play-app-2" d="M18.55 16L2.97 5.61V26.4L18.55 16zM0 32V0l24 16L0 32z"/>\n    <g id="grab-app-opensignup" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="collection" transform="translate(-67 -505)" fill="#FFF">\n            <g id="mweb-phone-icon-outline" transform="translate(67 505)">\n                <path d="M21.16 3.99v28.02a3 3 0 003 2.99h13.99a3 3 0 003-2.99V3.99a3 3 0 00-3-2.99H24.17a3 3 0 00-3.01 2.99zm-1 0a4 4 0 014-3.99h13.99a4 4 0 014 3.99v28.02a4 4 0 01-4 3.99H24.17a4 4 0 01-4.01-3.99V3.99z" id="Rectangle-1270"/>\n                <rect id="Rectangle-1271" x="29.41" y="29.73" width="2.5" height="2.5" rx="1.25"/>\n                <path d="M20.66 8.23h21v-1h-21v1zm0 19h21v-1h-21v1z" id="Combined-Shape"/>\n                <path d="M.29 18.44c0 .36.31.67.68.67h11.62L8.86 23.3a.72.72 0 000 .99l.36.41c.26.26.68.26.94 0l5.89-6.05a.72.72 0 000-1L9.96 11.3a.66.66 0 00-.94 0l-.36.41a.72.72 0 000 1l3.9 4.43H.96a.69.69 0 00-.67.67v.63z" id="→"/>\n            </g>\n        </g>\n    </g>\n    <g id="has-app">\n        <path class="has-app-phone" d="M18 56a2 2 0 002-2c0-1.1-.9-2-2-2s-2 .9-2 2 .9 2 2 2zM29 0H7C3.1 0 0 3.1 0 7v48c0 3.9 3.1 7 7 7h22c3.9 0 7-3.1 7-7V7c0-3.9-3.1-7-7-7zm5 55c0 2.8-2.2 5-5 5H7c-2.8 0-5-2.2-5-5v-6h32v6zm0-8H2V12h32v35zm0-37H2V7c0-2.8 2.2-5 5-5h22c2.8 0 5 2.2 5 5v3z"/>\n        <path class="has-app-confirm" d="M18 18c-6.4 0-11.5 5.1-11.5 11.5S11.6 41 18 41s11.5-5.1 11.5-11.5S24.4 18 18 18zm5.3 9.6l-5.8 5.8c-.3.3-.7.4-1.1.4-.4 0-.8-.1-1.1-.4l-2.6-2.6c-.6-.6-.6-1.5 0-2.1s1.5-.6 2.1 0l1.6 1.6 4.8-4.8c.6-.6 1.5-.6 2.1 0 .6.6.6 1.6 0 2.1z"/>\n    </g>\n    <g id="no-app">\n        <path class="no-app-phone" d="M18 56a2 2 0 002-2c0-1.1-.9-2-2-2s-2 .9-2 2 .9 2 2 2zM29 0H7C3.1 0 0 3.1 0 7v48c0 3.9 3.1 7 7 7h22c3.9 0 7-3.1 7-7V7c0-3.9-3.1-7-7-7zm5 55c0 2.8-2.2 5-5 5H7c-2.8 0-5-2.2-5-5v-6h32v6zm0-8H2V12h32v35zm0-37H2V7c0-2.8 2.2-5 5-5h22c2.8 0 5 2.2 5 5v3z"/>\n        <path class="no-app-bc-logo" d="M14 23L7 36h15l7-13z"/>\n    </g>\n    <g id="signup-promo-icon">\n        <path id="signup-phone-background" d="M25 52H5c-2.8 0-5-2.2-5-5V5c0-2.8 2.2-5 5-5h20c2.8 0 5 2.2 5 5v42c0 2.8-2.2 5-5 5z"/>\n        <g id="signup-promo-phone">\n            <path class="signup-phone-icon" d="M25 0H5C2.2 0 0 2.2 0 5v42c0 2.8 2.2 5 5 5h20c2.8 0 5-2.2 5-5V5c0-2.8-2.2-5-5-5zm3 47c0 1.7-1.3 3-3 3H5c-1.7 0-3-1.3-3-3v-6h26v6zm0-8H2V10h26v29zm0-31H2V5c0-1.7 1.3-3 3-3h20c1.7 0 3 1.3 3 3v3zM15 47a2 2 0 002-2c0-1.1-.9-2-2-2s-2 .9-2 2 .9 2 2 2z"/>\n            <path class="signup-bc-logo" d="M11.6 19L5.7 30h12.7l5.9-11z"/>\n        </g>\n    </g>\n    <path id="format-dropdown-selected" d="M8.6.3C8.2-.1 7.5-.1 7 .3L3.4 4 2 2.5c-.4-.4-1.2-.4-1.6 0-.4.4-.4 1.2 0 1.6l2.2 2.2c.2.2.5.3.8.3.3 0 .6-.1.8-.3L8.6 2c.5-.5.5-1.2 0-1.7z"/>\n    <defs>\n        <linearGradient id="ribbon-gradient" x1="0" x2="0" y1="0" y2="1">\n            <stop offset="0%" stop-color="#00BAEF"/>\n            <stop offset="90%" stop-color="#1DA0C3"/>\n        </linearGradient>\n    </defs>\n    <path id="rarr-ico" d="M5 5L0 9l2 1 6-5-6-5-2 1 5 4z"/>\n    <path id="larr-ico" d="M5 5L0 9l2 1 6-5-6-5-2 1 5 4z" transform="rotate(-180 4 5)"/>\n    <path d="M2.57 0L.44 2.13 7.31 9 .43 15.87 2.56 18l9-9z" transform="rotate(-180 7.5 9)" id="larr-onboarding-ico"/>\n    <g id="rarr-onboarding-ico" transform="translate(3)">\n        <path id="Fill-2" d="M2.57 0L.44 2.13 7.31 9 .43 15.87 2.56 18l9-9z"/>\n    </g>\n    <path d="M0 3h3v3H0V3zm6 0l2-1-2-2-1.5 2.3L3 0 1 2l2 1h1v3h5V3H6zm-5 7h2V7H1v3zm3 0h4V7H4v3z" id="gift-card-icon"/>\n    <path id="not-shipped" d="M7.9 0L4.75 3.16 1.58 0 0 1.58l3.16 3.17L0 7.9l1.58 1.58 3.16-3.16 3.17 3.16 1.58-1.58-3.16-3.16 3.16-3.17z"/>\n    <path id="checkmark-shipped" d="M4.66 6.5L1.38 3.37 0 4.8l3.28 3.14 1.18 1.12.26.26 7.6-7.95L10.89 0z"/>\n    <path fill-rule="evenodd" d="M11.82 21.35a60.6 60.6 0 011.25 1.4 42.86 42.86 0 011.21-1.4 56.68 56.68 0 014.18-4.24c5.95-5.4 8.04-9.93 4.2-13.42-2.69-2.35-5.25-1.9-7.63.34a11.2 11.2 0 00-1.62 1.92l-.46.73-.4-.75a10.42 10.42 0 00-1.5-1.97c-2.28-2.32-4.85-2.78-7.72-.3-3.62 3.7-1.54 8.23 4.22 13.45a69.17 69.17 0 014.27 4.24zm1.21-16.6c.38-.5.82-.99 1.31-1.45 2.72-2.55 5.84-3.1 8.99-.35 4.49 4.07 2.15 9.14-4.2 14.9a55.69 55.69 0 00-5.65 5.99l-.38.49-.4-.48c-.07-.1-.21-.26-.42-.5a68.18 68.18 0 00-5.4-5.5C.74 12.28-1.57 7.24 2.64 2.94 6 .04 9.14.6 11.75 3.26A11.4 11.4 0 0113 4.79l.03-.04z" id="menubar-collection-icon"/>\n    <path fill-rule="evenodd" d="M14.4.87a1 1 0 011.77.77l-1.1 7.84h6.46a1 1 0 01.74 1.68L9.24 25.2a1 1 0 01-1.72-.85L9 15.56H4.5a1 1 0 01-.77-1.63L14.4.87zm.78.63L4.5 14.57H9a1 1 0 01.98 1.16l-1.47 8.8 13.02-14.05h-6.47a1 1 0 01-.99-1.14l1.11-7.84z" id="menubar-feed-icon"/>\n    <path d="M21.38 19.44a.13.13 0 01-.12.07H1.13a.12.12 0 01-.11-.07.33.33 0 01-.03-.09l3.27-4.15c.37-.59.57-1.27.57-1.97V7.67C4.83 4.09 7.6 1.1 11 1h.2c1.66 0 3.23.63 4.43 1.8a6.33 6.33 0 011.94 4.58v5.85c0 .7.2 1.38.6 2.01l3.2 4.05c.03.06.02.11 0 .15m-7.45 1.32a2.73 2.73 0 01-5.46 0c0-.09.03-.17.03-.25h5.4c.01.08.03.16.03.25m8.27-2.04L19 14.67a2.66 2.66 0 01-.42-1.44V7.38A7.36 7.36 0 0010.98 0C7.03.11 3.83 3.55 3.83 7.66v5.56c0 .51-.15 1-.39 1.4L.17 18.78c-.22.36-.23.79-.02 1.15.2.36.57.58.98.58H7.5c0 .08-.03.16-.03.25a3.73 3.73 0 007.46 0c0-.09-.02-.17-.03-.25h6.36a1.14 1.14 0 00.94-1.78" id="menubar-messages-icon" fill-rule="evenodd"/>\n    <path fill-rule="evenodd" d="M11.43 19.7a9.02 9.02 0 008.93-9.1c0-5.03-4-9.1-8.93-9.1a9.02 9.02 0 00-8.93 9.1c0 5.03 4 9.1 8.93 9.1zm6.95-1.9l6 6.87c.44.5-.32 1.16-.76.66l-5.98-6.85a9.78 9.78 0 01-6.21 2.22c-5.49 0-9.93-4.52-9.93-10.1S5.94.5 11.43.5c5.48 0 9.93 4.52 9.93 10.1 0 2.82-1.14 5.37-2.98 7.2z" id="menubar-search-icon"/>\n    <path d="M10.7 10.47l3.74 4.2c.44.5-.3 1.16-.75.66l-3.73-4.2c-.44-.5.3-1.16.75-.66zM6.6 11.7a5.1 5.1 0 100-10.2 5.1 5.1 0 000 10.2zm0 1A6.1 6.1 0 116.6.5a6.1 6.1 0 010 12.2z" id="menubar-search-input-icon"/>\n    <g id="menubar-cart-icon" fill-rule="evenodd">\n        <path d="M21.5 25a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"/>\n        <circle cx="8.5" cy="23.5" r="1.5" opacity=".9"/>\n        <path fill-rule="nonzero" d="M4.57 2H.5a.5.5 0 010-1h4.48a.5.5 0 01.5.4l.5 2.7 18.52.18c.31 0 .54.28.5.58l-2.28 13.72a.5.5 0 01-.49.42H8.16a.5.5 0 01-.49-.4L4.57 2zm1.6 3.1L8.57 18h13.24l2.1-12.73L6.17 5.1z"/>\n    </g>\n    <g id="bandcamp-logo-color-bcaqua">\n        <path d="M26.62 0h2.42v5.8h.04a3.96 3.96 0 013.28-1.78c3.46 0 5.14 2.73 5.14 6.05C37.5 13.12 36 16 32.76 16c-1.49 0-3.08-.37-3.8-1.87h-.05v1.57h-2.3V0m5.43 6c-2.04 0-3.08 1.6-3.08 4.02 0 2.29 1.12 4 3.08 4 2.2 0 3.04-2.02 3.04-4 0-2.06-1.05-4.02-3.04-4.02" id="b" fill="#333"/>\n        <path d="M56.26 4.05c-1.44 0-2.7.77-3.42 2.03l-.04-.05V4.36h-2.3v9.68l-1.61.01c-.45 0-.58-.24-.58-.85V7.35c0-2.4-2.25-3.3-4.4-3.3-2.42 0-4.82.86-4.99 3.78h2.42c.11-1.23 1.07-1.8 2.43-1.8.97 0 2.27.24 2.27 1.54 0 1.47-1.55 1.27-3.3 1.6-2.03.25-4.22.7-4.22 3.54 0 2.22 1.78 3.32 3.76 3.32 1.3 0 2.85-.42 3.8-1.38.2 1.03.9 1.38 1.87 1.38.4 0 1.17-.15 4.96-.28v-.03h.02v-6.7c0-1.67 1.04-2.99 2.65-2.99 1.42 0 2.1.77 2.15 2.55v7.14h2.42v-7.8c0-2.55-1.5-3.87-3.88-3.87zM45.9 11.9c0 1.58-1.66 2.15-2.72 2.15-.85 0-2.24-.33-2.24-1.45 0-1.32.94-1.71 1.98-1.89 1.06-.2 2.23-.17 2.98-.68v1.87z" id="an" fill="#333"/>\n        <path d="M72.62 15.7h-2.29v-1.54h-.04c-.64 1.3-2.02 1.84-3.4 1.84-3.47 0-5.14-2.66-5.14-6.06 0-4.12 2.35-5.92 4.76-5.92 1.38 0 2.9.53 3.65 1.78h.04V0h2.43v15.7m-5.42-1.68c2.16 0 3.08-2.04 3.08-4.02 0-2.5-1.17-4-3.04-4-2.27 0-3.08 2.09-3.08 4.13 0 1.96.93 3.9 3.04 3.9" id="d" fill="#333"/>\n        <path d="M82.25 8.16c-.19-1.38-1.17-2.13-2.5-2.13-1.26 0-3.02.68-3.02 4.13 0 1.9.8 3.9 2.9 3.9 1.41 0 2.39-.97 2.62-2.6h2.42c-.44 2.95-2.2 4.57-5.03 4.57-3.44 0-5.34-2.53-5.34-5.87 0-3.43 1.81-6.1 5.42-6.1 2.55 0 4.72 1.31 4.95 4.1h-2.41" id="c" fill="#333"/>\n        <path d="M106.44 5.94c-.5-1.3-1.75-1.89-3.09-1.89-1.74 0-2.65.77-3.37 1.9l-.07-1.59h-2.3v9.68l-1.61.01c-.45 0-.57-.24-.57-.85V7.35c0-2.4-2.26-3.3-4.4-3.3-2.42 0-4.83.86-5 3.78h2.43c.1-1.23 1.06-1.8 2.42-1.8.98 0 2.27.24 2.27 1.54 0 1.47-1.55 1.27-3.3 1.6-2.03.25-4.22.7-4.22 3.54 0 2.22 1.78 3.32 3.76 3.32 1.3 0 2.85-.42 3.8-1.38.2 1.03.9 1.38 1.88 1.38.4 0 1.16-.15 4.92-.28l.05-6.77c0-1.9 1.15-2.95 2.4-2.95 1.47 0 1.93.84 1.93 2.4v7.3h2.43V9.05c0-1.9.7-3.03 2.33-3.03 1.9 0 2 1.25 2 3.06v6.63h2.42V7.88c0-2.77-1.36-3.83-3.67-3.83-1.6 0-2.64.73-3.44 1.9zm-16.15 8.11c-.85 0-2.24-.33-2.24-1.45 0-1.32.94-1.71 1.98-1.89 1.06-.2 2.23-.17 2.98-.68v1.87c0 1.58-1.66 2.15-2.72 2.15z" id="am" fill="#333"/>\n        <path d="M118.04 4.36V5.9h.04c.68-1.3 2-1.85 3.4-1.85 3.46 0 5.14 2.73 5.14 6.05 0 3.05-1.48 5.93-4.74 5.93-1.4 0-2.9-.53-3.67-1.78h-.05v5.67h-2.42V4.36h2.3zm.04 5.7c0 2.28 1.13 4 3.08 4 2.21 0 3.04-2.03 3.04-4 0-2.07-1.04-4.03-3.04-4.03-2.04 0-3.08 1.6-3.08 4.02z" id="p" fill="#333"/>\n        <path id="rhomboid" fill="#1DA0C3" d="M0 15.63L8.47 0H26.6l-8.47 15.63z"/>\n    </g>\n    <g id="bandcamp-logo-color-white" fill="#FFF">\n        <path d="M26.62 0h2.42v5.8h.04a3.96 3.96 0 013.28-1.78c3.46 0 5.14 2.73 5.14 6.05C37.5 13.12 36 16 32.76 16c-1.49 0-3.08-.37-3.8-1.87h-.05v1.57h-2.3V0m5.43 6c-2.04 0-3.08 1.6-3.08 4.02 0 2.29 1.12 4 3.08 4 2.2 0 3.04-2.02 3.04-4 0-2.06-1.05-4.02-3.04-4.02" id="b"/>\n        <path d="M56.26 4.05c-1.44 0-2.7.77-3.42 2.03l-.04-.05V4.36h-2.3v9.68l-1.61.01c-.45 0-.58-.24-.58-.85V7.35c0-2.4-2.25-3.3-4.4-3.3-2.42 0-4.82.86-4.99 3.78h2.42c.11-1.23 1.07-1.8 2.43-1.8.97 0 2.27.24 2.27 1.54 0 1.47-1.55 1.27-3.3 1.6-2.03.25-4.22.7-4.22 3.54 0 2.22 1.78 3.32 3.76 3.32 1.3 0 2.85-.42 3.8-1.38.2 1.03.9 1.38 1.87 1.38.4 0 1.17-.15 4.96-.28v-.03h.02v-6.7c0-1.67 1.04-2.99 2.65-2.99 1.42 0 2.1.77 2.15 2.55v7.14h2.42v-7.8c0-2.55-1.5-3.87-3.88-3.87zM45.9 11.9c0 1.58-1.66 2.15-2.72 2.15-.85 0-2.24-.33-2.24-1.45 0-1.32.94-1.71 1.98-1.89 1.06-.2 2.23-.17 2.98-.68v1.87z" id="an"/>\n        <path d="M72.62 15.7h-2.29v-1.54h-.04c-.64 1.3-2.02 1.84-3.4 1.84-3.47 0-5.14-2.66-5.14-6.06 0-4.12 2.35-5.92 4.76-5.92 1.38 0 2.9.53 3.65 1.78h.04V0h2.43v15.7m-5.42-1.68c2.16 0 3.08-2.04 3.08-4.02 0-2.5-1.17-4-3.04-4-2.27 0-3.08 2.09-3.08 4.13 0 1.96.93 3.9 3.04 3.9" id="d"/>\n        <path d="M82.25 8.16c-.19-1.38-1.17-2.13-2.5-2.13-1.26 0-3.02.68-3.02 4.13 0 1.9.8 3.9 2.9 3.9 1.41 0 2.39-.97 2.62-2.6h2.42c-.44 2.95-2.2 4.57-5.03 4.57-3.44 0-5.34-2.53-5.34-5.87 0-3.43 1.81-6.1 5.42-6.1 2.55 0 4.72 1.31 4.95 4.1h-2.41" id="c"/>\n        <path d="M106.44 5.94c-.5-1.3-1.75-1.89-3.09-1.89-1.74 0-2.65.77-3.37 1.9l-.07-1.59h-2.3v9.68l-1.61.01c-.45 0-.57-.24-.57-.85V7.35c0-2.4-2.26-3.3-4.4-3.3-2.42 0-4.83.86-5 3.78h2.43c.1-1.23 1.06-1.8 2.42-1.8.98 0 2.27.24 2.27 1.54 0 1.47-1.55 1.27-3.3 1.6-2.03.25-4.22.7-4.22 3.54 0 2.22 1.78 3.32 3.76 3.32 1.3 0 2.85-.42 3.8-1.38.2 1.03.9 1.38 1.88 1.38.4 0 1.16-.15 4.92-.28l.05-6.77c0-1.9 1.15-2.95 2.4-2.95 1.47 0 1.93.84 1.93 2.4v7.3h2.43V9.05c0-1.9.7-3.03 2.33-3.03 1.9 0 2 1.25 2 3.06v6.63h2.42V7.88c0-2.77-1.36-3.83-3.67-3.83-1.6 0-2.64.73-3.44 1.9zm-16.15 8.11c-.85 0-2.24-.33-2.24-1.45 0-1.32.94-1.71 1.98-1.89 1.06-.2 2.23-.17 2.98-.68v1.87c0 1.58-1.66 2.15-2.72 2.15z" id="am"/>\n        <path d="M118.04 4.36V5.9h.04c.68-1.3 2-1.85 3.4-1.85 3.46 0 5.14 2.73 5.14 6.05 0 3.05-1.48 5.93-4.74 5.93-1.4 0-2.9-.53-3.67-1.78h-.05v5.67h-2.42V4.36h2.3zm.04 5.7c0 2.28 1.13 4 3.08 4 2.21 0 3.04-2.03 3.04-4 0-2.07-1.04-4.03-3.04-4.03-2.04 0-3.08 1.6-3.08 4.02z" id="p"/>\n        <path id="rhomboid" d="M0 15.63L8.47 0H26.6l-8.47 15.63z"/>\n    </g>\n    <g id="bandcamp-rhomboid-white">\n        <path id="rhomboid" fill="#FFF" d="M0 15.63L8.47 0H26.6l-8.47 15.63z"/>\n    </g>\n    <g id="mobile-cart-up">\n        <path fill="#fff" stroke="#eee" d="M5 12L16 1h0l11 11"/>\n        <path fill="none" id="blocking" stroke="#fff" stroke-width="2" d="M4.5 12H27"/>\n    </g>\n    <defs>\n        <linearGradient x1="50%" y1="100%" x2="50%" y2="0%" id="fanAppGradient">\n            <stop stop-color="#00BAEF" offset="0%"/>\n            <stop stop-color="#1DA0C3" offset="100%"/>\n        </linearGradient>\n    </defs>\n    <g id="fan-app-icon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="mobileweb-fanartist-02" transform="translate(-86 -385)">\n            <g id="Group">\n                <g id="menu" transform="translate(58 39)">\n                    <g id="fan-app-icon" transform="translate(28 346)">\n                        <rect id="bg" fill="#FFF" x="0" y="0" width="23" height="23" rx="3"/>\n                        <path id="tent" fill="url(#fanAppGradient)" d="M4 15.9l4.78-8.8h10.21l-4.77 8.8z"/>\n                    </g>\n                </g>\n            </g>\n        </g>\n    </g>\n    <g id="artist-app-icon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="mobileweb-fanartist-02" transform="translate(-86 -334)">\n            <g id="Group">\n                <g id="menu" transform="translate(58 39)">\n                    <g id="artist-app-icon" transform="translate(28 295)">\n                        <rect id="bg" fill="#4999AD" x="0" y="0" width="23" height="23" rx="3"/>\n                        <path id="tent" fill="#FFF" d="M4 15.9l4.78-8.8h10.21l-4.77 8.8z"/>\n                    </g>\n                </g>\n            </g>\n        </g>\n    </g>\n    <path id="embed-icon" d="M16.9 2.3L22 6.97l-5.1 4.68c-.43.43-1 .43-1.43 0-.43-.43-.4-1.13.02-1.57l3.42-3.1-3.42-3.12a1.12 1.12 0 01-.02-1.56c.43-.43 1-.43 1.43 0zm-6.48 10.76c-.14.63-.62.98-1.2.87-.58-.12-.93-.72-.8-1.35L11.47.88c.14-.62.62-.97 1.2-.86.58.12.93.72.8 1.35l-2.8 10.77-.24.92zM5.1 2.3c.43-.43 1-.43 1.43 0 .43.43.43 1.13 0 1.56L3.1 6.97l3.44 3.11c.43.44.43 1.14 0 1.57-.42.43-1 .43-1.43 0L0 6.97 5.1 2.3z"/>\n    <path id="email-link" d="M0 2C0 .9.9 0 2 0h14a2 2 0 012 2v8a2 2 0 01-2 2H2a2 2 0 01-2-2V2zm16.06 9l.94-.9-4.7-4.55L17 1.9 16.06 1 9.24 6.47h-.48L1.94 1 1 1.9l4.7 3.65L1 10.09l.94.91 4.7-4.55 2.12 1.82h.48l2.11-1.82 4.7 4.55z"/>\n    <path id="reddit-share" d="M24 11.78a2.65 2.65 0 00-4.5-1.9 13.7 13.7 0 00-6.97-2.05l1.49-4.66 4.01.94v.05a2.17 2.17 0 004.34 0 2.17 2.17 0 00-4.2-.78l-4.32-1.02a.37.37 0 00-.44.25l-1.66 5.21c-2.83.03-5.4.8-7.3 2.03a2.64 2.64 0 10-3.13 4.2c-.06.28-.09.57-.09.86 0 3.9 4.8 7.09 10.72 7.09s10.72-3.18 10.72-7.1c0-.27-.03-.54-.08-.8A2.63 2.63 0 0024 11.78zM6.78 13.6a1.58 1.58 0 013.16 0 1.58 1.58 0 01-3.16 0zm9.06 4.66c-.8.8-2.05 1.18-3.83 1.18H12c-1.78 0-3.03-.38-3.83-1.18a.37.37 0 010-.52.37.37 0 01.53 0c.65.65 1.73.96 3.3.96H12c1.57 0 2.65-.31 3.3-.96a.37.37 0 01.53 0c.14.14.14.38 0 .52zm-.2-3.1c-.86 0-1.57-.7-1.57-1.57a1.58 1.58 0 013.16 0c0 .87-.71 1.58-1.58 1.58z"/>\n    <path id="copy-icon" d="M16.95 7.05a1 1 0 010 1.41l-8.48 8.49a1 1 0 11-1.42-1.41l8.49-8.49a1 1 0 011.4 0zm-5.8 10.04A4.2 4.2 0 0110 19.2l-1.66 1.65c-1.56 1.56-3.99 1.67-5.41.24-1.43-1.43-1.33-3.86.23-5.42L4.82 14c.6-.6 1.33-.98 2.09-1.14l1.93-1.94c-1.82-.3-3.83.3-5.31 1.79l-1.66 1.66c-2.35 2.34-2.5 5.98-.36 8.12 2.15 2.15 5.79 1.99 8.12-.35l1.66-1.66a6.14 6.14 0 001.79-5.32l-1.94 1.93zm3.22-15.23L12.7 3.52a6.14 6.14 0 00-1.79 5.32l1.94-1.93c.16-.76.54-1.49 1.14-2.1l1.66-1.65c1.56-1.56 3.99-1.66 5.42-.24 1.43 1.43 1.32 3.86-.24 5.42L19.18 10c-.6.6-1.33.98-2.08 1.14l-1.94 1.94c1.82.3 3.83-.3 5.32-1.78l1.66-1.67c2.34-2.34 2.5-5.97.35-8.12-2.14-2.14-5.78-1.98-8.12.35z"/>\n    <path id="share-icon" d="M6 17A15.24 15.24 0 0117 5.33V2l7 6.64-7 6.7V12s-6.17-.17-11 5zm12 .14V20H2V8h6.6a17 17 0 012.34-2H0v16h20v-6.77l-2 1.91z"/>\n\x3c!--hubs--\x3e\n    <g transform="translate(-1036 -601)" fill-rule="nonzero" stroke="#323232" id="hub-page-next" stroke-width="1" fill="none" stroke-linecap="round" stroke-linejoin="round">\n        <path d="M1052.17 602.15l11.62 10.63-11.62-10.63zm11.83 10.88L1052 624l12-10.97zm-.32-.13l-27.18.13 27.18-.13z" id="Combined-Shape"/>\n    </g>\n    <g transform="translate(-1036 -655)" fill-rule="nonzero" stroke="#323232" id="hub-page-prev" stroke-width="1" fill="none" stroke-linecap="round" stroke-linejoin="round">\n        <path d="M1052.17 656.15l11.62 10.63-11.62-10.63zm11.83 10.88L1052 678l12-10.97zm-.32-.13l-27.18.13 27.18-.13z" id="Combined-Shape" transform="matrix(-1 0 0 1 2100 0)"/>\n    </g>\n    <g transform="translate(-1036 -601)" fill-rule="nonzero" stroke="#FFF" id="hub-page-next-light" stroke-width="1" fill="none" stroke-linecap="round" stroke-linejoin="round">\n        <path d="M1052.17 602.15l11.62 10.63-11.62-10.63zm11.83 10.88L1052 624l12-10.97zm-.32-.13l-27.18.13 27.18-.13z" id="Combined-Shape"/>\n    </g>\n    <g transform="translate(-1036 -655)" fill-rule="nonzero" stroke="#FFF" id="hub-page-prev-light" stroke-width="1" fill="none" stroke-linecap="round" stroke-linejoin="round">\n        <path d="M1052.17 656.15l11.62 10.63-11.62-10.63zm11.83 10.88L1052 678l12-10.97zm-.32-.13l-27.18.13 27.18-.13z" id="Combined-Shape" transform="matrix(-1 0 0 1 2100 0)"/>\n    </g>\n    <g id="material-close">\n        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>\n        <path d="M0 0h24v24H0z" fill="none"/>\n    </g>\n    <g id="material-add">\n        <path d="M0 0h24v24H0z" fill="none"/>\n        <path d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>\n    </g>\n    <g id="material-arrow-fwd">\n        <path d="M0 0h24v24H0z" fill="none"/>\n        <path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/>\n    </g>\n    <g id="material-done">\n        <path fill="none" d="M0 0h24v24H0z"/>\n        <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>\n    </g>\n\x3c!--<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"></svg>--\x3e\n    <g id="material-queue">\n        <path d="M0 0h24v24H0z" fill="none"/>\n        <path d="M15 6H3v2h12V6zm0 4H3v2h12v-2zM3 16h8v-2H3v2zM17 6v8.18A3 3 0 1019 17V8h3V6h-5z"/>\n    </g>\n\x3c!--<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"></svg>--\x3e\n    <g id="material-vol-up">\n        <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3A4.5 4.5 0 0014 7.97v8.05A4.47 4.47 0 0016.5 12zM14 3.23v2.06a7 7 0 010 13.42v2.06a9 9 0 000-17.54z" id="Shape" fill="#333" fill-rule="nonzero"/>\n    </g>\n    <path fill="#333" d="M3 9v6h4l5 5V4L7 9z" id="material-vol-mute"/>\n    <g id="material-unlock">\n        <path d="M0 0h24v24H0z" fill="none"/>\n        <path d="M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6A5 5 0 007 6h1.9a3.1 3.1 0 016.2 0v2H6a2 2 0 00-2 2v10c0 1.1.9 2 2 2h12a2 2 0 002-2V10a2 2 0 00-2-2zm0 12H6V10h12v10z"/>\n    </g>\n\x3c!--<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 128 128" > <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#material-heart"></use> </svg>--\x3e\n    <path d="M25.75 36.06C10.4 51.72 18.82 70.11 41.2 90.41a249.17 249.17 0 0115.33 15.21c1.63 1.77 3.09 3.4 4.34 4.84.76.86 1.27 1.48 1.54 1.8l1.44 1.74 1.4-1.8 1.46-1.79A201.31 201.31 0 0185.85 90.4c23.11-21 31.63-39.47 15.27-54.3-11.46-10.04-22.82-8-32.73 1.29a44.91 44.91 0 00-4.78 5.28l-.1.13-.09-.13a41.46 41.46 0 00-4.48-5.45C53.8 32 48.12 29 42.04 29c-5.19 0-10.65 2.19-16.29 7.06z" id="material-heart"/>\n\x3c!--<svg width="16px" height="15px" viewBox="0 0 16 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">--\x3e\n    <g id="material-comment">\n        <path id="ic-comment" d="M14.93 0c.59 0 1.06.48 1.07 1.08v8.57c0 .59-.48 1.06-1.07 1.06H8V15l-4.27-4.29H1.07c-.59 0-1.06-.47-1.07-1.06V1.08C0 .48.48 0 1.07 0h13.86zM1.5 1.5V9.2h2.86l2.14 2.16V9.2h8V1.5h-13z"/>\n    </g>\n\x3c!--<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#material-keyboard-up"></use></svg>--\x3e\n    <g id="material-keyboard-up">\n        <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/>\n        <path d="M0 0h24v24H0z" fill="none"/>\n    </g>\n\x3c!--<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#material-keyboard-down"></use></svg>--\x3e\n    <g id="material-keyboard-down">\n        <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>\n        <path fill="none" d="M0 0h24v24H0V0z"/>\n    </g>\n    <defs>\n        <linearGradient id="pledge-processing-mask" x1="50%" x2="50%" y1="0%" y2="100%">\n            <stop offset="0%" stop-color="#F8E71C"/>\n            <stop offset="100%" stop-color="#4E8E25"/>\n        </linearGradient>\n    </defs>\n    <path d="M50.17 100.08l5.33 4.51c.49.69-.73 1.95-1.5 1.5l-8-7 8-7c.77-.44 1.99.82 1.5 1.5l-5.3 4.49a45 45 0 001.06-89.93l2.12-1.85a47 47 0 01-3.21 93.78zM45.46 6.12L40.1 1.59c-.48-.68.73-1.94 1.5-1.5l8 7-8 7c-.77.45-1.98-.81-1.5-1.5l5.29-4.47a45 45 0 00-1.03 89.9l-2.1 1.84a47 47 0 013.19-93.74zm1.14 71.27v-5.4a22.16 22.16 0 01-12.75-5.57l2.43-3.24c3.24 2.92 6.43 4.7 10.48 5.13v-13.5c-8-1.89-11.5-4.86-11.5-10.47v-.11c0-5.56 4.7-9.61 11.34-9.94v-3.13h3.45v3.24c4.05.38 7.18 1.9 10.32 4.32l-2.33 3.24c-2.59-2.21-5.29-3.4-8.15-3.89v13.29c8.2 1.89 11.66 5.02 11.66 10.47v.11c0 5.78-4.7 9.72-11.5 10.15v5.3H46.6zm.16-26.79V37.91c-4.54.16-7.35 2.76-7.35 6.05v.1c0 3.03 1.4 5.03 7.35 6.54zm3.13 17.88c4.59-.22 7.5-2.76 7.5-6.27v-.1c0-3.2-1.5-5.08-7.5-6.54v12.9z" transform="translate(0 .9)" id="pledge-processing"/>\n\x3c!--common icons--\x3e\n    <g id="help" fill="none" fill-rule="evenodd">\n        <rect width="15" height="15" fill="#B8B8B8" rx="7.5"/>\n        <path fill="#FFF" d="M6.57 9.8h1.72v1.7H6.57V9.8zM4.79 6.19c.01-.4.08-.76.2-1.1.14-.32.32-.6.55-.85.23-.24.5-.43.83-.57a3.45 3.45 0 012.4.01c.35.15.63.32.84.54a1.93 1.93 0 01.6 1.37 2.14 2.14 0 01-.93 1.86l-.47.35c-.15.11-.28.24-.4.39-.1.14-.18.33-.2.55v.42H6.7v-.5a2.25 2.25 0 01.54-1.34c.13-.15.27-.28.42-.39.14-.1.28-.22.4-.33.13-.1.23-.23.3-.36a.9.9 0 00.1-.5c0-.33-.07-.58-.24-.74a.94.94 0 00-.69-.24c-.2 0-.36.03-.5.11-.15.08-.27.18-.36.3-.1.14-.16.29-.2.46-.05.17-.07.36-.07.56H4.8z"/>\n    </g>\n    <g id="ic-add-video">\n        <path d="M88 32a8 8 0 018 8v19l24-24v69L96 80v16a8 8 0 01-8 8H16a8 8 0 01-8-8V40a8 8 0 018-8h72zM56 52h-8v12H36v8h12v12h8V72h12v-8H56V52z" id="ic-add-video"/>\n    </g>\n    <g id="ic-add-photo">\n        <path d="M104 8H88a8 8 0 00-8-8H32a8 8 0 00-8 8H8a8 8 0 00-8 8v56a8 8 0 008 8h96a8 8 0 008-8V16a8 8 0 00-8-8zM56 68a24 24 0 110-48 24 24 0 010 48zm4-40h-8v12H40v8h12v12h8V48h12v-8H60V28z" id="ic-add-photo"/>\n    </g>\n    <path fill="#1DA0C3" fill-rule="evenodd" d="M8.86 8.26H0L4.14.62H13L8.86 8.26" id="bc-logo-tent"/>\n\x3c!--<svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">--\x3e\n    <g id="contextual-dots" stroke="none" fill="none" fill-rule="evenodd">\n        <g transform="translate(7 17)" fill="#818285">\n            <circle cx="3" cy="3" r="3"/>\n            <circle cx="13" cy="3" r="3"/>\n            <circle cx="23" cy="3" r="3"/>\n        </g>\n        <path d="M0 0h40v40H0z"/>\n    </g>\n\x3c!--<svg width="128px" height="128px" viewBox="0 0 128 128" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">--\x3e\n    <g id="report-flag-icon">\n        <path fill="none" d="M0 0h128v128H0z"/>\n        <path d="M34.56 20v95.7h-7.9V20h7.9zm7.78 5.01s9.54-10 19.34 0c21.28 21.72 40.61-.65 40.61-.65v46.58s-19.33 22.37-40.61.65c-9.8-10-19.34 0-19.34 0z"/>\n    </g>\n\n    \n    \x3c!-- <svg id="icon-allow-comment" width="18px" height="18px" viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"></svg> --\x3e\n    <g id="allow-comment-icon">\n        <polygon points="15.981 3 6.573 13.501 2.708 9.635 2 10.342 6.614 14.956 16.726 3.668"></polygon>\n    </g>\n\n    \x3c!-- <svg class="live-calendar-icon" viewBox="0 0 12 11"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#live-calendar-icon"></use></svg> --\x3e\n    <g id="live-calendar-icon" fill="none" fill-rule="evenodd">\n        <g id="live-calendar-icon-stroke" transform="translate(-1033 -482)" stroke-width=".9">\n            <g id="component/event-card/4-col" transform="translate(744 209.5)">\n                <g id="Group" transform="translate(289 272)">\n                    <rect id="Rectangle" x=".45" y="2.65" width="10.73" height="8.36" rx="1.8"/>\n                    <path id="Path" d="M2.91.66v3.08M8.72.66v3.08"/>\n                    <path id="Path-4" d="M.83 5.67h10.8"/>\n                </g>\n            </g>\n        </g>\n    </g>\n\n    \x3c!-- <svg class="live-clock-icon" viewBox="0 0 12 11"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#live-clock-icon"></use></svg> --\x3e\n    <g id="live-clock-icon" fill="none" fill-rule="evenodd">\n        <g id="live-clock-icon-stroke" transform="translate(-1033 -499)" >\n            <g id="component/event-card/4-col" transform="translate(744 209.5)">\n                <g id="icon/clock" transform="translate(289 289)">\n                    <circle id="Oval" cx="6" cy="6.5" r="5.5"/>\n                    <path id="Path-5" d="M6 2.53V7h3.03"/>\n                </g>\n            </g>\n        </g>\n    </g>\n\n\n\n    \x3c!-- <svg id="icon-ban" width="18px" height="18px" viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"></svg> --\x3e\n    <g id="ban-user-icon">\n        <path d="M8.0002,0.0002 C3.5822,0.0002 0.0002,3.5822 0.0002,8.0002 C0.0002,12.4182 3.5822,16.0002 8.0002,16.0002 C12.4182,16.0002 16.0002,12.4182 16.0002,8.0002 C16.0002,3.5822 12.4182,0.0002 8.0002,0.0002 L8.0002,0.0002 Z M8.0002,1.0002 C11.8602,1.0002 15.0002,4.1402 15.0002,8.0002 C15.0002,11.8592 11.8602,15.0002 8.0002,15.0002 C4.1402,15.0002 1.0002,11.8592 1.0002,8.0002 C1.0002,4.1402 4.1402,1.0002 8.0002,1.0002 L8.0002,1.0002 Z M8.7072,8.0002 L11.6472,10.9402 L10.9402,11.6472 L8.0002,8.7072 L5.0592,11.6472 L4.3522,10.9402 L7.2922,8.0002 L4.3522,5.0592 L5.0592,4.3522 L8.0002,7.2932 L10.9402,4.3522 L11.6472,5.0592 L8.7072,8.0002 Z"></path>\n    </g>\n    \n\n    \x3c!-- <svg id="icon-delete-comment" fill-rule="evenodd" width="18px" height="18px" viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"></svg> --\x3e\n    <g id="delete-comment-icon" fill-rule="evenodd">\n        <path d="M10.5,14.518 L11.5,14.518 L11.5,5.37 L10.5,5.37 L10.5,14.518 Z M6.5,14.518 L7.5,14.518 L7.5,5.37 L6.5,5.37 L6.5,14.518 Z M4.017,16.002 L14.017,16.002 L14.017,3.887 L4.017,3.887 L4.017,16.002 Z M6.464,2.887 L11.536,2.887 L11.536,2 L6.464,2 L6.464,2.887 Z M14.001,2.887 L12.536,2.887 L12.536,1 L5.464,1 L5.464,2.887 L3.999,2.887 L1,2.887 L1,3.887 L3,3.887 L3,15.989 C3,16.541 3.447,16.988 3.999,16.988 L14.001,16.988 C14.553,16.988 15,16.541 15,15.989 L15,3.887 L17,3.887 L17,2.887 L14.001,2.887 Z"></path>\n    </g>\n\n    \x3c!-- <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"></svg> --\x3e\n    <g id="ic-edit">\n        <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n            <path d="m12.02 6.27 1.06-1.07a.56.56 0 0 0 .17-.41c0-.16-.06-.3-.17-.41l-1.36-1.36a.56.56 0 0 0-.4-.17c-.17 0-.31.06-.42.17L9.83 4.08l2.19 2.19zm-7.09 7.08L11.4 6.9 9.2 4.7l-6.45 6.46v2.18h2.18z"/>\n        </svg>\n    </g>\n\n    \x3c!-- <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"> --\x3e\n    <g id="ic-tooltip">\n        <path d="M8 15.06a6.55 6.55 0 0 0 5.74-3.28c.61-1.04.92-2.16.92-3.38a6.55 6.55 0 0 0-3.28-5.74A6.55 6.55 0 0 0 8 1.74c-1.2 0-2.33.3-3.36.92-1 .58-1.8 1.38-2.38 2.38a6.52 6.52 0 0 0-.92 3.36c0 1.2.3 2.33.92 3.36A6.55 6.55 0 0 0 8 15.06zm0-1.32a5.2 5.2 0 0 1-2.69-.73 5.18 5.18 0 0 1-1.92-1.92 5.2 5.2 0 0 1 0-5.38A5.18 5.18 0 0 1 5.31 3.8a5.2 5.2 0 0 1 5.38 0c.8.47 1.45 1.11 1.92 1.92a5.2 5.2 0 0 1 0 5.38A5.18 5.18 0 0 1 10.69 13a5.2 5.2 0 0 1-2.69.73zm.66-3.34c0-.33.1-.64.32-.93.11-.16.34-.38.67-.68.33-.3.56-.53.69-.73.2-.3.32-.64.32-1A2.72 2.72 0 0 0 8 4.4a2.72 2.72 0 0 0-2.66 2.66h1.32c0-.37.13-.68.4-.93.26-.26.58-.39.94-.39s.68.13.94.39c.27.25.4.56.4.93 0 .24-.07.46-.2.65-.1.14-.27.3-.5.48l-.6.48a2.19 2.19 0 0 0-.7 1.73h1.32zm0 2v-1.34H7.34v1.34h1.32z" fill="#999"/>\n    </g>\n\n    \x3c!-- <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"> --\x3e\n    <g id="ic-camera-small">\n        <path d="M9.21 5.93H7.57v1.65h-.93V5.93H5V5h1.64V3.36h.93V5h1.64v.93zm-2.13 3.1A3.57 3.57 0 0 1 3.53 5.5c0-1.94 1.6-3.54 3.55-3.54 1.93 0 3.54 1.6 3.54 3.54s-1.6 3.54-3.54 3.54zm6.2-7.86h-2.75C10.53.53 10 0 9.36 0H4.68C4.03 0 3.5.53 3.5 1.17H.76a.77.77 0 0 0-.76.76v7.43c0 .4.35.76.76.76h12.46c.4 0 .76-.35.76-.76V1.93c.11-.41-.24-.76-.7-.76z"/>\n    </g>\n\n    \x3c!-- <svg width="326" height="324" xmlns="http://www.w3.org/2000/svg"> --\x3e\n    <g id="ic-spinny">\n        <g transform="translate(0 2)" opacity=".99" fill="none" fill-rule="evenodd">\n            <circle fill="#A4A4A5" cx="161" cy="287" r="35"/>\n            <circle fill="#606463" cx="161" cy="35" r="35"/>\n            <circle fill="#D2D2D1" transform="rotate(90 35 161)" cx="35" cy="161" r="35"/>\n            <circle fill="#7C7F7E" transform="rotate(90 287 161)" cx="287" cy="161" r="35"/>\n            <circle fill="#BBBAB9" transform="rotate(45 71.9 250.1)" cx="71.9" cy="250.1" r="35"/>\n            <circle fill="#717474" transform="rotate(45 250.1 71.9)" cx="250.1" cy="71.9" r="35"/>\n            <circle fill="#DCDCDC" transform="rotate(135 71.9 71.9)" cx="71.9" cy="71.9" r="35"/>\n            <circle fill="#8D8F8F" transform="rotate(135 250.1 250.1)" cx="250.1" cy="250.1" r="35"/>\n        </g>\n    </g>\n    \x3c!-- <svg class="arrow" viewBox="0 0 24 24"><use href="#discover-arrow"></svg> --\x3e\n    <path id="discover-arrow" d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>\n    <g id="fan-app-icon" fill="none" fill-rule="evenodd">\n        <rect fill="#FFF" width="23" height="23" rx="3"/>\n        <path fill="url(#fanAppGradient)" d="M4 15.9l4.78-8.8h10.21l-4.77 8.8z"/>\n    </g>\n\n    \x3c!-- <svg width="22px" height="15px" viewBox="0 0 22 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> --\x3e\n    <g id="view-eyeball-icon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="adminControls---OFF-AIR-Copy" transform="translate(-823.000000, -743.000000)">\n            <g id="component/video/sound-check" transform="translate(134.000000, 222.000000)">\n                <g id="Group" transform="translate(689.000000, 521.000000)">\n                    <g transform="translate(0.000000, 0.000000)" id="Oval">\n                        <circle fill="currentColor" cx="11" cy="7.28" r="3"></circle>\n                        <path d="M11,1 C15.6667595,1 19.5502286,5.64619254 20.7714147,7.28017631 C19.5496534,8.91449561 15.6664139,13.56 11,13.56 C6.33324048,13.56 2.44977141,8.91380746 1.22858526,7.27982369 C2.45034662,5.64550439 6.33358609,1 11,1 Z" stroke="currentColor" stroke-width="2"></path>\n                    </g>\n                </g>\n            </g>\n        </g>\n    </g>\n\n    <path id="check" fill="none" stroke-width="1.5" d="M1.5 6.5l4 5 8-11" />\n    <g id="two-person-silhouette">\n        <path d=\'M12.81 8.64c-.244-.359-.808-.605-1.858-.986-1.046-.38-1.38-.701-1.38-1.388 0-.412.32-.277.46-1.032.058-.313.34-.005.394-.72 0-.285-.154-.357-.154-.357s.078-.42.109-.745c.037-.404-.042-1.579-1.494-1.579S6.971 3.008 7.01 3.413c.03.323.108.744.108.744s-.154.072-.154.357c.054.715.336.407.394.72.14.755.46.62.46 1.032 0 .467-.156.765-.583 1.027 2.284.995 2.24 1.2 2.24 2.09V11H13s-.028-2.12-.19-2.36zm-6.046-.7c-1.308-.518-1.726-.954-1.726-1.888 0-.56.399-.378.574-1.404.072-.426.426-.007.493-.98 0-.387-.192-.484-.192-.484s.098-.573.136-1.014C6.097 1.62 5.676 0 3.859 0 2.044 0 1.782 1.62 1.83 2.17c.039.441.136 1.014.136 1.014s-.192.097-.192.484c.067.973.42.554.493.98.175 1.026.575.843.575 1.404 0 .934-.418 1.37-1.727 1.887C.717 8.097 0 8.213 0 8.8V11h8.821V9.35c0-.536-.745-.892-2.057-1.41z\' />\n    </g>\n</svg>\n\n']}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_action_pane.liquid","warn"):Templ.register({"fan/signup/fan_action_pane":['<form id="signup-vm" class=\'action-form modern-form signup-common-form\' data-bind=\'css: { "visible": visible }, submit: openSignup\' novalidate>\n    <a id="signup-anchor"></a>\n    <div class="signup-common-inner">\n        ',{type:"case",blocks:[{type:"condition",left:"action",right:"'wishlist'",operator:"==",attachment:["\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"action_item_type == 'a' || action_item_type == 'album' ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:["\n                    ",{type:"translate",nodelist:["To wishlist this album, please sign up for a free Bandcamp account (or log in if you already have one)"]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["To wishlist this album, please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp account (or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> if you already have one)"]},"\n                "]}]},"\n            "]},{type:"ncondition",expression:"action_item_type == 't' || action_item_type == 'track' ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:["\n                    ",{type:"translate",nodelist:["To wishlist this track, please sign up for a free Bandcamp account (or log in if you already have one)"]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["To wishlist this track, please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp account (or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> if you already have one)"]},"\n                "]}]},"\n            "]}]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'follow'",operator:"==",attachment:["\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"action_item_type == 'b' || !action_item_type ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:["\n                    ",{type:"translate",nodelist:["To follow this artist, please sign up for a free Bandcamp account (or log in if you already have one)"]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["To follow this artist, please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp account (or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> if you already have one)"]},"\n                "]}]},"\n            "]},{type:"ncondition",expression:"action_item_type == 'f' ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:["\n                    ",{type:"translate",nodelist:["To follow this fan, please sign up for a free Bandcamp account (or log in if you already have one)"]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["To follow this fan, please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp account (or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> if you already have one)"]},"\n                "]}]},"\n            "]},{type:"ncondition",expression:"action_item_type == 'g' ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:["\n                    ",{type:"translate",nodelist:["To follow this genre, please sign up for a free Bandcamp account (or log in if you already have one)"]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["To follow this genre, please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp account (or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> if you already have one)"]},"\n                "]}]},"\n            "]}]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'live_ticket'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> to continue your live ticket purchase."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'live_attend'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> to join this live stream."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'live_attend_immediate'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> to join this live stream."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'live_chat'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> to chat."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'gift_cards'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> to continue your gift card purchase."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'gift_cards_verify'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> to continue your gift card purchase."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'redeem'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["To finish redeeming your gift card, please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp account (or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> if you already have one)."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'change_pledge'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["To change your pledge, please <a ",{type:"translateVariable",var_name:"signup_attr",nodelist:['class="crowdfunding-signup-login-link" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp fan account (or <a ",{type:"translateVariable",var_name:"login_attr",nodelist:['class="crowdfunding-signup-login-link" data-bind="click: openLogin"']},">log in</a> if you already have one)"]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'update_pledge_payment'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["To update your payment info, please <a ",{type:"translateVariable",var_name:"signup_attr",nodelist:['class="crowdfunding-signup-login-link" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp fan account (or <a ",{type:"translateVariable",var_name:"login_attr",nodelist:['class="crowdfunding-signup-login-link" data-bind="click: openLogin"']},">log in</a> if you already have one)"]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'update_pledge_address'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["To change your address, please <a ",{type:"translateVariable",var_name:"signup_attr",nodelist:['class="crowdfunding-signup-login-link" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp fan account (or <a ",{type:"translateVariable",var_name:"login_attr",nodelist:['class="crowdfunding-signup-login-link" data-bind="click: openLogin"']},">log in</a> if you already have one)"]},"\n        "],child_relation:null,child_condition:null}]},'\n\n        <div class="buttons">\n            <button class="signup" type="submit" data-bind="click: openSignup">\n                ',{type:"translate",nodelist:["Sign up"]},'\n            </button>\n            <button class="login" type="submit" data-bind="click: openLogin">\n                ',{type:"translate",nodelist:["Log in"]},"\n            </button>\n        </div>\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/search_tooltip.liquid","warn"):Templ.register({"fan/tooltips/search_tooltip":[{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:['\n<div class="',{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:["inner-circle-wrapper"]}]},'">\n    <div class="inner-circle"></div>\n</div>\n</div>\n']}]},'\n<div class="signup-tooltip search-tooltip">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        <div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:["\n            ",{type:"translate",nodelist:["Search Bandcamp by artist, album or track. Browse music by genre, format, and more."]},"\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"translate",nodelist:["You can search Bandcamp by artist, album or track."]},"\n        "]}]},'\n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/feed_tooltip.liquid","warn"):Templ.register({"fan/tooltips/feed_tooltip":['<div class="',{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:["inner-circle-wrapper"]}]},'">\n    <div class="inner-circle"></div>\n    <div class="inner-circle-contents">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:['\n        <a href="',{type:"variable",name:"fan_onboarding.feed_url",filters:[["a",[]]]},'">\n            <svg width="26px" height="26px" class="svg-icon"><use xlink:href="#menubar-feed-icon"></svg>\n        </a>\n    ']},{type:"else_ncondition",attachment:['\n        <a class="dismiss-tooltip-alt" href="',{type:"variable",name:"fan_onboarding.feed_url",filters:[["a",[]]]},'">',{type:"translate",nodelist:["feed"]},"</a>\n    "]}]},'\n    </div>\n</div>\n\n<div class="signup-tooltip feed-tooltip',{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:["-header-2018"]}]},'">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        <div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>\n\n        ",{type:"translate",nodelist:["Check your feed for new music in your favorite genres and from artists you follow."]},'\n\n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/discover_tooltip.liquid","warn"):Templ.register({"fan/tooltips/discover_tooltip":['<div>\n    <div class="inner-circle"></div>\n    <div class="inner-circle-contents">\n        <a class="dismiss-tooltip-alt" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/#discover">',{type:"translate",nodelist:["discover"]},'</a>\n    </div>\n</div>\n\n<div class="signup-tooltip discover-tooltip">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        <div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>\n        ",{type:"translate",nodelist:["Discover lets you browse music by genre, format, and more."]},'\n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/follow_tooltip.liquid","warn"):Templ.register({"fan/tooltips/follow_tooltip":['<div class="signup-tooltip follow-tooltip">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.num_tooltips > 1 ",attachment:['<div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>"]}]},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.band_name.length > 26 ",attachment:["\n            ",{type:"translate",nodelist:['You’re now following this artist and your email has been added to their mailing list (to undo, click "Following").']},"\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"translate",nodelist:["You’re now following ",{type:"translateVariable",var_name:"bandname",nodelist:[{type:"variable",name:"fan_onboarding.band_name",filters:[["h",[]],["truncate",["26"]]]}]},' and your email has been added to their mailing list (to undo, click "Following").']},"\n        "]}]},'\n        \n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/genre_follow_tooltip.liquid","warn"):Templ.register({"fan/tooltips/genre_follow_tooltip":['<div class="signup-tooltip follow-tooltip">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.num_tooltips > 1 ",attachment:['<div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>"]}]},"\n\n        ",{type:"translate",nodelist:["You’re now following ",{type:"translateVariable",var_name:"tagname",nodelist:[{type:"variable",name:"fan_onboarding.tag_name",filters:[["h",[]],["truncate",["26"]]]}]},", which means you’ll get updates about the best releases from this genre in your feed."]},'\n        \n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/wishlist_tooltip.liquid","warn"):Templ.register({"fan/tooltips/wishlist_tooltip":['<div class="',{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:["inner-circle-wrapper"]}]},'">\n    <div class="inner-circle"></div>\n    <div class="inner-circle-contents">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:['\n            <a class="dismiss-tooltip-alt" ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.wishlist_url ",attachment:['href="',{type:"variable",name:"fan_onboarding.wishlist_url",filters:[["a",[]]]},'"']}]},'><svg width="26px" height="26px" class="svg-icon"><use xlink:href="#menubar-collection-icon"></svg></a>\n        ']},{type:"else_ncondition",attachment:['\n            <a class="dismiss-tooltip-alt" ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.wishlist_url ",attachment:['href="',{type:"variable",name:"fan_onboarding.wishlist_url",filters:[["a",[]]]},'"']}]},">",{type:"translate",nodelist:["wishlist"]},"</a>\n        "]}]},'\n    </div>\n</div>\n\n<div class="signup-tooltip wishlist-tooltip">\n\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.num_tooltips > 1 ",attachment:['\n            <div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>"]}]},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.first_wishlisted_item_title.length > fan_onboarding.first_wishlist_item_title_length ",attachment:["\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.first_wishlisted_item_type == 't' ",attachment:["\n                ",{type:"translate",nodelist:["This track is now in your wishlist."]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["This album is now in your wishlist."]},"\n            "]}]},"\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"translate",nodelist:["",{type:"translateVariable",var_name:"album_title",nodelist:[{type:"variable",name:"fan_onboarding.first_wishlisted_item_title",filters:[["h",[]],["truncate",["26"]]]}]}," is now in your wishlist."]},"\n        "]}]},'\n\n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/wishlist_button_tooltip.liquid","warn"):Templ.register({"fan/tooltips/wishlist_button_tooltip":['<div>\n    <div class="inner-circle"></div>\n    <div class="inner-circle-contents">\n        <div class="tralbum-wishlist-link">\n            <a class="dismiss-tooltip-alt" ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.wishlist_url ",attachment:['href="',{type:"variable",name:"fan_onboarding.wishlist_url",filters:[["a",[]]]},'"']}]},">",{type:"translate",nodelist:["view"]},'</a>\n        </div>\n\n        <div class="collection-wishlist-link">\n            <span>\n                <span>\n                    <span class="bc-ui2 collect-item-icon trigger"></span>\n                    <span class="text trigger"><a>',{type:"translate",nodelist:["in wishlist"]},'</a></span>\n                </span>\n                <span class="view"><a target="_blank" href="',{type:"variable",name:"fan_onboarding.wishlist_url",filters:[["a",[]]]},'">&raquo;</a></span>\n            </span>\n        </div>\n    </div>\n</div>\n\n<div class="signup-tooltip wishlist-button-tooltip">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        <div class="signup-tooltip-body">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.num_tooltips > 1 ",attachment:['\n                <div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>\n            "]}]},"\n\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.first_wishlisted_item_title.length > 26 ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.first_wishlisted_item_type == 't' ",attachment:["\n                    ",{type:"translate",nodelist:["This track is now in your wishlist."]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["This album is now in your wishlist."]},"\n                "]}]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["",{type:"translateVariable",var_name:"album_title",nodelist:[{type:"variable",name:"fan_onboarding.first_wishlisted_item_title",filters:[["h",[]],["truncate",["26"]]]}]}," is now in your wishlist."]},"\n            "]}]},'\n        </div>\n\n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/fan_follow_tooltip.liquid","warn"):Templ.register({"fan/tooltips/fan_follow_tooltip":['<div class="following-button-wrapper">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.origin_page == 'home' ",attachment:['\n        <a class="follow-fan-btn-inactive">\n            <span class="following-msg">',{type:"translate",nodelist:["Following"]},"</span>\n        </a>\n    "]},{type:"else_ncondition",attachment:['\n        <button type="button" class="follow-unfollow-inactive following">\n            <span class="plus">\n            <svg class="icon follow-plus" width="10px" height="10px" viewBox="0 0 8 8"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#follow-plus"></use></svg>\n            </span>\n            <span class="checkmark">\n            <svg class="icon following-checkmark" width="14px" height="12px" viewBox="0 0 14 10"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#following-checkmark"></use></svg>\n            </span>\n            <div class="following-msg">',{type:"translate",nodelist:["Following"]},"</div>\n        </button>\n    "]}]},'\n</div>\n\n<div class="signup-tooltip fan-follow-tooltip">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.num_tooltips > 1 ",attachment:['<div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>"]}]},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.fan_name.length > 26 || !fan_onboarding.fan_name ",attachment:["\n            ",{type:"translate",nodelist:["You’re now following this fan, which means you’ll get updates about their activity in your feed."]},"\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"translate",nodelist:["You’re now following ",{type:"translateVariable",var_name:"bandname",nodelist:[{type:"variable",name:"fan_onboarding.fan_name",filters:[["h",[]],["truncate",["26"]]]}]},", which means you’ll get updates about their activity in your feed."]},"\n        "]}]},'\n\n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/collection_tooltip.liquid","warn"):Templ.register({"fan/tooltips/collection_tooltip":['<div>\n    <div class="inner-circle"></div>\n    <div class="inner-circle-contents">\n        <a class="dismiss-tooltip-alt" ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.collection_url ",attachment:['href="',{type:"variable",name:"fan_onboarding.collection_url",filters:[["a",[]]]},'"']}]},'>\n            <svg width="26" height="26" viewBox="0 0 26 26" class="svg-icon"><use xlink:href="#menubar-collection-icon"></svg>\n        </a>\n    </div>\n</div>\n\n<div class="signup-tooltip collection-tooltip">\n\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.num_tooltips > 1 ",attachment:['\n            <div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>"]}]},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"!fan_onboarding.first_purchased_item_title || fan_onboarding.first_purchased_item_title.length > 26 ",attachment:["\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.first_purchased_item_title == 't' ",attachment:["\n                ",{type:"translate",nodelist:["This track is now in your collection."]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["This album is now in your collection."]},"\n            "]}]},"\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"translate",nodelist:["",{type:"translateVariable",var_name:"album_title",nodelist:[{type:"variable",name:"fan_onboarding.first_purchased_item_title",filters:[["h",[]],["truncate",["16"]]]}]}," is now in your collection."]},"\n        "]}]},'\n\n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/menubar.liquid","warn"):Templ.register({menubar:["\n\n\n\n",{type:"let",variable:"has_full_access",expression:"!menubar.force_no_control && (page_identities.is_page_band_member || page_identities.is_admin) "},"\n",{type:"let",variable:"has_limited_access",expression:"page_identities.page_band_parent_label_id && !page_identities.page_band.authed "},"\n",{type:"let",variable:"has_access",expression:"has_full_access || has_limited_access "},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.bands.length >= 1 ",attachment:["\n    ",{type:"let",variable:"b",expression:"page_identities.bands[0] "},"\n    ",{type:"let",variable:"artistsmenu_title",expression:"b.name "},"\n    ",{type:"let",variable:"artistsmenu_show_photo",expression:"true "},"\n    ",{type:"let",variable:"artistsmenu_photo",expression:"b.photo "},"\n    ",{type:"let",variable:"artistsmenu_show_pro",expression:"b.is_pro "},"\n"]},{type:"else_ncondition",attachment:["\n    ",{type:"capture",to:"artistsmenu_title",nodelist:[{type:"translate",nodelist:["artists"]}]},"\n    ",{type:"let",variable:"artistsmenu_show_photo",expression:"false "},"\n    ",{type:"let",variable:"artistsmenu_photo",expression:"nil "},"\n    ",{type:"let",variable:"artistsmenu_show_pro",expression:"menubar.any_pro "},"\n"]}]},"\n\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.page_band && has_full_access ",attachment:["\n    ",{type:"let",variable:"hide_unless_has_full_access",expression:'"" '},"\n"]},{type:"else_ncondition",attachment:["\n    ",{type:"let",variable:"hide_unless_has_full_access",expression:'"hidden-while-loading" '},"\n"]}]},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.page_band && has_access ",attachment:["\n    ",{type:"let",variable:"hide_unless_has_access",expression:'"" '},"\n    ",{type:"let",variable:"hide_if_has_access",expression:'"hidden-while-loading" '},"\n"]},{type:"else_ncondition",attachment:["\n    ",{type:"let",variable:"hide_unless_has_access",expression:'"hidden-while-loading" '},"\n    ",{type:"let",variable:"hide_if_has_access",expression:'"" '},"\n"]}]},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.page_band && page_identities.page_band.is_label && has_full_access ",attachment:["\n    ",{type:"let",variable:"hide_if_not_logged_in_label",expression:'"" '},"\n    ",{type:"let",variable:"hide_if_logged_in_label",expression:'"hidden-while-loading" '},"\n"]},{type:"else_ncondition",attachment:["\n    ",{type:"let",variable:"hide_if_not_logged_in_label",expression:'"hidden-while-loading" '},"\n    ",{type:"let",variable:"hide_if_logged_in_label",expression:'"" '},"\n"]}]},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.page_band && page_identities.page_band.is_label && menubar.artist_subscriptions_enabled ",attachment:["\n    ",{type:"ef",blocks:[{type:"ncondition",expression:'menubar.unshipped_order_count == "async" ',attachment:["\n        ",{type:"let",variable:"wide",expression:"false "},"\n        ",{type:"let",variable:"extra_wide",expression:"true "},"\n    "]},{type:"else_ncondition",attachment:["\n        ",{type:"let",variable:"wide",expression:"true "},"\n        ",{type:"let",variable:"extra_wide",expression:"false "},"\n    "]}]},"\n"]},{type:"ncondition",expression:"!hide_search && page_identities.fan ",attachment:["\n        ",{type:"let",variable:"wide",expression:"false "},"\n        ",{type:"let",variable:"extra_wide",expression:"true "},"\n"]},{type:"else_ncondition",attachment:["\n    ",{type:"let",variable:"wide",expression:"false "},"\n    ",{type:"let",variable:"extra_wide",expression:"false "},"\n"]}]},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"!cfg.header_rework_2018 && page_identities.bands.length > 0 && page_identities.fan ",attachment:["\n    ",{type:"let",variable:"show_balance_number",expression:"false "},"\n"]},{type:"else_ncondition",attachment:["\n    ",{type:"let",variable:"show_balance_number",expression:"true "},"\n"]}]},'\n\n<div id="menubar-vm" class="menubar-outer loading" data-initial-values="',{type:"variable",name:"menubar",filters:[["json",[]],["a",[]]]},'">\n<div id="menubar"\n    class="\n        menubar-2018\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"(!page_identities.page_band || menubar.force_no_control) && (!has_full_access || (is_admin && page_identities.page_band != 0)) ",attachment:["out"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"wide ",attachment:["wide"]}]},"\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"extra_wide ",attachment:["extra-wide"]}]},"\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"is_admin_impersonating ",attachment:["admin-impersonating"]}]},'\n    "\n>\n<ul id="site-nav" class="menubar-section horizontal" data-test="site-nav">\n\n    \n    <li class="bclogo white" data-test="mb-bandcamp-logo"><a href="',{type:"variable",name:"siteroot_current",filters:[["a",[]]]},"/?from=",{type:"ef",blocks:[{type:"ncondition",expression:"!(page_identities.user) ",attachment:["menubar_logo_logged_out"]},{type:"else_ncondition",attachment:["menubar_logo_logged_in"]}]},'"><svg width="108px" height="17px" viewBox="0 0 127 20"><use xlink:href="#bandcamp-logo-color-white"></svg></a></li>\n    <li class="bclogo aqua" data-test="mb-bandcamp-logo"><a href="',{type:"variable",name:"siteroot_current",filters:[["a",[]]]},"/?from=",{type:"ef",blocks:[{type:"ncondition",expression:"!(page_identities.user) ",attachment:["menubar_logo_logged_out"]},{type:"else_ncondition",attachment:["menubar_logo_logged_in"]}]},'"><svg width="108px" height="17px" viewBox="0 0 127 20"><use xlink:href="#bandcamp-logo-color-bcaqua"></svg></a></li>\n\n\n    \x3c!-- ko if: showBandControls() || showLimitedAccessControls() --\x3e\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"menubar.show_dashboard_link ",attachment:['\n    <li class="menubar-item hoverable ',{type:"variable",name:"hide_unless_has_access",filters:[]},'" data-test="mb-dashboard">\n        <a data-bind="attr: {href: dashboardLinkHref()}">',{type:"translate",nodelist:["dashboard"]},'</a>\n    </li>\n    <li class="tralbum-tooltip-parent dash-link" data-bind="css: {\'show-tooltip\': dashboardTooltipVM().showing}">\n        <div class="tralbum-tooltip-outer">\n            <div class="inner-circle-wrapper">\n                <div class="inner-circle"></div>\n                <div class="inner-circle-contents">\n                    <a class="tooltip-action" data-bind="click: dashboardTooltipVM().close, attr: {href: dashboardLinkHref()}, text: dashboardTooltipVM().centralText"></a>\n                </div>\n            </div>\n            <div class="tralbum-tooltip">\n                <div class="tralbum-tooltip-inner">\n                    <span class="progress" data-bind="text: dashboardTooltipVM().progress"></span>\n                    <span data-bind="text: dashboardTooltipVM().tipText"></span>\n                    <a class="dismiss-tooltip" data-bind="click: dashboardTooltipVM().continueTips, text: dashboardTooltipVM().closeText"></a>\n                </div>\n            </div>\n        </div>\n    </li>\n    ']}]},'\n    <li class="menubar-item hoverable ',{type:"variable",name:"hide_unless_has_access",filters:[]},' add-menu" data-test="mb-add">\n        <a class="menubar-add-link">',{type:"translate",nodelist:["+ add"]},'</a>\n        <ul class="menu hidden-while-loading">\n            \n            \x3c!-- ko if: showBandControls() || showLimitedAccessControls() --\x3e\n            <ol data-bind="css: {\'page-band-links\': pageBand.isLabel()}">\n                <li class="submenu-item" data-test="mb-add-album"><a data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/edit_album\'}, click: addAlbumClick">',{type:"translate",nodelist:["album"]},'</a></li>\n                <li class="submenu-item" data-test="mb-add-track"><a data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/edit_track\'}, click: addTrackClick">',{type:"translate",nodelist:["track"]},'</a></li>\n                <li class="submenu-item"data-test="mb-add-merch"><a id="menubar-add-merch-link" data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/edit_merch\'}, click: addMerchClick"><span class="add-music">',{type:"translate",nodelist:["merch"]},"</span></a></li>\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.show_crowdfunding_link ",attachment:['\n                    <li class="submenu-item" data-test="mb-add-vinyl"><a id="menubar-add-merch-link" data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/edit_vinyl_campaign\'}"><span class="add-music">',{type:"translate",nodelist:["vinyl campaign"]},"</span></a></li>\n                "]}]},"\n\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.show_add_live_show ",attachment:['\n                    <li class="submenu-item" data-test="mb-add-livestream"><a data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/edit_live_show\'}, click: addLiveEventClick">',{type:"translate",nodelist:["live stream"]},"</a></li>\n                "]}]},"\n\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.show_add_listening_party ",attachment:['\n                    <li class="submenu-item" data-test="mb-add-listening-party"><a data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/edit_listening_party\'}, click: addListeningPartyClick">',{type:"translate",nodelist:["listening party"]},"</a></li>\n                "]}]},'\n            </ol>\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: showBandControls() && pageBand.isLabel() --\x3e\n            <ol>\n                <li class="ui-widget-content ui-menu-divider"></li>\n                <li class="submenu-item"><a data-bind="click: addNewArtist">',{type:"translate",nodelist:["new artist"]},'</a></li>\n                <li class="submenu-item"><a data-bind="click: addExistingArtist">',{type:"translate",nodelist:["existing artist"]},"</a></li>\n            </ol>\n            \x3c!-- /ko --\x3e\n        </ul>\n    </li>\n    \x3c!-- /ko --\x3e\n\n    \n\n    \x3c!-- ko if: showBandControls() || showLimitedAccessControls() --\x3e\n    \n    ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.unshipped_order_count ",attachment:['\n        <li class="menubar-item hoverable ',{type:"variable",name:"hide_unless_has_access",filters:[]},'">\n            <a data-bind="attr: {href: ordersLinkHref}">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"menubar.unshipped_order_count == 0 ",attachment:["\n                    ",{type:"translate",nodelist:["orders"]},"\n                "]},{type:"else_ncondition",attachment:['\n                    <span class="menubar-async-order-count">\n                        <span class="unshipped-order-count-value-wrapper">\n                            <span class="unshipped-order-count-value order-count-loading"></span>\n                        </span>\n                        <span class="unshipped-order-count-label">',{type:"translate",nodelist:["orders"]},"</span>\n                    </span>\n                "]}]},"\n            </a>\n        </li>\n    "]}]},'\n\n    \n        <li class="menubar-item hoverable ',{type:"variable",name:"hide_unless_has_access",filters:[]},'" data-test="mb-stats">\n            <a data-bind="attr: {href: statsLinkHref2018}">',{type:"translate",nodelist:["stats"]},"</a>\n        </li>\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.artist_subscriptions_enabled ",attachment:['\n        <li class="menubar-item ',{type:"ef",blocks:[{type:"ncondition",expression:"menubar.artist_service_active ",attachment:["hoverable"]}]},'" data-test="mb-subscriptions">\n        \x3c!-- ko if: pageBand.hasService() --\x3e\n            <a><span class="subscription-name add-music has-children ',{type:"variable",name:"hide_unless_has_access",filters:[]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"!menubar.artist_service_active ",attachment:["hidden-while-loading"]}]},'">',{type:"translate",nodelist:["subscription"]},'</span></a>\n            <ul class="menu subscription-menu">\n                <li class="submenu-item"><a data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/\' + pageBand.serviceUrlFragment() + \'?from=menubar\'}"><strong data-bind="text: pageBand.serviceName">',{type:"variable",name:"menubar.artist_service_name",filters:[["h",[]]]},'</strong></a></li> \x3c!-- clairenote artist_service_name is for pageartist artist_service_has_subscribers too--\x3e\n                <li class="submenu-item"><a data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/edit_subscription?from=menubar\'}">',{type:"translate",nodelist:["edit"]},'</a></li>\n                <li class="',{type:"ef",blocks:[{type:"ncondition",expression:"!menubar.artist_service_has_subscribers ",attachment:["ui-state-disabled"]}]},' submenu-item">\n                    <a ',{type:"ef",blocks:[{type:"ncondition",expression:"menubar.artist_service_has_subscribers ",attachment:["data-bind=\"attr: {href: pageBand.trackpipeLocalUrl() + '/subscribers?from=menubar'}\""]}]},">",{type:"translate",nodelist:["subscribers"]},'</a>\n                </li>\n                <li class="submenu-item">\n                    <a data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/community?from=menubar\'}">',{type:"translate",nodelist:["message subscribers"]},"</a>\n                </li>\n            </ul>\n        \x3c!-- /ko --\x3e\n        </li>\n    "]}]},"\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.live_events ",attachment:['\n        <li class="menubar-item hoverable" data-test="mb-livestreams">\n            <a><span class="add-music has-children ',{type:"variable",name:"hide_unless_has_access",filters:[]},'">',{type:"ef",blocks:[{type:"ncondition",expression:"menubar.show_add_listening_party ",attachment:[{type:"translate",nodelist:["live"]}]},{type:"else_ncondition",attachment:[{type:"translate",nodelist:["live streams"]}]}]},'</span></a>\n            <ul class="menu live-menu">\n                <ol class="live-events">\n                    \x3c!-- ko if: artistsMenu.liveEvents().drafts.length --\x3e\n                        <li class="submenu-label" data-test="mb-livestreams-drafts"><b>',{type:"translate",nodelist:["draft events"]},'</b></li>\n                        <ol data-bind="foreach: { data: artistsMenu.liveEvents().drafts, as: \'event\' }">\n                            <li class="submenu-item">\n                                <a data-bind="text: event.title, attr: { href: event.url }"></a>\n                            </li>\n                        </ol>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko if: artistsMenu.liveEvents().upcoming.length --\x3e\n                        <li class="submenu-label" data-test="mb-livestreams-upcoming"><b>',{type:"translate",nodelist:["upcoming events"]},'</b></li>\n                        <ol data-bind="foreach: { data: artistsMenu.liveEvents().upcoming, as: \'event\' }">\n                            <li class="submenu-item"><a data-bind="text: event.title, attr: { href: event.url }"></a></li>\n                        </ol>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko if: artistsMenu.liveEvents().past.length --\x3e\n                        <li class="submenu-label" data-test="mb-livestreams-past"><b>',{type:"translate",nodelist:["past events"]},'</b></li>\n                        <ol data-bind="foreach: { data: artistsMenu.liveEvents().past, as: \'event\' }">\n                            <li class="submenu-item"><a data-bind="text: event.title, attr: { href: event.url }"></a></li>\n                        </ol>\n                    \x3c!-- /ko --\x3e\n                </ol>\n            </ul>\n        </li>\n    ']}]},"\n\n    \x3c!-- /ko --\x3e\n    \x3c!-- ko ifnot: showBandControls() || showLimitedAccessControls() --\x3e\n    \x3c!-- ko ifnot: showMobileAutocomplete() --\x3e\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"!hide_search ",attachment:['\n        <li id="main-search-container" class="search extended menubar-item ',{type:"variable",name:"hide_if_has_access",filters:[]},'" data-test="mb-search-box">\n            ',{type:"include",template_name:"'_autocomplete_responsive_widget'"},"\n        </li>\n    "]}]},'\n    \x3c!-- /ko --\x3e\n    \x3c!-- /ko --\x3e\n</ul>\n\n<ul id="user-nav" class="menubar-section horizontal">\n\x3c!-- ko if: user() --\x3e\n\n    \n    \x3c!-- ko if: partner() --\x3e\n    <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!page_identities.partner ",attachment:["hidden-while-loading"]}]},'">\n        <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/partner">',{type:"translate",nodelist:["partner"]},"</a>\n    </li>\n    \x3c!-- /ko --\x3e\n\n    \x3c!-- ko if: showBandControls() || showLimitedAccessControls() --\x3e\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"!hide_search ",attachment:['\n        \n        \n        \x3c!-- ko ifnot: showMobileAutocomplete() --\x3e\n        \x3c!-- ko if: altSearch() --\x3e\n        <li id="alt-search-container" class="search extended menubar-item ',{type:"variable",name:"hide_if_has_access",filters:[]},' hidden-while-loading" data-bind="visible: altSearch()">\n            ',{type:"include",template_name:"'_autocomplete_responsive_widget'"},'\n        </li>\n        \x3c!-- /ko --\x3e\n        \n        <li class="you-autocomplete-me menubar-item ',{type:"variable",name:"hide_unless_has_access",filters:[]},' hoverable" data-bind="click: showAltSearch, visible: !altSearch()">\n            <a><svg width="26px" height="26px" viewBox="0 0 26 26" class="svg-icon"><use xlink:href="#menubar-search-icon"></svg></a>\n        </li>\n        \x3c!-- /ko --\x3e\n    ']}]},"\n    \x3c!-- /ko --\x3e \x3c!-- claire minimized search for artist --\x3e\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"has_corp_header ",attachment:["\n        ",{type:"include",template_name:"'corp_hiring_banner'"},"\n    "]}]},"\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.gift_card_balance ",attachment:['\n    <li class="menubar-item hoverable menubar-gift-card-balance">\n        <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/redeem">\n            <svg class="icon gift-card-icon-bordered" width="9px" height="10px" viewBox="0 0 9 10"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#gift-card-icon"></use></svg>\n            \n            <span class="gift-card-balance">',{type:"variable",name:"menubar.gift_card_balance",filters:[["money",["1"]],["h",[]]]}," ",{type:"variable",name:"menubar.gift_card_balance.currency",filters:[["h",[]]]},"</span>\n        </a>\n    </li>\n    "]}]},"\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.user && !hide_cart_icon ",attachment:['\n    <li data-bind="visible: hasCart" class="menubar-item hoverable cart-wrapper ',{type:"ef",blocks:[{type:"ncondition",expression:"!has_cart ",attachment:["hidden-while-loading"]}]},'" data-test="mb-cart">\n        <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/cart" ',{type:"ef",blocks:[{type:"ncondition",expression:"menubar.is_tralbum_page ",attachment:['data-bind="click: goCart"']}]},' title="',{type:"translate",nodelist:["cart"]},'">\n            <svg width="26" height="26" class="menubar-cart-icon svg-icon">\n                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menubar-cart-icon"></use>\n                <text data-bind="text: numCartItemsDisplay" x="15" y="12" dominant-baseline="middle" text-anchor="middle">\n                    ',{type:"variable",name:"cart_quantity",filters:[["h",[]]]},"\n                </text>\n            </svg>\n        </a>\n    </li>\n    "]}]},"\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.has_notifications && !hide_notification_center ",attachment:['\n        <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(page_identities.user) ",attachment:["hidden-while-loading"]}]},' notification-center-menubar-button">\n            <a href="#">\n                <span class="unread-messages-indicator ',{type:"ef",blocks:[{type:"ncondition",expression:"menubar.hide_unseen_notification_indicator ",attachment:["hide"]}]},'" data-bind="css: {\'hide\': hide_unseen_notification_indicator}"></span>\n                <svg width="26px" height="26px" class="svg-icon"><use xlink:href="#menubar-messages-icon"></svg>\n            </a>\n        </li>\n        ',{type:"include",template_name:"'_notification_center_widget'"},"\n    "]}]},"\n\n    \x3c!-- ko if: (fan() && !fan().private) --\x3e\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"!hide_feed ",attachment:['\n        <li id="feed-main" class="signup-tooltip-parent menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(page_identities.user && page_identities.fan && !page_identities.fan.private) ",attachment:["hidden-while-loading"]}]},'" data-tooltip-id="f" data-test="mb-feed">\n            <a href="',{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.fan.url ",attachment:[{type:"variable",name:"page_identities.fan.url",filters:[["a",[]]]},"/feed?from=menubar"]}]},'" title="',{type:"translate",nodelist:["feed"]},'">\n                <svg width="26px" height="26px" viewBox="0 0 26 26" class="svg-icon"><use xlink:href="#menubar-feed-icon"></svg>\n            </a>\n            <div class="signup-tooltip-outer feed-tooltip-outer header-2018"></div>\n        </li>\n    ']}]},"\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"!hide_collection_wishlist ",attachment:["\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.has_collection || (!menubar.has_collection && !menubar.has_wishlist) ",attachment:['\n        <li id="collection-main" class="menubar-item hoverable signup-tooltip-parent ',{type:"ef",blocks:[{type:"ncondition",expression:"!(page_identities.user && page_identities.fan && !page_identities.fan.private) ",attachment:["hidden-while-loading"]}]},'" data-tooltip-id="c" data-test="mb-collection">\n            <a href="',{type:"variable",name:"page_identities.fan.url",filters:[["a",[]]]},'" title="',{type:"translate",nodelist:["collection"]},'">\n                <svg width="26" height="26" viewBox="0 0 26 26" class="svg-icon"><use xlink:href="#menubar-collection-icon"></svg>\n            </a>\n            <div class="signup-tooltip-outer collection-tooltip-outer header-2018"></div>\n        </li>\n        ']},{type:"ncondition",expression:"menubar.has_wishlist ",attachment:['\n        <li id="collection-main" class="signup-tooltip-parent menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(page_identities.user && page_identities.fan && !page_identities.fan.private) ",attachment:["hidden-while-loading"]}]},'" data-tooltip-id="w" data-test="mb-collection">\n            <a href="',{type:"variable",name:"page_identities.fan.url",filters:[["a",[]]]},'/wishlist" title="',{type:"translate",nodelist:["wishlist"]},'">\n                <svg width="26" height="26" viewBox="0 0 26 26" class="svg-icon"><use xlink:href="#menubar-collection-icon"></svg>\n            </a>\n            <div class="signup-tooltip-outer wishlist-tooltip-outer header-2018"></div>\n        </li>\n        ']}]},"\n    "]}]},'\n    \x3c!-- /ko --\x3e\n        <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(page_identities.user) ",attachment:["hidden-while-loading"]}]},'" data-test="user-menu">\n        <a>\n            <div data-bind="with: artistsMenu">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.bands[0] ",attachment:['\n                    \x3c!-- Artist (and possibly fanartist) profile pic --\x3e\n                    \x3c!-- ko if: optionsLoggedInBand() && optionsLoggedInBand().photo --\x3e\n                    <div class="userpic ',{type:"ef",blocks:[{type:"ncondition",expression:"is_admin ",attachment:["admin"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"!menubar.active_profile_photo ",attachment:["hidden-while-loading"]}]},'">\n                        <img ',{type:"variable",name:"menubar.active_profile_photo",filters:[["image",["'art_embedded_player'"]]]},' data-bind="src_image: {image_id: optionsLoggedInBand().photo, format: \'art_embedded_player\'}"\n                        >\n                    </div>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko ifnot: optionsLoggedInBand() && optionsLoggedInBand().photo --\x3e\n                    <div class="userpic ',{type:"ef",blocks:[{type:"ncondition",expression:"is_admin ",attachment:["admin"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.active_profile_photo ",attachment:["hidden-while-loading"]}]},'">\n                        <div class="no-image-placeholder"></div>\n                    </div>\n                    \x3c!-- /ko --\x3e\n                ']},{type:"else_ncondition",attachment:['\n                    \x3c!-- Fan only profile pic --\x3e\n                    \x3c!-- ko if: $parent.loggedInFanPhoto() --\x3e\n                    <div class="userpic ',{type:"ef",blocks:[{type:"ncondition",expression:"is_admin ",attachment:["admin"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"!menubar.active_profile_photo ",attachment:["hidden-while-loading"]}]},'">\n                        <img ',{type:"variable",name:"menubar.active_profile_photo",filters:[["image",["'art_embedded_player'"]]]},' data-bind="src_image: {image_id: $parent.loggedInFanPhoto(), format: \'art_embedded_player\'}"\n                        >\n                    </div>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko ifnot: $parent.loggedInFanPhoto() --\x3e\n                    <div class="userpic ',{type:"ef",blocks:[{type:"ncondition",expression:"is_admin ",attachment:["admin"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.active_profile_photo ",attachment:["hidden-while-loading"]}]},'">\n                        <div class="no-image-placeholder"></div>\n                    </div>\n                    \x3c!-- /ko --\x3e\n                ']}]},'\n            </div>\n        </a>\n\n        <ul class="menu user-menu hidden-while-loading" data-bind="with: artistsMenu, css: { label: (artistsMenu.loggedInLabelMemberBands().length > 0 || artistsMenu.linkedNonLabelMemberBands().length > 1) }">\n        <ol class="user-menu-wrapper">\n            \x3c!-- ARTIST --\x3e\n            \x3c!-- ko if: bmgr.bands().length >= 1 && loggedInBand() --\x3e\n                <li class="submenu-item">\n                    <a data-bind="attr: { href: loggedInBand().trackpipeLocalUrl()}" class="name">\n                        <strong class="menu-bandname" data-bind="text: optionsLoggedInBand().title, css: { long: !optionsLoggedInBand().showPro}">',{type:"variable",name:"artistsmenu_title",filters:[["h",[]]]},"</strong>\n                        ",{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.fan && page_identities.bands.length >= 0 ",attachment:['\n                        \x3c!-- ko if: optionsLoggedInBand() && optionsLoggedInBand().photo --\x3e\n                        <div class="userpic menu-artistpic',{type:"ef",blocks:[{type:"ncondition",expression:"is_admin ",attachment:["admin"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"!menubar.active_profile_photo ",attachment:["hidden-while-loading"]}]},'">\n                            <img ',{type:"variable",name:"menubar.active_profile_photo",filters:[["image",["'art_embedded_player'"]]]},' data-bind="src_image: {image_id: optionsLoggedInBand().photo, format: \'art_embedded_player\'}"\n                            >\n                        </div>\n                        \x3c!-- /ko --\x3e\n                        \x3c!-- ko ifnot: optionsLoggedInBand() && optionsLoggedInBand().photo --\x3e\n                        <div class="userpic ',{type:"ef",blocks:[{type:"ncondition",expression:"is_admin ",attachment:["admin"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.active_profile_photo ",attachment:["hidden-while-loading"]}]},'">\n                            <div class="no-image-placeholder"></div>\n                        </div>\n                        \x3c!-- /ko --\x3e\n                        ']}]},'\n                        <div data-bind="visible: optionsLoggedInBand().showPro" class="menubar-badge-pro round3 ',{type:"ef",blocks:[{type:"ncondition",expression:"!artistsmenu_show_pro ",attachment:["hidden-while-loading"]}]},'">',{type:"translate",nodelist:["PRO"]},'</div>\n                        <div class="view-site">',{type:"translate",nodelist:["view site"]},'</div>              \n                    </a>\n                </li> \n\n                <li class="submenu-item">\n                    <a data-bind="\n                        attr: {href: \'',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/profile?from=menubar&id=' + loggedInBand().id},\n                        css: {admin: optionsLoggedInBand().adminAccess}\"\n                    >\n                        <span>",{type:"translate",nodelist:["edit profile"]},'</span>\n                    </a>\n                </li>\n                <li class="submenu-item">\n                    <a data-bind="\n                        attr: {href: \'',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/tools?from=menubar&id=' + loggedInBand().id},\n                        css: {admin: optionsLoggedInBand().adminAccess}\"\n                    >\n                        <span>",{type:"translate",nodelist:["tools"]},"</span>\n                    </a>\n                </li>\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.band_has_items ",attachment:['\n                <li class="submenu-item">\n                    <a data-bind="click: launchPageDesign.bind($data, loggedInBand())">',{type:"translate",nodelist:["page design"]},"</a>\n                </li>\n                "]}]},'\n\n                <li class="ui-menu-item ',{type:"ef",blocks:[{type:"ncondition",expression:"menubar.page_path == '/edit_subscription' ",attachment:["disabled"]}]},' submenu-item">\n                    \x3c!-- ko ifnot: loggedInBand().hasService() --\x3e\n                        <a data-bind="attr: { href: \'',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/subscriptions?band_id=' + loggedInBand().id + '&from=menubar'}\">",{type:"translate",nodelist:["subscription"]},"</a>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko if: loggedInBand().hasService() --\x3e\n                        <a data-bind=\"attr: { href: loggedInBand().trackpipeLocalUrl() + '/' + loggedInBand().serviceUrlFragment() + '?from=menubar'}\">",{type:"translate",nodelist:["subscription"]},'</a>\n                    \x3c!-- /ko --\x3e\n                </li>\n            \x3c!-- /ko --\x3e\n            \n            \x3c!-- FAN --\x3e\n            \x3c!-- ko if: ($parent.fan() && !$parent.fan().private) --\x3e\n            <li class="submenu-item">\n                <a href="',{type:"variable",name:"page_identities.fan.url",filters:[["a",[]]]},'" class="name">\n                    <strong class="menu-bandname long" data-test="fan-username">',{type:"variable",name:"page_identities.fan.name",filters:[["h",[]]]},"</strong>\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.bands.length > 0 ",attachment:['\n                    <div class="userpic fanpic ',{type:"ef",blocks:[{type:"ncondition",expression:"!page_identities.fan ",attachment:["hidden-while-loading"]}]},'">\n                        ',{type:"ef",blocks:[{type:"ncondition",expression:"!page_identities.fan.photo ",attachment:['\n                            <div class="no-image-placeholder"></div>\n                        ']},{type:"else_ncondition",attachment:["\n                            <img ",{type:"variable",name:"page_identities.fan.photo",filters:[["image",["'art_embedded_player'"]]]},">\n                        "]}]},"\n                    </div>\n                    "]}]},'\n                    <div class="view-collection" data-test="submenu-item-view-collection">',{type:"translate",nodelist:["view collection"]},'</div>\n                </a>\n            </li>\n            <li class="submenu-item"><a href="',{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.fan.url ",attachment:[{type:"variable",name:"page_identities.fan.url",filters:[["a",[]]]},"/purchases?from=menubar"]}]},'"><span data-test="submenu-item-purchases">',{type:"translate",nodelist:["purchases"]},'</span></a></li>\n            \x3c!-- /ko --\x3e\n            <li class="ui-widget-content ui-menu-divider first"></li>\n\n            \x3c!-- LABEL ARTISTS --\x3e\n            \x3c!-- ko if: loggedInLabelMemberBands() && loggedInLabelMemberBands().length > 0 --\x3e\n            <li class="menu-switch ui-menu-item submenu-item ui-state-disabled" data-bind="visible: !showLinkedBands()">\n                <span data-bind="attr: {href: loggedInBand().trackpipeLocalUrl() + \'/artists?from=menubar_artist_dropdown\'}, text: loggedInLabelMemberBandsCountStr()"></span>\n            </li>\n\n            <ol class="label-artist-menu no-pro-badges ui-state-disabled ui-menu-item" data-bind="visible: !showLinkedBands()" data-test="label-artists">\n            <input type="text" class="artist-filter-text" data-test="artist-filter-text" data-bind="textInput: labelMemberBandsSearchTerm, visible: loggedInLabelMemberBands().length > 10" placeholder="',{type:"translate",nodelist:["Search all artists"]},'">\n\n                \x3c!-- ko foreach: filteredLoggedInLabelMemberBands() --\x3e\n                    <li class="label-member-band submenu-item" data-bind="template: {\n                        \'name\': \'band-menuitem-template-options\'\n                    }"></li>\n                \x3c!-- /ko --\x3e\n\n                \x3c!-- ko if: filteredLoggedInLabelMemberBands().length == 0 --\x3e\n                    <li class="no-results submenu-item">',{type:"translate",nodelist:["no results"]},'</li>\n                \x3c!-- /ko --\x3e\n            </ol>\n            <li class="ui-widget-content ui-menu-divider" data-bind="visible: !showLinkedBands()"></li>\n            \x3c!-- /ko --\x3e\n\n            \x3c!-- CONNECTED ACCOUNTS --\x3e\n            \x3c!-- ko if: linkedNonLabelMemberBands().length > 1 --\x3e\n            <ol class="linked-accounts-wrapper">\n                <li class="menu-switch ui-menu-item submenu-item linked-accounts-menu ui-state-disabled" data-bind="click: () => showLinkedBands(!showLinkedBands())" data-test="linked-accounts-header">\n                <span data-bind="text: loggedInLinkedBandsCountStr()"></span><div data-bind="css: { \'arrow-down\': showLinkedBands(), \'arrow-right\' : !showLinkedBands() }"></div>\n                </li>\n                <ol class="linked-accounts-menu-content" data-bind="visible: showLinkedBands()" data-test="linked-accounts">\n                \x3c!-- ko foreach: linkedNonLabelMemberBands() --\x3e\n                    <li class="submenu-item" data-bind="template: {\n                        \'name\': \'band-menuitem-template\'\n                    },\n                    css: {\n                        \'hidden\': ($data.id == $root.artistsMenu.loggedInBand().id)\n                    }"></li>\n                \x3c!-- /ko --\x3e\n                </ol>\n            </ol>\n            <li class="ui-widget-content ui-menu-divider"></li>\n            \x3c!-- /ko --\x3e\n\n\n            \x3c!-- ALL USERS --\x3e\n            <ol class="all-user-option">\n                <li class="submenu-item"><a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/settings?from=menubar" data-test="submenu-item-settings">',{type:"translate",nodelist:["settings"]},"</a></li>\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.show_guide_link ",attachment:['\n                <li class="submenu-item"><a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/guide?from=artistmenu">',{type:"translate",nodelist:["guide"]},"</a></li>\n                "]}]},'\n                <li class="submenu-item"><a href="https://get.bandcamp.help" data-test="submenu-item-help">',{type:"translate",nodelist:["help"]},'</a></li>\n                <li class="submenu-item"><a class="logout-action" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/logout" data-test="submenu-item-logout">',{type:"translate",nodelist:["log out"]},"</a></li>\n            </ol>\n        </ol>\n        </ul>\n    </li>\n\x3c!-- /ko --\x3e\n\n\x3c!-- ko ifnot: user() --\x3e\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"!page_identities.user && !hide_cart_icon ",attachment:['\n    <li data-bind="visible: hasCart" class="menubar-item hoverable cart-wrapper hidden-while-loading svg-icon" data-test="mb-cart">\n        <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/cart" ',{type:"ef",blocks:[{type:"ncondition",expression:"menubar.is_tralbum_page ",attachment:['data-bind="click: goCart"']}]},' title="',{type:"translate",nodelist:["cart"]},'">\n            <svg width="26" height="26" class="menubar-cart-icon">\n                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menubar-cart-icon"></use>\n                <text data-bind="text: numCartItemsDisplay" x="15" y="12" dominant-baseline="middle" text-anchor="middle">\n                    ',{type:"variable",name:"cart_quantity",filters:[["h",[]]]},"\n                </text>\n            </svg>\n        </a>\n    </li>\n    "]}]},"\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"!hide_login_signup ",attachment:["\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"!hide_signup ",attachment:['\n            <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(!page_identities.user) ",attachment:["hidden-while-loading"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"is_fan_page ",attachment:["mobile-hidden"]}]},'">\n                <a class="all-signup-link">',{type:"translate",nodelist:["sign up"]},"</a>\n            </li>\n        "]}]},'\n        <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(!page_identities.user) ",attachment:["hidden-while-loading"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:'menubar.page_path == "/login" ',attachment:["mobile-hidden"]}]},'">\n            <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/login",{type:"ef",blocks:[{type:"ncondition",expression:"is_fan_page ",attachment:["?from=fan_page"]},{type:"else_ncondition",attachment:["?from=menubar"]}]},{type:"ef",blocks:[{type:"ncondition",expression:"menubar_login_bounce_param ",attachment:[{type:"variable",name:"menubar_login_bounce_param",filters:[["a",[]]]}]}]},'" class="login-link">',{type:"translate",nodelist:["log in"]},"</a>\n        </li>\n    "]}]},"\n\x3c!-- /ko --\x3e\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"ppp_menubar ",attachment:['\n\x3c!-- ko ifnot: fan() --\x3e\n    \x3c!-- ko ifnot: user() --\x3e\n    <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(!page_identities.fan) || !(!page_identities.user) ",attachment:["hidden-while-loading"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"is_fan_page ",attachment:["mobile-hidden"]}]},'">\n        <a class="fan-signup-modal-link" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/fans?from=menubar"\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_signup_params ",attachment:['\n            data-from="',{type:"variable",name:"fan_signup_params.from",filters:[["a",[]]]},'"\n            data-email="',{type:"variable",name:"fan_signup_params.email",filters:[["a",[]]]},'"\n            data-token="',{type:"variable",name:"fan_signup_params.signup_token",filters:[["a",[]]]},'"\n            data-tsig="',{type:"variable",name:"fan_signup_params.tsig",filters:[["a",[]]]},'"\n            data-verified="',{type:"variable",name:"fan_signup_params.verified",filters:[["a",[]]]},'"\n            ']}]},"\n            >",{type:"translate",nodelist:["sign up"]},'</a>\n    </li>\n    \x3c!-- /ko --\x3e\n    \x3c!-- ko if: user() --\x3e\n    <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(!page_identities.fan) || !page_identities.user ",attachment:["hidden-while-loading"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"is_fan_page ",attachment:["mobile-hidden"]}]},'">\n        <a class="fan-signup-modal-link" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/fans?from=menubar">',{type:"translate",nodelist:["sign up as fan"]},"</a>\n    </li>\n    \x3c!-- /ko --\x3e\n</li>\n\x3c!-- /ko --\x3e\n"]}]},"\n",{type:"ef",blocks:[{type:"ncondition",expression:"ppp_menubar || cc_menubar ",attachment:['\n\x3c!-- ko ifnot: fan() --\x3e\n    \x3c!-- ko ifnot: user() --\x3e\n    <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(!page_identities.fan) || !(!page_identities.user)",attachment:["hidden-while-loading"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"is_fan_page ",attachment:["mobile-hidden"]}]},'">\n       <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/login?from=menubar">',{type:"translate",nodelist:["log in"]},'</a>\n    </li>\n    \x3c!-- /ko --\x3e\n    \x3c!-- ko if: user() --\x3e\n    <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(!page_identities.fan) || !page_identities.user ",attachment:["hidden-while-loading"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"is_fan_page ",attachment:["mobile-hidden"]}]},'">\n        <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/logout?login=1">',{type:"translate",nodelist:["log in as fan"]},"</a>\n    </li>\n    \x3c!-- /ko --\x3e\n\x3c!-- /ko --\x3e\n"]}]},"\n\n</ul>\n</div>\n\n<div class='corp-banners'>\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home && show_forget_password_banner ",attachment:["\n    ",{type:"include",template_name:"'password_change_banner'"},"\n"]}]},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home && show_tax_identity_banner_corphome ",attachment:["\n    ",{type:"include",template_name:"'tax_identity_banner'"},"\n"]}]},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home && show_tax_identity_warning_corphome ",attachment:["\n    ",{type:"include",template_name:"'tax_identity_warning'"},"\n"]}]},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home && show_notify_act_banner_corphome ",attachment:["\n    ",{type:"include",template_name:"'notify_act_banner'"},"\n"]}]},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home && show_notify_act_warning_corphome ",attachment:["\n    ",{type:"include",template_name:"'notify_act_warning'"},"\n"]}]},"\n\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home && fan_onboarding ",attachment:["\n        ",{type:"let",variable:"is_unverified_fan",expression:"page_identities.fan && !page_identities.fan.verified && !page_identities.fan.private "},"\n        ",{type:"let",variable:"show_verify_banner",expression:"fan_onboarding.show_verify_banner && is_unverified_fan && !skip_verification_banner "},"\n        ",{type:"let",variable:"verify_email",expression:"fan_onboarding.email "},"\n        ",{type:"include",template_name:"'home_2016/fan_verify_banner'"},"\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"show_tos_banner && !show_verify_banner ",attachment:["\n            ",{type:"include",template_name:"'tos_update_banner'"},"\n        "]}]},"\n    "]},{type:"else_ncondition",attachment:["\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home && show_tos_banner ",attachment:["\n            ",{type:"include",template_name:"'tos_update_banner'"},"\n        "]}]},"\n    "]}]},'\n\n</div>\n\n\x3c!-- Knockout template for list items in the artists menu --\x3e\n<script type="text/html" id="band-menuitem-template">\n    <a class="menu-artistitem"\n        data-bind="css: {\'is-pro\': isPro()}, attr: {href: $root.artistsMenu.isPageBand(id) ? \'\' : trackpipeLocalUrl()}"\n    >\n        <span class="menu-artistpic">\n            \x3c!-- ko if: photo() --\x3e\n            <img data-bind="src_image: {image_id: photo(), format: \'art_embedded_player\'}">\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko ifnot: photo() --\x3e\n            <div class="no-image-placeholder"></div>\n            \x3c!-- /ko --\x3e\n        </span>\n        <span data-bind="text: name()" class="menu-bandname menu-text"></span>\n        <span data-bind="visible: isPro()" class="menubar-badge-pro round3">',{type:"translate",nodelist:["PRO"]},'</span>\n    </a>\n<\/script>\n\n<script type="text/html" id="band-menuitem-template-options">\n    <a data-bind="attr: {href: trackpipeLocalUrl()}" class="menu-artistitem">\n        <span class="menu-artistpic">\n            \x3c!-- ko if: photo() --\x3e\n            <img data-bind="src_image: {image_id: photo(), format: \'art_embedded_player\'}">\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko ifnot: photo() --\x3e\n            <div class="no-image-placeholder"></div>\n            \x3c!-- /ko --\x3e\n        </span>\n        <span data-bind="text: name()" class="menu-bandname menu-text"></span>\n        <span class="show-more" data-bind="visible: $root.artistsMenu.bmgr.bandByID(id) || $root.artistsMenu.lmgr.isMemberBandAuthed(id), click: () => $root.artistsMenu.setActiveLabelMemberBand(id)">•••</span>\n    </a>\n    \x3c!-- ko if: ($root.artistsMenu.activeLabelMemberBand() == id) --\x3e\n    <div class="label-artist-menu-links ui-menu-item">\n        <span data-bind="visible: $root.artistsMenu.bmgr.bandByID(id) || $root.artistsMenu.lmgr.isMemberBandAuthed(id)">\n            <a data-bind="\n                attr: {href: \'',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/profile?from=menubar&id=\' + id}"\n            >\n                <span class="menu-text">',{type:"translate",nodelist:["edit profile"]},"</span>\n            </a>\n            <a data-bind=\"\n                attr: {href: '",{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/tools?from=menubar&id=\' + id}"\n            >\n                <span class="menu-text">',{type:"translate",nodelist:["tools"]},'<span>\n            </a>\n            \x3c!-- ko if: hasItems --\x3e\n                <a data-bind="click: $root.artistsMenu.launchPageDesign.bind($data)"><span class="menu-text">',{type:"translate",nodelist:["page design"]},"</span></a>\n            \x3c!-- /ko --\x3e\n\n            \x3c!-- ko ifnot: hasService() --\x3e\n                <a data-bind=\"attr: { href: '",{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/subscriptions?band_id=' + id + '&from=menubar'}\"><span class=\"menu-text\">",{type:"translate",nodelist:["subscription"]},'</span></a>\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: hasService() --\x3e\n                <a data-bind="attr: { href: trackpipeLocalUrl() + \'/\' + serviceUrlFragment() + \'?from=menubar\'}"><span data-bind="text: serviceName()" class="menu-text">',{type:"translate",nodelist:["subscription"]},'</span></a>\n            \x3c!-- /ko --\x3e\n        </span>\n    </div>\n    \x3c!-- /ko --\x3e\n    <span class="show-less" data-bind="visible: $root.artistsMenu.activeLabelMemberBand() == id && ($root.artistsMenu.bmgr.bandByID(id) || $root.artistsMenu.lmgr.isMemberBandAuthed(id)), click: () => $root.artistsMenu.setActiveLabelMemberBand(id)">show less</span>\n<\/script>\n\n\n\x3c!-- Knockout template for the parent label --\x3e\n<script type="text/html" id="band-parentlabel-template">\n    <div data-bind="css: {\'artist-listing-with-links\': $parent.columns() > 1}">\n        <a class="menu-artistitem" data-bind="attr: {href: trackpipeUrlHttps()}">\n        \x3c!-- ko if: $parent.columns() === 1 --\x3e\n            <span class="menu-artistpic">\n                <img data-bind="src_image: {image_id: photo(), format: \'bio_navbar\'}">\n            </span>\n            <span data-bind="text: name()" class="menu-bandname"></span>\n        \x3c!-- /ko --\x3e\n        \x3c!-- ko if: $parent.columns() > 1 --\x3e\n            \x3c!-- ko if: photo() --\x3e\n                <img class="photo" data-bind="src_image: {image_id: photo(), format: \'fan_bio_thumb_small\'}">\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko ifnot: photo() --\x3e\n                <div class="photo none"></div>\n            \x3c!-- /ko --\x3e\n        \x3c!-- /ko --\x3e\n        </a>\n   \n        <div class="infobox">\n            <p class="name"><a data-bind="attr: {href: trackpipeUrl()}, text: name()"></a></p>\n            <p class="actions">\n                <a data-bind="attr: {href: \'',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/profile?from=menubar&id=' + id}\">",{type:"translate",nodelist:["profile"]},"</a> &middot;\n                <a data-bind=\"attr: {href: '",{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/tools?from=menubar&id=' + id}\">",{type:"translate",nodelist:["tools"]},"</a> &middot;\n                <a data-bind=\"attr: {href: trackpipeLocalUrl() + '/stats?from=menubar'}\">",{type:"translate",nodelist:["stats"]},"</a>\n            </p>\n        </div>\n    </div>\n<\/script>\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/_notification_center_widget.liquid","warn"):Templ.register({_notification_center_widget:['<div id="notification-center-container" data-bind="with: NotificationCenterVM">\n    <div class="notification-center" data-bind="css: {\'open\': show, \'empty\': empty, \'loading\': !loaded()}">\n        <div class="messages">\n            <div class="message-container" data-bind="foreach: messages">\n                <li class="divider"></li>\n                <a class="message" data-bind="attr: { href:messageUrl }">\n                    <span class="unread-indicator" data-bind="css: {\'hide\': !unread()}"></span>\n                    <div class="message-image" data-bind="css: {\'room-for-recipient-name\': recipientName}">\n                        <div class="message-userpic">\n                            \x3c!-- ko if: fanImageId --\x3e\n                                <img data-bind="attr: {src: fanImageId}">\n                            \x3c!-- /ko --\x3e\n                            \x3c!-- ko ifnot: fanImageId --\x3e\n                                <div class="no-image-placeholder"></div>\n                            \x3c!-- /ko --\x3e\n                        </div>\n                    </div>\n                    <div class="message-text" data-bind="css: {\'room-for-recipient-name\': recipientName}">\n                        \x3c!-- ko if: recipientName --\x3e\n                            <div class="recipient-name" data-bind="text: recipientName">Artist Name</div>\n                        \x3c!-- /ko --\x3e\n                        ',{type:"translate",nodelist:["\n                            ",{type:"translateVariable",var_name:"sender_name",nodelist:['\n                                <span class="message-sender-name" data-bind="text: fanName"></span>\n                            ']}," replied to your message.\n                        "]},' \n                        <span class="message-time" data-bind="text: relative_time">just now</span>\n                    </div>\n                </a>\n            </div>\n            \x3c!-- ko if: paginating --\x3e\n                ',{type:"include",template_name:'"fan/collection/loading"'},'\n            \x3c!-- /ko --\x3e\n\n            \x3c!-- ko if: empty --\x3e\n                <div class="empty-msg">\n                    ',{type:"translate",nodelist:["No notifications yet."]},'\n                </div>\n            \x3c!-- /ko --\x3e\n        </div>\n        <div class="mark-all-as-read" data-bind="click: markAllAsRead">',{type:"translate",nodelist:["Mark all as read"]},"</div>\n    </div>\n</div>\n\n"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/home/header_2015.liquid","warn"):Templ.register({"home/header_2015":['<div class="hd ',{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:["header-rework-2018 ",{type:"ef",blocks:[{type:"ncondition",expression:"!page_identities.user ",attachment:["banner-lo"]}]}]}]}," row ",{type:"ef",blocks:[{type:"ncondition",expression:"identities.user && user_type ",attachment:["logged-in"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"!is_client_render ",attachment:["tooltips-hidden"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:["corp-home"]}]},'">\n    <div class="row">\n        <div class="col col-7-12">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"!cfg.header_rework_2018 ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:['\n                    <h1 class="hd-logo"><span>Bandcamp</span></h1>\n                ']},{type:"else_ncondition",attachment:['\n                    <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'"><h1 class="hd-logo"><span>Bandcamp</span></h1></a>\n                ']}]},'\n                <h2 class="hd-sub-head">',{type:"translate",nodelist:["Discover amazing new music and directly support the artists who make it."]},"</h2>\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:['\n                    <h1 class="corp-bclogo" data-test="mb-bandcamp-logo"><svg width="137px" height="22px" viewBox="0 0 127 20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#bandcamp-logo-color-bcaqua">Bandcamp</use></svg></h1>\n                ']},{type:"else_ncondition",attachment:['\n                    <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'">\n                        <h1 class="corp-bclogo" data-test="mb-bandcamp-logo"><svg width="137px" height="22px" viewBox="0 0 127 20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#bandcamp-logo-color-bcaqua">Bandcamp</use></svg>\n                        </h1>\n                    </a>\n                ']}]},'\n                <h2 class="hd-sub-head ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">',{type:"translate",nodelist:["Discover amazing new music and <a ",{type:"translateVariable",var_name:"link",nodelist:['class="blue-gradient" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/fair_trade_music_policy"']},">directly support</a> the artists who make it."]},"</h2>\n            "]}]},"\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"identities.user && user_type ",attachment:['\n            <ul class="hd-nav user-nav">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"user_photo ",attachment:['\n                <li class="user-nav-thumb">\n                    <span class="user-nav-thumb">\n                        <img ',{type:"variable",name:"user_photo",filters:[["image",["'bio_navbar'"]]]},">\n                    </span>\n                </li>\n                "]}]},'\n                <li class="name">\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_name ",attachment:["\n                        ",{type:"translate",nodelist:["Hi ",{type:"translateVariable",var_name:"name",nodelist:[{type:"variable",name:"fan_name",filters:[["h",[]]]}]},""]},"\n                    "]},{type:"else_ncondition",attachment:["\n                        ",{type:"translate",nodelist:["Hi ",{type:"translateVariable",var_name:"name",nodelist:[{type:"variable",name:"user_name",filters:[["h",[]]]}]},""]},"\n                    "]}]},"\n                </li>\n\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"collection_url && !identities.fan.private ",attachment:['\n                    <li class="signup-tooltip-parent" data-tooltip-id="f">\n                        <a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'/feed">',{type:"translate",nodelist:["feed"]},'</a>\n                        <div class="signup-tooltip-outer feed-tooltip-outer"></div>\n                    </li>\n\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"has_wishlist && !has_collection ",attachment:['\n                        <li class="signup-tooltip-parent" data-tooltip-id="w">\n                            <a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'/wishlist">',{type:"translate",nodelist:["wishlist"]},'</a>\n                            <div class="signup-tooltip-outer wishlist-tooltip-outer"></div>\n                        </li>\n                    ']},{type:"ncondition",expression:"has_wishlist ",attachment:['\n                        <li class="signup-tooltip-parent" data-tooltip-id="c">\n                            <a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'">',{type:"translate",nodelist:["collection"]},'</a>\n                            <div class="signup-tooltip-outer collection-tooltip-outer"></div>\n                        </li>\n                        <li class="signup-tooltip-parent" data-tooltip-id="w">\n                            <a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'/wishlist">',{type:"translate",nodelist:["wishlist"]},'</a>\n                            <div class="signup-tooltip-outer wishlist-tooltip-outer"></div>\n                        </li>\n                    ']},{type:"else_ncondition",attachment:['\n                        <li class="signup-tooltip-parent" data-tooltip-id="c">\n                            <a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'">',{type:"translate",nodelist:["collection"]},'</a>\n                            <div class="signup-tooltip-outer collection-tooltip-outer"></div>\n                        </li>\n                    ']}]},"\n                "]}]},"\n\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"band_url ",attachment:['\n                <li><a href="',{type:"variable",name:"band_url",filters:[["a",[]]]},'">your site</a></li>\n                ']},{type:"ncondition",expression:"partner_url ",attachment:['\n                <li><a href="',{type:"variable",name:"partner_url",filters:[["a",[]]]},'">your page</a></li>\n                ']}]},"\n\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:['\n                <li class="cartitem">\n                    <a href="/cart" rel="nofollow">\n                        <span class="cart bc-home">&nbsp;</span>\n                        <span class="cart-item-count">',{type:"variable",name:"cart_quantity",filters:[]},"</span>\n                    </a>\n                </li>\n                "]}]},"\n\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"gift_card_balance ",attachment:["\n                    ",{type:"let",variable:"hide_gift_card_balance",expression:"!cfg.header_rework_2018 && (band_url || partner_url) && collection_url "},"\n                    ",{type:"include",template_name:"'home/header_gift_balance'"},"\n                "]}]},"\n            </ul>\n            "]}]},'\n        </div>\n        <div id="corphome-autocomplete-form" class="searchwidget col col-5-12" data-test="mb-search-box">\n            ',{type:"include",template_name:"'_autocomplete_responsive_widget'"},'\n            <ul class="hd-nav corp-nav ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"!cfg.header_rework_2018 ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"cfg.gift_cards ",attachment:['\n                <li>\n                    <a class="gift-cards-link" href="/gift_cards?from=header">',{type:"translate",nodelist:["gift cards"]},"</a>\n                </li>\n                "]}]},'\n                <li class="signup-tooltip-parent" data-tooltip-id="d">\n                    <a class="discover-link" href="/#discover">',{type:"translate",nodelist:["discover"]},'</a>\n                    <div class="signup-tooltip-outer discover-tooltip-outer"></div>\n                </li>\n                ']}]},"\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"has_cart && !identities.user ",attachment:['\n                <li class="menubar-item cart-wrapper-corp-lo svg-icon" data-test="mb-cart">\n                    <a href="/cart" rel="nofollow">\n                        <svg width="26" height="26" class="menubar-cart-icon">\n                            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menubar-cart-icon"></use>                    \n                            <text x="15" y="12" dominant-baseline="middle" text-anchor="middle">\n                                ',{type:"variable",name:"cart_quantity",filters:[["h",[]]]},"\n                            </text>\n                        </svg>\n                    </a>\n                </li>\n                "]}]},"\n                "]}]},"\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"!identities.user ",attachment:['\n                <li data-test="mb-signup"><a href="#" class="all-signup-link">',{type:"translate",nodelist:["sign up"]},"</a></li>\n                "]}]},"\n                \n                ",{type:"ef",blocks:[{type:"ncondition",expression:"identities.user && user_type ",attachment:['\n                <li class="log-out-link"><a class="logout-action" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/logout",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:["?corp_home=1"]}]},'" ',{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:['data-logout-override="corp_home"']}]},">",{type:"translate",nodelist:["log out"]},"</a></li>\n                "]}]},'\n                <li class="log-in-link" data-test="mb-login"><a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/login",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:["?from=home"]}]},'">',{type:"translate",nodelist:["log in"]},"</a></li>\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"has_cart && !identities.user && !cfg.header_rework_2018 ",attachment:['\n                <li class="cartitem">\n                    <a href="/cart" rel="nofollow">\n                        <span class="cart bc-home">&nbsp;</span>\n                        <span class="cart-item-count">',{type:"variable",name:"cart_quantity",filters:[]},"</span>\n                    </a>\n                </li>\n                "]}]},"\n            </ul>\n        </div>\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"has_corp_header && !is_gift_cards_page && holiday_gc_link ",attachment:['\n            <div class="hd-banner-2018 holiday-gc-link ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">\n                <a class="hd-banner-2018-inner blue-gradient" href="/gift_cards?from=header">',{type:"translate",nodelist:["Bandcamp Gift Cards"]},"</a>\n            </div>\n        "]},{type:"ncondition",expression:"has_corp_header && corp_hiring_banner_text && !is_jobs_page ",attachment:['\n            <div class="hd-banner-2018 wide ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">\n                <a class="hd-banner-2018-inner blue-gradient" href="/jobs">',{type:"variable",name:"corp_hiring_banner_text",filters:[["h",[]]]},'</a>\n            </div>\n            \n            <div class="hd-banner-2018 small ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">\n                <a class="hd-banner-2018-inner blue-gradient" href="/jobs">',{type:"translate",nodelist:["We’re hiring!"]},"</a>\n            </div>\n        "]}]},"\n\n    </div>\n\n    <div class='corp-banners'>\n        ",{type:"let",variable:"is_unverified_fan",expression:"identities.fan && !identities.fan.verified && !identities.fan.private "},"\n        ",{type:"let",variable:"show_verify_banner",expression:"fan_onboarding.show_verify_banner && is_unverified_fan && !skip_verification_banner "},"\n        ",{type:"let",variable:"verify_email",expression:"fan_onboarding.email "},"\n        ",{type:"include",template_name:"'home_2016/fan_verify_banner'"},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"show_rock_the_vote_banner && !show_verify_banner ",attachment:["\n            ",{type:"include",template_name:"'rock_the_vote_banner'"},"\n        "]}]},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"show_tos_banner && !show_verify_banner ",attachment:["\n            ",{type:"include",template_name:"'tos_update_banner'"},"\n        "]}]},"\n    </div>\n</div>\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"!cfg.header_rework_2018 ",attachment:['\n<div class="hd-mobile row ',{type:"ef",blocks:[{type:"ncondition",expression:"identities.user && user_type ",attachment:["logged-in"]}]},'">    \n\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:['\n        <h1 class="hd-logo"><span>Bandcamp</span></h1>\n    ']},{type:"else_ncondition",attachment:['\n        <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'"><h1 class="hd-logo"><span>Bandcamp</span></h1></a>\n    ']}]},"\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"identities.user && user_type ",attachment:['\n    <ul class="hd-nav user-nav">\n\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"gift_card_balance ",attachment:["\n            ",{type:"let",variable:"hide_gift_card_balance",expression:"!cfg.header_rework_2018 && (band_url || partner_url) && collection_url "},"\n            ",{type:"include",template_name:"'home/header_gift_balance'"},"\n        "]},{type:"ncondition",expression:"!cfg.header_rework_2018 && cfg.gift_cards && ((collection_url && !identities.fan.private) || band_url || partner_url) ",attachment:['\n            <li><a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/gift_cards">',{type:"translate",nodelist:["gift cards"]},"</a></li>\n        "]}]},"\n\n                \n        \n        ",{type:"ef",blocks:[{type:"ncondition",expression:"collection_url && !identities.fan.private ",attachment:['\n        <li><a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'">',{type:"translate",nodelist:["collection"]},"</a></li>\n        "]}]},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"band_url ",attachment:['\n        <li><a href="',{type:"variable",name:"band_url",filters:[["a",[]]]},'">your site</a></li>\n        ']},{type:"ncondition",expression:"partner_url ",attachment:['\n        <li><a href="',{type:"variable",name:"partner_url",filters:[["a",[]]]},'">your page</a></li>\n        ']}]},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:['\n        <li>\n            <a class="home-cartitem" href="/cart" rel="nofollow">\n                <span class="cart bc-home"></span>\n                <span class="cart-item-count">',{type:"variable",name:"cart_quantity",filters:[]},"</span>\n            </a>\n        </li>\n        "]}]},"\n\n    </ul>\n    "]},{type:"else_ncondition",attachment:['\n    <ul class="hd-nav corp-nav ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">\n       <li>\n       <ul>\n            \n            ',{type:"ef",blocks:[{type:"ncondition",expression:"!has_cart ",attachment:['<li><span class="corp-nav-label">for:</span></li>']}]},'\n            <li><a href="/artists?from=hpartists">',{type:"translate",nodelist:["artists"]},'</a></li>\n            <li><a href="/fans?from=hpfans">',{type:"translate",nodelist:["fans"]},'</a></li>\n            <li><a href="/labels?from=hplabels">',{type:"translate",nodelist:["labels"]},'</a></li>\n        </ul>\n        </li>\n        <li class="log-in-link"><a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/login",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:["?from=home"]}]},'">',{type:"translate",nodelist:["log in"]},"</a></li>\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:['\n        <li>\n            <a class="home-cartitem" href="/cart" rel="nofollow">\n                <span class="cart bc-home"></span>\n                <span class="cart-item-count">',{type:"variable",name:"cart_quantity",filters:[]},"</span>\n            </a>\n        </li>\n        "]}]},"\n    </ul>\n    "]}]},'\n    <form class="searchwidget" action="/search" method="get">\n        <input name="q" type="text" placeholder="',{type:"translate",nodelist:["Search for artist, track or album"]},'" tabindex="0" autocomplete="off" maxlength="2048">\n        <input type="hidden" name="from" value="corphome">\n        <input type="hidden" name="item_type" data-bind="value: AutocompleteVM.currentFilter">\n        <button type="submit"><span class="icon bc-home"></span>',{type:"translate",nodelist:["Search"]},"</button>\n    </form>\n    <div class='corp-banners'>\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"show_rock_the_vote_banner && !show_verify_banner && is_corp_home ",attachment:["\n        ",{type:"include",template_name:"'rock_the_vote_banner'"},"\n        "]}]},"\n    </div>\n</div>\n"]},{type:"ncondition",expression:"show_header_2015 && !is_phone ",attachment:["\n    ",{type:"include",template_name:"'menubar_phone'"},"\n"]}]},"\n"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/rock_the_vote_banner.liquid","warn"):Templ.register({rock_the_vote_banner:['<div class="corpbanner rock-the-vote">\n    <div class="vote-logo-container">\n        <a href="https://bandcamp.com/vote">\n        <img class="vote-logo" src="/img/icon-vote-bandcamp.png"></img>\n        </a>\n    </div>\n    <div class="text">\n        Today is election day! Do you know where to vote? <a href="https://www.rockthevote.org/voting-information/find-your-polling-place">Find out here</a>.\n    </div>\n\n    <a class="dismiss-banner" id="dismiss-rock-the-vote-notification" href="#">\n        <span class="ui-icon dismiss-icon"></span>\n    </a>\n</div>\n']}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_app_download_banner.liquid","warn"):Templ.register({"fan/signup/fan_app_download_banner":['<div id=\'fan-app-download-banner-vm\' class="corpbanner fan-app-download">\n    <a class="dismiss-banner col" id="dismiss-fan-app-download-banner" href="#"\n        data-bind="click: dismissBanner">\n        <span class="ui-icon dismiss-icon"></span>\n    </a>\n    <div class="app-icon-container col">\n        <img class="app-icon" src="/img/app-icon-fanapp-ios.png"></img>\n    </div>\n    <div class="text col">\n        <div class=\'row title\'>Bandcamp</div>\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"isAppInstalled ",attachment:["\n            <div class='row'>",{type:"translate",nodelist:["Installed on your device"]},"</div>\n        "]},{type:"else_ncondition",attachment:["\n            <div class='row'>",{type:"translate",nodelist:["Free in the App Store"]},"</div>\n        "]}]},'\n    </div>\n    <a href="',{type:"variable",name:"redirectToAppURL",filters:[["h",[]]]},"\">\n        <button class='col'>\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"isAppInstalled ",attachment:["\n                <span>",{type:"translate",nodelist:["OPEN"]},"</span>\n            "]},{type:"else_ncondition",attachment:["\n                <span>",{type:"translate",nodelist:["GET"]},"</span>\n            "]}]},"\n        </button>\n    </a>\n\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/_autocomplete_responsive_widget.liquid","warn"):Templ.register({_autocomplete_responsive_widget:['<form aria-label="autocomplete search" class="menubar-search signup-tooltip-parent" action="/search" method="get" data-tooltip-id="s" aria-busy="false">\n  <input tabindex="0" aria-autocomplete="list" class="dismiss-tooltip-alt search-bar" type="text" name="q" placeholder="',{type:"translate",nodelist:["Search for artist, album, or track"]},'" autocomplete="off" maxlength="2048">\n    <div role="progressbar" class="loading-icon" id="search-loading-icon" aria-busy="false">\n        <svg aria-label="loading icon" class="search-spinner" width="15" height="16" viewBox="-1 -1 16 16">\n            <use href="#search-spinner"></use>\n        </svg>\n    </div>\n    <div aria-label="clear search" class="clear-autocomplete" >×</div>\n  </input>\n  <input type="hidden" class="selected-filter" name="item_type" value="" />\n  <button type="submit" tabindex="-1" aria-label="',{type:"translate",nodelist:["submit for full search page"]},'" class="menubar-search-icon"><svg width="15" height="16" viewBox="0 0 15 16"><use href="#menubar-search-input-icon" /></svg></button>\n  <ul role="listbox" class="genre-list" aria-busy="false"></ul>\n  <ul class="filter-list" aria-busy="false"></ul>\n  <ul role="listbox" class="search-autocomplete" aria-busy="false">\n    \n    <li class="simple results-see-all">\n      <a tabindex="-1" aria-label="visit full-search page">\n        <span>',{type:"translate",nodelist:["See all results"]},'</span>\n        <span><svg class="arrow" viewBox="0 0 24 24"><use href="#discover-arrow"></svg></span>\n      </a>\n    </li>\n    <li class="simple results-tags">\n      <a tabindex="-1" >\n        <span class="msg"></span>\n        <span><svg class="arrow" viewBox="0 0 24 24"><use href="#discover-arrow"></svg></span>\n      </a>\n    </li>\n    <li class="simple results-genre">\n      <a tabindex="-1">\n        <span class="msg"></span>\n        <span><svg class="arrow" viewBox="0 0 24 24"><use href="#discover-arrow"></svg></span>\n      </a>\n    </li>\n    <li aria-label="no matching results" class="autocomplete-no-results" >\n      <p class="noresults-header">',{type:"translate",nodelist:["No matching results"]},'</p>\n      <p class="noresults-text">',{type:"translate",nodelist:["Try a different filter or a new search keyword."]},'</p>\n      <div class="tumbleweed">\n        <img src="/img/search/tumbleweed-emptystate-lightbg.gif"/>\n      </div>\n    </li>\n  </ul>\n  <li class="simple mobile-results-tags no-show">\n    <a>\n      <span class="msg"></span>\n      <span><svg class="arrow" viewBox="0 0 24 24"><use href="#discover-arrow"></svg></span>\n    </a>\n  </li>\n  <div class="mobile-placeholder">\n      <p>',{type:"translate",nodelist:["Search all Bandcamp artists, tracks, and albums"]},'</p>\n  </div>\n  <template id="autocomplete-results-item"><li class="result-item">\n    <a tabindex="-1">\n      <span class="result-art"><img></span>\n      <span class="result-info">\n        <div class="result-title"><strong></strong></div>\n        <cite></cite>\n        <div class="result-type"></div>\n      </span>\n    </a>\n  </li></template>\n  <div class="signup-tooltip-outer search-tooltip-outer header-2018"></div>\n</form>\n<div aria-label="cancel search" class="cancel-autocomplete" >',{type:"translate",nodelist:["cancel"]},"</div>"]}),void 0===window.Templ?Log.server("Premature template registration: common/fan/templates/complete_profile.liquid","warn"):Templ.register({"common/fan/templates/complete_profile":['<div class="profile-pic">\n\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n        \x3c!-- ko switch --\x3e\n            \x3c!-- ko case: fanImageUploading() --\x3e\n                <label class="placeholder-wrapper loading">\n                    <div class="placeholder loading">\n                        <svg class="spinny-icon" viewBox="0 0 326 324"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ic-spinny"></use></svg>\n                    </div>\n                </label>\n            \x3c!-- /ko --\x3e\n\n            \x3c!-- ko case: $else --\x3e\n                <label class="placeholder-wrapper" for="signup-profile-pic-input" tabindex="0" data-bind="event: { \'keydown\': addProfilePicKeydown }">\n                    \x3c!-- ko if: fanImageId() --\x3e\n                        <img data-bind="src_image: { image_id: fanImageId(), format: \'art_thumb\' }">\n                    \x3c!-- /ko --\x3e\n\n                    \x3c!-- ko if: !fanImageId() --\x3e\n                        <div class="placeholder">\n                            <svg class="camera-icon" viewBox="0 0 28 20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#camera-icon"></use></svg>\n                        </div>\n                    \x3c!-- /ko --\x3e\n                </label>\n            \x3c!-- /ko --\x3e\n        \x3c!-- /ko --\x3e\n        \n    ']},{type:"else_ncondition",attachment:['\n\n        \x3c!-- ko switch --\x3e\n            \x3c!-- ko case: fanImageUploading() --\x3e\n                <label class="placeholder-wrapper loading">\n                    <div class="placeholder loading">\n                        <svg class="spinny-icon" viewBox="0 0 326 324"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ic-spinny"></use></svg>\n                    </div>\n                </label>\n            \x3c!-- /ko --\x3e\n\n            \x3c!-- ko case: fanImageId() --\x3e\n                <div class="profile-pic-wrapper">\n                    <img data-bind="src_image: { image_id: fanImageId(), format: \'art_thumb\' }">\n\n                    <a href="#" class="profile-pic-edit-icon" data-bind="click: toggleEditProfilePic">\n                        <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ic-edit"></use></svg> \n                    </a>\n\n                    \x3c!-- ko if: showEditProfilePic --\x3e\n                        <div class="edit-profile-menu">\n                            <a href="#" data-bind="click: deleteProfilePic">',{type:"translate",nodelist:["Delete profile photo"]},'</a>\n                            <a href="#" data-bind="click: uploadProfilePic">',{type:"translate",nodelist:["Upload new profile photo"]},'</a>\n                        </div>\n                    \x3c!-- /ko --\x3e\n                </div>\n            \x3c!-- /ko --\x3e\n\n            \x3c!-- ko case: !fanImageId() --\x3e\n                <label class="placeholder-wrapper" for="signup-profile-pic-input" tabindex="0" data-bind="event: { \'keydown\': addProfilePicKeydown }">\n                    <div class="placeholder">\n                        <svg class="camera-icon" viewBox="0 0 28 20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#camera-icon"></use></svg>\n                    </div>\n                </label>\n            \x3c!-- /ko --\x3e\n        \x3c!-- /ko --\x3e\n    ']}]},'\n\n    <input id="signup-profile-pic-input" type="file" name="photo" accept="image/*" style="display: none;" data-bind="value: fanImageFakePath, event: { change: addProfilePic }"></input>\n</div>\n\n<div class="item">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:['\n        <label for="complete-profile-name-input" class="name-label">\n            ',{type:"translate",nodelist:["Display name"]},'\n            <span class="hover-hint-wrapper">\n                <a href="#" class="hover-hint-anchor" data-bind="\n                    event: {\n                        \'mouseover\': showNameHint,\n                        \'focus\': showNameHint,\n                        \'mouseout\': hideNameHint,\n                        \'blur\': hideNameHint,\n                    }\n                ">\n                    <svg class="tooltip-icon" viewBox="0 0 16 16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ic-tooltip"></use></svg>\n                </a>\n                <div class="hover-hint" data-bind="visible: nameHintVisible">\n                    <div class="hover-hint-arrow"></div>\n                    ',{type:"translate",nodelist:["Your display name is visible in your public profile, and in various other places across Bandcamp."]},"\n                </div>\n            </span>\n        </label>\n    "]}]},'\n    \n    <div class="name">\n        <div class="name-inner jquery-placeholder-wrapper">\n            <input\n                id="complete-profile-name-input"\n                type="text"\n                class="name-input"\n                data-test="name-input"\n                autocomplete="off"\n                data-bind="\n                    value: name,\n                    errorBubble: name.error_msg,\n                    valueUpdate: \'input\',\n                    hasfocus: name.focused,\n                    css: {\n                        \'has-validation-error\': name.error_msg()\n                    }\n            " ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['placeholder="',{type:"translate",nodelist:["display name"]},'"']}]},'>\n        </div>\n        <div class="error-bubble" style="display: none;"><span class="message"></span></div>\n    </div>\n\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n        <div class="hint">\n            ',{type:"translate",nodelist:["Your display name is visible in your public profile, and in various other places across Bandcamp."]},"\n        </div>\n    "]}]},'\n</div>\n\n<div class="item">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:['\n        <label for="location-input" class="location-label">\n            ',{type:"translate",nodelist:["Location"]},'\n            <span class="hover-hint-wrapper">\n                <a href="#" class="hover-hint-anchor" data-bind="\n                    event: {\n                        \'mouseover\': showLocationHint,\n                        \'focus\': showLocationHint,\n                        \'mouseout\': hideLocationHint,\n                        \'blur\': hideLocationHint,\n                    }\n                ">\n                    <svg class="tooltip-icon" viewBox="0 0 16 16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ic-tooltip"></use></svg>\n                </a>\n                <div class="hover-hint" data-bind="visible: locationHintVisible">\n                    <div class="hover-hint-arrow"></div>\n                    ',{type:"translate",nodelist:["Your location is visible in your public profile."]},"\n                </div>\n            </span>\n        </label>\n    "]}]},'\n\n    <div class="location">\n        <div class="location-inner jquery-placeholder-wrapper">\n            <input\n                id="location-input"\n                type="text"\n                class="location-input"\n                data-test="location-input"\n                autocomplete="off"\n                data-bind="\n                    value: location,\n                    errorBubble: location.error_msg,\n                    valueUpdate: \'input\',\n                    hasfocus: location.focused,\n                    css: {\n                        \'has-validation-error\': location.error_msg()\n                    }\n            " ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['placeholder="',{type:"translate",nodelist:["location"]},'"']}]},'>\n        </div>\n        <div class="error-bubble" style="display: none;"><span class="message"></span></div>\n    </div>\n\n    <div class="location-display">\n        <span data-bind="visible: locationVM.loading">\n            ',{type:"translate",nodelist:["searching"]},'<span class="loading"></span>\n        </span>\n        <span data-bind="visible: !locationVM.isNullLocation() && !locationVM.loading()">\n            ',{type:"translate",nodelist:["(displayed: ",{type:"translateVariable",var_name:"loc_display",nodelist:['<span data-bind="text: locationVM.location"></span>']},")"]},"\n        </span>\n    </div>\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n        <div class="hint">\n            ',{type:"translate",nodelist:["Your location is visible in your public profile."]},"\n        </div>\n    "]}]},'\n</div>\n\n<div class="item">\n    <div class="buttons">\n        <button\n            class="submit"\n            type="submit"\n            data-test="submit"\n            data-bind="enable: !submitting()"\n        >\n            <div data-bind="visible: !submitting()">',{type:"translate",nodelist:["Save profile"]},'</div>\n            <div data-bind="visible: submitting()" style="display: none;">',{type:"translate",nodelist:["Please wait"]},'&hellip;</div>\n        </button>\n    </div>\n</div>\n\n<div class="item skip-wrapper" data-bind="css: { \'hide\': submitting() }">\n    <a class="skip" href="#" data-bind="click: skip">',{type:"translate",nodelist:["Skip"]},"</a>\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/widgets/image_editor_dialog.liquid","warn"):Templ.register({"widgets/image_editor_dialog":["<div class='crop-tool'></div>\n<div class='status' data-bind='animateVisible: saving() || uploading()'>\n    <div class='status-text'>Saving&hellip;</div>\n    <div class='upload-progress'></div>\n</div>\n<div class='error' data-bind='animateVisible: error'>\n    \x3c!-- ko if: error() === 'image' --\x3eThe image could not be loaded. You can try uploading it but it'll probably fail.\x3c!-- /ko --\x3e\n    \x3c!-- ko if: error() === 'network' --\x3eThere was a network error. Please try again.\x3c!-- /ko --\x3e\n</div>\n<div class='buttons'>\n    <a class='save-button' data-bind='click: save, css: {disabled: saving() || uploading()}'>Save</a>\n    <a class='cancel' data-bind='click: cancel'>Cancel</a>\n    <div class='save-progress' data-bind='animateVisible: saving() || uploading()'>&nbsp;</div>\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/widgets/bccroptool.liquid","warn"):Templ.register({"widgets/bccroptool":["\n<div class='loading-indicator' data-bind='animateVisible: imageLoading'></div>\n<div class='target'>\n    <img class='image' src='/img/blank.gif' data-bind='\n        attr: {src: imageSrc},\n        css: {hidden: imageLoading()},\n        style: {\n            left: displayLeft() + \"px\",\n            top: displayTop() + \"px\",\n            width: displayWidth() + \"px\",\n            height: displayHeight() + \"px\"\n        }'>\n    <div class='center-crosshair' data-bind='\n        visible: showZoomCenter,\n        style: {\n            left: zoomCenterLeft() + \"px\",\n            top: zoomCenterTop() + \"px\"\n        }'>\n        +\n    </div>\n    <div class='target-border'></div>\n</div>\n<div class='border'></div>\n<div class='zoom-slider'></div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/widgets/image_editor.liquid","warn"):Templ.register({"widgets/image_editor":["<div class='crop-tool'></div>\n<div class='editor-info'>\n    <div class='status' data-bind='animateVisible: saving() || uploading()'>\n        <div class='status-text'>",{type:"translate",nodelist:["Saving&hellip;"]},"</div>\n        <div class='upload-progress'></div>\n    </div>\n    <div class='error' data-bind='animateVisible: error'>\n        \x3c!-- ko if: error() === 'image' --\x3e",{type:"translate",nodelist:["The image could not be loaded. You can try uploading it but it’ll probably fail."]},"\x3c!-- /ko --\x3e\n        \x3c!-- ko if: error() === 'network' --\x3e",{type:"translate",nodelist:["There was a network error. Please try again."]},"\x3c!-- /ko --\x3e\n    </div>\n</div>\n"]});var Captcha=function(){"use strict";let e=null;const t={};let n,a=null;function i(n,a){let i=t[n];if(!i){const o=$.Deferred();i=o.promise(),t[n]=i,(e||(e=$.Deferred(),window.bcCaptchaOnloadCallback=function(){Log.debug("loaded recaptcha"),e.resolve()},Log.debug("requesting recaptcha"),$.cachedScript("https://www.google.com/recaptcha/api.js?onload=bcCaptchaOnloadCallback&render=explicit")),e.promise()).then((function(){Log.debug("rendering recaptcha for element "+n);const e=grecaptcha.render(n,a);o.resolve(e)}))}return i}return{renderInvisible:function(){return i("global-invisible-recaptcha",{sitekey:$("#pagedata").data("blob").invisible_recaptcha_public_key,size:"invisible",callback:function(e){null!==a&&($(window).scrollTop(a),a=null),n(e)}}).then((function(){$("#global-invisible-recaptcha").fadeIn()}))},execute:function(e){const i=t["global-invisible-recaptcha"];if(!i)throw"Must call Captcha.renderInvisible() before calling execute()";n=e,i.then((function(e){a=$(window).scrollTop(),$("#global-invisible-recaptcha").css("top",a+50+"px"),Log.debug("executing invisible recaptcha (scrollTopBeforeExecute = "+a+")"),grecaptcha.reset(e),grecaptcha.execute(e)}))},hideInvisible:function(){$("#global-invisible-recaptcha > div").fadeOut()}}}(),Money=function(e){"use strict";return function(e){let t,n;if(!e)throw"missing money input";if(t=e.amount,n=e.currency,"number"!=typeof t||t%1!=0)throw"invalid amount";if("string"!=typeof n||3!==n.length)throw"invalid currency"}(e),{amount:e.amount,currency:e.currency,is_money:!0,add:function(e){if(!e.is_money)throw"type mismatch";if(e.currency!==this.currency)throw"currency mismatch";return new Money({amount:this.amount+e.amount,currency:this.currency})},subtract:function(e){if(!e.is_money)throw"type mismatch";if(e.currency!==this.currency)throw"currency mismatch";return new Money({amount:this.amount-e.amount,currency:this.currency})},format:function(e){return void 0===e&&(e=6),TextFormat.money(this,e)},negate:function(){return new Money({amount:-1*this.amount,currency:this.currency})},scaleAndRound:function(e){const t=CurrencyData.info[this.currency].places;return new Money({amount:Math.round(Math.pow(10,2-t)*Math.round(e*this.amount*Math.pow(10,t-2))),currency:this.currency})}}};function QueuedUploader(e){"use strict";const t=e.progress||$.noop,n=e.finish||$.noop,a=e.start||$.noop,i=$.extend({},e),o=[];let s,r,l;function c(){if(d())return;let e;for(let t=0;t<o.length;t++)if("queued"===o[t].state){e=o[t];break}e?(s||(r={lastUpdated:new Date,totalSent:0,bytesPerSecond:0,secondsRemaining:NaN},l=setInterval(f,m),a(),s=setInterval(p,1e3)),e.state="uploading",e.displayState=TM("uploading","dev"),e.trigger("start")):s&&function(){n(),o.length=0,s&&(clearInterval(s),s=null);!function(){l&&(clearInterval(l),l=null);r=null}()}()}function d(){for(let e=0;e<o.length;e++)if(o[e].working())return!0;return!1}function p(){const e=function(){const e={validating:0,queued:0,uploading:0,processing:0,finished:0,failed:0};let t=0,n=0;for(let a=0;a<o.length;a++){const i=o[a],s=o[a].state;e[s]=(e[s]||0)+1,"failed"!==s&&(t+=i.sent,n+=i.size)}return $.extend(e,{bytesSent:t,totalBytes:n})}(),n=(new Date-r.lastUpdated)/1e3;e.totalJobs=o.length,e.bytesPerSecond=r.bytesPerSecond,e.secondsRemaining=Math.max(0,r.secondsRemaining-n),t(e)}this.queueFile=function(e,t){const n=(t=$.extend({},i,t)).postURL,a=t.uploaderInfo,s=function(e,t,n){const a=n.filter,i=a&&function(e){const t="^("+e.replace(/;/g,"|").replace(/\./g,"\\.").replace(/\*/g,".+")+")$";return new RegExp(t,"i")}(a.extensions),s=n.maxFileSize,l=n.validate;var p={filename:e,size:t,sent:0,state:"validating",displayState:TM("validating","dev"),working:function(){return"uploading"===p.state||"processing"===p.state},fail:function(e,t){Log.error("Job failed",p,e,t),p.errorReason=e,p.errorMessage=t,p.state="failed",p.displayState=TM("failed","dev"),p.trigger("error")},cancel:function(){!function(e){const t=Iter.index(o,e);-1!==t&&(o.splice(t,1),r&&(r.totalSent-=e.sent,f()))}(p),p.trigger("cancel")},on:function(e,t){return $(p).on(e,t),p},trigger:function(e){return $(p).triggerHandler(e),p},processUploadResponse:function(e){p.responseData=e,e.error?p.fail(e.reason,e.message||e.exception||TM("Unknown error","dev")):(p.state="finished",p.displayState=TM("finished","dev"),p.trigger("finish"))},processUploadFailure:function(e,t,n){Log.error("XHR error",e,t,n),0===e.status?p.fail("xhr",TM("There was a network error. Please try again.","dev")):p.fail("xhr",t)}};p.on("start",(function(){p.startDate=new Date})),p.on("progress",g),p.on("finish error cancel",c),o.push(p),d()&&f();return setTimeout((function(){function n(){p.state="queued",p.displayState=TM("queued","dev"),p.trigger("queue"),c()}a&&!i.test(e)?p.fail("extension",TM("Type Error: {{file_name}} is not {{file_type}}","dev",{file_name:e,file_type:a.description},'"file_type" is a phrase, i.e. "an image file"')):s&&t>s?p.fail("size",TM("That file is {{file_size}}, max allowed is {{max_file_size}}.","dev",{file_size:TextFormat.toMb(t),max_file_size:TextFormat.toMb(s)})):l?l(p,(function(e,t){e?p.fail(e,t):n()})):n()}),0),p}(e.name,e.size,t);return s.on("start",(function(){const t=new FormData;let i,o;i=a.url,o=function(t,i){s.state="processing",s.displayState=TM("processing","dev"),s.trigger("progress");const o=new Date-s.startDate;let r;if("uploader"==a.type){const t=$.parseJSON(i);r={type:a.type,filename:e.name,server:t.server,id:t.id,hash:t.hash}}else r={type:a.type,filename:e.name,key:t.key};r.duration=o,Crumb.ajax({type:"POST",url:n,data:r,context:s,success:s.processUploadResponse,error:s.processUploadFailure})};const r=function(n){for(const e in n)t.append(e,n[e]);t.append("file",e);const i=$.upload(a.url,t,a.type);i.on("progress",(function(e){s.sent=e.loaded,s.size=e.total,s.trigger("progress")})).done((function(e){o(n,e)})).fail(s.processUploadFailure),s.on("cancel",(function(){i.abort()}))};if("gcs"==a.type){let t=!1;s.on("cancel",(function(){t=!0})),PublicAPI.call("GCSUploadInfo_1","get_upload_params",{filename:e.name}).then((function(e){if(!t){const t={};a.url=e.url,e.params.forEach((function(e){t[e.key]=e.value})),r(t)}})).catch(s.processUploadFailure)}else if("s3"==a.type){a.upload_index=uploadInfo.upload_index||1;const e=filename.replace(/\W/g,"_"),t=a.key_base+a.upload_index+"_"+e;a.upload_index++,a.params.key=t,r(a.params)}else r(a.params)})),s},this.working=d;const u=3e4,m=5e3,h=3e4;function f(){let e=0,t=0;for(let n=0;n<o.length;n++){const a=o[n];"failed"!==a.state&&(e+=a.sent,t+=a.size)}const n=new Date,a=n-r.lastUpdated,i=e-r.totalSent,s=1e3*i/a;let l=1;if(0===r.totalSent)r.firstEstimateTime=n;else{l=a/(Math.min(n-r.firstEstimateTime,u)+a)}r.bytesPerSecond=l*s+(1-l)*r.bytesPerSecond;const c=r.bytesPerSecond<1024||n-r.lastProgress>h;r.secondsRemaining=c?NaN:(t-e)/r.bytesPerSecond,r.totalSent=e,r.lastUpdated=n,Log.debug(a+" ms elapsed, "+i+" bytes, "+Math.round(.001*s)+"KB/s raw, "+.01*Math.round(100*l)+" alpha, "+Math.round(.001*r.bytesPerSecond)+"KB/s filtered, "+Time.strftime(new Date(1e3*r.secondsRemaining),"%M:%S remaining"))}function g(){r&&(r.lastProgress=new Date)}}function SimpleProgress(e){"use strict";this._element=$(e),this._unique=Math.round(1e5*Math.random()).toString(),this._element.html('<div id="progress_outer_'+this._unique+'" class="progress_outer"><div id="progress_inner_'+this._unique+'" class="progress_inner">&nbsp;</div></div>'),this.update=function(e,t,n){let a=0;a="number"==typeof n?n:100*e/t;const i=$("#progress_inner_"+this._unique);i?i.css("width",a+"%"):Log.debug("missing progress_inner")},this.done=function(){this._element.html("done.")},this.remove=function(){this._element.remove()},this.clear=function(){this._element.html("")}}function uploadImage(e,t,n){"use strict";let a=uploadImage.uploader;a||(a=uploadImage.uploader=new QueuedUploader({filter:QueuedUploader.FILTERS.image,maxFileSize:4194304,uploaderInfo:UploadInfo}));let i=e.targetURL;const o=e.maxSize,s=e.file,r=e.container,l=e.errorHandler;if(!Url.isFullyQualified(i)){const e=Url.toHash(window.location.href);i=Url.fullyQualify(i,e)}const c={postURL:i,maxFileSize:o};!function(e){const a=elt(r),i=$(".upload-progress",a)[0],s=$(".filename",a)[0];let c;function d(e){$(a).removeClass("uploading"),Form.setSubmitBlock(null)}e.on("queue",(function(){$(a).addClass("uploading"),Dom.setText(s,Text.escapeHtml(e.filename)),c=new SimpleProgress(i),c.update(0,e.size),n&&n(e)})).on("start",(function(){Form.dirtyForm(),Form.setSubmitBlock("Please wait until the image finishes uploading before saving.")})).on("progress",(function(){c.update(e.sent,e.size)})).on("finish",(function(){d(),t(e.responseData)})).on("error",(function(){!function(){if(l){try{l(e)}catch(e){Log.error("caught error in uploadImage error handler: "+e)}return}let t,n;if(e.responseData)t="coverarterror",n=e.responseData,"image"==e.responseData.major&&"upload_copyright_error"==e.responseData.minor&&BCAPI.call("PreviouslyUploaded_1","associate_upload_attempt",{shachecksum:e.responseData.deets,account_type:"band",account_id:BandData.id,user_id:Identities.user().id});else if("size"===e.errorReason)t="coverarterror",n={major:"image",minor:"filesize",deets:"your file is "+TextFormat.toMb(e.size)+", the maximum size is "+TextFormat.toMb(o)};else{t="upload_error";const a=e.errorMessage;n={message:a&&Text.escapeHtml(a),laconic:!a||/Network error:/.test(a)}}const a=[];a.push({text:TM("OK"),click:function(e){$(this).dialog("close")}});const i=TM("Image Upload Error");NuDialog.showTemplate(t,n,{buttons:a,title:i})}(),d(),t(null)}))}(a.queueFile(s,c))}QueuedUploader.FILTERS={losslessAudio:{description:TM("a lossless audio file","dev"),extensions:"*.wav;*.aiff;*.aif;*.flac",mimetypes:["audio/wav","audio/aiff","audio/flac","audio/x-flac","application/x-flac"]},image:{description:TM("an image file","dev"),extensions:"*.png;*.jpg;*.gif;*.jpeg"},video:{description:TM("a video file","dev"),extensions:"*.*"},crowdfundingMastersAudio:{description:TM("a .wav file","dev"),extensions:"*.wav",mimetypes:["audio/wav"]}};var UploadImageErrors={doDialog:function(e,t){"use strict";return NuDialog.alert(e+" Upload Error",this.prepErrorString(t))},prepErrorString:function(e){"use strict";const t=e.match(/^exception\: Band(\w*)\: (\w*)\:(\w*)(\:\s*(.*))*/);let n=null;if(t&&t[3])switch(t[3]){case"filesize":case"filedimensions":case"filedimensionsmax":case"aspectratio":(t[5]||t[4])&&(n=t[5].charAt(0).toUpperCase()+t[5].slice(1));break;case"bad":case"badimage":n="Error processing image file. Please verify that it's one of the supported types and try again.";break;case"upload_copyright_error":t[5]&&BCAPI.call("PreviouslyUploaded_1","associate_upload_attempt",{shachecksum:t[5],account_type:"band",account_id:BandData.id,user_id:Identities.user().id}),n="This image couldn’t be uploaded because it has been identified as a copyright infringement. Please contact copyright@bandcamp.com for more information."}return n||(e?(/^Type Error\:/.test(e)&&(e="file must be .jpg, .gif,  or .png."),n="Oops, "+e):n="Oops, something unexpected happened. Please try uploading your background image again."),"."!=n.charAt(n.length-1)&&(n+="."),n}};!function(e){"use strict";const t=window.XMLHttpRequest?new XMLHttpRequest:null;var n=null;let a=!0;try{(n=document.createElement("input")).type="file",n.disabled&&(a=!1)}catch(e){a=!1}finally{n&&n.parentNode&&n.parentNode.removeChild(n)}a||"mac"!=Browser.platform&&"win"!=Browser.platform||Log.server("Unexpected disabling of file upload, local userAgent: "+navigator.userAgent,"WARN"),e.support.upload=t&&"upload"in t&&window.FormData&&a,e.upload=function(t,n,a){const i={url:t,type:"POST",data:n,cache:!1,contentType:!1,processData:!1,xhrFields:{withCredentials:"uploader"===a},xhr:function(){const t=new XMLHttpRequest;return e(t.upload).on("progress",s),t}},o=e.ajax(i);function s(t){const n=t.originalEvent;t.loaded=n.loaded,t.total=n.total,e(o).trigger(t)}return o.on=function(t,n){return e(this).on(t,n),this},o};const i=["margin-top","margin-right","margin-bottom","margin-left"];let o=!1;e.fn.wrapFileInput=function(t){return this.each((function(n,a){!function(t,n){const a=n.select||e.noop,s=n.click||e.noop,r=n.clickStat||null,l=n.multiple||!1,c=n.accept||null,d=e(t);let p=e(t).closest("html5-upload-wrapper");if(p.length>1)return;const u=e('<input type="file">').attr("multiple",l?"":null).attr("accept",c||null).on("click",(function(){const e=s.apply(this,Array.prototype.slice.apply(arguments));return null!==r&&Stats.record({kind:r}),e})).on("change",(function(){this.files&&this.files[0]&&a.call(this,this.files),e(this).val("")})).css({position:"absolute",opacity:0,"z-index":1e4,cursor:"pointer"}),m=e("<div/>").addClass("input-wrapper").append(u).css({position:"absolute",overflow:"hidden"});p=e("<div/>").addClass("html5-upload-wrapper").css({position:"relative",display:"inline-block",cursor:"pointer"});for(let e=0;e<i.length;e++){const t=i[e];p.css(t,d.css(t)),d.css(t,0)}Capabilities.hasHover()?(u.css({right:"-1em",top:"-.5em"}),m.css({width:"3px",height:"3px"}),p.on("mouseenter",(function(){o&&(Log.debug("mouseenter file wrapper"),Log.debug("element offset",d.offset())),d.addClass("hover")})).on("mouseleave",(function(){o&&Log.debug("mouseleave file wrapper"),d.removeClass("hover")})).on("mousemove",(function(e){o&&console.log("mousemove file wrapper "+e.pageX+" "+e.pageY);const t=d.offset(),n=d.outerWidth(),a=d.outerHeight(),i=Math.max(t.left,Math.min(t.left+n,e.pageX))-1,s=Math.max(t.top,Math.min(t.top+a,e.pageY))-1;m.offset({left:i,top:s})}))):(u.css({width:"100%",height:"100%","min-width":"100%","max-width":"100%"}),m.css({width:"100%",height:"100%"}));d.wrap(p).before(m)}(a,t)}))},window.bcDebugFileInputWrappers=function(){o=!0,e(".html5-upload-wrapper > .input-wrapper").css("outline","solid 2px red").css("overflow","visible").find("input").css("opacity","0.75")}}(jQuery),function(e,t,n){"use strict";e.HTML5ImageUploader=function(e){const a=this;a.uploading=n.observable(!0),a.uploadDeferred=t.Deferred(),a.uploadPromise=a.uploadDeferred.promise(),a._uploader=new QueuedUploader({filter:QueuedUploader.FILTERS.image,maxFileSize:10485760,uploaderInfo:UploadInfo,finish:function(){"finished"===a.job.state?a.uploadDeferred.resolve(a.job.responseData):a.uploadDeferred.reject(a.job.state),a.uploading(!1)},failed:function(){a.uploadDeferred.reject("upload")}}),a.uploadFromComputer=function(e,t){a.uploading(!0),a.job=a._uploader.queueFile(t,{postURL:e})},a.uploadFromURL=function(e,t,n){const a=this;a.uploading(!0);const i={photo_image_url:t,photo_image_source:n,fan_id:Identities.fan().id};Crumb.ajax({type:"POST",url:e,data:i,dataType:"json",success:function(e){e.ok?a.uploadDeferred.resolve(e):a.uploadDeferred.reject("upload"),a.uploading(!1)},error:function(e,t,n){a.uploadDeferred.reject("upload")}})}}}(window,jQuery,ko),function(){"use strict";const e=new QueuedUploader({maxFileSize:1e7,filter:QueuedUploader.FILTERS.image,uploaderInfo:UploadInfo});ko.components.register("image-upload",{viewModel:function(t){const n=this;this.imageID=t.id,this.imageHash=t.hash,this.canDelete=t.canDelete,this.imageFormat=t.format,this.postURL=t.postURL||"/upload_image",this.imageParams=ko.pureComputed((function(){return{image_id:ko.unwrap(n.imageID),format:ko.unwrap(n.imageFormat)}})),this.deleteImage=function(){n.imageID(null)},this.uploadFile=function(t,a){const i=a.target.files[0];if(a.target.value=null,!i)return;n.uploading(!0),n.progress(0);const o={postURL:ko.unwrap(n.postURL)};var s=e.queueFile(i,o).on("progress",(function(){n.progress(s.sent/s.size)})).on("finish",(function(){const e=s.responseData;n.imageID(e.id),n.imageHash(e.hash),n.uploading(!1)})).on("error",(function(){n.uploading(!1),NuDialog.alert(s.errorReason,s.errorMessage)}))},this.uploading=ko.observable(!1),this.progress=ko.observable(0),this.progressWidth=ko.pureComputed((function(){return 100*n.progress()+"%"}))},template:'<div class="knockout-image-upload" data-bind="css: {\'knockout-image-upload-no-art\': !imageID()}">    <div class="knockout-image-upload-content">    \x3c!-- ko if: imageID --\x3e       <img data-bind="src_image: imageParams">    \x3c!-- /ko --\x3e    \x3c!-- ko ifnot: imageID --\x3e       <label class="knockout-image-upload-add" data-bind="visible: !uploading()"><input type="file" data-bind="event: {change: uploadFile}">add</label>       <div class="knockout-image-upload-progress-outer" data-bind="visible: uploading">           <div class="knockout-image-upload-progress-inner" data-bind="style: {width: progressWidth}"></div>       </div>    \x3c!-- /ko --\x3e    </div>\x3c!-- ko if: imageID --\x3e    <button class="knockout-image-upload-delete" data-bind="click: deleteImage, visible: canDelete" title="delete">&times;</button>\x3c!-- /ko --\x3e</div>'})}(),function(e,t,n){"use strict";const a=Number.MAX_VALUE;function i(e,t,i,o){const s=this;this.targetScale=o,this.targetDisplayWidth=t*this.targetScale,this.targetDisplayHeight=i*this.targetScale,this.originalImageLoaded=function(e){s.imageWidth(e.naturalWidth||e.width),s.imageHeight(e.naturalHeight||e.height),s.canvasScale(Math.min(a/s.imageWidth(),a/s.imageHeight()));const n=Math.max(t/s.imageWidth(),i/s.imageHeight());s.scaleMin(n),s.scale(n),s.displayLeft((s.targetDisplayWidth-s.displayWidth())/2),s.displayTop((s.targetDisplayHeight-s.displayHeight())/2),s.resetZoomCenter()},this.imageLoadFailed=function(){s.imageError(!0),s.imageLoading(!1),Stats.record({kind:"edit image load error"})},this.imageSrc=n.observable(e),this.imageError=n.observable(!1),this.imageWidth=n.observable(0),this.imageHeight=n.observable(0),this.imageLoading=n.observable(!0),this.canvasScale=n.observable(1),this.canvasWidth=n.computed((function(){return s.canvasScale()*s.imageWidth()})),this.canvasHeight=n.computed((function(){return s.canvasScale()*s.imageHeight()})),this.scaleMin=n.observable(1),this.scale=n.observable(1).extend({min:this.scaleMin,max:1}),this.displayWidth=n.computed((function(){return s.scale()*s.targetScale*s.imageWidth()})),this.displayHeight=n.computed((function(){return s.scale()*s.targetScale*s.imageHeight()})),this.displayLeftMin=n.computed((function(){return s.targetDisplayWidth-s.displayWidth()})),this.displayTopMin=n.computed((function(){return s.targetDisplayHeight-s.displayHeight()})),this.displayLeft=n.observable(0).extend({min:this.displayLeftMin,max:0}),this.displayTop=n.observable(0).extend({min:this.displayTopMin,max:0}),this.cropLeft=n.computed((function(){return-s.displayLeft()/s.targetScale/s.scale()})),this.cropTop=n.computed((function(){return-s.displayTop()/s.targetScale/s.scale()})),this.cropWidth=n.computed((function(){return t/s.scale()})),this.cropHeight=n.computed((function(){return i/s.scale()})),this.showZoomCenter=n.observable(!1),this.zoomCenterX=n.observable(0),this.zoomCenterY=n.observable(0),this.zoomCenterLeft=n.computed((function(){return s.scale()*s.targetScale*(s.zoomCenterX()-s.cropLeft())})),this.zoomCenterTop=n.computed((function(){return s.scale()*s.targetScale*(s.zoomCenterY()-s.cropTop())})),this.resetZoomCenter=function(){s.zoomCenterX=n.observable(s.cropLeft()+.5*s.cropWidth()),s.zoomCenterY=n.observable(s.cropTop()+.5*s.cropHeight())}}e.ImageEditorNuDialog=function(e){const a=this;t("#pagedata").data("blob").cfg;a.page=e.page,a.imgSrc=e.imgInfo.src,a.imgId=e.imgInfo.id,a.imgHash=e.imgInfo.hash,a.minWidth=e.minWidth,a.minHeight=e.minHeight,a.saving=n.observable(!1),a.uploading=n.observable(!1),a.error=n.observable(""),a.finishedDeferred=new t.Deferred,a.finishedPromise=a.finishedDeferred.promise(),a.saveDeferred=new t.Deferred,a.savePromise=a.saveDeferred.promise(),this.savePromise.always((function(){a.dialog.dialog("close")})),a.cancel=function(){a.dialog.dialog("close")},a.saving.subscribe((function(e){t(".crop-tool",a.dialog.body).bccroptool(e?"disable":"enable")})),a.save=function(){a.saving()||a.uploading()||(a.saving(!0),a.error(null),Crumb.ajax({type:"POST",url:"/edit_image",data:a.postParams(a.imgId,a.imgHash),success:function(e){e.ok?(a.finishedDeferred.resolve(e),a.saveDeferred.resolve(e)):(a.saving(!1),a.error("network"))},error:function(e){a.saving(!1),a.error("network")}}))},a.postParams=function(e,t){return{id:e,hash:t,crop_left:Math.round(a.cropViewModel.cropLeft()),crop_top:Math.round(a.cropViewModel.cropTop()),crop_width:Math.round(a.cropViewModel.cropWidth()),crop_height:Math.round(a.cropViewModel.cropHeight())}};const i={};let o=TM("Crop Image",{},"Modify profile image.");"collection"===a.page?i[TM("OK",null,"Save profile image")]=a.save:"live event editor"===a.page?(i[TM("OK","dev")]=a.save,o=TM("Crop image","dev")):i[TM("Save")]=a.save,i[TM("Cancel")]=a.cancel,a.dialog=NuDialog.showTemplate("widgets/image_editor",{},{title:o,dialogClass:"image-editor-dialog",buttons:i,close:function(){a.finishedDeferred.isResolved()||a.finishedDeferred.reject("aborted"),a.dialog.remove()}}),a.cropViewModel=t(".crop-tool",a.dialog.body).bccroptool({minWidth:a.minWidth,minHeight:a.minHeight,imgSrc:a.imgSrc}).bccroptool("viewModel"),n.applyBindings(a,a.dialog.find(".editor-info")[0]),a.dialog.dialog("option","position","centre")},t.widget("bc.bccroptool",{options:{imgSrc:null,minHeight:400,minWidth:400},_viewModel:null,viewModel:function(){return this._viewModel},move:function(e,t){const n=this._viewModel;n.displayLeft(n.displayLeft()+e),n.displayTop(n.displayTop()+t),n.resetZoomCenter()},zoom:function(e,t,n){const a=this._viewModel,i=a.scale()*e;if(!(i>1||i<a.scaleMin()))if(void 0===t){a.scale(i);const e=.5*a.targetDisplayWidth-a.zoomCenterLeft(),t=.5*a.targetDisplayHeight-a.zoomCenterTop();a.displayLeft(a.displayLeft()+e),a.displayTop(a.displayTop()+t)}else{const o=e*(a.displayLeft()-t)+t,s=e*(a.displayTop()-n)+n;a.scale(i),a.displayLeft(o),a.displayTop(s)}},_setOption:function(e,t){"disabled"===e&&this._zoomSlider&&this._zoomSlider.option(e,t),this._super(e,t)},_create:function(){if(!this.options.imgSrc)throw"Must specify imgSrc option for bccroptool";const e=this;this.element.addClass("bccroptool").renderLiquid("widgets/bccroptool").find(".image").one("load",(function(){const t=this;e._viewModel.originalImageLoaded(t),e._viewModel.canvasScale()<1?e._useRescaledImage(t):e._viewModel.imageLoading(!1)})).one("error",(function(t){e._viewModel.imageLoadFailed()})).end();const t=this.options.minWidth,a=this.options.minHeight,o=this.element.find(".target"),s=Math.min(o.width()/t,o.height()/a);this._$target=o,this._viewModel=new i(this.options.imgSrc,t,a,s),n.applyBindings(this._viewModel,this.element[0]),Capabilities.hasTouch()?this._initTouch():(this._initSlider(),this._initMouse())},_useRescaledImage:function(e){const n=this._viewModel,a=n.canvasWidth(),i=n.canvasHeight(),o=t("<canvas>").attr({width:a,height:i})[0],s=o.getContext("2d");function r(e){e?n.imageSrc(e):Log.error("failed to create scaled image url")}this.element.find(".image").one("load",(function(){n.imageLoading(!1)})).one("error",(function(){n.imageLoadFailed()})),s.drawImage(e,0,0,a,i),"toBlobHD"in o?o.toBlobHD(r):"toBlob"in o?o.toBlob(r):r("toDataURLHD"in o?o.toDataURLHD():o.toDataURL())},_initSlider:function(){const e=this,t=this.element.find(".zoom-slider");t.slider({orientation:"horizontal",max:1,min:0,step:.001}).on("mousedown",(function(e){e.stopPropagation()})),this._zoomSlider=t.data("ui-slider"),this._on(".zoom-slider",{slide:function(e,t){const n=t.value,a=this._viewModel.scaleMin(),i=this._viewModel.scale(),o=a+(1-a)*n;this.zoom(o/i)}}),this._viewModel.scale.subscribe((function(t){const n=e._viewModel.scaleMin();e._zoomSlider.value((t-n)/(1-n))}))},_initMouse:function(){let e,n;const a=this;function i(e){const t=e.originalEvent||e,n=-t.wheelDelta||t.detail||t.deltaY;return this.zoom(Math.pow(2,n/500)),!1}this._on({mousedown:function(i){return e=i.clientX,n=i.clientY,t("body").on("mousemove.bccropdrag",(function(t){const i=t.clientX,o=t.clientY;t.altKey||t.shiftKey||t.ctrlKey?a.zoom(Math.pow(2,(n-o)/100)):a.move(i-e,o-n),e=i,n=o})).one("mouseup.bccropdrag mouseleave.bccropdrag",(function(e){t("body").off("mousemove.bccropdrag")})),!1},mousewheel:i,DOMMouseScroll:i,wheel:i})},_initTouch:function(){let e;const t=this;function n(e){let n=0,a=0;Iter.each(e,(function(e){n+=e.pageX,a+=e.pageY}));const i=n/e.length,o=a/e.length;let s=0;Iter.each(e,(function(e){s+=Math.pow(e.pageX-i,2)+Math.pow(e.pageY-o,2)}));const r=t._$target.offset();return{x:i-r.left,y:o-r.top,spread:Math.sqrt(s)/e.length}}this._on({touchstart:function(t){e=n(t.originalEvent.targetTouches)},touchmove:function(t){const a=n(t.originalEvent.targetTouches);this.move(a.x-e.x,a.y-e.y),a.spread&&e.spread&&this.zoom(a.spread/e.spread,a.x,a.y),e=a,t.preventDefault()}})}})}(window,jQuery,ko),function(e,t,n){"use strict";e.CompleteProfileVM=function(e){const a=this;a.fanImageId=n.observable(e.imageId),a.fanImageHash=n.observable(null),a.fanImageFakePath=n.observable(""),a.fanImageUploading=n.observable(!1),a.showEditProfilePic=n.observable(!1),a.toggleEditProfilePic=function(){a.showEditProfilePic(!a.showEditProfilePic())},a.deleteProfilePic=function(){a.showEditProfilePic(!1),a.fanImageId(!1),a.fanImageHash(!1),a.fanImageFakePath(""),a.fanImageUploading(!1)},a.uploadProfilePic=function(){document.getElementById("signup-profile-pic-input").click()},a.addProfilePicKeydown=function(e,t){return 13!==t.keyCode||(document.getElementById("signup-profile-pic-input").click(),!1)},a.addProfilePic=function(e,t){a.showEditProfilePic(!1);const n=event.target.files[0];if(!n)return;const i=new FileReader,o=new Image;i.readAsDataURL(n),i.onload=function(e){o.src=e.target.result,o.onload=function(){const e=this.width,t=this.height;n.size>4194304?(NuDialog.alert(TM("Error"),TM("Your image is too large. Please select an image that is less than 4 MB.","pre")),a.fanImageUploading(!1),a.fanImageFakePath("")):e<480||t<480?(NuDialog.alert(TM("Error"),TM("Your image is too small, it must be at least 480 x 480 pixels wide and tall.","pre")),a.fanImageUploading(!1),a.fanImageFakePath("")):n.type.includes("gif")||n.type.includes("jpeg")||n.type.includes("png")?(a.fanImageUploading(!0),a.getUploader().uploadFromComputer("/fan_photo_uploaded",n)):(NuDialog.alert(TM("Error"),TM("Your image is an unsupported format. Please upload a jpg, gif, or png file.","pre")),a.fanImageUploading(!1),a.fanImageFakePath(""))},o.onerror=function(){NuDialog.alert(TM("Error","dev"),TM("We couldn’t upload your profile image. Please try again.","pre")),a.fanImageUploading(!1),a.fanImageFakePath("")}}};a.getUploader=function(){const e=new HTML5ImageUploader;return e.uploadPromise.done((function(e){!function(e){a.fanImageUploading(!1);const t=e.image_id,n=ImageUtils.imageURL(t,"original"),i=e.image_hash;new ImageEditorNuDialog({imgInfo:{src:n,id:t,hash:i},minWidth:800,minHeight:800,page:a.page}).finishedPromise.done((function(e){a.fanImageId(e.id),a.fanImageHash(e.hash),document.getElementById("complete-profile-name-input").focus()})).fail((function(){a.fanImageFakePath(""),a.fanImageUploading(!1),document.getElementById("complete-profile-name-input").focus()}))}(e)})).fail((function(e){a.fanImageUploading(!1),NuDialog.alert(TM("Error","pre"),TM("We couldn’t upload your profile image. Please try again.","pre")),a.fanImageFakePath("")})),e},a.locationVM=new FanLocationVM(e.location,e.rawLocation),a.name=n.observable(e.name).extend({errorKeys:{tooLong:TM("That display name is too long. Please try again.","pre")}}),a.name.validate=function(){const e=t.trim(a.name());a.name.error_key(e.length>100?"tooLong":null)},a.location=a.locationVM.rawLocation.extend({errorKeys:{tooLong:TM("That location is too long. Please try again.","pre")}}),a.location.validate=function(){const e=t.trim(a.name());a.location.error_key(e.length>1e3?"tooLong":null)},a.nameHintVisible=n.observable(!1),a.showNameHint=function(){a.nameHintVisible(!0)},a.hideNameHint=function(){a.nameHintVisible(!1)},a.locationHintVisible=n.observable(!1),a.showLocationHint=function(){a.locationHintVisible(!0)},a.hideLocationHint=function(){a.locationHintVisible(!1)},a.hasErrors=n.computed((function(){let e=!1;return["name","location"].forEach((function(t){e=e||a[t].error_key()})),e})),this.validate=function(){return["name","location"].forEach((function(e){a[e].validate()})),!a.hasErrors()},a.submitting=n.observable(!1),a.submit=function(){if(!a.validate())return void(e.onValidationError&&e.onValidationError());a.submitting(!0);const n={name:a.name(),location:a.locationVM.rawLocation()};a.fanImageId()&&(n.image_id=a.fanImageId(),a.fanImageHash()&&(n.image_hash=a.fanImageHash())),e.params&&t.extend(n,e.params),SignupAPI.completeProfile(n).then((function(t){a.submitting(!1),a.fanImageHash(null),e.onSubmit&&e.onSubmit(n)}),(function(t){a.submitting(!1),e.onError&&e.onError(t&&t.error)}))},a.skip=function(){e.onSubmit()}}}(window,$,ko),function(e,t,n){"use strict";const a={f:"fan/tooltips/feed_tooltip",s:"fan/tooltips/search_tooltip",d:"fan/tooltips/discover_tooltip",b:"fan/tooltips/follow_tooltip",g:"fan/tooltips/genre_follow_tooltip",w:"fan/tooltips/wishlist_tooltip",x:"fan/tooltips/wishlist_button_tooltip",o:"fan/tooltips/fan_follow_tooltip",c:"fan/tooltips/collection_tooltip"},i=function(n,a){const i=this,o=t(a);n=n||{},i.tooltips=n.tooltips,i.numTooltips=n.num_tooltips,i.tooltipNumber=n.tooltip_number,i.currentIndex=n.current_index,i.complete=n.complete,i.deferred=n.deferred,i.$root=o,i.showFirstWishlistTooltip=n.show_first_wishlist_tooltip,i.firstWishlistedItemTitle=n.first_wishlisted_item_title,i.firstWishlistedItemType=n.first_wishlisted_item_type,i.firstPurchasedItemTitle=n.first_purchased_item_title,i.firstPurchasedItemType=n.first_purchased_item_type,i.fanName=e.FanData&&e.FanData.name||Identities&&Identities.fan&&Identities.fan()&&Identities.fan().name,e.BandData&&(i.bandName=e.BandData.name),i.hasSeenTooltips=!!n.has_seen_tooltips,i.hasCollection=n.has_collection,i.bindTosBanner(),i.bindRockTheVoteBanner(),i.bindNewsletterInviteBanner(),i.rebind(),BCEvents.subscribe("hub.dismissFanFollowTooltip",(function(){null!=i.currentIndex&&"o"===i.tooltips[i.currentIndex]&&t(".fan-reviews .signup-tooltip-parent.show-tooltip[data-tooltip-id='o'] .signup-tooltip  a.dismiss-tooltip").trigger("click.dismiss")})),BCEvents.subscribe("hub.dismissDDFollowTooltip",(function(){null!=i.currentIndex&&"o"===i.tooltips[i.currentIndex]&&t(".dig-deeper .signup-tooltip-parent.show-tooltip[data-tooltip-id='g'] .signup-tooltip  a.dismiss-tooltip").trigger("click.dismiss")}))};i.prototype.setFirstWishlistedItem=function(e,t){this.firstWishlistedItemTitle=e,this.firstWishlistedItemType=t},i.prototype.setTooltips=function(e){const t=this;t.tooltips=e,t.numTooltips=e.length,t.tooltipNumber=1,t.currentIndex=0,t.complete=!1},i.prototype.dismissTooltip=function(n,a){const i=this;if(!i.tooltips)return;const o=t(n).closest(".signup-tooltip-parent");o.addClass("hide-tooltip"),setTimeout((function(){o.removeClass("show-tooltip"),BCEvents.publish("fanOnboarding.dismissTooltip",{})}),500);const s=i.tooltips[i.currentIndex],r=[s];return"f"===s&&r.push("b"),"b"===s&&r.push("z"),SignupAPI.dismissTooltips(r),a?setTimeout((function(){t(n).attr("href")&&(e.location.href=t(n).attr("href"))}),500):i.advance(),t(e).off("resize.adjustCss"),!1},i.prototype.dismissCollectionBanner=function(e){Crumb.ajax({url:"/api/fansignup/1/dismiss_collection_banner",data:{},dataAs:"JSON",type:"POST",success:function(e){e.error&&Log.error("error dismissing banner")},error:function(e,t,n){Log.error("ajax error: ",t,n)}})},i.prototype.dismissFeedBanner=function(e){Crumb.ajax({url:"/api/fansignup/1/dismiss_feed_banner",data:{},dataAs:"JSON",type:"POST",success:function(e){e.error&&Log.error("error dismissing banner")},error:function(e,t,n){Log.error("ajax error: ",t,n)}})},i.prototype.advance=function(){const e=this;e.currentIndex=e.currentIndex+1;const n=e.tooltips[e.currentIndex];if(n){e.tooltipNumber=e.tooltipNumber+1,e.renderCurrentTooltip(!0);["w","f","s"].indexOf(n)>-1&&t("html, body").animate({scrollTop:0},300)}else t("body").removeClass("prevent-header-hiding")},i.prototype.rebind=function(){const e=this;t(".signup-tooltip a.dismiss-tooltip",e.$root).off("click.dismiss"),t(".signup-tooltip a.dismiss-tooltip",e.$root).on("click.dismiss",(function(){return e.dismissTooltip(this)})),t(".signup-tooltip-parent a.dismiss-tooltip",e.$root).off("click.dismiss"),t(".signup-tooltip-parent a.dismiss-tooltip",e.$root).on("click.dismiss",(function(){return e.dismissTooltip(this)})),t(".signup-tooltip-parent .dismiss-tooltip-alt",e.$root).off("click.dismiss"),t(".signup-tooltip-parent .dismiss-tooltip-alt",e.$root).on("click.dismiss",(function(){return e.dismissTooltip(this,!0)}))},i.prototype.dataForRender=function(){const t=this;return{tooltips:t.tooltips,num_tooltips:t.numTooltips,tooltip_number:t.tooltipNumber,current_index:t.currentIndex,band_name:t.bandName,fan_name:t.fanName,tag_name:t.tagName,feed_url:Identities.fan()?siteroot_https+"/"+Identities.fan().username+"/feed":null,wishlist_url:Identities.fan()?siteroot_https+"/"+Identities.fan().username+"/wishlist":null,first_wishlisted_item_title:t.firstWishlistedItemTitle,first_wishlist_item_title_length:16,first_wishlisted_item_type:t.firstWishlistedItemType,first_purchased_item_title:t.firstPurchasedItemTitle,first_purchased_item_type:t.firstPurchasedItemType,origin_page:e.FanSignup?FanSignup.originPage:null}},i.prototype.renderCurrentTooltip=function(n,i){const o=this,s=o.tooltips[o.currentIndex],r=t(i||".signup-tooltip-parent[data-tooltip-id='"+s+"']");if(!r)return;if(r.hasClass("show-tooltip"))return;const l=n?500:0,c=a[s];if(c){if(t(".signup-tooltip-outer",r).empty(),t(".signup-tooltip-outer",r).append(Templ.render(c,{fan_onboarding:o.dataForRender(),cfg:U.pagedataBlob().cfg})),"x"===s&&r.hasClass("collection-item-actions")){const n=t(".signup-tooltip-body",r),a=t(".dismiss-tooltip",r),i=n.width(),o=a.width(),s=function(){const e=t(".signup-tooltip-outer",r).offset().left;e<-(400-i)/2+12?n.css({"text-align":"left","margin-left":-e-(400-i)/2+12}):n.css({"text-align":"center","margin-left":0}),e<-(400-o)/2+12?a.css({"text-align":"left","margin-left":-e-(400-o)/2+12}):a.css({"text-align":"center","margin-left":0})};s(),t(e).on("resize.adjustCss",(function(){s()})),e.doAdjust=s}o.rebind(),setTimeout((function(){r.addClass("show-tooltip"),BCEvents.publish("fanOnboarding.showTooltip",{})}),l),SignupAPI.markTooltipsViewed([s])}},i.prototype.initForView=function(e){const t=this;t.tooltips&&0!==t.tooltips.length&&(t.currentIndex||(t.currentIndex=0),t.renderCurrentTooltip(null,e),t.bindVerifyBanner())},i.prototype.showTooltip=function(e,t){this.setTooltips([e]),this.initForView(t)},i.prototype.skipWalkthrough=function(){const e=this;e.tooltips&&0!==e.tooltips.length&&SignupAPI.dismissTooltips(e.tooltips)},i.prototype.showVerifyBanner=function(){t(".corpbanner.verify-email").show()},i.prototype.bindVerifyBanner=function(){t(".corpbanner.verify-email a").off("click.verify"),t(".corpbanner.verify-email .resend-verification-email").on("click.verify",(function(){const n=t(".corpbanner.verify-email").data("email");return e.verifyNag=e.verifyNag||new VerifyNag({fan_email:n,skipToEmail:!0},(function(e,n){(e||n)&&t(".corpbanner.verify-email").addClass("hide")})),e.verifyNag.openDialog(),!1})),t(".corpbanner.verify-email .dismiss-banner").on("click.verify",(function(){return SignupAPI.dismissVerificationBanner({}),t(".corpbanner.verify-email").addClass("hide"),!1}))},i.prototype.bindRockTheVoteBanner=function(){t(".corpbanner.rock-the-vote .dismiss-banner").on("click",(function(){return t(".corpbanner.rock-the-vote").addClass("hide"),t(".bd.has-rock-the-vote-banner").removeClass("has-rock-the-vote-banner"),t(".has-menubar.has-rock-the-vote-banner").removeClass("has-rock-the-vote-banner"),SignupAPI.dismissRockTheVoteBanner({}),!1}))},i.prototype.bindNewsletterInviteBanner=function(){const e=this;t(".newsletter-invite-banner .tell-us-what-you-like").on("click",(function(){t(".newsletter-invite-banner").hide(),SignupAPI.dismissNewsletterInviteBanner({});const e={fan_id:Identities.fan().id||FanData.fan_id},n=t.Deferred();return Crumb.ajax({url:"/api/genrepreferences/1/open_genre_preferences",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?(FanSignup.updateState({followedGenres:e.result.followed_genres,fromNewsletterInvite:!0,fanUsername:Identities.fan().name||FanData.name,email:U.pagedataBlob().fan_onboarding.email}),FanSignup.openPane("genre_picker",!0),n.resolve(e)):(Log.debug("failure response",e),n.reject(e))},error:function(e,t,a){return n.reject()}}),n.promise()})),t(".newsletter-invite-banner .dismiss").on("click",(function(){t(".newsletter-invite-banner").hide(),SignupAPI.dismissNewsletterInviteBanner({}),e.skipWalkthrough()}))},i.prototype.showNewsletterInviteBanner=function(){t(".newsletter-invite-banner").show()},i.prototype.bindTosBanner=function(){Log.debug("bind tos banner"),t(".corpbanner.tos-update").on("click",(function(){return(new TosAcceptVM).show(),!1})),t(".corpbanner.tos-update .tos-update-link").on("click",(function(){return(new TosAcceptVM).show(),!1})),t(".corpbanner.tos-update .dismiss-banner").on("click",(function(){return(new TosAcceptVM).show(),!1}))};const o=U.pagedataBlob(),s=o.fan_onboarding||{},r=o.signup_params;t(document).ready((function(){const n=t("#header-wrapper"),a=t("#menubar");if(n||a){const n=new i(s,t("body")[0]);if(e.FanOnboarding=n,t("#dismiss-collection-banner").click((function(){return t(".onboarding-collection-banner").addClass("hide"),n.dismissCollectionBanner(),!1})),t("#dismiss-feed-banner").click((function(){return t(".onboarding-collection-banner").addClass("hide"),n.dismissFeedBanner(),!1})),n.tooltips&&n.tooltips.length>0){const t=Url.getQueryParam(e.location.href,"fan_action_pane");t&&"welcome_2"===t||o.show_newsletter_invite_banner||n.initForView()}n.bindVerifyBanner();const a=new Cookie.CommChannel("fan_verification");r&&r.set_fan_verified?a.send("verified",1):Identities.fan()&&Identities.fan().verified||(a.subscribe((function(e,n){"verified"==n[1]&&n[2]&&Identities.fan()&&(Identities.fan().verified=1,t(".corpbanner.verify-email").addClass("hide"))})),a.startListening())}}))}(window,$,ko),function(e,t,n){"use strict";let a=null;const i={createFanAccount:function(e){const n=t.Deferred();return Identities.user()&&(e.user_id=Identities.user().id),e.email=t.trim(e.email),e.name=t.trim(e.name),e.password=t.trim(e.password),Crumb.ajax({url:"/api/fansignup/1/signup",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):(Log.debug("failure response",e),n.reject(e))},error:function(e,t,a){return n.reject()}}),n.promise()},login:function(e){const n=t.Deferred();return e.email=t.trim(e.email),e.password=t.trim(e.password),Crumb.ajax({url:"/api/fansignup/1/login",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,a){return n.reject()}}),n.promise()},logout:function(){const e=t.Deferred();return Crumb.ajax({url:"/api/fansignup/1/logout",data:{},dataAs:"JSON",type:"POST",success:function(t){return t.ok?e.resolve(t):e.reject(t)},error:function(t,n,a){return e.reject()}}),e.promise()},sendForgotPasswordEmail:function(e){const n=t.Deferred();return e.email=t.trim(e.email),Crumb.ajax({url:"/api/fansignup/1/forgot_password",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,a){return n.reject()}}),n.promise()},resetPassword:function(e){const n=t.Deferred();return e.token=t.trim(e.token),e.password=t.trim(e.password),Crumb.ajax({url:"/api/fansignup/1/reset_password",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,a){return n.reject()}}),n.promise()},sendAppLinkEmail:function(e){const n=t.Deferred();return e.email=t.trim(e.email),e.fan_username=t.trim(e.fan_username),Crumb.ajax({url:"/api/fansignup/1/send_app_link_email",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,a){return n.reject()}}),n.promise()},resendFanVerifyEmail:function(e){const n=t.Deferred();return e.email&&(e.email=t.trim(e.email)),Crumb.ajax({url:"/api/fansignup/1/resend_fan_verify_email",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,a){return n.reject()}}),n.promise()},dismissTooltips:function(e){const n=t.Deferred();return Crumb.ajax({url:"/api/fansignup/1/dismiss_tooltips",data:{tooltips:e},dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,a){return n.reject()}}),n.promise()},setWelcomePaneSeen:function(){const e=t.Deferred();return Crumb.ajax({url:"/api/fansignup/1/set_welcome_pane_seen",data:{},dataAs:"JSON",type:"POST",success:function(t){return t.ok?e.resolve(t):e.reject(t)},error:function(t,n,a){return e.reject()}}),e.promise()},markTooltipsViewed:function(e){const n=t.Deferred();return Crumb.ajax({url:"/api/fansignup/1/mark_tooltips_viewed",data:{tooltips:e},dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,a){return n.reject()}}),n.promise()},dismissRockTheVoteBanner:function(e){const n=t.Deferred();return Crumb.ajax({url:"/corpbanner/dismiss_rock_the_vote_banner_cb",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,a){return n.reject()}}),n.promise()},dismissNewsletterInviteBanner:function(e){const n=t.Deferred();return Crumb.ajax({url:"/corpbanner/dismiss_newsletter_invite_banner_cb",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,a){return n.reject()}}),n.promise()},dismissTosBanner:function(e){const n=t.Deferred();return Crumb.ajax({url:"/corpbanner/dismiss_tos_banner_cb",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,a){return n.reject()}}),n.promise()},dismissVerificationBanner:function(e){const n=t.Deferred();return Crumb.ajax({url:"/api/corpbanner/1/dismiss_verification_banner",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,a){return n.reject()}}),n.promise()},followGenres:function(e){const n=t.Deferred(),a={selected_genres:e};return Crumb.ajax({url:"/api/fansignup/1/follow_genres",data:a,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,a){return n.reject()}}),n.promise()},setGenrePreferences:function(e){var n;const a={fan_id:(null===(n=Identities.fan())||void 0===n?void 0:n.id)||FanData.fan_id,toFollow:e.toFollow,toUnfollow:e.toUnfollow},i=t.Deferred();return Crumb.ajax({url:"/api/genrepreferences/1/save_genre_preferences",data:a,dataAs:"JSON",type:"POST",success:function(e){return e.ok?i.resolve(e):(Log.debug("failure response",e),i.reject(e))},error:function(e,t,n){return i.reject()}}),i.promise()},subscribeToNewsletters:function(e,n){const a=t.Deferred(),i={genre_ids:e,best_of:n};return Crumb.ajax({url:"/api/fansignup/1/subscribe_to_newsletters",data:i,dataAs:"JSON",type:"POST",success:function(e){return e.ok?a.resolve(e):a.reject(e)},error:function(e,t,n){return a.reject()}}),a.promise()},customGenreSearch:function(e,n){const a=t.Deferred();return t.ajax({type:"POST",url:"/api/fansignup/1/search_tag",data:JSON.stringify({search_term:e,count:n||10}),contentType:"application/json"}).then((function(e){return e.ok?a.resolve(e):a.reject(e)}),(function(){return a.reject()})),a.promise()},completeProfile:function(e){const n=t.Deferred();return Crumb.ajax({url:"/api/fansignup/1/complete_profile",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,a){return n.reject()}}),n.promise()}},o={scrollToFirstError:function(){const e=t("#signup-vm");if(e[0]){const t=e.find(".error:first");if(Dom.scrollToElement(t,-50,!0),"phone"!=MediaView.mode)try{t.focus().select()}catch(e){}}},scrollToTheTop:function(e){t("html, body").animate({scrollTop:0},e||200)},asyncLogin:function(e){Identities.initialData=e,Identities.updateFromHash(e),Identities.user(e.user),Identities.fan(e.fan),Identities.partner(e.partner),Identities.isAdmin(e.isAdmin),Identities.subscribedToPageBand(e.subscribed_to_page_band),e.fan&&e.fan.url&&t("#collect-item a.view, .collect-item a.view, .wishlisted-msg .view a").attr("href",e.fan.url+"#wishlist")},renderMenubar:function(n,a,i){const o=a||{},s=(t("#pagedata").data("blob")||{}).cfg||{};let r=t("#menubar-wrapper");0===r.length&&(t("body").prepend(t('<div id="menubar-wrapper"></div>')),r=t("#menubar-wrapper"),s.header_rework_2018&&r.addClass("header-rework-2018")),o.fan_url=n.fan&&n.fan.url,o.is_fan_page=!0,i&&"wishlist"===i.action&&(o.has_wishlist=!0);const l=n.fan&&n.fan.verified;Templ.renderElem(r[0],"menubar",{page_identities:n,menubar:o,cfg:s,skip_verification_banner:l,fan_onboarding:{email:a.email,show_verify_banner:!0}}),l||FanOnboarding.bindVerifyBanner(),s.header_rework_2018&&(t("#header-wrapper").length>0&&t("#header-wrapper").hide(),t("#menubar-wrapper").addClass("header-rework-2018"),t(".bd").removeClass("corp-header-padding")),e.initiatedAutocomplete=!1,Menubar.initialize(),e.Logout&&e.Logout.initialize()},renderHeader:function(n,a,i){if(0===t("#header-wrapper").length)return;const o=a||{},s=t("#pagedata").data("blob")||{},r=s.cfg||{};o.is_corp_home=s.is_corp_home,o.has_cart=s.has_cart,o.cart_quantity=s.cart_quantity,o.identities=n,o.cfg=r,o.is_client_render=!0,o.gift_card_balance&&(o.currency_data&&!e.CurrencyData&&(e.CurrencyData=o.currency_data),o.gift_card_balance=new Money(o.gift_card_balance)),e.FanOnboarding&&e.FanOnboarding.tooltips?o.fan_onboarding=e.FanOnboarding.dataForRender():o.skip_verification_banner=!0,i&&"wishlist"===i.action&&(o.has_wishlist=!0),o.show_rock_the_vote_banner=s.show_rock_the_vote_banner,Templ.renderElem(t("#header-wrapper")[0],"home/header_2015",o),o.show_rock_the_vote_banner&&FanOnboarding.bindRockTheVoteBanner(),e.Logout&&e.Logout.initialize(),t(".all-signup-link").click((function(){return FanSignup.openPane("choose_account",!0),!1}))},cleanURL:function(){history&&history.replaceState({},"",e.location.pathname)},signupError:function(e){return a||(a={logged_in_fan:TM("You’re already logged in as a fan."),wrong_email:TM("Your email address does not match what we have on file.")}),a[e]}};e.SignupAPI=i,e.SignupUtils=o}(window,$,ko),function(e,t,n){"use strict";const a=U.pagedataBlob(),i=a.cfg||{},o=Url.getQueryParam(e.location.href,"skip_redeem");e.SignupPane=function(s,r){const l=this,c=/^[a-zA-Z0-9_-]+$/,d=/^(_)\1*$/,p=s.state;Stats.record({kind:"click",click:"fan_signup_start"});const u=function(e){return/(^)([^\s\(\)"'\/><,@]+@\w([^\s\(\)"'\/><&,@]*\w)?\.\w[^\s\(\)"'\/><&,@]*\w)($)/.test(e)};let m;switch(l.showGiftCardPrompt=n.observable(!1),s.originPage){case"redeem":m=TM("Sign up and redeem",null,"sign up for fan account and redeem gift card");break;case"gift_cards":m=TM("Sign up"),l.showGiftCardPrompt(!0);break;default:m=TM("Sign up for a Bandcamp fan account")}if(l.title=Identities.user()?"":m,l.pageTitle=TM("Sign up"),l.template="fan/signup/fan_signup_pane",l.resetOnClose=!0,l.signupToken=s.signupToken,l.tsig=s.tsig,l.verified=s.verified,l.width=500,l.position={my:"center center",at:"center center-60",of:e},l.visible=n.observable(!1),l.immediate=n.observable(!!r.immediate),l.afterRender=function(){t(".signup-heading").hide(),t("#signup-title").show(),l.visible(!0),"desktop"===MediaView.mode&&(l.loggedIn()?t("#username-input").focus():t("#email-input").focus())},l.close=function(e){const n=t.Deferred();return e&&s.updateState(l.exportState()),l.immediate(!1),l.visible(!1),Captcha.hideInvisible(),n.resolve(),n.promise()},this.saving=n.observable(!1),this.inlineLoginVisible=n.observable(!1),this.disableEmailField=n.pureComputed((function(){const e=Object.keys(FanSignup.CROWDFUNDING_RECEIPT_ACTIONS).map((function(e){return FanSignup.CROWDFUNDING_RECEIPT_ACTIONS[e]}));return"crowdfunding"===s.originPage&&-1!==e.indexOf(s.actionParams.action)&&!l.inlineLoginVisible()&&!l.emailEdited()&&l.email()})),l.loggedIn=n.observable(!!Identities.user()),l.usernameIsURL=n.computed((function(){return l.loggedIn()||l.inlineLoginVisible()})),l.showExistingArtist=n.computed((function(){return l.loggedIn()&&!s.portable&&(!s.actionParams||!s.actionParams.action)})),l.showLiveInviteAcceptArtistMsg=n.computed((function(){return l.loggedIn()&&s.actionParams&&"live_invite"===s.actionParams.action})),l.notifyMeBand=n.observable(!1),l.notifyMeLabel=n.observable(!1),"follow"===s.actionParams.action&&"b"==s.actionParams.itemType){const e=a.signup_params.mailing_list_info,n=t("#follow-unfollow-band_"+s.actionParams.actionBandId)[0];l.showNotifyMe=!0,l.artist=n?n.dataset.bandName:BandData&&BandData.name,e&&(l.label=e.label_name,l.labelId=e.label_id)}function h(n){const a=s.portable&&"desktop"===MediaView.mode,i=!s.portable&&s.actionParams.action,r=i&&s.actionParams.actionURL,c=s.isMobile&&"redeem"!==i,d=c&&i,p="crowdfunding"===s.originPage,u="gift_cards"===s.originPage||["gift_cards","gift_cards_verify"].includes(s.actionParams.action),m="redeem"===s.originPage,h="live_ticket"===s.actionParams.action,f="live_invite"===s.actionParams.action,g="live_attend"===s.actionParams.action,_="live_attend_immediate"===s.actionParams.action,b="live_chat"===s.actionParams.action,v="follow"===s.actionParams.action&&"live"===s.originPage,y="wishlist"===s.actionParams.action&&"live"===s.originPage,w={mode:MediaView.mode,username:l.username(),tsig:l.tsig,verified:l.verified};l.signupToken&&l.signupToken.length>0&&(w.signup_token=l.signupToken),l.saveCard()&&(w.save_card=l.saveCard()),l.enableCaptcha()&&(w.captcha_token=n),l.loggedIn()||(w.email=l.email()),l.signupToken&&(w.signup_token=l.signupToken),l.loggedIn()||(w.password=l.password()),l.selectedUser()&&(w.user_id=l.selectedUser().user_id),s.actionParams&&(w.action=s.actionParams.action,w.action_item_id=s.actionParams.actionItemId,w.action_band_id=s.actionParams.actionBandId,w.action_item_type=s.actionParams.actionItemType,w.action_url=s.actionParams.actionURL,w.action_sig=s.actionParams.actionSig),"follow"===s.actionParams.action&&(w.notify_me_band=l.notifyMeBand(),w.notify_me_label=l.notifyMeLabel(),w.action_label_id=l.labelId);s.activationParams&&(["home","band"].includes(s.originPage)||"gift_cards_verify"===w.action)&&(w.activation_url=s.activationParams.url,w.activation_sig=s.activationParams.sig),l.email()===s.initialEmail&&s.initialEmailSignature&&(w.email_sig=s.initialEmailSignature),w.is_corp_signup="fans"===s.originPage||"home"===s.originPage||"corp"===s.originPage,o&&(w.skip_redeem=!0);const k=s.getSignupFrom();w.signup_from=k,"redeem"===k&&(w.resume_id=s.actionParams.resumeId,w.resume_buy_id=s.actionParams.resumeBuyId,w.resume_action=s.actionParams.resumeAction),w.link_band=l.inlineLoginVisible(),l.deferWalkthrough=s.state.deferWalkthrough||g||h||f||_||b||v||y,w.defer_onboarding=l.deferWalkthrough,l.saving(!0),SignupAPI.createFanAccount(w).then((function(t){t.crumbs&&Crumb.put(t.crumbs),t.user_data&&(l.userDataForMenubar=t.user_data);const n=s.actionParams&&s.actionParams.action;let o=null;const w=t.identities.bands&&t.identities.bands.length>0;n?"wishlist"===n?o=w?"logged_out_wishlist_band_signup_completes":"logged_out_wishlist_new_signup_completes":"follow"===n&&"f"===s.actionParams.actionItemType?o=w?"logged_out_fan_follow_band_signup_completes":"logged_out_fan_follow_new_signup_completes":"follow"===n&&"g"===s.actionParams.actionItemType?o=w?"logged_out_genre_follow_band_signup_completes":"logged_out_genre_follow_new_signup_completes":"follow"!==n||s.actionParams.actionItemType&&"b"!==s.actionParams.actionItemType?"live_ticket"!==n&&"live_attend"!==n&&"live_attend_immediate"!==n||(o="logged_out_live_ticket_purchase_new_signup_completes"):o=w?"logged_out_follow_band_signup_completes":"logged_out_follow_new_signup_completes":"corp"===k?o="corp_header_single_signup_fan_completes":"menubar"===k&&(o="menubar_single_signup_fan_completes"),o&&(Stats.record({kind:"click",click:o}),BCEvents.publish("fanSignup."+o,s.actionParams)),l.asyncIdentities=t.identities,l.nextURL=t.next_url,l.nextAppURL=t.next_app_url,l.verificationNeeded=t.verification_needed,l.tooltips=t.tooltips,t.tooltips&&e.FanOnboarding&&e.FanOnboarding.setTooltips(t.tooltips),t.first_wishlisted_item_title&&(s.actionParams.title=t.first_wishlisted_item_title),t.first_purchased_item_title&&(FanOnboarding.firstPurchasedItemTitle=t.first_purchased_item_title),t.first_purchased_item_type&&(FanOnboarding.firstPurchasedItemType=t.first_purchased_item_type),t.action_genre_id&&(s.actionParams.genreId=t.action_genre_id),t.upload_info&&!e.UploadInfo&&(e.UploadInfo=t.upload_info),SignupUtils.asyncLogin(t.identities),s.updateState(l.exportState()),"redeem"===s.originPage&&(Redeem.rawCardData(t.gift_card_data),Redeem.rawUserBalance(t.user_balance),Redeem.showNewFan(!0));const x=!l.verificationNeeded;u||m?s.onComplete():g?l.openCompleteProfile():h||f||_||b||v||y?l.completeSignup():p?x?l.openWelcome2():l.openWelcome():a?l.openGenrePicker():x?d&&r?l.continueMobileOnboardingAction():i?s.onComplete():l.openWelcome():d&&r?l.continueMobileOnboardingAction():c?l.continueMobileOnboarding():l.openAlmostThere()}),(function(e){if(e&&"captcha_missing"===e.error&&(l.enableCaptcha(!0),Captcha.renderInvisible()),e&&e.errors)Iter.each(e.errors,(function(e){if(e.field&&"email"===e.field&&"existing_fan"===e.error&&l.loggedIn())l.username.error_key("existingFanLoggedIn");else if(e.field&&"email"===e.field&&"fan_already_linked_email"===e.error&&l.loggedIn())l.username.error_key("fanAlreadyLinkedEmail");else if(e.field&&"email"===e.field&&"band_member"===e.error)l.inlineLoginVisible(!0);else if(e.field&&(l[e.field].error_key(e.error),"username"===e.field&&"duplicate"===e.error&&e.error_data)){const t=e.error_data.suggested_username;t&&t.length>0&&l.suggestedUsername(t)}SignupUtils.scrollToFirstError()}));else if(e&&"many_matched_users"===e.error&&e.error_data&&e.error_data.users&&e.error_data.users.length>0)l.chooserVisible(!0),l.inlineLoginVisible(!1),l.possibleUsers(e.error_data.users);else if(e&&"rsvp_limit_reached"===e.error){const e=TM("Stay tuned for future events!","pre");NuDialog.alertHTML(TM("This event has reached capacity","pre"),e,{buttons:[{text:"Ok, got it",click:function(){t(this).dialog("close")}}]})}else if(e){const t=e.error&&SignupUtils.signupError(e.error)||TM("There was a problem signing up. Please try again.");NuDialog.alert(TM("Signup Error"),t)}l.saving(!1)}))}l.username=n.observable(p.fan_username),l.email=n.observable(p.email),l.password=n.observable(p.password),l.passwordMasked=n.observable(!1),l.saveCard=n.observable(a.signup_params.save_card),l.emailEdited=n.observable(!1),l.tos=n.observable(!1),l.networkError=n.observable(!1),l.email.checking=n.observable(!1),l.email.checked=n.observable(!1),l.email.extend({errorKeys:{}}),l.email.subscribe((function(){l.email.error_key(null),l.email.checked(!1),l.inlineLoginVisible(!1),l.emailEdited(!0),u(t.trim(l.email()))&&!l.networkError()&&l.email.checking(!0)})),l.email.deferred=null,l.email.check=null,l.email.validate=function(){const e=l.email();l.loggedIn()?l.email.error_key(null):l.email.error_key(u(e)?null:"invalid")},p.email&&!l.loggedIn()&&setTimeout((function(){u(t.trim(l.email()))&&!l.networkError()&&l.email.checking(!0)}),300),l.password.extend({errorKeys:{missing:TM("Please enter your password."),tooShort:TM("Your password must be at least {{numberOfCharacters}} characters.",{numberOfCharacters:9}),incorrect:TM("That password isn’t correct. Please try again.")}}),l.password.validate=function(){if(l.loggedIn())return l.password.error_key(null);l.password.error_key(l.password()?l.password().length<9?"tooShort":null:"missing")},l.username.display=n.pureComputed({read:function(){return l.username()},write:function(e){e&&e.length>0&&l.username(e.toLowerCase())}}),l.username.extend({errorKeys:{}}),l.username.validate=function(){const e=t.trim(l.username());l.username.error_key(e?e.length<3?"tooShort":e.length>60?"tooLong":u(e)?"isEmail":c.test(e)?d.test(e)?"undies":null:"invalid":"missing")},l.username.label=n.computed((function(){return l.loggedIn()||l.inlineLoginVisible()?TM("Choose your fan URL"):TM("Username")})),l.username.placeholder=n.computed((function(){return l.loggedIn()||l.inlineLoginVisible()?TM("choose your fan URL"):TM("username")})),l.username.subscribe((function(){l.username.error_key(null)})),l.suggestedUsername=n.observable(),l.useSuggestedUsername=function(){l.username(l.suggestedUsername()),l.suggestedUsername(null),l.username.error_key(null)},this.tos.extend({errorKeys:{missingValue:TM("Ahem... please agree to the terms.",null,"don't need to translate the ahem")}}),this.tos.validate=function(){l.tos.error_key(l.tos()?null:"missingValue")},this.chooserVisible=n.observable(!1),this.possibleUsers=n.observableArray(),this.formatUser=function(e){let t=[];return e.fan_username&&t.push(e.fan_username),e.bands&&e.bands.length>0&&(t=t.concat(Iter.collect(e.bands,(function(e){return e.band_name})))),Templ.render("login/user_picker_text",{username:e.username,list:t})},this.selectedUser=n.observable(),this.bottomLinkVisible=n.computed((function(){return!l.loggedIn()&&!l.chooserVisible()})),this.artistSignupVisible=n.computed((function(){return!s.portable&&!l.loggedIn()&&!l.chooserVisible()})),this.enableCaptcha=n.observable(i.fan_signup_use_captcha),this.enableCaptcha()&&Captcha.renderInvisible(),this.has_errors=n.computed((function(){return Iter.find(["email","password","username","tos"],(function(e){return l[e].error_key()}))})),this.clear_errors=function(){Iter.each(["password","username","tos","email"],(function(e){l[e].error_key(null)}))},this.submitEnabled=n.computed((function(){return!l.saving()&&!l.has_errors()})),this.submitText=n.computed((function(){return l.saving()?TM("Please wait...",null,"waiting to complete signup"):l.chooserVisible()?TM("Go",null,"complete signup"):l.loggedIn()?TM("Complete setup"):"jeanlucpicard"===l.username()?"Make it so":TM("Sign up")})),this.validate=function(){return Iter.each(["password","username","tos","email"],(function(e){l[e].validate()})),!l.has_errors()},this.submit=function(){if(l.submitEnabled())if(l.validate())if(Stats.record({kind:"click",click:"fan_signup_signup_continue"}),l.saving(!0),l.enableCaptcha()){const e=setTimeout((function(){l.saving(!1)}),1e4);Captcha.execute((function(t){clearTimeout(e),h(t)}))}else h(null);else SignupUtils.scrollToFirstError()},this.continueMobileOnboarding=function(){e.location.href=Url.addQueryParams(siteroot_https+"?",{fan_action_pane:"genre_picker",show_download_banner:1,redirect_to_app_url:l.nextAppURL})},this.continueMobileOnboardingAction=function(){e.location.href=Url.addQueryParams(s.actionParams.actionURL+"?",{fan_action_pane:"genre_picker",show_download_banner:1,redirect_to_app_url:l.nextAppURL})},this.openLogin=function(e){Stats.record({kind:"click",click:"fan_signup_signup_login"}),l.close(e).then((function(){s.openPane("login")}))},this.openForgotPassword=function(){l.close(!0).then((function(){s.openPane("forgot_password")}))},this.openAlmostThere=function(){l.close(!0).then((function(){s.openPane("almost_there"),s._dialog&&s._dialog.parent().addClass("no-close")}))},this.openWelcome=function(){l.close(!0).then((function(){s.openPane("welcome")}))},this.openWelcome2=function(){l.close().then((function(){s.openPane("welcome_2")}))},this.openCompleteProfile=function(){l.close().then((function(){s.openPane("complete_profile")}))},this.openGenrePicker=function(){l.close(!0).then((function(){s.openPane("genre_picker")}))},this.completeSignup=function(){l.close(!0).then((function(){s.onComplete()}))},l.exportState=function(){return{fanUsername:l.username(),saveCard:l.saveCard(),email:l.email(),asyncIdentities:l.asyncIdentities,nextURL:l.nextURL,userDataForMenubar:l.userDataForMenubar,verificationNeeded:l.verificationNeeded,deferWalkthrough:l.deferWalkthrough}},l.hash=function(){return{download_item:a.download_item,signup_params:a.signup_params,show_notify_me:l.showNotifyMe,artist:l.artist,label:l.label,rendered:!0,cfg:i}}}}(window,$,ko),function(e,t,n){"use strict";e.LoginPane=function(a,i){const o=this,s=a.state,r=t("#pagedata").data("blob").cfg,l="redeem"===a.originPage?TM("Log in and redeem",null,"log in and redeem gift card"):TM("Log in");function c(n){const i={username:o.email(),password:o.password()};o.twofactorVisible()&&(i.twofactor=o.twofactor(),i.twofactor_remember=o.twofactorRemember()),n&&(i.captcha_token=n),a.actionParams&&(i.action=a.actionParams.action,i.action_item_id=a.actionParams.actionItemId,i.action_band_id=a.actionParams.actionBandId,i.action_item_type=a.actionParams.actionItemType,i.action_url=a.actionParams.actionURL,i.action_sig=a.actionParams.actionSig,i.resume_id=a.actionParams.resumeId,i.resume_buy_id=a.actionParams.resumeBuyId,i.resume_action=a.actionParams.resumeAction),o.selectedUser()&&(i.user_id=o.selectedUser().id),o.submitting(!0),SignupAPI.login(i).then((function(t){t.crumbs&&Crumb.put(t.crumbs);const n=a.actionParams&&a.actionParams.action;if(n){let e=null;const i=t.identities.bands&&t.identities.bands.length>0&&!t.identities.fan;"wishlist"===n?e=i?"logged_out_wishlist_login_as_band_no_fan":"logged_out_wishlist_login_as_fan":"follow"===n&&"f"===a.actionParams.actionItemType?e=i?"logged_out_fan_follow_login_as_band_no_fan":"logged_out_fan_follow_login_as_fan":"follow"!==n||a.actionParams.actionItemType&&"b"!==a.actionParams.actionItemType||(e=i?"logged_out_follow_login_as_band_no_fan":"logged_out_follow_login_as_fan"),Stats.record({kind:"click",click:e})}if(t.user_data&&(o.userDataForMenubar=t.user_data),"redeem"===a.originPage&&(Redeem.rawCardData(t.gift_card_data),Redeem.rawUserBalance(t.user_balance)),t.upload_info&&!e.UploadInfo&&(e.UploadInfo=t.upload_info),SignupUtils.asyncLogin(t.identities),t.identities.fan&&!t.identities.fan.private)o.asyncIdentities=t.identities,o.nextURL=t.next_url,o.didLogin=!0,o.email(t.email),o.subscribedToBestOf=t.subscribed_to_best_of,o.alreadyPurchased=!!t.already_purchased,a.updateState(o.exportState()),"tag"===a.originPage&&e.hub&&o.subscribedToBestOf?a.onComplete():s.nextPane?a.openPane(s.nextPane):a.onComplete();else if(a.actionParams&&a.actionParams.action)if(["gift_cards","gift_cards_verify","live_attend","live_attend_immediate"].includes(a.actionParams.action))o.asyncIdentities=t.identities,o.nextURL=t.next_url,o.didLogin=!0,o.email(t.email),o.subscribedToBestOf=t.subscribed_to_best_of,a.updateState(o.exportState()),a.onComplete();else{a.updateState({userName:t.username,bands:t.bands||[]});let e=!1;t.affiliations&&(a.affiliations=t.affiliations,(t.affiliations.fan||t.affiliations.fan_already_linked_email)&&(e=!0)),e?o.showDupeFan():o.showExistingArtist()}else e.location.href=t.next_url||siteroot_https}),(function(e){if(e&&"captcha_missing"===e.error&&(o.enableCaptcha(!0),Captcha.renderInvisible()),e&&e.errors)Iter.each(e.errors,(function(n){if(Log.debug("error.field: "+n.field+"; error.reason: "+n.reason),"login.twofactor"==n.field&&"missingValue"==n.reason)o.twofactorVisible()?o.twofactor.error_key("missingValue"):o.twofactorVisible(!0),t("#two-factor-code-input").focus();else if("login.user"==n.field&&"matchedManyUsers"==n.reason)o.userChooserVisible(!0),o.possibleUsers(e.error_data.matched_users),o.selectedUser(o.possibleUsers()[0]);else if("login.user"==n.field&&"emailVerificationRequired"==n.reason)NuDialog.alert(TM("Email confirmation required"),TM("To log in, please click the link in the email that we just sent to the address associated with your account.")),a.onComplete();else{let e={"user.name":o.email,"login.password":o.password,"login.twofactor":o.twofactor}[n.field];e||(Log.error("Unknown error field",n.field),e=o.password),e.error_key(n.reason)}})),SignupUtils.scrollToFirstError();else if(e&&"rsvp_limit_reached"===e.error){const e=TM("Stay tuned for future events!","pre");NuDialog.alertHTML(TM("This event has reached capacity","pre"),e,{buttons:[{text:"Ok, got it",click:function(){t(this).dialog("close")}}]})}else if(e){const e=TM("There was an error logging in. Please try again.");NuDialog.alert(TM("Login Error"),e)}o.submitting(!1)}))}o.title=o.pageTitle=l,o.template="fan/signup/fan_login_pane",o.visible=n.observable(!1),o.immediate=n.observable(!!i.immediate),o.resetOnClose=!0,o.afterRender=function(){t(".signup-heading").hide(),t("#login-title").show(),o.visible(!0),"desktop"===MediaView.mode&&t("#email-input").focus()},o.close=function(){const e=t.Deferred();return a.updateState(o.exportState()),o.immediate(!1),o.visible(!1),e.resolve(),e.promise()},o.showExisting=n.observable(!!s.email),o.email=n.observable(s.email).extend({errorKeys:{missingValue:TM("Please enter your email or username."),noMatch:TM("We couldn’t find that account. Please try again.")}}),o.password=n.observable().extend({errorKeys:{missingValue:TM("Please enter your password."),noMatch:TM("Incorrect password. Please try again.")}}),this.userChooserVisible=n.observable(!1),this.possibleUsers=n.observableArray(),this.selectedUser=n.observable(),this.formatUser=function(e){let t=[];return e.fan_username&&t.push(e.fan_username),e.bands&&e.bands.length>0&&(t=t.concat(Iter.collect(e.bands,(function(e){return e.band_name})))),Templ.render("login/user_picker_text",{username:e.name,list:t})},o.twofactor=n.observable().extend({errorKeys:{missingValue:TM("Please enter your two-factor code."),noMatch:TM("Code validation failed. Please try again.")}}),o.twofactorRemember=n.observable(!1),o.twofactorVisible=n.observable(!1),o.twofactorHelpVisible=n.observable(!1),o.showTwoFactorHelp=function(){o.twofactorHelpVisible(!0)},this.enableCaptcha=n.observable(r.login_use_captcha),this.enableCaptcha()&&Captcha.renderInvisible(),o.validate=function(){const e=t.trim(o.email());o.email.error_key(e?null:"missingValue"),o.password.error_key(o.password()?null:"missingValue");return o.twofactorVisible()&&o.twofactor.error_key(o.twofactor()?null:"missingValue"),!o.email.error_key()&&!o.password.error_key()&&!0},this.has_errors=n.computed((function(){return Iter.find(["email","password","twofactor"],(function(e){return o[e].error_key()}))})),this.submitting=n.observable(!1),this.submitEnabled=n.computed((function(){return!o.submitting()&&!o.has_errors()})),o.submit=function(){if(o.submitEnabled()&&!o.submitting())if(o.validate())if(o.submitting(!0),o.enableCaptcha()){const e=setTimeout((function(){o.submitting(!1)}),1e4);Captcha.execute((function(t){clearTimeout(e),c(t)}))}else c(null);else SignupUtils.scrollToFirstError()},o.showExistingArtist=function(){o.close().then((function(){a.openPane("existing_artist")}))},o.showDupeFan=function(){o.close().then((function(){a.openPane("dupe_fan")}))},o.backToSignup=function(){o.close().then((function(){a.openPane("signup")}))},o.forgotPassword=function(){o.close().then((function(){a.openPane("forgot_password")}))},o.exportState=function(){return{email:o.email(),nextURL:o.nextURL,asyncIdentities:o.asyncIdentities,userDataForMenubar:o.userDataForMenubar,didLogin:o.didLogin,subscribedToBestOf:o.subscribedToBestOf,alreadyPurchased:o.alreadyPurchased}},o.hash=function(){return{portable:a.portable,fan_signup_only:"redeem"===a.originPage||"gift_cards"===a.originPage}}}}(window,$,ko),function(e,t,n){"use strict";const a=function(){const n=this;n.template="",n.containerClass="",n.$container=t("<div></div>"),n.pageData=t("#pagedata").data("blob")||{},n.itemCount=0,n.batchSize=0,n.sequence=[],n.pendingSequence=[],n.batchFetchState={},n.$window=t(e),n.$document=t(document),n.expanded=!1,n.initialized=!1};a.prototype.itemOverflowIndex=function(){return this.$window.width()<=980?39:40},a.prototype.renderItem=function(e,n){const a=this,i={item:e,view:a.type,cfg:a.pageData.cfg,current_fan:CurrentFan,fan_read_only:!1,is_own_collection:CurrentFan.is_own_collection,fan_id:FanData.fan_id,viewing_fan_id:CurrentFan.fan_id,fan_name:FanData.name,common:{},render_hidden:n},o=t(Templ.render(a.template,i));a.$container.find("ol").append(o),a.postRender(e)},a.prototype.postRender=function(e){},a.prototype.needsPagination=function(){const e=this;return!e.error&&(e.sequence.length!==e.itemCount&&e.$window.scrollTop()+e.$window.height()+1e3>=e.$document.height())},a.prototype.onScroll=function(){const e=this;return e.sequence.length>=e.itemCount?(e.$window.off("scroll."+e.type,e.scrollFn),void(e.completeCallback&&e.completeCallback())):e.expanded&&!e.paginating&&e.needsPagination()?e.paginate():void 0},a.prototype.showButton=function(){this.$expandContainer&&this.$expandContainer.removeClass("show-loading").addClass("show-button")},a.prototype.hideButton=function(){this.$expandContainer&&this.$expandContainer.removeClass("show-button show-loading")},a.prototype.showLoading=function(){this.$expandContainer&&this.$expandContainer.removeClass("show-button").addClass("show-loading")},a.prototype.hideLoading=function(){this.$expandContainer&&this.$expandContainer.removeClass("show-button show-loading")},a.prototype.paginate=function(){return t.Deferred().promise()},a.prototype.expand=function(e){const t=this;if(t.expanded||(t.pendingSequence&&t.pendingSequence.length>0&&(t.showLoading(),Iter.each(t.pendingSequence,(function(e){const n=t.itemCache[e];t.sequence.push(e),setTimeout((function(){t.renderItem(n)}),17)})),t.pendingSequence=[]),t.expanded=!0),t.itemCount===t.sequence.length)return t.expandCallback&&t.expandCallback(),t.completeCallback&&t.completeCallback(),t.hideButton(),void setTimeout((function(){t.hideLoading()}),17);if("phone"===MediaView.mode){if(t.sequence.length>=t.itemCount)return void(t.completeCallback&&t.completeCallback());t.paginate().then((function(){t.sequence.length>=t.itemCount?t.completeCallback&&t.completeCallback():t.showButton()}))}else t.scrollFn=t.onScroll.bind(t),t.$window.on("scroll."+t.type,t.scrollFn),t.scrollFn();t.expandCallback&&t.expandCallback()},a.prototype.preload=function(e,t){const n=this;if(n.pendingSequence&&n.pendingSequence.length>0){const a=n.pendingSequence.slice(0,n.batchSize),i=n.pendingSequence.slice(n.batchSize,n.pendingSequence.length);let o=null;(i.length>0||a.length!==n.itemCount)&&(o=n.itemOverflowIndex()),Iter.eachWithIndex(a,(function(a,i){const s=o&&i+1>o,r=n.itemCache[a];n.sequence.push(a),e||t&&i>=t?setTimeout((function(){n.renderItem(r,s)}),17):n.renderItem(r,s)})),n.pendingSequence=i}},a.prototype.load=function(e,t,n){const a=this;e&&a.preload(t,n),a.expanded&&a.itemCount>a.sequence.length&&"phone"!==MediaView.mode?(a.scrollFn=a.onScroll.bind(a),a.$window.off("scroll."+a.type),a.$window.on("scroll."+a.type,a.scrollFn),a.scrollFn()):a.itemCount>a.sequence.length+a.pendingSequence.length&&a.showButton(),a.$showMore&&(a.clickFn=function(){a.expand()},a.$showMore.off("click"),a.$showMore.on("click",a.clickFn)),!a.initialized&&a.initialize&&a.initialize(),a.initialized=!0},a.prototype.unload=function(){const e=this;e.$window.off("scroll."+e.type),e.$showMore.off("click")},a.prototype.collapse=function(){const e=this;if(e.expanded){if(e.expanded=!1,e.itemCount>e.batchSize){const t=e.sequence.slice(0,e.batchSize),n=e.sequence.slice(e.batchSize,e.sequence.length);e.sequence=t,e.pendingSequence=n,e.$container.find(e.containerClass+":nth-child("+e.batchSize+")").nextAll().remove(),e.showButton()}e.$window.off("scroll."+e.type,e.scrollFn),e.$showMore.off("click",e.clickFn)}else e.unload()},a.prototype.removeItem=function(e){const t=this,n=t.sequence.indexOf(e);let a={};return n>-1&&(t.sequence.splice(n,1),a=t.itemCache[e],t.itemCount-=1),a},a.prototype.appendItem=function(e,t){const n=this;n.itemCache[e]=t,n.expanded?n.sequence.push(e):n.pendingSequence.push(e),n.itemCount+=1},a.prototype.prependItem=function(e,t){const n=this;n.itemCache[e]=t,n.expanded?n.sequence.unshift(e):n.pendingSequence.unshift(e),n.itemCount+=1},e.Paginate=a}(window,jQuery,ko),function(e,t,n){"use strict";const a=function(e,t,n){FollowGrid.call(this,e,t,n)};function i(){const e=t(".preference-container .open-prefs");e.prop("disabled",!e.prop("disabled")),e.toggleClass("disabled"),e.find("span").toggle()}(a.prototype=new Paginate).openGenrePicker=function(){const n=t("#pagedata").data("blob"),i=t("#fan-signup-addnl-bundle").data("url"),o={additionalBundleLoaded:!1,additionalBundle:i,additionalBundlePromise:t.cachedScript(i),state:{fanUsername:Identities.fan().name||FanData.name},isMobile:"phone"===MediaView.mode&&n.cfg.mobile_onboarding},s={genres:n.genre_picker.genres,subgenres:n.genre_picker.subgenres,standalone:!0};e.GenrePickerPaneVM=new GenrePickerPane(o,s),a.openGenrePreferences()},a.prototype.postRender=function(e){},a.prototype.paginate=function(){const e=this;if(e.sequence.length>=e.itemCount||e.paginating)return t.Deferred().resolve().promise();e.paginating=!0,e.showLoading();const n=e.$container.find(e.containerClass+":hidden"),a=n.length,i=e.batchSize-a;return FanCollectionAPI.getFollowers(FanData.fan_id,e.lastToken,e.type,i).then((function(t,i,o){e.paginating=!1,e.hideLoading(),a>0&&n.removeClass("initial-batch render-hidden");const s=e.sequence.length+t.length>=e.itemCount;let r=null;s||(r=e.itemOverflowIndex()),e.lastToken=i,Iter.eachWithIndex(t,(function(t,n){const i=r&&a+n+1>r;e.itemCache[t.fan_id]=t,e.sequence.push(t.fan_id),e.renderItem(t,i)})),e.needsPagination()&&e.paginate()}))},a.openGenrePreferences=function(){i();const a={fan_id:Identities.fan().id||FanData.fan_id},o=t.Deferred();return Crumb.ajax({url:"/api/genrepreferences/1/open_genre_preferences",data:a,dataAs:"JSON",type:"POST",success:function(a){if(a.ok){const r=t("#pagedata").data("blob").templglobals&&t("#pagedata").data("blob").templglobals.is_phone;let l=["nu-dialog","overflow-dialog","blank-title"];r&&(l=l.concat("mobile-onboarding"));const c=t("<div>");var s=NuDialog.alertHTML("",c,{title:null,buttons:null,closeOnEscape:!0,width:r?e.innerWidth-16:"auto",height:"auto",dialogClass:l.join(" "),close:function(){t(".genres-overflow-wrapper").scrollTop(0),s.detach(),e.GenrePickerPaneVM.close(),i(),e.GenrePickerPaneVM=null}});console.log(r?e.innerWidth-16:"auto");const d=e.GenrePickerPaneVM.hash();return c.html(Templ.render(e.GenrePickerPaneVM.template,d)),n.applyBindings(e.GenrePickerPaneVM,t("#signup-vm")[0]),e.GenrePickerPaneVM.$dialog(s),t(".genre-picker-form").toggleClass("active"),e.GenrePickerPaneVM.prefillSelectedGenres(a.result.followed_genres),e.GenrePickerPaneVM.afterRender(),e.GenrePickerPaneVM.scrollTop(),s.dialog("option","position",{my:"center center",at:"center center",of:e}),o.resolve(a)}return Log.debug("failure response",a),o.reject(a)},error:function(e,t,n){return o.reject()}}),o.promise()},a.saveGenrePreferences=function(i,o){const s={fan_id:Identities.fan().id||FanData.fan_id,toFollow:i,toUnfollow:o},r=t.Deferred();return Crumb.ajax({url:"/api/genrepreferences/1/save_genre_preferences",data:s,dataAs:"JSON",type:"POST",success:function(i){return i.ok?(e.GenrePickerPaneVM.$dialog().dialog("close"),n.cleanNode(t("#signup-vm")),e.location.href=a.urlQueryParams("from","genres"),r.resolve(i)):(Log.debug("failure response",i),r.reject(i))},error:function(e,t,n){return r.reject()}}),r.promise()},a.urlQueryParams=function(t,n,a){a=a||e.location.href;const i=new RegExp("([?&])"+t+"=.*?(&|#|$)(.*)","gi");let o;if(i.test(a))return null!=n?a.replace(i,"$1"+t+"="+n+"$2$3"):(o=a.split("#"),a=o[0].replace(i,"$1$3").replace(/(&|\?)$/,""),void 0!==o[1]&&null!==o[1]&&(a+="#"+o[1]),a);if(null!=n){const e=-1!==a.indexOf("?")?"&":"?";return o=a.split("#"),a=o[0]+e+t+"="+n,void 0!==o[1]&&null!==o[1]&&(a+="#"+o[1]),a}return a},e.GenreGrid=a}(window,jQuery,ko);var Fanpage={};!function(e){"use strict";let t;$(document).ready((function(){const e=$("#pagedata").data("blob");t=$("#fan-container")[0],PopupImage.delegate(t),PopupImage.attach("a.showmeProfilePhoto"),PopupImage.attach("a.showmeJustification"),$(t).on("click",".collection-item-actions .wishlist-msg",(function(t){const n=$(this).parents(".collection-item-container"),a=n.data("tralbumid"),i=n.data("tralbumtype"),o=n.data("bandid"),s=n.data("title");!Identities.fan()||Identities.fan()&&!Identities.fan().verified?FanAction.doAction("wishlist",e.lo_querystr||"",null,a,i,o):Fanpage.collectItem(a,i,o,s,this)})),$(t).on("click",".collection-item-actions .wishlisted-msg",(function(e){const t=$(this);if(t.closest(".signup-tooltip-parent").hasClass("show-tooltip"))return;const n=t.parents(".collection-item-container"),a=n.data("itemid"),i=n.data("ispurchasable");Fanpage.uncollectItem(a,this,!i)})),$(t).on("click",".preference-container .open-prefs",(function(e){e.stopImmediatePropagation(),FollowGrids.followingGenres.openGenrePicker()})),$(".followingnoteclose").click((function(){$(".following-note").slideUp(200)})),$(t).on("click",".share-link",(function(e){const t=$(this).data("itemtype"),n=$(this).data("itemid");let a={};a=$(this).data("isgiftsgiven")?CollectionGrids.giftsGiven.itemCache[t[0]+n+"g"]:CollectionGrids.collection.itemCache[t[0]+n];const i={linkback:a.item_url,is_track:"t"===a.tralbum_type,title:a.item_title,artist:a.band_name},o=TM("Share"),s=NuDialog.showTemplate("_share_tralbum_phone",i,{title:o,buttons:{}});return SocialControls.initFromDOM(s),!1})),!window.MediaView||"desktop"!=window.MediaView.mode||"iphone"!=Browser.platform&&"android"!=Browser.platform||$(".collection-grid").addClass("tablet"),"undefined"!=typeof CurrentFan&&CurrentFan.is_own_collection&&Stats.record({kind:"fan view "+("desktop"===MediaView.mode?"desktop":"mobile")})})),e.toggleAlsoCollectedBy=function(e){const t=$(e).closest(".collected-by").find(".deets");if(t.hasClass("populated"))t.toggle();else{const n=t.closest(".collection-item-container"),a=n.data("tralbumtype"),i=n.data("tralbumid"),o=$(".also-link",$(e).closest(".collected-by")),s=new FanTralbumCollectors(t,a,i,"collection");s.renderFull().then((function(){"phone"===MediaView.mode&&0===s.thumbs.length&&1===s.reviews.length&&o.closest(".collected-by-header").text(TM("supported by",null,"people that have purchased this item"))})),"phone"===MediaView.mode&&o.removeClass("item-link also-link").addClass("not-a-link")}},e.collectItem=function(e,t,n,a,o){const s={};if(null===CurrentFan||"undefined"==typeof CurrentFan||null===CurrentFan.fan_id)return;if(s.fan_id=CurrentFan.fan_id,s.item_id=e,s.item_type=t,s.band_id=n,CurrentFan.is_own_collection||(s.ref_username=FanData.username),$(o).closest(".collection-item-container").find(".collection-item-actions").addClass("wishlisted").removeClass("wishlist"),i("/collect_item_cb",s,(function(){CurrentFan.collection_count++,$("#menubar-collection-count").html(CurrentFan.collection_count)})),FanOnboarding.showFirstWishlistTooltip&&0===$(".signup-tooltip-parent.show-tooltip").length&&"phone"!==MediaView.mode){FanOnboarding.setFirstWishlistedItem(a,s.item_type),FanOnboarding.showFirstWishlistTooltip=!1;const e=$(o).closest(".signup-tooltip-parent")[0];window.FanOnboarding.showTooltip("x",e)}const r={click_type:"wishlist",item_id:e,item_type:t,user_type:"fan"};BCTracker.record("click",r)},e.uncollectItem=function(e,t,n){const a={};if(null===CurrentFan||"undefined"==typeof CurrentFan||null===CurrentFan.fan_id)return;n=void 0!==n&&n,a.fan_id=CurrentFan.fan_id,a.item_id=e,$(t).closest(".collection-item-container").find(".collection-item-actions").addClass("wishlist").removeClass("wishlisted"),i("/uncollect_item_cb",a,(function(){CurrentFan.collection_count--,$("#menubar-collection-count").html(CurrentFan.collection_count),n&&$(t).closest(".collection-item-controls").empty()}));const o={click_type:"unwishlist",item_id:a.item_id,item_type:a.item_type,user_type:"fan"};BCTracker.record("click",o)},e.showHideComments=function(e){$("#comments-container_"+e).toggleClass("hidden"),$("#collection-item-container_"+e).toggleClass("active")},e.featureAccount=function(){i("/feature_fan_cb",{fan_id:FanData.fan_id,feature:1},(function(){location.reload()}))},e.cancelSubscription=function(e){const t=$(e.target),n=t.data("sub-id"),a=t.data("band-id"),i=t.data("band-name");NuDialog.alert("Cancel Subscription","Are you sure you want to cancel this fan's subscription to "+i+"? They will keep their content but immediately lose access to other subscription features.",{buttons:{"Do it":function(){Crumb.ajax({url:"/api/artistsub/1/admin_cancel_sub",data:{fan_id:FanData.fan_id,sub_id:n,band_id:a},dataAs:"JSON",type:"POST",success:function(e){window.location.reload()},error:function(e,t,n){Log.error("Cancel subscription error: ",t,n)}}),$(this).dialog("close")},"No don't":function(){$(this).dialog("close")}}})},e.nukeSubscription=function(e){const t=$(e.target),n=t.data("sub-id"),a=t.data("band-id"),i=t.data("band-name");NuDialog.alert("Nuke Subscription","Are you sure you want to nuke this fan's subscription to "+i+"?\n This will also remove any collection items associated with this subscription.",{buttons:{"Do it":function(){Crumb.ajax({url:"/api/artistsub/1/admin_nuke",data:{fan_id:FanData.fan_id,sub_id:n,band_id:a},dataAs:"JSON",type:"POST",success:function(e){window.location.reload()},error:function(e,t,n){Log.error("Nuke subscription error: ",t,n)}}),$(this).dialog("close")},"No don't":function(){$(this).dialog("close")}}})},e.unfeatureAccount=function(){i("/feature_fan_cb",{fan_id:FanData.fan_id},(function(){location.reload()}))};let n=!1;function a(e){let t=[],n="nu-dialog mailing-list-opt-in blank-title";e.label_id?(n+=" label",t=[{text:TM("Done"),click:function(){const t=$("#notify-me-band").prop("checked"),n=$("#notify-me-label").prop("checked");if(n||t){const a={};t&&(a.band_id=e.band_id),n&&(a.label_id=e.label_id),Crumb.ajax({type:"POST",url:"/band_follow_email_opt_in_cb",data:a,dataType:"json",success:function(e){},error:function(e,t,n){},complete:function(){}})}$(this).dialog("close")}}]):(n+=" band",t=[{text:TM("Yes please!"),click:function(){Crumb.ajax({type:"POST",url:"/band_follow_email_opt_in_cb",data:{band_id:e.band_id},dataType:"json",success:function(e){},error:function(e,t,n){},complete:function(){}}),$(this).dialog("close")}},{text:TM("No thanks"),click:function(){$(this).dialog("close")}}]),NuDialog.showTemplate("fan/band_follow_mailing_list_opt_in",{artist:e.band_name,label:e.label_name,email_address:e.email_address},{dialogClass:n,buttons:t})}function i(e,t,n,a){const i={type:"POST",url:e,data:t,dataType:"json",xhrFields:{withCredentials:!0}};a=a||function(){},Crumb.ajax(i).done((function(e){Trackpipe.showXHRError(e)?Log.error("XHR POST returned error JSON",e):(Log.note("XHR form submission succeeded with data",e),n(e))})).fail((function(e,t,n){if(Log.error("XHR POST failed",e,t,n),e.data)Trackpipe.showXHRError(e.data);else{const e=[];e.push({text:TM("OK"),click:function(e){$(this).dialog("close")}}),NuDialog.alert(TM("Network Error",null,"Dialog box title."),TM("There was a network error while processing your request. Please try again."),{buttons:e})}a()}))}e.followUnfollow=function(e,t,a){const o=$("#pagedata").data("blob")||{};null==e&&(e=FanData.fan_id);let s=$(a)[0];s||(s=$("#follow-unfollow_"+e)[0]);const r=$(s).hasClass("following")?"unfollow":"follow",l={fan_id:CurrentFan.fan_id,follow_id:e,action:r};!Identities.fan()||Identities.fan()&&!Identities.fan().verified?FanAction.doAction("follow",null,null,l.follow_id,"f",null,l):("undefined"!=typeof FROM_FANSUGGEST&&FROM_FANSUGGEST&&"follow"==r&&!n&&(l.from_fansuggest=!0,n=!0),$(s).toggleClass("following"),i("/fan_follow_cb",l,function(t){if(!t.ok){$(s).toggleClass("following");const e=[];e.push({text:TM("OK"),click:function(e){$(this).dialog("close")}});let n=t.reason;"read_only"===n&&(n="Fans are currently read only, please try to follow later"),NuDialog.alert(TM("Error",null,"Dialog box title."),n,{buttons:e})}if($("body").trigger("fan_"+r+"ed",[e]),!CurrentFan.is_following_any&&(!window.FanData||!FanData.is_own_page)&&"phone"==window.MediaView.mode&&o.mobile_app_compatible){CurrentFan.is_following_any=!0;const t=TM("Following!",null,"Title for dialog box suggesting the fan uses the bandcamp app.");let n="";if(e==FanData.fan_id)n=FanData.name;else{n=$.extend({},ItemCache.followers,ItemCache.following_fans)[e].name}const a={platform_app_url:o.platform_app_url,mobile_app_url:o.mobile_app_url,fan_name:n};NuDialog.showTemplate("fan/collection/fan_first_follow_pane",a,{width:"90%",title:t,buttons:{}})}}.bind({action:r}),function(){$(s).toggleClass("following")}.bind({action:r})),Stats.record({kind:"click",click:"fan_"+r}))},e.showMailingListDialog=a,e.followUnfollowBand=function(e){const t=$("#follow-unfollow-band_"+e)[0],n=$(t).hasClass("following")?"unfollow":"follow",o=FanData.fan_id,s={fan_id:CurrentFan.fan_id,follow_id:o,action:n};!Identities.fan()||Identities.fan()&&!Identities.fan().verified?FanAction.doAction("follow",null,null,null,null,e,s):(i("/fan_follow_band_cb",{fan_id:CurrentFan.fan_id,band_id:e,action:n},(function(n){if($(t).toggleClass("following"),n.is_following){const i=n.mailing_list_info;i.band_name=t.dataset.bandName,i.band_id=e,a(i)}})),Stats.record({kind:"click",click:"band_"+n}))},e.followUnfollowGenre=function(e){const t=$("#follow-unfollow-genre_"+e)[0],n=$(t).hasClass("following")?"unfollow":"follow";if($(t).toggleClass("following"),!$(t).hasClass("following")&&CurrentFan.fan_id==FanData.fan_id){$("#follow-grid-item-genre_"+e).remove();const t=$("#following-tabs li[data-tab='following-genres'] span.count"),n=Number(t.html());t.html(n-1)}const a={fan_id:CurrentFan.fan_id,follow_id:e,action:n};if(!Identities.fan()||Identities.fan()&&!Identities.fan().verified)return void FanAction.doAction("follow",null,null,e,"g",null,a);const i={action:n,discover_id:e},o=$.Deferred();Crumb.ajax({url:"/api/genrepreferences/1/fan_follow_genre",data:i,dataAs:"JSON",type:"POST",success:function(e){return e.ok?o.resolve(e):(Log.debug("failure response",e),o.reject(e))},error:function(e,t,n){return o.reject()}}),Stats.record({kind:"click",click:"fan_manage_genre_grid_"+n})}}(Fanpage),function(){"use strict";window.FanLocationVM=function(e,t){const n=this;n.location=ko.observable(e||""),n.rawLocation=ko.observable(t||""),n.isNullLocation=ko.computed((function(){return!n.location()||""===n.location()})),n.geocodeTimeout=null,n.loading=ko.observable(!1),n.prevRaw=t,n.geocode=function(){n.rawLocation().length<2?(n.loading(!1),n.location("")):$.post("/geo2_cb",{location:n.rawLocation()}).done((function(e){n.loading(!1),e.raw===n.prevRaw&&n.location(e.text)}))},n.rawLocation.subscribe((function(e){e!=n.prevRaw&&(n.prevRaw=e,n.location("...."),n.loading(!0),n.geocodeTimeout&&clearTimeout(n.geocodeTimeout),0===e.length?n.geocodeTimeout=setTimeout(n.geocode,0):n.geocodeTimeout=setTimeout(n.geocode,500))})),n.reset=function(e,t){n.loading(!1),n.location(e),n.rawLocation(t),n.prevRaw=t}}}(),function(e,t,n){"use strict";e.ForgotPasswordPane=function(e,a){const i=this,o=/(^)([^\s\(\)"'\/><,@]+@\w([^\s\(\)"'\/><&,@]*\w)?\.\w[^\s\(\)"'\/><&,@]*\w)($)/,s=e.state;i.title=TM("Forgot password"),i.pageTitle=TM("Forgot Your Password?"),i.template="fan/signup/fan_forgot_password_pane",i.visible=n.observable(!1),i.immediate=n.observable(!!a.immediate),i.afterRender=function(){i.visible(!0)},i.close=function(){const n=t.Deferred();return e.updateState(i.exportState()),i.immediate(!1),i.visible(!1),n.resolve(),n.promise()},i.email=n.observable(s.email).extend({errorKeys:{empty:"Please enter your email address.",disabled:"Sorry, password reset for that account is disabled.",invalid:"That email address doesn't check out. Example: cool@guy.com",no_match:"We weren't able to find an account by that email address."}}),i.email.validate=function(){const e=t.trim(i.email());i.email.error_key(e&&0!==e.length?o.test(e)?null:"invalid":"empty")},i.email.subscribe((function(){i.email.error_key(null)})),i.validate=function(){i.email.validate()},i.has_errors=n.computed((function(){return!!i.email.error_key()})),i.submitting=n.observable(!1),i.sent=n.observable(!1),i.submitDisabled=n.computed((function(){return!i.email()||i.has_errors()||i.submitting()||i.sent()})),i.submit=function(){i.validate(),i.has_errors()?SignupUtils.scrollToFirstError():(i.submitting(!0),SignupAPI.sendForgotPasswordEmail({email:i.email()}).then((function(e){i.submitting(!1),i.sent(!0)}),(function(e){if(i.submitting(!1),e&&e.errors)Iter.each(e.errors,(function(e){i[e.field]&&i[e.field].error_key&&i[e.field].error_key(e.reason)})),SignupUtils.scrollToFirstError();else if(e){const t="An error occurred - please try again.";NuDialog.alert("Error",e&&e.error||t)}})))},i.backToSignup=function(){i.close().then((function(){e.openPane("signup")}))},i.exportState=function(){return{email:i.email()}},i.hash=function(){return{}}}}(window,$,ko),function(e,t,n){"use strict";e.TosAcceptVM=function(e,a){const i=this;i.title="Bandcamp Terms of Use",i.template="fan/signup/fan_tos_accept",i.hasAgreed=n.observable(!1),i.submitDisabled=n.computed((function(){return!i.hasAgreed()})),i.show=function(){this.dialog=NuDialog.showTemplate(i.template,{},t.extend({width:"auto",minHeight:0,closeOnEscape:!0,title:i.title,draggable:!0,buttons:[],dialogClass:"no-padding"},{})),setTimeout((function(){t(".tos-accept-dialog .tos-accept-agree")[0].focus()}),250),n.applyBindings(this,this.dialog[0])},i.submit=function(){Log.debug("tos-accept submit"),this.dialog.dialog("close"),t(".corpbanner.tos-update").addClass("hide"),SignupAPI.dismissTosBanner()},i.hash=function(){return{}}}}(window,$,ko),function(e,t,n){"use strict";e.ResetPasswordPane=function(e,a){const i=this;i.title=i.pageTitle=TM("Reset password"),i.template="fan/signup/fan_reset_password_pane",i.visible=n.observable(!1),i.immediate=n.observable(!!a.immediate),i.afterRender=function(){i.visible(!0)},i.close=function(){const n=t.Deferred();return e.updateState(i.exportState()),i.immediate(!1),i.visible(!1),n.resolve(),n.promise()},i.password=n.observable("").extend({errorKeys:{empty:"Please enter a new password."}}),i.password.validate=function(){const e=i.password();i.password.error_key(e&&0!==e.length?null:"empty")},i.validate=function(){i.password.validate()},i.has_errors=n.computed((function(){return!!i.password.error_key()})),i.submitDisabled=n.computed((function(){return!i.password()||i.submitting()})),i.unrecoverableError=n.observable(!1),i.reset=n.observable(!1),i.submitting=n.observable(!1),i.submit=function(){i.validate(),i.has_errors()?SignupUtils.scrollToFirstError():(i.submitting(!0),SignupUtils.resetPassword({password:i.password(),token:a.token}).then((function(e){i.reset(!0),SignupUtils.asyncLogin(e),i.backToSignup()}),(function(e){if(i.submitting(!1),e&&e.errors)Iter.each(e.errors,(function(e){"password"===e.field&&("unrecoverable_error"===e.reason?i.unrecoverableError(!0):i.password.error_key(e.reason))})),SignupUtils.scrollToFirstError();else if(e){const t="An error occurred - please try again.";NuDialog.alert("Error",e&&e.error_message||t)}})))},i.backToSignup=function(){i.close().then((function(){e.openPane("signup")}))},i.exportState=function(){return{}},i.hash=function(){return{}}}}(window,$,ko),function(e,t,n){"use strict";e.ExistingArtistPane=function(a,i){const o=this,s=a.state,r=U.pagedataBlob();o.title="",o.pageTitle=TM("Sign up"),o.template="fan/signup/fan_existing_artist_pane",o.width=505,o.visible=n.observable(!1),o.immediate=n.observable(!!i.immediate),o.afterRender=function(){o.visible(!0)},o.close=function(){const e=t.Deferred();return a.updateState(o.exportState()),o.immediate(!1),o.visible(!1),e.resolve(),e.promise()},o.submit=function(){o.close(!0).then((function(){a.openPane("signup")}))},o.logout=function(){SignupAPI.logout().then((function(){a.updateState({email:null,userName:null,bands:[]}),SignupUtils.asyncLogin({}),"/"===e.location.pathname&&SignupUtils.renderHeader({}),a.resetInitial(),o.close(!0).then((function(){a.openPane("signup")}))}))},o.exportState=function(){return{}},o.hash=function(){return{action:a.actionParams.action,action_item_type:a.actionParams.actionItemType,unsupported_device:r.unsupported_device,user_name:s.userName,bands:s.bands||[]}}}}(window,$,ko),function(e,t,n){"use strict";e.ActionPane=function(a,i){const o=this;o.title="",o.template="fan/signup/fan_action_pane",o.visible=n.observable(!1),o.immediate=n.observable(!!i.immediate),o.afterRender=function(){o.visible(!0)},o.close=function(){const e=t.Deferred();return a.updateState(o.exportState()),o.immediate(!1),o.visible(!1),e.resolve(),e.promise()},this.openSignup=function(){const t=a.actionParams&&a.actionParams.action;if(t){let e=null;"wishlist"===t?e="logged_out_wishlist_signup":"follow"===t&&"f"===a.actionParams.actionItemType?e="logged_out_fan_follow_signup":"follow"===t&&"g"===a.actionParams.actionItemType?e="logged_out_genre_follow_signup":"follow"!==t||a.actionParams.actionItemType&&"b"!==a.actionParams.actionItemType?"live_ticket"===t&&(e="logged_out_live_ticket_purchase_signup"):(e="logged_out_follow_signup",HiddenParams.get("external_follow")&&Stats.record({kind:"click",click:"artist_dash_external_follow_signup"})),Stats.record({kind:"click",click:e})}if("phone"===MediaView.mode){const t={action:a.actionParams.action,from:a.actionParams.from,pane:"signup"};a.initialEmail&&(t.email=a.initialEmail,t.sig=a.initialEmailSignature);let n=siteroot_https+"/fan_signup";return a.actionParams.queryString&&(n+=a.actionParams.queryString),void(e.location.href=Url.addQueryParams(n,t))}if(Url.isCustomDomain())if(a.subdomainURL){const t={fan_action_pane:"signup"};a.actionParams.action&&(t.fan_action=a.actionParams.action,t.item_id=a.actionParams.actionItemId,t.item_type=a.actionParams.actionItemType,t.band_id=a.actionParams.actionBandId),e.location.href=Url.addQueryParams(a.subdomainURL,t)}else e.location.href=siteroot_https+"/fans";else o.close().then((function(){a.openPane("signup")}))},this.openLogin=function(){const t=a.actionParams&&a.actionParams.action;if(t){let e=null;"wishlist"===t?e="logged_out_wishlist_login":"follow"===t&&"f"===a.actionParams.actionItemType?e="logged_out_fan_follow_login":"follow"!==t||a.actionParams.actionItemType&&"b"!==a.actionParams.actionItemType?"live_ticket"===t&&(e="logged_out_live_ticket_purchase_login"):(e="logged_out_follow_login",HiddenParams.get("external_follow")&&Stats.record({kind:"click",click:"artist_dash_external_follow_login"})),Stats.record({kind:"click",click:e})}if("phone"!==MediaView.mode)if(Url.isCustomDomain())if(a.subdomainURL){const t={fan_action_pane:"login"};a.actionParams.action&&(t.fan_action=a.actionParams.action),e.location.href=Url.addQueryParams(a.subdomainURL,t)}else e.location.href=siteroot_https+"/fans";else o.close().then((function(){a.openPane("login")}));else a.actionParams.queryString?e.location.href=siteroot_https+"/fan_signup"+a.actionParams.queryString+"&action="+a.actionParams.action+"&from="+a.actionParams.from+"&pane=login":e.location.href=siteroot_https+"/fan_signup?action="+a.actionParams.action+"&from="+a.actionParams.from+"&pane=login"},o.exportState=function(){return{}},o.hash=function(){return{action:a.actionParams.action,action_item_type:a.actionParams.actionItemType,is_phone:a.isMobile}}}}(window,$,ko),function(e,t,n){"use strict";e.AlmostTherePane=function(e,a){const i=this,o=e.state;i.title=TM("Ready, set, activate!",null,"we're directing the user to activate their account"),i.pageTitle=TM("Sign up"),i.template="fan/signup/fan_almost_there_pane",i.visible=n.observable(!1),i.immediate=n.observable(!!a.immediate),i.portable=e.portable,i.is_phone="phone"===Browser.media_mode,i.noClose=!1,i.afterRender=function(){i.visible(!0),t(".signup-heading").hide(),t("#almost-there-title").show()},i.close=function(){const n=t.Deferred();return e.updateState(i.exportState()),i.immediate(!1),i.visible(!1),n.resolve(),n.promise()},i.submit=function(){Stats.record({kind:"click",click:"fan_signup_almost_there_continue"}),e.isMobile?e.onComplete():e.fanOnboarding&&i.portable?i.openWelcome2():i.portable||e.actionParams.action?e.onComplete():i.openWelcome()},i.openWelcome=function(){i.close().then((function(){e.openPane("welcome")}))},i.openWelcome2=function(){i.close().then((function(){e.openPane("welcome_2")}))},i.exportState=function(){return{}},i.hash=function(){return{email:o.email,username:o.fanUsername,portable:i.portable,is_phone:i.is_phone}}}}(window,$,ko),function(e,t,n){"use strict";e.WelcomePane=function(a,i){const o=this,s=a.state,r=U.pagedataBlob();o.platform_app_url=r.platform_app_url,o.mobile_app_url=r.mobile_app_url,o.app_store_url=r.app_store_url,o.play_store_url=r.play_store_url,o.unsupported_device=r.unsupported_device,o.is_phone="phone"===Browser.media_mode,o.followOnly=r.signup_params.follow_only,o.wishlistOnly=r.signup_params.wishlist_only,o.noClose=!0,o.isActivationView="welcome"===a.initialPane&&!a.portable,o.isBandMember=Identities.bmgr.bands().length>0||a.state.asyncIdentities&&a.state.asyncIdentities.bands&&a.state.asyncIdentities.bands.length>0,a.portable&&"phone"!==MediaView.mode?o.title=TM("Welcome"):o.title="",o.pageTitle=TM("Welcome"),o.template="fan/signup/fan_welcome_pane",a.portable||t("#propOpenWrapper").addClass("welcome"),t(".bc-toplogo")&&t(".bc-toplogo").hide(),o.visible=n.observable(!1),o.immediate=n.observable(!!i.immediate),o.appLinkSent=n.observable(!1),o.appLinkEmail=s.email;o.sendAppLinkEmail=function(){o.appLinkSent(!0);const e=s.email;var t;(t=e)&&-1!==t.indexOf("@")?SignupAPI.sendAppLinkEmail({fan_username:s.fanUsername,email:e}).then((function(e){e&&e.ok||(Log.error(e&&e.error),NuDialog.alert(TM("Signup Error"),TM("There was a problem sending the email. Please try again.")),o.appLinkSent(!1))})):(NuDialog.alert(TM("Signup Error"),TM("There was a problem sending the email. Please try again.")),o.appLinkSent(!1))},o.closeAppLinkModal=function(){o.$dialog.dialog("close")},o.appLinkModal=function(){s.email&&!o.appLinkSent()&&o.sendAppLinkEmail(),o.$dialog=NuDialog.showTemplate("fan/signup/fan_email_link",{},{dialogClass:"nu-dialog no-close blank-title",buttons:{}}),n.applyBindings(o,o.$dialog[0])},o.afterRender=function(){o.visible(!0),t(".signup-heading").hide(),t("#signup-title").hide(),t(".fan-signup .top-divider").hide(),"welcome"===a.initialPane?t("#sign-up-active").show():o.isBandMember?t("#sign-up-welcome-artist").show():(t("#sign-up-welcome .sign-up-welcome-fan-name").text(s.fanUsername),t("#sign-up-welcome").show())},o.close=function(){const e=t.Deferred();return t("#propOpenWrapper").removeClass("welcome"),a.updateState(o.exportState()),o.immediate(!1),o.visible(!1),e.resolve(),e.promise()},o.buttonEnabled=n.observable(!0),o.submit=function(){o.buttonEnabled(!1),a.onComplete()},o.getApp=function(){e.location.href=o.platform_app_url},o.exportState=function(){return{}},o.hash=function(){return{email:s.email,username:s.fanUsername,action:a.actionParams.action,unsupported_device:o.unsupported_device,platform_app_url:o.platform_app_url,mobile_app_url:o.mobile_app_url,app_store_url:r.app_store_url,play_store_url:r.play_store_url,is_phone:o.is_phone,portable:a.portable,is_band_member:o.isBandMember,is_activation_view:o.isActivationView}}}}(window,$,ko),function(e,t,n){"use strict";e.VerifyNag=function(e,a){const i=this;i.title=TM("Activate your account"),i.fanEmail=n.observable(e.fan_email),i.skipToEmail=e.skipToEmail,i.changingEmail=n.observable(!1),i.submitted=n.observable(!1),i.resentEmail=n.observable(!1),i.skipToEmail&&i.changingEmail(!0),i.emailError=n.observable(),i.alreadyAFanError=n.computed((function(){return"already_a_fan"==i.emailError()})),i.fanAlreadyLinkedEmailError=n.computed((function(){return"fan_already_linked_email"==i.emailError()})),i.invalidEmailError=n.computed((function(){return"invalid_email"==i.emailError()})),i.openDialog=function(){i._dialog=NuDialog.showTemplate("fan/signup/fan_verify_nag_pane",{email:i.fanEmail()},{dialogClass:"nu-dialog center-title no-close",draggable:!0,width:"phone"===MediaView.mode?"90%":500,modal:!0,title:i.title,buttons:{},closeOnEscape:!1}),n.applyBindings(i,t("#nag-vm")[0])},i.closeDialog=function(){if(i.skipToEmail||i.changingEmail(!1),i.submitted(!1),i._dialog&&(i._dialog.dialog("close"),a)){const t=i.fanEmail()!==e.fan_email?i.fanEmail():null,n=i.resentEmail();a(t,n)}},i.submit=function(){!i.changingEmail()||i.submitted()?i.closeDialog():i.resendEmail()},i.cancel=function(){i.closeDialog()},i.resendEmail=function(){i.resentEmail(!0);const e={email:i.fanEmail()};SignupAPI.resendFanVerifyEmail(e).then((function(e){e.ok&&i.submitted(!0)}),(function(e){e.errors&&e.errors[0]&&"email"==e.errors[0].field&&i.emailError(e.errors[0].reason)}))},i.changeEmail=function(){i.changingEmail(!0)}}}(window,$,ko),function(e,t,n){"use strict";e.DupeFanPane=function(a,i){const o=this,s=a.state;o.title="",o.pageTitle=TM("Signup error"),o.template="fan/signup/fan_dupe_fan_pane",o.width=505,o.visible=n.observable(!1),o.immediate=n.observable(!!i.immediate),o.afterRender=function(){o.visible(!0)},o.close=function(){const e=t.Deferred();return a.updateState(o.exportState()),o.immediate(!1),o.visible(!1),e.resolve(),e.promise()},o.submit=function(){o.close(!0)},o.email=s.email,o.logout=function(){SignupAPI.logout().then((function(){o.close(!0).then((function(){e.location.href=siteroot_https+"/login"}))}))},o.exportState=function(){return{}},o.hash=function(){return{fan:a.affiliations&&a.affiliations.fan,fan_already_linked_email:a.affiliations&&a.affiliations.fan_already_linked_email,email:o.email}}}}(window,$,ko),function(e,t,n){"use strict";e.ChooseAccountPane=function(a,i){const o=this;a.state;o.title=TM("Sign up for a Bandcamp account"),o.pageTitle=TM("Sign up for a Bandcamp account"),o.template="fan/signup/fan_choose_account_pane",o.width=500,o.visible=n.observable(!1),o.immediate=n.observable(!!i.immediate),o.afterRender=function(){let e=null;e="home"===a.originPage||"corp"===a.originPage?"corp_header_single_signup":"menubar_single_signup",o.visible(!0),Stats.record({kind:"click",click:e})},o.close=function(){const e=t.Deferred();return a.updateState(o.exportState()),o.immediate(!1),o.visible(!1),e.resolve(),e.promise()},o.openFanSignup=function(){let t=null;const n=void 0!==e.SubscribeVM&&!e._community;t="home"===a.originPage||"corp"===a.originPage?"corp_header_single_signup_fan":"menubar_single_signup_fan",Stats.record({kind:"click",click:t}),o.close().then((function(){n?e.location.href=siteroot_https+"?fan_action_pane=signup":a.openPane("signup")}))},o.exportState=function(){return{}},o.hash=function(){return{fans_from:"home"===a.originPage||"corp"===a.originPage?"hpfans":"menubar",artists_from:"home"===a.originPage||"corp"===a.originPage?"hpartists":"menubar",labels_from:"home"===a.originPage||"corp"===a.originPage?"hplabels":"menubar",signup_params:{standalone:!a.portable}}}}}(window,$,ko),function(e,t,n){"use strict";const a=function(e){let t;return t=e>900?540:e<=700?350:e-360,t},i=function(e,t){let n;return n=e>900?604:e<=700?414:e-296,t&&(n+=26),n},o=function(e){const n=t(".search-wrapper");return n.position().top+n.height()},s=function(e,a,i,o,s,r){const l=this;l.name=a.name,l.normName=a.norm_name,l.geonameName=a.geoname_name,l.format=a.format,l.displayName=n.computed({read:function(){const t=e.selectedGenres();let n,a=!1;t.forEach((function(e){e!==l&&e.name===l.name&&(a=!0)})),n=a&&i?i.name+" / "+l.name:l.name;const o=[];return n&&o.push(n),l.geonameName&&o.push(l.geonameName),l.format&&"all"!==l.format&&o.push(l.format),o.join(" / ").toLowerCase()},deferEvaluation:!0}),l.value=a.value||a.norm_name,l.id=a.id||a.tag_id||a.genre_id,l.discoverId=a.discover_id,l.parentGenre=i,l.isFake=!1,l.isCustom=!!o,l.isSearch=r,l.expanded=n.observable(o),l.selected_=n.observable(!!s),l.selected=n.computed({read:function(){return!l.expanded()&&l.subgenres&&l.subgenres().length>0&&!!Iter.find(l.subgenres(),(function(e){return e.selected()}))||l.selected_()},write:function(e){l.selected_(e)}}),l.selectedSecondPane=n.computed((function(){return l.selected_()})),l.isLong="electronic"===l.value,l.cssId=l.value+"-box",l.visible=n.observable(!1),l.hiding=n.observable(!1),l.collapsing=!1,l.toggleSelect=function(n,a){e.searchHasFocus(!1);const o=l.selected();if(l.selected(!o),e.isFirstPane&&e.isFirstPane()&&t("#signup-vm .mobile #"+l.value+"-box").toggleClass("selected",!o),o){l.hiding(!0),l.visible(!1);const t=function(){e.selectedGenres.remove(l),l.hiding(!1)};e.selectedGenres().length>1?setTimeout((function(){t()}),300):t()}else e.selectedGenres.unshift(l),setTimeout((function(){l.visible(!0)}),0);i||Iter.find(l.subgenres(),(function(e){return e.selected()}))?!i||i.selected()||Iter.find(i.subgenres(),(function(e){return e.selected()}))||(i.expanded(!1),n||(i.collapsing=!0),e.isMobile||a||e.$genres.masonry()):(n||(l.collapsing=!0),l.expanded(!1),e.isMobile||a||e.$genres.masonry())},l.expand=function(n,a){l.expanded()||l.collapsing?l.collapsing=!1:(l.selected()?t("#signup-vm .mobile #"+l.value+"-box").toggleClass("selected",l.selected()):(l.selected(!0),t("#signup-vm .mobile #"+l.value+"-box").toggleClass("selected",l.selected()),e.selectedGenres.unshift(l),setTimeout((function(){l.visible(!0)}),0)),l.expanded(!0),Iter.each(e.genres,(function(e){e!==l&&e.expanded(!1)})),e.isMobile||e.$genres.masonry())},l.hasExpandedClass=n.computed((function(){return"podcasts"!==l.normName&&"audiobooks"!==l.normName&&(!!l.isSearch||l.expanded())})),l.subgenres=n.observableArray()};var r=function(l,c){const d=this,p=l.state,u=t(e).width()>768;d.isWide=u,d.title=null,d.overflowDialog=!0,d.pageTitle=TM("Choose your favorite genres"),d.template="fan/signup/fan_genre_picker_pane",d.width=u?720:555,d.standalone=n.observable(c.standalone),d.isMobile=l.isMobile;const m=t(e).width(),h=t(e).height(),f=d.isMobile?null:a(h)+"px",g=d.isMobile?null:i(h)+"px";let _;if(d.genres_overflow_wrapper_height=n.observable(f),d.search_results_top=n.observable(i(g)),d.hash=function(){return{fan_name:d.isMobile?Identities.fan()&&Identities.fan().name:p.fanUsername,genres_overflow_wrapper_height:d.genres_overflow_wrapper_height(),search_results_top:d.search_results_top(),skinny:m<=768,from_newsletter_invite_banner:p.fromNewsletterInvite,is_phone:d.isMobile}},d.standalone()?(Stats.record({kind:"click",click:"fan_manage_genre_start"}),d.templateName=n.observable(d.template),d.templateHash=n.observable(d.hash()),d.$dialog=n.observable()):Stats.record({kind:"click",click:"fan_signup_genre_start"}),d.currentPane=n.observable("genres"),d.showGenres=n.computed((function(){return"genres"==d.currentPane()})),d.showSubgenres=n.computed((function(){return"subgenres"==d.currentPane()})),d.isFirstPane=n.computed((function(){return"genres"==d.currentPane()})),d.visible=n.observable(!1),d.immediate=n.observable(!!c.immediate),d.minGenres=n.observable(u?5:4),d.submitting=n.observable(!1),d.submitEnabled=n.computed((function(){return!d.submitting()})),d.genres=[],d.suggestedNewsletters=[],c.genres){const e=FanSignup.actionParams.action,t=Iter.find(c.genres,(function(e){return e.id==FanSignup.actionParams.genreId}));"follow"!==e&&"wishlist"!==e||!t||(_=new s(d,t),c.subgenres[t.value]&&Iter.each(c.subgenres[t.value],(function(e){_.subgenres.push(new s(d,e,_))})),d.genres.push(_)),Iter.eachWithIndex(c.genres,(function(e,n){t&&t.id==e.id||(_=new s(d,e),c.subgenres[e.value]&&Iter.each(c.subgenres[e.value],(function(e){_.subgenres.push(new s(d,e,_))})),d.genres.push(_))}))}d.numCustomFollows=n.observable(0),d.selectedGenres=n.observableArray(),d.selectedGenres.noAnimation=n.observable(!0),d.showPageLeft=n.observable(!1),d.showPageRight=n.observable(!1),d.selectedGenresSubscription=d.selectedGenres.subscribe((function(n){l.additionalBundlePromise.done((function(){setTimeout((function(){const a=d.$selectedGenresEl.scrollLeft(),s=d.$selectedGenresEl.width(),r=d.$selectedGenresEl[0].scrollWidth;d.showPageLeft(a>0),d.showPageRight(a+s<r),t(".search-results",d.$root).css({top:d.isMobile?o(e.innerHeight):i(t(e).height(),n.length>0)})}),200)}))})),d.prefilledGenres=n.observableArray(),d.prefillSelectedGenres=function(e){d.prefilledGenres=n.observableArray();Object.keys(e).map((function(t){return e[t]})).forEach((function(e){let t=!0;if(e.geoname_name||e.format&&"all"!==e.format||d.genres.forEach((function(n){if(e.genre_id===n.id)if(0===e.tag_id){t=!1;-1==d.selectedGenres().indexOf(n)&&(d.prefilledGenres.unshift(n),n.toggleSelect(!1,!0),setTimeout((function(){n.visible(!0)}),0))}else n.subgenres&&n.subgenres().length>0&&(n.subgenres().forEach((function(n){e.norm_name===n.normName&&(t=!1,d.prefilledGenres.unshift(n),n.toggleSelect(!1,!0),setTimeout((function(){n.visible(!0)}),0))})),n.selected(!n.selected_()),n.selected(!n.selected_()))}),d),t){const t=new s(d,{name:e.name,norm_name:e.norm_name,value:e.norm_name,id:e.discover_id,discover_id:e.discover_id,geoname_name:e.geoname_name,format:e.format},null,!0,!0);d.selectedGenres.unshift(t),d.numCustomFollows(d.numCustomFollows()+1),d.prefilledGenres.unshift(t),setTimeout((function(){t.visible(!0)}),0)}}),this)},d.searchClick=function(){return d.searchTerm()&&d.searchTerm().length>0&&0===d.searchResults().length&&d.doSearch(d.searchTerm()),!1},d.searchWrapperClick=function(){d.scrollToSearch()},d.scrollToSearch=function(){d.$genresWrapper.animate({scrollTop:d.$genresWrapper[0].scrollHeight},100)},d.deselectClick=function(e,n){if(!t.contains(t(".search-input-wrapper",d.$root[0])[0],n.target)&&!t.contains(t(".search-results",d.$root[0])[0],n.target))return d.searchHasFocus(!1),d.searchSelectIndex(null),d.searchResults([]),!0},d.searchHasFocus=n.observable(!1),d.searchResults=n.observableArray([]),d.searchTerm=n.observable(),d.truncatedSearchTerm=n.computed((function(){const e=d.searchTerm();return Text.truncate(e,15,"...")})),d.searching=n.observable(!1),d.searchHasFocus.subscribe((function(n){d.isMobile&&!n&&e.scrollTo(0,d.$root.offset().top),d.isMobile&&n&&t(".search-results").css({top:o()})})),d.searchSelectIndex=n.observable(null),d.searchSelectIndex.subscribe((function(e){0===e?d.searchHasFocus(!0):d.searchHasFocus(!1)})),d.doSearch=function(e){const n=[],a={};e=t.trim(e.toString()).toLowerCase().replace(/^#+/g,""),d.searching(!0);const i=(new Date).getTime(),o=function(n){e===t.trim(d.searchTerm().toString()).toLowerCase().replace(/^#+/g,"")&&(d.searching(!1),0===n.length&&n.push({isEmpty:!0}),d.searchResults(n))};SignupAPI.customGenreSearch(e,10).then((function(s){if(e!==t.trim(d.searchTerm().toString()).toLowerCase().replace(/^#+/g,""))return;if(!s.matching_tags||0===s.matching_tags)return void o(n);Iter.each(s.matching_tags,(function(t){const i=t.tag_name.toLowerCase();if(n.length>=10||a[i])return;const o=i.indexOf(e),s=i.slice(0,o),r=i.slice(o+e.length,i.length),l=o>=0?s+"<b>"+Text.escapeHtml(e)+"</b>"+r:i;n.push({displayName:l,name:i,normName:t.tag_norm_name,isCustom:!0,count:t.count,countText:TP("{{count}} match","{{count}} matches",t.count)}),a[t.name]=!0}));const r=(new Date).getTime()-i;r<0?setTimeout((function(){o(n)}),0-r):o(n)}),(function(){const e=(new Date).getTime()-i;e<0?setTimeout((function(){o(n)}),0-e):o(n)}))},d.searchTerm.subscribe((function(e){d.searching(!1),e&&e.length>2?(d.searchResults([]),d.doSearch(e)):d.searchResults([])})),d.collapseSearch=function(e){d.searchResults([]),e&&d.searchTerm(null),d.searchHasFocus(!1),d.searchSelectIndex(0)},d.expandSearch=function(){d.searchResults([]),d.doSearch(d.searchTerm())},d.selectSearchResult=function(e){e.isCustom?d.selectCustomGenre(e.name,e.normName):(d.collapseSearch(!0),Iter.each(d.genres,(function(t){t.expanded(!1),e.parentGenreID||e.name!==t.name?e.parentGenreID===t.id?(t.expanded(!0),d.isMobile||d.$genres.masonry(),Iter.each(t.subgenres(),(function(t){e.name===t.name&&(t.selected(!0),Iter.find(d.selectedGenres(),(function(e){return e.name===t.name}))||(d.selectedGenres.unshift(t),setTimeout((function(){t.visible(!0)}),0)))}))):t.expanded(!1):(t.selected(!0),t.expanded(!0),d.isMobile||d.$genres.masonry(),Iter.find(d.selectedGenres(),(function(e){return e.name===t.name}))||(d.selectedGenres.unshift(t),setTimeout((function(){t.visible(!0)}),0)))})),d.isMobile||d.$genres.masonry())},d.onlyFollowsCustom=function(){return d.numCustomFollows()===d.selectedGenres().length},d.selectCustomGenre=function(e,t){d.collapseSearch(!0);const n=new s(d,{name:e,norm_name:t},null,!0,!0);d.selectedGenres.unshift(n),d.numCustomFollows(d.numCustomFollows()+1),setTimeout((function(){n.visible(!0)}),0)},d.searchInputKeypress=function(e,n){const a=n.keyCode||n.which;switch(d.scrollToSearch(),a){case 9:case 40:n.preventDefault(),d.searchSelectIndex(d.searchSelectIndex()+1),1===d.searchSelectIndex()&&t(".search-results li:first",d.$root[0]).focus();break;case 38:if(n.preventDefault(),0===d.searchSelectIndex())return;d.searchSelectIndex(d.searchSelectIndex()-1);break;case 13:n.preventDefault(),0===d.searchResults().length&&d.searchTerm()&&d.searchTerm().length>0&&d.expandSearch();break;case 27:return n.preventDefault(),d.searchHasFocus(!1),d.searchResults([]),!1;default:return!0}},d.searchInputMouseover=function(e,t){0!==d.searchResults().length&&(t.preventDefault(),d.searchSelectIndex(0))},d.searchResultsKeypress=function(e,n){const a=n.keyCode||n.which;switch(d.scrollToSearch(),a){case 38:n.preventDefault(),d.searchSelectIndex(d.searchSelectIndex()-1),0===d.searchSelectIndex()&&t(".search-wrapper input",d.$root[0]).focus();break;case 40:if(n.preventDefault(),d.searchSelectIndex()===d.searchResults().length)return;d.searchSelectIndex(d.searchSelectIndex()+1);break;case 13:var i=d.searchSelectIndex()-1,o=d.searchResults()[i];o&&(o.isCustom?d.selectCustomGenre(o.name,o.normName):d.selectSearchResult(o));break;case 27:d.searchResults([]);break;default:return!0}},d.searchResultsMouseover=function(e){d.searchSelectIndex(e+1)};d.pageLeft=function(){const e=d.$selectedGenresEl.width(),t=d.$selectedGenresEl[0].scrollWidth,n=d.$selectedGenresEl.scrollLeft()-.5*e;d.searchResults([]),d.$selectedGenresEl.animate({scrollLeft:n},200),setTimeout((function(){d.showPageLeft(n>0),d.showPageRight(n+e<t)}),200)},d.pageRight=function(){const e=d.$selectedGenresEl.width(),t=d.$selectedGenresEl[0].scrollWidth,n=d.$selectedGenresEl.scrollLeft()+.5*e;d.searchResults([]),d.$selectedGenresEl.animate({scrollLeft:n},200),setTimeout((function(){d.showPageLeft(n>0),d.showPageRight(n+e<t)}),200)},d.resetScroll=function(){d.searchResults([]);const e=d.$selectedGenresEl.scrollLeft(),t=d.$selectedGenresEl.width(),n=d.$selectedGenresEl[0].scrollWidth;d.$selectedGenresEl.animate({scrollLeft:0},200),d.showPageLeft(e>0),d.showPageRight(e+t<n)},d.scrollTop=function(){t(".genres-overflow-wrapper").scrollTop(0)},d.exportSelectedGenres=function(){const e=d.selectedGenres(),t=[];return Iter.each(e,(function(e){e.parentGenre?t.push({genre_norm_name:e.parentGenre.normName,name:e.name,subgenre_norm_name:e.normName}):t.push({genre_norm_name:e.normName,name:e.name,subgenre_norm_name:null})})),t},d.afterRender=function(){const n=function(){if(d.$root=t("#signup-vm"),d.isMobile||(d.$genres=t(".genres",d.$root[0]).masonry({itemSelector:".genre",stamp:".search",columnWidth:162})),d.visible(!0),d.standalone()&&!d.isMobile&&t("#signup-vm").toggleClass("standalone"),d.$selectedGenresEl=t("ul.selected-genres",d.$root[0]),d.$genresWrapper=t(".genres-overflow-wrapper",d.$root[0]),d.$selectedGenresEl.on("scroll",(function(){const e=d.$selectedGenresEl.scrollLeft(),t=d.$selectedGenresEl.width(),n=d.$selectedGenresEl[0].scrollWidth;d.searchResults([]),d.showPageLeft(e>0),d.showPageRight(e+t<n)})),d.$genresWrapper.on("scroll",(function(){d.searchResults().length>0&&d.collapseSearch(!1)})),t(e).height()>t(".ui-dialog").height()+30&&t("body").addClass("prevent-scroll"),setTimeout((function(){d.selectedGenres.noAnimation(!1)}),0),!d.isMobile){const n=e.innerHeight;t(".genres-overflow-wrapper",d.$root).css({height:a(n)}),t(".search-results",d.$root).css({top:i(n,d.selectedGenres().length>0)})}};l.additionalBundleLoaded?n():l.additionalBundlePromise.done((function(){n()})),t(e).resize((function(){if(!(l._pane&&!l._dialog&&!(FanSignup._pane instanceof r)||d.standalone()&&!!d.$dialog()||p.fromNewsletterInvite))return;const n=l._dialog||d.$dialog&&d.$dialog();if(!n)return;d.searchResults([]);const o=e.innerWidth,s=e.innerHeight;d.isMobile||(o<=768?(d.minGenres(4),n.dialog("option","width",555),d.$root.addClass("skinny")):(d.minGenres(5),n.dialog("option","width",720),d.$root.removeClass("skinny")),t(".genres-overflow-wrapper",d.$root).css({height:a(s)}),t(".search-results",d.$root).css({top:i(s,d.selectedGenres().length>0)})),n.dialog("option","position",{my:"center center",at:"center center",of:e})}))},d.submitEnabled=n.computed((function(){return!d.submitting()})),d.canShowSubgenres=function(){return d.selectedGenres().length!==d.numCustomFollows()},d.exportGenrePreferences=function(){const e=[],t=[];return d.prefilledGenres().forEach((function(e){-1===d.selectedGenres().indexOf(e)&&(p.fromNewsletterInvite||Stats.record({kind:"click",click:"fan_manage_genre_picker_unfollow"}),t.unshift({genre_id:e.id||e.parentGenre&&e.parentGenre.id,genre_norm_name:e.id?e.normName:e.parentGenre&&e.parentGenre.normName,subgenre_norm_name:!e.id&&e.normName,discover_id:e.discoverId}))}),d),d.selectedGenres().forEach((function(t){-1===d.prefilledGenres().indexOf(t)&&(!p.fromNewsletterInvite&&d.standalone()&&Stats.record({kind:"click",click:"fan_manage_genre_picker_follow"}),e.unshift({genre_id:t.id||t.parentGenre&&t.parentGenre.id,genre_norm_name:t.id?t.normName:t.parentGenre&&t.parentGenre.normName,subgenre_norm_name:!t.id&&t.normName}))}),d),{toFollow:e,toUnfollow:t}},d.next=function(){if(d.standalone()&&!d.isMobile&&d.isFirstPane()||d.standalone()&&d.isMobile&&!d.isFirstPane())return void d.saveGenrePreferences();if(d.isMobile&&d.isFirstPane()){if(d.standalone())return(d.selectedGenres().length>0||d.prefilledGenres().length>0)&&d.canShowSubgenres()?void d.currentPane("subgenres"):void d.saveGenrePreferences();if(d.selectedGenres().length>0&&d.canShowSubgenres())return void d.currentPane("subgenres")}const e=d.exportGenrePreferences();if(e.toFollow.length>0||e.toUnfollow.length>0){if(d.submitting())return;d.submitting(!0),p.fromNewsletterInvite||Stats.record({kind:"click",click:"fan_signup_genre_pick"}),SignupAPI.setGenrePreferences(e).then((function(e){d.submitting(!1),e.error||(d.suggestedNewsletters=e.suggested_newsletters,d.switchPane("newsletter_picker"))}),(function(e){d.submitting(!1)}))}else d.standalone()||(p.fromNewsletterInvite||Stats.record({kind:"click",click:"fan_signup_genre_skip"}),d.switchPane("newsletter_picker"))},d.saveGenrePreferences=function(){const a=d.exportGenrePreferences();if(a.toFollow.length>0||a.toUnfollow.length>0){if(d.submitting())return;d.submitting(!0),Stats.record({kind:"click",click:"fan_manage_genre_pick"}),SignupAPI.setGenrePreferences(a).then((function(a){d.submitting(!1),a.error||(e.GenrePickerPaneVM.$dialog().dialog("close"),n.cleanNode(t("#signup-vm")),e.location.href=GenreGrid.urlQueryParams("from","genres"))}),(function(e){d.submitting(!1)}))}},d.switchPane=function(e){d.close(!0).then((function(){l.openPane(e)}))},d.close=function(){const e=t.Deferred();return d.standalone()?(d.resetScroll(),t("body").removeClass("prevent-scroll")):l.updateState(d.exportState()),d.immediate(!1),d.visible(!1),d.selectedGenresSubscription.dispose(),e.resolve(),e.promise()},d.exportState=function(){return{selectedGenres:d.exportSelectedGenres(),suggestedNewsletters:d.suggestedNewsletters}},l.state.followedGenres&&l.state.followedGenres.length>0&&d.prefillSelectedGenres(l.state.followedGenres)};e.GenrePickerPane=r}(window,$,ko),function(e,t,n){"use strict";const a=function(e){const t=this;t.selected=n.observable(!1),t.title=e.title,t.name=e.name,t.genreId=e.genre_id,t.description=e.description};e.NewsletterPickerPane=function(i,o){const s=this,r=i.state;Stats.record({kind:"click",click:"fan_signup_newsletter_start"}),s.title=null,s.template="fan/signup/fan_newsletter_picker_pane",s.width=480,s.visible=n.observable(!1),s.immediate=n.observable(!!o.immediate),s.afterRender=function(){s.visible(!0),i.isMobile&&i._dialog.dialog("option","position",{my:"center center",at:"center center"})},s.close=function(){const e=t.Deferred();return i.updateState(s.exportState()),s.immediate(!1),s.visible(!1),e.resolve(),e.promise()},s.newsletters=[],Iter.each(r.suggestedNewsletters,(function(e){const t=new a(e);s.newsletters.push(t)})),s.selectedNewsletters=n.computed((function(){return Iter.findAll(s.newsletters,(function(e){return e.selected()}))})),s.bestOfSelected=n.observable(!1),s.hasSelectedGenres=r.selectedGenres.length>0,s.hasSuggestedNewsletters=r.suggestedNewsletters.length>0,s.hasNonNewsletterGenres=s.hasSelectedGenres&&r.selectedGenres.length!==r.suggestedNewsletters.length,s.isValidEmail=-1!==i.state.email.indexOf("@"),s.exportSelectedNewsletters=function(){const e=s.selectedNewsletters();return Iter.collect(e,(function(e){return e.genreId}))},s.skip=function(){Iter.each(s.newsletters,(function(e){e.selected(!1)})),s.submit()},s.submitting=n.observable(!1),s.submitEnabled=n.computed((function(){return!s.submitting()})),s.chooseBestOf=function(){s.bestOfSelected(!0),s.submit()},s.submit=function(){const t=function(){"tag"===i.originPage&&e.hub&&i.state.didLogin||i.isMobile&&o.set_fan_verified?i.onComplete():i.isMobile?s.switchPane("almost_there"):s.switchPane("welcome_2")},n=s.exportSelectedNewsletters(),a=s.bestOfSelected();if(n.length>0||a){if(s.submitting())return;s.submitting(!0),Stats.record({kind:"click",click:"fan_signup_newsletter_pick"}),SignupAPI.subscribeToNewsletters(n,a).then((function(e){s.submitting(!1),e.error||t()}),(function(e){s.submitting(!1)}))}else Stats.record({kind:"click",click:"fan_signup_newsletter_skip"}),t()},s.switchPane=function(e){s.close(!0).then((function(){i.openPane(e)}))},s.exportState=function(){return{subscribedToBestOf:s.bestOfSelected()}},s.hash=function(){return{genres:r.selectedGenres,email:r.email,from_newsletter_invite_banner:r.fromNewsletterInvite}}}}(window,$,ko),function(e,t,n){"use strict";e.Welcome2Pane=function(e,a){const i=this;i.hideTitlebar=!1,i.template="fan/signup/fan_welcome_2_pane",i.title=null,i.width=FanOnboarding.hasSeenTooltips||FanOnboarding.complete?500:520,i.fromEmail=!e._pane;const o="gift_card_redeem"===e.getSignupFrom(),s=(FanOnboarding.deferred||o)&&!!a.set_fan_verified;i.showTooltips=!(FanOnboarding.hasSeenTooltips||FanOnboarding.complete||a.skip_walkthrough||s||"phone"===MediaView.mode),i.visible=n.observable(!1),i.immediate=n.observable(!!a.immediate),i.skipWalkthrough=a.skip_walkthrough||s,i.afterRender=function(){SignupAPI.setWelcomePaneSeen(),i.fromEmail&&i.showTooltips?Stats.record({kind:"click",click:"fan_signup_welcome_email_start"}):i.showTooltips&&Stats.record({kind:"click",click:"fan_signup_welcome_2_start"}),i.visible(!0)},i.close=function(){const n=t.Deferred();return e.updateState(i.exportState()),i.immediate(!1),i.visible(!1),n.resolve(),n.promise()},i.submit=function(){const t=this;t.fromEmail&&t.showTooltips?t.skipWalkthrough?Stats.record({kind:"click",click:"fan_signup_welcome_email_skip"}):Stats.record({kind:"click",click:"fan_signup_welcome_email_pick"}):t.showTooltips&&(t.skipWalkthrough?Stats.record({kind:"click",click:"fan_signup_welcome_2_skip"}):Stats.record({kind:"click",click:"fan_signup_welcome_2_pick"})),t.close().then((function(){FanOnboarding.deferred=!1,t.skipWalkthrough||"corp"!==e.originPage&&"fans"!==e.originPage&&"ppp"!==e.originPage&&e.originPage?s&&"phone"===MediaView.mode?t.close(!0).then((function(){e.openPane("genre_picker")})):s?(FanOnboarding.showNewsletterInviteBanner(),e.signupFrom=null,e.closeDialog()):e.onComplete():e.openHomepageWelcome()}))},i.skip=function(){i.skipWalkthrough=!0,i.submit()},i.exportState=function(){return{skipWalkthrough:i.skipWalkthrough}},i.hash=function(){return{show_tooltips:i.showTooltips}}}}(window,$,ko),function(e,t,n){"use strict";e.CompleteProfilePane=function(e,a){const i=this;i.title=TM("Complete profile","pre",null,"asking fans to complete their profiles"),i.pageTitle=TM("Sign up","pre"),i.template="fan/signup/fan_complete_profile_pane",i.visible=n.observable(!1),i.immediate=n.observable(!!a.immediate),i.portable=e.portable,i.isPhone="phone"===Browser.media_mode,i.noClose=!1,i.completeProfileVM=new CompleteProfileVM({onSubmit:function(){i.close().then((function(){e.onComplete()}))},onError:function(e){const t=e&&SignupUtils.signupError(e)||TM("There was a problem signing up. Please try again.","pre");NuDialog.alert(TM("Signup Error","pre"),t)},onValidationError:function(){SignupUtils.scrollToFirstError()}}),i.afterRender=function(){i.visible(!0),document.getElementById("complete-profile-name-input").focus()},i.close=function(){const n=t.Deferred();return e.updateState(i.exportState()),i.immediate(!1),i.visible(!1),n.resolve(),n.promise()},i.exportState=function(){return{}},i.hash=function(){return{}}}}(window,$,ko),function(e,t,n){"use strict";const a=function(){const t=this;t.hideDownloadBanner()||(t.$root=null,t.elemId="#fan-app-download-banner-vm",t.template="fan/signup/fan_app_download_banner",t.isAppInstalled="1"===Url.getQueryParam(e.location.href,"is_app_installed"),t.redirectToAppURL=siteroot_https+"/this_is_an_appstore_url",t.hash=function(){return{isAppInstalled:t.isAppInstalled,redirectToAppURL:t.redirectToAppURL}},t.bindDownloadBanner())};a.prototype={dismissBanner:function(){t(this.$root).remove()},hideDownloadBanner:function(){const t="1"!==Url.getQueryParam(e.location.href,"show_download_banner"),n=!(U.pagedataBlob().templglobals&&U.pagedataBlob().templglobals.is_phone);return t||n},bindDownloadBanner:function(){t("body").append(Templ.render(this.template,this.hash())),this.$root=t(this.elemId),n.applyBindings(this,this.$root[0]),e.history.replaceState({},document.title,Url.removeQueryParams(e.location.href,["show_download_banner","is_app_installed","redirect_to_app_url"]))}},t(document).ready((function(){e.FanAppDownloadBanner=new a}))}(window,$,ko),function(e,t,n){"use strict";if("/fan_signup"===e.location.pathname)return;const a=U.pagedataBlob().signup_params||{},i={signup:SignupPane,login:LoginPane,forgot_password:ForgotPasswordPane,reset_password:ResetPasswordPane,existing_artist:ExistingArtistPane,almost_there:AlmostTherePane,action:ActionPane,welcome:WelcomePane,dupe_fan:DupeFanPane,choose_account:ChooseAccountPane,genre_picker:GenrePickerPane,newsletter_picker:NewsletterPickerPane,welcome_2:Welcome2Pane,complete_profile:CompleteProfilePane},o={fans:"fans",corp:"corp",ppp:"signupdwnld",band:"menubar",home:"home",fan:"collection_banner",redeem:"gift_card_redeem",live_ticket:"live_ticket_purchase",gift_cards:"gift_card_purchase"},s=new function(a){const s=this;s._dialog=null,s._element=null,s._pane=null,s.portable=!0,s.isMobile=a.isMobile,s.originPage=null;const r=U.pagedataBlob();Url.toHash(e.location.href).host===Url.toHash(siteroot_https).host?"/fans"===e.location.pathname?s.originPage="fans":"/download"===e.location.pathname?s.originPage="ppp":"/"===e.location.pathname?s.originPage="home":0===e.location.pathname.indexOf("/redeem")?s.originPage="redeem":0===e.location.pathname.indexOf("/gift_cards")?s.originPage="gift_cards":void 0!==r.collection_data?s.originPage="fan":-1!==e.location.href.indexOf(siteroot_https+"/tag/")?s.originPage="tag":s.originPage="corp":0===e.location.pathname.indexOf("/campaign")?s.originPage="crowdfunding":0===e.location.pathname.indexOf("/live")?s.originPage="live":void 0!==r.community?s.originPage="community":s.originPage="band";const l="home"===s.originPage,c="corp"===s.originPage,d="band"===s.originPage,p="fan"===s.originPage,u="redeem"===s.originPage,m="gift_cards"===s.originPage,h="ppp"===s.originPage,f="crowdfunding"===s.originPage,g="tag"===s.originPage,_="community"===s.originPage;s.CROWDFUNDING_RECEIPT_ACTIONS={pledge:"change_pledge",payment:"update_pledge_payment",address:"update_pledge_address"},s.getSignupFrom=function(){if(!s.actionParams||!s.actionParams.action)return s.signupFrom?s.signupFrom:o[s.originPage];{const e=s.actionParams.action,t=s.actionParams.actionItemType;if("wishlist"===e)return"wishlist";if("follow"===e&&"f"===t)return"fan_follow";if("follow"===e&&"g"===t)return"genre_follow";if("follow"===e)return"follow";if("redeem"===e)return"gift_card_redeem";if("live_ticket"===e||"live_invite"===e||"live_attend"===e||"live_attend_immediate"===e)return"live_ticket_purchase";if("live_chat"===e)return"live_chat";if(["gift_cards","gift_cards_verify"].includes(e))return"gift_card_purchase"}},s.openHomepageWelcome=function(){l||(SignupUtils.asyncLogin(s.state.asyncIdentities),s.doAction(),e.location.href=siteroot_https,s.closeDialog())},s.onComplete=function(n){const i=s.state.asyncIdentities,o=s.state.userDataForMenubar,r=s.state.skipWalkthrough||!1,b=s.state.deferWalkthrough||!1;o&&(o.email=s.state.email),e.FanControls&&(e.FanControls._isFan=!0);const v=s.actionParams,y=function(){if(e.FanOnboarding)if(r)e.FanOnboarding.skipWalkthrough();else if(!b){if(void 0===e.FanOnboarding.tooltips||!e.FanOnboarding.tooltips||0===e.FanOnboarding.tooltips.length)return;let n=null,a=null,i=!0;v&&"wishlist"===v.action&&v.title&&e.FanOnboarding.setFirstWishlistedItem(v.title,v.actionItemType),v&&v.action&&("wishlist"===v.action||"follow"===v.action)&&l&&t("body").removeClass("scroll-detected").addClass("prevent-header-hiding"),v&&v.action&&"follow"===v.action&&v.actionItemType,v&&v.action&&"follow"===v.action&&"f"===v.actionItemType&&g&&(a=t(".page.current .follow-fan[data-follow-fan="+v.actionItemId+"]").first(),FanOnboarding.fanName=a.data("fan-name"),n=a.closest(".signup-tooltip-parent"),i=!1),v&&v.action&&"follow"===v.action&&"g"===v.actionItemType&&g&&(a=t("button.following[data-discover-id="+v.actionItemId+"]"),FanOnboarding.tagName=a.data("tag-name"),n=a.closest(".signup-tooltip-parent"),i=!1),v&&v.action&&"follow"===v.action&&"g"===v.actionItemType&&p&&(a=t("button.following[data-discover-id="+v.actionItemId+"]"),FanOnboarding.tagName=a.data("tag-name"),n=a.closest(".signup-tooltip-parent"),i=!1),v&&v.action&&"follow"===v.action&&_&&(a=t(".community-band-info .follow-band:visible"),FanOnboarding.bandName=w.community.band.name,n=a.closest(".signup-tooltip-parent"),i=!1),i&&t("html, body").animate({scrollTop:0},300),setTimeout((function(){e.FanOnboarding.initForView(n)}),300)}};if(!i)return"welcome_2"!==s.currentPane()||s.isMobile||y(),h||SignupUtils.cleanURL(),void s.closeDialog();SignupUtils.asyncLogin(i);const w=U.pagedataBlob()||{},k=w.cfg||{};d||p?SignupUtils.renderMenubar(i,o,v):l||c?k.header_rework_2018?SignupUtils.renderMenubar(i,o,v):SignupUtils.renderHeader(i,o,v):u?(k.header_rework_2018?SignupUtils.renderMenubar(i,o,!1):SignupUtils.renderHeader(i,o,!1),Redeem.rawUserBalance(o.gift_card_balance),Redeem.submit()):m?(k.header_rework_2018?SignupUtils.renderMenubar(i,o,!1):SignupUtils.renderHeader(i,o,!1),GiftCards.loginComplete(s.actionParams)):t("#menubar")[0]?SignupUtils.renderMenubar(i,o,"wishlist"===v.action):t(".hd")[0]&&SignupUtils.renderHeader(i,o,v),a.email=s.state.email,Identities.fan()&&!Identities.fan().verified&&v.action&&"live_ticket"!==v.action&&"live_attend"!==v.action&&"live_attend_immediate"!==v.action&&s._pane instanceof LoginPane&&!m&&!u?(e.verifyNag=e.verifyNag||new VerifyNag({fan_email:a.email}),e.verifyNag.openDialog()):s.doAction(),e.dispatchEvent(new CustomEvent("bc:fanSignupComplete",{detail:{identities:s.state.asyncIdentities,actionParams:s.actionParams}})),s.closeDialog(),h||f||SignupUtils.cleanURL(),n||s.isMobile||y(),(h||f)&&e.location.reload(),BCEvents.publish("fanSignup.complete")},s.closeDialog=function(){s._dialog&&("HomeControl"in e&&HomeControl.feedReader&&HomeControl.feedReader.playPauseFeed(!1),s._dialog.dialog("close"))},s.openDialog=function(n){n=n||"Signup",s._element=t("<div>");let a="phone"===MediaView.mode?"90%":500,i="auto";s.isMobile&&(a=t(e).width()-16,i=t(e).height()-16),s._dialog=NuDialog.alertHTML(n,s._element,{dialogClass:"nu-dialog center-title",draggable:!0,width:a,height:i,modal:!0,title:n,buttons:{},close:function(){t("body").removeClass("prevent-scroll"),s._element.remove(),s._dialog=null,s.currentPane(null),s._pane.resetOnClose&&s.resetState(),Captcha.hideInvisible()},closeOnEscape:!1})},s.state={},s.resetState=function(){s.state={userName:a.user_name||null,bands:a.bands||[],fanUsername:a.suggested_name&&a.suggested_name.length>0?a.suggested_name:null,email:a.email||null,asyncIdentities:null,nextURL:null,nextPane:a.next_pane,userDataForMenubar:null,selectedGenres:[],verificationNeeded:!0,suggestedNewsletters:[],skipWalkthrough:!!a.skip_walkthrough,deferWalkthrough:!1,didLogin:!1,subscribedToBestOf:!1,fromNewsletterInvite:!1,followedGenres:[],alreadyPurchased:!1}},s.resetState(),s.updateState=function(e){t.each(e,(function(e,t){void 0!==s.state[e]&&void 0!==t&&(s.state[e]=t)}))},s.resetInitial=function(){a.user_name=null,a.bands=[],a.email=null},s.additionalBundle=t("#fan-signup-addnl-bundle").data("url"),s.loadAdditionalBundle=function(){!s.additionalBundleLoaded&&s.additionalBundle&&(s.additionalBundlePromise=t.cachedScript(s.additionalBundle),s.additionalBundlePromise.done((function(){Log.debug("loaded signup library on demand"),s.additionalBundleLoaded=!0})))},s.additionalBundleLoaded=!1,s.currentPane=n.observable(),s.openPane=function(o,r){if(s.currentPane(o),"HomeControl"in e&&HomeControl.feedReader&&HomeControl.feedReader.playPauseFeed(!0),i[o]){s._dialog||(s.openDialog(),s.loadAdditionalBundle());const l={};t.extend(l,a,{immediate:r}),s._pane=new i[o](s,l),s._dialog.dialog("option","title",s._pane.title);const c=["nu-dialog","fan-signup-portable"];s._pane.hideTitlebar?c.push("hide-title"):s._pane.title&&""!==s._pane.title?c.push("center-title"):c.push("blank-title"),s._pane.overflowDialog&&c.push("overflow-dialog"),s._pane.transparentBackground&&c.push("transparent-background"),s._pane.noClose&&c.push("no-close");const d="action"!==s.currentPane()&&"welcome_2"!==s.currentPane()&&"welcome"!==s.currentPane();s.isMobile&&d&&c.push("mobile-onboarding"),s._dialog.dialog("option","dialogClass",c.join(" ")),s._pane.width&&"phone"!==MediaView.mode?s._dialog.dialog("option","width",s._pane.width):"phone"!==MediaView.mode&&s._dialog.dialog("option","width",500),s._dialog.dialog("option","minHeight","auto");const p=t.extend(s._pane.hash(),{});s._element.html(Templ.render(s._pane.template,p)),n.applyBindings(s._pane,t("#signup-vm")[0]),s._dialog.dialog("option","height","auto"),"phone"===MediaView.mode?s.isMobile&&"genre_picker"===s.currentPane()?s._dialog.dialog("option","position",{my:"center center",at:"center center",of:e}):s._dialog.dialog("option","position",{my:"top",at:"top+30%"}):s._pane.position?s._dialog.dialog("option","position",s._pane.position):s._dialog.dialog("option","position",{my:"center center",at:"center center",of:e}),s._pane.afterRender(),t(e).height()>t(".fan-signup-portable:visible").height()+30?t("body").addClass("prevent-scroll"):t("body").removeClass("prevent-scroll");const u=t("a.ui-dialog-titlebar-close",s._dialog.siblings(".ui-dialog-titlebar"));u&&!s._pane.noClose&&(u.off("click.manual-close"),u.on("click.manual-close",(function(){t("body").removeClass("prevent-scroll"),t(".top-banner.welcome-non-fan").addClass("hide"),s._pane instanceof SignupPane&&Stats.record({kind:"click",click:"fan_signup_signup_close"}),s.state.skipWalkthrough=!0,s.onComplete(!0),"HomeControl"in e&&HomeControl.feedReader&&HomeControl.feedReader.playPauseFeed(!1),HiddenParams.get("external_follow")&&s._pane instanceof ActionPane&&"follow"===s.actionParams.action&&(!s.actionParams.actionItemType||"b"===s.actionParams.actionItemType)&&Stats.record({kind:"click",click:"artist_dash_external_follow_login_close"}),s._pane.resetOnClose&&s.resetState(),BCEvents.publish("fanSignup.closed")})))}},s.initialEmail=a.email,s.initialEmailSignature=a.email_sig,s.actionParams={action:a.action,actionItemId:a.action_item_id,actionItemType:a.action_item_type,actionBandId:a.action_band_id,actionURL:a.action_url,actionSig:a.action_sig},s.doAction=function(){const t=s.actionParams.action,n=s.actionParams.actionItemType,a=s.actionParams.actionItemId,i=s.actionParams.actionBandId,o=s.actionParams.collectData;if(t)if("live_ticket"===t)s.state.alreadyPurchased&&s.state.nextURL?e.location.href=s.state.nextURL:BCEvents.publish("fanSignup.actionSignup.liveTicket",{packageIndex:s.actionParams.packageIndex,isGift:s.actionParams.isGift});else if("live_attend"===t||"live_attend_immediate"===t)s.state.alreadyPurchased&&s.state.nextURL?e.location.href=s.state.nextURL:BCEvents.publish("fanSignup.actionSignup.liveAttend",{packageIndex:s.actionParams.packageIndex,email:s.state.email});else if("live_invite"===t)BCEvents.publish("fanSignup.actionSignup.liveInvite",{packageIndex:s.actionParams.packageIndex,email:s.state.email});else if("wishlist"===t)FanControls2.wishlist(n,a,i,o);else if("follow"===t){const t=n,r=a;if(t&&"b"!==t)if("f"===t)FanControls2.followFan(r,o);else if("g"===t&&"tag"===s.originPage&&e.hub){const t=e.hub.hubHeader,n=e.hub.tabs.slice(-1)[0].digDeeper.filterSettings,i=a==t.discoverId,o=a==n.discoverId();i&&o?(t.doFollowUnfollow("follow"),n.toggleFollowing()):i?t.doFollowUnfollow("follow"):n.doSpecFollow("follow")}else"g"===t&&"fan"===s.originPage&&FanControls2.followGenre(a);else FanControls2.followBand(i,!0)}},"corp"===s.originPage||"ppp"===s.originPage?s.activationParams={}:s.activationParams={url:a.activation_url,sig:a.activation_sig},s.signupFrom=a.from,s.signupToken=a.signup_token,s.tsig=a.tsig,s.verified=a.verified,a.affiliations&&(s.affiliations=a.affiliations),s.subdomainURL=a.subdomain_url,s.genres=a.genres,s.subgenres=a.subgenres}(a);e.FanSignup=s,t(document).ready((function(){t(".all-signup-link").click((function(){return s.openPane("choose_account",!0),!1})),t(".fan-signup-modal-link").click((function(){const e=t(this).data("from"),n=t(this).data("email"),a=t(this).data("token"),i=t(this).data("tsig"),o=t(this).data("verified");return void 0!==e&&(s.signupFrom=e),void 0!==n&&(s.state.email=n,s.initialEmail=n),void 0!==a&&(s.signupToken=a),void 0!==i&&(s.tsig=i),void 0!==o&&(s.verified=o),s.openPane("signup",!0),!1})),a.pane&&setTimeout((function(){e.FanSignup.openPane(a.pane,!0)}),200)}))}(window,$,ko);const BCAPI=function(){"use strict";return{call2:function(e,t,n){return new Promise((function(a,i){BCAPI.call(e,t,n).done(a).fail((function(e,t){i("network"===e?t:e)}))}))},makeFailureAlert2:function(e){const t=BCAPI.makeFailureAlert(e);return function(e){return Array.isArray(e)?t("network",e):t(e),Promise.reject(e)}},call:function(e,t,n){const a=function(e){const t=e.match(/(.*)(_|\/)([0-9]+)/);if(!t)throw new Error("unparsable api class name: "+e);let n=t[1];const a=t[3];return n=n.replace(/([^A-Z])([A-Z])/g,"$1_$2"),n=n.toLowerCase(),[n,a]}(e),i="/api/"+a[0]+"/"+a[1]+"/"+t;if(n||(n={}),"object"!=typeof n)throw new Error("data must be an object");console.log("calling "+i,n);const o=$.Deferred();let s=0;function r(){const e={},t=Crumb.get(i);t&&(e["X-BC-Crumb"]=t),$.ajax({url:i,data:JSON.stringify(n),contentType:"application/json; charset=UTF-8",dataAs:"JSON",type:"POST",headers:e,success:l,error:c})}function l(e,t,n){if("object"==typeof e&&null!==e&&e.__api_special__){const t=e.error_type;if(Log.warn(e.__api_special__+": ",t),function(e,t){const n=i.substring(1),a=t.getResponseHeader("X-BC-Crumb");if(-1!==e.indexOf("IdentityAccessRules::InvalidCrumbError")&&a&&0===s){console.log("retrying with new crumb",a);const e={};return e[n]=a,Crumb.put(e),s++,r(),!0}return!1}(t,n))return;o.reject(t)}else window.isDebug&&"object"==typeof e&&null!==e&&e.error&&"bad function"===e.error_message?o.reject("network",[n,t,"bad function"]):o.resolve(e)}function c(e,t,n){o.reject("network",[e,t,n])}return r(),o.promise()},makeFailureAlert:function(e){return function(t,n){let a;if("network"===t)NuDialog.showNetworkError.apply(NuDialog,n);else a=e[t]||TM("Unknown error"),NuDialog.alert(TM("Error"),a+" ("+t+")")}}}}(),PublicAPI={call:BCAPI.call2,makeFailureAlert:BCAPI.makeFailureAlert2,failureAlert(e,t){"use strict";this.makeFailureAlert(t)(e)}};window.PublicAPI=PublicAPI,function(e){"use strict";const t={record:function(e){const t={event_type:e};fetch("/api/usereventstats/1/record",{method:"POST",body:JSON.stringify(t),headers:[["Content-Type","application/json"]]}).then((e=>e.json())).then((e=>{e.error&&Log.debug("error submitting user event stat")})).catch((()=>{Log.debug("error submitting user event stat")}))}};e.UserEventStats=t}(window),function(){"use strict";$(".banner-close-link").click((function(e){const t=$(this).closest(".banner, .top-banner").hide()[0].id;return $.ajax({url:"/banner_cb?d="+encodeURIComponent(t),type:"GET",dataType:"json"}),BCEvents.publish("bannerDismissed."+t),!1}))}();
