/* LegacyMode */
(()=>{var pt=Object.defineProperty,ee=Object.defineProperties,re=Object.getOwnPropertyDescriptor,ne=Object.getOwnPropertyDescriptors;var Rt=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var dt=(n,t,e)=>t in n?pt(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,rt=(n,t)=>{for(var e in t||(t={}))oe.call(t,e)&&dt(n,e,t[e]);if(Rt)for(var e of Rt(t))ie.call(t,e)&&dt(n,e,t[e]);return n},nt=(n,t)=>ee(n,ne(t)),i=(n,t)=>pt(n,"name",{value:t,configurable:!0});var d=(n,t,e,r)=>{for(var o=r>1?void 0:r?re(t,e):t,s=n.length-1,a;s>=0;s--)(a=n[s])&&(o=(r?a(t,e,o):a(o))||o);return r&&o&&pt(t,e,o),o};var u=(n,t,e)=>(dt(n,typeof t!="symbol"?t+"":t,e),e);var T=(n,t,e)=>new Promise((r,o)=>{var s=l=>{try{g(e.next(l))}catch(m){o(m)}},a=l=>{try{g(e.throw(l))}catch(m){o(m)}},g=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,a);g((e=e.apply(n,t)).next())});var c={modules:["SignalsIds","SignalsBsc","SignalsVlp","SignalsTvp","SignalsAbs","LegacyLayer","SignalsAutoInsertion","GptMeasurement","TimeConfig","PrisaConfig"],configs:{RFYxMTQ4MjYx:[0,1,2,3,4,5,6],RFYxMDcxNDY3:[0,1,2,3,4,5,6],"RFY5NzI5MzU=":[6],"RFYzNzU5MzU=":[0,1,2,5,6],"RFY2NzUwMzg=":[0,1,2,3,5,6],"RFY5NDA4NDg=":[0,1,2,3,5,6],"RFY0NjQwMjE=":[0,1,2,3,4,5,6],RFYxMTUzNjQ1:[0,1,5,6],"RFY3NTk1MjA=":[0,1,2,3,5,6,7,8],"RFY2NjkzNjE=":[0,1,2,3,5,6],RFYxMDAxNjU0:[0,1,2,3,4,5,6],RFYxMDI2NTMx:[0,1,2,3,5,6],RFYxMTYzNTAw:[0,1,2,3,4,5,6],RFYxMDcwMjkx:[0,1,2,3,4,5,6],RFYxMTA2NzY0:[0,1,2,3,4,5,6],RFYxMTA4MDIy:[0,1,5,6],RFYxMTIyMjY4:[0,1,5,6],RFYxMTQ1NzI5:[0,1,5,6],"RFY3Nzc1NzY=":[0,1,2,3,5,6],"RFY5NzQ3MzA=":[0,1,2,3,5],RFYxMTA2NjUz:[0,1,2,3,4,5,6],RFYxMDQ0MzMw:[0,1,2,3,4,5,6,7,9],"RFY4MDU2MDE=":[0,2,3,5],"RFY0MjQ5NDA=":[0,1,2,4,5,6],"RFYxMTExMTE=":[0,1,2,3,5,6],"RFY4MDkxOTk=":[0,1,2,3,5,6],"RFY3NDg3MjI=":[0,1,5,6],RFYxMDgzNzg4:[0,1,2,3,5,6],"RFY0NjUxNTc=":[0,1,2,5,6],"RFY4MzIzNDY=":[0,1,5,6],"RFY3MzQzNDI=":[0,1,2,3,4,5,6],RFYxMTA2MDA5:[0,1,2,3,4,5,6],"RFY4MjE5MTg=":[0,1,2,3,5,6],"RFY5NDMzOTk=":[0,1,2,3,4,5,6],RFYxMTA4MTY0:[0,1,2,3,4,5,6],"RFYzNzQxNTg=":[0,1,2,5,6],"RFY5Nzg2NjI=":[6],"RFY5ODk2NzI=":[4,5,6],"RFY0NjQwNDE=":[0,1,2,4,5,6],RFYxMDg1MzM3:[0,1,2,4,5],RFYxMDEwNzI4:[],RFYxMTQwNjg5:[6],RFYxMDgwMjEy:[4,5,6],"RFY1ODc0MTQ=":[0,1,2,3,4,5,6],RFYxMTQ3ODUx:[0,1,2,3,5,6],RFYxMTM2MTU2:[0,1,5,6],"RFY2NTE3NDQ=":[0,1,2,3,4,5,6],RFYxMDEyNjAw:[0,1,2,3,4,5,6],"RFY3MTg2ODU=":[0,5],RFYxMDUzMDUz:[0,1,2,4,5],RFYxMDExNDU1:[0,1,2,3,4,5,6],"RFY4OTMwNTY=":[0,1,2,3,5],RFYxMDIzOTQ1:[4,5,6],RFYxMDE2NjU2:[0,1,2,3,4,5,6],"RFY3NTc3MzA=":[0,1,2,3,5,6],"RFY4NjYwMjU=":[0,1,2,3,5,6],"RFY3OTc2ODY=":[0,1,2,3,5,6],"RFYzMTIwNDg=":[0,1,2,5,6],"RFY4NjQ3ODc=":[4,5,6],"RFY2NzI1MjE=":[0,1,2,3,5,6],"RFY2ODQzNDg=":[0,1,2,3,4,5,6],RFYxMTEwOTk0:[0,1,2,3,4,5,6],RFYxMTU3NzY0:[0,1,2,3,5,6],"RFY0NjQwMzM=":[0,1,2,5,6],"MTc0OTI1Mjg=":[0,1,2,5,6],"RFY5NzQ3MzE=":[0,1,2,3,5],RFYxMTA5Mzky:[0,1,2,3,4,5,6],RFYxMTMwNzQ4:[0,1,5,6],"RFY5NDU5ODg=":[0,1,2,3,4,5,6],"RFY2NzM2NzI=":[0,1,2,3,4,5,6],"RFY3MTA4Nzg=":[0,1,2,3,5,6],"RFY5NDIxOTY=":[0,1,2,3,4,5,6],RFYxMDM2Nzc2:[0,1,4,5],"RFY4MzIzNTM=":[0,1,5,6],"RFY2NDcwODg=":[0,1,2,3,5,6],"RFY4NDQ0Njg=":[0,1,2,3,5,6],"RFY3OTI4NTU=":[0,2,5,6],"RFY4NDY4Mjc=":[4,5,6],"RFY3Nzc4ODU=":[0,1,2,3,5,6],RFYxMDU4Nzk0:[0,1,2,3,5,6],RFYxMTYyMjEy:[0,1,5,6],"RFY4OTY3MTQ=":[0,1,2,3,4,5,6],RFYxMTYxMjU5:[4,5],"RFY5MDI5MjM=":[0,1,2,3,5,6],"RFY5MTA2Mzg=":[0,1,5],"RFY5NzQ3MzI=":[],RFYxMTQ5Mzg3:[0,1,5,6]}};var mt={queueAdRequest:n=>{var t;try{(t=n.callback)==null||t.call(n),n.callback=null}catch(e){}},defineSlot:(n,t)=>{},getTargeting:n=>({})};var Y=class{constructor(t,e){u(this,"window");u(this,"dvtag");u(this,"modules",new Map);u(this,"errorHandlers",[]);var r;this.window=e,this.window.dvtag=(r=this.window.dvtag)!=null?r:{},this.dvtag=this.window.dvtag,this.dvtag._core=this;for(let[o,s]of Object.entries(mt))this.dvtag[o]=s;for(let o of t)this.createModule(o);for(let o of this.modules.values())this.applyModuleDecoration(o);for(let o of this.modules.values())this.applyErrorDecoration(o);for(let o of this.modules.values())this.applyPluginDecoration(o);for(let o of this.modules.values())this.applyApiDecoration(o);for(let o of this.modules.values())this.applyExecuteDecoration(o)}get(t){return this.getModule(t).gateway}getByName(t){let e=[...this.modules.keys()].find(r=>r.name===t);return e!=null?this.get(e):null}getModule(t){let e=this.modules.get(t);if(e==null)throw new Error(`module not in core: ${t.name}`);return e}createModule(t){if(t.prototype.moduleConfig==null)throw new Error(`not a module: ${t.name}`);let e=new t;e.core=this,e.gateway={module:e},this.modules.set(t,e)}applyModuleDecoration(t){var o,s,a,g,l,m;let e=t.constructor.prototype.moduleConfig,r=t.constructor.name;for(let{method:p}of e){let h=t[p].bind(t),y=(a=(s=(o=this.dvtag._hooks)==null?void 0:o.interceptModule)==null?void 0:s[r])==null?void 0:a[p],S=y==null?h:y.bind(t),E=(m=(l=(g=this.dvtag._hooks)==null?void 0:g.inspectModule)==null?void 0:l[r])==null?void 0:m[p],U=E==null?S:(...w)=>{let I=S(...w);return E(w,I),I},V=i((...w)=>{try{return U(...w)}catch(I){throw this.traceMethodError(t,p,w,I)}},"traced");t.gateway[p]=V}if(t.plugins!=null){t.pluginFunctions={};for(let p of Object.keys(t.plugins)){t.pluginFunctions[p]=[];let h=t.pluginFunctions[p];t.plugins[p]=(...y)=>{let S=[];for(let E of h)try{S.push(E(...y))}catch(U){this.tracePluginError(t,p,U)}return S}}}}traceMethodError(t,e,r,o){var s;return o.dvtagTrace=(s=o.dvtagTrace)!=null?s:[],o.dvtagTrace.unshift(`${t.constructor.name}.${e}(${r.map(a=>typeof a).join(",")})`),o}traceExecuteError(t){var e;return t.dvtagTrace=(e=t.dvtagTrace)!=null?e:[],t.dvtagTrace.unshift("@execute"),this.handleSevereError(t),t}tracePluginError(t,e,r){var o;return r.dvtagTrace=(o=r.dvtagTrace)!=null?o:[],r.dvtagTrace.unshift(`@plugin(${t.constructor.name}, '${e}')`),this.handleSevereError(r),r}traceApiError(t,e){var r;return e.dvtagTrace=(r=e.dvtagTrace)!=null?r:[],e.dvtagTrace.unshift(`@api('${t}')`),this.handleSevereError(e),e}handleSevereError(t){for(let e of this.errorHandlers)try{e(t)}catch(r){}}applyErrorDecoration(t){var r;let e=(r=t.constructor.prototype.errorConfig)!=null?r:[];for(let{method:o}of e)this.errorHandlers.push(t.gateway[o])}applyPluginDecoration(t){var r;let e=(r=t.constructor.prototype.pluginConfig)!=null?r:[];for(let{PluggableClass:o,category:s,method:a}of e)this.getModule(o).pluginFunctions[s].push(t.gateway[a])}applyApiDecoration(t){var r;let e=(r=t.constructor.prototype.apiConfig)!=null?r:[];for(let{api:o,method:s}of e)Object.defineProperty(this.dvtag,o,{value:(...a)=>{var g,l;try{return t.gateway[s](...a)}catch(m){return this.traceApiError(o,m),(l=(g=mt)[o])==null?void 0:l.call(g,...a)}},writable:!1})}applyExecuteDecoration(t){var r;let e=(r=t.constructor.prototype.executeConfig)!=null?r:[];for(let{method:o}of e)try{t.gateway[o]()}catch(s){this.traceExecuteError(s)}}};i(Y,"Core");var ft=[],ht=ft;var f=i(n=>{let t=n.prototype,e=Object.getOwnPropertyNames(t).filter(r=>{var o;return r!=="constructor"&&((o=Object.getOwnPropertyDescriptor(t,r))==null?void 0:o.value)instanceof Function});t.moduleConfig=e.map(r=>({method:r})),ft.push(n)},"moduleClass"),ot=i(n=>t=>{},"attachModule"),C=i((n,t)=>{var e;n.executeConfig=(e=n.executeConfig)!=null?e:[],n.executeConfig.push({method:t})},"executeMethod"),St=i((n,t)=>(e,r)=>{var o;e.pluginConfig=(o=e.pluginConfig)!=null?o:[],e.pluginConfig.push({PluggableClass:n,category:t,method:r})},"pluginMethod"),B=i(n=>(t,e)=>{var r;t.apiConfig=(r=t.apiConfig)!=null?r:[],t.apiConfig.push({api:n,method:e})},"apiMethod");var gt,ae=new Uint8Array(16);function Tt(){if(!gt&&(gt=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!gt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return gt(ae)}i(Tt,"rng");var v=[];for(let n=0;n<256;++n)v.push((n+256).toString(16).slice(1));function It(n,t=0){return(v[n[t+0]]+v[n[t+1]]+v[n[t+2]]+v[n[t+3]]+"-"+v[n[t+4]]+v[n[t+5]]+"-"+v[n[t+6]]+v[n[t+7]]+"-"+v[n[t+8]]+v[n[t+9]]+"-"+v[n[t+10]]+v[n[t+11]]+v[n[t+12]]+v[n[t+13]]+v[n[t+14]]+v[n[t+15]]).toLowerCase()}i(It,"unsafeStringify");var ge=typeof crypto!="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),yt={randomUUID:ge};function ce(n,t,e){if(yt.randomUUID&&!t&&!n)return yt.randomUUID();n=n||{};let r=n.random||(n.rng||Tt)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){e=e||0;for(let o=0;o<16;++o)t[e+o]=r[o];return t}return It(r)}i(ce,"v4");var vt=ce;var D=i(()=>vt(),"uuid");var ct=["BSC","ABS"],Dt=["IDS"],X=["VLP","TVP"],Q=[...ct,...Dt,...X],_t=i(n=>Q.includes(n.toUpperCase()),"isSignal"),lt=i(n=>X.includes(n.toUpperCase()),"isSlotSignal"),Ct=i(n=>Dt.includes(n.toUpperCase()),"isUserSignal"),xt=i(n=>ct.includes(n.toUpperCase()),"isPageSignal"),bt=i(n=>n.map(t=>t.toUpperCase()).filter(_t),"asSignals");var x=class{constructor(){u(this,"pq",null)}getPq(){return this.pq==null&&(this.pq=this._initialize()),this.pq}getPts(){return this.getPq().PTS}setApi(t){let e=this.getPq();e!=null&&(e.init=()=>{},e.loadSignals=t.loadSignals,e.loadSignalsForSlots=t.loadSignalsForSlots,e.getTargeting=t.getTargeting)}_pushToDvtagCmd(...t){var e;this.core.dvtag.cmd=(e=this.core.dvtag.cmd)!=null?e:[],this.core.dvtag.cmd.push(...t)}_initialize(){var r,o;this.core.window.PQ=(r=this.core.window.PQ)!=null?r:{};let t=this.core.window.PQ;if(t.loaded)return{cmd:[],PTS:{}};t.loaded=!0,t.PTS=(o=t.PTS)!=null?o:{};let e=t.cmd;return t.cmd={push:s=>this._pushToDvtagCmd(s)},Array.isArray(e)&&this._pushToDvtagCmd(...e),t}};i(x,"LegacyPq"),x=d([f],x);var le=[[/((\?)|&)(?:amp_lite|fr=operanews)/g,"$2"],[/(^https?:\/\/)(www\.)/g,"$1"],[/(((\?)|&|%3F|%26|;)(?:utm_campaign|utm_source|utm_content|utm_term|utm_viral|utm_medium|utm_identifier|utm_key|fb_source|referrer|referer|ref|rand|rnd|randid|\.?rand|\.?partner|cb|count|adid|session|sessionid|session_redirect|param\d|userinfo|uid|refresh|ocid|ncid|clickenc|fbclid|amp_js_v|amp_gsa|ns_source|ns_campaign|ns_mchanel|ns_mchannel|ns_linkname|ns_fee|src|ex_cid|usqp|source|xid|trkid|utm_social-type|mbid|utm_brand|__twitter_impression|utm_referrer|CMP|cmp|_cmp|cq_cmp)=[^&]*)/g,"$3"],[/[/.]amp(?:\/[?&]*)?$/g,""],[/((\?)|&)(?:outputType|isFollow|suppressMediaBar|cid|ICID|icid|bdk|wtu_id_h|utm_placement|intcmp|_native_ads|traffic_source|entry|\.tsrc|autoplay|autostart|dc_data|influencer|pubdate|utm_hp_ref|redirect|service|refresh_ce|refresh_cens|xcmg|target_id|_amp)=[^&]*/g,"$2"],[/(\?|&)(?:amp)(?:&|$|=[^&]*)/g,"$1"]],ue=[[/(?:\/|\/\?|\?|&|\/\$0|#[\s\S]*)+$/g,""],[/(?:\/|\/\?|\?|&|\/\$0|#[\s\S]*)+$/g,""]],kt=i((n,t)=>{for(let[e,r]of n)t=t.replace(e,r);return t},"replaceByRules"),Mt=i(n=>{let t=kt(le,n);return kt(ue,t)},"normalizeUrl");var Lt=i(n=>n.split("?",1)[0].split("#",1)[0],"stripUrlQuery");var Pt=i((n,t)=>{try{let e=new URLSearchParams(n),r=e.get("ctx"),o=e.get("cmp");if(r!=null&&o!=null)return{ctx:r,cmp:o,prefetch:t}}catch(e){}return null},"parseInfo"),Ot=i(n=>{var t;return n.pathname!=="/signals/pub.js"?null:(t=Pt(n.search,!0))!=null?t:Pt(n.hash.substring(1),!1)},"parseLegacyPagetagUrl");var de=/^\/dvtag\/([^/]+)\/([^/]+)\/pub\.js$/,b=class{constructor(){u(this,"visitUuid",D());u(this,"tagInfo");u(this,"normalizedUrl")}_initialize(){this.getTagInfo()}getTagInfo(){var t;if(this.tagInfo==null){try{this.tagInfo=this._parseTagInfo()}catch(e){}(t=this.tagInfo)!=null||(this.tagInfo={ctx:"unknown",cmp:"unknown"})}return this.tagInfo}getVisitUuid(){return this.visitUuid}_parseTagInfo(){let t=this.getCurrentScriptSrc();if(t==null)return null;let e=new URL(t,"https://pub.doubleverify.com"),r=e.pathname,o=de.exec(r);if(o!=null){let[,s,a]=o;return{ctx:s,cmp:a}}return Ot(e)}getCurrentScriptSrc(){var t,e;return(e=(t=this.core.window.document.currentScript)==null?void 0:t.getAttribute("src"))!=null?e:null}getStrippedPageUrl(){return Lt(this.core.window.location.href)}getNormalizedPageUrl(){var e;let t=this.getStrippedPageUrl();return((e=this.normalizedUrl)==null?void 0:e.stripped)!==t&&(this.normalizedUrl={stripped:t,normalized:Mt(this.core.window.location.href)}),this.normalizedUrl.normalized}};i(b,"Context"),d([C],b.prototype,"_initialize",1),b=d([f],b);var k=class{getShortCommitId(){return"9dbea0d"}getBuildTimestamp(){return 1698040812699}getAuthToken(){return typeof AUTH_TOKEN=="undefined"?"default":AUTH_TOKEN}};i(k,"DefinedVariables"),k=d([f],k);var A=class{getWindow(){return this.core.window}getDocument(){return this.getWindow().document}getUserAgent(){var t,e;return(e=(t=this.getWindow().navigator)==null?void 0:t.userAgent)!=null?e:""}getPageUrl(){var t,e;return(e=(t=this.getWindow().location)==null?void 0:t.href)!=null?e:""}getHostname(){return new URL(this.getPageUrl()).hostname}getNavigator(){return this.getWindow().navigator}getPerformance(){var t;return(t=this.getWindow().performance)!=null?t:{}}getPerformanceTimeMs(){var t,e,r;return Math.floor((r=(e=(t=this.getPerformance()).now)==null?void 0:e.call(t))!=null?r:null)}};i(A,"Environment"),A=d([f],A);var Gt=i(n=>n==null?"":`@${n}`,"getPositionSuffix");var pe=/^(\d+)x(\d+)$/,Nt=i(n=>n==="all"?[]:n.split(",").map(t=>{let e=t.match(pe);return e==null?{label:t}:{width:parseInt(e[1],10),height:parseInt(e[2],10)}}),"stringToSlotSizes"),it=i(n=>n.length===0?"all":n.map(({width:t,height:e,label:r})=>r!=null?r:`${t}x${e}`).join(","),"slotSizesToString"),zt=i(n=>n==null?"":n.length>0&&n.every(({label:r})=>r==null)?it(n):"","slotSizesToStringIfSpecific");var Et="https://pub.doubleverify.com/dvtag/signals/",M=class{_getBaseUrl(t,e){let r=this.core.get(b),{ctx:o,cmp:s}=r.getTagInfo(),a=r.getNormalizedPageUrl();if(e!==!0)try{a=new URL(a).origin}catch(l){}let g=new URL(t,Et);return g.searchParams.set("ctx",o),g.searchParams.set("cmp",s),g.searchParams.set("url",a),g}getUserTargetingUrl(t){let e=this._getBaseUrl("ids/pub.json");return t.includes("IDS")&&e.searchParams.set("ids","1"),e.href}getPageTargetingUrl(t){let e=this._getBaseUrl("bsc/pub.json",!0);return t.includes("BSC")&&e.searchParams.set("bsc","1"),t.includes("ABS")&&e.searchParams.set("abs","1"),e.href}getSlotTargetingUrl(t,e){var s;let r=this._getBaseUrl("vlp/pub.json");t.includes("VLP")&&r.searchParams.set("vlp","1"),t.includes("TVP")&&r.searchParams.set("tvp","1");let o=0;for(let a of e){let{id:g,position:l,sizes:m}=(s=a.adUnit)!=null?s:{},p=g+Gt(l);r.searchParams.set(`slot-${o++}-${p}`,zt(m))}return r.href}};i(M,"SignalsUrlBuilder"),M=d([f],M);var jt="https://vtrk.doubleverify.com";var qt=i(()=>Math.floor(1e12*Math.random()),"randomInt");var Z="qt_loaded",Ft="pts_pid",Vt="pts_sid",K=class extends Error{constructor(e,r){super(r);this.code=e}};i(K,"QtError");var Bt=i((n,t)=>{var r,o;let e={};for(let[s,a]of t.entries()){let g=n[s];if(g!=null)for(let l of X){let m=g[l];m==null||m.length<1||((o=e[r=a.uuid])!=null||(e[r]={}),e[a.uuid][l]=m[0])}}return e},"formatSlotTargetingForTracking");var Qt=i(({transferSize:n,decodedBodySize:t})=>n>0?"network":t>0?"cache":"unknown","getCacheStatus");var Ut=i((n,t)=>n.reduce((e,r)=>{var s,a,g;let o=Number.parseInt((g=(a=(s=r[t])==null?void 0:s[0])==null?void 0:a.split)==null?void 0:g.call(a,"-")[0],10);return Number.isNaN(o)||(e+=o),e},0),"summarizeSlotTargeting");var N=i((n,t)=>n!=null&&t!=null?Math.round(t-n):void 0,"timeSpan");var st=class{constructor(t,e,r,o,s,a,g,l,m,p,h,y=1e3){u(this,"data");u(this,"start");u(this,"flushed",!1);u(this,"getPerformanceTimeMs");u(this,"sendPixel");u(this,"disabled");this.getPerformanceTimeMs=m,this.sendPixel=p,this.disabled=h,this.start=this.getPerformanceTimeMs(),this.data={["t"]:"event",["ec"]:"page",["ea"]:"unknown",["v"]:"1",["ctx"]:r,["cmp"]:o,["cid"]:e,["z"]:qt(),["cd105"]:g,["cd160"]:D(),["cd161"]:a,["cd50"]:"upt",["cd51"]:t,["cd180"]:"no-fetches"},s&&(this.data["cd55"]="1"),l!=null&&(this.data["cd52"]=l),setTimeout(()=>this.fireEvent(),y)}setEventAction(t){this.addData({["ea"]:t})}addRequestedSignals(t){let e=i(r=>r?"1":void 0,"toString");this.addData({["cm56"]:e(t.includes("IDS")),["cm57"]:e(t.includes("BSC")),["cm58"]:e(t.includes("ABS")),["cm59"]:e(t.includes("VLP")),["cm60"]:e(t.includes("TVP"))})}setAutoInsertionEnabled(){this.addData({["cd68"]:"1"})}addResultsData(t,e,r,o){t["IDS"]!=null&&this.addData({["cm170"]:t["IDS"][0],["cm61"]:t["IDS"][0]}),e["BSC"]!=null&&this.addData({["cd171"]:e["BSC"].join(","),["cm62"]:e["BSC"].length}),e["ABS"]!=null&&this.addData({["cm63"]:e["ABS"].length}),r.length!==0&&(this.addData({["cd175"]:JSON.stringify(Bt(r,o))}),r[0]["VLP"]!=null&&this.addData({["cm66"]:r.length,["cm64"]:Ut(r,"VLP")}),r[0]["TVP"]!=null&&this.addData({["cm67"]:r.length,["cm65"]:Ut(r,"TVP")}))}setRequestSuccess(){let t=this.getPerformanceTimeMs(),e;this.start!=null&&t!=null&&(e=Math.round(t-this.start)),this.addData({["cd53"]:"1",["cm54"]:e})}addFetchPerformanceData(t,e,r,o){var m,p;if(t==null){this.data["cd180"]==="no-fetches"&&(this.data["cd180"]=(o==null?void 0:o.getEntriesByName)==null?"no-api":"no-entry");return}r==="ids"&&this.addData({["cm187"]:Math.round(t.duration)}),r==="bsc"&&this.addData({["cm188"]:Math.round(t.duration)}),r==="vlp"&&this.addData({["cm189"]:Math.round(t.duration)});let s=this.getPerformanceTimeMs(),a=N(t.fetchStart,s),g=this.data["cm186"];if(a==null||g>a)return;let l=(m=t.secureConnectionStart)!=null?m:t.connectEnd;this.addData({["cd180"]:Qt(t),["cm180"]:N(t.fetchStart,t.responseEnd),["cm181"]:N(t.domainLookupStart,t.domainLookupEnd),["cm182"]:N(t.connectStart,l),["cm183"]:N(l,t.connectEnd),["cm184"]:N(t.requestStart,t.responseStart),["cm185"]:N(t.responseStart,t.responseEnd),["cm186"]:a,["cd191"]:(p=e==null?void 0:e.split("-"))==null?void 0:p[0]})}trackError(t){var e;this.addData({["ea"]:"error",["cd110"]:(e=t==null?void 0:t.message)!=null?e:"unknown error",["cd111"]:t instanceof K?t.code:void 0}),this.fireEvent()}addData(t){Object.assign(this.data,t)}fireEvent(){let t=Object.keys(this.data).filter(r=>this.data[r]!=null).map(r=>`${r}=${encodeURIComponent(this.data[r])}`),e=`${jt}?${t.join("&")}`;return!this.flushed&&!this.disabled&&this.sendPixel(e),this.flushed=!0,e}};i(st,"PendingEvent");var me=5,fe=["ids","bsc","vlp"],R=class{constructor(){u(this,"plugins",{getLegacyType:()=>[],isTrackingDisabled:()=>[]});u(this,"eventCount",0)}_trackInitialLoad(){var o;let{prefetch:t}=this.core.get(b).getTagInfo(),e=this.createPendingEvent(void 0,!1);e.setEventAction(t?"load-pq-signals":"load-pq");let r=this.core.get(b).getCurrentScriptSrc();if(r!=null){let s=this.core.get(A).getPerformance(),a=(o=s.getEntriesByType)==null?void 0:o.call(s,"resource").find(g=>g.name===r);e.addFetchPerformanceData(a,null,"tag",s)}e.fireEvent()}createPendingEvent(t,e=!0){var w;let r=this.core.get(k),o=this.core.get(b),s=this.core.get(A),a=(w=this.plugins.getLegacyType()[0])!=null?w:"unknown",g=r.getShortCommitId(),l=o.getVisitUuid(),m=o.getNormalizedPageUrl(),{ctx:p,cmp:h,prefetch:y}=o.getTagInfo(),S=s.getNavigator(),E=i(()=>s.getPerformanceTimeMs(),"getPerformanceTimeMs"),U=i(I=>{try{typeof(S==null?void 0:S.sendBeacon)=="function"?S.sendBeacon(I):new Image().src=I}catch(_){}},"sendPixel"),V=this.eventCount>=me||this.plugins.isTrackingDisabled().length>0;return e&&this.eventCount++,new st(g,l,p,h,y,m,a,t,E,U,V)}findPerformanceEntries(){var e,r;let t=this.core.get(A).getPerformance();return(r=(e=t.getEntriesByType)==null?void 0:e.call(t,"resource").filter(o=>o.name.startsWith(Et)).map(o=>{var a;return{type:(a=fe.find(g=>o.name.includes(g)))!=null?a:"unknown",entry:o,performance:t}}))!=null?r:[]}};i(R,"LegacyTracking"),d([C],R.prototype,"_trackInitialLoad",1),R=d([f],R);var tt=i(n=>{if(n==null)return[];let t=Kt(n);return t!=null?[t]:Array.isArray(n)?n.map(Kt).filter(e=>e!=null):[]},"parseSlotSizes"),Kt=i(n=>{if(n==null)return null;if(typeof n=="string")return{label:n};if(Array.isArray(n)){if(n.length===1&&typeof n[0]=="string")return{label:n[0]};if(n.length===2&&typeof n[0]=="number"&&typeof n[1]=="number")return{width:n[0],height:n[1]}}if(typeof n=="object"){let{label:t,width:e,height:r}=n;if(typeof e=="number"&&typeof r=="number")return{width:e,height:r};if(typeof t=="string")return{label:t}}return null},"parseSlotSize");var $t=i(n=>{var r,o,s;let t=D(),e={id:(o=(r=n.adUnitPath)!=null?r:n.invCode)!=null?o:n.tagId,sizes:tt(Nt((s=n.sizes)!=null?s:"all")),position:n.position};return{elementId:t,adUnit:e}},"parseLegacyAdUnit");var Wt=i(n=>{try{return n.getSizes()}catch(t){return[]}},"getGptSlotSize");var Ht=i(n=>({elementId:n.getSlotElementId(),adUnit:{id:n.getAdUnitPath(),sizes:tt(Wt(n)),position:n.getTargeting("dvp_spos")[0]}}),"parseLegacyGptSlot");var Jt=i((n,t)=>(t==null?void 0:t.structuredClone)!=null?t.structuredClone(n):JSON.parse(JSON.stringify(n)),"deepClone");var Yt=i((n,t)=>{var o;let e=(o=n["IDS"])==null?void 0:o[0];if(e==null)return;let r=parseInt(e);isNaN(r)||(t["IDS"]=r)},"setUserTargetingOnPts"),Xt=i((n,t)=>{for(let e of ct)n[e]!=null&&(t[e]=n[e])},"setPageTargetingOnPts"),Zt=i((n,t,e)=>{var g,l,m,p,h,y;let{adUnit:r}=n;if((r==null?void 0:r.id)==null)return;let o=r.id,s=it((g=r.sizes)!=null?g:[]),a=r.position;for(let S of X){let E=t[S];E!=null&&((l=e[S])!=null||(e[S]={}),(p=(m=e[S])[o])!=null||(m[o]={}),e[S][o][s]=E[0],a!=null&&((y=(h=e[S][o])[a])!=null||(h[a]={}),e[S][o][a][s]=E[0]))}},"setSlotTargetingOnPts");var wt=i(n=>[...new Set(n.filter(_t).map(t=>t.toLowerCase()))],"getGreenlightSignal");var $=class{autoInsertPageId(){let e=this.core.get(b).getVisitUuid();this._onPubadsReady(r=>{r.setTargeting(Ft,e)})}autoInsertGlobalTargeting(t){this._onPubadsReady(e=>{for(let[r,o]of Object.entries(t))e.setTargeting(r,o);e.setTargeting(Z,wt([...e.getTargeting(Z),...Object.keys(t)]))})}autoInsertSlotId(t){this._onPubadsReady(e=>{let r=e.getSlots().find(o=>o.getSlotElementId()===t.elementId);r!=null&&r.setTargeting(Vt,t.uuid)})}autoInsertSlotTargeting(t,e){this._onPubadsReady(r=>{let o=r.getSlots().find(s=>s.getSlotElementId()===t.elementId);if(o!=null){for(let[s,a]of Object.entries(e))o.setTargeting(s,a);o.setTargeting(Z,wt([...r.getTargeting(Z),...o.getTargeting(Z),...Object.keys(e)]))}})}_onPubadsReady(t){var r,o;let e=this.core.window;e.googletag=(r=e.googletag)!=null?r:{},e.googletag.cmd=(o=e.googletag.cmd)!=null?o:[],e.googletag.cmd.push(()=>{t(e.googletag.pubads())})}};i($,"LegacyModeAutoInsertion"),$=d([f],$);var L=class{constructor(){u(this,"cache",{})}_performFetchJson(t,e){return T(this,null,function*(){let r=t;if(e!=null&&e.authToken){let a=this.core.get(k).getAuthToken(),g=new URL(t);g.searchParams.set("token",a),r=g.href}let o=yield this.core.window.fetch(r);return{json:yield o.json(),headers:o.headers}})}fetchJson(t,e){return T(this,null,function*(){let r=this.cache[t];return r==null&&(r=this._performFetchJson(t,e).then(o=>o.json),this.cache[t]=r),r})}fetchJsonWithHeaders(t,e){return T(this,null,function*(){let r=this.cache[t];if(r!=null)return{data:yield r};let o=this._performFetchJson(t,e);this.cache[t]=o.then(g=>g.json);let{json:s,headers:a}=yield o;return{data:s,headers:a}})}};i(L,"Fetch"),L=d([f],L);var he="cf-ray",W=class{_reportPerformance(t,e,r,o){try{let s=this.core.get(A).getPerformance(),a=s.getEntriesByType("resource").find(g=>g.name.startsWith(t)&&g.name.slice(t.length+1).startsWith("token="));o.addFetchPerformanceData(a,e==null?void 0:e.get(he),r,s)}catch(s){}}_getUserTargeting(t,e){return T(this,null,function*(){if(!t.some(Ct))return{};let r=this.core.get(M).getUserTargetingUrl(t);try{let{data:o,headers:s}=yield this.core.get(L).fetchJsonWithHeaders(r,{authToken:!0});return this._reportPerformance(r,s,"ids",e),o}catch(o){return e.trackError(o),{}}})}_getPageTargeting(t,e){return T(this,null,function*(){if(!t.some(xt))return{};let r=this.core.get(M).getPageTargetingUrl(t);try{let{data:o,headers:s}=yield this.core.get(L).fetchJsonWithHeaders(r,{authToken:!0});return this._reportPerformance(r,s,"bsc",e),o}catch(o){return e.trackError(o),{}}})}_getSlotTargeting(t,e,r){return T(this,null,function*(){if(!t.some(lt)||e.length===0)return new Array(e.length).fill({});let o=this.core.get(M).getSlotTargetingUrl(t,e);try{let{data:s,headers:a}=yield this.core.get(L).fetchJsonWithHeaders(o,{authToken:!0});return this._reportPerformance(o,a,"vlp",r),s.length!==e.length?new Array(e.length).fill({}):s.map(g=>Object.fromEntries(Object.entries(g).map(([l,m])=>[l,[m[0]]])))}catch(s){return r.trackError(s),new Array(e.length).fill({})}})}getTargeting(t,e,r){return T(this,null,function*(){let[o,s,a]=yield Promise.all([this._getUserTargeting(t,r),this._getPageTargeting(t,r),this._getSlotTargeting(t,e,r)]);return{userTargeting:o,pageTargeting:s,slotTargeting:a}})}};i(W,"LegacyModeFetchTargeting"),W=d([f],W);var Se={SignalsIds:"IDS",SignalsBsc:"BSC",SignalsAbs:"ABS",SignalsVlp:"VLP",SignalsTvp:"TVP"},Te="SignalsAutoInsertion",P=class{constructor(){u(this,"validConfigFound");u(this,"enabledSignals");u(this,"autoInsertionEnabled")}isValidConfigFound(){return this._initialize(),this.validConfigFound}isSignalEnabled(t){return this._initialize(),t!=null&&this.enabledSignals.includes(t)}isAutoInsertionEnabled(){return this._initialize(),this.autoInsertionEnabled}_initialize(){if(this.validConfigFound!=null)return;let t;try{t=this._getEntryModules()}catch(e){this.validConfigFound=!0,this.enabledSignals=Q,this.autoInsertionEnabled=!0;return}if(t==null){this.validConfigFound=!1,this.enabledSignals=[],this.autoInsertionEnabled=!1;return}this.validConfigFound=!0,this.enabledSignals=t.map(e=>Se[e]).filter(e=>e!=null),this.autoInsertionEnabled=t.includes(Te)}_getEntryModules(){let{cmp:t}=this.core.get(b).getTagInfo(),e=btoa(t),{modules:r,configs:o}=c,s=o[e];return s==null?null:s.map(a=>r[a])}};i(P,"TagConfig"),P=d([f],P);var te=i((n,t)=>{var s,a,g,l;let e=[],r=[],o=[];if(t.VLP==null)return{newSlots:n,existingSlots:r,existingTargeting:o};for(let m of n){let{id:p,sizes:h}=m.adUnit,y=it(h),S=(a=(s=t.VLP)==null?void 0:s[p])==null?void 0:a[y];if(S==null){e.push(m);continue}r.push(m);let E=(l=(g=t.TVP)==null?void 0:g[p])==null?void 0:l[y],U={};S!=null&&(U.VLP=[S]),E!=null&&(U.TVP=[E]),o.push(U)}return{newSlots:e,existingSlots:r,existingTargeting:o}},"processNewSlots");var O=class{performFetches(t,e,r,o,s){return T(this,null,function*(){let a=this.core.get(W),g=this.core.get($),l=this.core.get(P),p=this.core.get(x).getPts();if(s.addRequestedSignals(bt(t)),!l.isValidConfigFound())throw new K("404","Config not found!");let h=bt(t).filter(_=>l.isSignalEnabled(_)).filter(_=>lt(_)||p[_]==null),{newSlots:y,existingSlots:S,existingTargeting:E}=o?te(e,p):{newSlots:e,existingSlots:[],existingTargeting:[]};e=[...y,...S],s.setEventAction("request-timeout");let{userTargeting:U,pageTargeting:V,slotTargeting:w}=yield a.getTargeting(h,y,s);s.setEventAction("unknown");let I=[...w,...E];Yt(U,p),Xt(V,p);for(let _=0;_<e.length;_++)Zt(e[_],I[_],p);if(r&&l.isAutoInsertionEnabled()){s.setAutoInsertionEnabled(),g.autoInsertPageId(),g.autoInsertGlobalTargeting(U),g.autoInsertGlobalTargeting(V);for(let _=0;_<e.length;_++)g.autoInsertSlotId(e[_]),g.autoInsertSlotTargeting(e[_],I[_])}return s.addResultsData(U,V,w,y),Jt(p,this.core.window)})}};i(O,"LegacyModePerformFetches"),O=d([f],O);var H=class{constructor(){u(this,"_slotUuids",{})}_initialize(){this.core.get(x).setApi({loadSignals:this.loadSignals.bind(this),loadSignalsForSlots:this.loadSignalsForSlots.bind(this),getTargeting:this.getTargeting.bind(this)})}_getLegacyType(){return"mode"}loadSignals(t,e){return T(this,null,function*(){let r=this.core.get(R),o=this.core.get(O),s=this.core.get(P),a=r.createPendingEvent("loadSignals");a.setEventAction("slot-timeout");let l=s.isSignalEnabled("VLP")||s.isSignalEnabled("TVP")?yield this._getSlots():[];a.setEventAction("unknown");let m=!0,p=!1;try{yield o.performFetches(Q,l,m,p,a),a.setRequestSuccess(),a.setEventAction("load-signals");try{e==null||e()}catch(h){}}catch(h){try{e==null||e(h)}catch(y){}a.trackError(h)}finally{a.fireEvent()}})}loadSignalsForSlots(t,e,r){return T(this,null,function*(){let o=this.core.get(R),s=this.core.get(O),a=o.createPendingEvent("loadSignalsForSlots"),g=t.map(p=>this._parseGptSlot(p)),l=!0,m=!0;r=typeof e=="function"?e:r;try{yield s.performFetches(Q,g,l,m,a),a.setRequestSuccess(),a.setEventAction("load-signals-slots");try{r==null||r()}catch(p){}}catch(p){try{r==null||r(p)}catch(h){}a.trackError(p)}finally{a.fireEvent()}})}getTargeting(t,e){return T(this,null,function*(){var m,p;let r=this.core.get(R),o=this.core.get(O),s=r.createPendingEvent("getTargeting"),a=(p=(m=t.adUnits)==null?void 0:m.map(h=>this._parseAdUnit(h)))!=null?p:[],g=!1,l=!1;try{let h=yield o.performFetches(Q,a,g,l,s);s.setRequestSuccess(),s.setEventAction("load-signals");try{e==null||e(void 0,h)}catch(y){}}catch(h){try{e==null||e(h)}catch(y){}s.trackError(h)}finally{s.fireEvent()}})}_getSlots(){return T(this,null,function*(){var o,s;let t=this.core.window;t.googletag=(o=t.googletag)!=null?o:{},t.googletag.cmd=(s=t.googletag.cmd)!=null?s:[];let e=t.googletag;return(yield new Promise(a=>e.cmd.push(()=>{a(e.pubads().getSlots())}))).map(a=>this._parseGptSlot(a))})}_getSlotUuid(t){let e=this._slotUuids[t];return e==null&&(e=D(),this._slotUuids[t]=e),e}_parseGptSlot(t){let{elementId:e,adUnit:r}=Ht(t);return{elementId:e,uuid:this._getSlotUuid(r.id),adUnit:nt(rt({},r),{position:null})}}_parseAdUnit(t){let{adUnit:e}=$t(t);return{elementId:e.id,uuid:this._getSlotUuid(e.id),adUnit:nt(rt({},e),{position:null})}}};i(H,"LegacyMode"),d([C],H.prototype,"_initialize",1),d([St(R,"getLegacyType")],H.prototype,"_getLegacyType",1),H=d([f],H);var at=class{constructor(){u(this,"pending",[]);u(this,"flushing",!1)}push(t){this.pending.push(t),this.flush()}flush(){return T(this,null,function*(){var e;if(this.flushing)return;this.flushing=!0;let t=this.pending.shift();for(;t!=null;){try{yield t.promise}catch(r){}try{(e=t.callback)==null||e.call(t)}catch(r){}t=this.pending.shift()}this.flushing=!1})}};i(at,"AsyncQueue");var z=class{constructor(){u(this,"plugins",{adRequestQueued:()=>[]});u(this,"queue",new at);u(this,"adRequests",[])}_queueAdRequest(t){return T(this,null,function*(){if(this.plugins.adRequestQueued(),t==null)return;let e={status:0,timeoutValue:t.timeout,timeoutStarted:t.timestamp,delayStarted:new Date().getTime()};this.adRequests.push(e);let r=t.callback;r==null?e.status=1:t.callback=()=>{e.status=2,e.released=new Date().getTime(),t.callback=null,r()};let o=i(()=>{e.delayEnded=new Date().getTime(),t.callback!=null&&(t.callback=null,e.status=3,e.released=new Date().getTime(),r==null||r())},"onAsyncOperationsCompleted");this.queue.push({callback:o})})}delayAdRequests(t){this.queue.push({promise:t})}getAdRequestStatusses(){return this.adRequests}};i(z,"AdRequestQueue"),d([B("queueAdRequest")],z.prototype,"_queueAdRequest",1),z=d([f],z);var j=class{constructor(){u(this,"initialized",!1);u(this,"size",0)}_initialize(){return T(this,null,function*(){if(yield Promise.resolve(),this.initialized)return;this.initialized=!0;let t=this.core.dvtag.cmd instanceof Array?this.core.dvtag.cmd:[];this.core.dvtag.cmd=t,t.push=(...e)=>{for(let r of e)try{r()}catch(o){}return this.size+=e.length,this.size};for(let e of t)try{e()}catch(r){}this.size=t.length,t.length=0})}};i(j,"CommandBuffer"),d([C],j.prototype,"_initialize",1),j=d([f],j);var et=class{constructor(t,e,r,o,s){this._slotStore=t;this.source=e;this.elementId=r;this.adUnit=o;this._targetable=s;u(this,"uuid");u(this,"_variables",{});u(this,"_targeting",{});this.uuid=D()}setVariable(t,e){this._variables[t]=e}getVariable(t){return this._variables[t]}getUptTargetingKeys(){return[...new Set([...Object.keys(this._targeting),...this._slotStore.getUptPageTargetingKeys()])]}getUptTargetingForKey(t){var e;return[...new Set([...(e=this._targeting[t])!=null?e:[],...this._slotStore.getUptPageTargetingForKey(t)])]}getUptTargeting(){let t={};for(let e of this.getUptTargetingKeys())t[e]=this.getUptTargetingForKey(e);return t}setUptSlotTargeting(t){for(let[e,r]of Object.entries(t))this._targeting[e]=[...new Set(r)],this.flushUptTargetingToAdServer(e)}addUptSlotTargeting(t){var e;for(let[r,o]of Object.entries(t))this._targeting[r]=[...new Set([...(e=this._targeting[r])!=null?e:[],...o])],this.flushUptTargetingToAdServer(r)}getAdServerTargeting(t){var e;return(e=this._targetable.getTargeting(t))!=null?e:[]}flushUptTargetingToAdServer(t){this._targetable.setTargeting(t,this.getUptTargetingForKey(t))}};i(et,"Slot");var ve={getTargeting:()=>[],setTargeting:()=>{}},G=class{constructor(){u(this,"plugins",{slotDiscovered:t=>[],slotDestroyed:t=>[]});u(this,"_slots",{});u(this,"_pageTargeting",{})}getSlot(t,e){var r;return(r=this._slots[t])==null?void 0:r[e]}createSlot(t,e,r,o=ve){var g,l;let s=this.getSlot(t,e);s!=null&&this.plugins.slotDestroyed(s);let a=new et(this,t,e,r,o);(l=(g=this._slots)[t])!=null||(g[t]={}),this._slots[t][e]=a;for(let m of Object.keys(this._pageTargeting))a.flushUptTargetingToAdServer(m);return this.plugins.slotDiscovered(a),a}getUptPageTargetingKeys(){return Object.keys(this._pageTargeting)}getUptPageTargetingForKey(t){var e;return(e=this._pageTargeting[t])!=null?e:[]}getUptPageTargeting(){let t={};for(let[e,r]of Object.entries(this._pageTargeting))t[e]=[...r];return t}setUptPageTargeting(t){for(let[e,r]of Object.entries(t))this._pageTargeting[e]=[...new Set(r)];this._flushUptPageTargetingToAdServer(Object.keys(t))}addUptPageTargeting(t){var e;for(let[r,o]of Object.entries(t))this._pageTargeting[r]=[...new Set([...(e=this._pageTargeting[r])!=null?e:[],...o])];this._flushUptPageTargetingToAdServer(Object.keys(t))}_flushUptPageTargetingToAdServer(t){for(let e of Object.values(this._slots))for(let r of Object.values(e))for(let o of t)r==null||r.flushUptTargetingToAdServer(o)}};i(G,"SlotStore"),G=d([f],G);var At="api",q=class{_defineSlot(t,e={}){this.core.get(G).createSlot(At,t,nt(rt({},e),{sizes:tt(e.sizes)}))}};i(q,"DefineSlot"),d([B("defineSlot")],q.prototype,"_defineSlot",1),q=d([f],q);var F=class{_getTargeting(t){var r;let e=this.core.get(G);if(t==null)return e.getUptPageTargeting();{let o=e.getSlot(At,t);return(r=o==null?void 0:o.getUptTargeting())!=null?r:e.getUptPageTargeting()}}};i(F,"GetTargeting"),d([B("getTargeting")],F.prototype,"_getTargeting",1),F=d([f],F);var J=class{};i(J,"HouseHold"),J=d([f,ot(z),ot(j),ot(q),ot(F)],J);if(window.dvtag==null||window.dvtag._core==null)try{new Y([J,...ht],window)}catch(n){}})();
