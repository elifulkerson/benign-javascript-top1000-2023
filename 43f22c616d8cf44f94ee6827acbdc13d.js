(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["cozy_data_actions_UniversalHomepageActions_tsx"],{"./cozy/data/actions/UniversalHomepageActions.tsx":function(e,t,o){"use strict";o.r(t),o.d(t,{ackUniversalHomepageRefresh:function(){return T},clearIsInitialData:function(){return O},loadUniversalHomepageInitial:function(){return g},loadUniversalHomepageProducts:function(){return I},loadUniversalHomepageTabProducts:function(){return f},reloadUniversalHomepageProducts:function(){return L},setUniversalHomepageSelectedTab:function(){return E}}),o("./node_modules/core-js/modules/web.dom-collections.iterator.js");var s=o("./cozy/data/services/universalHomepage/GetUniversalHomepageService.tsx"),n=o("./cozy/utils/Api.tsx"),r=o("./cozy/data/builders/GenericFeedService.tsx"),a=o("./cozy/data/builders/ModuleFeedItem.tsx"),c=o("./cozy/data/selectors/UniversalHomepageSelectors.tsx"),i=o("./cozy/data/actions/PromotionActions.tsx"),_=o("./cozy/data/actions/FeedClearActions.tsx"),d=o("./cozy/data/actions/FeedActions.tsx"),u=o("./cozy/data/actions/actionNameConstants/UniversalHomepageActionNameConstants.tsx"),l=o("./cozy/data/constants/FeedConstants.tsx");const p=(e,t)=>{var o,s,n,i,_,d,u;const l={...(0,c.ws)(t)},p=(0,a.iG)(e.modules),m={items:p.feedProducts,next_offset:e.next_offset,no_more_items:e.no_more_items};return{...(0,a.ZP)(p.feedItems,l,null),...(0,r.Z)(m,null,{seenProductIDs:l,productsFieldName:"items",nextOffsetFieldName:"next_offset",noMoreItemsFieldName:"no_more_items"}),deal_dash_info:null===(o=e.extra_info)||void 0===o?void 0:o.blitz_buy_info,promoDealSpec:null===(s=e.extra_info)||void 0===s?void 0:s.promo_deal_spec,rotatingFeedBanners:null===(n=e.extra_info)||void 0===n?void 0:n.rotating_popular_feed_banners,app_download_prompt_spec:null===(i=e.extra_info)||void 0===i?void 0:i.app_download_prompt_spec,sticky_toaster_spec:null===(_=e.extra_info)||void 0===_?void 0:_.sticky_toaster_spec,blitz_buy_banner_spec:null===(d=e.extra_info)||void 0===d?void 0:d.blitz_buy_banner_spec,blitz_buy_banner_spec_variations:null===(u=e.extra_info)||void 0===u?void 0:u.blitz_buy_banner_spec_variations}},m=e=>{const t={};for(const o of e.tab_specs){const e=[],s=[];if(o.product_tiles){const n={};for(const t of o.product_tiles)(0,a.zB)(n,t,e,s,null);t[o.tab_id]={productIDs:s,products:e}}}return t},f=(e,t,o,s,r,a)=>({type:u.B9,payload:async()=>{const e={tabIDs:t.map((e=>e.tab_id)),sectionCode:o,pageCode:s,moduleID:r,pageVersionID:a},c=await async function(e){const{data:t}=await(0,n.ZP)("merchandising/tabbed-module/fetch-tab-products-detail",{tab_ids:e.tabIDs,section_code:e.sectionCode,page_code:e.pageCode,module_id:e.moduleID,page_version_id:e.pageVersionID});return t}(e);return{...m(c)}},meta:{moduleID:e,tabsToLoad:t}}),E=(e,t)=>({type:u.M$,payload:{selectedTabs:{[e]:t}}}),I=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(t,o)=>t({type:u.eV,payload:async()=>{e.offset||t((0,i.clearBanners)());let n=await(0,s.Z)({...e,trueClientOffset:e.offset}),r=p(n,o());for(;r.productIDs.length<1&&!n.no_more_items;){n=await(0,s.Z)({...e,offset:n.next_offset,trueClientOffset:n.next_offset});const t=p(n,o());r={...r,...t,extractedProducts:[...r.extractedProducts,...t.extractedProducts],modules:[...r.modules,...t.modules],moduleIDs:[...r.moduleIDs,...t.moduleIDs],hasTopPromoModuleSpecs:t.hasTopPromoModuleSpecs||r.hasTopPromoModuleSpecs,app_download_prompt_spec:r.app_download_prompt_spec||t.app_download_prompt_spec}}return r}})},g=(e,t)=>({type:u.x4,payload:{...p(e,t),isInitialData:!0}}),O=()=>({type:u.iM}),T=()=>({type:u.AU}),L=e=>t=>{(0,s.d)(),t((0,_.A7)()),t((0,_.vz)()),t((0,_.T3)()),t(I({offset:0,numColumns:e})),t((0,d.recordCategoryID)(l.vQ.LATEST))}},"./cozy/data/actions/actionNameConstants/UniversalHomepageActionNameConstants.tsx":function(e,t,o){"use strict";o.d(t,{eV:function(){return s},x4:function(){return n},I2:function(){return r},iM:function(){return a},AU:function(){return c},B9:function(){return i},C5:function(){return _},zq:function(){return d},LY:function(){return u},M$:function(){return l}});const s="UNIVERSAL_HOMEPAGE_LOAD_PRODUCTS",n="UNIVERSAL_HOMEPAGE_LOAD_PRODUCTS_FULFILLED",r="UNIVERSAL_HOMEPAGE_LOAD_PRODUCTS_PENDING",a="UNIVERSAL_HOMPAGE_CLEAR_IS_INITIAL_DATA",c="UNIVERSAL_HOMEPAGE_ACK_REFRESH",i="UNIVERSAL_HOMEPAGE_LOAD_TAB_PRODUCTS",_="UNIVERSAL_HOMEPAGE_LOAD_TAB_PRODUCTS_FULFILLED",d="UNIVERSAL_HOMEPAGE_LOAD_TAB_PRODUCTS_PENDING",u="UNIVERSAL_HOMEPAGE_LOAD_TAB_PRODUCTS_REJECTED",l="UNIVERSAL_HOMEPAGE_SET_SELECTED_TAB_INDEX"},"./cozy/data/builders/ModuleFeedItem.tsx":function(e,t,o){"use strict";o.d(t,{zB:function(){return c},iG:function(){return u}}),o("./node_modules/core-js/modules/web.dom-collections.iterator.js");var s=o("./cozy/data/builders/Product.tsx"),n=o("./node_modules/uuid/v4.js"),r=o.n(n),a=o("./cozy/data/constants/UniversalHomepageConstants.tsx");const c=(e,t,o,n,r)=>{if(!e[t.product_id]){const a={id:t.product_id,contest_page_picture:t.product_image_url,normal_picture:t.product_image_url,display_picture:t.product_image_url,product_tile_v2_spec:{...t}},c=(0,s.oi)(a,r);o.push(c),null==n||n.push(t.product_id),e[t.product_id]=!0}},i=e=>{const{product:t,rating_spec:o}=e||{};if(t){const e=(0,s.oi)(t);return o&&(e.staticFields.productRating=o),[e]}return[]},_=(e,t)=>{const o=e.universalHomepageModuleType;switch(o){case a.W.DIVIDER:return{feedItemSpec:{staticFields:{id:e.id,divider_spec:e.divider_spec},type:o}};case a.W.COLLECTION_TRAY:return{feedItemSpec:{staticFields:{id:e.id,collection_tray_module_spec:e.collection_tray_module_spec},type:o}};case a.W.SIMPLE_TEXT_ROW:return{feedItemSpec:{staticFields:{id:e.id,simple_text_row_spec:e.simple_text_row_spec},type:o}};case a.W.MINI_PDP:return{feedItemSpec:{staticFields:{id:e.id,mini_pdp_module_spec:e.mini_pdp_module_spec},type:o},feedProducts:i(e.mini_pdp_module_spec)};case a.W.TABBED_MODULES:const s=((e,t)=>{const o=[],s=e.tabbed_module_spec,n={...s,tabs:[]},r={};for(const e of s.tabs){const s={...e,isLoading:!1,product_tiles:[]};if(e.product_tiles)for(const n of e.product_tiles)c(r,n,o,s.product_tiles,t);n.tabs.push(s)}return{tabbed_module:n,products:o}})(e,t);return{feedItemSpec:{staticFields:{id:e.id,tabbed_module_spec:s.tabbed_module},type:o},feedProducts:s.products};case a.W.PROMO_CAROUSEL:const n=(e=>{const t=[],o=e.promo_carousel_module_spec,s={...o,items:[]};for(const e of o.items)switch(e.template_type){case a.y.LEGACY_ROTATING_BANNERS:const o=e.spec_data;t.push(o);break;case a.y.V1_PROMO_BANNERS:case a.y.COUPON_PROMO_BANNERS:const n=e;s.items.push(n)}return{rotating_popular_feed_banners:t,promo_banners:s}})(e);return{feedItemSpec:{staticFields:{id:e.id,promo_carousel_module_spec:n.promo_banners},type:o},rotatingPopularFeedBanners:n.rotating_popular_feed_banners,hasTopPromoModuleSpecs:!0};case a.W.THIN_BANNER:return{feedItemSpec:{staticFields:{id:e.id,thin_banner_module_spec:e.thin_banner_module_spec},type:o}};case a.W.MERCHANDISED_CAROUSEL:const r=((e,t)=>{const o=[],s=e.merchandised_carousel_spec,n={...s,isLoading:!1,item_specs:[]},r={};for(const e of s.item_specs)c(r,e,o,n.item_specs,t);return{merchandised_carousel:n,products:o}})(e,t);return{feedItemSpec:{staticFields:{id:e.id,merchandised_carousel_spec:r.merchandised_carousel},type:o},feedProducts:r.products};case a.W.CATEGORIES_ROW:return{feedItemSpec:{staticFields:{id:e.id,categories_row_spec:e.categories_row_spec},type:o}};default:return null}},d=e=>{switch(e.type){case a.W.PRODUCT_TILE_V2:const t=e.data;return{id:t.product_id,product_tile_v2_spec:{...t},normal_picture:t.product_image_url,display_picture:t.product_image_url,contest_page_picture:t.product_image_url,universalHomepageModuleType:e.type,universalHomepageModuleLogInfo:e.log_info};case a.W.COLLECTION_TILE_V2:const o=e.data;return{id:o.content.collection_id,collection_tile_v2_spec:{...o},universalHomepageModuleType:e.type,universalHomepageModuleLogInfo:e.log_info};case a.W.PRODUCT_TILE:const s=e.data;return{...s,id:s.id,universalHomepageModuleType:e.type,universalHomepageModuleLogInfo:e.log_info};case a.W.TABBED_MODULES:const n=e.data;return{id:a.W.TABBED_MODULES+"_"+r()(),tabbed_module_spec:{...n},universalHomepageModuleType:e.type,universalHomepageModuleLogInfo:e.log_info};case a.W.PROMO_CAROUSEL:const c=e.data;return{id:a.W.PROMO_CAROUSEL+"_"+r()(),promo_carousel_module_spec:{...c},universalHomepageModuleType:e.type,universalHomepageModuleLogInfo:e.log_info};case a.W.THIN_BANNER:const i=e.data;return{id:a.W.THIN_BANNER+"_"+r()(),thin_banner_module_spec:{...i},universalHomepageModuleType:e.type,universalHomepageModuleLogInfo:e.log_info};case a.W.MERCHANDISED_CAROUSEL:const _=e.data;return{id:a.W.MERCHANDISED_CAROUSEL+"_"+r()(),merchandised_carousel_spec:{..._},universalHomepageModuleType:e.type,universalHomepageModuleLogInfo:e.log_info};case a.W.MINI_PDP:const d=e.data;return{id:a.W.MINI_PDP+"_"+r()(),mini_pdp_module_spec:{...d},universalHomepageModuleType:e.type,universalHomepageModuleLogInfo:e.log_info};case a.W.CATEGORIES_ROW:const u=e.data;return{id:a.W.CATEGORIES_ROW+"_"+r()(),categories_row_spec:{...u},universalHomepageModuleType:e.type,universalHomepageModuleLogInfo:e.log_info};case a.W.COLLECTION_TRAY:const l=e.data;return{id:a.W.COLLECTION_TRAY+"_"+r()(),collection_tray_module_spec:{...l},universalHomepageModuleType:e.type,universalHomepageModuleLogInfo:e.log_info};case a.W.SIMPLE_TEXT_ROW:const p=e.data;return{id:a.W.SIMPLE_TEXT_ROW+"_"+r()(),simple_text_row_spec:{...p},universalHomepageModuleType:e.type,universalHomepageModuleLogInfo:e.log_info};case a.W.DIVIDER:const m=e.data;return{id:a.W.DIVIDER+"_"+r()(),divider_spec:{...m},universalHomepageModuleType:e.type,universalHomepageModuleLogInfo:e.log_info};default:return null}},u=e=>{const t=[];let o=!1,s=0,n=0;const r=[];for(const c of e){n+=1;const i=c.type,_=d(c);_&&(i===a.W.PRODUCT_TILE_V2||i===a.W.PRODUCT_TILE||i===a.W.COLLECTION_TILE_V2?(s+=1,o&&n===e.length&&s%2!=0?r.push(_):t.push(_)):(o=!0,t.push(_)))}return o?{feedProducts:r,feedItems:t}:{feedProducts:t,feedItems:[]}};t.ZP=(e,t,o)=>{const n=[],c=[],i=[],d=[],u=[];let l=!1;for(const r of e)if(r.universalHomepageModuleType===a.W.PRODUCT_TILE_V2||r.universalHomepageModuleType===a.W.PRODUCT_TILE||r.universalHomepageModuleType===a.W.COLLECTION_TILE_V2){if(!t[r.id]){const e=(0,s.oi)(r,o);n.push(e),u.push(r.id),t[r.id]=!0}}else{const e=_(r,o);if(e){var p,m;const t=e.feedItemSpec,o=null!==(p=e.feedProducts)&&void 0!==p?p:[],s=null!==(m=e.rotatingPopularFeedBanners)&&void 0!==m?m:[];l=(null==e?void 0:e.hasTopPromoModuleSpecs)||l,s.length>0&&d.push(...s),o.length>0&&n.push(...o),c.push(t),i.push(r.id)}}if(u.length>0){const e=a.W.PRODUCT_TILE_V2+"_"+r()();c.push({staticFields:{id:e,short_feed_product_tiles_spec:u},type:a.W.PRODUCT_TILE_V2}),i.push(e)}return{moduleIDs:i,modules:c,extractedProducts:n,rotatingFeedBanners:d.length>0?d:void 0,seenProductIDs:t,hasTopPromoModuleSpecs:l}}},"./cozy/data/constants/UniversalHomepageConstants.tsx":function(e,t,o){"use strict";o.d(t,{W:function(){return s},y:function(){return n}});const s={PRODUCT_TILE_V2:"product_tile_v2",TABBED_MODULES:"tabbed_item_row",PROMO_CAROUSEL:"promo_carousel",THIN_BANNER:"thin_banner",PRODUCT_TILE:"product_tile",COLLECTION_TILE_V2:"collection_tile_v2",MERCHANDISED_CAROUSEL:"merchandised_carousel",MINI_PDP:"mini_pdp",CATEGORIES_ROW:"categories_row",COLLECTION_TRAY:"horizontal_scroll_categories_row",SIMPLE_TEXT_ROW:"simple_text_row",DIVIDER:"divider"};let n;!function(e){e[e.V1_PROMO_BANNERS=1]="V1_PROMO_BANNERS",e[e.COUPON_PROMO_BANNERS=2]="COUPON_PROMO_BANNERS",e[e.LEGACY_ROTATING_BANNERS=3]="LEGACY_ROTATING_BANNERS"}(n||(n={}))},"./cozy/data/selectors/UniversalHomepageSelectors.tsx":function(e,t,o){"use strict";o.d(t,{os:function(){return n},V_:function(){return r},WQ:function(){return a},JP:function(){return c},Vc:function(){return i},ws:function(){return _},Mk:function(){return d},ds:function(){return u},h3:function(){return l}});var s=o("./cozy/data/selectors/DataSelectors.tsx");const n=e=>(0,s.c0)(e).nextOffset,r=e=>(0,s.c0)(e).productIDs,a=e=>(0,s.c0)(e).moduleIDs,c=e=>(0,s.c0)(e).noMoreItems,i=e=>(0,s.c0)(e).isLoading,_=e=>(0,s.c0)(e).seenProductIDs,d=e=>(0,s.c0)(e).isInitialData,u=e=>(0,s.c0)(e).shouldRefreshCurrentFeed,l=e=>(0,s.c0)(e).selectedTabs},"./cozy/data/services/universalHomepage/GetUniversalHomepageService.tsx":function(e,t,o){"use strict";o.d(t,{d:function(){return c}}),o("./node_modules/core-js/modules/web.dom-collections.iterator.js");var s=o("./cozy/utils/Api.tsx"),n=o("./cozy/data/constants/ErrorConstants.tsx"),r=o("./cozy/data/constants/FeedConstants.tsx");let a=[];t.Z=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{data:t}=await(0,s.ZP)("get-universal-homepage",{count:e.count||r.J,offset:e.offset,num_columns:e.numColumns,true_client_offset:e.trueClientOffset},{abortCallback:e=>{a.push(e)}});return t};const c=()=>{for(const e of a)e(n.CL);a=[]}}}]);
//# sourceMappingURL=cozy_data_actions_UniversalHomepageActions_tsx.fbde98d99a2464c95c3c.js.map