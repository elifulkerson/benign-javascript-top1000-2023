void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/home/bcweekly_email_panel.liquid","warn"):Templ.register({"home/bcweekly_email_panel":['<div class="bcweekly-email-panel" tabindex="0">\n    <div>\n        <h4 class="panel-title">Copy this link to share the show:</h4>\n        <div>\n            <input class="email-field" type="text" value="',{type:"variable",name:"siteroot",filters:[["a",[]]]},"/?show=",{type:"variable",name:"show.show_id",filters:[["u",[]],["a",[]]]},'&amp;play=1" readonly>\n        </div>\n    </div>\n    <a class="close" href="#"><span class="bc-ui">close</span></a>\n</div>']}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/home_2016/bcweekly.liquid","warn"):Templ.register({"home_2016/bcweekly":['<div id="bcweekly-inner" class="bd-section bcweekly',{type:"ef",blocks:[{type:"ncondition",expression:"!bcw.published_date ",attachment:[" unpublished"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"bcw.expanded ",attachment:["expanded"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"bcw.dark_mode ",attachment:["dark-mode"]}]},'"\n\t',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n\tstyle="background-image: url(',{type:"ef",blocks:[{type:"ncondition",expression:"bcw.show_v2_image_id ",attachment:[{type:"variable",name:"bcw.show_v2_image_id",filters:[["image_url",["'weekly_mobile_web'"]]]}]},{type:"else_ncondition",attachment:[{type:"variable",name:"bcw.show_image_id",filters:[["image_url",["'weekly_mobile_web'"]]]}]}]},');"\n\t']},{type:"else_ncondition",attachment:['\n\tstyle="background-image: url(',{type:"ef",blocks:[{type:"ncondition",expression:"bcw.show_v2_image_id ",attachment:[{type:"variable",name:"bcw.show_v2_image_id",filters:[["image_url",["'original'"]]]}]},{type:"else_ncondition",attachment:[{type:"variable",name:"bcw.show_image_id",filters:[["image_url",["'original'"]]]}]}]},');"\n\t']}]},'\n>\n    <div class="row">\n        <div class="close-show-mobile">\n            <a href="#" class="close-show-inner">\n                <svg class="close-show-icon" viewBox="0 0 12 12"><use href="#close-weekly-archive"></svg>\n            </a>\n        </div>\n    </div>\n</div>\n\n<div class="bcweekly-info bd-section">\n    <div class="row">\n        <div class="bcweekly-info-inner">\n            ',{type:"include",template_name:"'home_2016/bcweekly_player'"},"\n            ",{type:"include",template_name:"'home_2016/bcweekly_tracks'"},'\n\n            <div class="close-show-desktop">\n                <a href="#" class="close-show-inner">\n                    <svg class="close-show-icon" viewBox="0 0 12 12"><use href="#close-weekly-archive"></svg><span class="close-show-text">',{type:"translate",nodelist:["close show"]},"</span>\n                </a>\n            </div>\n        </div>\n    </div>\n\n    ",{type:"include",template_name:"'home_2016/bcweekly_browse'"},"\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/home_2016/bcweekly_tracks.liquid","warn"):Templ.register({"home_2016/bcweekly_tracks":['<div class="bcweekly-tracks">\n</div>']}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/home_2016/bcweekly_tracks_inner.liquid","warn"):Templ.register({"home_2016/bcweekly_tracks_inner":['<ol class="bcweekly-track-list">\n\n    ',{type:"for",collection_name:"bcw.tracks",nodelist:["\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"trk.album_id ",attachment:["\n            ",{type:"let",variable:"tralbum_type",expression:'"album" '},"\n            ",{type:"capture",to:"tralbum_key",nodelist:["a",{type:"variable",name:"trk.album_id",filters:[]}]},"\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"let",variable:"tralbum_type",expression:'"track" '},"\n            ",{type:"capture",to:"tralbum_key",nodelist:["t",{type:"variable",name:"trk.track_id",filters:[]}]},"\n        "]}]},'\n\n        <li class="row bcweekly-track ',{type:"ef",blocks:[{type:"ncondition",expression:"forloop.index0 == 0 ",attachment:["first-track"]}]},'" data-index="',{type:"variable",name:"forloop.index0",filters:[]},'">\n            <div class="col col-2-16 track-image-cell">\n                <a href="',{type:"variable",name:"trk.url_hints",filters:[["tralbum_url",[]],["a",[]]]},'?from=hpbcw" data-collapsed-href="',{type:"variable",name:"trk.url_hints",filters:[["tralbum_url",[]],["a",[]]]},'?from=hpbcw" data-expanded-href="',{type:"variable",name:"trk.track_art_id",filters:[["art_url",["'screen'"]],["a",[]]]},'">\n                    <span class="ratio-1-1">\n                        <img ',{type:"variable",name:"trk.track_art_id",filters:[["art",["'art_thumbthumb'"]]]},' alt="">\n                    </span>\n                </a>\n            </div>\n            <div class="col col-9-16 track-details-cell">\n                <p class="track-details">\n                    <a class="track-details" href="',{type:"variable",name:"trk.url_hints",filters:[["tralbum_url",[]],["a",[]]]},'?from=hpbcw" target="_blank">\n                        ',{type:"ef",blocks:[{type:"ncondition",expression:"trk.album_title ",attachment:["\n                        ",{type:"translate",nodelist:["",{type:"translateVariable",var_name:"track_title",nodelist:['<span class="track-title">',{type:"variable",name:"trk.title",filters:[["h",[]]]},"</span>"]}," from ",{type:"translateVariable",var_name:"album_title",nodelist:['<span class="track-album">',{type:"variable",name:"trk.album_title",filters:[["h",[]]]},"</span>"]},""]},"\n                        "]},{type:"else_ncondition",attachment:['\n                        <span class="track-title">',{type:"variable",name:"trk.title",filters:[["h",[]]]},"</span>\n                        "]}]},'\n                    </a>\n                </p>\n                <p class="track-artist">\n                    ',{type:"translate",nodelist:["by ",{type:"translateVariable",var_name:"track_artist",nodelist:['<a href="',{type:"variable",name:"trk.url_hints",filters:[["band_url",[]],["a",[]]]},'?from=hpbcw"target="_blank">',{type:"variable",name:"trk.artist",filters:[["h",[]]]},"</a>"]},""]},'\n                </p>\n            </div>\n            <div class="col col-4-16">\n                <div class="collect-item-container collection-controls-cell collect-item disabled">\n                    <span class="buy-now collect-item" data-collect-item="',{type:"variable",name:"tralbum_key",filters:[["a",[]]]},'" data-collect-band="',{type:"variable",name:"trk.band_id",filters:[["a",[]]]},'">\n                        <a href="',{type:"variable",name:"trk.url_hints",filters:[["tralbum_url",[]],["a",[]]]},'?from=hpbcwbn" target="_blank" class="collect-link txt">\n                            <span class="txt">',{type:"translate",nodelist:["buy"]},'</span>\n                        </a>\n                    </span>\n                    <span class="purchased-msg collect-item" data-collect-item="',{type:"variable",name:"tralbum_key",filters:[["a",[]]]},'" data-collect-band="',{type:"variable",name:"trk.band_id",filters:[["a",[]]]},'">\n                        <a href="',{type:"variable",name:"fan_data.url",filters:[["a",[]]]},'" target="_blank">\n                            <span class="bc-ui2 collect-item-icon"></span><span class="txt">',{type:"translate",nodelist:["you own this"]},'</span>\n                        </a>\n                    </span>\n                    <span class="wishlist-msg collect-item ',{type:"ef",blocks:[{type:"ncondition",expression:"!fan_data.id ",attachment:["logged-out"]}]},'" title="',{type:"translate",nodelist:["Add this album to your wishlist"]},'" data-collect-item="',{type:"variable",name:"tralbum_key",filters:[["a",[]]]},'" data-collect-band="',{type:"variable",name:"trk.band_id",filters:[["a",[]]]},'" data-collect-stat="homepage_bcw_wishlist" ',{type:"ef",blocks:[{type:"ncondition",expression:"!fan_data.id ",attachment:['data-lo-querystr="',{type:"variable",name:"trk.lo_querystr",filters:[["a",[]]]},'" data-lo-from="hpbcwwlo"']}]},' data-collect-title="',{type:"ef",blocks:[{type:"ncondition",expression:"trk.album_title ",attachment:[{type:"variable",name:"trk.album_title",filters:[["a",[]]]}]},{type:"else_ncondition",attachment:[{type:"variable",name:"trk.title",filters:[["a",[]]]}]}]},'">\n                        <a href="#" target="_blank" class="collect-link">\n                            <span class="bc-ui2 collect-item-icon"></span><span class="txt">',{type:"translate",nodelist:["wishlist"]},'</span>\n                        </a>\n                    </span>\n                    <span class="wishlisted-msg collect-item" data-collect-item="',{type:"variable",name:"tralbum_key",filters:[["a",[]]]},'" data-collect-band="',{type:"variable",name:"trk.band_id",filters:[["a",[]]]},'" data-collect-stat="homepage_bcw_wishlist">\n                        <a href="#" title="',{type:"translate",nodelist:["Remove this album from your wishlist"]},'" class="collect-link">\n                            <span class="bc-ui2 collect-item-icon"></span><span class="txt">',{type:"translate",nodelist:["in wishlist"]},'</span>\n                        </a>\n                    </span>\n                </div>\n            </div>\n            <div class="col col-1-16">\n                <p class="track-number">',{type:"variable",name:"forloop.index",filters:[["h",[]]]},'</p>\n            </div>\n            <div class="row track-large">\n                <div class="col col-8-15">\n                    <a href="',{type:"variable",name:"trk.track_art_id",filters:[["art_url",["'screen'"]],["a",[]]]},'" class="ratio-1-1 popupImage">\n                        <img ',{type:"variable",name:"trk.track_art_id",filters:[["art",["'art_solo_feature'"]]]},' alt="">\n                    </a>\n                </div>\n                <div class="col col-7-15">\n                    <p class="track-counter">',{type:"translate",nodelist:["Currently playing ",{type:"translateVariable",var_name:"track_number",nodelist:["<span>",{type:"variable",name:"forloop.index",filters:[["h",[]]]},"</span>"]},""]},'</p>\n\n                    <p class="track-details">\n                        <a href="',{type:"variable",name:"trk.url_hints",filters:[["tralbum_url",[]],["a",[]]]},'?from=hpbcw" target="_blank">\n                            ',{type:"ef",blocks:[{type:"ncondition",expression:"trk.album_title ",attachment:["\n                            ",{type:"translate",nodelist:["",{type:"translateVariable",var_name:"track_title",nodelist:['<span class="track-title">',{type:"variable",name:"trk.title",filters:[["h",[]]]},"</span>"]}," from ",{type:"translateVariable",var_name:"album_title",nodelist:['<span class="track-album">',{type:"variable",name:"trk.album_title",filters:[["h",[]]]},"</span>"]},""]},"\n                            "]},{type:"else_ncondition",attachment:['\n                            <span class="track-title">',{type:"variable",name:"trk.title",filters:[["h",[]]]},"</span>\n                            "]}]},"\n                        </a>\n                    </p>\n\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:"trk.bio_image_id ",attachment:['\n                    <a class="track-bio-img popupImage" href="',{type:"variable",name:"trk.bio_image_id",filters:[["image_url",["'bio_screen'"]]]},'">\n                        <img ',{type:"variable",name:"trk.bio_image_id",filters:[["image",["32"]]]},' alt="">\n                    </a>\n                    ']}]},'\n                    \n                    <p class="track-artist">\n                        ',{type:"translate",nodelist:["by ",{type:"translateVariable",var_name:"track_artist",nodelist:['<a href="',{type:"variable",name:"trk.url_hints",filters:[["band_url",[]],["a",[]]]},'?from=hpbcw" target="_blank">',{type:"variable",name:"trk.artist",filters:[["h",[]]]},"</a>"]},""]},"\n                    </p>\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:"trk.location_text ",attachment:['\n                        <p class="track-loc">\n                            ',{type:"variable",name:"trk.location_text",filters:[["h",[]]]},"\n                        </p>\n                    "]}]},'\n                </div>\n                <div class="collect-item-container disabled">\n                    \n                    <ul class="collect-item ',{type:"ef",blocks:[{type:"ncondition",expression:"!fan_data.id ",attachment:["logged-out"]}]},'" data-collect-item="',{type:"variable",name:"tralbum_key",filters:[["a",[]]]},'" data-collect-band="',{type:"variable",name:"trk.band_id",filters:[["a",[]]]},'" data-collect-stat="homepage_bcw_wishlist" ',{type:"ef",blocks:[{type:"ncondition",expression:"!fan_data.id ",attachment:['data-lo-querystr="',{type:"variable",name:"trk.lo_querystr",filters:[["a",[]]]},'" data-lo-from="hpnnwlo"']}]},' data-collect-title="',{type:"ef",blocks:[{type:"ncondition",expression:"trk.album_title ",attachment:[{type:"variable",name:"trk.album_title",filters:[["a",[]]]}]},{type:"else_ncondition",attachment:[{type:"variable",name:"trk.title",filters:[["a",[]]]}]}]},'">\n                        <li class="item-container buy-now">\n                            <a href="',{type:"variable",name:"trk.url_hints",filters:[["tralbum_url",[]],["a",[]]]},'?from=hpbcwbn" target="_blank" class="nav_button nav_button_buy" id="nav_button_buy">\n                                ',{type:"translate",nodelist:["buy now"]},'\n                            </a>\n                        </li>\n                        <li class="item-container wishlist">\n                            <span class="purchased-msg collection-btn">\n                                <a href="',{type:"variable",name:"fan_data.url",filters:[["a",[]]]},'">\n                                    <span class="bc-ui2 collect-item-icon"></span><span class="txt">',{type:"translate",nodelist:["you own this"]},'</span>\n                                </a>\n                            </span>\n                            <span class="wishlist-msg collection-btn" title="',{type:"translate",nodelist:["Add this album to your wishlist"]},'">\n                                <a href="#" id="nav_button_collect" target="_blank" class="collect-link">\n                                    <span class="bc-ui2 collect-item-icon"></span><span class="txt">',{type:"translate",nodelist:["wishlist"]},'</span>\n                                </a>\n                            </span>\n                            <span class="wishlisted-msg collection-btn">\n                                <span title="',{type:"translate",nodelist:["Remove this album from your wishlist"]},'">\n                                    <a href="#" id="nav_button_uncollect" class="collect-link">\n                                        <span class="bc-ui2 collect-item-icon"></span><span class="txt">',{type:"translate",nodelist:["in wishlist"]},'</span>\n                                    </a>\n                                </span>\n                            </span>\n                        </li>\n                        <li class="item-container hear-more">\n                            <a href="',{type:"variable",name:"trk.url_hints",filters:[["tralbum_url",[]],["a",[]]]},'?from=hpbcw" target="_blank">',{type:"translate",nodelist:["visit album page"]}," &rarr;</a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </li>\n\n    "],variable_name:"trk",reversed:null,attribs:{}},"\n</ol>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/home_2016/bcweekly_player.liquid","warn"):Templ.register({"home_2016/bcweekly_player":['<div class="bcweekly-player">\n    <div class="col">\n        <a href="#" class="play-btn"',{type:"ef",blocks:[{type:"ncondition",expression:"bcw.button_color ",attachment:[' style="background-color: #',{type:"variable",name:"bcw.button_color",filters:[["a",[]]]},'"']}]},'><span class="icon"></span></a>\n    </div>\n    <div class="col">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n            <ul class="bcweekly-tabs">\n                <li class="bcweekly-tab tab-active"><a href="#bcweekly-details-tab" class="show-details">',{type:"translate",nodelist:["Details"]},'</a></li>\n                <li class="bcweekly-tab disabled"><a href="#bcweekly-playing-tab" class="show-playing">',{type:"translate",nodelist:["Now Playing"]},'</a></li>\n            </ul>\n            <div class="tab-content">\n                <div id="bcweekly-details-tab">\n                    <h2 class="bcweekly-title">',{type:"variable",name:"bcw.title",filters:[["h",[]]]}," <em>",{type:"variable",name:"bcw.date",filters:[["time",["6"]],["h",[]]]},'</em></h2>\n                    <p class="bcweekly-desc">',{type:"variable",name:"bcw.desc",filters:[["h",[]]]},'</p>\n                    <p class="bcweekly-credits">',{type:"variable",name:"bcw.image_caption",filters:[]},'</p>\n                </div>\n                <div id="bcweekly-playing-tab" style="display: none;">\n                </div>\n            </div>\n            <p class="bcweekly-links-1"><a href="#" class="bcweekly-shows-link">',{type:"translate",nodelist:["all shows"]},'</a></p>\n            <p class="bcweekly-links-2"><a href="#" class="bcweekly-shows-link">',{type:"translate",nodelist:["all shows"]},'</a></p>\n            <p class="bcweekly-links-3">\n                <a href="#" class="bcweekly-tracks-link">',{type:"translate",nodelist:["Tracklist"]},'</a>\n                <a href="#" class="bcweekly-shows-link">',{type:"translate",nodelist:["All Shows"]},'</a>\n                <a class="bcweekly-share-link" href="#">',{type:"translate",nodelist:["Share this Show"]},"</a>\n            </p>\n        "]},{type:"else_ncondition",attachment:['\n            <h2 class="bcweekly-title">',{type:"variable",name:"bcw.title",filters:[["h",[]]]}," <em>",{type:"variable",name:"bcw.date",filters:[["time",["6"]],["h",[]]]},'</em></h2>\n            <p class="bcweekly-desc">',{type:"variable",name:"bcw.desc",filters:[["h",[]]]},'</p>\n            <p class="bcweekly-credits">',{type:"variable",name:"bcw.image_caption",filters:[]},'</p>\n            <p class="bcweekly-links-1"><a href="#" class="bcweekly-shows-link">',{type:"translate",nodelist:["all shows"]},'</a></p>\n            <div class="bcweekly-links-2">\n                <a href="#" class="bcweekly-shows-link">',{type:"translate",nodelist:["all shows"]},'</a>\n                <a class="bcweekly-share-link" href="#">',{type:"translate",nodelist:["share this show"]},'</a>\n            <ul class="social-controls" data-url="',{type:"variable",name:"siteroot",filters:[["a",[]]]},"/?show=",{type:"variable",name:"bcw.show_id",filters:[["u",[]],["a",[]]]},'&amp;play=1">\n                <li class="facebook-share-ctrl" data-stat="homepage_bcw_fb_like">\n                    <a class="facebook-link" title="',{type:"translate",nodelist:["Share on Facebook"]},'"><span class="bc-home"></span></a>\n                </li>\n                <li class="twitter-ctrl" data-text="',{type:"translate",nodelist:["I’m listening to ",{type:"translateVariable",var_name:"show_title_and_subtitle",nodelist:[{type:"variable",name:"bcw.title",filters:[["a",[]]]}," &ndash; ",{type:"variable",name:"bcw.subtitle",filters:[["a",[]]]}]},":"]},'" data-stat="homepage_bcw_tweet">\n                    <a class="twitter-link" title="',{type:"translate",nodelist:["Share on Twitter"]},'"><span class="bc-home"></span></a>\n                </li>\n                \n                <li class="trigger-email-panel">\n                    <a href="#" class="email-link" title="',{type:"translate",nodelist:["Share a link to this show"]},'"><span class="bc-home"></span></a>\n                </li>\n            </ul>\n            </div>\n            <p class="bcweekly-links-3">\n                <a href="#" class="bcweekly-tracks-link">',{type:"translate",nodelist:["Tracklist"]},'</a>\n                <a href="#" class="bcweekly-shows-link">',{type:"translate",nodelist:["All Shows"]},'</a>\n                <a class="bcweekly-share-link" href="#">',{type:"translate",nodelist:["Share this Show"]},"</a>\n            </p>\n\n        "]}]},'\n    </div>\n    <div class="row bcweekly-scrubber">\n        <div class="scrubber">\n            <div class="scrubber-buffer" style="width: 0%;"></div>\n            <div class="scrubber-thumb ui-draggable"></div>\n        </div>\n        <div class="scrubber-time"><div class="time-output">00:00 / --:--</div></div>\n    </div>\n    <span class="bcweekly-player-fade"></span>\n</div>\n']}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/home_2016/bcweekly_browse.liquid","warn"):Templ.register({"home_2016/bcweekly_browse":['<div class="bcweekly-browse hidden">\n</div>']}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/home_2016/bcweekly_browse_inner.liquid","warn"):Templ.register({"home_2016/bcweekly_browse_inner":['<div class="bcweekly-browse-inner">\n    <h3 class="bcweekly-browse-heading">',{type:"translate",nodelist:["The Bandcamp Radio archive"]},'</h3>\n    <ol class="browse-list">\n        ',{type:"include",template_name:'"home_2016/bcweekly_browse_inner_items"'},'\n    </ol>\n</div>\n<div class="bcweekly-browse-overlay-top"></div>\n<div class="bcweekly-browse-overlay-bottom"></div>\n<a href="#" class="bcweekly-close-link">\n    <svg class="bcweekly-close-icon" viewBox="0 0 12 12"><use xlink:href="#close-weekly-archive"></svg>\n</a>']}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/home_2016/bcweekly_browse_inner_items.liquid","warn"):Templ.register({"home_2016/bcweekly_browse_inner_items":[{type:"for",collection_name:"bcw_seq",nodelist:['\n    <li class="col bcweekly-browse-item',{type:"ef",blocks:[{type:"ncondition",expression:"show.unpub ",attachment:[" unpublished"]}]},'" data-show-id="',{type:"variable",name:"show.id",filters:[["a",[]]]},'">\n        <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/?show=",{type:"variable",name:"show.id",filters:[["u",[]],["a",[]]]},'">\n            <span class="show-image-wrapper ratio-16-9">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"show.v2_image_id ",attachment:['\n                <img class="show-image" ',{type:"variable",name:"show.v2_image_id",filters:[["image",["'bio_app'"]]]},">\n                "]},{type:"ncondition",expression:"show.image_id ",attachment:['\n                <img class="show-image" ',{type:"variable",name:"show.image_id",filters:[["image",["'bio_app'"]]]},">\n                "]}]},'\n                <div class="bcweekly-browse-item-play"><span class="icon"></span></div>\n            </span>\n            <div class="show-details">\n                <div class="episode-date">\n                    ',{type:"variable",name:"show.title",filters:[["h",[]]]},", ",{type:"variable",name:"show.date",filters:[["date",['"%B %d, %Y"']]]},'\n                </div>\n                <p class="show-description">',{type:"variable",name:"show.desc",filters:[["h",[]]]},'</p>\n                <p class="show-credits">',{type:"variable",name:"show.image_caption",filters:[["strip_html",[]]]},"</p>\n            </div>\n        </a>\n    </li>\n"],variable_name:"show",reversed:null,attribs:{}},"\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/home_2016/bcweekly_playing_tab_phone.liquid","warn"):Templ.register({"home_2016/bcweekly_playing_tab_phone":["\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"trk.album_id ",attachment:["\n    ",{type:"let",variable:"tralbum_type",expression:'"album" '},"\n    ",{type:"capture",to:"tralbum_key",nodelist:["a",{type:"variable",name:"trk.album_id",filters:[]}]},"\n"]},{type:"else_ncondition",attachment:["\n    ",{type:"let",variable:"tralbum_type",expression:'"track" '},"\n    ",{type:"capture",to:"tralbum_key",nodelist:["t",{type:"variable",name:"trk.track_id",filters:[]}]},"\n"]}]},'\n\n<div class="row bcweekly-now-playing-section track-large">\n    <div class="col col-6-12">\n        <a href="',{type:"variable",name:"trk.track_art_id",filters:[["art_url",["'screen'"]]]},'" class="ratio-1-1 popupImage">\n            <img ',{type:"variable",name:"trk.track_art_id",filters:[["art",["'art_thumb'"]]]},' alt="">\n        </a>\n    </div>\n    <div class="col col-6-12">\n        <p class="track-details">\n            <a href="',{type:"variable",name:"trk.url_hints",filters:[["tralbum_url",[]],["a",[]]]},'?from=hpbcw" target="_blank">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"trk.album_title ",attachment:["\n                ",{type:"translate",nodelist:["",{type:"translateVariable",var_name:"track_title",nodelist:['<span class="track-title">',{type:"variable",name:"trk.title",filters:[["h",[]]]},"</span>"]}," from ",{type:"translateVariable",var_name:"album_title",nodelist:['<span class="track-album">',{type:"variable",name:"trk.album_title",filters:[["h",[]]]},"</span>"]},""]},"\n                "]},{type:"else_ncondition",attachment:['\n                <span class="track-title">',{type:"variable",name:"trk.title",filters:[["h",[]]]},"</span>\n                "]}]},"\n            </a>\n        </p>\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"trk.bio_image_id ",attachment:['\n        <a class="track-bio-img popupImage" href="',{type:"variable",name:"trk.bio_image_id",filters:[["image_url",["'bio_screen'"]]]},'">\n            <img ',{type:"variable",name:"trk.bio_image_id",filters:[["image",["32"]]]},' alt="">\n        </a>\n        ']}]},'\n        <p class="track-artist">\n            ',{type:"translate",nodelist:["by ",{type:"translateVariable",var_name:"track_artist",nodelist:['<a href="',{type:"variable",name:"trk.url_hints",filters:[["band_url",[]],["a",[]]]},'?from=hpbcw" target="_blank">',{type:"variable",name:"trk.artist",filters:[["h",[]]]},"</a>"]},""]},"\n        </p>\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"trk.location_text ",attachment:['\n            <p class="track-loc">\n                ',{type:"variable",name:"trk.location_text",filters:[["h",[]]]},"\n            </p>\n        "]}]},'\n    </div>\n    <div class="collect-item-container disabled">\n        \n        <ul class="collect-item" data-collect-item="',{type:"variable",name:"tralbum_key",filters:[["a",[]]]},'" data-collect-band="',{type:"variable",name:"trk.band_id",filters:[["a",[]]]},'" data-collect-stat="homepage_bcw_wishlist">\n            \n            <li class="item-container buy-now">\n                <a href="',{type:"variable",name:"trk.url_hints",filters:[["tralbum_url",[]],["a",[]]]},'?from=hpbcwbn" class="nav_button nav_button_buy" id="nav_button_buy" target="_blank">',{type:"translate",nodelist:["buy now"]},'</a>\n            </li>\n            <li class="item-container wishlist">\n                <span class="purchased-msg collection-btn">\n                    <a href="',{type:"variable",name:"fan_data.url",filters:[["a",[]]]},'">\n                        <span class="bc-ui2 collect-item-icon"></span><span class="txt">',{type:"translate",nodelist:["you own this"]},'</span>\n                    </a>\n                </span>\n                <span class="wishlist-msg collection-btn" title="',{type:"translate",nodelist:["Add this album to your wishlist"]},'">\n                    <a href="',{type:"ef",blocks:[{type:"ncondition",expression:"!fan_data ",attachment:["/fans?from=hpbcwwlo"]},{type:"else_ncondition",attachment:["#"]}]},'" id="nav_button_collect" target="_blank" class="collect-link">\n                        <span class="bc-ui2 collect-item-icon"></span><span class="txt">',{type:"translate",nodelist:["wishlist"]},'</span>\n                    </a>\n                </span>\n                <span class="wishlisted-msg collection-btn">\n                    <span title="',{type:"translate",nodelist:["Remove this album from your wishlist"]},'">\n                        <a href="#" id="nav_button_uncollect" class="collect-link">\n                            <span class="bc-ui2 collect-item-icon"></span><span class="txt">',{type:"translate",nodelist:["in wishlist"]},'</span>\n                        </a>\n                    </span>\n                </span>\n            </li>\n            <li class="item-container hear-more">\n                <a href="',{type:"variable",name:"trk.url_hints",filters:[["tralbum_url",[]],["a",[]]]},'?from=hpbcwbn" target="_blank">',{type:"translate",nodelist:["hear more"]},"</a>\n            </li>\n        </ul>\n    </div>\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/home_2016/bcweekly_share_phone.liquid","warn"):Templ.register({"home_2016/bcweekly_share_phone":['<ul class="bcweekly-share-panel social-controls" data-url="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/bcweekly/",{type:"variable",name:"show.show_id",filters:[["u",[]],["a",[]]]},'" data-text="',{type:"translate",nodelist:["I’m listening to ",{type:"translateVariable",var_name:"show_title_and_subtitle",nodelist:[{type:"variable",name:"show.title",filters:[["a",[]]]}," &ndash; ",{type:"variable",name:"show.subtitle",filters:[["a",[]]]}]},":"]},'">\n    <li class="facebook-share-ctrl">\n        <a class="facebook-link compound-button">Facebook</a>\n    </li>\n    <li class="twitter-ctrl">\n        <a class="twitter-link compound-button">Twitter</a>\n    </li>\n    <li class="email-ctrl">\n        <a class="email-link compound-button">',{type:"translate",nodelist:["Email"]},"</a>\n    </li>\n</ul>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/home/home_2015/salesfeed_item.liquid","warn"):Templ.register({"home/home_2015/salesfeed_item":['<li class="salesfeed-item col col-2-16">\n    <a class="item-inner',{type:"ef",blocks:[{type:"ncondition",expression:"item.item_type == 'b' ",attachment:[" item-bundle"]}]},'" href="',{type:"variable",name:"item.url",filters:[["a",[]]]},'?from=salesfeed">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"item.item_type == 'b' ",attachment:['\n            <div class="bundle-badge">\n                <div class="number">',{type:"variable",name:"item.releases",filters:[]},'</div>\n                <div class="releases">',{type:"translate",nodelist:["releases"]},'</div>\n                <div class="items">',{type:"translate",nodelist:["items"]},'</div>\n            </div>\n            <div class="bundle-box front"></div>\n            <div class="bundle-box back"></div>\n            <span class="item-img ratio-1-1">\n                <img src="',{type:"variable",name:"item.art_url",filters:[["a",[]]]},'" alt="">\n            </span>\n        ']},{type:"else_ncondition",attachment:['\n            <span class="item-img ratio-1-1">\n                <img src="',{type:"variable",name:"item.art_url",filters:[["a",[]]]},'" alt="">\n            </span>\n        ']}]},'\n        <h5 class="item-title">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"item.item_type == 'b' ",attachment:["\n                ",{type:"translate",nodelist:["Full Discography"]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"variable",name:"item.item_description",filters:[["h",[]]]},"\n            "]}]},"\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"item.album_title && (item.item_type == 'p' || item.item_type == 't') ",attachment:['\n            <span class="album-title">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"item.item_type == 't' ",attachment:["from"]}]}," ",{type:"variable",name:"item.album_title",filters:[["h",[]]]},"\n            </span>\n            "]}]},'\n            <span class="item-artist">',{type:"ef",blocks:[{type:"ncondition",expression:"item.item_type != 'b' ",attachment:[{type:"translate",nodelist:["by ",{type:"translateVariable",var_name:"artist_name",nodelist:[{type:"variable",name:"item.artist_name",filters:[["h",[]]]}]},""]}]},{type:"else_ncondition",attachment:[{type:"variable",name:"item.artist_name",filters:[["h",[]]]}]}]},'</span>\n        </h5>\n        <span class="item-price">',{type:"translate",nodelist:["Sold for ",{type:"translateVariable",var_name:"amount",nodelist:[{type:"variable",name:"item.amount_paid_fmt",filters:[]}]},""]},"  </span>\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"item.amount_over_fmt ",attachment:['\n        <span class="item-over">\n            ',{type:"translate",nodelist:["",{type:"translateVariable",var_name:"amount",nodelist:[{type:"variable",name:"item.amount_over_fmt",filters:[]}]}," more than the min"]},"  \n        </span>\n        "]}]},'\n        <span class="item-loc">\n            ',{type:"translate",nodelist:["in ",{type:"translateVariable",var_name:"country_abbreviation",nodelist:['<span class="flag-icon flag-',{type:"variable",name:"item.country_code",filters:[["h",[]]]},'"></span> ',{type:"variable",name:"item.country",filters:[["h",[]]]}]},""]},'\n        </span>\n        <span class="item-timestamp" data-utc-date="',{type:"variable",name:"item.utc_date_rounded",filters:[["a",[]]]},'">\n            <span class="now">',{type:"ef",blocks:[{type:"ncondition",expression:"item.seconds_since <= 1 ",attachment:[{type:"translate",nodelist:["1 second ago"]}]},{type:"else_ncondition",attachment:[{type:"translate",nodelist:["",{type:"translateVariable",var_name:"seconds",nodelist:[{type:"variable",name:"item.seconds_since",filters:[["h",[]]]}]}," seconds ago"]}]}]},"</span>\n        </span>\n    </a>\n</li>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/home/home_2015/spotlight_content.liquid","warn"):Templ.register({"home/home_2015/spotlight_content":[{type:"for",collection_name:"fnsps",nodelist:["\n",{type:"capture",to:"fan_key",nodelist:[{type:"variable",name:"fnsp.fan_id",filters:[]}]},'\n<div class="spotlight-unit col col-6-12 ',{type:"ef",blocks:[{type:"ncondition",expression:"!fnsp.published_date ",attachment:["unpublished"]}]},' signup-tooltip-parent" data-tooltip-id="o">\n    <div class="row">\n        <div class="col col-4-16">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fnsp.bio_image_id ",attachment:['\n                <a class="spotlight-image" href="',{type:"variable",name:"fnsp.username",filters:[["fan_page_url",[]],["a",[]]]},'">\n                    <span class="ratio-1-1">\n                        <img ',{type:"variable",name:"fnsp.bio_image_id",filters:[["image",["50"]]]},">\n                    </span>\n                </a>\n            "]}]},'\n        </div>\n        <div class="col col-6-16 offset-1-16 spotlight-details">\n            <h4 class="spotlight-name">',{type:"variable",name:"fnsp.name",filters:[["h",[]]]},'</h4>\n            <p class="spotlight-location">',{type:"variable",name:"fnsp.location",filters:[["h",[]]]},'</p>\n            <div class="follow-button-wrapper">\n                <div class="spotlight-button follow-button follow-fan" data-follow-fan="',{type:"variable",name:"fan_key",filters:[["a",[]]]},'" data-fan-name="',{type:"variable",name:"fnsp.name",filters:[["h",[]]]},'" data-follow-stat="homepage_feat_fan_follow">\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"!page_identities.fan || (page_identities.fan.id != fnsp.fan_id) ",attachment:['\n                    <a class="follow-fan-btn" href="',{type:"ef",blocks:[{type:"ncondition",expression:"!page_identities.fan ",attachment:["/fans?from=hpffflo"]},{type:"else_ncondition",attachment:["#"]}]},'">\n                        <span class="follow-msg">Follow</span>\n                        <span class="following-msg">Following</span>\n                    </a>\n                    ']},{type:"else_ncondition",attachment:['\n                    <a href="',{type:"variable",name:"page_identities.fan.url",filters:[["a",[]]]},"\">that's you!</a>\n                    "]}]},'\n                </div>\n                <div class="signup-tooltip-outer fan-follow-tooltip-outer"></div>\n            </div>\n        </div>\n        <div class="col col-5-16">\n            <p class="spotlight-bio">\n                ',{type:"variable",name:"fnsp.bio",filters:[["html_autolink",["'target=\"_blank\"'"]],["newline_to_gap",[]]]},'\n            </p>\n            <a class="spotlight-link" href="',{type:"variable",name:"fnsp.username",filters:[["fan_page_url",[]],["a",[]]]},'">view full profile</a>\n        </div>\n    </div>\n\n    <div class="spotlight-items row">\n        ',{type:"for",collection_name:"fnsp.items",nodelist:["\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"fnit.item_type == 'a' ",attachment:["\n                ",{type:"let",variable:"tralbum_type",expression:'"album" '},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"let",variable:"tralbum_type",expression:'"track" '},"\n            "]}]},"\n            ",{type:"capture",to:"tralbum_key",nodelist:[{type:"variable",name:"fnit.item_type",filters:[]},{type:"variable",name:"fnit.item_id",filters:[]}]},'\n\n            <div class="spotlight-item row playable-hover-target">\n                <div class="col col-4-16">\n                    <a class="item-img playable ratio-1-1" href="',{type:"variable",name:"fnit.url_hints",filters:[["tralbum_url",[]],["a",[]]]},'?from=hpff" data-fanid="',{type:"variable",name:"fnsp.fan_id",filters:[["a",[]]]},'" data-subitem-index="',{type:"variable",name:"forloop.index0",filters:[["a",[]]]},'">\n                        <img ',{type:"variable",name:"fnit.art_id",filters:[["art",["'art_embedded_player_large'"]]]},' alt="">\n                        <span class="plb-btn">\n                            <span class="plb-bg"></span>\n                            <span class="plb-ic"></span>\n                        </span>\n                        <span class="hidden-access">play ',{type:"variable",name:"tralbum_type",filters:[["h",[]]]},'</span>\n                    </a>\n                </div>\n                <div class="col col-11-16 offset-1-16">\n                    <a class="item-link" href="',{type:"variable",name:"fnit.url_hints",filters:[["tralbum_url",[]],["a",[]]]},'?from=hpff">\n                        <span class="item-title">\n                            ',{type:"variable",name:"fnit.title",filters:[["h",[]]]},'\n                        </span>\n                        <span class="item-artist">\n                            by ',{type:"variable",name:"fnit.artist_name",filters:[["h",[]]]},'\n                        </span>\n                    </a>\n                    <p class="item-desc">\n                        ',{type:"variable",name:"fnit.comment",filters:[["html_autolink",["'target=\"_blank\"'"]],["newline_to_gap",[]]]},'\n                    </p>\n                    <ul class="item-collection-controls horizontal-list collect-item ',{type:"ef",blocks:[{type:"ncondition",expression:"!page_identities.fan ",attachment:["logged-out"]}]},'" data-collect-item="',{type:"variable",name:"tralbum_key",filters:[["h",[]]]},'" data-collect-band="',{type:"variable",name:"fnit.band_id",filters:[["h",[]]]},'" data-collect-stat="homepage_feat_fan_wishlist',{type:"ef",blocks:[{type:"ncondition",expression:"!page_identities.fan ",attachment:["_lo"]}]},'" ',{type:"ef",blocks:[{type:"ncondition",expression:"!page_identities.fan ",attachment:['data-lo-querystr="',{type:"variable",name:"fnit.lo_querystr",filters:[["a",[]]]},'" data-lo-from="hpffwlo"']}]},'>\n                        <li class="buy-now">\n                            <a href="',{type:"variable",name:"fnit.url_hints",filters:[["tralbum_url",[]],["a",[]]]},'?from=hpffbn">buy now</a>\n                        </li>\n                        <li class="purchased-msg collection-btn">\n                            <a href="',{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.fan ",attachment:[{type:"variable",name:"page_identities.fan.url",filters:[["a",[]]]}]}]},'">\n                                <span class="bc-ui2 collect-item-icon"></span><span class="txt">you own this</span>\n                            </a>\n                        </li>\n                        <li class="wishlist-msg collection-btn" title="Add this ',{type:"variable",name:"tralbum_type",filters:[["a",[]]]},' to your wishlist">\n                            <a href="#">\n                                <span class="bc-ui2 collect-item-icon"></span><span class="txt">wishlist</span>\n                            </a>\n                        </li>\n                        <li class="wishlisted-msg collection-btn">\n                            <a href="#" title="Remove this album from your wishlist">\n                                <span class="bc-ui2 collect-item-icon"></span><span class="txt">in wishlist</span>\n                            </a>\n                            <a class="view" href="',{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.fan ",attachment:[{type:"variable",name:"page_identities.fan.url",filters:[["a",[]]]},"/wishlist"]}]},'" title="View your wishlist">»</a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        '],variable_name:"fnit",reversed:null,attribs:{limit:3}},"\n    </div>\n</div>\n"],variable_name:"fnsp",reversed:null,attribs:{limit:2}},"\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/fan_action_panel.liquid","warn"):Templ.register({"fan/fan_action_panel":['\n<div class="login-dlg">\n    <div id="wishlist-message">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"is_band_member ",attachment:["\n            ",{type:"ef",blocks:[{type:"ncondition",expression:'action == "wishlist" ',attachment:["\n                ",{type:"translate",nodelist:["Wishlisting requires a Bandcamp fan account. <a ",{type:"translateVariable",var_name:"link",nodelist:['href="',{type:"variable",name:"signupUrl",filters:[["a",[]]]},'"']},">Learn more</a>."]},"\n            "]},{type:"ncondition",expression:'action == "follow" ',attachment:["\n                ",{type:"translate",nodelist:["Following requires a Bandcamp fan account. <a ",{type:"translateVariable",var_name:"link",nodelist:['href="',{type:"variable",name:"signupUrl",filters:[["a",[]]]},'"']},">Learn more</a>."]},"\n            "]}]},"\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"ef",blocks:[{type:"ncondition",expression:'action == "wishlist" ',attachment:["\n                ",{type:"translate",nodelist:["Wishlisting requires a Bandcamp fan account. Please <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="',{type:"variable",name:"loginUrl",filters:[["a",[]]]},'"']},">log in</a> or <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="',{type:"variable",name:"signupUrl",filters:[["a",[]]]},'"']},">learn more</a>."]},"\n            "]},{type:"ncondition",expression:'action == "follow" ',attachment:["\n                ",{type:"translate",nodelist:["Following requires a Bandcamp fan account. Please <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="',{type:"variable",name:"loginUrl",filters:[["a",[]]]},'"']},">log in</a> or <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="',{type:"variable",name:"signupUrl",filters:[["a",[]]]},'"']},">learn more</a>."]},"\n            "]}]},"\n        "]}]},"\n    </div>\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/home/home_2015/discover_inline_player.liquid","warn"):Templ.register({"home/home_2015/discover_inline_player":['<table>\n    <tr>\n        <td class="play_cell" rowspan="2">\n            <a><div class="playbutton"></div></a>\n        </td>\n        <td class="track_cell" colspan="3">\n            <div class="track_info">\n                <span class="title-section hiddenelem">\n                    <a class="title_link primaryText" href="#"><span class="title"></span></a>\n                </span>\n                <span class="time secondaryText hiddenelem">\n                    <span class="time_elapsed"></span>\n                    /\n                    <span class="time_total"></span>\n                </span>\n                <span class="message hiddenelem"></span>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td class="progbar_cell" colspan="3">\n            <div class="progbar">\n                <div class="progbar_empty">\n                    <div class="progbar_fill"></div>\n                    <div class="thumb"></div>\n                </div>\n            </div>\n        </td>\n    </tr>\n</table>\n']}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/_autocomplete_responsive_widget.liquid","warn"):Templ.register({_autocomplete_responsive_widget:['<form aria-label="autocomplete search" class="menubar-search signup-tooltip-parent" action="/search" method="get" data-tooltip-id="s" aria-busy="false">\n  <input tabindex="0" aria-autocomplete="list" class="dismiss-tooltip-alt search-bar" type="text" name="q" placeholder="',{type:"translate",nodelist:["Search for artist, album, or track"]},'" autocomplete="off" maxlength="2048">\n    <div role="progressbar" class="loading-icon" id="search-loading-icon" aria-busy="false">\n        <svg aria-label="loading icon" class="search-spinner" width="15" height="16" viewBox="-1 -1 16 16">\n            <use href="#search-spinner"></use>\n        </svg>\n    </div>\n    <div aria-label="clear search" class="clear-autocomplete" >×</div>\n  </input>\n  <input type="hidden" class="selected-filter" name="item_type" value="" />\n  <button type="submit" tabindex="-1" aria-label="',{type:"translate",nodelist:["submit for full search page"]},'" class="menubar-search-icon"><svg width="15" height="16" viewBox="0 0 15 16"><use href="#menubar-search-input-icon" /></svg></button>\n  <ul role="listbox" class="genre-list" aria-busy="false"></ul>\n  <ul class="filter-list" aria-busy="false"></ul>\n  <ul role="listbox" class="search-autocomplete" aria-busy="false">\n    \n    <li class="simple results-see-all">\n      <a tabindex="-1" aria-label="visit full-search page">\n        <span>',{type:"translate",nodelist:["See all results"]},'</span>\n        <span><svg class="arrow" viewBox="0 0 24 24"><use href="#discover-arrow"></svg></span>\n      </a>\n    </li>\n    <li class="simple results-tags">\n      <a tabindex="-1" >\n        <span class="msg"></span>\n        <span><svg class="arrow" viewBox="0 0 24 24"><use href="#discover-arrow"></svg></span>\n      </a>\n    </li>\n    <li class="simple results-genre">\n      <a tabindex="-1">\n        <span class="msg"></span>\n        <span><svg class="arrow" viewBox="0 0 24 24"><use href="#discover-arrow"></svg></span>\n      </a>\n    </li>\n    <li aria-label="no matching results" class="autocomplete-no-results" >\n      <p class="noresults-header">',{type:"translate",nodelist:["No matching results"]},'</p>\n      <p class="noresults-text">',{type:"translate",nodelist:["Try a different filter or a new search keyword."]},'</p>\n      <div class="tumbleweed">\n        <img src="/img/search/tumbleweed-emptystate-lightbg.gif"/>\n      </div>\n    </li>\n  </ul>\n  <li class="simple mobile-results-tags no-show">\n    <a>\n      <span class="msg"></span>\n      <span><svg class="arrow" viewBox="0 0 24 24"><use href="#discover-arrow"></svg></span>\n    </a>\n  </li>\n  <div class="mobile-placeholder">\n      <p>',{type:"translate",nodelist:["Search all Bandcamp artists, tracks, and albums"]},'</p>\n  </div>\n  <template id="autocomplete-results-item"><li class="result-item">\n    <a tabindex="-1">\n      <span class="result-art"><img></span>\n      <span class="result-info">\n        <div class="result-title"><strong></strong></div>\n        <cite></cite>\n        <div class="result-type"></div>\n      </span>\n    </a>\n  </li></template>\n  <div class="signup-tooltip-outer search-tooltip-outer header-2018"></div>\n</form>\n<div aria-label="cancel search" class="cancel-autocomplete" >',{type:"translate",nodelist:["cancel"]},"</div>"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/home/header_2015.liquid","warn"):Templ.register({"home/header_2015":['<div class="hd ',{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:["header-rework-2018 ",{type:"ef",blocks:[{type:"ncondition",expression:"!page_identities.user ",attachment:["banner-lo"]}]}]}]}," row ",{type:"ef",blocks:[{type:"ncondition",expression:"identities.user && user_type ",attachment:["logged-in"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"!is_client_render ",attachment:["tooltips-hidden"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:["corp-home"]}]},'">\n    <div class="row">\n        <div class="col col-7-12">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"!cfg.header_rework_2018 ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:['\n                    <h1 class="hd-logo"><span>Bandcamp</span></h1>\n                ']},{type:"else_ncondition",attachment:['\n                    <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'"><h1 class="hd-logo"><span>Bandcamp</span></h1></a>\n                ']}]},'\n                <h2 class="hd-sub-head">',{type:"translate",nodelist:["Discover amazing new music and directly support the artists who make it."]},"</h2>\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:['\n                    <h1 class="corp-bclogo" data-test="mb-bandcamp-logo"><svg width="137px" height="22px" viewBox="0 0 127 20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#bandcamp-logo-color-bcaqua">Bandcamp</use></svg></h1>\n                ']},{type:"else_ncondition",attachment:['\n                    <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'">\n                        <h1 class="corp-bclogo" data-test="mb-bandcamp-logo"><svg width="137px" height="22px" viewBox="0 0 127 20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#bandcamp-logo-color-bcaqua">Bandcamp</use></svg>\n                        </h1>\n                    </a>\n                ']}]},'\n                <h2 class="hd-sub-head ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">',{type:"translate",nodelist:["Discover amazing new music and <a ",{type:"translateVariable",var_name:"link",nodelist:['class="blue-gradient" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/fair_trade_music_policy"']},">directly support</a> the artists who make it."]},"</h2>\n            "]}]},"\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"identities.user && user_type ",attachment:['\n            <ul class="hd-nav user-nav">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"user_photo ",attachment:['\n                <li class="user-nav-thumb">\n                    <span class="user-nav-thumb">\n                        <img ',{type:"variable",name:"user_photo",filters:[["image",["'bio_navbar'"]]]},">\n                    </span>\n                </li>\n                "]}]},'\n                <li class="name">\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_name ",attachment:["\n                        ",{type:"translate",nodelist:["Hi ",{type:"translateVariable",var_name:"name",nodelist:[{type:"variable",name:"fan_name",filters:[["h",[]]]}]},""]},"\n                    "]},{type:"else_ncondition",attachment:["\n                        ",{type:"translate",nodelist:["Hi ",{type:"translateVariable",var_name:"name",nodelist:[{type:"variable",name:"user_name",filters:[["h",[]]]}]},""]},"\n                    "]}]},"\n                </li>\n\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"collection_url && !identities.fan.private ",attachment:['\n                    <li class="signup-tooltip-parent" data-tooltip-id="f">\n                        <a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'/feed">',{type:"translate",nodelist:["feed"]},'</a>\n                        <div class="signup-tooltip-outer feed-tooltip-outer"></div>\n                    </li>\n\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"has_wishlist && !has_collection ",attachment:['\n                        <li class="signup-tooltip-parent" data-tooltip-id="w">\n                            <a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'/wishlist">',{type:"translate",nodelist:["wishlist"]},'</a>\n                            <div class="signup-tooltip-outer wishlist-tooltip-outer"></div>\n                        </li>\n                    ']},{type:"ncondition",expression:"has_wishlist ",attachment:['\n                        <li class="signup-tooltip-parent" data-tooltip-id="c">\n                            <a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'">',{type:"translate",nodelist:["collection"]},'</a>\n                            <div class="signup-tooltip-outer collection-tooltip-outer"></div>\n                        </li>\n                        <li class="signup-tooltip-parent" data-tooltip-id="w">\n                            <a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'/wishlist">',{type:"translate",nodelist:["wishlist"]},'</a>\n                            <div class="signup-tooltip-outer wishlist-tooltip-outer"></div>\n                        </li>\n                    ']},{type:"else_ncondition",attachment:['\n                        <li class="signup-tooltip-parent" data-tooltip-id="c">\n                            <a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'">',{type:"translate",nodelist:["collection"]},'</a>\n                            <div class="signup-tooltip-outer collection-tooltip-outer"></div>\n                        </li>\n                    ']}]},"\n                "]}]},"\n\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"band_url ",attachment:['\n                <li><a href="',{type:"variable",name:"band_url",filters:[["a",[]]]},'">your site</a></li>\n                ']},{type:"ncondition",expression:"partner_url ",attachment:['\n                <li><a href="',{type:"variable",name:"partner_url",filters:[["a",[]]]},'">your page</a></li>\n                ']}]},"\n\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:['\n                <li class="cartitem">\n                    <a href="/cart" rel="nofollow">\n                        <span class="cart bc-home">&nbsp;</span>\n                        <span class="cart-item-count">',{type:"variable",name:"cart_quantity",filters:[]},"</span>\n                    </a>\n                </li>\n                "]}]},"\n\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"gift_card_balance ",attachment:["\n                    ",{type:"let",variable:"hide_gift_card_balance",expression:"!cfg.header_rework_2018 && (band_url || partner_url) && collection_url "},"\n                    ",{type:"include",template_name:"'home/header_gift_balance'"},"\n                "]}]},"\n            </ul>\n            "]}]},'\n        </div>\n        <div id="corphome-autocomplete-form" class="searchwidget col col-5-12" data-test="mb-search-box">\n            ',{type:"include",template_name:"'_autocomplete_responsive_widget'"},'\n            <ul class="hd-nav corp-nav ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"!cfg.header_rework_2018 ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"cfg.gift_cards ",attachment:['\n                <li>\n                    <a class="gift-cards-link" href="/gift_cards?from=header">',{type:"translate",nodelist:["gift cards"]},"</a>\n                </li>\n                "]}]},'\n                <li class="signup-tooltip-parent" data-tooltip-id="d">\n                    <a class="discover-link" href="/#discover">',{type:"translate",nodelist:["discover"]},'</a>\n                    <div class="signup-tooltip-outer discover-tooltip-outer"></div>\n                </li>\n                ']}]},"\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"has_cart && !identities.user ",attachment:['\n                <li class="menubar-item cart-wrapper-corp-lo svg-icon" data-test="mb-cart">\n                    <a href="/cart" rel="nofollow">\n                        <svg width="26" height="26" class="menubar-cart-icon">\n                            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menubar-cart-icon"></use>                    \n                            <text x="15" y="12" dominant-baseline="middle" text-anchor="middle">\n                                ',{type:"variable",name:"cart_quantity",filters:[["h",[]]]},"\n                            </text>\n                        </svg>\n                    </a>\n                </li>\n                "]}]},"\n                "]}]},"\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"!identities.user ",attachment:['\n                <li data-test="mb-signup"><a href="#" class="all-signup-link">',{type:"translate",nodelist:["sign up"]},"</a></li>\n                "]}]},"\n                \n                ",{type:"ef",blocks:[{type:"ncondition",expression:"identities.user && user_type ",attachment:['\n                <li class="log-out-link"><a class="logout-action" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/logout",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:["?corp_home=1"]}]},'" ',{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:['data-logout-override="corp_home"']}]},">",{type:"translate",nodelist:["log out"]},"</a></li>\n                "]}]},'\n                <li class="log-in-link" data-test="mb-login"><a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/login",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:["?from=home"]}]},'">',{type:"translate",nodelist:["log in"]},"</a></li>\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"has_cart && !identities.user && !cfg.header_rework_2018 ",attachment:['\n                <li class="cartitem">\n                    <a href="/cart" rel="nofollow">\n                        <span class="cart bc-home">&nbsp;</span>\n                        <span class="cart-item-count">',{type:"variable",name:"cart_quantity",filters:[]},"</span>\n                    </a>\n                </li>\n                "]}]},"\n            </ul>\n        </div>\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"has_corp_header && !is_gift_cards_page && holiday_gc_link ",attachment:['\n            <div class="hd-banner-2018 holiday-gc-link ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">\n                <a class="hd-banner-2018-inner blue-gradient" href="/gift_cards?from=header">',{type:"translate",nodelist:["Bandcamp Gift Cards"]},"</a>\n            </div>\n        "]},{type:"ncondition",expression:"has_corp_header && corp_hiring_banner_text && !is_jobs_page ",attachment:['\n            <div class="hd-banner-2018 wide ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">\n                <a class="hd-banner-2018-inner blue-gradient" href="/jobs">',{type:"variable",name:"corp_hiring_banner_text",filters:[["h",[]]]},'</a>\n            </div>\n            \n            <div class="hd-banner-2018 small ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">\n                <a class="hd-banner-2018-inner blue-gradient" href="/jobs">',{type:"translate",nodelist:["We’re hiring!"]},"</a>\n            </div>\n        "]}]},"\n\n    </div>\n\n    <div class='corp-banners'>\n        ",{type:"let",variable:"is_unverified_fan",expression:"identities.fan && !identities.fan.verified && !identities.fan.private "},"\n        ",{type:"let",variable:"show_verify_banner",expression:"fan_onboarding.show_verify_banner && is_unverified_fan && !skip_verification_banner "},"\n        ",{type:"let",variable:"verify_email",expression:"fan_onboarding.email "},"\n        ",{type:"include",template_name:"'home_2016/fan_verify_banner'"},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"show_rock_the_vote_banner && !show_verify_banner ",attachment:["\n            ",{type:"include",template_name:"'rock_the_vote_banner'"},"\n        "]}]},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"show_tos_banner && !show_verify_banner ",attachment:["\n            ",{type:"include",template_name:"'tos_update_banner'"},"\n        "]}]},"\n    </div>\n</div>\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"!cfg.header_rework_2018 ",attachment:['\n<div class="hd-mobile row ',{type:"ef",blocks:[{type:"ncondition",expression:"identities.user && user_type ",attachment:["logged-in"]}]},'">    \n\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:['\n        <h1 class="hd-logo"><span>Bandcamp</span></h1>\n    ']},{type:"else_ncondition",attachment:['\n        <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'"><h1 class="hd-logo"><span>Bandcamp</span></h1></a>\n    ']}]},"\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"identities.user && user_type ",attachment:['\n    <ul class="hd-nav user-nav">\n\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"gift_card_balance ",attachment:["\n            ",{type:"let",variable:"hide_gift_card_balance",expression:"!cfg.header_rework_2018 && (band_url || partner_url) && collection_url "},"\n            ",{type:"include",template_name:"'home/header_gift_balance'"},"\n        "]},{type:"ncondition",expression:"!cfg.header_rework_2018 && cfg.gift_cards && ((collection_url && !identities.fan.private) || band_url || partner_url) ",attachment:['\n            <li><a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/gift_cards">',{type:"translate",nodelist:["gift cards"]},"</a></li>\n        "]}]},"\n\n                \n        \n        ",{type:"ef",blocks:[{type:"ncondition",expression:"collection_url && !identities.fan.private ",attachment:['\n        <li><a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'">',{type:"translate",nodelist:["collection"]},"</a></li>\n        "]}]},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"band_url ",attachment:['\n        <li><a href="',{type:"variable",name:"band_url",filters:[["a",[]]]},'">your site</a></li>\n        ']},{type:"ncondition",expression:"partner_url ",attachment:['\n        <li><a href="',{type:"variable",name:"partner_url",filters:[["a",[]]]},'">your page</a></li>\n        ']}]},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:['\n        <li>\n            <a class="home-cartitem" href="/cart" rel="nofollow">\n                <span class="cart bc-home"></span>\n                <span class="cart-item-count">',{type:"variable",name:"cart_quantity",filters:[]},"</span>\n            </a>\n        </li>\n        "]}]},"\n\n    </ul>\n    "]},{type:"else_ncondition",attachment:['\n    <ul class="hd-nav corp-nav ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">\n       <li>\n       <ul>\n            \n            ',{type:"ef",blocks:[{type:"ncondition",expression:"!has_cart ",attachment:['<li><span class="corp-nav-label">for:</span></li>']}]},'\n            <li><a href="/artists?from=hpartists">',{type:"translate",nodelist:["artists"]},'</a></li>\n            <li><a href="/fans?from=hpfans">',{type:"translate",nodelist:["fans"]},'</a></li>\n            <li><a href="/labels?from=hplabels">',{type:"translate",nodelist:["labels"]},'</a></li>\n        </ul>\n        </li>\n        <li class="log-in-link"><a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/login",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:["?from=home"]}]},'">',{type:"translate",nodelist:["log in"]},"</a></li>\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:['\n        <li>\n            <a class="home-cartitem" href="/cart" rel="nofollow">\n                <span class="cart bc-home"></span>\n                <span class="cart-item-count">',{type:"variable",name:"cart_quantity",filters:[]},"</span>\n            </a>\n        </li>\n        "]}]},"\n    </ul>\n    "]}]},'\n    <form class="searchwidget" action="/search" method="get">\n        <input name="q" type="text" placeholder="',{type:"translate",nodelist:["Search for artist, track or album"]},'" tabindex="0" autocomplete="off" maxlength="2048">\n        <input type="hidden" name="from" value="corphome">\n        <input type="hidden" name="item_type" data-bind="value: AutocompleteVM.currentFilter">\n        <button type="submit"><span class="icon bc-home"></span>',{type:"translate",nodelist:["Search"]},"</button>\n    </form>\n    <div class='corp-banners'>\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"show_rock_the_vote_banner && !show_verify_banner && is_corp_home ",attachment:["\n        ",{type:"include",template_name:"'rock_the_vote_banner'"},"\n        "]}]},"\n    </div>\n</div>\n"]},{type:"ncondition",expression:"show_header_2015 && !is_phone ",attachment:["\n    ",{type:"include",template_name:"'menubar_phone'"},"\n"]}]},"\n"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/password_change_banner.liquid","warn"):Templ.register({password_change_banner:['<div class="corpbanner forget-password" ',{type:"ef",blocks:[{type:"ncondition",expression:"cc_menubar || !show_forget_password_banner ",attachment:['style="display: none;"']}]},'>\n    <div class="text">\n        ',{type:"translate",nodelist:["To improve the security of your account, we are requiring you to <a ",{type:"translateVariable",var_name:"href",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/settings?pane=profile"']},">choose a new password.</a>"]},"\n    </div>\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/rock_the_vote_banner.liquid","warn"):Templ.register({rock_the_vote_banner:['<div class="corpbanner rock-the-vote">\n    <div class="vote-logo-container">\n        <a href="https://bandcamp.com/vote">\n        <img class="vote-logo" src="/img/icon-vote-bandcamp.png"></img>\n        </a>\n    </div>\n    <div class="text">\n        Today is election day! Do you know where to vote? <a href="https://www.rockthevote.org/voting-information/find-your-polling-place">Find out here</a>.\n    </div>\n\n    <a class="dismiss-banner" id="dismiss-rock-the-vote-notification" href="#">\n        <span class="ui-icon dismiss-icon"></span>\n    </a>\n</div>\n']}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_app_download_banner.liquid","warn"):Templ.register({"fan/signup/fan_app_download_banner":['<div id=\'fan-app-download-banner-vm\' class="corpbanner fan-app-download">\n    <a class="dismiss-banner col" id="dismiss-fan-app-download-banner" href="#"\n        data-bind="click: dismissBanner">\n        <span class="ui-icon dismiss-icon"></span>\n    </a>\n    <div class="app-icon-container col">\n        <img class="app-icon" src="/img/app-icon-fanapp-ios.png"></img>\n    </div>\n    <div class="text col">\n        <div class=\'row title\'>Bandcamp</div>\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"isAppInstalled ",attachment:["\n            <div class='row'>",{type:"translate",nodelist:["Installed on your device"]},"</div>\n        "]},{type:"else_ncondition",attachment:["\n            <div class='row'>",{type:"translate",nodelist:["Free in the App Store"]},"</div>\n        "]}]},'\n    </div>\n    <a href="',{type:"variable",name:"redirectToAppURL",filters:[["h",[]]]},"\">\n        <button class='col'>\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"isAppInstalled ",attachment:["\n                <span>",{type:"translate",nodelist:["OPEN"]},"</span>\n            "]},{type:"else_ncondition",attachment:["\n                <span>",{type:"translate",nodelist:["GET"]},"</span>\n            "]}]},"\n        </button>\n    </a>\n\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/home/header_gift_balance.liquid","warn"):Templ.register({"home/header_gift_balance":['<li>\n    <a class="gift-balance-link" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/redeem">\n        <svg class="icon gift-card-icon-bordered" width="9px" height="10px" viewBox="0 0 9 10"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#gift-card-icon"></use></svg>\n        <span class="all-balances" ',{type:"ef",blocks:[{type:"ncondition",expression:"hide_gift_card_balance ",attachment:[' style="display: none;" ']}]},'>\n            <span class="gift-card-balance">',{type:"variable",name:"gift_card_balance",filters:[["money",["1"]],["h",[]]]}," ",{type:"variable",name:"gift_card_balance.currency",filters:[["h",[]]]},"</span>\n        </span>\n    </a>\n</li>"]});var FanControls={Data:null,start:function(e){FanControls._started||(FanControls._started=!0,FanControls._cfg=U.pagedataBlob().cfg||{},FanControls._identities=U.pagedataBlob().identities,FanControls._isFan=!!Identities.fan(),e?FanControls.data=e:FanControls.getData())},getData:function(){const e=$.Deferred();if(Log.debug("FanControls.getData: data is "+(FanControls.Data?"present":"not yet present")),FanControls.Data)e.resolve(FanControls.Data);else{if(FanControls._data_promise)return FanControls._data_promise;FanControls._data_promise=e.promise(),FanControls._isFan?$.ajax({type:"GET",url:"/api/fan/2/collection_summary",dataType:"json"}).then((function(t){Log.debug("FanControls.getData: xhr finished"),FanControls.Data=t,FanControls._data_promise=null,e.resolve(t)})):(FanControls._data_promise=null,e.reject())}return e.promise()},attach:function(e){$(e).find(".wishlist-msg, .wishlisted-msg").click(FanControls.wishlist_click),$(e).find(".follow-fan").click(FanControls.followfan_click)},delegate:function(e){$(e).on("click",".collect-item .wishlist-msg, .collect-item .wishlisted-msg",FanControls.wishlist_click),$(e).on("click",".follow-fan",FanControls.followfan_click),$(e).on("mouseenter mouseleave",".following",(function(e){"mouseenter"==e.type?$(".following-msg",this).html(TM("Unfollow")):"mouseleave"==e.type&&$(".following-msg",this).html(TM("Following"))}))},wishlist_click:function(e){if(e.target&&$(e.target).hasClass("view"))return;const t=FanControls.findContainer(this,"collect-item");if(!Identities.fan()||Identities.fan()&&!Identities.fan().verified&&!t.hasClass("wishlisted"))return e.preventDefault(),void FanControls.signup_or_verify_wishlist_click(t);t&&t.hasClass("disabled")?e.preventDefault():FanControls._isFan&&FanControls.getData().then((function(){if(e.preventDefault(),!FanControls.Data)return void Log.debug("no FanControls.Data, why are we here?");const n=FanControls.collectParams(t);if(!n)return void Log.debug("bad tralbum data on wishlist control");if(!FanControls.Data||FanControls.Data.read_only)return void NuDialog.alert("Unavailable","Oops! Wishlists are currently unavailable. Please try again later.");const a=t.hasClass("wishlisted"),i=t.attr("data-collect-stat");if(!a&&i&&Stats.record({kind:"click",click:i}),!FanControls.Data.fan_id)return void NuDialog.alertHTML("Login Required","Please <a href='"+Text.escapeHtml(siteroot_https)+"/login'>log in</a> to wishlist this "+("a"==n.item_type?"album":"track")+". Don't have a fan account yet? <a target='_blank' href='/fans'>Learn more</a>.");const s=FanControls.matchingContainers(t,"collect-item","collect-item");s.toggleClass("wishlisted"),FanControls.toggleItem(n);if(FanControls.doPost(a?"/uncollect_item_cb":"/collect_item_cb",n,(function(e){e.ok?Log.note("item "+(a?"removed":"added")+" from wishlist"):(s.toggleClass("wishlisted"),FanControls.toggleItem(n))})),!a){if($("#pagedata").data("blob").is_corp_home&&window.FanOnboarding&&window.FanOnboarding.showFirstWishlistTooltip&&0===$(".signup-tooltip-parent.show-tooltip").length&&"phone"!==MediaView.mode){window.FanOnboarding.setFirstWishlistedItem(n.item_title,n.item_type);const e=$("#pagedata").data("blob").identities;window.SignupUtils.renderHeader(FanControls.identities,{has_collection:window.FanOnboarding.hasCollection,user_type:"fan",fan_name:e.fan.name,collection_url:e.fan.url,band_url:Identities.bmgr.bands().length>0?Identities.bmgr.bands()[0].trackpipeUrl():null},{action:"wishlist"}),window.FanOnboarding.showTooltip("w"),$("body").removeClass("scroll-detected"),$("body").addClass("prevent-header-hiding"),window.FanOnboarding.showFirstWishlistTooltip=!1}}}))},signup_or_verify_wishlist_click:function(e){const t=e.data("lo-querystr")||"",n=e.data("lo-from"),a=this.collectParams(e);a&&FanAction.doAction("wishlist",t,n,a.item_id,a.item_type,a.band_id,a)},followfan_click:function(e){const t=FanControls.findContainer(this,"follow-fan");if(t.hasClass("disabled"))return void e.preventDefault();if(!(Identities.fan()&&Identities.fan().verified||t.hasClass("following")))return e.preventDefault(),void FanControls.signup_or_verify_followfan_click(t);if(!FanControls._isFan)return;const n=$(e.target).closest("a").attr("href");if("#"!==n&&-1===n.indexOf("/fans"))return;if(e.preventDefault(),!FanControls.Data)return void Log.debug("no FanControls.Data, why are we here?");const a=FanControls.followFanParams(t);if(!a)return void Log.debug("bad fan data on follow-fan control");if(!FanControls.Data||FanControls.Data.read_only)return void NuDialog.alert("Unavailable","Oops! Wishlists are currently unavailable. Please try again later.");const i=t.hasClass("following"),s=t.attr("data-follow-stat");if(!i&&s&&Stats.record({kind:"click",click:s}),!FanControls.Data.fan_id)return void NuDialog.alertHTML("Login Required","Please <a href='"+Text.escapeHtml(siteroot_https)+"/login'>log in</a> to follow this fan. Don't have a fan account yet? <a target='_blank' href='/fans'>Learn more</a>.");const o=FanControls.matchingContainers(t,"follow-fan","follow-fan");o.toggleClass("following"),FanControls.toggleFan(a);FanControls.doPost("/fan_follow_cb",a,(function(e){1==e.ok?(Log.note("fan "+(i?"removed":"added")+" from follows"),$("body").trigger("fan_"+(i?"unfollow":"follow")+"ed",[a.follow_id])):(o.toggleClass("following"),FanControls.toggleFan(a))}))},signup_or_verify_followfan_click:function(e){const t=this.followFanParams(e);t&&FanAction.doAction("follow",null,null,t.follow_id,"f",null,t)},doPost:function(e,t,n){Url.isCustomDomain()&&(e=siteroot_current+e),Crumb.ajax({type:"POST",url:e,data:t,dataType:Url.isCustomDomain()&&!$.support.cors?"jsonp":"json",xhrFields:{withCredentials:!0},success:function(e){n(e),!0===e.ok?Log.debug("XHR form submission succeeded with data",e):Log.error("XHR POST returned error JSON",e)},error:function(e,t,n){Log.error("XHR POST failed",e,t,n)}})},findContainer:function(e,t){return container=$(e).closest("."+t),0==container.length?(Log.debug("missing fan-controls container"),null):container},matchingContainers:function(e,t,n){return $("."+t+"[data-"+n+"="+e.attr("data-"+n)+"]")},getTralbumLookup:function(e){return FanControls.Data&&FanControls.Data.collection_summary&&FanControls.Data.collection_summary.tralbum_lookup?FanControls.Data.collection_summary.tralbum_lookup[e]:null},isFollowedFan:function(e){if(!(FanControls.Data&&FanControls.Data.collection_summary&&FanControls.Data.collection_summary.follows&&FanControls.Data.collection_summary.follows.following))return null;return(FanControls.Data.collection_summary.follows.following||{})[e]},setTralbumLookup:function(e,t){FanControls.Data&&FanControls.Data.collection_summary&&FanControls.Data.collection_summary.tralbum_lookup||Log.error("attempting to set tralbum lookup with no data!"),FanControls.Data.collection_summary.tralbum_lookup[e]=t},initializeItems:function(e){const t=$(e||document);if(!FanControls._isFan)return t.find(".collect-item").removeClass("disabled"),void t.find(".follow-button").removeClass("disabled");Log.debug("FanControls.initializeItems getting data"),FanControls.getData().then((function(e){Log.debug("FanControls.initializeItems got data, doing some stuff");const n=e&&e.collection_summary,a=n&&n.tralbum_lookup,i=n&&n.follows&&n.follows.following;a?t.find(".collect-item").each((function(e,t){const n=$(t),i=n.attr("data-collect-item"),s=a[i];s?s.purchased?(n.addClass("purchased"),n.removeClass("wishlisted")):(n.addClass("wishlisted"),n.removeClass("purchased")):n.removeClass("purchased").removeClass("wishlisted"),n.removeClass("disabled")})):Log.error("trying to render fan state but collection_summary data not found. Data:",e),i?t.find(".follow-button").each((function(e,t){const n=$(t),a=n.data("follow-fan");i[a]?n.addClass("following"):n.removeClass("following"),n.removeClass("disabled")})):Log.error("trying to render fan state but following data not found.  Data:",e)}))},toggleItem:function(e){if(!FanControls.Data||FanControls.Data.read_only)return;const t=e.item_type+e.item_id,n=FanControls.getTralbumLookup(t);n?n.purchased||FanControls.setTralbumLookup(t,null):FanControls.setTralbumLookup(t,{item_type:e.item_type,item_id:e.item_id,band_id:e.band_id,purchased:null})},toggleFan:function(e){if(!FanControls.Data||FanControls.Data.read_only)return;const t=e.follow_id.toString(),n=FanControls.Data.collection_summary.follows.following,a=n[t];n[t]=!a||null},collectParams:function(e){if(!e)return null;const t=FanControls.Data?FanControls.Data.fan_id:null,n=e.attr("data-collect-band"),a=e.attr("data-collect-item")||"",i=e.attr("data-booyakasha-user")||null,s=a.substr(0,1),o=parseInt(a.substr(1)),l=e.attr("data-collect-context")||null,r=e.attr("data-ref-hint")||null,c=e.attr("data-collect-stat")||null,d=e.attr("data-collect-title")||null;if(isNaN(o))return Log.debug("bad or missing item spec for collect controls: "+a),null;const u={fan_id:t,item_id:o,item_type:s,band_id:n,context:l};return r&&(u.ref_hint=r),d&&(u.item_title=d),window.ReferrerToken&&(u.ref_token=window.ReferrerToken),i&&(u.ref_username=i),c&&(u.stat_token=c),u},followFanParams:function(e){if(!e)return null;const t=FanControls.Data?FanControls.Data.fan_id:null,n=e.attr("data-follow-fan"),a=e.hasClass("following")?"unfollow":"follow",i=e.attr("data-follow-stat");return isNaN(n)?(Log.debug("bad or missing item spec for follow-fan controls"),null):(params={fan_id:t,follow_id:n,action:a},i&&(params.stat_token=i),params)}};!1!==window.FanControlsAutoStart&&$(document).ready((function(){FanControls.start()})),function(e,t,n){"use strict";const a={isWishlisted:function(e,t){const n=FanControls.getTralbumLookup(e+t);return n&&!n.purchased},isFollowedFan:function(e){return FanControls.isFollowedFan(e)},wishlist:function(n,a,i,s){const o=this;if(!Identities.fan()||e.TralbumJSONLD&&Identities.fan().private)e.TralbumJSONLD&&FanAction.doAction("wishlist",U.pagedataBlob().lo_querystr||"",null,a,n,i);else{if(e.TralbumJSONLD||!e.TralbumData||!TralbumData.current||!TralbumData.current.id){const e={fan_id:Identities.fan().id,item_type:n,item_id:a,band_id:i,purchased:null};s&&t.each(s,(function(t,n){s[t]&&(e[t]=n)}));const l=t('.collect-item[data-collect-item="'+n+a+'"]');t.merge(l,t('.collection-item-container[data-tralbumid="'+a+'"][data-tralbumtype="'+n+'"]'));const r=function(){FanControls.toggleItem(e),l.toggleClass("wishlisted"),BCEvents.publish("fanControls.wishlist.toggle")};return FanControls._started=!1,FanControls.start(),FanControls.initializeItems(),FanControls.getData().then((function(){const t=o.isWishlisted(n,a);!t&&e.stat_token&&Stats.record({kind:"click",click:e.stat_token}),r(),FanControls.doPost(t?"/uncollect_item_cb":"/collect_item_cb",e,(function(e){!0===e.ok?Log.note("item "+(t?"removed":"added")+" from wishlist"):r()}))}))}FanControls.collectItem(Identities.fan().id,TralbumData.current.id,TralbumData.current.type,TralbumData.current.band_id)}},followBand:function(n,a,i){const s=e.BandData||null;if(!e.TralbumJSONLD||Identities.fan()&&!Identities.fan().private)if(s)BandFollow.followUnfollow(Identities.fan().id,s.id,TralbumData.current?TralbumData.current.id:null,TralbumData.current?TralbumData.current.type:null,a,i);else{const e={band_id:n,fan_id:Identities.fan().id,action:i?"unfollow":"follow"},a=t('.follow-band[data-follow-band="'+n+'"]');t.merge(a,t("#follow-unfollow-band_"+n));const s=function(){t(".following-msg",a).html(TM("Following")),a.toggleClass("following"),BCEvents.publish("fanControls.followBand.toggle")};FanControls._started=!1,FanControls.start(),FanControls.initializeItems(),FanControls.getData().then((function(){s(),FanControls.doPost("/fan_follow_band_cb",e,(function(e){!0===e.ok?Log.note("fan followed"):s()}))}))}else FanAction.doAction("follow",U.pagedataBlob().lo_querystr||"",null,n,"b",n);BCEvents.publish("fanControls.followBand")},followFan:function(e,n){const a=this,i={fan_id:Identities.fan().id,follow_id:e};n&&t.each(n,(function(e,t){n[e]&&(i[e]=t)}));const s=t('.follow-fan[data-follow-fan="'+e+'"]');t.merge(s,t("#follow-unfollow_"+e)),FanControls._started=!1,FanControls.start(),s.addClass("following"),FanControls.getData().then((function(){FanControls.initializeItems(),s.addClass("following");const t=a.isFollowedFan(e);!t&&i.stat_token&&Stats.record({kind:"click",click:i.stat_token}),FanControls.toggleFan(i),FanControls.doPost("/fan_follow_cb",i,(function(e){!0===e.ok&&Log.note("fan "+(t?"followed":"unfollowed"))}))}))},followGenre:function(e){const n=t("#follow-unfollow-genre_"+e)[0],a="follow";if(!t(n).hasClass("following")){t("#follow-grid-item-genre_"+e).remove();const n=t("#following-tabs li[data-tab='following-genres'] span.count"),a=Number(n.html());n.html(a-1)}const i={action:a,discover_id:e},s=t.Deferred();Crumb.ajax({url:"/api/genrepreferences/1/fan_follow_genre",data:i,dataAs:"JSON",type:"POST",success:function(e){return e.ok?s.resolve(e):(Log.debug("failure response",e),t(n).toggleClass("following"),s.reject(e))},error:function(e,t,n){return s.reject()}}),Stats.record({kind:"click",click:"fan_manage_genre_grid_"+a})}};e.FanControls2=a}(window,$,ko),window.VideoElementWrapper=function(){function e(e){this.element=e,this.state="init";const t=["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","stalled","suspend","waiting"],n=this;function a(e){return function(){n.handleEvent(e)}}for(let e=0;e<t.length;e++)this.element.addEventListener(t[e],a(t[e]));this.$blackout=$('<div class="wrapped-video-blackout">'),this.$poster=$('<img class="wrapped-video-poster">'),this.$play=$('<div class="wrapped-video-play video-play-button">'),this.$loading=$('<div class="wrapped-video-loading video-loading-indicator">'),$(e).after(this.$blackout,this.$poster,this.$play,this.$loading),this.changeState("loading"),this.$poster.add(this.$play).click((function(){e.play()}));const i=$(e).attr("poster");i&&(this.setPoster(i),this.changeState("ready")),this._stateTransitions={init:{canplay:"ready",playing:"playing",ended:"ready",error:"error",progress:"ready"},error:{abort:"init",emptied:"init",suspend:"init"},ready:{play:"loading",playing:"playing",emptied:"loading"},playing:{emptied:"loading",ended:"ended",waiting:"loading",error:"error"},ended:{play:"loading",playing:"playing",emptied:"loading"},"loading-playing":{abort:"init",playing:"playing",ended:"ready",error:"error"},"loading-notplaying":{abort:"init",canplay:"ready",suspend:"ready",ended:"ready",error:"error"}}}return e.prototype.changeState=function(e){e&&this.state!=e&&($(this.element).parent().removeClass("state-"+this.state),Log.debug("new state: "+e),this.state=e,$(this.element).parent().addClass("state-"+this.state))},e.prototype.handleEvent=function(e){let t=this.state;"loading"==t&&(t=this.element.paused?"loading-notplaying":"loading-playing"),Log.debug("videoevent: "+e+" in "+t);const n=this._stateTransitions[t];this.changeState(n&&n[e])},e.prototype.setPoster=function(e){this.$poster.attr("src",e)},e}(),function(e,t){"use strict";function n(e,t,n){this.init(e,t,n)}e.VideoPlayer=n,t.extend(n.prototype,{videoId:null,sourceType:null,prev_sourceType:null,properties:null,genericContainerSelector:null,genericIFrameElem:null,genericPlayer:null,captionText:null,trackinfo:null,musicPlaylist:null,currOnTrackPlayed:null,state:null,postAnimateFn:null,featuredId:null,init:function(e,n,a){if(this.isPhone())return;let i=!1;if(e){this.trackinfo=e;for(let t=0;t<e.length&&!i;t++)"t"==e[t].video_source_type&&(i=!0)}if(n&&(this.genericContainerSelector=n),this.properties=a||{},this.properties.root_class_name||(this.properties.root_class_name="video-player"),this.properties.siteroot||(this.properties.siteroot=siteroot_current),this.properties.guideElem&&this.properties.parallelElem){const e=this,n=t(e.properties.parallelElem).css("padding-top"),a=function(a){a?t(e.properties.parallelElem).css("padding-top",t(e.properties.guideElem).offset().top-t(e.properties.parallelElem).offset().top+"px"):t(e.properties.parallelElem).css("padding-top",n)};this.postAnimateFn=a}if(this.properties.featuredSelector){const e=t(this.properties.featuredSelector).attr("data-id");e&&(this.featuredId=e)}t(this.genericContainerSelector+" video.native-video-player").on("ended",(function(){this.currentTime=0}))},doVideo:function(e,a,i,s,o){if(!this.isPhone())if(this.trackinfo&&this.featuredId==a){if(this.justHide(),this.state=null,o){t("html, body").animate({scrollTop:t(".featured-video-wrapper").offset().top-20},500);const e=t(".featured-video-wrapper iframe")[0],a=t(".featured-video-wrapper video.native-video-player")[0];e&&(Log.debug("posting play message to featured iframe"),e.contentWindow.postMessage("play","*")),a&&(n.featuredWrapper||(n.featuredWrapper=new VideoElementWrapper(a)),a.load(),a.play())}}else{if("open"==this.state&&this.sourceType==e&&this.videoId==a)return this.justHide(),void(this.state=null);this.state="open",this.preLoad(e),this.sourceType=e,this.videoId=a,this.captionText=i,"t"==e&&this.do23(a,s,o)}},_loadVideo:function(e,a,i,s){if(e){const t={message:s?"startvideo":"loadvideo",id:i,from:this.musicPlaylist?"a":"t"};Log.debug("posting message to videoframe: "+JSON.stringify(t)),e.contentWindow.postMessage(t,"*")}else if(a){n.wrapper||(n.wrapper=new VideoElementWrapper(a));let e=null;for(let t=0;t<TralbumData.trackinfo.length;t++)if(TralbumData.trackinfo[t].video_id==i){let n=TralbumData.trackinfo[t].video_mobile_url;n=n.replace("video_mobile_high","video_hd"),e={src:"http://bandcamp.23video.com/"+n,poster:"//bandcamp.23video.com/"+TralbumData.trackinfo[t].video_poster_url};break}e?(a.pause(),Log.debug("loading video with url "+e.src),n.wrapper.setPoster(e.poster),t(a).attr(e)):Log.error("do not have a video url for video id "+i)}},do23:function(n,a,i){const s=this,o=t(this.genericContainerSelector+" iframe"),l=o[0],r=t(this.genericContainerSelector+" video.native-video-player")[0];if(!l&&!r)return;let c=this.properties.siteroot+"/videoframe?video_id="+n;a&&(c+="&autoplay=1"),BandData&&BandData.id&&(c+="&band_id="+BandData.id),this.musicPlaylist?c+="from='a'":c+="from='t'",this.genericIFrameElem=o,this.postLoad("t"),t(this.genericContainerSelector).addClass(this.properties.root_class_name+"-viz"),this.showCaption();const d=this.genericContainerSelector;if(!(this.prev_sourceType||this.properties.noAnimation))t("#bio-container").addClass("anim-hidden"),t(this.genericContainerSelector).slideDown({complete:function(){if("open"==s.state?s._loadVideo(l,r,n,a):(l.contentWindow.location.replace(c),s._loadVideo(null,r,n,a)),s.postAnimateFn&&s.postAnimateFn(!0),i){const n=t(e).scrollTop();if(t(d).offset().top<n){const e=t(d).offset().top-20;t("html, body").animate({scrollTop:e},500)}}t("#bio-container").removeClass("anim-hidden")}});else if(t(this.genericContainerSelector).show(),"open"==s.state?s._loadVideo(l,r,n,a):(l.contentWindow.location.replace(c),s._loadVideo(null,r,n,a)),this.postAnimateFn&&this.postAnimateFn(!0),i){const n=t(e).scrollTop();if(t(d).offset().top<n){const e=t(d).offset().top-20;t("html, body").animate({scrollTop:e},500)}}t(this.genericContainerSelector).removeClass(this.properties.root_class_name+"-hidden")},preLoad:function(){this.prev_sourceType},postLoad:function(e){if(!this.prev_sourceType||this.prev_sourceType==e)return;const t=this.genericContainerSelector;this.justHide(t,!1),this.state=null},justHide:function(e,n){const a=this;if(!this.sourceType||!this.videoId)return;if(e||(e=this.genericContainerSelector),this.captionText){const e=t("."+this.properties.root_class_name+"-caption");e.html(""),e.hide(),this.captionText=null}n?t(e).slideUp({complete:function(){a.postAnimateFn&&a.postAnimateFn(!1)}}):(t(e).hide(),this.postAnimateFn(!1)),t(e).removeClass(this.properties.root_class_name+"-viz"),t(e).addClass(this.properties.root_class_name+"-hidden");const i=t(e+" iframe")[0],s=t(e+" video.native-video-player")[0];i&&(Log.debug("posting stop message to player iframe"),i.contentWindow.postMessage("stop","*")),s&&(Log.debug("pausing video element"),s.pause())},_playTrackListener:function(e,t){let n=null;t||(t=this),++e;for(let a=0;a<t.trackinfo.length;a++)if(t.trackinfo[a].track_num==e){n=TralbumData.trackinfo[a];break}if(!n||!n.video_id)return this.justHide(null,!0),void(this.state=null);Log.debug("queuing video track: "+e),this.doVideo(n.video_source_type,n.video_id,n.video_caption,!1,!1)},setPlaylistListeners:function(e){if(this.isPhone())return;const t=this;e.ontrackplayed((function(e){e!=t.currOnTrackPlayed&&(t.currOnTrackPlayed=e,Log.debug("VideoPlayer: ontrackplayed: "+e),t._playTrackListener(e,t))})),this.musicPlaylist=e},showCaption:function(){let e=!1;const n=t("."+this.properties.root_class_name+"-caption"),a=t("."+this.properties.root_class_name);return this.captionText?(n.html(this.captionText),n.show(),a&&a.addClass("caption-viz"),e=!0):n&&(n.hide(),a&&a.removeClass("caption-viz")),e},isPhone:function(){return e.MediaView&&"phone"==MediaView.mode}}),e.TralbumPageVideoPlayer={_hiddenForDialogs:[],init:function(a,i){if(e.Browser&&"safari"==Browser.make&&"iphone"==Browser.platform&&(t(document).on("bc_dialog_open",(function(e,n){Log.debug("hiding video for IOS while dialog is open"),TralbumPageVideoPlayer._hiddenForDialogs.push(t("video:visible").hide())})),t(document).on("bc_dialog_close",(function(e,n){const a=TralbumPageVideoPlayer._hiddenForDialogs;t.each(a,(function(e,t){Log.debug("restoring hidden video because dialog is closing"),t.show()})),TralbumPageVideoPlayer._hiddenForDialogs=[]}))),t("video.native-video-player").each((function(){t(this).parents(".featured-video-wrapper")[0]?n.featuredWrapper||(n.featuredWrapper=new VideoElementWrapper(this)):n.wrapper||(n.wrapper=new VideoElementWrapper(this))})),!e.tracklistVideoPlayer){const t=new n(e.TralbumData.trackinfo,".middleColumn .video-wrapper",{root_class_name:"video-wrapper",parallelElem:"#rightColumn",guideElem:"#tralbumArt",noAnimation:!!i,featuredSelector:".featured-video-wrapper"});e.tracklistVideoPlayer=t}a&&e.tracklistVideoPlayer.setPlaylistListeners(a)}},e.TralbumPageVideoPlayer=TralbumPageVideoPlayer}(window,jQuery);var CrossFrame=function(){"use strict";function e(e,t,n){this.serial=1,this.domain=n,this.deferred=[],this.methodHandlers={},this.eventHandlers={},this.thisWindow=e,"*"==n&&Log.error("warning: using * for CrossFrame domain; you should specify a specific domain");const a=this;function i(e,n,i){function s(e){t.postMessage({message:"crossframe_call_fail",serial:i,error:e},a.domain)}const o=a.methodHandlers[e];if(o)try{o(n).then((function(e){!function(e){t.postMessage({message:"crossframe_call_result",serial:i,result:e},a.domain)}(e)})).fail((function(e){s(e)}))}catch(e){s(err)}else s("no such method")}function s(e){const t=a.deferred[e];return t?delete a.deferred[e]:Log.debug("hmm, didn't find a promise for call "+e),t}function o(e){switch(e.message){case"crossframe_call":i(e.name,e.arg,e.serial);break;case"crossframe_emit":!function(e,t){const n=a.eventHandlers[e];if(n)for(let a=0;a<n.length;a++){Log.debug("calling handler for "+e+" with arg "+JSON.stringify(t));try{n[a].call(this,t)}catch(e){Log.debug("caught exception in handler: "+e)}}else Log.debug("no handlers for "+e)}(e.name,e.arg);break;case"crossframe_call_result":!function(e,t){const n=s(e);n?n.resolve(t):Log.debug("hmm, didn't find a promise for call "+e)}(e.serial,e.result);break;case"crossframe_call_fail":!function(e,t){const n=s(e);n?n.fail(t):Log.debug("hmm, didn't find a promise for failed call "+e)}(e.serial,e.error)}}this.call=function(e,n){const a={message:"crossframe_call",name:e,arg:n,serial:this.serial++},i=$.Deferred();return this.deferred[a.serial]=i,t.postMessage(a,this.domain),i.promise()},this.emit=function(e,n){const a={message:"crossframe_emit",name:e,arg:n};t.postMessage(a,this.domain)},this.messageListener=function(e){"*"!=a.domain&&a.domain!=e.origin||o(e.data)},e.addEventListener("message",this.messageListener),this.handlers={}}return e.prototype.handleMethod=function(e,t){this.methodHandlers[e]=t},e.prototype.on=function(e,t){let n=this.eventHandlers[e];n||(n=[],this.eventHandlers[e]=n),n.push(t)},e.prototype.destroy=function(){this.thisWindow.removeEventListener("message",this.messageListener),this.methodHandlers=null,this.eventHandlers=null},e}();!function(e,t){"use strict";const n={doAction:function(n,a,i,s,o,l,r,c){const d=U.pagedataBlob()||{};d.cfg;let u=null;const p=Identities.bmgr.bands().length>0,m=Identities.fan()&&!Identities.fan().private&&!Identities.fan().verified;if("wishlist"===n?u=m?"unverified_fan_wishlist_open":p?"logged_out_wishlist_open_band_no_fan":"logged_out_wishlist_open":"follow"===n&&"f"===o?u=m?"unverified_fan_fan_follow_open":p?"logged_out_fan_follow_open_band_no_fan":"logged_out_fan_follow_open":"follow"!==n||o&&"b"!==o?"follow"!==n||o&&"g"!==o?"live_ticket"!==n&&"live_attend"!==n&&"live_attend_immediate"!==n||(u=p?"logged_out_live_ticket_purchase_open_band_no_fan":"logged_out_live_ticket_purchase_open","live_ticket"===n&&BCTracker.record("click",{click_outcome:"failed_buy_ticket_now",feature:"live",feature_sub_type:"live_stream"})):u=m?"unverified_fan_follow_open":p?"logged_out_follow_open_band_no_fan":"logged_out_genre_follow_open":u=m?"unverified_fan_follow_open":p?"logged_out_follow_open_band_no_fan":"logged_out_follow_open",u&&Stats.record({kind:"click",click:u}),"wishlist"===n||"follow"===n&&"b"===o){const e={click_type:n,item_id:s,item_type:o,user_type:"guest"};BCTracker.record("click",e)}0===(a=a||"").length&&d.signup_querystrings&&(a=d.signup_querystrings[o+s]||"");const f=i||("follow"==n?"loflwlgn":"lowllgn"),h=i||("follow"==n?"loflwlrn":"lowllrn");let g,b;if(a.length>0?(g=siteroot_https+"/login"+a+"&action="+n+"&from="+f,b=siteroot_https+"/fans"+a+"&action="+n+"&from="+h):(g=siteroot_https+"/login?action="+n+"&from="+f,b=siteroot_https+"/fans?action="+n+"&from="+h),Identities.fan()&&!Identities.fan().private&&!Identities.fan().verified&&e.VerifyNag){const t=d.signup_params.email||e.FanSignup.state.email;e.verifyNag=e.verifyNag||new VerifyNag({fan_email:t}),e.verifyNag.openDialog()}else{const d=(!Identities.fan()||Identities.fan().private)&&Identities.user();if("phone"===MediaView.mode&&d){const t=siteroot_https+"/fan_signup"+a+"&action="+n+"&from="+h+"&pane=existing_artist";e.location.href=t}else if(Url.isCustomDomain()&&d)if(FanSignup.subdomainURL){const t={fan_action_pane:"existing_artist",fan_action:n};e.location.href=Url.addQueryParams(FanSignup.subdomainURL,t)}else e.location.href=siteroot_https+"/fans";else{let e;FanSignup.actionParams={action:n},s&&o?(FanSignup.actionParams.actionItemId=s,FanSignup.actionParams.actionItemType=o,FanSignup.actionParams.actionBandId=l):l&&(FanSignup.actionParams.actionBandId=l),r&&(FanSignup.actionParams.collectData=r),c&&(FanSignup.actionParams=t.extend({},FanSignup.actionParams,c)),FanSignup.actionParams.from=i,FanSignup.actionParams.queryString=a,e=d&&FanSignup.affiliations&&(FanSignup.affiliations.fan||FanSignup.affiliations.fan_already_linked_email)?"dupe_fan":d?"existing_artist":"action",FanSignup.openPane(e,!0)}}}};e.FanAction=n,t(document).ready((function(){const n=Url.parseQuery(location.search),a=U.pagedataBlob()||{};a.cfg;if(n.show_nag){const t=a.signup_params.email||e.FanSignup.state.email;e.verifyNag=e.verifyNag||new VerifyNag({fan_email:t}),e.verifyNag.openDialog(),SignupUtils.cleanURL()}t(document).on("visibilitychange",(function(){document.visibilityState&&"visible"===document.visibilityState&&!Identities.user()&&Cookie.get("js_logged_in")&&e.location.reload(!0)}))}))}(window,jQuery);var CarouselControl=function(){"use strict";var e={init:function(t,n){e.$container=$(t),e.pagedata=n,e.bcweeklyIsBig=e.pagedata&&e.pagedata.big_item&&e.pagedata.big_item.is_bcweekly,e.$container.find(".carousel-big-item-details").on("mouseover",(function(){$(this).siblings(".carousel-big-item").find(".carousel-item-hover-overlay").addClass("visible")})),e.$container.find(".carousel-big-item-details").on("mouseout",(function(){$(this).siblings(".carousel-big-item").find(".carousel-item-hover-overlay").removeClass("visible")}))},expandWeekly:function(t){const n=$.Deferred();if(e.$container.addClass("bcweekly-expanded"),e.$container.find(".bcweekly").addClass("expanded"),t&&HomeControl.bcwControl&&HomeControl.bcwControl.setupPlaylist(),"desktop"===MediaView.mode&&HomeControl.feedReader){var a=HomeControl.feedReader.paused;HomeControl.feedReader.paused=!0}return setTimeout((function(){"desktop"===MediaView.mode&&HomeControl.feedReader&&!a&&(HomeControl.feedReader.paused=!1),n.resolve()}),e.transitionDuration()+100),n.promise()},collapseWeekly:function(){if(!e.$container.hasClass("bcweekly-expanded"))return;const t=$.Deferred();HomeControl.bcwControl.jumpToTrack(0),HomeControl.bcwControl.playlist.stop(),HomeControl.bcwControl.removeShowArg(),e.$container.removeClass("bcweekly-expanded"),"desktop"===MediaView.mode&&e.bcweeklyIsBig&&e.$container.find(".bcweekly").removeClass("expanded");const n=Iter.find(e.pagedata.small_items.concat(e.pagedata.big_item),(function(e){return e.is_bcweekly}));if(n){const t=HomeControl.bcwControl.showIdToIndex(n.show_id);t!=HomeControl.bcwControl.showIndex&&setTimeout((function(){HomeControl.bcwControl.navigateToShow(t,!1,!e.bcweeklyIsBig)}),e.transitionDuration()+100)}if("desktop"===MediaView.mode&&HomeControl.feedReader){var a=HomeControl.feedReader.paused;HomeControl.feedReader.paused=!0}return setTimeout((function(){"desktop"===MediaView.mode&&HomeControl.feedReader&&!a&&(HomeControl.feedReader.paused=!1),t.resolve()}),e.transitionDuration()+100),t.promise()},transitionDuration:function(){return"desktop"===MediaView.mode?300:200},weeklyIsExpanded:function(){return e.$container.hasClass("bcweekly-expanded")}};return e.init.apply(e,arguments),e},BCWeeklyControl=function(){"use strict";const e="bcweekly-track",t="bcweekly-current";var n={init:function(a,i,s,o,l,r,c,d){n.$root=$(a).first(),n.showIndex=o||0,n.showSeq=[],n.showSeqPromise=null,n.showSeqDetails=i||{},n.makeShowIdIndex(),n.showData=s||{},n.fanData=l||{},n.trackIndex=null,n.collapsedTrackItemHeight=null,n.playlist=null,n.$root.on("click","."+e,(function(e){if($(e.target).closest("a").hasClass("collect-link"))return!0;const a=$(this);if(e.ctrlKey||e.metaKey||e.shiftKey)return!0;if(!a.hasClass(t)){e.preventDefault();const t=a.data("index");n._currentlyPlayingIndex()==t&&"phone"!=MediaView.mode||n.jumpToTrack(t),n.showPlayingTabPhone()}n.expandTrack(a)})).on("click",".play-btn",n.handlePlayClick).on("click",".collect-item .collection-btn",(function(e){e.stopPropagation(),"#"==$(e.target).closest("a").attr("href")&&e.preventDefault()})).on("click",".social-controls .email-link",(function(e){return n.toggleEmailPanel(),!1})).on("click",".bcweekly-shows-link",(function(e){return n.showBrowser(),!1})).on("click",".bcweekly-close-link",(function(e){return n.hideBrowser(),!1})).on("click",".bcweekly-browse-item",(function(e){if(e.preventDefault(),e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)return!0;const t=n.showIdToIndex($(this).data("show-id"));if(t==n.showIndex)n.jumpToTrack(0),n.hideBrowser();else{const e=n.navigateToShow(t,!0);e&&n.pushHistory(e)}return!1})).on("click",".bcweekly-tracks-link",(function(e){return n.showTracks(),!1})).on("scroll",".bcweekly-browse-inner",(function(e){n.lastBrowsePanelScrollTop=$(this).scrollTop()})).on("click",".bcweekly-share-link",(function(e){return n.doShare(),!1})).on("click",".close-show-inner",(function(e){return HomeControl.carouselControl.collapseWeekly(),!1})),PopupImage.delegate(n.$root),FanControls.delegate(n.$root),n.setupPlaylist(),n.setupPlayerControls(),n.setupSharing(),"phone"==MediaView.mode&&($.each(n.showData,(function(e,t){n.fixupShowDataPhone(t)})),n.initTabs()),$(window).on("popstate",$.proxy(n,"popHistory")),r&&n.autoplay(),$(window).on("keydown",(function(e){27===e.keyCode&&n.hideBrowser()})),setTimeout((function(){n.renderTracklist(),FanControls.initializeItems(n.$root)}),100),c&&n.$root.find(".bcweekly").addClass("expanded"),d&&n.openArchive()},renderTracklist:function(){const e=n.$root.find(".bcweekly-tracks");0===e.find(".bcweekly-track-list").length&&0!==e.length&&Templ.renderElem(e[0],"home_2016/bcweekly_tracks_inner",{bcw:n.currentShow(),fan_data:n.fanData||{}})},autoplay:function(){n.playingOrPaused()||"iphone"==Browser.platform||(HomeControl.carouselControl.expandWeekly(!0),n.renderTracklist(),FanControls.initializeItems(n.$root),n._trackbreaks=n._calculateTrackBreaks(null),n.playlist.playpause(),n.precacheTrackArt())},openArchive:function(){HomeControl.carouselControl.expandWeekly(!0),n.renderTracklist(),FanControls.initializeItems(n.$root),n._trackbreaks=n._calculateTrackBreaks(null),n.precacheTrackArt(),n.playlist.playpause(),n.playlist.playpause(),n.showBrowser()},handlePlayClick:function(){"phone"!==MediaView.mode&&n.renderTracklist(),n.playingOrPaused()||(n._trackbreaks=n._calculateTrackBreaks(null),n._trackbreaks[0]&&0===n._trackbreaks[0].timecode&&n.expandTrack(n.trackElem(0)),n.pushHistory((n.currentShow()||{}).show_id,!0),setTimeout(n.showPlayingTabPhone,0));const e=!n.$root.find(".bcweekly").hasClass("expanded"),t=!!n.playlist;return HomeControl.carouselControl.expandWeekly(!t).then((function(){e&&"desktop"===MediaView.mode&&$("html, body").animate({scrollTop:n.$root.find(".bcweekly").offset().top-200}),t||n.playlist.playpause()})),t&&n.playlist.playpause(),n.precacheTrackArt(),!1},loadShowData:function(e){const t=$.Deferred(),a=n.showData[e];if(a)t.resolve(a);else{let a="/api/bcweekly/2/get?id="+Number(e);Identities.fan()||(a=a+"&lo=1&lo_action_url="+siteroot_https),$.ajax({type:"GET",url:a,dataType:"json"}).then((function(a){a.error?t.fail():(n.showData[e]=a,t.resolve(a))}))}return t},getPastShows:function(){if(null===n.showSeqPromise){const e="/api/bcweekly/3/list",t=$.Deferred();n.showSeqPromise=t,$.ajax({type:"GET",url:e,dataType:"json"}).then((function(e){e.error?t.fail():(n.showSeq=e.results,n.rebuildSeqDetails(),t.resolve())}))}return n.showSeqPromise},showBrowser:function(){const e=n.$root.find(".bcweekly-browse");n.getPastShows().then((function(){e.removeClass("hidden"),0===e.find(".bcweekly-browse-inner").length&&Templ.renderElem(e[0],"home_2016/bcweekly_browse_inner",{bcw_seq:n.showSeq}),n.$root.hasClass("bcweekly-view-shows")||n.$root.addClass("bcweekly-view-shows");const t=e.find(".bcweekly-browse-item");let a=t.filter("[data-show-id="+n.currentShow().show_id+"]");a.length||(a=t.first()),t.removeClass("current"),a.addClass("current")}))},hideBrowser:function(){n.$root.hasClass("bcweekly-view-shows")&&(n.$root.removeClass("bcweekly-view-shows"),setTimeout((function(){n.$root.find(".bcweekly-browse").addClass("hidden")}),200))},showTracks:function(){n.$root.toggleClass("bcweekly-view-tracks")},navigateToShow:function(e,t,a){if(e<0||e>=n.showSeqDetails.num_shows||e==n.showIndex)return null;const i=n.showSeqDetails.show_ids[e];return n.getPastShows().then((function(){n.playlist.stop(),n.$root.find(".bcweekly").removeClass("sharing");const s=n.showSeq[e],o=n.loadShowData(i);function l(i){(t||a)&&(i.expanded=!0),"phone"===MediaView.mode&&n.fixupShowDataPhone(i),Templ.renderElem($("#bcweekly")[0],"home_2016/bcweekly",{pagedata:$("#pagedata").data("blob"),bcw:i,fan_data:n.fanData,bcweekly_sharing:$("#pagedata").data("blob").bcweekly_sharing,page_identities:Identities.initialData}),n.showIndex=e,n.setupPlaylist(),n.setupPlayerControls(),n.setupSharing(),n.hideSpinner(),n.hideBrowser();const s=$(".bcweekly-tracks");Templ.renderElem(s[0],"home_2016/bcweekly_tracks_inner",{bcw:i,fan_data:n.fanData||{}}),FanControls.initializeItems(n.$root),i.tracks.length>0&&t&&n.handlePlayClick()}if(o.isResolved())o.then((function(e){l(e),setTimeout((function(){n.$root.find(".bcweekly-browse").addClass("hidden")}),200)}));else{l({subtitle:s.subtitle,show_image_id:s.image_id,show_v2_image_id:s.v2_image_id,date:s.date,title:"Bandcamp Weekly",show_id:s.id,published_date:s.published_date,image_caption:s.image_caption,desc:s.desc,show_screen_image_id:s.image_id,button_color:s.button_color,tracks:[]}),n.showSpinner(),o.then((function(e){l(e),setTimeout((function(){n.$root.find(".bcweekly-browse").addClass("hidden")}),200),HomeControl.updateCollectionInfo(n.$root)}))}})),i},rebuildSeqDetails:function(){const e={show_ids:[]};e.num_shows=n.showSeq.length,n.showSeq.forEach((function(t,n){e.show_ids[n]=t.id,t.episode_number=e.num_shows-n})),n.makeShowIdIndex()},makeShowIdIndex:function(){n.showIdToSel={},n.showSeqDetails.show_ids.forEach((function(e,t){n.showIdToSel[e]=t}))},showIdToIndex:function(e){const t=n.showIdToSel[e];return null==t?-1:t},showSpinner:function(){n.$root.find(".bcweekly-bd").addClass("loading")},hideSpinner:function(){n.$root.find(".bcweekly-bd").removeClass("loading")},trackElem:function(e){return n.$root.find("li.bcweekly-track").eq(e)},expandTrack:function(e,t){"phone"===MediaView.mode?n.expandTrackPhone(e):n.expandTrackDesktop(e,t)},expandTrackDesktop:function(e,a){const i=$(e),s=i.siblings(),o=n.trackIndex;n.trackIndex=i.data("index"),o!=n.trackIndex&&(i.hasClass(t)||(n.animateTrackItem(i,!0,a),s.filter("."+t+", :animated").each((function(){n.animateTrackItem(this,!1,a)}))))},collapseAllTracks:function(){n.$root.find("."+t).each((function(){n.animateTrackItem(this,!1)})),n.fadeTrackItems(n.$root.find("."+e),!0)},animateTrackItem:function(e,a,i){const s=$(e);a?(s.addClass(t),setTimeout((function(){n.scrollTrackList(i)}),250)):s.removeClass(t)},fadeTrackItems:function(e,t,n){const a=n?2e3:400;$(e).children().stop(!0,!1).animate({opacity:t?1:.5},a/2)},scrollTrackList:function(e){const t=n.$root.find(".bcweekly-tracks"),a=(n.trackIndex||0)*n.trackItemHeight()+1,i=e?2e3:400;a!=t.scrollTop()&&t.stop(!0,!1).animate({scrollTop:a},i)},trackItemHeight:function(){if(null===n.collapsedTrackItemHeight){let a=0;n.$root.find("."+e+":not(."+t+")").each((function(){const e=$(this)[0].getBoundingClientRect().height;e>a&&(a=e)})),n.collapsedTrackItemHeight=a}return n.collapsedTrackItemHeight},setupPlaylist:function(){if(!n.playlist){const e={no_trackstate:!0,savepos:!0},t=new Player.Playlist(new WrapperSoundPlayer,n.STAT_FROM,null,e);n.playlist=t,Player.Playlist.coordinator.onplaying((function(){Log.debug("TPI.play"),TitlePlayIndicator.play()})),Player.Playlist.coordinator.onstopped((function(){Log.debug("TPI.stop"),TitlePlayIndicator.stop()})),t.onstatechanged(n._playlist_onstate),t.ontime(n._playlist_ontime),t.onloaded(n._playlist_onloaded)}const e=n.currentShow();if(e){const t={file:e.audio_stream,duration:e.audio_duration,id:e.audio_track_id};n.playlist.load([t]),n._updateTime(0,e.audio_duration)}n._updateLoaded()},setupPlayerControls:function(){const e=n.$root.find(".scrubber-thumb");function t(e){const t=n.$root.find(".bcweekly-player .scrubber-thumb"),a=n.$root.find(".bcweekly-player .scrubber"),i=a.width()-t.width();let s=e-a.offset().left-n._thumbDragOffset;s<0?s=0:s>i&&(s=i);return n.playlist.duration()*(s/i)}function a(t){n._thumbDragging=!0,n.playlist.seeking=!0,n._thumbDragOffset=t-e.offset().left}function i(e){const a=t(e);n._drag_pos=a,n._updateTime(a,n.playlist.duration())}function s(e,a){if(n._thumbDragging=!1,n.playlist.seeking=!0,!a){const a=t(e),i=n._trackAtTime(a);if(n._trackbreaks=n._calculateTrackBreaks(i),i){const e=n.trackElem(i);n.expandTrack(e)}else n.collapseAllTracks();n.clearTrackStat(),n.playlist.play_track(0,t(e)),n._updateTime(a,n.playlist.duration())}}const o=n.$root.find(".bcweekly-player .scrubber");function l(e){return e.originalEvent.changedTouches[0].pageX}function r(){o.off("touchmove",c),o.off("touchend",d),o.off("touchcancel",u)}function c(e){i(l(e)),n._updatePlaypos()}function d(e){r(),s(l(e),!1)}function u(e){r(),s(l(e),!0)}n._use_touch()?o.on("touchstart",(function(e){e.preventDefault(),a(l(e)),o.on("touchmove",c),o.on("touchend",d),o.on("touchcancel",u)})):e.draggable({containment:"parent",start:function(e){a(e.pageX)},drag:function(e){i(e.pageX)},stop:function(e){s(e.pageX)}})},currentShow:function(){const e=n.showIndex;if(null===e||e<0||e>=n.showSeqDetails.num_shows)return null;const t=n.showSeqDetails.show_ids[e];return n.showData[t]},precacheTrackArt:function(){const e=n.currentShow();e&&!e.precached_track_art&&($.each(e.tracks,(function(e,t){const n=ImageUtils.artURL(t.track_art_id,"art_thumb");PopupImage.preload_url(n)})),e.precached_track_art=!0)},_trackAtTime:function(e){e=e||0;const t=n.currentShow();for(var a=0;a<t.tracks.length&&!(t.tracks[a].timecode>e);a++);return 0===a?null:a-1},_currentlyPlayingIndex:function(){if(!n.playingOrPaused())return null;const e=n.playlist.position();return n._trackAtTime(e)},_calculateTrackBreaks:function(e){let t=e;null===t&&(t=0);const a=[],i=n.currentShow();for(;t<i.tracks.length;t++){let n=i.tracks[t].timecode;t==e&&(n=0),a.push({timecode:n,index:t})}return a},_use_touch:function(){return"iphone"==Browser.platform},jumpToTrack:function(e){const t=n.currentShow();if(!t)return;const a=t.tracks[e];n._trackbreaks=n._calculateTrackBreaks(e),a&&(n.startNewTrackStat(a.track_id),n.playShow(0===e?0:a.timecode),n.precacheTrackArt())},playShow:function(e){null===e?this.playlist.play():this.playlist.play_track(0,e)},getPlaylist:function(){return this.playlist},startNewTrackStat:function(e){const t={id:e};this._currentTrackStat=new Player.PlayStat(t,this.STAT_FROM)},completeCurrentTrackStat:function(){this._currentTrackStat&&(this._currentTrackStat.play_progress(100,100),this._currentTrackStat=null)},clearTrackStat:function(){this._currentTrackStat=null},_playlist_onstate:function(e){"COMPLETED"==e.newstate&&(n.completeCurrentTrackStat(),n.collapseAllTracks()),n.$root.find(".bcweekly").removeClass("playing busy"),"PLAYING"!=e.newstate&&"BUFFERING"!=e.newstate||n.$root.find(".bcweekly").addClass("BUFFERING"==e.newstate&&Capabilities.hasAnimation()?"busy":"playing")},_playlist_ontime:function(e){if(n._trackbreaks.length>0){const t=n._trackbreaks[0];if(t.timecode<e.position){const e=n.trackElem(t.index);n.completeCurrentTrackStat();const a=n.currentShow().tracks[t.index];n.startNewTrackStat(a.track_id),n.expandTrack(e),n._trackbreaks.shift()}}n._thumbDragging||(n._updateTime(e.position,e.duration),n._updatePlaypos())},_playlist_onloaded:function(e){n._updateLoaded()},_updateTime:function(e,t){n.$root.find(".time-output").html(Time.timeStr(e||0)+" / "+Time.timeStr(t||0))},_updatePlaypos:function(){const e=n.$root.find(".bcweekly-player .scrubber-thumb"),t=n.$root.find(".bcweekly-player .scrubber"),a=(n._thumbDragging?n._drag_pos:n.playlist.position())/n.playlist.duration(),i=(t.width()-e.width())*a;n.$root.find(".scrubber-thumb").css("left",i+"px")},_updateLoaded:function(){n.$root.find(".scrubber-buffer").css("width",n.playlist.percent_loaded()+"%")},playingOrPaused:function(){switch(n.playlist.get_state()){case"PLAYING":case"PAUSED":case"BUFFERING":return!0}return!1},setupSharing:function(){"phone"!=MediaView.mode&&SocialControls.initFromDOM(n.$root.find(".social-controls"))},doShare:function(){n.$root.find(".bcweekly").addClass("sharing"),"phone"==MediaView.mode&&this.showSharePhone()},showEmailPanel:function(e){if(!(e=e||n.currentShow())||n.$emailPanel)return;const t=n.$emailPanel=$(Templ.render("home/bcweekly_email_panel",{show:e})).appendTo(n.$root.find(".bcweekly-info-inner")).bcdismissable({triggerElements:n.$root.find(".social-controls .trigger-email-panel"),dismissed:function(e){n.hideEmailPanel()}});t.find(".close").click((function(e){return n.hideEmailPanel(),!1})),t.find(".email-field").on("click",(function(e){$(this).select()})),t.position({my:"center bottom",at:"center+30 top+5",of:"#bcweekly .trigger-email-panel",collision:"flipfit"}).css({display:"none",visibility:"visible"}).slideDown(100,(function(){t.find(".email-field").select()}))},hideEmailPanel:function(){n.$emailPanel&&(n.$emailPanel.bcdismissable("destroy").remove(),n.$emailPanel=null)},toggleEmailPanel:function(){n.$emailPanel?n.hideEmailPanel():(n.showEmailPanel(),Stats.record({kind:"click",click:"homepage_bcw_email"}))},showSharePhone:function(e){if(!(e=e||n.currentShow()))return;const t={show:e},a=NuDialog.showTemplate("home_2016/bcweekly_share_phone",t,{title:"Share Show",buttons:[],close:function(){n.$root.find(".bcweekly").removeClass("sharing"),$(this).remove()}});SocialControls.initFromDOM(a[0])},scrollBrowsePanel:function(e,t){const a=e.find(".bcweekly-browse-inner");let i=n.lastBrowsePanelScrollTop||a.scrollTop()||0;const s=a.height(),o=t.position(),l=t.outerHeight();let r=0;o.top<i?r=o.top-i:o.top+l>i+s&&(r=o.top+l-(i+s)),Log.warn(i,s,Math.round(o.top),Math.round(l),Math.round(r)),i+=r,a.scrollTop(i),n.lastBrowsePanelScrollTop=a.scrollTop(),Log.warn(a.scrollTop())},pushHistory:function(e,t){if(!e||!history.pushState)return;let n=Url.toHash(location.href);const a=[],i="show";$.each(Url.parseQueryArray(n.search),(function(){this.name!=i&&a.push(this)})),n.search="?"+Url.joinQueryArray(a.concat({name:i,value:e})),n=Url.fromHash(n),t?history.replaceState({},"",n):history.pushState({},"",n)},popHistory:function(e){const t=parseInt(Url.getQueryParam(location.href,"show"))||null;n.navigateToShow(t?n.showIdToIndex(t):0)&&Log.debug("bcweekly: popping history: ",location.href)},removeShowArg:function(){if(!history.replaceState)return;let e=Url.toHash(location.href);const t=[];$.each(Url.parseQueryArray(e.search),(function(){"show"!=this.name&&t.push(this)})),t.length>0?e.search="?"+Url.joinQueryArray(t):e.search="",e=Url.fromHash(e),history.replaceState({},"",e)},fixupShowDataPhone:function(e){const t=e.tracks[0];t&&(t.timecode=0)},expandTrackPhone:function(e){const t=$(e);if(n.trackIndex=t.data("index"),!t.hasClass("current")){const e=n.currentShow(),t=e&&e.tracks[n.trackIndex];if(t){const e=n.fanData&&!n.fanData.read_only,a={trk:t,fan_data:n.fanData,show_collect_controls:e};$("#bcweekly-playing-tab").renderLiquid("home_2016/bcweekly_playing_tab_phone",a),$(".bcweekly-tabs .bcweekly-tab").removeClass("disabled"),FanControls.initializeItems($("#bcweekly-playing-tab")),this.highlightTrackPhone(n.trackIndex)}}},highlightTrackPhone:function(t){this.$root.find("."+e).removeClass("current"),null!==t&&this.trackElem(t).addClass("current")},initTabs:function(){n.$root.on("click",".bcweekly-tabs",(function(e){return n.switchTabs($(e.target).closest(".bcweekly-tab")),!1}))},switchTabs:function(e){const t=$(e);if(!t.length||t.hasClass("tab-active")||t.hasClass("disabled"))return;const a=n.$root.find(".bcweekly-tabs .bcweekly-tab");a.removeClass("tab-active"),t.addClass("tab-active"),a.each((function(){const e=$(this),n=e.find("a").attr("href"),a=n&&Url.toHash(n).hash;a&&(e.is(t)?$(a).show():$(a).hide())})),Dom.scrollToElement(n.$root,0,!1)},showPlayingTabPhone:function(){if("phone"!=MediaView.mode)return;const e=n.$root.find(".bcweekly-tabs .bcweekly-tab").has("a[href=#bcweekly-playing-tab]");e.removeClass("disabled"),n.switchTabs(e)},showDetailsTabPhone:function(){if("phone"!=MediaView.mode)return;const e=n.$root.find(".bcweekly-tabs .bcweekly-tab").has("a[href=#bcweekly-details-tab]");e.removeClass("disabled"),n.switchTabs(e)},STAT_FROM:"bcweekly"};return n.init.apply(n,arguments),n};!function(){"use strict";window.BCDailyManager=function(e){const t=$(e);let n=parseInt(sessionStorage.getItem("bcdaily_current_batch"))||1;for(let e=1;e<=n;e++)t.addClass("batch-"+e);t.on("click",".stepper-bcdaily",(function(){t.addClass("batch-"+ ++n),sessionStorage.setItem("bcdaily_current_batch",n)}))}}(),function(e,t,n){"use strict";const a={cleanParams:function(e){const n={};return t.each(e,(function(e,t){n[e]="p"===e?Math.floor(t/6).toString():t.toString()})),n},get:function(e){const n=t.Deferred(),a=this.cleanParams(e);return Identities.fan()||(a.lo=!0,a.lo_action_url=siteroot_https),t.get(Url.addQueryParams("/api/discover/3/get_web",a)).then((function(e){return n.resolve(e)}),(function(e){return n.reject(e)})),n.promise()}},i={get:function(e,n){const a=t("#pagedata").data("blob").discover_2015.discover_colors,i=t("#pagedata").data("blob").discover_2015.discover_color_offsets,s={hue:a[e].baseHue,sat:a[e].baseSat,light:a[e].baseLight,alpha:a[e].baseAlpha};if(!n)return s;const o=i[n];return o?(t.each(o,(function(e,t){s[e]=s[e]+t})),s):s}};function s(e,t){const a=this,i=[];e.recommendations&&e.recommendations.length>0&&Iter.each(e.recommendations,(function(e){const n={date:Time.relative_day(e.rec_date),why:e.rec_why,bandName:e.rec_band_name,staffFanURL:null,bandURL:null};e.rec_band_url_hash&&Templ.runWithContext((function(){n.bandURL=Url.addQueryParams(Templ.filters.band_url(e.rec_band_url_hash),{from:t.parent.referrer()})})),i.push(n)})),a.items=i,a.currentIndex=n.observable(0),a.currentItem=n.computed((function(){const e=a.currentIndex();return i&&0!==i.length&&i[e]?i[e]:null})),a.pageForward=function(){const e=a.currentIndex();e+1>=a.items.length||a.currentIndex(e+1)},a.pageBackward=function(){const e=a.currentIndex();e-1<0||a.currentIndex(e-1)}}function o(e,t){const a=this;a.parent=t,a.itemId=e.id,a.itemType=e.type,a.bandId=e.band_id,a.artId=e.art_id,a.tralbumKey=a.itemType+a.itemId,a.isPreorder=e.is_preorder,a.loQuerystr=e.lo_querystr,a.featuredTrack=e.featured_track,a.urlHints=e.url_hints,Templ.runWithContext((function(){a.bandURL=Url.addQueryParams(Templ.filters.band_url(a.urlHints),{from:t.referrer()}),a.itemURL=Url.addQueryParams(Templ.filters.tralbum_url(a.urlHints),{from:t.referrer()}),a.buyURL=Url.addQueryParams(a.itemURL,{action:"download",from:t.referrer()})})),a.buyNow=function(){return Stats.record({kind:"click",click:"discover_buy_now"}),y("discover_buy_now","item-click",a),!0},a.hearMore=function(){return Stats.record({kind:"click",click:"discover_hear_more"}),y("discover_hear_more","item-click",a),!0},a.addToWishlist=function(){return Stats.record({kind:"click",click:"nav_button_collect"}),y("discover_wishlist","item-click",a),!0},a.bioImage=e.bio_image,a.title=e.primary_text,a.artist=e.secondary_text,a.genre=e.genre_text,a.location=e.location_text,a.playing=n.observable(!1);const i=[];let o;for(let t=1;t<5;t++)o="package_art"+t,e[o]&&i.push(e[o]);a.packageArts=n.observableArray(i),a.recommendations=new s(e,a),a.playMe=function(e,n){1===n.which&&t.player.playpauseItem(a)}}function l(e,t){const a=this;a.name=n.observable(e.name),a.value=n.observable(e.value),a.disabled=n.observable(null===e.value),a.isFiller=n.observable(e.filler),a.selected=n.computed((function(){return t.currentPage()===a.value()}));const i=e.forceHighlight&&e.forceHighlight===e.name||!e.forceHighlight&&t.highlight&&t.currentPage()===e.value;a.highlight=n.observable(i),a.immediate=n.observable(i),i&&setTimeout((function(){a.immediate(!1),a.highlight(!1)}),0),a.selectMe=function(){t.selectItem(a)}}function r(e,t){const a=this;a.numPages=n.observable(e),a.currentPage=n.computed({read:function(){return t.pageNumber()+1},write:function(e){t.pageNumber(e-1)}}),a.selectItem=function(e){const n=e.value(),i=e.name(),s="next"===i||"previous"===i?i:null;n&&n>0<=a.numPages()&&t.jumpToPage(n-1,null,s)},a.pagingItems=n.observableArray(),a.highlight=!1,a.update=function(e){const t=a.currentPage(),n=a.numPages(),i=[];if(n<2)return i;let s=2,o=n-1,r=!1,c=!1;n>9&&(t>6&&(r=!0),t<n-5&&(c=!0),r&&c?(s=t-2,o=t+2):r?s=n-6:c&&(o=7)),i.push(new l({name:TM("previous"),value:t>1?t-1:null,forceHighlight:e},a)),i.push(new l({name:"1",value:1,forceHighlight:e},a)),r&&i.push(new l({name:"...",filler:!0,forceHighlight:e},a));for(let t=s;t<=o;t++)i.push(new l({name:t,value:t,forceHighlight:e},a));c&&i.push(new l({name:"...",filler:!0,forceHighlight:e},a)),n>1&&i.push(new l({name:n,value:n,forceHighlight:e},a)),i.push(new l({name:TM("next"),value:t<n?t+1:null,forceHighlight:e},a)),a.pagingItems(i)},a.updateNext=function(){a.update("next")},a.updatePrev=function(){a.update("previous")},a.update(),a.highlight=!0,a.visible=n.observable(!0)}function c(e,t,a){const s=this;s.level=n.observable(0),s.pushHistory=a.history.pushHistory;const o=t&&Iter.find(e,(function(e){return e.value===t}))||e[0];s.pills=n.observableArray(e),s.selectedPill=n.observable(o),s.selectPill=function(e){return!s.pillIsSelected(e)&&(s.selectedPill(e),!0)},s.pillIsSelected=function(e){return s.selectedPill()===e},s.UISelectPill=function(e){s.selectPill(e)&&(y("discover_genre","pill-select",s.selectedPill()),s.pushHistory())},s.currentGenreValue=n.computed((function(){const e=s.selectedPill();return e?e.value:null})),s.backgroundColor=n.computed((function(){const e=i.get(s.currentGenreValue(),s.level());if(e)return"hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, "+e.alpha+")"})),s.backgroundFadeRight=n.computed((function(){const e=i.get(s.currentGenreValue(),s.level());if(e)return"linear-gradient(to right, hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, 0), hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, 1) 65%)"})),s.backgroundFadeLeft=n.computed((function(){const e=i.get(s.currentGenreValue(),s.level());if(e)return"linear-gradient(to left, hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, 0), hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, 1) 65%)"})),s.setByValue=function(e){if(null==e)s.selectedPill(s.pills()[0]);else{let t=Iter.find(s.pills(),(function(t){return t.value===e}));t||(t=s.pills()[0]),s.selectedPill(t)}},s.$container=a.$root.find(".discover-genres.client-rendered"),s.scrollLeftVisible=n.observable(!0),s.scrollRightVisible=n.observable(!0)}function d(e,t,a,s){const o=this;o.level=n.observable(1),o.pushHistory=s.history.pushHistory,o.selectedPill=n.observable(null);const l=t&&e[t]||[],r=a&&Iter.find(l,(function(e){return e.value===a}))||l[0];o.pills=n.observableArray(l),o.selectedPill=n.observable(r),o.immediatePillTransition=n.observable(!1),o.visible=n.computed({read:function(){return"all"!==s.genres.selectedPill().value&&"rec"!==s.slices.selectedPill().value&&o.pills().length>0},deferEvaluation:!0}),o.selectPill=function(e){return!o.pillIsSelected(e)&&(o.selectedPill(e),!0)},o.pillIsSelected=function(e){return o.selectedPill()===e},o.UISelectPill=function(e){o.selectPill(e)&&(y("discover_subgenre","pill-select",o.selectedPill()),o.pushHistory())},o.backgroundColor=n.computed((function(){const e=i.get(s.genres.currentGenreValue(),o.level());return e?"hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, "+e.alpha+")":""})),o.backgroundFadeRight=n.computed((function(){const e=i.get(s.genres.currentGenreValue(),o.level());return e?"linear-gradient(to right, hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, 0), hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, 1) 65%)":""})),o.backgroundFadeLeft=n.computed((function(){const e=i.get(s.genres.currentGenreValue(),o.level());return e?"linear-gradient(to left, hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, 0), hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, 1) 65%)":""})),o.setByValue=function(e){if(0!==o.pills().length)if(null==e)o.selectedPill(o.pills()[0]);else{let t=Iter.find(o.pills(),(function(t){return t.value===e}));t||(t=o.pills()[0]),o.selectedPill(t)}},o.$container=s.$root.find(".discover-subgenres.client-rendered"),o.scrollLeftVisible=n.observable(!0),o.scrollRightVisible=n.observable(!0)}function u(e,t,a){const s=this;s.level=n.observable(2),s.pushHistory=a.history.pushHistory;const o=t&&Iter.find(e,(function(e){return e.value===t}))||e[0];s.pills=n.observableArray(e),s.selectedPill=n.observable(o),s.selectPill=function(e){return!s.pillIsSelected(e)&&(s.selectedPill(e),!0)},s.pillIsSelected=function(e){return s.selectedPill()===e},s.UISelectPill=function(e){s.selectPill(e)&&(y("discover_slices","pill-select",s.selectedPill()),s.pushHistory())},s.selectedPill.subscribe((function(e){"rec"===e.value?(a.locations.selected(!1),a.formats.selected(!1),a.dates.selected(!1),a.subgenres.pills().length>0&&a.subgenres.selectPill(a.subgenres.pills()[0])):a.formats.selected(!0)})),s.backgroundColor=n.computed((function(){const e=i.get(a.genres.currentGenreValue(),s.level());return e?"hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, "+e.alpha+")":""})),s.setByValue=function(e){if(null==e)s.selectedPill(s.pills()[0]);else{let t=Iter.find(s.pills(),(function(t){return t.value===e}));t||(t=s.pills()[0]),s.selectedPill(t)}}}function p(e,t,a){const s=this;s.level=n.observable(2),s.pushHistory=a.history.pushHistory;let o=null;null!=t&&(o=Iter.find(e,(function(e){return parseInt(e.value)===t}))||e[0]),s.selectedPill=n.observable(o);const l=o&&0!==parseInt(o.value);s.selected=n.observable(l),s.pills=n.observableArray(e),s.selectPill=function(e){return!s.pillIsSelected(e)&&(s.selectedPill(e),!0)},s.pillIsSelected=function(e){return s.selectedPill()===e},s.UISelectPill=function(e){s.selectPill(e)&&(y("discover_location","pill-select",s.selectedPill()),s.pushHistory())},s.selectorVisible=n.computed((function(){return!(a.slices.selectedPill()&&"rec"===a.slices.selectedPill().value)})),s.toggleSelected=function(){const e=s.selected();(e||"rec"!==a.slices.selectedPill().value)&&s.selected(!e)},s.selected.subscribe((function(e){const t=s.pills();e?(Stats.record({kind:"click",click:"discover_location"}),y("discover_location","filter-on"),s.pillIsSelected(t[0])||(s.selectedPill(t[0]),s.pushHistory())):(y("discover_location","filter-off"),s.pillIsSelected(t[0])||(s.selectedPill(t[0]),s.pushHistory())),s.pushHistory()})),s.selectedPill.subscribe((function(e){e&&parseInt(e.value>0)&&(s.selected(!0),a.dates.selected(!1))})),s.backgroundColor=n.computed((function(){const e=i.get(a.genres.currentGenreValue(),s.level());return e?"hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, "+e.alpha+")":""})),s.backgroundFadeRight=n.computed((function(){const e=i.get(a.genres.currentGenreValue(),s.level());return e?"linear-gradient(to right, hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, 0), hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, 1) 65%)":""})),s.backgroundFadeLeft=n.computed((function(){const e=i.get(a.genres.currentGenreValue(),s.level());return e?"linear-gradient(to left, hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, 0), hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, 1) 65%)":""})),s.setByValue=function(e){if(null==e)s.selectedPill(s.pills()[0]);else{let t=Iter.find(s.pills(),(function(t){return t.value===parseInt(e)}));t||(t=s.pills()[0]),s.selectedPill(t)}},s.$container=a.$root.find(".discover-locations.client-rendered"),s.scrollLeftVisible=n.observable(!0),s.scrollRightVisible=n.observable(!0)}function m(e,t,a){const s=this;s.level=n.observable(2),s.pushHistory=a.history.pushHistory;const o=t&&Iter.find(e,(function(e){return e.value===t}))||e[0];s.pills=n.observableArray(e),s.selectedPill=n.observable(o),s.selectPill=function(e){return!s.pillIsSelected(e)&&(s.selectedPill(e),!0)},s.pillIsSelected=function(e){return s.selectedPill()===e},s.UISelectPill=function(e){s.selectPill(e)&&(y("discover_artist_recs","pill-select",s.selectedPill()),s.pushHistory())},s.visible=n.computed((function(){const e=a.slices.selectedPill();return!!e&&(e.value&&"rec"===e.value)})),s.backgroundColor=n.computed((function(){const e=i.get(a.genres.currentGenreValue(),s.level());return e?"hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, "+e.alpha+")":""})),s.setByValue=function(e){if(null==e)s.selectedPill(s.pills()[0]);else{let t=Iter.find(s.pills(),(function(t){return t.value===e}));t||(t=s.pills()[0]),s.selectedPill(t)}}}function f(e,t,a){const s=this;s.level=n.observable(3),s.pushHistory=a.history.pushHistory;const o=t&&Iter.find(e,(function(e){return e.value===t}))||e[0];s.pills=n.observableArray(e),s.selectedPill=n.observable(o),s.selectPill=function(e){return!s.pillIsSelected(e)&&(s.selectedPill(e),!0)},s.pillIsSelected=function(e){return s.selectedPill()===e},s.UISelectPill=function(e){s.statClick(e);s.selectPill(e)&&s.pushHistory()},s.selectorVisible=n.computed((function(){return!(a.slices.selectedPill()&&"rec"===a.slices.selectedPill().value)})),s.selected=n.observable(o),s.toggleSelected=function(){(s.selected()||"rec"!==a.slices.selectedPill().value)&&s.selected(!s.selected())},s.selected.subscribe((function(e){const t=s.pills();e?y("discover_format","filter-on"):(y("discover_format","filter-off"),t.length>0&&s.selectedPill()!==t[0]&&(s.selectedPill(t[0]),s.pushHistory()))})),s.selectedPill.subscribe((function(e){"all"!==e.value&&s.selected(!0)})),s.backgroundColor=n.computed((function(){const e=i.get(a.genres.currentGenreValue(),s.level());return e?"hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, "+e.alpha+")":""})),s.setByValue=function(e){if(null==e)s.selectedPill(s.pills()[0]);else{let t=Iter.find(s.pills(),(function(t){return t.value===e}));t||(t=s.pills()[0]),s.selectedPill(t)}},s.statClick=function(e){if(e){const t={all:"discover_format_all",digital:"discover_format_digital",vinyl:"discover_format_vinyl",cd:"discover_format_cd",cassette:"discover_format_cassette"}[e.value];t&&(Stats.record({kind:"click",click:t}),y("discover_format","pill-select",s.selectedPill()))}}}function h(e,t,a){const s=this;s.level=n.observable(4),s.pushHistory=a.history.pushHistory;const o=null!=t&&Iter.find(e,(function(e){return e.value===t}))||e[1];s.pills=n.observableArray(e),s.selectedPill=n.observable(o),s.selectPill=function(e){return!s.pillIsSelected(e)&&(s.selectedPill(e),!0)},s.pillIsSelected=function(e){return s.selectedPill()===e},s.UISelectPill=function(e){s.selectPill(e)&&(y("discover_date","pill-select",s.selectedPill()),s.pushHistory())},s.selectorVisible=n.computed((function(){const e="all"!==a.genres.currentGenreValue(),t=a.subgenres.selectedPill()&&a.subgenres.selectedPill()!==a.subgenres.pills()[0],n=a.locations.selectedPill()&&0!==parseInt(a.locations.selectedPill().value),i=a.slices.selectedPill()&&"rec"===a.slices.selectedPill().value;return!(t||i||e&&n)})).extend({rateLimit:100}),s.selected=n.observable(o&&null!==o.value&&void 0!==o.value&&0!==o.value),s.toggleSelected=function(){!s.selected()&&"rec"===a.slices.selectedPill().value||a.subgenres.selectedPill()&&a.subgenres.selectedPill()!==a.subgenres.pills()[0]||s.selected(!s.selected())},s.selected.subscribe((function(e){const t=s.pills(),n=s.selectedPill();e&&t.length>0?(s.pillIsSelected(t[1])||(s.selectedPill(t[1]),s.pushHistory()),Stats.record({kind:"click",click:"discover_date"}),y("discover_date","filter-on")):!e&&t.length>0&&(y("discover_date","filter-off"),s.selectorVisible()&&n!=t[1]?(s.pillIsSelected(t[1])||s.selectedPill(t[1]),s.selectedPill(t[1])):s.selectorVisible()||s.selectedPill(null))})),s.selectedPill.subscribe((function(e){e&&e.value&&s.selected(!0)})),s.backgroundColor=n.computed((function(){const e=i.get(a.genres.currentGenreValue(),s.level());return e?"hsla("+e.hue+", "+e.sat+"%, "+e.light+"%, "+e.alpha+")":""})),s.selectedDateJSON=n.computed((function(){const e=s.selectedPill();return e?e.data:null})),s.setByValue=function(e){if(null==e)s.selectedPill(s.pills()[1]);else{let t=Iter.find(s.pills(),(function(t){return t.value===parseInt(e)}));t||(t=s.pills()[1]),s.selectedPill(t)}}}function g(e){const a=this;a.stateChangeCallback=function(e){e&&("PLAYING"===e.newstate||"BUFFERING"==e.newstate?(a.currentItem().playing(!0),y("discover_playpause","status_changed",item)):"IDLE"!==e.newstate&&"PAUSED"!==e.newstate||(a.currentItem().playing(!1),y("discover_playpause","status_changed",item)))},a.playlist=new Player.Playlist(new WrapperSoundPlayer,"discover",null,{no_trackstate:!0}),a.playlist.onstatechanged(a.stateChangeCallback),a.inlinePlayer=new Player.InlinePlayerView(a.playlist,e.$root.find(".inline_player")[0]),a.currentItem=n.observable({});const i=e.currentPage().items();i&&i.length>0&&(a.currentItem(i[0]),a.playlist.load([a.currentItem().featuredTrack])),a.playpauseItem=function(t){a.currentItem()===t?(t.playing(!t.playing()),a.playlist.playpause(),y("discover_playpause","item-click",t)):(Iter.each(e.currentPage().items(),(function(e){e.playing(!1)})),t.playing(!0),a.currentItem(t),a.playlist.load([t.featuredTrack]),a.playlist.play_track(0,0),y("discover_playpause","item-click",t))},a.pause=function(){a.currentItem()&&(a.currentItem().playing(!1),a.playlist.pause(),y("discover_playpause","item-click",item))},a.hasCurrentItem=n.computed((function(){return a.currentItem()&&!t.isEmptyObject(a.currentItem())})),a.currentItem.subscribe((function(){setTimeout((function(){e.$root.find(".discover-detail-inner .collect-item").removeData("collect-item"),e.$root.find(".discover-detail-inner .collect-item").removeData("collect-band"),e.$root.find(".discover-detail-inner .collect-item").removeData("lo-querystr"),e.$root.find(".discover-detail-inner .collect-item").removeData("lo-from"),FanControls.initializeItems(e.$root.find(".discover-detail-inner")[0])}),0)}))}function b(e,t,a){const i=this;i.role=n.observable(e),i.items=n.observableArray(t),i.immediateTransition=n.observable(!1),i.pageNumber=n.observable(a),i.loading=n.observable(!1),i.loading.subscribe((function(e){Log.debug("Page with role "+i.role()+" loading: "+e)})),i.fadingIn=n.observable(!1),i.fadingOut=n.observable(!1),i.loading.subscribe((function(e){i.fadingIn(!e),i.fadingOut(e)}))}function _(a,i){this.pushHistory=function(){const n=t.extend({},i.currentParams()),s=a.concat(["p"]),o=function(e){const n={};return t.each(e,(function(e,t){null!=t&&(n[e]=t.toString())})),n}(n),l=Url.toHash(e.location.href),r=Url.parseQuery(l.search),c={};t.each(r,(function(e,t){s.indexOf(e)<0&&(c[e]=t)}));const d={};t.extend(d,c,o);let u=!1;if(t.each(s,(function(e){const t=s[e];d[t]!==r[t]&&(u=!0)})),u){l.search="?"+Url.joinQuery(d);const t=Url.fromHash(l);Log.debug("discover: pushing history: "+t),e.history&&e.history.pushState({},"",t)}},this.popHistory=function(a){const s=Url.parseQuery(e.location.search);Log.debug("discover: popping history: "+n.toJSON(s)),t.isEmptyObject(s)?i.navigateFromArgs(s):i.navigateFromArgs(s,!0)}}function y(e,t,n){const a={feature:"discover-homepage"};if(a.action=t,a.type=e,"pill-select"==t)a.pill={name:n.name,value:n.value};else if("item-click"==t||"status_changed"==t)a.item={title:n.title,artist:n.artist,band_id:n.bandId,item_id:n.itemId},"discover_playpause"==e&&(a.is_play=n.playing());else if("update"==t||"initial"==t){let e=null;void 0!==n.currentPage().items()&&(e=n.currentPage().items().map((function(e){return{title:e.title,artist:e.artist,band_id:e.bandId,item_id:e.itemId}}))),a.items=e,a.selected_filters=["genres","subgenres","slices","locations","formats","dates","artistRecs"].map((function(e){let t;const a=n[e].selectedPill();return t=void 0===a||null==a?"unset":a.name,e+":"+t})),a.location_selector_on=n.locations.selected(),a.format_selector_on=n.formats.selected(),a.date_selector_on=n.dates.selected()}BCTracker.record("click",a)}e.DiscoverVM=function(i,s){const l=this;function v(){let e=0;l.subgenres.visible()&&e++,l.slices.level(e+1),l.locations.level(e+2),l.locations.selected()&&e++,l.formats.level(e+2),l.formats.selected()&&e++,l.dates.level(e+2)}l.$root=t(i),l.history=new _(s.categories,l),t(e).on("popstate",l.history.popHistory),l.genres=new c(s.options.g,s.args.g,l),l.slices=new u(s.options.s,s.args.s,l),l.subgenres=new d(s.options.t,s.args.g,s.args.t,l),l.locations=new p(s.options.l,s.args.gn,l),l.formats=new f(s.options.f,s.args.f,l),l.artistRecs=new m(s.options.r,s.args.r,l),l.dates=new h(s.options.w,s.args.w,l),v(),l.subgenres.visible.subscribe((function(e){v()})),l.locations.selected.subscribe((function(e){v()})),l.formats.selected.subscribe((function(e){v()})),l.genres.selectedPill.subscribe((function(e){const t=s.options.t[e.value]||[];l.subgenres.pills(t),t.length>0?(l.subgenres.immediatePillTransition(!0),l.subgenres.selectedPill(t[0]),setTimeout((function(){l.subgenres.immediatePillTransition(!1)}),0)):l.subgenres.selectedPill(null)})),l.subgenres.selectedPill.subscribe((function(e){e&&e!==l.subgenres.pills()[0]&&l.dates.selected(!1)})),l.referrer=n.computed((function(){return"discover-"+l.slices.selectedPill().value})),l.pageNumber=n.observable(s.args.p),l.serverPageNumber=n.computed((function(){return Math.floor(l.pageNumber()/6)})),l.paging=new r(Math.min(Math.ceil(s.initial.total_count/8),200),l),l.pages=[new b("prev",[],-1),new b("current",[],0),new b("next",[],1)],l.prevPage=n.computed((function(){return Iter.find(l.pages,(function(e){return"prev"===e.role()}))})),l.currentPage=n.computed((function(){return Iter.find(l.pages,(function(e){return"current"===e.role()}))})),l.nextPage=n.computed((function(){return Iter.find(l.pages,(function(e){return"next"===e.role()}))})),l.pageForward=function(e,n){l.pageNumber(l.pageNumber()+1),y("discover_paging","page-forward",l);const a=t.extend({},l.currentParams()),i=l.pageNumber(),s=l.prevPage(),o=l.currentPage();let r=l.nextPage();l.fetchItems(a).then((function(t){r.items(t.items),l.paging.numPages(t.numPages),l.paging.update(n),s.immediateTransition(!1),o.immediateTransition(!1),r.immediateTransition(!1),r.role("current"),o.role("prev"),s.role("next"),r=s,r.immediateTransition(!0),r.pageNumber(i+1),l.cacheTheFuture(),e||l.history.pushHistory()}),(function(){}))},l.pageBackward=function(e,n){if(0===l.pageNumber())return;l.pageNumber(l.pageNumber()-1),y("discover_paging","page-backward",l);const a=t.extend({},l.currentParams()),i=l.pageNumber();let s=l.prevPage();const o=l.currentPage(),r=l.nextPage();l.fetchItems(a).then((function(t){s.items(t.items),l.paging.numPages(t.numPages),l.paging.update(n),s.immediateTransition(!1),o.immediateTransition(!1),r.immediateTransition(!1),s.role("current"),o.role("next"),r.role("prev"),s=r,s.immediateTransition(!0),s.pageNumber(i-1),l.cacheThePast(),e||l.history.pushHistory()}),(function(){}))},l.jumpToPage=function(e,n,a){const i=l.pageNumber();if(e===i+1)return l.pageForward(null,a);if(e===i-1)return l.pageBackward(null,a);l.pageNumber(e),y("discover_paging","page-jump",l);const s=t.extend({},l.currentParams());l.currentPage().loading(!0),l.paging.update(a),l.fetchItems(s,!0).then((function(e){l.currentPage().items(e.items),l.currentPage().loading(!1),l.cacheTheFuture(),l.cacheThePast(),n||l.history.pushHistory()}),(function(){}))},l.cacheTheFuture=function(){const e=t.extend({},l.currentParams());e.p=e.p+2;const a=n.toJSON(e);l.cache[a]||l.fetchItems(e)},l.cacheThePast=function(){const e=t.extend({},l.currentParams());if(e.p=e.p-2,e.p<0)return;const a=n.toJSON(e);l.cache[a]||l.fetchItems(e)},l.currentParams=n.computed((function(){const e=l.genres.selectedPill().value,t=l.slices.selectedPill().value,n={g:e,s:t,p:l.pageNumber()},a=l.locations.selectedPill();a&&null!==a.value&&(n.gn=a.value);const i=l.formats.selectedPill();i&&null!==i.value&&(n.f=i.value);const s=l.subgenres.selectedPill();s&&s.value&&!/all-/.test(s.value)&&(n.t=s.value);const o=l.dates.selectedPill();o&&null!==o.value&&!n.t&&(n.w=o.value);const r=l.artistRecs.selectedPill();return"rec"===t&&r.value&&(n.r=r.value),n})),l.currentParamsKey=n.computed((function(){return n.toJSON(l.currentParams())})),l.cache={},l.numPages={},l.instantiateItems=function(e){const t=[];return Iter.each(e,(function(e){t.push(new o(e,l))})),t},l.handleServerItems=function(e,a,i,s){const r={};let c,d;for(let e=0;e<a.length;e++)c=Math.floor(e/8)+6*s,r[c]||(r[c]=[]),r[c].push(new o(a[e],l));t.each(r,(function(t){const a=r[t],s=parseInt(t);e.p=s,d=n.toJSON(e),l.cache[d]||(l.cache[d]=a),l.numPages[d]||(l.numPages[d]=Math.min(Math.ceil(i/8),200))}))},l.fetchPromise=null,l.fetchItems=function(e,i){l.fetchPromise&&(l.fetchPromise.reject(),l.fetchPromise=null);const s=t.Deferred(),o=n.toJSON(e);if(l.fetchPromise=s,l.cache[o]){if(Log.debug("found items in the cache"),!i)return s.resolve({items:l.cache[o],numPages:l.numPages[o]});setTimeout((function(){return s.resolve({items:l.cache[o],numPages:l.numPages[o]})}),100)}else Log.debug("fetching items from the server"),a.get(e).then((function(t){return l.handleServerItems(e,t.items,t.total_count,t.args.p),s.resolve({items:l.cache[o],numPages:l.numPages[o]})}),(function(e){return Log.error("error fetching discover results: "+e),s.reject()}));return s.promise()},l.newFilters=function(){l.pageNumber(0);const e=t.extend({},l.currentParams()),n=l.currentPage();n.loading(!0),l.paging.visible(!1),l.fetchItems(e,!0).then((function(e){l.currentPage().items(e.items),l.paging.numPages(e.numPages),l.paging.update(),l.paging.visible(!0),n.loading(!1)}),(function(){}))},l.navigateFromArgs=function(e){const n={f:e.f||"all",g:e.g||"all",t:e.t||null,gn:e.gn||0,w:e.w||null,s:e.s||"top",p:e.p||0,r:e.r||null};let a=t.extend({},l.currentParams()),i=!0;t.each(n,(function(e,t){if("p"!==e){const t=null===n[e]||void 0===n[e],s=null===a[e]||void 0===a[e];(t&&!s||!t&&s||(!t&&n[e].toString())!==(!s&&a[e].toString()))&&(i=!1)}})),i&&parseInt(n.p)===parseInt(a.p+1)?l.pageForward(!0):i&&parseInt(n.p)===parseInt(a.p-1)?l.pageBackward(!0):i?l.jumpToPage(parseInt(n.p),!0):(l.genres.setByValue(n.g),l.subgenres.setByValue(n.t),l.slices.setByValue(n.s),l.formats.setByValue(n.f),l.locations.setByValue(n.gn),l.dates.setByValue(n.w),l.dates.selected()||l.dates.selected(null!==n.w&&parseInt(0!==n.w)),l.pageNumber(parseInt(n.p)),l.artistRecs.setByValue(n.r),l.currentPage().loading(!0),a=t.extend({},l.currentParams()),l.fetchItems(a,!0).then((function(e){l.currentPage().items(e.items),l.paging.numPages(e.numPages),l.currentPage().loading(!1),l.paging.visible(!0)}),(function(){})))},Iter.each(["genres","subgenres","slices","locations","formats","dates","artistRecs"],(function(e){l[e].selectedPill.subscribe((function(){l.newFilters(),y("discover_results","update",l)}))})),FanControls.delegate(l.$root),FanControls.start(),FanControls.initializeItems(l.$root),PopupImage.delegate(l.$root),l.handleServerItems(t.extend({},l.currentParams()),s.initial.server_items,s.initial.total_count,l.serverPageNumber()),l.currentPage().items(l.cache[l.currentParamsKey()]),y("discover_results","initial",l),l.player=new g(l),l.tumbleweedSrc=n.computed((function(){return l.currentPage().items()&&0!==l.currentPage().items().length?"":"/img/discover/discover-tumbleweed.gif"})),l.setupScrollers=function(){Iter.each(["genres","subgenres","locations"],(function(e){!function(e){function t(){if(e.$container.find(".selected")[0]){const t=e.$container.width(),n=e.$container[0].scrollWidth,a=e.$container.find(".selected").offset().left;e.$container.scrollLeft(a-t),e.scrollLeftVisible(e.$container.scrollLeft()>0),e.scrollRightVisible(e.$container.scrollLeft()+t<n)}}e.scrollRight=function(){y("discover_scroll_right","scroll");const t=e.$container.width(),n=e.$container[0].scrollWidth,a=e.$container.scrollLeft()+.5*t;e.$container.animate({scrollLeft:a},200),e.scrollLeftVisible(a>0),e.scrollRightVisible(a+t<n)},e.scrollLeft=function(){y("discover_scroll_left","scroll");const t=e.$container.width(),n=e.$container[0].scrollWidth,a=e.$container.scrollLeft()-.5*t;e.$container.animate({scrollLeft:a},200),e.scrollLeftVisible(a>0),e.scrollRightVisible(a+t<n)},t(),e.selected&&e.selected.subscribe((function(e){e&&t()})),e instanceof d&&(e.visible.subscribe((function(){t()})),l.genres.selectedPill.subscribe((function(){t()}))),e.$container.on("scroll",(function(){const t=e.$container.scrollLeft(),n=e.$container.width(),a=e.$container[0].scrollWidth;e.scrollLeftVisible(t>0),e.scrollRightVisible(t+n<a)}))}(l[e])}))},ScrollDepthTracker.track(document.getElementById("discover"),{element:"scroll_discover"})},e.DiscoverAPI=a}(window,jQuery,ko),function(e,t,n){"use strict";const a={initialize:function(n){let a=[];function i(){const i=n.currentPage().itemsWithVideo()[0];let s;if(Iter.each(a,(function(e){e.dispose()})),a=[],i)if("phone"===MediaView.mode||"iphone"===Browser.platform){const e=t(".notable-item video")[0];t(e).on("play",(function(){n.player.pause()})),Iter.each(n.currentPage().items(),(function(t){const n=t.playing.subscribe((function(t){t&&e.pause()}));a.push(n)})),s=i.showVideo.subscribe((function(t){t?e.play():e.pause()}))}else{n.xframe&&n.xframe.destroy();const o=t(".notable-video iframe")[0];n.xframe=new CrossFrame(e,o.contentWindow,siteroot_current);const l=t.Deferred();n.xframe.on("loaded",(function(){l.resolve()})),n.xframe.on("videoplaying",(function(){n.player.pause()})),s=i.showVideo.subscribe((function(e){e?l.then((function(){n.player.pause(),n.xframe.call("playvideo",{pos:0})})):n.xframe.call("stopvideo",{pos:0})})),a.push(s),Iter.each(n.currentPage().items(),(function(e){const t=e.playing.subscribe((function(e){e&&n.xframe.call("stopvideo",{pos:0})}));a.push(t)}))}}i(),n.renderVideoIframes.subscribe((function(e){if(e){if(0===n.currentPage().itemsWithVideo().length)return;setTimeout((function(){i()}),50)}})),n.mobilePage.items.subscribe((function(e){if(e){if(0===n.mobilePage.itemsWithVideo().length)return;i()}}))}};e.NotableVideo=a}(window,jQuery,ko),function(e,t,n){"use strict";const a=function(e){let n=0;const a=t(e).find(".notable-item");return a.length>0&&Iter.each(a,(function(e){let a=0;t(e).children().each((function(){a+=t(this).outerHeight(!0)})),a>n&&(n=a)})),n},i=function(e,n,a){t(e).css("min-height",a+20+"px"),t(n).find(".notable-item").css("min-height",a+20+"px")};function s(e,t,a,i){const s=this;s.title=e.title,s.artist=e.artist,s.video_id=e.video_id,s.artId=e.art_id,s.desc=e.desc,s.is_preorder=e.is_preorder,s.tralbumURL=Url.addQueryParams(e.tralbum_url,{from:"hpnn"}),s.tralbumBuyURL=Url.addQueryParams(e.tralbum_url,{from:"hpnnbn"}),s.loQuerystr=e.lo_querystr,s.dataItemId=e.id,s.playing=n.observable(!1),s.genre=e.genre,s.tralbumType=e.tralbum_type,s.tralbumKey=e.tralbum_type+e.tralbum_id,s.bandId=e.band_id,s.publishedDate=e.published_date,s.playing=n.observable(!1),s.featuredTrack={id:e.audio_track_id,file:e.audio_url,duration:e.audio_duration},s.playMe=function(){s.videoAttributes||a.player.playpauseItem(s)},s.videoAttributes=null,e.video_info&&(s.videoAttributes={videoId:e.video_info.video_id,mobileURL:"//bandcamp.23video.com"+e.video_info.mobile_url,iframeSrc:"/video_frame?video_id="+e.video_info.video_id,aspect:e.video_info.original_aspect,posterImageId:e.video_info.poster_image_id,posterFallbackURL:e.video_info.poster_fallback_url,orientation:!e.video_info.original_aspect||e.video_info.original_aspect>=1?"landscape":"portrait",duration:Time.strftime(new Date(1e3*e.video_info.duration),e.video_info.duration>=3600?"%H:%M:%S":"%M:%S")},s.videoAttributes.videoFormat="video_"+s.videoAttributes.orientation,s.videoAttributes.posterURL=s.videoAttributes.posterFallbackURL,s.videoAttributes.backgroundStyle="url("+s.videoAttributes.posterURL+") center no-repeat",s.videoAttributes.backgroundSize="phone"===MediaView.mode?"cover":"100%"),s.hasVideo=null!==s.videoAttributes,s.showVideo=n.observable(!1),s.playVideo=function(){Stats.record({kind:"click",click:"homepage_new_notable_video_play"}),s.showVideo(!0)},s.isCurrentPage=n.computed((function(){return!!i&&"current"===i.role()})),s.immediate=0===parseInt(t)&&a.immediate}function o(e){const t=this;t.stateChangeCallback=function(e){e&&("PLAYING"===e.newstate||"BUFFERING"==e.newstate?t.currentItem.playing(!0):"IDLE"!==e.newstate&&"PAUSED"!==e.newstate||t.currentItem.playing(!1))},t.playlist=new Player.Playlist(new WrapperSoundPlayer,"new_and_notable",null,{no_trackstate:!0}),t.playlist.onstatechanged(t.stateChangeCallback),t.currentItem=null,t.playpauseItem=function(n){t.currentItem===n?(n.playing(!n.playing()),t.playlist.playpause()):(Iter.each(e.currentPage().items(),(function(e){e.playing(!1)})),n.playing(!0),t.currentItem=n,t.playlist.load([n.featuredTrack]),t.playlist.play_track(0,0))},t.pause=function(){t.currentItem&&t.currentItem.playing(!1),t.playlist.pause()}}function l(e,t,a){const i=this;i.role=n.observable(e),i.items=n.observableArray(t),i.itemsWithVideo=n.computed((function(){const e=i.items();return Iter.findAll(e,(function(e){return e.hasVideo}))})),i.immediateTransition=n.observable(!1),i.pageNumber=n.observable(a),i.loading=n.observable(!1),i.loading.subscribe((function(e){Log.debug("Page with role "+i.role()+" loading: "+e)})),i.fadingIn=n.observable(!1),i.fadingOut=n.observable(!1),i.loading.subscribe((function(e){i.fadingIn(!e),i.fadingOut(e)})),i.maxHeight=null}e.NotableVM=function(r,c,d,u){const p=this;p.$root=t(r),p.data=d,p.fanData=u,p.sequence=c,p.sequenceVideos=[],p.nextAvailPage=0,p.pageCount=0,p.numVideosOnPage=[],p.pageIndex=0,p.getPageCount=function(){return Math.max(p.pageCount,Math.ceil(p.sequence.length/5))},p.pages=[new l("prev",[],-1),new l("current",[],0),new l("next",[],1)],p.mobilePage=new l("current",[],0),p.prevPage=n.computed((function(){return Iter.find(p.pages,(function(e){return"prev"===e.role()}))})),p.currentPage=n.computed((function(){return Iter.find(p.pages,(function(e){return"current"===e.role()}))})),p.nextPage=n.computed((function(){return Iter.find(p.pages,(function(e){return"next"===e.role()}))})),p.leftActive=n.observable(!1),p.rightActive=n.observable(p.pageIndex<p.getPageCount()-1),p.loading=!1,p.loadedTo=0,p.preloading=!1,p.videoSequenceInitted=!1,p.renderVideoIframes=n.observable(!0),p.immediate=!0,p.ready=!1,p.player=new o(p),p.updateSequenceVideo=function(){let e=!1;t.each(p.sequence.slice(p.loadedTo,p.sequence.length),(function(t,n){if(!p.data[n])return p.loadedTo=p.loadedTo+t,e=!0,!1;if(null===p.data[n].video_id){for(;p.pageIsComplete(p.nextAvailPage);)p.nextAvailPage++,p.nextAvailPage>=p.getPageCount()&&(p.sequenceVideos[p.nextAvailPage]=[],p.pageCount=p.nextAvailPage);p.sequenceVideos[p.nextAvailPage].push(n)}else if(p.hasSpaceForVideo(p.nextAvailPage))p.sequenceVideos[p.nextAvailPage].push(n),p.numVideosOnPage[p.nextAvailPage]++;else{let e=1;for(;!p.hasSpaceForVideo(p.nextAvailPage+e);)e++;p.sequenceVideos[p.nextAvailPage+e].push(n),p.numVideosOnPage[p.nextAvailPage+e]++,p.pageCount=p.sequenceVideos.length}})),e||(p.loadedTo=p.sequence.length)},p.initVideoSequence=function(){const e=p.getPageCount();for(let t=0;t<e;t++)p.sequenceVideos[t]=[],p.numVideosOnPage[t]=0;p.videoSequenceInitted=!0,p.updateSequenceVideo()},p.appendItems=function(e,t){p.videoSequenceInitted||p.initVideoSequence();const n=[];Iter.each(p.sequenceVideos[e],(function(a){const i=p.data[a];n.push(new s(i,e,p,t))})),p.currentPage().items(p.currentPage().items().concat(n)),p.mobilePage.items(p.mobilePage.items().concat(n)),p.updateActives()},p.instantiateItems=function(e,t){const n=[];return Iter.each(p.sequenceVideos[e],(function(a){const i=p.data[a];n.push(new s(i,e,p,t))})),n},p.hideVideos=function(){Iter.each(p.currentPage().items(),(function(e){e.showVideo(!1)})),p.renderVideoIframes(!1)},p.renderTimeout=null,p.paging=n.observable(!1),p.postPageAction=null,p.pageRight=function(){const e=p.pageIndex+1;if(e<0||e>=p.getPageCount()||e==p.pageIndex)return;if(p.paging())return void(p.postPageAction=p.pageRight);p.paging(!0),p.player.pause(),p.hideVideos(),p.renderTimeout&&clearTimeout(p.renderTimeout);const t=p.prevPage(),n=p.currentPage();let a=p.nextPage();p.pageIndex=e,a.maxHeight&&i(p.$root.find(".notable-results")[0],p.$root.find(".result-next")[0],a.maxHeight),t.immediateTransition(!1),n.immediateTransition(!1),a.immediateTransition(!1),a.role("current"),n.role("prev"),t.role("next"),a=t,a.immediateTransition(!0),a.pageNumber(p.pageIndex+1),p.updateActives(),p.populateNextPage(),p.renderTimeout=setTimeout((function(){p.paging(!1),p.postPageAction?(p.postPageAction(),p.postPageAction=null):p.renderVideoIframes(!0)}),500)},p.pageLeft=function(){const e=p.pageIndex-1;if(e<0||e>=p.getPageCount()||e==p.pageIndex)return;if(p.paging())return void(p.postPageAction=p.pageLeft);p.paging(!0),p.player.pause(),p.hideVideos(),p.renderTimeout&&clearTimeout(p.renderTimeout);let t=p.prevPage();const n=p.currentPage(),a=p.nextPage();p.pageIndex=e,t.maxHeight&&i(p.$root.find(".notable-results")[0],p.$root.find(".result-prev")[0],t.maxHeight),t.immediateTransition(!1),n.immediateTransition(!1),a.immediateTransition(!1),t.role("current"),n.role("next"),a.role("prev"),t=a,t.immediateTransition(!0),t.pageNumber(p.pageIndex-1),p.updateActives(),p.populatePrevPage(),p.renderTimeout=setTimeout((function(){p.paging(!1),p.postPageAction?(p.postPageAction(),p.postPageAction=null):p.renderVideoIframes(!0)}),500)},p.populateNextPage=function(){const e=p.pageIndex;e+1<=p.getPageCount()-1&&p.prefetch(e+1).then((function(){const t=p.nextPage();t.items(p.instantiateItems(e+1,t)),setTimeout((function(){const e=a(p.$root.find(".result-next")[0]);t.maxHeight=e}),0)}))},p.populatePrevPage=function(){const e=p.pageIndex;e-1>=0&&p.prefetch(e-1).then((function(){const t=p.prevPage();t.items(p.instantiateItems(e-1,t)),setTimeout((function(){const e=a(p.$root.find(".result-prev")[0]);t.maxHeight=e}),0)}))},p.pageIsComplete=function(e){return p.sequenceVideos[e].length==5-p.numVideosOnPage[e]},p.hasSpaceForVideo=function(e){if(!(e<0))return p.sequenceVideos[e]||(p.sequenceVideos[e]=[]),p.numVideosOnPage[e]||(p.numVideosOnPage[e]=0),p.numVideosOnPage[e]<1&&p.sequenceVideos[e].length<4},p.loadTralbums=function(e){const n=t.Deferred().resolve().promise();if(!p.pageIsComplete(e)){const e=p.loadedTo+15,n=p.sequence.slice(p.loadedTo,e);let a="/api/notabletralbum/2/get?id="+n.join(",");if(Identities.fan()||(a=a+"&lo=1&lo_action_url="+siteroot_https),n.length>0)return t.ajax({type:"GET",url:a,dataType:"json"}).then((function(e){t.extend(p.data,e),p.updateSequenceVideo()}))}return n},p.prefetch=function(e){let n=t.Deferred().resolve().promise();return p.pageIsComplete(e)||(p.preloading=p.loadTralbums(e).then((function(){p.preloading=!1})),n=p.preloading.then((function(){}))),n},p.loadingInline=n.observable(!1),p.loadPageInline=function(){const e=p.pageIndex+1;if(e<0||e>=p.getPageCount()||e==p.pageIndex)return;p.loadingInline(!0);p.prefetch(e).then((function(){p.loadingInline(!1),p.pageIndex=e,p.appendItems(e)}))},p.doFirstPage=function(){p.initVideoSequence(),p.immediate=!0;const e=p.prevPage(),t=p.currentPage();let n=p.nextPage();const s=p.instantiateItems(0,n);n.items(s),p.mobilePage.items(s),n.maxHeight=a(p.$root.find(".result-next")[0]),n.maxHeight>0&&i(p.$root.find(".notable-results")[0],p.$root.find(".result-next")[0],n.maxHeight),n.immediateTransition(!0),n.role("current"),t.role("prev"),e.role("next"),n=e,n.immediateTransition(!0),p.populateNextPage(),p.immediate=!1,p.ready=!0},p.updateActives=function(){p.leftActive(p.pageIndex>0),p.rightActive(p.pageIndex<p.getPageCount()-1)},p.postBinding=function(){"phone"===MediaView.mode||e.innerWidth<=740?p.appendItems(0):p.doFirstPage(),p.$root.find(".notable-results").scroll((function(){const e=t(this);0!==e.find(".result-mobile:visible").length&&!p.loadingInline()&&e.scrollLeft()>this.scrollWidth-e.width()-100&&p.loadPageInline()}))},FanControls.delegate(p.$root),p.afterItemsRender=function(e){setTimeout((function(){FanControls.initializeItems(e)}),0),p.$root.find(".item-desc a").each((function(){!function(e,n){const a=t(e),i=Url.toHash(a.attr("href"));if(/^\/(album|track)\//.test(i.pathname)){const e=Url.parseQuery(i.search);e.from=n,i.search="?"+Url.joinQuery(e),a.attr("href",Url.fromHash(i))}}(this,"hpnn")}))}}}(window,jQuery,ko),function(){"use strict";const e=ko.observable(new Date);setInterval((function(){e(new Date)}),1e3);const t=function(t){const n=this;n.eventId=t.event_id,n.token=t.token,n.isListeningParty=ko.observable("l"===t.event_type),n.title=t.title,n.artist=t.artist,n.imageId=t.image_id,n.albumArtId=t.album_art_id,n.imageURL=ImageUtils.imageURL(n.imageId,"bio_app",!0),n.description=ko.observable(t.description),n.fullDescription=t.description,n.liveEventUrl=t.live_event_url,n.liveTicketUrl=t.live_ticket_url,n.liveStartDateGMT=t.scheduled_start_date,n.liveStartDate=Templ.filters.time(t.scheduled_start_date,"yyyyMMMMd",Intl.DateTimeFormat().resolvedOptions().timeZone),n.liveStartTime=Templ.filters.time(t.scheduled_start_date,"hhmmzz",Intl.DateTimeFormat().resolvedOptions().timeZone),n.scheduledStartDate=new Date(n.liveStartDateGMT),n.isLive=ko.computed((()=>n.scheduledStartDate-e()<0)),n.doorsOpen=ko.computed((()=>n.scheduledStartDate-e()<18e5)),n.startingSoon=ko.computed((()=>n.scheduledStartDate-e()>=0&&n.scheduledStartDate-e()<18e5)),e().getDate()===n.scheduledStartDate.getDate()&&e().getMonth()===n.scheduledStartDate.getMonth()&&e().getFullYear()===n.scheduledStartDate.getFullYear()&&(n.startingSoon()?n.liveStartDate='<span class="today">'+TM("Starting soon")+"</span>":n.liveStartDate='<span class="today">'+TM("Today!")+"</span>"),n.isAttending=ko.observable(t.is_attending),n.includesDigital=ko.observable(t.includes_digital),n.showPrice=ko.observable(!n.isAttending()),n.showIncludesDigital=ko.observable(n.showPrice()&&n.includesDigital()),n.showJoinStream=ko.observable(n.doorsOpen()&&n.isAttending()),n.imageColorOne=ko.observable(t.image_color_one),n.imageColorTwo=ko.observable(t.image_color_two),n.gradient=ko.computed((function(){return"linear-gradient(180deg, #".concat(n.imageColorOne(),", #").concat(n.imageColorOne(),"B3 50%, #").concat(n.imageColorTwo(),"00 100%)")})),n.minutes=ko.observable(),n.startedTime=ko.observable(),n.updateMinutes=function(){if(!n.startedTime())return;const e=new Date;n.minutes(Math.floor((e-n.startedTime())/6e4))},n.startedString=ko.computed((function(){return n.minutes()<60?TP("Started 1 minute ago","Started {{count}} minutes ago",n.minutes(),{},"How many minutes since the live stream has started"):TP("Started 1 hour ago","Started {{count}} hours ago",Math.floor(n.minutes()/60),{},"How many hours since the live stream has started")})),t.start_date&&(n.startedTime(new Date(t.start_date)),n.updateMinutes(),setInterval(n.updateMinutes,6e4)),n.moreElem=document.createElement("a"),n.moreElem.innerText=TM("Read more"),n.moreElem.href=t.live_ticket_url};window.CuratedShowsManager=function(e){const n=this;let a=null;n.listingVMs=ko.observableArray();for(let i=0;i<e.length;i++)a=new t(e[i]),n.listingVMs.push(a)}}();var HomeFeedReader=LangUtils.makeclass({ctor:function(e){this._feedData=e,this._clientServerDelay=1e3*this._feedData.server_time-(new Date).valueOf(),this._onfeedevent=EventSender.create(this,"feedevent"),this._onfeedupdate=EventSender.create(this,"feedupdate");const t=this;setTimeout((function(){t._onfeedupdate(t._feedData),t._schedule_work()}),1)},prototype:{_do_work:function(){this._scheduled=null;try{const e=this._now();for(this._low_water_time&&e>this._low_water_time&&this._get_data();this._events_due();){const e=this._feedData.events.shift();this._onfeedevent(e)}}catch(e){this.debug("_do_work: caught: "+e)}this._schedule_work()},_events_due:function(){if(this._feedData.events.length>0){const e=this._now();return new Date(1e3*(this._feedData.events[0].utc_date+this._feedData.data_delay_sec))<e}return!1},_get_data:function(){if(this._fetch_pending)return;this.debug("getting data (low water time: "+this._low_water_time+")");const e=this;e._fetch_pending=!0;const t=this._feedData.end_date;this.debug("requesting data with start_date of "+t+"(server time is "+this._now().valueOf()/1e3+")");const n=HomeFeedReader.FEED_URL+"?"+Url.joinQuery({start_date:t});$.ajax({url:n,type:"GET",dataType:"json",success:function(t){e._fetch_pending=!1,e._low_water_time=null,e._feed_recv(t)},failure:function(t){e._fetch_pending=!1,e._low_water_time=null,e._feed_failure(t)}})},_now:function(){return new Date((new Date).valueOf()+this._clientServerDelay)},server_date:function(e){return new Date(1e3*e-this._clientServerDelay)},_calc_low_water_time:function(){if(!this._low_water_time||this._low_water_time<this._now()){this.debug("feed end_date: "+this._feedData.end_date+" (="+new Date(1e3*this._feedData.end_date)+")");const e=new Date(1e3*(this._feedData.end_date+.5*this._feedData.data_delay_sec+Math.random()*this._feedData.data_delay_sec/4));this.debug("will request new data "+(e.valueOf()/1e3-this._feedData.end_date)+" sec after feed end_date (at "+e+")"),this._low_water_time=e}},_schedule_work:function(){if(this._scheduled)return;let e=null,t=null,n=null;if(this._fetch_pending||(this._calc_low_water_time(),e=this._low_water_time.valueOf()-this._now().valueOf(),isNaN(e)&&(Log.error("fetch_wait is nan"),e=null),e<0&&(e=0)),this._feedData.events&&this._feedData.events.length>0){const e=this._feedData.events[0];t=new Date(1e3*(e.utc_date+this._feedData.data_delay_sec)).valueOf()-this._now().valueOf(),n=e.event_type}let a=null,i=null;if(null!=e&&null!=t?e<t?(i="fetching data in "+e+"ms.",a=e):("sale"==n&&(i="feed event ("+n+") in "+t+"ms. (fetch data in "+e+"ms)"),a=t):null!=e?(i="no more events. fetching data in "+e+"ms.",a=e):null!=t&&(i="feed event ("+n+") in "+t+"ms.",a=t),null!=a){const e=this;a=Math.max(a,0),this._scheduled=setTimeout((function(){e._do_work()}),a)}else this._fetch_pending||Log.error("_schedule work: delay is null with no request pending?")},_feed_recv:function(e){this.debug("got feed data: "+e);const t=e,n=t.events;if(n)for(;n.length>0;){const e=n.shift();e.utc_date>this._feedData.end_date&&this._feedData.events.push(e)}t.end_date?(this.debug("feed data received: new end_date "+t.end_date+", old end_date "+this._feedData.end_date+" ("+(t.end_date-this._feedData.end_date)+" sec newer)"),this._feedData.end_date=t.end_date):(this.debug("feed failed; new low water time in 120 sec"),this._low_water_time=new Date(this._now().valueOf()+12e4)),t.data_delay_sec&&(this._feedData.data_delay_sec=t.data_delay_sec),this._onfeedupdate(this._feedData),this._schedule_work()},_feed_failure:function(e){this.debug("feed fetch failed: "+e)},debug:function(e){}},statics:{FEED_URL:"/api/salesfeed/1/get"}});!function(e,t,n){"use strict";e.SalesFeedControl=function(){var n={init:function(a,i,s){n.prefersReducedMotion=e.matchMedia&&(e.matchMedia("(prefers-reduced-motion: reduce)")||{}).matches,n.prefersReducedMotion||(void 0===s&&(s={}),n.$root=t(a).first(),n.$list=n.$root.find(".salesfeed-items"),n.$preloadList=n.$root.find(".preload-salesfeed-items"),n.feedData=i,n.reader=new HomeFeedReader(i||{}),n.reader.onfeedevent(t.proxy(n,"handleFeedEvent")),n.reader.onfeedupdate(t.proxy(n,"handleFeedUpdate")),n.itemsPerRow=s.itemsPerRow||8,n.itemTempl=s.itemTempl||"home/home_2015/salesfeed_item",n.itemPreloadTempl=s.itemPreloadTempl,n.isDev=String.prototype.endsWith&&Templ.getGlobals().sitedomain.endsWith("bcdevs.com"),n.pausable=void 0===s.pausable||s.pausable,n.paused=!1,n.pauseQueue=[],n.pausable&&Capabilities.hasHover()&&n.$root.on("mouseenter mouseleave",".salesfeed-item",(function(e){t(this).toggleClass("selected")})).find(".salesfeed-bd").on("mouseenter mouseleave",(function(e){n.playPauseFeed("mouseenter"==e.type)})),setInterval(n.updateItems,300))},handleFeedEvent:function(e){"sale"==e.event_type&&t.each(e.items,(function(e,t){if(!t.art_id&&!t.package_image_id)return!0;n.paused?n.queueItem(t):n.renderItemIntoFeed(t)}))},handleFeedUpdate:function(e){if(n.itemPreloadTempl)for(let t=0;t<e.events.length;++t){const a=e.events[t];if("sale"==a.event_type)for(let e=0;e<a.items.length;++e)n.preloadItem(a.items[e])}},preloadItem:function(e){const t=n.renderItem(e,n.itemPreloadTempl);t.prependTo(n.$preloadList),e.preloaded=t},renderItemIntoFeed:function(t){var a;t.utc_date_rounded=Math.floor(t.utc_date),t.seconds_since=n.secondsSince(t.utc_date_rounded);const i=t.country_code,s=null===(a=Translate)||void 0===a?void 0:a.locale;s&&"en"!==s&&i&&e.Country&&(t.country=Country.name(i));n.renderItem(t,n.itemTempl).prependTo(n.$list),t.preloaded&&(t.preloaded.remove(),t.preloaded=null),setTimeout((function(){n.pruneItem()}),1e3)},renderItem:function(e,a){if(n.isDev){var i=TemplGlobals.image_siteroot;TemplGlobals.image_siteroot="https://f4.bcbits.com"}const s=t(Templ.render(a,{item:e}));return n.isDev&&(TemplGlobals.image_siteroot=i),s},updateItems:function(){document.querySelectorAll(".salesfeed-item").forEach((e=>{const t=parseInt(e.querySelector(".item-timestamp").dataset.utcDate),a=n.secondsSince(t),i=a<=1?TM("1 second ago"):TM("{{seconds}} seconds ago","pre",{seconds:a});e.querySelector(".now").innerText=i}))},pruneItem:function(){for(;n.$list.children().length>n.itemsPerRow+1;)n.$list.find("li:last-child").remove()},playPauseFeed:function(e){if(!n.prefersReducedMotion){if(void 0===e&&(e=!n.paused),e){const e=document.querySelector(".salesfeed-humour");if(e){const t=[TM("(and yes, this really is a live feed — I can’t believe you thought it was canned!)"),TM("(and yes, this really is a live feed — when you hear “nobody pays for music anymore,” that’s just The Man spreading his agenda)")],a=Math.floor(Math.random()*t.length);e.textContent=t[a],n.humourTimer=setTimeout((function(){e.classList.add("visible")}),3500)}}else{const e=document.querySelector(".salesfeed-humour");e&&e.classList.remove("visible"),n.humourTimer&&clearTimeout(n.humourTimer)}n.paused=!!e,e?n.$root.addClass("paused"):(n.$root.removeClass("paused"),n.flushQueue())}},queueItem:function(e){const t=n.pauseQueue;t.unshift(e),t.length>n.itemsPerRow&&(t.length=n.itemsPerRow),Log.debug("salesfeed: pause queue: new length: ",t.length,", new item: ",e)},flushQueue:function(){const e=n.pauseQueue;Log.debug("salesfeed: rendering ",e.length,"queued items"),t.each(e.reverse(),(function(e,t){n.renderItemIntoFeed(t)})),e.length=0},secondsSince:function(e){return Math.floor((new Date).getTime()/1e3-e-n.feedData.data_delay_sec)}};return n.init.apply(n,arguments),n}}(window,jQuery,ko);var FanSpotlightControl=function(){var e={init:function(t,n,a,i,s){e.$root=$(t).first(),e.$header=e.$root.find("h3"),e.pageIndex=i||0,e.seq=n.map((function(e){return e.fan_id}))||[],e.data=a||{},e.fanData=s,e.loadingTo=2,e.loadedTo=2,e.preloading=!1,e.loadingSpinner=$("<img class='loading' src='/img/loading-dark.gif'>"),e.pageData=$("#pagedata").data("blob")||{},e.doFirstPage(),e.$root.lazyload({threshold:500,appear:function(){e.populateNextPage()}}),e.$root.find(".stepper-next").on("mousedown",(function(t){return e.pageRight(),t.preventDefault(),!1})),e.$root.find(".stepper-prev").on("mousedown",(function(t){return e.pageLeft(),t.preventDefault(),!1})),e.updateFlipButtons(),e.setupPlaylist(),FanControls.delegate(e.$root),FanControls.initializeItems(e.$root)},pageCount:function(){return Math.ceil(e.seq.length/2)},pageRight:function(){const t=e.pageIndex+1;if(t<0||t>=e.pageCount()||t==e.pageIndex)return;e.playlist.stop(),e.pageIndex=t,e.$root.find(".spotlight-result").removeClass("immediate");let n=e.$root.find(".result-next");const a=e.$root.find(".result-current"),i=e.$root.find(".result-prev"),s=e.getMaxHeight(n[0]);s>0&&e.setContainerHeight(s),n.removeClass("result-next"),n.addClass("result-current"),a.removeClass("result-current"),a.addClass("result-prev"),i.removeClass("result-prev"),i.addClass("result-next"),n=i,n.addClass("immediate"),e.populateNextPage(),e.updateFlipButtons(),FanControls.initializeItems(e.$root)},populateNextPage:function(){const t=e.pageIndex+1;t<=e.pageCount()-1&&e.prefetch(t).then((function(){const n=2*t,a=$.map(e.seq.slice(n,n+2),(function(t){return e.data[t]})),i=Templ.render("home/home_2015/spotlight_content",{fnsps:a,fcd:e.fanData,page_identities:Identities.initialData,animate:!0});e.$root.find(".result-next").html(i)}))},pageLeft:function(){const t=e.pageIndex-1;if(t<0||t>=e.pageCount()||t==e.pageIndex)return;e.playlist.stop(),e.pageIndex=t,$(".spotlight-result").removeClass("immediate");const n=e.$root.find(".result-next"),a=e.$root.find(".result-current");let i=e.$root.find(".result-prev");const s=e.getMaxHeight(i[0]);s>0&&e.setContainerHeight(s),i.removeClass("result-prev"),i.addClass("result-current"),a.removeClass("result-current"),a.addClass("result-next"),n.removeClass("result-next"),n.addClass("result-prev"),i=n,i.addClass("immediate"),e.populatePrevPage(),e.updateFlipButtons(),FanControls.initializeItems(e.$root)},populatePrevPage:function(){const t=e.pageIndex-1;t>=0&&e.prefetch(t).then((function(){const n=2*t,a=$.map(e.seq.slice(n,n+2),(function(t){return e.data[t]})),i=Templ.render("home/home_2015/spotlight_content",{fnsps:a,fcd:e.fanData,page_identities:Identities.initialData,animate:!0});e.$root.find(".result-prev").html(i)}))},updateFlipButtons:function(){e.$root.find(".stepper-prev, .stepper-next").removeClass("inactive"),e.pageIndex+1>=e.pageCount()&&e.$root.find(".stepper-next").addClass("inactive"),0===e.pageIndex&&e.$root.find(".stepper-prev").addClass("inactive")},setupPlaylist:function(){if(e.playlist)return;const t=new Player.Playlist(new LazySound,"featured_fan",null,{no_trackstate:!0});e.playlist=t,t.onstatechanged((function(t){if(e.$root.find(".playable").removeClass("playing busy"),("PLAYING"==t.newstate||"BUFFERING"==t.newstate)&&e._currentlyPlaying){const n=".playable[data-fanid="+e._currentlyPlaying.id+"][data-subitem-index="+e._currentlyPlaying.index+"]";e.$root.find(n).addClass("BUFFERING"==t.newstate&&Capabilities.hasAnimation()?"busy":"playing")}})),e.$root.on("click",".playable",(function(t){if(t.ctrlKey||t.metaKey||t.shiftKey)return!0;const n=e.playlist.get_track_info(),a=$(t.target).closest(".playable").data("fanid"),i=$(t.target).closest(".playable").data("subitem-index");Log.debug("playing item id "+a+" subitem index "+i);const s=e.data[a],o=s&&s.items[i];if(o)if(n&&e._currentlyPlaying.id==a&&e._currentlyPlaying.index==i)e.playlist.playpause();else{const t={file:o.stream_url,id:o.audio_track_id};e._currentlyPlaying={id:a,index:i},e.playlist.load([t]),e.playlist.play_track(0,0)}else Log.error("got a click but don't have data for id "+a),e.playlist.stop();return!1}))},idsForPage:function(t){const n=2*t,a=n+12;return e.seq.slice(n,a)},loadData:function(t){let n="/api/featuredfan/1/get?id="+e.idsForPage(t).join(",");return Identities.fan()||(n=n+"&lo=1&lo_action_url="+siteroot_https),$.ajax({type:"GET",url:n,dataType:"json"}).then((function(t){$.extend(e.data,t),e.loadedTo=e.loadingTo}))},prefetch:function(t){let n=$.Deferred().resolve().promise();return e.preloading||t+2>e.loadingTo&&(e.loadingTo+=6,e.preloading=e.loadData(e.loadedTo).then((function(){e.preloading=!1}))),t+1>e.loadedTo&&(e.showLoadingSpinner(),n=e.preloading.then((function(){e.hideLoadingSpinner()}))),n},showLoadingSpinner:function(){e.$header.find(".loading").length||(e.loading=!0,e.$header.append(e.loadingSpinner))},hideLoadingSpinner:function(){e.loading=!1,e.$header.find(".loading").remove()},doFirstPage:function(){let t=e.$root.find(".result-next");const n=e.$root.find(".result-current"),a=e.$root.find(".result-prev"),i=$.map(e.seq.slice(0,2),(function(t){return e.data[t]})),s=Templ.render("home/home_2015/spotlight_content",{fnsps:i,fcd:e.fanData,page_identities:Identities.initialData,animate:!0});t.html(s);const o=e.getMaxHeight(t[0]);o>0&&e.setContainerHeight(o),t.addClass("immediate"),t.removeClass("result-next"),t.addClass("result-current"),n.removeClass("result-current"),n.addClass("result-prev"),a.removeClass("result-prev"),a.addClass("result-next"),t=a,t.addClass("immediate")},getMaxHeight:function(t){let n=0;const a=e.$root.find(t).find(".spotlight-unit");return a.length>0&&Iter.each(a,(function(e){const t=$(e);t.height()>n&&(n=t.height())})),n},setContainerHeight:function(t){e.$root.find(".spotlight-results").css("min-height",t+20+"px")}};return e.init.apply(e,arguments),e};!function(){"use strict";const e=t={bcwControl:null,init:function(){const e=$("#pagedata").data("blob");FraudReCaptcha.execute("visit_homepage"),t.initCarousel(e),t.initBCDaily(e),setTimeout((function(){t.initNotable(e),t.initCuratedShows(e)}),100),"phone"!=MediaView.mode&&(setTimeout((function(){t.initDiscover(e)}),100),setTimeout((function(){t.initFanSpotlight(e)}),100),Url.getQueryParam(window.location.href,"skip_homefeed")||t.initHomeFeed(e))},initCarousel:function(e){t.carouselControl=new CarouselControl("#carousel-bcweekly-container",e.carousel);const n=e.carousel&&!e.carousel.big_item.is_bcweekly,a="1"==HiddenParams.show_archive;t.bcwControl=new BCWeeklyControl("#bcweekly",e.bcw_seq_details,e.bcw_data,e.bcw_index,Identities.fan(),!1,n,a),$("#carousel-bcweekly-container").on("click",".carousel-small-bcweekly-link, .carousel-bcweekly-play-button",t.bcwControl.handlePlayClick)},initDiscover:function(e){t.discoverVM=new DiscoverVM($("#discover")[0],e.discover_2015),ko.applyBindings(t.discoverVM,$("#discover")[0]),$("#discover .server-rendered").remove(),$("#discover .client-rendered").show(),t.discoverVM.setupScrollers()},initNotable:function(e){t.notableVM=new NotableVM($("#notable")[0],e.bcnt_seq,e.bcnt_data,e.fan_controls),ko.applyBindings(t.notableVM,$("#notable")[0]),t.notableVM.postBinding(),NotableVideo.initialize(t.notableVM)},initFanSpotlight:function(e){t.fnspControl=new FanSpotlightControl($("#spotlight")[0],e.fnsp_seq,e.fnsp_data,null,e.fan_controls)},initBCDaily:function(e){t.bcDailyVM=new BCDailyManager($("#bcdaily")[0])},initCuratedShows:function(e){t.curatedShowsVM=new CuratedShowsManager(e.curated_event_listings);const n=$("#curatedshows")[0];n&&ko.applyBindings(t.curatedShowsVM,n)},initHomeFeed:function(e){$.get("/api/salesfeed/1/get_initial").then((function(e){t.feedReader=new SalesFeedControl(".salesfeed",e.feed_data)}),(function(e){}))},pauseAllAudio:function(){t.bcwControl.playlist.pause(),t.discoverVM.player.pause(),t.notableVM.player.pause(),t.fnspControl.playlist.pause()},updateCollectionInfo:function(e){$("#pagedata").data("blob").show_fan_collection_info&&(FanControls.start(),FanControls.initializeItems(e))}};var t;window.HomeControl=e,$(document).ready((function(){const t=$("#pagedata").data("blob")||{},n=t.cfg||{};if(window.CurrencyData=t.currency_data,"invalid"==t.la_invitation){var a="<span style='font-size: 16px'>This invitation is no longer valid.</span>";NuDialog.alertHTML("",a,{dialogClass:"ui-dialog-2018 transparent-title preview-check no-title",buttons:{"Got it":function(){$(this).dialog("close")}}})}if("expired"==t.la_invitation){a="<span style='font-size: 16px'>This invitation has expired. Please reach out to the person who invited you to request a new invitation.</span>";NuDialog.alertHTML("",a,{dialogClass:"ui-dialog-2018 transparent-title preview-check no-title",buttons:{"Got it":function(){$(this).dialog("close")}}})}let i;function s(){const e=document.body,t=document.documentElement;return{left:parseFloat(window.pageXOffset||e.scrollLeft||t.scrollLeft),top:parseFloat(window.pageYOffset||e.scrollTop||t.scrollTop)}}$(".stepper .stepper-next, .stepper .stepper-prev").on("mousedown",(function(e){const t=$(e.target).closest(".stepper > *");t.is(".inactive")||t.is(".disabled")||(t.addClass("immediate"),t.addClass("highlight"),setTimeout((function(){t.removeClass("immediate"),t.removeClass("highlight")}),0))})),$(".scroller-next, .scroller-prev").on("mousedown",(function(e){const t=$(e.target).closest("a");t.is(".inactive")||t.is(".disabled")||(t.addClass("immediate"),t.addClass("highlight"),setTimeout((function(){t.removeClass("immediate"),t.removeClass("highlight")}),0))})),e.init(),s().top<100&&$(".hd").removeClass("tooltips-hidden"),(!n.header_rework_2018||n.header_rework_2018&&"desktop"===MediaView.mode)&&(n.header_rework_2018?(i=$(".menubar-outer"),i[0]?i.addClass("fixed"):i=$(".hd")):i=$(".hd"),$(window).scroll((function(e){if("desktop"===MediaView.mode){s().top>=100&&!$("body").hasClass("prevent-header-hiding")?i.addClass("hide-tooltips"):(i.removeClass("tooltips-hidden"),i.removeClass("hide-tooltips"))}})));const o=location.hash;if("#discover"==o){$("body").addClass("scroll-detected"),$(".hd").addClass("hide"),$("#menubar-vm").addClass("hide");const e=$("#discover");$("html, body").animate({scrollTop:e.offset().top},100)}if($(".discover-link").click((function(e){e.preventDefault(),Stats.record({kind:"click",click:"homepage_header_discover"});const t=$("#discover");$("html, body").animate({scrollTop:t.offset().top})})),$(".featured-item-sticky a.app-link").click((function(){const e=$(this).is(".ios")?"homepage_ios_download":"homepage_android_download";return Stats.record({kind:"click",click:e}),!0})),"#selling-right-now"==o){$("body").addClass("scroll-detected");const e=$("#salesfeed");$("html, body").scrollTop(e.offset().top-120)}if("#newsletter"==o){$("body").addClass("scroll-detected");const e=$("#email-intake");$("html, body").scrollTop(e.offset().top-115)}}))}(window,jQuery,ko),function(){"use strict";function e(e,t){const n=this;n.email=ko.observable(t.email||""),n.cleanmail=ko.observable(n.email()),n.showoffable=ko.observable(!!t.email),n.submitable=ko.computed((function(){return n.cleanmail(n.email().substring(0,100).trim()),/.+@.+/.test(n.cleanmail())})),n.submit=function(){$("input",e).blur(),$(".intake",e).animate({opacity:0},500),$(".success",e).addClass("display").animate({opacity:1},500),setTimeout((function(){$(e).fadeOut(500)}),7e3),BCAPI.call("Newsletter_1","signup",{email_address:n.cleanmail()}).fail((function(){$(e).hide(),NuDialog.alert("Error","Sorry, there was an error.")}))}}$((function(){const t=$("#email-intake-vm")[0];t&&ko.applyBindings(new e(t,$(t).data("initial-values")),t)}))}();var CountryOrder={preferred:["US","CA","GB","AU","FR","DE","JP"],general:["AF","AX","AL","DZ","AS","AD","AO","AI","AQ","AG","AR","AM","AW","AC","AU","AT","AZ","BS","BH","BD","BB","BY","BE","BZ","BJ","BM","BT","BO","BA","BW","BV","BR","IO","BN","BG","BF","BI","KH","CM","CA","CV","BQ","KY","CF","TD","CL","CN","CX","CC","CO","KM","CG","CD","CK","CR","CI","HR","CU","CW","CY","CZ","DK","DJ","DM","DO","EC","EG","SV","GQ","ER","EE","ET","FK","FO","FJ","FI","FR","GF","PF","TF","GA","GM","GE","DE","GH","GI","GR","GL","GD","GP","GU","GT","GG","GN","GW","GY","HT","HM","HN","HK","HU","HY","IS","IN","ID","IR","IQ","IE","IM","IL","IT","JM","JP","JE","JO","KZ","KE","KI","XK","KW","KG","LA","LV","LB","LS","LR","LY","LI","LT","LU","MO","MK","MG","MW","MY","MV","ML","MT","MH","MQ","MR","MU","YT","MX","FM","UM","MD","MC","MN","ME","MS","MA","MZ","MM","NA","NR","NP","NL","AN","NC","NZ","NI","NE","NG","NU","NF","KP","MP","NO","OM","PK","PW","PS","PA","PG","PY","PE","PH","PN","PL","PT","PR","QA","RE","RO","RU","RW","BL","SH","KN","LC","MF","PM","VC","WS","SM","ST","SA","SN","RS","SC","SL","SG","SX","SK","SI","SB","SO","ZA","GS","KR","SS","ES","LK","SD","SR","SJ","SZ","SE","CH","SY","TW","TJ","TZ","TH","TL","TG","TK","TO","TT","TA","TN","TR","TM","TC","TV","UG","UA","AE","GB","US","UY","UZ","VU","VA","VE","VN","VG","VI","WF","EH","YE","ZM","ZW"]},CountryNames={UZ:"Uzbekistan",SE:"Sweden",CX:"Christmas Island",PG:"Papua New Guinea",LR:"Liberia",AC:"Ascension",IT:"Italy",VC:"Saint Vincent and the Grenadines",FK:"Falkland Islands (Islas Malvinas)",CM:"Cameroon",ZW:"Zimbabwe",BY:"Belarus",HU:"Hungary",KH:"Cambodia",BN:"Brunei",NF:"Norfolk Island",AZ:"Azerbaijan",MR:"Mauritania",ZA:"South Africa",PS:"Palestine",DM:"Dominica",AO:"Angola",MG:"Madagascar",CY:"Cyprus",PH:"Philippines",LS:"Lesotho",AD:"Andorra",CN:"China",NR:"Nauru",CC:"Cocos (Keeling) Islands",BZ:"Belize",ZM:"Zambia",HK:"Hong Kong",BO:"Bolivia",NG:"Nigeria",KI:"Kiribati",BD:"Bangladesh",GW:"Guinea-Bissau",TF:"French Southern Territories",MS:"Montserrat",GL:"Greenland",PT:"Portugal",MH:"Marshall Islands",SR:"Suriname",VE:"Venezuela",AE:"United Arab Emirates",SG:"Singapore",GA:"Gabon",CZ:"Czech Republic",LT:"Lithuania",FM:"Micronesia",CO:"Colombia",LI:"Liechtenstein",RS:"Serbia",CD:"Congo (Kinshasa)",TR:"Turkey",TG:"Togo",DZ:"Algeria",EC:"Ecuador",MT:"Malta",BE:"Belgium",AQ:"Antarctica",SS:"South Sudan",GM:"Gambia",DO:"Dominican Republic",GB:"United Kingdom",SH:"Saint Helena",LU:"Luxembourg",AF:"Afghanistan",IL:"Israel",UG:"Uganda",HM:"Heard Island and McDonald Islands",BQ:"Caribbean Netherlands",NI:"Nicaragua",WF:"Wallis and Futuna",TH:"Thailand",MU:"Mauritius",BF:"Burkina Faso",GY:"Guyana",ST:"Sao Tome and Principe",GN:"Guinea",AR:"Argentina",YE:"Yemen",VG:"Virgin Islands, British",PK:"Pakistan",DE:"Germany",LV:"Latvia",AG:"Antigua and Barbuda",SI:"Slovenia",US:"United States",IM:"Isle of Man",RU:"Russia",FO:"Faroe Islands",LK:"Sri Lanka",NU:"Niue",CF:"Central African Republic",KW:"Kuwait",HY:"Hyrule",TT:"Trinidad and Tobago",HN:"Honduras",BR:"Brazil",MV:"Maldives",BG:"Bulgaria",EE:"Estonia",PW:"Palau",AS:"American Samoa",MK:"Macedonia",JM:"Jamaica",SJ:"Svalbard and Jan Mayen",GD:"Grenada",PL:"Poland",CR:"Costa Rica",PA:"Panama",IN:"India",LA:"Laos",CG:"Congo (Brazzaville)",BS:"Bahamas",WS:"Samoa",KM:"Comoros",TJ:"Tajikistan",MW:"Malawi",BH:"Bahrain",QA:"Qatar",AT:"Austria",ML:"Mali",SV:"El Salvador",GP:"Guadeloupe",VI:"Virgin Islands, U.S.",SK:"Slovakia",GE:"Georgia",PM:"Saint Pierre and Miquelon",AI:"Anguilla",MA:"Morocco",IO:"British Indian Ocean Territory",RW:"Rwanda",ID:"Indonesia",CH:"Switzerland",KY:"Cayman Islands",LB:"Lebanon",TV:"Tuvalu",KN:"Saint Kitts and Nevis",ER:"Eritrea",BT:"Bhutan",NL:"Netherlands",TK:"Tokelau",EG:"Egypt",MX:"Mexico",BI:"Burundi",NA:"Namibia",VU:"Vanuatu",JO:"Jordan",GQ:"Equatorial Guinea",PY:"Paraguay",AU:"Australia",MM:"Myanmar",PN:"Pitcairn Islands",LY:"Libya",SL:"Sierra Leone",GF:"French Guiana",FR:"France",SA:"Saudi Arabia",CI:"Cote d'Ivoire (Ivory Coast)",KZ:"Kazakhstan",LC:"Saint Lucia",IE:"Ireland",TW:"Taiwan",ES:"Spain",EH:"Western Sahara",TL:"Timor-Leste",MY:"Malaysia",BJ:"Benin",TA:"Tristan da Cunha",GR:"Greece",YT:"Mayotte",MN:"Mongolia",JP:"Japan",SX:"Sint Maarten",MC:"Monaco",JE:"Jersey",SM:"San Marino",GG:"Guernsey",SB:"Solomon Islands",CU:"Cuba",OM:"Oman",IQ:"Iraq",UA:"Ukraine",ET:"Ethiopia",BV:"Bouvet Island",KP:"North Korea",HR:"Croatia",TM:"Turkmenistan",KE:"Kenya",MZ:"Mozambique",NC:"New Caledonia",AW:"Aruba",MO:"Macau",SY:"Syria",GS:"South Georgia and the South Sandwich Islands",SN:"Senegal",GH:"Ghana",DJ:"Djibouti",AL:"Albania",MD:"Moldova",VA:"Vatican City",PE:"Peru",IR:"Iran",SC:"Seychelles",CV:"Cape Verde",RO:"Romania",FI:"Finland",NZ:"New Zealand",CK:"Cook Islands",XK:"Kosovo",UM:"Midway Islands",BW:"Botswana",NO:"Norway",TN:"Tunisia",BL:"Saint Barthélemy",TC:"Turks and Caicos Islands",BA:"Bosnia and Herzegovina",SZ:"Swaziland",GT:"Guatemala",AX:"Aland",MP:"Northern Mariana Islands",GI:"Gibraltar",DK:"Denmark",AM:"Armenia",ME:"Montenegro",SO:"Somalia",UY:"Uruguay",IS:"Iceland",SD:"Sudan",CW:"Curaçao",PF:"French Polynesia",CL:"Chile",FJ:"Fiji",TZ:"Tanzania",HT:"Haiti",RE:"Reunion",NP:"Nepal",CA:"Canada",KR:"South Korea",TO:"Tonga",BM:"Bermuda",NE:"Niger",KG:"Kyrgyzstan",GU:"Guam",TD:"Chad",MQ:"Martinique",BB:"Barbados",VN:"Viet Nam",AN:"Netherlands Antilles",MF:"Saint Martin",PR:"Puerto Rico"};!function(){"use strict";window.Country={name:function(i){const s=i.toUpperCase();if(e)return CountryNames[s];if(t)return Pseudoloc.str(CountryNames[s]);const o=Translate.locale;return a[o]&&a[o][s]||n.of(s)}};const e=!window.Translate||"en"===Translate.locale||!Intl.DisplayNames,t=window.Pseudoloc&&"qq"===Translate.locale,n=!e&&new Intl.DisplayNames([Translate.locale],{type:"region"}),a={en:{HY:"Hyrule",HK:"Hong Kong",MO:"Macao"},ja:{HY:"ハイラル",CN:"中国",HK:"香港",MO:"マカオ",US:"アメリカ"},fr:{HY:"Hyrule",CN:"Chine",HK:"Hong Kong",MO:"Macao"},de:{HY:"Hyrule",CN:"China",HK:"Hongkong",MO:"Macao"},es:{HY:"Hyrule",CN:"China",HK:"Hong Kong",MO:"Macao"},pt:{HY:"Hyrule",CN:"China",HK:"Hong Kong",MO:"Macau"}}}();
