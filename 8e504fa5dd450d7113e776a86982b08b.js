!function(factory){"object"==typeof module&&"object"==typeof module.exports?module.exports=factory(require("jquery")):factory(jQuery)}((function($){function GifPlayer(preview,options){this.previewElement=preview,this.options=options,this.animationLoaded=!1}return GifPlayer.scopes=new Array,GifPlayer.prototype={supportedFormats:["gif","jpeg","jpg","png"],playIcon:'<span class="vscom-gif-player-icon vscom-gif-player-icon--play fabric-icon vscom-icon vscom-icon--Play"></span>',pauseIcon:'<span class="vscom-gif-player-icon vscom-gif-player-icon--pause fabric-icon vscom-icon vscom-icon--Pause"></span>',activate:function(){var self=this;0===this.previewElement.width()?setTimeout((function(){self.activate()}),100):(self.mode=self.getOption("mode"),self.lazyload=self.getOption("lazyload"),self.wrap(),self.addEvents())},wrap:function(){this.previewElement.addClass("gifplayer-ready"),this.wrapper=this.previewElement.parent(".gifplayer-wrapper"),this.button=this.previewElement.closest("a"),this.previewElement.css("position","relative")},getOption:function(option){var dataOption=this.previewElement.data(option.toLowerCase());return null!=dataOption&&""!=dataOption?dataOption:this.options[option]},addControl:function(){this.playElement.append(this.pauseIcon),this.previewElement.removeAttr("data-aria")},addEvents:function(){var gp=this,playOn=this.getOption("playOn");switch(playOn){case"auto":gp.gifElement.prop("complete")?this.animationLoaded||($(gp.playElement).attr("aria-label","Pause Animated GIF"),$(gp.playElement).attr("role","button"),gp.gifElement.attr("alt",this.previewElement.attr("alt")),$(gp.button).attr("aria-label",gp.pauseText+" - "+gp.alt),$(gp.button).attr("data-bi-name","pause"),this.loadAnimation()):jQuery(this.gifElement).on("load",function(e){this.animationLoaded||($(gp.playElement).attr("aria-label","Pause Animated GIF"),$(gp.playElement).attr("role","button"),gp.gifElement.attr("alt",this.previewElement.attr("alt")),$(gp.button).attr("aria-label",gp.playText+" - "+gp.alt),$(gp.button).attr("data-bi-name","pause"),this.loadAnimation())}.bind(this));case"click":gp.previewElement.on("click",(function(e){gp.getOption("onClick").call(gp.previewElement,e),"pause"==$(gp.playElement).data("state")?(gp.animationLoaded?(gp.spinnerElement&&gp.spinnerElement.hide(),gp.stopGif()):gp.abortLoading(e),$(gp.playElement).html(gp.playIcon).data("state","play"),$(gp.playElement).attr("aria-label","Play Animated GIF"),$(gp.playElement).attr("role","button"),$(gp.button).attr("data-bi-name","play"),$(gp.button).attr("aria-label",gp.playText+" - "+gp.alt)):gp.animationLoaded&&($(gp.playElement).html(gp.pauseIcon).data("state","pause"),$(gp.playElement).attr("aria-label","Pause Animated GIF"),$(gp.playElement).attr("role","button"),$(gp.button).attr("data-bi-name","pause"),$(gp.button).attr("aria-label",gp.pauseText+" - "+gp.alt),gp.startGif()),e.preventDefault(),e.stopPropagation()})),gp.playElement.on("click",(function(e){gp.previewElement.trigger("click"),$(this).blur()})),gp.playElement.off("keypress").off("keydown").off("keyup").on("keypress",(function(e){13===e.keyCode&&gp.previewElement.trigger("click")}));break;case"hover":gp.previewElement.on("click mouseover",(function(e){gp.loadAnimation(),e.preventDefault(),e.stopPropagation()}));break;default:console.log(playOn+" is not accepted as playOn value.")}},processScope:function(){var scope=this.getOption("scope");scope&&(GifPlayer.scopes[scope]&&GifPlayer.scopes[scope].stopGif(),GifPlayer.scopes[scope]=this)},loadAnimation:function(){this.processScope(),this.gifElement.removeClass("gif-loading"),this.spinnerElement.hide(),this.playElement.show(),this.addControl(),"gif"==this.mode?this.startGif():"video"==this.mode&&(this.videoLoaded?this.playVideo():this.loadVideo()),this.animationLoaded=!0,this.getOption("onPlay").call(this.previewElement)},startGif:function(){this.previewElement.css("position","absolute"),this.previewElement.hide(),this.gifElement.css("position","relative"),this.gifElement.show(),this.progressElement&&this.progressElement.css("z-index","1")},stopGif:function(){this.gifElement.css("position","absolute"),this.gifElement.hide(),this.previewElement.css("position","relative"),this.previewElement.show(),this.getOption("onStop").call(this.previewElement),this.progressElement&&this.progressElement.css("z-index","-100")},getFile:function(ext){var gif=this.getOption(ext);if(null!=gif&&""!=gif)return gif;for(replaceString=this.previewElement.attr("src"),i=0;i<this.supportedFormats.length;i++)pattrn=new RegExp(this.supportedFormats[i]+"$","i"),replaceString=replaceString.replace(pattrn,ext);return replaceString},loadVideo:function(){this.videoLoaded=!0;var videoSrcMp4=this.getFile("mp4"),videoSrcWebm=this.getFile("webm"),videoWidth=this.previewElement.width(),videoHeight=this.previewElement.height();this.videoElement=$('<video class="gp-video-element" width="'+videoWidth+'px" height="'+videoHeight+'" style="margin:0 auto;width:'+videoWidth+"px;height:"+videoHeight+'px;" autoplay="autoplay" loop="loop" muted="muted" poster="'+this.previewElement.attr("src")+'"><source type="video/mp4" src="'+videoSrcMp4+'"><source type="video/webm" src="'+videoSrcWebm+'"></video>');var gp=this,checkLoad=function(){4===gp.videoElement[0].readyState?(gp.playVideo(),gp.animationLoaded=!0):setTimeout(checkLoad,100)},wait;this.getOption("wait")?checkLoad():this.playVideo(),this.videoElement.on("click",(function(){gp.videoPaused?gp.resumeVideo():gp.pauseVideo()}))},playVideo:function(){this.spinnerElement.hide(),this.previewElement.hide(),this.playElement.hide(),this.gifLoaded=!0,this.previewElement.hide(),this.wrapper.append(this.videoElement),this.videoPaused=!1,this.videoElement[0].play(),this.getOption("onPlay").call(this.previewElement)},pauseVideo:function(){this.videoPaused=!0,this.videoElement[0].pause(),this.playElement.show(),this.mouseoverEnabled=!1,this.getOption("onStop").call(this.previewElement)},resumeVideo:function(){this.videoPaused=!1,this.videoElement[0].play(),this.playElement.hide(),this.getOption("onPlay").call(this.previewElement)},enableAbort:function(){var gp=this;this.previewElement.click((function(e){gp.abortLoading(e)})),this.spinnerElement.click((function(e){gp.abortLoading(e)}))},abortLoading:function(e){this.spinnerElement.hide(),this.previewElement.show(),this.previewElement.css("display","relative"),e.preventDefault(),e.stopPropagation(),this.animationLoaded=!1,this.getOption("onStop").call(this.previewElement)},resetEvents:function(){this.previewElement.off("click"),this.previewElement.off("mouseover"),this.playElement.off("click"),this.spinnerElement.off("click"),this.addEvents()}},$.fn.gifplayer=function(options){return/^(play|stop)$/i.test(options)?this.each((function(){if(options=options.toLowerCase(),$(this).hasClass("gifplayer-ready")){var gp=new GifPlayer($(this),null);switch(gp.options={},gp.options=$.extend({},$.fn.gifplayer.defaults,gp.options),gp.wrapper=$(this).parent(),gp.button=$(this).closest("a"),gp.playText=$(this).data("playtext"),gp.pauseText=$(this).data("pausetext"),gp.spinnerElement=gp.wrapper.find(".spinner"),gp.playElement=gp.wrapper.find(".play-gif"),gp.gifElement=gp.wrapper.find(".gp-gif-element"),gp.alt=gp.wrapper.find(".vscom-gif-player-img").attr("alt"),gp.videoElement=gp.wrapper.find(".gp-video-element"),gp.progressElement=gp.wrapper.find(".vscom-gif-progress"),gp.meterElement=gp.wrapper.find(".vscom-gif-meter"),gp.mode=gp.getOption("mode"),options){case"play":gp.playElement.trigger("click");break;case"stop":gp.playElement.is(":visible")||("gif"==gp.mode?gp.stopGif():"video"==gp.mode&&gp.videoElement.trigger("click"))}}})):this.each((function(index){options=$.extend({},$.fn.gifplayer.defaults,options);var gifplayer=new GifPlayer($(this),options);gifplayer.wrapper=$(this).parent(),gifplayer.button=$(this).closest("a"),gifplayer.playText=$(this).data("playtext"),gifplayer.pauseText=$(this).data("pausetext"),gifplayer.gifElement=gifplayer.wrapper.find(".gp-gif-element"),gifplayer.alt=gifplayer.wrapper.find(".vscom-gif-player-img").attr("alt"),console.log(gifplayer.alt),gifplayer.spinnerElement=gifplayer.wrapper.find(".spinner"),gifplayer.playElement=gifplayer.wrapper.find(".play-gif"),gifplayer.progressElement=gifplayer.wrapper.find(".vscom-gif-progress"),gifplayer.activate()}))},$.fn.gifplayer.defaults={label:"GIF",playOn:"click",gif:"",mp4:"",webm:"",wait:!1,scope:!1,onPlay:function(){},onStop:function(){},onClick:function(){},onLoad:function(){},onLoadComplete:function(){}},GifPlayer})),jQuery((function(){jQuery(".vscom-gif-player-img").gifplayer()}));